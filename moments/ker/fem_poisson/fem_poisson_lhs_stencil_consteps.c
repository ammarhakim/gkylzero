#include <gkyl_fem_poisson_kernels.h> 
 
void fem_poisson_lhs_stencil_consteps_1x_ser_p1_inx_periodicx(const double *epsilon, const double *kSq, const double *dx, const double *bcVals, const long *globalIdxs, gkyl_mat_triples *tri) 
{ 
  // epsilon: permittivity.
  // kSq: wave number squared (factor multiplying phi).
  // dx: cell length in each direction.
  // bcVals[3]: values to impose as BCs, i.e. bcVals[0]*phi+bcVals[1]*d(phi)/dx=bcVals[2].
  // globalIdxs: global linear index of each basis function/node in current cell.
  // tri: triples object (i,j,val), i.e. contribute val to i,j element of the global matrix.

  double rdx2Sq[1];
  rdx2Sq[0] = 4.0/(dx[0]*dx[0]);

  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[0], 0.408248290463863*kSq[1]+0.5*epsilon[0]*rdx2Sq[0]-0.4714045207910318*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[1], (-0.5*epsilon[0]*rdx2Sq[0])-0.2357022603955158*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[0], (-0.5*epsilon[0]*rdx2Sq[0])-0.2357022603955158*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[1], (-0.408248290463863*kSq[1])+0.5*epsilon[0]*rdx2Sq[0]-0.4714045207910318*kSq[0]);

}
void fem_poisson_lhs_stencil_consteps_1x_ser_p2_inx_periodicx(const double *epsilon, const double *kSq, const double *dx, const double *bcVals, const long *globalIdxs, gkyl_mat_triples *tri) 
{ 
  // epsilon: permittivity.
  // kSq: wave number squared (factor multiplying phi).
  // dx: cell length in each direction.
  // bcVals[3]: values to impose as BCs, i.e. bcVals[0]*phi+bcVals[1]*d(phi)/dx=bcVals[2].
  // globalIdxs: global linear index of each basis function/node in current cell.
  // tri: triples object (i,j,val), i.e. contribute val to i,j element of the global matrix.

  double rdx2Sq[1];
  rdx2Sq[0] = 4.0/(dx[0]*dx[0]);

  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[0], (-0.1957600456294712*kSq[2])+0.2449489742783178*kSq[1]+1.166666666666667*epsilon[0]*rdx2Sq[0]-0.1885618083164128*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[1], (-0.03011693009684172*kSq[2])+0.1632993161855452*kSq[1]-1.333333333333333*epsilon[0]*rdx2Sq[0]-0.09428090415820636*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[2], 0.01505846504842086*kSq[2]+0.1666666666666667*epsilon[0]*rdx2Sq[0]+0.04714045207910317*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[0], (-0.03011693009684171*kSq[2])+0.1632993161855452*kSq[1]-1.333333333333333*epsilon[0]*rdx2Sq[0]-0.09428090415820635*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[1], 0.4818708815494677*kSq[2]+2.666666666666667*epsilon[0]*rdx2Sq[0]-0.7542472332656511*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[2], (-0.03011693009684171*kSq[2])-0.1632993161855452*kSq[1]-1.333333333333333*epsilon[0]*rdx2Sq[0]-0.09428090415820635*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[0], 0.01505846504842086*kSq[2]+0.1666666666666667*epsilon[0]*rdx2Sq[0]+0.04714045207910317*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[1], (-0.03011693009684172*kSq[2])-0.1632993161855452*kSq[1]-1.333333333333333*epsilon[0]*rdx2Sq[0]-0.09428090415820636*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[2], (-0.1957600456294712*kSq[2])-0.2449489742783178*kSq[1]+1.166666666666667*epsilon[0]*rdx2Sq[0]-0.1885618083164128*kSq[0]);

}
void fem_poisson_lhs_stencil_consteps_1x_ser_p1_lox_periodicx(const double *epsilon, const double *kSq, const double *dx, const double *bcVals, const long *globalIdxs, gkyl_mat_triples *tri) 
{ 
  // epsilon: permittivity.
  // kSq: wave number squared (factor multiplying phi).
  // dx: cell length in each direction.
  // bcVals[3]: values to impose as BCs, i.e. bcVals[0]*phi+bcVals[1]*d(phi)/dx=bcVals[2].
  // globalIdxs: global linear index of each basis function/node in current cell.
  // tri: triples object (i,j,val), i.e. contribute val to i,j element of the global matrix.

  double rdx2Sq[1];
  rdx2Sq[0] = 4.0/(dx[0]*dx[0]);

  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[0], 0.408248290463863*kSq[1]+0.5*epsilon[0]*rdx2Sq[0]-0.4714045207910318*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[1], (-0.5*epsilon[0]*rdx2Sq[0])-0.2357022603955158*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[0], (-0.5*epsilon[0]*rdx2Sq[0])-0.2357022603955158*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[1], (-0.408248290463863*kSq[1])+0.5*epsilon[0]*rdx2Sq[0]-0.4714045207910318*kSq[0]);

}
void fem_poisson_lhs_stencil_consteps_1x_ser_p2_lox_periodicx(const double *epsilon, const double *kSq, const double *dx, const double *bcVals, const long *globalIdxs, gkyl_mat_triples *tri) 
{ 
  // epsilon: permittivity.
  // kSq: wave number squared (factor multiplying phi).
  // dx: cell length in each direction.
  // bcVals[3]: values to impose as BCs, i.e. bcVals[0]*phi+bcVals[1]*d(phi)/dx=bcVals[2].
  // globalIdxs: global linear index of each basis function/node in current cell.
  // tri: triples object (i,j,val), i.e. contribute val to i,j element of the global matrix.

  double rdx2Sq[1];
  rdx2Sq[0] = 4.0/(dx[0]*dx[0]);

  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[0], (-0.1957600456294712*kSq[2])+0.2449489742783178*kSq[1]+1.166666666666667*epsilon[0]*rdx2Sq[0]-0.1885618083164128*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[1], (-0.03011693009684172*kSq[2])+0.1632993161855452*kSq[1]-1.333333333333333*epsilon[0]*rdx2Sq[0]-0.09428090415820636*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[2], 0.01505846504842086*kSq[2]+0.1666666666666667*epsilon[0]*rdx2Sq[0]+0.04714045207910317*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[0], (-0.03011693009684171*kSq[2])+0.1632993161855452*kSq[1]-1.333333333333333*epsilon[0]*rdx2Sq[0]-0.09428090415820635*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[1], 0.4818708815494677*kSq[2]+2.666666666666667*epsilon[0]*rdx2Sq[0]-0.7542472332656511*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[2], (-0.03011693009684171*kSq[2])-0.1632993161855452*kSq[1]-1.333333333333333*epsilon[0]*rdx2Sq[0]-0.09428090415820635*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[0], 0.01505846504842086*kSq[2]+0.1666666666666667*epsilon[0]*rdx2Sq[0]+0.04714045207910317*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[1], (-0.03011693009684172*kSq[2])-0.1632993161855452*kSq[1]-1.333333333333333*epsilon[0]*rdx2Sq[0]-0.09428090415820636*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[2], (-0.1957600456294712*kSq[2])-0.2449489742783178*kSq[1]+1.166666666666667*epsilon[0]*rdx2Sq[0]-0.1885618083164128*kSq[0]);

}
void fem_poisson_lhs_stencil_consteps_1x_ser_p1_lox_dirichletx(const double *epsilon, const double *kSq, const double *dx, const double *bcVals, const long *globalIdxs, gkyl_mat_triples *tri) 
{ 
  // epsilon: permittivity.
  // kSq: wave number squared (factor multiplying phi).
  // dx: cell length in each direction.
  // bcVals[3]: values to impose as BCs, i.e. bcVals[0]*phi+bcVals[1]*d(phi)/dx=bcVals[2].
  // globalIdxs: global linear index of each basis function/node in current cell.
  // tri: triples object (i,j,val), i.e. contribute val to i,j element of the global matrix.

  double rdx2Sq[1];
  rdx2Sq[0] = 4.0/(dx[0]*dx[0]);

  gkyl_mat_triples_insert(tri, globalIdxs[0], globalIdxs[0], 1.0);
  gkyl_mat_triples_insert(tri, globalIdxs[0], globalIdxs[1], 0.0);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[0], (-0.5*epsilon[0]*rdx2Sq[0])-0.2357022603955158*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[1], (-0.408248290463863*kSq[1])+0.5*epsilon[0]*rdx2Sq[0]-0.4714045207910318*kSq[0]);

}
void fem_poisson_lhs_stencil_consteps_1x_ser_p2_lox_dirichletx(const double *epsilon, const double *kSq, const double *dx, const double *bcVals, const long *globalIdxs, gkyl_mat_triples *tri) 
{ 
  // epsilon: permittivity.
  // kSq: wave number squared (factor multiplying phi).
  // dx: cell length in each direction.
  // bcVals[3]: values to impose as BCs, i.e. bcVals[0]*phi+bcVals[1]*d(phi)/dx=bcVals[2].
  // globalIdxs: global linear index of each basis function/node in current cell.
  // tri: triples object (i,j,val), i.e. contribute val to i,j element of the global matrix.

  double rdx2Sq[1];
  rdx2Sq[0] = 4.0/(dx[0]*dx[0]);

  gkyl_mat_triples_insert(tri, globalIdxs[0], globalIdxs[0], 1.0);
  gkyl_mat_triples_insert(tri, globalIdxs[0], globalIdxs[1], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[0], globalIdxs[2], 0.0);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[0], (-0.03011693009684171*kSq[2])+0.1632993161855452*kSq[1]-1.333333333333333*epsilon[0]*rdx2Sq[0]-0.09428090415820635*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[1], 0.4818708815494677*kSq[2]+2.666666666666667*epsilon[0]*rdx2Sq[0]-0.7542472332656511*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[2], (-0.03011693009684171*kSq[2])-0.1632993161855452*kSq[1]-1.333333333333333*epsilon[0]*rdx2Sq[0]-0.09428090415820635*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[0], 0.01505846504842086*kSq[2]+0.1666666666666667*epsilon[0]*rdx2Sq[0]+0.04714045207910317*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[1], (-0.03011693009684172*kSq[2])-0.1632993161855452*kSq[1]-1.333333333333333*epsilon[0]*rdx2Sq[0]-0.09428090415820636*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[2], (-0.1957600456294712*kSq[2])-0.2449489742783178*kSq[1]+1.166666666666667*epsilon[0]*rdx2Sq[0]-0.1885618083164128*kSq[0]);

}
void fem_poisson_lhs_stencil_consteps_1x_ser_p1_lox_neumannx(const double *epsilon, const double *kSq, const double *dx, const double *bcVals, const long *globalIdxs, gkyl_mat_triples *tri) 
{ 
  // epsilon: permittivity.
  // kSq: wave number squared (factor multiplying phi).
  // dx: cell length in each direction.
  // bcVals[3]: values to impose as BCs, i.e. bcVals[0]*phi+bcVals[1]*d(phi)/dx=bcVals[2].
  // globalIdxs: global linear index of each basis function/node in current cell.
  // tri: triples object (i,j,val), i.e. contribute val to i,j element of the global matrix.

  double rdx2Sq[1];
  rdx2Sq[0] = 4.0/(dx[0]*dx[0]);

  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[0], 0.408248290463863*kSq[1]+0.5*epsilon[0]*rdx2Sq[0]-0.4714045207910318*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[1], (-0.5*epsilon[0]*rdx2Sq[0])-0.2357022603955158*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[0], (-0.5*epsilon[0]*rdx2Sq[0])-0.2357022603955158*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[1], (-0.408248290463863*kSq[1])+0.5*epsilon[0]*rdx2Sq[0]-0.4714045207910318*kSq[0]);

}
void fem_poisson_lhs_stencil_consteps_1x_ser_p2_lox_neumannx(const double *epsilon, const double *kSq, const double *dx, const double *bcVals, const long *globalIdxs, gkyl_mat_triples *tri) 
{ 
  // epsilon: permittivity.
  // kSq: wave number squared (factor multiplying phi).
  // dx: cell length in each direction.
  // bcVals[3]: values to impose as BCs, i.e. bcVals[0]*phi+bcVals[1]*d(phi)/dx=bcVals[2].
  // globalIdxs: global linear index of each basis function/node in current cell.
  // tri: triples object (i,j,val), i.e. contribute val to i,j element of the global matrix.

  double rdx2Sq[1];
  rdx2Sq[0] = 4.0/(dx[0]*dx[0]);

  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[0], (-0.1957600456294712*kSq[2])+0.2449489742783178*kSq[1]+1.166666666666667*epsilon[0]*rdx2Sq[0]-0.1885618083164128*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[1], (-0.03011693009684172*kSq[2])+0.1632993161855452*kSq[1]-1.333333333333333*epsilon[0]*rdx2Sq[0]-0.09428090415820636*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[2], 0.01505846504842086*kSq[2]+0.1666666666666667*epsilon[0]*rdx2Sq[0]+0.04714045207910317*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[0], (-0.03011693009684171*kSq[2])+0.1632993161855452*kSq[1]-1.333333333333333*epsilon[0]*rdx2Sq[0]-0.09428090415820635*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[1], 0.4818708815494677*kSq[2]+2.666666666666667*epsilon[0]*rdx2Sq[0]-0.7542472332656511*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[2], (-0.03011693009684171*kSq[2])-0.1632993161855452*kSq[1]-1.333333333333333*epsilon[0]*rdx2Sq[0]-0.09428090415820635*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[0], 0.01505846504842086*kSq[2]+0.1666666666666667*epsilon[0]*rdx2Sq[0]+0.04714045207910317*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[1], (-0.03011693009684172*kSq[2])-0.1632993161855452*kSq[1]-1.333333333333333*epsilon[0]*rdx2Sq[0]-0.09428090415820636*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[2], (-0.1957600456294712*kSq[2])-0.2449489742783178*kSq[1]+1.166666666666667*epsilon[0]*rdx2Sq[0]-0.1885618083164128*kSq[0]);

}
void fem_poisson_lhs_stencil_consteps_1x_ser_p1_lox_robinx(const double *epsilon, const double *kSq, const double *dx, const double *bcVals, const long *globalIdxs, gkyl_mat_triples *tri) 
{ 
  // epsilon: permittivity.
  // kSq: wave number squared (factor multiplying phi).
  // dx: cell length in each direction.
  // bcVals[3]: values to impose as BCs, i.e. bcVals[0]*phi+bcVals[1]*d(phi)/dx=bcVals[2].
  // globalIdxs: global linear index of each basis function/node in current cell.
  // tri: triples object (i,j,val), i.e. contribute val to i,j element of the global matrix.

  double rdx2Sq[1];
  rdx2Sq[0] = 4.0/(dx[0]*dx[0]);

  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[0], 0.408248290463863*kSq[1]-(1.0*bcVals[0]*epsilon[0]*rdx2Sq[0])/bcVals[1]+0.5*epsilon[0]*rdx2Sq[0]-0.4714045207910318*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[1], (-0.5*epsilon[0]*rdx2Sq[0])-0.2357022603955158*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[0], (-0.5*epsilon[0]*rdx2Sq[0])-0.2357022603955158*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[1], (-0.408248290463863*kSq[1])+0.5*epsilon[0]*rdx2Sq[0]-0.4714045207910318*kSq[0]);

}
void fem_poisson_lhs_stencil_consteps_1x_ser_p2_lox_robinx(const double *epsilon, const double *kSq, const double *dx, const double *bcVals, const long *globalIdxs, gkyl_mat_triples *tri) 
{ 
  // epsilon: permittivity.
  // kSq: wave number squared (factor multiplying phi).
  // dx: cell length in each direction.
  // bcVals[3]: values to impose as BCs, i.e. bcVals[0]*phi+bcVals[1]*d(phi)/dx=bcVals[2].
  // globalIdxs: global linear index of each basis function/node in current cell.
  // tri: triples object (i,j,val), i.e. contribute val to i,j element of the global matrix.

  double rdx2Sq[1];
  rdx2Sq[0] = 4.0/(dx[0]*dx[0]);

  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[0], (-0.1957600456294712*kSq[2])+0.2449489742783178*kSq[1]-(1.0*bcVals[0]*epsilon[0]*rdx2Sq[0])/bcVals[1]+1.166666666666667*epsilon[0]*rdx2Sq[0]-0.1885618083164128*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[1], (-0.03011693009684172*kSq[2])+0.1632993161855452*kSq[1]-1.333333333333333*epsilon[0]*rdx2Sq[0]-0.09428090415820636*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[2], 0.01505846504842086*kSq[2]+0.1666666666666667*epsilon[0]*rdx2Sq[0]+0.04714045207910317*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[0], (-0.03011693009684171*kSq[2])+0.1632993161855452*kSq[1]-1.333333333333333*epsilon[0]*rdx2Sq[0]-0.09428090415820635*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[1], 0.4818708815494677*kSq[2]+2.666666666666667*epsilon[0]*rdx2Sq[0]-0.7542472332656511*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[2], (-0.03011693009684171*kSq[2])-0.1632993161855452*kSq[1]-1.333333333333333*epsilon[0]*rdx2Sq[0]-0.09428090415820635*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[0], 0.01505846504842086*kSq[2]+0.1666666666666667*epsilon[0]*rdx2Sq[0]+0.04714045207910317*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[1], (-0.03011693009684172*kSq[2])-0.1632993161855452*kSq[1]-1.333333333333333*epsilon[0]*rdx2Sq[0]-0.09428090415820636*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[2], (-0.1957600456294712*kSq[2])-0.2449489742783178*kSq[1]+1.166666666666667*epsilon[0]*rdx2Sq[0]-0.1885618083164128*kSq[0]);

}
void fem_poisson_lhs_stencil_consteps_1x_ser_p1_upx_periodicx(const double *epsilon, const double *kSq, const double *dx, const double *bcVals, const long *globalIdxs, gkyl_mat_triples *tri) 
{ 
  // epsilon: permittivity.
  // kSq: wave number squared (factor multiplying phi).
  // dx: cell length in each direction.
  // bcVals[3]: values to impose as BCs, i.e. bcVals[0]*phi+bcVals[1]*d(phi)/dx=bcVals[2].
  // globalIdxs: global linear index of each basis function/node in current cell.
  // tri: triples object (i,j,val), i.e. contribute val to i,j element of the global matrix.

  double rdx2Sq[1];
  rdx2Sq[0] = 4.0/(dx[0]*dx[0]);

  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[0], 0.408248290463863*kSq[1]+0.5*epsilon[0]*rdx2Sq[0]-0.4714045207910318*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[1], (-0.5*epsilon[0]*rdx2Sq[0])-0.2357022603955158*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[0], (-0.5*epsilon[0]*rdx2Sq[0])-0.2357022603955158*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[1], (-0.408248290463863*kSq[1])+0.5*epsilon[0]*rdx2Sq[0]-0.4714045207910318*kSq[0]);

}
void fem_poisson_lhs_stencil_consteps_1x_ser_p2_upx_periodicx(const double *epsilon, const double *kSq, const double *dx, const double *bcVals, const long *globalIdxs, gkyl_mat_triples *tri) 
{ 
  // epsilon: permittivity.
  // kSq: wave number squared (factor multiplying phi).
  // dx: cell length in each direction.
  // bcVals[3]: values to impose as BCs, i.e. bcVals[0]*phi+bcVals[1]*d(phi)/dx=bcVals[2].
  // globalIdxs: global linear index of each basis function/node in current cell.
  // tri: triples object (i,j,val), i.e. contribute val to i,j element of the global matrix.

  double rdx2Sq[1];
  rdx2Sq[0] = 4.0/(dx[0]*dx[0]);

  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[0], (-0.1957600456294712*kSq[2])+0.2449489742783178*kSq[1]+1.166666666666667*epsilon[0]*rdx2Sq[0]-0.1885618083164128*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[1], (-0.03011693009684172*kSq[2])+0.1632993161855452*kSq[1]-1.333333333333333*epsilon[0]*rdx2Sq[0]-0.09428090415820636*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[2], 0.01505846504842086*kSq[2]+0.1666666666666667*epsilon[0]*rdx2Sq[0]+0.04714045207910317*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[0], (-0.03011693009684171*kSq[2])+0.1632993161855452*kSq[1]-1.333333333333333*epsilon[0]*rdx2Sq[0]-0.09428090415820635*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[1], 0.4818708815494677*kSq[2]+2.666666666666667*epsilon[0]*rdx2Sq[0]-0.7542472332656511*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[2], (-0.03011693009684171*kSq[2])-0.1632993161855452*kSq[1]-1.333333333333333*epsilon[0]*rdx2Sq[0]-0.09428090415820635*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[0], 0.01505846504842086*kSq[2]+0.1666666666666667*epsilon[0]*rdx2Sq[0]+0.04714045207910317*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[1], (-0.03011693009684172*kSq[2])-0.1632993161855452*kSq[1]-1.333333333333333*epsilon[0]*rdx2Sq[0]-0.09428090415820636*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[2], (-0.1957600456294712*kSq[2])-0.2449489742783178*kSq[1]+1.166666666666667*epsilon[0]*rdx2Sq[0]-0.1885618083164128*kSq[0]);

}
void fem_poisson_lhs_stencil_consteps_1x_ser_p1_upx_dirichletx(const double *epsilon, const double *kSq, const double *dx, const double *bcVals, const long *globalIdxs, gkyl_mat_triples *tri) 
{ 
  // epsilon: permittivity.
  // kSq: wave number squared (factor multiplying phi).
  // dx: cell length in each direction.
  // bcVals[3]: values to impose as BCs, i.e. bcVals[0]*phi+bcVals[1]*d(phi)/dx=bcVals[2].
  // globalIdxs: global linear index of each basis function/node in current cell.
  // tri: triples object (i,j,val), i.e. contribute val to i,j element of the global matrix.

  double rdx2Sq[1];
  rdx2Sq[0] = 4.0/(dx[0]*dx[0]);

  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[0], 0.408248290463863*kSq[1]+0.5*epsilon[0]*rdx2Sq[0]-0.4714045207910318*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[1], (-0.5*epsilon[0]*rdx2Sq[0])-0.2357022603955158*kSq[0]);
  gkyl_mat_triples_insert(tri, globalIdxs[1], globalIdxs[0], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[1], globalIdxs[1], 1.0);

}
void fem_poisson_lhs_stencil_consteps_1x_ser_p2_upx_dirichletx(const double *epsilon, const double *kSq, const double *dx, const double *bcVals, const long *globalIdxs, gkyl_mat_triples *tri) 
{ 
  // epsilon: permittivity.
  // kSq: wave number squared (factor multiplying phi).
  // dx: cell length in each direction.
  // bcVals[3]: values to impose as BCs, i.e. bcVals[0]*phi+bcVals[1]*d(phi)/dx=bcVals[2].
  // globalIdxs: global linear index of each basis function/node in current cell.
  // tri: triples object (i,j,val), i.e. contribute val to i,j element of the global matrix.

  double rdx2Sq[1];
  rdx2Sq[0] = 4.0/(dx[0]*dx[0]);

  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[0], (-0.1957600456294712*kSq[2])+0.2449489742783178*kSq[1]+1.166666666666667*epsilon[0]*rdx2Sq[0]-0.1885618083164128*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[1], (-0.03011693009684172*kSq[2])+0.1632993161855452*kSq[1]-1.333333333333333*epsilon[0]*rdx2Sq[0]-0.09428090415820636*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[2], 0.01505846504842086*kSq[2]+0.1666666666666667*epsilon[0]*rdx2Sq[0]+0.04714045207910317*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[0], (-0.03011693009684171*kSq[2])+0.1632993161855452*kSq[1]-1.333333333333333*epsilon[0]*rdx2Sq[0]-0.09428090415820635*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[1], 0.4818708815494677*kSq[2]+2.666666666666667*epsilon[0]*rdx2Sq[0]-0.7542472332656511*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[2], (-0.03011693009684171*kSq[2])-0.1632993161855452*kSq[1]-1.333333333333333*epsilon[0]*rdx2Sq[0]-0.09428090415820635*kSq[0]);
  gkyl_mat_triples_insert(tri, globalIdxs[2], globalIdxs[0], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[2], globalIdxs[1], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[2], globalIdxs[2], 1.0);

}
void fem_poisson_lhs_stencil_consteps_1x_ser_p1_upx_neumannx(const double *epsilon, const double *kSq, const double *dx, const double *bcVals, const long *globalIdxs, gkyl_mat_triples *tri) 
{ 
  // epsilon: permittivity.
  // kSq: wave number squared (factor multiplying phi).
  // dx: cell length in each direction.
  // bcVals[3]: values to impose as BCs, i.e. bcVals[0]*phi+bcVals[1]*d(phi)/dx=bcVals[2].
  // globalIdxs: global linear index of each basis function/node in current cell.
  // tri: triples object (i,j,val), i.e. contribute val to i,j element of the global matrix.

  double rdx2Sq[1];
  rdx2Sq[0] = 4.0/(dx[0]*dx[0]);

  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[0], 0.408248290463863*kSq[1]+0.5*epsilon[0]*rdx2Sq[0]-0.4714045207910318*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[1], (-0.5*epsilon[0]*rdx2Sq[0])-0.2357022603955158*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[0], (-0.5*epsilon[0]*rdx2Sq[0])-0.2357022603955158*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[1], (-0.408248290463863*kSq[1])+0.5*epsilon[0]*rdx2Sq[0]-0.4714045207910318*kSq[0]);

}
void fem_poisson_lhs_stencil_consteps_1x_ser_p2_upx_neumannx(const double *epsilon, const double *kSq, const double *dx, const double *bcVals, const long *globalIdxs, gkyl_mat_triples *tri) 
{ 
  // epsilon: permittivity.
  // kSq: wave number squared (factor multiplying phi).
  // dx: cell length in each direction.
  // bcVals[3]: values to impose as BCs, i.e. bcVals[0]*phi+bcVals[1]*d(phi)/dx=bcVals[2].
  // globalIdxs: global linear index of each basis function/node in current cell.
  // tri: triples object (i,j,val), i.e. contribute val to i,j element of the global matrix.

  double rdx2Sq[1];
  rdx2Sq[0] = 4.0/(dx[0]*dx[0]);

  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[0], (-0.1957600456294712*kSq[2])+0.2449489742783178*kSq[1]+1.166666666666667*epsilon[0]*rdx2Sq[0]-0.1885618083164128*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[1], (-0.03011693009684172*kSq[2])+0.1632993161855452*kSq[1]-1.333333333333333*epsilon[0]*rdx2Sq[0]-0.09428090415820636*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[2], 0.01505846504842086*kSq[2]+0.1666666666666667*epsilon[0]*rdx2Sq[0]+0.04714045207910317*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[0], (-0.03011693009684171*kSq[2])+0.1632993161855452*kSq[1]-1.333333333333333*epsilon[0]*rdx2Sq[0]-0.09428090415820635*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[1], 0.4818708815494677*kSq[2]+2.666666666666667*epsilon[0]*rdx2Sq[0]-0.7542472332656511*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[2], (-0.03011693009684171*kSq[2])-0.1632993161855452*kSq[1]-1.333333333333333*epsilon[0]*rdx2Sq[0]-0.09428090415820635*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[0], 0.01505846504842086*kSq[2]+0.1666666666666667*epsilon[0]*rdx2Sq[0]+0.04714045207910317*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[1], (-0.03011693009684172*kSq[2])-0.1632993161855452*kSq[1]-1.333333333333333*epsilon[0]*rdx2Sq[0]-0.09428090415820636*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[2], (-0.1957600456294712*kSq[2])-0.2449489742783178*kSq[1]+1.166666666666667*epsilon[0]*rdx2Sq[0]-0.1885618083164128*kSq[0]);

}
void fem_poisson_lhs_stencil_consteps_1x_ser_p1_upx_robinx(const double *epsilon, const double *kSq, const double *dx, const double *bcVals, const long *globalIdxs, gkyl_mat_triples *tri) 
{ 
  // epsilon: permittivity.
  // kSq: wave number squared (factor multiplying phi).
  // dx: cell length in each direction.
  // bcVals[3]: values to impose as BCs, i.e. bcVals[0]*phi+bcVals[1]*d(phi)/dx=bcVals[2].
  // globalIdxs: global linear index of each basis function/node in current cell.
  // tri: triples object (i,j,val), i.e. contribute val to i,j element of the global matrix.

  double rdx2Sq[1];
  rdx2Sq[0] = 4.0/(dx[0]*dx[0]);

  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[0], 0.408248290463863*kSq[1]+0.5*epsilon[0]*rdx2Sq[0]-0.4714045207910318*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[1], (-0.5*epsilon[0]*rdx2Sq[0])-0.2357022603955158*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[0], (-0.5*epsilon[0]*rdx2Sq[0])-0.2357022603955158*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[1], (1.0*epsilon[0]*rdx2Sq[0]*bcVals[3])/bcVals[4]-0.408248290463863*kSq[1]+0.5*epsilon[0]*rdx2Sq[0]-0.4714045207910318*kSq[0]);

}
void fem_poisson_lhs_stencil_consteps_1x_ser_p2_upx_robinx(const double *epsilon, const double *kSq, const double *dx, const double *bcVals, const long *globalIdxs, gkyl_mat_triples *tri) 
{ 
  // epsilon: permittivity.
  // kSq: wave number squared (factor multiplying phi).
  // dx: cell length in each direction.
  // bcVals[3]: values to impose as BCs, i.e. bcVals[0]*phi+bcVals[1]*d(phi)/dx=bcVals[2].
  // globalIdxs: global linear index of each basis function/node in current cell.
  // tri: triples object (i,j,val), i.e. contribute val to i,j element of the global matrix.

  double rdx2Sq[1];
  rdx2Sq[0] = 4.0/(dx[0]*dx[0]);

  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[0], (-0.1957600456294712*kSq[2])+0.2449489742783178*kSq[1]+1.166666666666667*epsilon[0]*rdx2Sq[0]-0.1885618083164128*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[1], (-0.03011693009684172*kSq[2])+0.1632993161855452*kSq[1]-1.333333333333333*epsilon[0]*rdx2Sq[0]-0.09428090415820636*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[2], 0.01505846504842086*kSq[2]+0.1666666666666667*epsilon[0]*rdx2Sq[0]+0.04714045207910317*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[0], (-0.03011693009684171*kSq[2])+0.1632993161855452*kSq[1]-1.333333333333333*epsilon[0]*rdx2Sq[0]-0.09428090415820635*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[1], 0.4818708815494677*kSq[2]+2.666666666666667*epsilon[0]*rdx2Sq[0]-0.7542472332656511*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[2], (-0.03011693009684171*kSq[2])-0.1632993161855452*kSq[1]-1.333333333333333*epsilon[0]*rdx2Sq[0]-0.09428090415820635*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[0], 0.01505846504842086*kSq[2]+0.1666666666666667*epsilon[0]*rdx2Sq[0]+0.04714045207910317*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[1], (-0.03011693009684172*kSq[2])-0.1632993161855452*kSq[1]-1.333333333333333*epsilon[0]*rdx2Sq[0]-0.09428090415820636*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[2], (1.0*epsilon[0]*rdx2Sq[0]*bcVals[3])/bcVals[4]-0.1957600456294712*kSq[2]-0.2449489742783178*kSq[1]+1.166666666666667*epsilon[0]*rdx2Sq[0]-0.1885618083164128*kSq[0]);

}
void fem_poisson_lhs_stencil_consteps_2x_ser_p1_inx_periodicx_iny_periodicy(const double *epsilon, const double *kSq, const double *dx, const double *bcVals, const long *globalIdxs, gkyl_mat_triples *tri) 
{ 
  // epsilon: permittivity.
  // kSq: wave number squared (factor multiplying phi).
  // dx: cell length in each direction.
  // bcVals[3]: values to impose as BCs, i.e. bcVals[0]*phi+bcVals[1]*d(phi)/dx=bcVals[2].
  // globalIdxs: global linear index of each basis function/node in current cell.
  // tri: triples object (i,j,val), i.e. contribute val to i,j element of the global matrix.

  double rdx2Sq[2];
  rdx2Sq[0] = 4.0/(dx[0]*dx[0]);
  rdx2Sq[1] = 4.0/(dx[1]*dx[1]);

  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[0], (-0.1666666666666667*kSq[3])+0.1924500897298752*kSq[2]+0.3333333333333333*epsilon[0]*rdx2Sq[1]+0.1924500897298752*kSq[1]+0.3333333333333333*epsilon[0]*rdx2Sq[0]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[1], 0.09622504486493762*kSq[2]+0.1666666666666667*epsilon[0]*rdx2Sq[1]-0.3333333333333333*epsilon[0]*rdx2Sq[0]-0.1111111111111111*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[2], (-0.3333333333333333*epsilon[0]*rdx2Sq[1])+0.09622504486493762*kSq[1]+0.1666666666666667*epsilon[0]*rdx2Sq[0]-0.1111111111111111*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[3], (-0.1666666666666667*epsilon[0]*rdx2Sq[1])-0.1666666666666667*epsilon[0]*rdx2Sq[0]-0.05555555555555555*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[0], 0.09622504486493762*kSq[2]+0.1666666666666667*epsilon[0]*rdx2Sq[1]-0.3333333333333333*epsilon[0]*rdx2Sq[0]-0.1111111111111111*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[1], 0.1666666666666667*kSq[3]+0.1924500897298752*kSq[2]+0.3333333333333333*epsilon[0]*rdx2Sq[1]-0.1924500897298752*kSq[1]+0.3333333333333333*epsilon[0]*rdx2Sq[0]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[2], (-0.1666666666666667*epsilon[0]*rdx2Sq[1])-0.1666666666666667*epsilon[0]*rdx2Sq[0]-0.05555555555555555*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[3], (-0.3333333333333333*epsilon[0]*rdx2Sq[1])-0.09622504486493762*kSq[1]+0.1666666666666667*epsilon[0]*rdx2Sq[0]-0.1111111111111111*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[0], (-0.3333333333333333*epsilon[0]*rdx2Sq[1])+0.09622504486493762*kSq[1]+0.1666666666666667*epsilon[0]*rdx2Sq[0]-0.1111111111111111*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[1], (-0.1666666666666667*epsilon[0]*rdx2Sq[1])-0.1666666666666667*epsilon[0]*rdx2Sq[0]-0.05555555555555555*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[2], 0.1666666666666667*kSq[3]-0.1924500897298752*kSq[2]+0.3333333333333333*epsilon[0]*rdx2Sq[1]+0.1924500897298752*kSq[1]+0.3333333333333333*epsilon[0]*rdx2Sq[0]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[3], (-0.09622504486493762*kSq[2])+0.1666666666666667*epsilon[0]*rdx2Sq[1]-0.3333333333333333*epsilon[0]*rdx2Sq[0]-0.1111111111111111*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[0], (-0.1666666666666667*epsilon[0]*rdx2Sq[1])-0.1666666666666667*epsilon[0]*rdx2Sq[0]-0.05555555555555555*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[1], (-0.3333333333333333*epsilon[0]*rdx2Sq[1])-0.09622504486493762*kSq[1]+0.1666666666666667*epsilon[0]*rdx2Sq[0]-0.1111111111111111*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[2], (-0.09622504486493762*kSq[2])+0.1666666666666667*epsilon[0]*rdx2Sq[1]-0.3333333333333333*epsilon[0]*rdx2Sq[0]-0.1111111111111111*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[3], (-0.1666666666666667*kSq[3])-0.1924500897298752*kSq[2]+0.3333333333333333*epsilon[0]*rdx2Sq[1]-0.1924500897298752*kSq[1]+0.3333333333333333*epsilon[0]*rdx2Sq[0]-0.2222222222222222*kSq[0]);

}
void fem_poisson_lhs_stencil_consteps_2x_ser_p2_inx_periodicx_iny_periodicy(const double *epsilon, const double *kSq, const double *dx, const double *bcVals, const long *globalIdxs, gkyl_mat_triples *tri) 
{ 
  // epsilon: permittivity.
  // kSq: wave number squared (factor multiplying phi).
  // dx: cell length in each direction.
  // bcVals[3]: values to impose as BCs, i.e. bcVals[0]*phi+bcVals[1]*d(phi)/dx=bcVals[2].
  // globalIdxs: global linear index of each basis function/node in current cell.
  // tri: triples object (i,j,val), i.e. contribute val to i,j element of the global matrix.

  double rdx2Sq[2];
  rdx2Sq[0] = 4.0/(dx[0]*dx[0]);
  rdx2Sq[1] = 4.0/(dx[1]*dx[1]);

  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[0], 0.04549218533640458*kSq[7]+0.04549218533640458*kSq[6]-0.0127775312999988*kSq[5]-0.0127775312999988*kSq[4]-0.04666666666666667*kSq[3]+0.03849001794597505*kSq[2]+0.5777777777777777*epsilon[0]*rdx2Sq[1]+0.03849001794597505*kSq[1]+0.5777777777777777*epsilon[0]*rdx2Sq[0]-0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[1], 0.03442651863295482*kSq[7]+0.0295084445425327*kSq[6]-0.05962847939999439*kSq[5]-0.063887656499994*kSq[4]-0.05333333333333333*kSq[3]+0.06666666666666667*epsilon[0]*rdx2Sq[1]+0.03849001794597505*kSq[1]-0.8888888888888888*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[2], (-0.006147592613027645*kSq[6])+0.03336355394999686*kSq[5]+0.02697478829999747*kSq[4]-0.01924500897298752*kSq[2]+0.1888888888888889*epsilon[0]*rdx2Sq[1]+0.3111111111111111*epsilon[0]*rdx2Sq[0]-0.02222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[3], 0.0295084445425327*kSq[7]+0.03442651863295482*kSq[6]-0.063887656499994*kSq[5]-0.05962847939999439*kSq[4]-0.05333333333333333*kSq[3]+0.03849001794597505*kSq[2]-0.8888888888888888*epsilon[0]*rdx2Sq[1]+0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[4], (-0.01721325931647741*kSq[7])-0.05678902799999467*kSq[5]-0.03975231959999626*kSq[4]-0.01333333333333333*kSq[3]-0.4444444444444444*epsilon[0]*rdx2Sq[1]+0.03849001794597505*kSq[1]-0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[5], (-0.006147592613027645*kSq[7])+0.02697478829999747*kSq[5]+0.03336355394999686*kSq[4]+0.3111111111111111*epsilon[0]*rdx2Sq[1]-0.01924500897298752*kSq[1]+0.1888888888888889*epsilon[0]*rdx2Sq[0]-0.02222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[6], (-0.01721325931647741*kSq[6])-0.03975231959999626*kSq[5]-0.05678902799999467*kSq[4]-0.01333333333333333*kSq[3]+0.03849001794597505*kSq[2]-0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.4444444444444444*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[7], 0.0234254740499978*kSq[5]+0.0234254740499978*kSq[4]+0.01333333333333333*kSq[3]+0.2555555555555555*epsilon[0]*rdx2Sq[1]+0.2555555555555555*epsilon[0]*rdx2Sq[0]-0.03333333333333333*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[0], 0.03442651863295482*kSq[7]+0.0295084445425327*kSq[6]-0.05962847939999439*kSq[5]-0.063887656499994*kSq[4]-0.05333333333333333*kSq[3]+0.06666666666666667*epsilon[0]*rdx2Sq[1]+0.03849001794597505*kSq[1]-0.8888888888888888*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[1], (-0.1967229636168847*kSq[6])-0.07950463919999252*kSq[5]+0.2271561119999787*kSq[4]+0.3079201435678004*kSq[2]+0.5333333333333333*epsilon[0]*rdx2Sq[1]+1.777777777777778*epsilon[0]*rdx2Sq[0]-0.3555555555555556*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[2], (-0.03442651863295482*kSq[7])+0.0295084445425327*kSq[6]-0.05962847939999439*kSq[5]-0.063887656499994*kSq[4]+0.05333333333333333*kSq[3]+0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.03849001794597505*kSq[1]-0.8888888888888888*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[3], (-0.03442651863295482*kSq[7])-0.03442651863295482*kSq[6]+0.09938079899999068*kSq[5]+0.09938079899999068*kSq[4]-0.02666666666666666*kSq[3]+0.0769800358919501*kSq[2]+0.0769800358919501*kSq[1]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[4], 0.03442651863295482*kSq[7]-0.03442651863295482*kSq[6]+0.09938079899999068*kSq[5]+0.09938079899999068*kSq[4]+0.02666666666666666*kSq[3]+0.0769800358919501*kSq[2]-0.0769800358919501*kSq[1]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[5], 0.01721325931647741*kSq[6]-0.03975231959999626*kSq[5]-0.05678902799999467*kSq[4]+0.01333333333333333*kSq[3]-0.03849001794597505*kSq[2]-0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.4444444444444444*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[6], 0.07950463919999252*kSq[5]+0.1135780559999893*kSq[4]-0.5333333333333333*epsilon[0]*rdx2Sq[1]+0.8888888888888888*epsilon[0]*rdx2Sq[0]-0.1777777777777778*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[7], 0.01721325931647741*kSq[6]-0.03975231959999626*kSq[5]-0.05678902799999467*kSq[4]-0.01333333333333333*kSq[3]-0.03849001794597505*kSq[2]-0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.4444444444444444*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[0], (-0.006147592613027645*kSq[6])+0.03336355394999686*kSq[5]+0.02697478829999747*kSq[4]-0.01924500897298752*kSq[2]+0.1888888888888889*epsilon[0]*rdx2Sq[1]+0.3111111111111111*epsilon[0]*rdx2Sq[0]-0.02222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[1], (-0.03442651863295482*kSq[7])+0.0295084445425327*kSq[6]-0.05962847939999439*kSq[5]-0.063887656499994*kSq[4]+0.05333333333333333*kSq[3]+0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.03849001794597505*kSq[1]-0.8888888888888888*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[2], (-0.04549218533640458*kSq[7])+0.04549218533640458*kSq[6]-0.0127775312999988*kSq[5]-0.0127775312999988*kSq[4]+0.04666666666666667*kSq[3]+0.03849001794597505*kSq[2]+0.5777777777777777*epsilon[0]*rdx2Sq[1]-0.03849001794597505*kSq[1]+0.5777777777777777*epsilon[0]*rdx2Sq[0]-0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[3], 0.01721325931647741*kSq[7]-0.05678902799999467*kSq[5]-0.03975231959999626*kSq[4]+0.01333333333333333*kSq[3]-0.4444444444444444*epsilon[0]*rdx2Sq[1]-0.03849001794597505*kSq[1]-0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[4], (-0.0295084445425327*kSq[7])+0.03442651863295482*kSq[6]-0.063887656499994*kSq[5]-0.05962847939999439*kSq[4]+0.05333333333333333*kSq[3]+0.03849001794597505*kSq[2]-0.8888888888888888*epsilon[0]*rdx2Sq[1]+0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[5], 0.0234254740499978*kSq[5]+0.0234254740499978*kSq[4]-0.01333333333333333*kSq[3]+0.2555555555555555*epsilon[0]*rdx2Sq[1]+0.2555555555555555*epsilon[0]*rdx2Sq[0]-0.03333333333333333*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[6], (-0.01721325931647741*kSq[6])-0.03975231959999626*kSq[5]-0.05678902799999467*kSq[4]+0.01333333333333333*kSq[3]+0.03849001794597505*kSq[2]-0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.4444444444444444*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[7], 0.006147592613027645*kSq[7]+0.02697478829999747*kSq[5]+0.03336355394999686*kSq[4]+0.3111111111111111*epsilon[0]*rdx2Sq[1]+0.01924500897298752*kSq[1]+0.1888888888888889*epsilon[0]*rdx2Sq[0]-0.02222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[0], 0.0295084445425327*kSq[7]+0.03442651863295482*kSq[6]-0.063887656499994*kSq[5]-0.05962847939999439*kSq[4]-0.05333333333333333*kSq[3]+0.03849001794597505*kSq[2]-0.8888888888888888*epsilon[0]*rdx2Sq[1]+0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[1], (-0.03442651863295482*kSq[7])-0.03442651863295482*kSq[6]+0.09938079899999068*kSq[5]+0.09938079899999068*kSq[4]-0.02666666666666666*kSq[3]+0.0769800358919501*kSq[2]+0.0769800358919501*kSq[1]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[2], 0.01721325931647741*kSq[7]-0.05678902799999467*kSq[5]-0.03975231959999626*kSq[4]+0.01333333333333333*kSq[3]-0.4444444444444444*epsilon[0]*rdx2Sq[1]-0.03849001794597505*kSq[1]-0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[3], (-0.1967229636168847*kSq[7])+0.2271561119999787*kSq[5]-0.07950463919999252*kSq[4]+1.777777777777778*epsilon[0]*rdx2Sq[1]+0.3079201435678004*kSq[1]+0.5333333333333333*epsilon[0]*rdx2Sq[0]-0.3555555555555556*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[4], 0.1135780559999893*kSq[5]+0.07950463919999252*kSq[4]+0.8888888888888888*epsilon[0]*rdx2Sq[1]-0.5333333333333333*epsilon[0]*rdx2Sq[0]-0.1777777777777778*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[5], 0.0295084445425327*kSq[7]-0.03442651863295482*kSq[6]-0.063887656499994*kSq[5]-0.05962847939999439*kSq[4]+0.05333333333333333*kSq[3]-0.03849001794597505*kSq[2]-0.8888888888888888*epsilon[0]*rdx2Sq[1]+0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[6], (-0.03442651863295482*kSq[7])+0.03442651863295482*kSq[6]+0.09938079899999068*kSq[5]+0.09938079899999068*kSq[4]+0.02666666666666666*kSq[3]-0.0769800358919501*kSq[2]+0.0769800358919501*kSq[1]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[7], 0.01721325931647741*kSq[7]-0.05678902799999467*kSq[5]-0.03975231959999626*kSq[4]-0.01333333333333333*kSq[3]-0.4444444444444444*epsilon[0]*rdx2Sq[1]-0.03849001794597505*kSq[1]-0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[4], globalIdxs[0], (-0.01721325931647741*kSq[7])-0.05678902799999467*kSq[5]-0.03975231959999626*kSq[4]-0.01333333333333333*kSq[3]-0.4444444444444444*epsilon[0]*rdx2Sq[1]+0.03849001794597505*kSq[1]-0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[4], globalIdxs[1], 0.03442651863295482*kSq[7]-0.03442651863295482*kSq[6]+0.09938079899999068*kSq[5]+0.09938079899999068*kSq[4]+0.02666666666666666*kSq[3]+0.0769800358919501*kSq[2]-0.0769800358919501*kSq[1]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[4], globalIdxs[2], (-0.0295084445425327*kSq[7])+0.03442651863295482*kSq[6]-0.063887656499994*kSq[5]-0.05962847939999439*kSq[4]+0.05333333333333333*kSq[3]+0.03849001794597505*kSq[2]-0.8888888888888888*epsilon[0]*rdx2Sq[1]+0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[4], globalIdxs[3], 0.1135780559999893*kSq[5]+0.07950463919999252*kSq[4]+0.8888888888888888*epsilon[0]*rdx2Sq[1]-0.5333333333333333*epsilon[0]*rdx2Sq[0]-0.1777777777777778*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[4], globalIdxs[4], 0.1967229636168847*kSq[7]+0.2271561119999787*kSq[5]-0.07950463919999252*kSq[4]+1.777777777777778*epsilon[0]*rdx2Sq[1]-0.3079201435678004*kSq[1]+0.5333333333333333*epsilon[0]*rdx2Sq[0]-0.3555555555555556*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[4], globalIdxs[5], (-0.01721325931647741*kSq[7])-0.05678902799999467*kSq[5]-0.03975231959999626*kSq[4]+0.01333333333333333*kSq[3]-0.4444444444444444*epsilon[0]*rdx2Sq[1]+0.03849001794597505*kSq[1]-0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[4], globalIdxs[6], 0.03442651863295482*kSq[7]+0.03442651863295482*kSq[6]+0.09938079899999068*kSq[5]+0.09938079899999068*kSq[4]-0.02666666666666666*kSq[3]-0.0769800358919501*kSq[2]-0.0769800358919501*kSq[1]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[4], globalIdxs[7], (-0.0295084445425327*kSq[7])-0.03442651863295482*kSq[6]-0.063887656499994*kSq[5]-0.05962847939999439*kSq[4]-0.05333333333333333*kSq[3]-0.03849001794597505*kSq[2]-0.8888888888888888*epsilon[0]*rdx2Sq[1]+0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[5], globalIdxs[0], (-0.006147592613027645*kSq[7])+0.02697478829999747*kSq[5]+0.03336355394999686*kSq[4]+0.3111111111111111*epsilon[0]*rdx2Sq[1]-0.01924500897298752*kSq[1]+0.1888888888888889*epsilon[0]*rdx2Sq[0]-0.02222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[5], globalIdxs[1], 0.01721325931647741*kSq[6]-0.03975231959999626*kSq[5]-0.05678902799999467*kSq[4]+0.01333333333333333*kSq[3]-0.03849001794597505*kSq[2]-0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.4444444444444444*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[5], globalIdxs[2], 0.0234254740499978*kSq[5]+0.0234254740499978*kSq[4]-0.01333333333333333*kSq[3]+0.2555555555555555*epsilon[0]*rdx2Sq[1]+0.2555555555555555*epsilon[0]*rdx2Sq[0]-0.03333333333333333*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[5], globalIdxs[3], 0.0295084445425327*kSq[7]-0.03442651863295482*kSq[6]-0.063887656499994*kSq[5]-0.05962847939999439*kSq[4]+0.05333333333333333*kSq[3]-0.03849001794597505*kSq[2]-0.8888888888888888*epsilon[0]*rdx2Sq[1]+0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[5], globalIdxs[4], (-0.01721325931647741*kSq[7])-0.05678902799999467*kSq[5]-0.03975231959999626*kSq[4]+0.01333333333333333*kSq[3]-0.4444444444444444*epsilon[0]*rdx2Sq[1]+0.03849001794597505*kSq[1]-0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[5], globalIdxs[5], 0.04549218533640458*kSq[7]-0.04549218533640458*kSq[6]-0.0127775312999988*kSq[5]-0.0127775312999988*kSq[4]+0.04666666666666667*kSq[3]-0.03849001794597505*kSq[2]+0.5777777777777777*epsilon[0]*rdx2Sq[1]+0.03849001794597505*kSq[1]+0.5777777777777777*epsilon[0]*rdx2Sq[0]-0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[5], globalIdxs[6], 0.03442651863295482*kSq[7]-0.0295084445425327*kSq[6]-0.05962847939999439*kSq[5]-0.063887656499994*kSq[4]+0.05333333333333333*kSq[3]+0.06666666666666667*epsilon[0]*rdx2Sq[1]+0.03849001794597505*kSq[1]-0.8888888888888888*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[5], globalIdxs[7], 0.006147592613027645*kSq[6]+0.03336355394999686*kSq[5]+0.02697478829999747*kSq[4]+0.01924500897298752*kSq[2]+0.1888888888888889*epsilon[0]*rdx2Sq[1]+0.3111111111111111*epsilon[0]*rdx2Sq[0]-0.02222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[6], globalIdxs[0], (-0.01721325931647741*kSq[6])-0.03975231959999626*kSq[5]-0.05678902799999467*kSq[4]-0.01333333333333333*kSq[3]+0.03849001794597505*kSq[2]-0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.4444444444444444*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[6], globalIdxs[1], 0.07950463919999252*kSq[5]+0.1135780559999893*kSq[4]-0.5333333333333333*epsilon[0]*rdx2Sq[1]+0.8888888888888888*epsilon[0]*rdx2Sq[0]-0.1777777777777778*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[6], globalIdxs[2], (-0.01721325931647741*kSq[6])-0.03975231959999626*kSq[5]-0.05678902799999467*kSq[4]+0.01333333333333333*kSq[3]+0.03849001794597505*kSq[2]-0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.4444444444444444*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[6], globalIdxs[3], (-0.03442651863295482*kSq[7])+0.03442651863295482*kSq[6]+0.09938079899999068*kSq[5]+0.09938079899999068*kSq[4]+0.02666666666666666*kSq[3]-0.0769800358919501*kSq[2]+0.0769800358919501*kSq[1]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[6], globalIdxs[4], 0.03442651863295482*kSq[7]+0.03442651863295482*kSq[6]+0.09938079899999068*kSq[5]+0.09938079899999068*kSq[4]-0.02666666666666666*kSq[3]-0.0769800358919501*kSq[2]-0.0769800358919501*kSq[1]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[6], globalIdxs[5], 0.03442651863295482*kSq[7]-0.0295084445425327*kSq[6]-0.05962847939999439*kSq[5]-0.063887656499994*kSq[4]+0.05333333333333333*kSq[3]+0.06666666666666667*epsilon[0]*rdx2Sq[1]+0.03849001794597505*kSq[1]-0.8888888888888888*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[6], globalIdxs[6], 0.1967229636168847*kSq[6]-0.07950463919999252*kSq[5]+0.2271561119999787*kSq[4]-0.3079201435678004*kSq[2]+0.5333333333333333*epsilon[0]*rdx2Sq[1]+1.777777777777778*epsilon[0]*rdx2Sq[0]-0.3555555555555556*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[6], globalIdxs[7], (-0.03442651863295482*kSq[7])-0.0295084445425327*kSq[6]-0.05962847939999439*kSq[5]-0.063887656499994*kSq[4]-0.05333333333333333*kSq[3]+0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.03849001794597505*kSq[1]-0.8888888888888888*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[7], globalIdxs[0], 0.0234254740499978*kSq[5]+0.0234254740499978*kSq[4]+0.01333333333333333*kSq[3]+0.2555555555555555*epsilon[0]*rdx2Sq[1]+0.2555555555555555*epsilon[0]*rdx2Sq[0]-0.03333333333333333*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[7], globalIdxs[1], 0.01721325931647741*kSq[6]-0.03975231959999626*kSq[5]-0.05678902799999467*kSq[4]-0.01333333333333333*kSq[3]-0.03849001794597505*kSq[2]-0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.4444444444444444*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[7], globalIdxs[2], 0.006147592613027645*kSq[7]+0.02697478829999747*kSq[5]+0.03336355394999686*kSq[4]+0.3111111111111111*epsilon[0]*rdx2Sq[1]+0.01924500897298752*kSq[1]+0.1888888888888889*epsilon[0]*rdx2Sq[0]-0.02222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[7], globalIdxs[3], 0.01721325931647741*kSq[7]-0.05678902799999467*kSq[5]-0.03975231959999626*kSq[4]-0.01333333333333333*kSq[3]-0.4444444444444444*epsilon[0]*rdx2Sq[1]-0.03849001794597505*kSq[1]-0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[7], globalIdxs[4], (-0.0295084445425327*kSq[7])-0.03442651863295482*kSq[6]-0.063887656499994*kSq[5]-0.05962847939999439*kSq[4]-0.05333333333333333*kSq[3]-0.03849001794597505*kSq[2]-0.8888888888888888*epsilon[0]*rdx2Sq[1]+0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[7], globalIdxs[5], 0.006147592613027645*kSq[6]+0.03336355394999686*kSq[5]+0.02697478829999747*kSq[4]+0.01924500897298752*kSq[2]+0.1888888888888889*epsilon[0]*rdx2Sq[1]+0.3111111111111111*epsilon[0]*rdx2Sq[0]-0.02222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[7], globalIdxs[6], (-0.03442651863295482*kSq[7])-0.0295084445425327*kSq[6]-0.05962847939999439*kSq[5]-0.063887656499994*kSq[4]-0.05333333333333333*kSq[3]+0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.03849001794597505*kSq[1]-0.8888888888888888*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[7], globalIdxs[7], (-0.04549218533640458*kSq[7])-0.04549218533640458*kSq[6]-0.0127775312999988*kSq[5]-0.0127775312999988*kSq[4]-0.04666666666666667*kSq[3]-0.03849001794597505*kSq[2]+0.5777777777777777*epsilon[0]*rdx2Sq[1]-0.03849001794597505*kSq[1]+0.5777777777777777*epsilon[0]*rdx2Sq[0]-0.06666666666666667*kSq[0]);

}
void fem_poisson_lhs_stencil_consteps_2x_ser_p1_lox_periodicx_iny_periodicy(const double *epsilon, const double *kSq, const double *dx, const double *bcVals, const long *globalIdxs, gkyl_mat_triples *tri) 
{ 
  // epsilon: permittivity.
  // kSq: wave number squared (factor multiplying phi).
  // dx: cell length in each direction.
  // bcVals[3]: values to impose as BCs, i.e. bcVals[0]*phi+bcVals[1]*d(phi)/dx=bcVals[2].
  // globalIdxs: global linear index of each basis function/node in current cell.
  // tri: triples object (i,j,val), i.e. contribute val to i,j element of the global matrix.

  double rdx2Sq[2];
  rdx2Sq[0] = 4.0/(dx[0]*dx[0]);
  rdx2Sq[1] = 4.0/(dx[1]*dx[1]);

  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[0], (-0.1666666666666667*kSq[3])+0.1924500897298752*kSq[2]+0.3333333333333333*epsilon[0]*rdx2Sq[1]+0.1924500897298752*kSq[1]+0.3333333333333333*epsilon[0]*rdx2Sq[0]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[1], 0.09622504486493762*kSq[2]+0.1666666666666667*epsilon[0]*rdx2Sq[1]-0.3333333333333333*epsilon[0]*rdx2Sq[0]-0.1111111111111111*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[2], (-0.3333333333333333*epsilon[0]*rdx2Sq[1])+0.09622504486493762*kSq[1]+0.1666666666666667*epsilon[0]*rdx2Sq[0]-0.1111111111111111*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[3], (-0.1666666666666667*epsilon[0]*rdx2Sq[1])-0.1666666666666667*epsilon[0]*rdx2Sq[0]-0.05555555555555555*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[0], 0.09622504486493762*kSq[2]+0.1666666666666667*epsilon[0]*rdx2Sq[1]-0.3333333333333333*epsilon[0]*rdx2Sq[0]-0.1111111111111111*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[1], 0.1666666666666667*kSq[3]+0.1924500897298752*kSq[2]+0.3333333333333333*epsilon[0]*rdx2Sq[1]-0.1924500897298752*kSq[1]+0.3333333333333333*epsilon[0]*rdx2Sq[0]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[2], (-0.1666666666666667*epsilon[0]*rdx2Sq[1])-0.1666666666666667*epsilon[0]*rdx2Sq[0]-0.05555555555555555*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[3], (-0.3333333333333333*epsilon[0]*rdx2Sq[1])-0.09622504486493762*kSq[1]+0.1666666666666667*epsilon[0]*rdx2Sq[0]-0.1111111111111111*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[0], (-0.3333333333333333*epsilon[0]*rdx2Sq[1])+0.09622504486493762*kSq[1]+0.1666666666666667*epsilon[0]*rdx2Sq[0]-0.1111111111111111*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[1], (-0.1666666666666667*epsilon[0]*rdx2Sq[1])-0.1666666666666667*epsilon[0]*rdx2Sq[0]-0.05555555555555555*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[2], 0.1666666666666667*kSq[3]-0.1924500897298752*kSq[2]+0.3333333333333333*epsilon[0]*rdx2Sq[1]+0.1924500897298752*kSq[1]+0.3333333333333333*epsilon[0]*rdx2Sq[0]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[3], (-0.09622504486493762*kSq[2])+0.1666666666666667*epsilon[0]*rdx2Sq[1]-0.3333333333333333*epsilon[0]*rdx2Sq[0]-0.1111111111111111*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[0], (-0.1666666666666667*epsilon[0]*rdx2Sq[1])-0.1666666666666667*epsilon[0]*rdx2Sq[0]-0.05555555555555555*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[1], (-0.3333333333333333*epsilon[0]*rdx2Sq[1])-0.09622504486493762*kSq[1]+0.1666666666666667*epsilon[0]*rdx2Sq[0]-0.1111111111111111*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[2], (-0.09622504486493762*kSq[2])+0.1666666666666667*epsilon[0]*rdx2Sq[1]-0.3333333333333333*epsilon[0]*rdx2Sq[0]-0.1111111111111111*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[3], (-0.1666666666666667*kSq[3])-0.1924500897298752*kSq[2]+0.3333333333333333*epsilon[0]*rdx2Sq[1]-0.1924500897298752*kSq[1]+0.3333333333333333*epsilon[0]*rdx2Sq[0]-0.2222222222222222*kSq[0]);

}
void fem_poisson_lhs_stencil_consteps_2x_ser_p2_lox_periodicx_iny_periodicy(const double *epsilon, const double *kSq, const double *dx, const double *bcVals, const long *globalIdxs, gkyl_mat_triples *tri) 
{ 
  // epsilon: permittivity.
  // kSq: wave number squared (factor multiplying phi).
  // dx: cell length in each direction.
  // bcVals[3]: values to impose as BCs, i.e. bcVals[0]*phi+bcVals[1]*d(phi)/dx=bcVals[2].
  // globalIdxs: global linear index of each basis function/node in current cell.
  // tri: triples object (i,j,val), i.e. contribute val to i,j element of the global matrix.

  double rdx2Sq[2];
  rdx2Sq[0] = 4.0/(dx[0]*dx[0]);
  rdx2Sq[1] = 4.0/(dx[1]*dx[1]);

  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[0], 0.04549218533640458*kSq[7]+0.04549218533640458*kSq[6]-0.0127775312999988*kSq[5]-0.0127775312999988*kSq[4]-0.04666666666666667*kSq[3]+0.03849001794597505*kSq[2]+0.5777777777777777*epsilon[0]*rdx2Sq[1]+0.03849001794597505*kSq[1]+0.5777777777777777*epsilon[0]*rdx2Sq[0]-0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[1], 0.03442651863295482*kSq[7]+0.0295084445425327*kSq[6]-0.05962847939999439*kSq[5]-0.063887656499994*kSq[4]-0.05333333333333333*kSq[3]+0.06666666666666667*epsilon[0]*rdx2Sq[1]+0.03849001794597505*kSq[1]-0.8888888888888888*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[2], (-0.006147592613027645*kSq[6])+0.03336355394999686*kSq[5]+0.02697478829999747*kSq[4]-0.01924500897298752*kSq[2]+0.1888888888888889*epsilon[0]*rdx2Sq[1]+0.3111111111111111*epsilon[0]*rdx2Sq[0]-0.02222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[3], 0.0295084445425327*kSq[7]+0.03442651863295482*kSq[6]-0.063887656499994*kSq[5]-0.05962847939999439*kSq[4]-0.05333333333333333*kSq[3]+0.03849001794597505*kSq[2]-0.8888888888888888*epsilon[0]*rdx2Sq[1]+0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[4], (-0.01721325931647741*kSq[7])-0.05678902799999467*kSq[5]-0.03975231959999626*kSq[4]-0.01333333333333333*kSq[3]-0.4444444444444444*epsilon[0]*rdx2Sq[1]+0.03849001794597505*kSq[1]-0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[5], (-0.006147592613027645*kSq[7])+0.02697478829999747*kSq[5]+0.03336355394999686*kSq[4]+0.3111111111111111*epsilon[0]*rdx2Sq[1]-0.01924500897298752*kSq[1]+0.1888888888888889*epsilon[0]*rdx2Sq[0]-0.02222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[6], (-0.01721325931647741*kSq[6])-0.03975231959999626*kSq[5]-0.05678902799999467*kSq[4]-0.01333333333333333*kSq[3]+0.03849001794597505*kSq[2]-0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.4444444444444444*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[7], 0.0234254740499978*kSq[5]+0.0234254740499978*kSq[4]+0.01333333333333333*kSq[3]+0.2555555555555555*epsilon[0]*rdx2Sq[1]+0.2555555555555555*epsilon[0]*rdx2Sq[0]-0.03333333333333333*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[0], 0.03442651863295482*kSq[7]+0.0295084445425327*kSq[6]-0.05962847939999439*kSq[5]-0.063887656499994*kSq[4]-0.05333333333333333*kSq[3]+0.06666666666666667*epsilon[0]*rdx2Sq[1]+0.03849001794597505*kSq[1]-0.8888888888888888*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[1], (-0.1967229636168847*kSq[6])-0.07950463919999252*kSq[5]+0.2271561119999787*kSq[4]+0.3079201435678004*kSq[2]+0.5333333333333333*epsilon[0]*rdx2Sq[1]+1.777777777777778*epsilon[0]*rdx2Sq[0]-0.3555555555555556*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[2], (-0.03442651863295482*kSq[7])+0.0295084445425327*kSq[6]-0.05962847939999439*kSq[5]-0.063887656499994*kSq[4]+0.05333333333333333*kSq[3]+0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.03849001794597505*kSq[1]-0.8888888888888888*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[3], (-0.03442651863295482*kSq[7])-0.03442651863295482*kSq[6]+0.09938079899999068*kSq[5]+0.09938079899999068*kSq[4]-0.02666666666666666*kSq[3]+0.0769800358919501*kSq[2]+0.0769800358919501*kSq[1]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[4], 0.03442651863295482*kSq[7]-0.03442651863295482*kSq[6]+0.09938079899999068*kSq[5]+0.09938079899999068*kSq[4]+0.02666666666666666*kSq[3]+0.0769800358919501*kSq[2]-0.0769800358919501*kSq[1]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[5], 0.01721325931647741*kSq[6]-0.03975231959999626*kSq[5]-0.05678902799999467*kSq[4]+0.01333333333333333*kSq[3]-0.03849001794597505*kSq[2]-0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.4444444444444444*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[6], 0.07950463919999252*kSq[5]+0.1135780559999893*kSq[4]-0.5333333333333333*epsilon[0]*rdx2Sq[1]+0.8888888888888888*epsilon[0]*rdx2Sq[0]-0.1777777777777778*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[7], 0.01721325931647741*kSq[6]-0.03975231959999626*kSq[5]-0.05678902799999467*kSq[4]-0.01333333333333333*kSq[3]-0.03849001794597505*kSq[2]-0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.4444444444444444*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[0], (-0.006147592613027645*kSq[6])+0.03336355394999686*kSq[5]+0.02697478829999747*kSq[4]-0.01924500897298752*kSq[2]+0.1888888888888889*epsilon[0]*rdx2Sq[1]+0.3111111111111111*epsilon[0]*rdx2Sq[0]-0.02222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[1], (-0.03442651863295482*kSq[7])+0.0295084445425327*kSq[6]-0.05962847939999439*kSq[5]-0.063887656499994*kSq[4]+0.05333333333333333*kSq[3]+0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.03849001794597505*kSq[1]-0.8888888888888888*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[2], (-0.04549218533640458*kSq[7])+0.04549218533640458*kSq[6]-0.0127775312999988*kSq[5]-0.0127775312999988*kSq[4]+0.04666666666666667*kSq[3]+0.03849001794597505*kSq[2]+0.5777777777777777*epsilon[0]*rdx2Sq[1]-0.03849001794597505*kSq[1]+0.5777777777777777*epsilon[0]*rdx2Sq[0]-0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[3], 0.01721325931647741*kSq[7]-0.05678902799999467*kSq[5]-0.03975231959999626*kSq[4]+0.01333333333333333*kSq[3]-0.4444444444444444*epsilon[0]*rdx2Sq[1]-0.03849001794597505*kSq[1]-0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[4], (-0.0295084445425327*kSq[7])+0.03442651863295482*kSq[6]-0.063887656499994*kSq[5]-0.05962847939999439*kSq[4]+0.05333333333333333*kSq[3]+0.03849001794597505*kSq[2]-0.8888888888888888*epsilon[0]*rdx2Sq[1]+0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[5], 0.0234254740499978*kSq[5]+0.0234254740499978*kSq[4]-0.01333333333333333*kSq[3]+0.2555555555555555*epsilon[0]*rdx2Sq[1]+0.2555555555555555*epsilon[0]*rdx2Sq[0]-0.03333333333333333*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[6], (-0.01721325931647741*kSq[6])-0.03975231959999626*kSq[5]-0.05678902799999467*kSq[4]+0.01333333333333333*kSq[3]+0.03849001794597505*kSq[2]-0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.4444444444444444*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[7], 0.006147592613027645*kSq[7]+0.02697478829999747*kSq[5]+0.03336355394999686*kSq[4]+0.3111111111111111*epsilon[0]*rdx2Sq[1]+0.01924500897298752*kSq[1]+0.1888888888888889*epsilon[0]*rdx2Sq[0]-0.02222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[0], 0.0295084445425327*kSq[7]+0.03442651863295482*kSq[6]-0.063887656499994*kSq[5]-0.05962847939999439*kSq[4]-0.05333333333333333*kSq[3]+0.03849001794597505*kSq[2]-0.8888888888888888*epsilon[0]*rdx2Sq[1]+0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[1], (-0.03442651863295482*kSq[7])-0.03442651863295482*kSq[6]+0.09938079899999068*kSq[5]+0.09938079899999068*kSq[4]-0.02666666666666666*kSq[3]+0.0769800358919501*kSq[2]+0.0769800358919501*kSq[1]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[2], 0.01721325931647741*kSq[7]-0.05678902799999467*kSq[5]-0.03975231959999626*kSq[4]+0.01333333333333333*kSq[3]-0.4444444444444444*epsilon[0]*rdx2Sq[1]-0.03849001794597505*kSq[1]-0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[3], (-0.1967229636168847*kSq[7])+0.2271561119999787*kSq[5]-0.07950463919999252*kSq[4]+1.777777777777778*epsilon[0]*rdx2Sq[1]+0.3079201435678004*kSq[1]+0.5333333333333333*epsilon[0]*rdx2Sq[0]-0.3555555555555556*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[4], 0.1135780559999893*kSq[5]+0.07950463919999252*kSq[4]+0.8888888888888888*epsilon[0]*rdx2Sq[1]-0.5333333333333333*epsilon[0]*rdx2Sq[0]-0.1777777777777778*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[5], 0.0295084445425327*kSq[7]-0.03442651863295482*kSq[6]-0.063887656499994*kSq[5]-0.05962847939999439*kSq[4]+0.05333333333333333*kSq[3]-0.03849001794597505*kSq[2]-0.8888888888888888*epsilon[0]*rdx2Sq[1]+0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[6], (-0.03442651863295482*kSq[7])+0.03442651863295482*kSq[6]+0.09938079899999068*kSq[5]+0.09938079899999068*kSq[4]+0.02666666666666666*kSq[3]-0.0769800358919501*kSq[2]+0.0769800358919501*kSq[1]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[7], 0.01721325931647741*kSq[7]-0.05678902799999467*kSq[5]-0.03975231959999626*kSq[4]-0.01333333333333333*kSq[3]-0.4444444444444444*epsilon[0]*rdx2Sq[1]-0.03849001794597505*kSq[1]-0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[4], globalIdxs[0], (-0.01721325931647741*kSq[7])-0.05678902799999467*kSq[5]-0.03975231959999626*kSq[4]-0.01333333333333333*kSq[3]-0.4444444444444444*epsilon[0]*rdx2Sq[1]+0.03849001794597505*kSq[1]-0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[4], globalIdxs[1], 0.03442651863295482*kSq[7]-0.03442651863295482*kSq[6]+0.09938079899999068*kSq[5]+0.09938079899999068*kSq[4]+0.02666666666666666*kSq[3]+0.0769800358919501*kSq[2]-0.0769800358919501*kSq[1]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[4], globalIdxs[2], (-0.0295084445425327*kSq[7])+0.03442651863295482*kSq[6]-0.063887656499994*kSq[5]-0.05962847939999439*kSq[4]+0.05333333333333333*kSq[3]+0.03849001794597505*kSq[2]-0.8888888888888888*epsilon[0]*rdx2Sq[1]+0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[4], globalIdxs[3], 0.1135780559999893*kSq[5]+0.07950463919999252*kSq[4]+0.8888888888888888*epsilon[0]*rdx2Sq[1]-0.5333333333333333*epsilon[0]*rdx2Sq[0]-0.1777777777777778*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[4], globalIdxs[4], 0.1967229636168847*kSq[7]+0.2271561119999787*kSq[5]-0.07950463919999252*kSq[4]+1.777777777777778*epsilon[0]*rdx2Sq[1]-0.3079201435678004*kSq[1]+0.5333333333333333*epsilon[0]*rdx2Sq[0]-0.3555555555555556*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[4], globalIdxs[5], (-0.01721325931647741*kSq[7])-0.05678902799999467*kSq[5]-0.03975231959999626*kSq[4]+0.01333333333333333*kSq[3]-0.4444444444444444*epsilon[0]*rdx2Sq[1]+0.03849001794597505*kSq[1]-0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[4], globalIdxs[6], 0.03442651863295482*kSq[7]+0.03442651863295482*kSq[6]+0.09938079899999068*kSq[5]+0.09938079899999068*kSq[4]-0.02666666666666666*kSq[3]-0.0769800358919501*kSq[2]-0.0769800358919501*kSq[1]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[4], globalIdxs[7], (-0.0295084445425327*kSq[7])-0.03442651863295482*kSq[6]-0.063887656499994*kSq[5]-0.05962847939999439*kSq[4]-0.05333333333333333*kSq[3]-0.03849001794597505*kSq[2]-0.8888888888888888*epsilon[0]*rdx2Sq[1]+0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[5], globalIdxs[0], (-0.006147592613027645*kSq[7])+0.02697478829999747*kSq[5]+0.03336355394999686*kSq[4]+0.3111111111111111*epsilon[0]*rdx2Sq[1]-0.01924500897298752*kSq[1]+0.1888888888888889*epsilon[0]*rdx2Sq[0]-0.02222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[5], globalIdxs[1], 0.01721325931647741*kSq[6]-0.03975231959999626*kSq[5]-0.05678902799999467*kSq[4]+0.01333333333333333*kSq[3]-0.03849001794597505*kSq[2]-0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.4444444444444444*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[5], globalIdxs[2], 0.0234254740499978*kSq[5]+0.0234254740499978*kSq[4]-0.01333333333333333*kSq[3]+0.2555555555555555*epsilon[0]*rdx2Sq[1]+0.2555555555555555*epsilon[0]*rdx2Sq[0]-0.03333333333333333*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[5], globalIdxs[3], 0.0295084445425327*kSq[7]-0.03442651863295482*kSq[6]-0.063887656499994*kSq[5]-0.05962847939999439*kSq[4]+0.05333333333333333*kSq[3]-0.03849001794597505*kSq[2]-0.8888888888888888*epsilon[0]*rdx2Sq[1]+0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[5], globalIdxs[4], (-0.01721325931647741*kSq[7])-0.05678902799999467*kSq[5]-0.03975231959999626*kSq[4]+0.01333333333333333*kSq[3]-0.4444444444444444*epsilon[0]*rdx2Sq[1]+0.03849001794597505*kSq[1]-0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[5], globalIdxs[5], 0.04549218533640458*kSq[7]-0.04549218533640458*kSq[6]-0.0127775312999988*kSq[5]-0.0127775312999988*kSq[4]+0.04666666666666667*kSq[3]-0.03849001794597505*kSq[2]+0.5777777777777777*epsilon[0]*rdx2Sq[1]+0.03849001794597505*kSq[1]+0.5777777777777777*epsilon[0]*rdx2Sq[0]-0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[5], globalIdxs[6], 0.03442651863295482*kSq[7]-0.0295084445425327*kSq[6]-0.05962847939999439*kSq[5]-0.063887656499994*kSq[4]+0.05333333333333333*kSq[3]+0.06666666666666667*epsilon[0]*rdx2Sq[1]+0.03849001794597505*kSq[1]-0.8888888888888888*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[5], globalIdxs[7], 0.006147592613027645*kSq[6]+0.03336355394999686*kSq[5]+0.02697478829999747*kSq[4]+0.01924500897298752*kSq[2]+0.1888888888888889*epsilon[0]*rdx2Sq[1]+0.3111111111111111*epsilon[0]*rdx2Sq[0]-0.02222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[6], globalIdxs[0], (-0.01721325931647741*kSq[6])-0.03975231959999626*kSq[5]-0.05678902799999467*kSq[4]-0.01333333333333333*kSq[3]+0.03849001794597505*kSq[2]-0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.4444444444444444*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[6], globalIdxs[1], 0.07950463919999252*kSq[5]+0.1135780559999893*kSq[4]-0.5333333333333333*epsilon[0]*rdx2Sq[1]+0.8888888888888888*epsilon[0]*rdx2Sq[0]-0.1777777777777778*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[6], globalIdxs[2], (-0.01721325931647741*kSq[6])-0.03975231959999626*kSq[5]-0.05678902799999467*kSq[4]+0.01333333333333333*kSq[3]+0.03849001794597505*kSq[2]-0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.4444444444444444*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[6], globalIdxs[3], (-0.03442651863295482*kSq[7])+0.03442651863295482*kSq[6]+0.09938079899999068*kSq[5]+0.09938079899999068*kSq[4]+0.02666666666666666*kSq[3]-0.0769800358919501*kSq[2]+0.0769800358919501*kSq[1]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[6], globalIdxs[4], 0.03442651863295482*kSq[7]+0.03442651863295482*kSq[6]+0.09938079899999068*kSq[5]+0.09938079899999068*kSq[4]-0.02666666666666666*kSq[3]-0.0769800358919501*kSq[2]-0.0769800358919501*kSq[1]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[6], globalIdxs[5], 0.03442651863295482*kSq[7]-0.0295084445425327*kSq[6]-0.05962847939999439*kSq[5]-0.063887656499994*kSq[4]+0.05333333333333333*kSq[3]+0.06666666666666667*epsilon[0]*rdx2Sq[1]+0.03849001794597505*kSq[1]-0.8888888888888888*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[6], globalIdxs[6], 0.1967229636168847*kSq[6]-0.07950463919999252*kSq[5]+0.2271561119999787*kSq[4]-0.3079201435678004*kSq[2]+0.5333333333333333*epsilon[0]*rdx2Sq[1]+1.777777777777778*epsilon[0]*rdx2Sq[0]-0.3555555555555556*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[6], globalIdxs[7], (-0.03442651863295482*kSq[7])-0.0295084445425327*kSq[6]-0.05962847939999439*kSq[5]-0.063887656499994*kSq[4]-0.05333333333333333*kSq[3]+0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.03849001794597505*kSq[1]-0.8888888888888888*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[7], globalIdxs[0], 0.0234254740499978*kSq[5]+0.0234254740499978*kSq[4]+0.01333333333333333*kSq[3]+0.2555555555555555*epsilon[0]*rdx2Sq[1]+0.2555555555555555*epsilon[0]*rdx2Sq[0]-0.03333333333333333*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[7], globalIdxs[1], 0.01721325931647741*kSq[6]-0.03975231959999626*kSq[5]-0.05678902799999467*kSq[4]-0.01333333333333333*kSq[3]-0.03849001794597505*kSq[2]-0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.4444444444444444*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[7], globalIdxs[2], 0.006147592613027645*kSq[7]+0.02697478829999747*kSq[5]+0.03336355394999686*kSq[4]+0.3111111111111111*epsilon[0]*rdx2Sq[1]+0.01924500897298752*kSq[1]+0.1888888888888889*epsilon[0]*rdx2Sq[0]-0.02222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[7], globalIdxs[3], 0.01721325931647741*kSq[7]-0.05678902799999467*kSq[5]-0.03975231959999626*kSq[4]-0.01333333333333333*kSq[3]-0.4444444444444444*epsilon[0]*rdx2Sq[1]-0.03849001794597505*kSq[1]-0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[7], globalIdxs[4], (-0.0295084445425327*kSq[7])-0.03442651863295482*kSq[6]-0.063887656499994*kSq[5]-0.05962847939999439*kSq[4]-0.05333333333333333*kSq[3]-0.03849001794597505*kSq[2]-0.8888888888888888*epsilon[0]*rdx2Sq[1]+0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[7], globalIdxs[5], 0.006147592613027645*kSq[6]+0.03336355394999686*kSq[5]+0.02697478829999747*kSq[4]+0.01924500897298752*kSq[2]+0.1888888888888889*epsilon[0]*rdx2Sq[1]+0.3111111111111111*epsilon[0]*rdx2Sq[0]-0.02222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[7], globalIdxs[6], (-0.03442651863295482*kSq[7])-0.0295084445425327*kSq[6]-0.05962847939999439*kSq[5]-0.063887656499994*kSq[4]-0.05333333333333333*kSq[3]+0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.03849001794597505*kSq[1]-0.8888888888888888*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[7], globalIdxs[7], (-0.04549218533640458*kSq[7])-0.04549218533640458*kSq[6]-0.0127775312999988*kSq[5]-0.0127775312999988*kSq[4]-0.04666666666666667*kSq[3]-0.03849001794597505*kSq[2]+0.5777777777777777*epsilon[0]*rdx2Sq[1]-0.03849001794597505*kSq[1]+0.5777777777777777*epsilon[0]*rdx2Sq[0]-0.06666666666666667*kSq[0]);

}
void fem_poisson_lhs_stencil_consteps_2x_ser_p1_lox_dirichletx_iny_periodicy(const double *epsilon, const double *kSq, const double *dx, const double *bcVals, const long *globalIdxs, gkyl_mat_triples *tri) 
{ 
  // epsilon: permittivity.
  // kSq: wave number squared (factor multiplying phi).
  // dx: cell length in each direction.
  // bcVals[3]: values to impose as BCs, i.e. bcVals[0]*phi+bcVals[1]*d(phi)/dx=bcVals[2].
  // globalIdxs: global linear index of each basis function/node in current cell.
  // tri: triples object (i,j,val), i.e. contribute val to i,j element of the global matrix.

  double rdx2Sq[2];
  rdx2Sq[0] = 4.0/(dx[0]*dx[0]);
  rdx2Sq[1] = 4.0/(dx[1]*dx[1]);

  gkyl_mat_triples_insert(tri, globalIdxs[0], globalIdxs[0], 1.0);
  gkyl_mat_triples_insert(tri, globalIdxs[0], globalIdxs[1], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[0], globalIdxs[2], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[0], globalIdxs[3], 0.0);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[0], 0.09622504486493762*kSq[2]+0.1666666666666667*epsilon[0]*rdx2Sq[1]-0.3333333333333333*epsilon[0]*rdx2Sq[0]-0.1111111111111111*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[1], 0.1666666666666667*kSq[3]+0.1924500897298752*kSq[2]+0.3333333333333333*epsilon[0]*rdx2Sq[1]-0.1924500897298752*kSq[1]+0.3333333333333333*epsilon[0]*rdx2Sq[0]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[2], (-0.1666666666666667*epsilon[0]*rdx2Sq[1])-0.1666666666666667*epsilon[0]*rdx2Sq[0]-0.05555555555555555*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[3], (-0.3333333333333333*epsilon[0]*rdx2Sq[1])-0.09622504486493762*kSq[1]+0.1666666666666667*epsilon[0]*rdx2Sq[0]-0.1111111111111111*kSq[0]);
  gkyl_mat_triples_insert(tri, globalIdxs[2], globalIdxs[0], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[2], globalIdxs[1], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[2], globalIdxs[2], 1.0);
  gkyl_mat_triples_insert(tri, globalIdxs[2], globalIdxs[3], 0.0);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[0], (-0.1666666666666667*epsilon[0]*rdx2Sq[1])-0.1666666666666667*epsilon[0]*rdx2Sq[0]-0.05555555555555555*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[1], (-0.3333333333333333*epsilon[0]*rdx2Sq[1])-0.09622504486493762*kSq[1]+0.1666666666666667*epsilon[0]*rdx2Sq[0]-0.1111111111111111*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[2], (-0.09622504486493762*kSq[2])+0.1666666666666667*epsilon[0]*rdx2Sq[1]-0.3333333333333333*epsilon[0]*rdx2Sq[0]-0.1111111111111111*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[3], (-0.1666666666666667*kSq[3])-0.1924500897298752*kSq[2]+0.3333333333333333*epsilon[0]*rdx2Sq[1]-0.1924500897298752*kSq[1]+0.3333333333333333*epsilon[0]*rdx2Sq[0]-0.2222222222222222*kSq[0]);

}
void fem_poisson_lhs_stencil_consteps_2x_ser_p2_lox_dirichletx_iny_periodicy(const double *epsilon, const double *kSq, const double *dx, const double *bcVals, const long *globalIdxs, gkyl_mat_triples *tri) 
{ 
  // epsilon: permittivity.
  // kSq: wave number squared (factor multiplying phi).
  // dx: cell length in each direction.
  // bcVals[3]: values to impose as BCs, i.e. bcVals[0]*phi+bcVals[1]*d(phi)/dx=bcVals[2].
  // globalIdxs: global linear index of each basis function/node in current cell.
  // tri: triples object (i,j,val), i.e. contribute val to i,j element of the global matrix.

  double rdx2Sq[2];
  rdx2Sq[0] = 4.0/(dx[0]*dx[0]);
  rdx2Sq[1] = 4.0/(dx[1]*dx[1]);

  gkyl_mat_triples_insert(tri, globalIdxs[0], globalIdxs[0], 1.0);
  gkyl_mat_triples_insert(tri, globalIdxs[0], globalIdxs[1], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[0], globalIdxs[2], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[0], globalIdxs[3], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[0], globalIdxs[4], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[0], globalIdxs[5], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[0], globalIdxs[6], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[0], globalIdxs[7], 0.0);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[0], 0.03442651863295482*kSq[7]+0.0295084445425327*kSq[6]-0.05962847939999439*kSq[5]-0.063887656499994*kSq[4]-0.05333333333333333*kSq[3]+0.06666666666666667*epsilon[0]*rdx2Sq[1]+0.03849001794597505*kSq[1]-0.8888888888888888*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[1], (-0.1967229636168847*kSq[6])-0.07950463919999252*kSq[5]+0.2271561119999787*kSq[4]+0.3079201435678004*kSq[2]+0.5333333333333333*epsilon[0]*rdx2Sq[1]+1.777777777777778*epsilon[0]*rdx2Sq[0]-0.3555555555555556*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[2], (-0.03442651863295482*kSq[7])+0.0295084445425327*kSq[6]-0.05962847939999439*kSq[5]-0.063887656499994*kSq[4]+0.05333333333333333*kSq[3]+0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.03849001794597505*kSq[1]-0.8888888888888888*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[3], (-0.03442651863295482*kSq[7])-0.03442651863295482*kSq[6]+0.09938079899999068*kSq[5]+0.09938079899999068*kSq[4]-0.02666666666666666*kSq[3]+0.0769800358919501*kSq[2]+0.0769800358919501*kSq[1]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[4], 0.03442651863295482*kSq[7]-0.03442651863295482*kSq[6]+0.09938079899999068*kSq[5]+0.09938079899999068*kSq[4]+0.02666666666666666*kSq[3]+0.0769800358919501*kSq[2]-0.0769800358919501*kSq[1]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[5], 0.01721325931647741*kSq[6]-0.03975231959999626*kSq[5]-0.05678902799999467*kSq[4]+0.01333333333333333*kSq[3]-0.03849001794597505*kSq[2]-0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.4444444444444444*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[6], 0.07950463919999252*kSq[5]+0.1135780559999893*kSq[4]-0.5333333333333333*epsilon[0]*rdx2Sq[1]+0.8888888888888888*epsilon[0]*rdx2Sq[0]-0.1777777777777778*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[7], 0.01721325931647741*kSq[6]-0.03975231959999626*kSq[5]-0.05678902799999467*kSq[4]-0.01333333333333333*kSq[3]-0.03849001794597505*kSq[2]-0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.4444444444444444*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[0], (-0.006147592613027645*kSq[6])+0.03336355394999686*kSq[5]+0.02697478829999747*kSq[4]-0.01924500897298752*kSq[2]+0.1888888888888889*epsilon[0]*rdx2Sq[1]+0.3111111111111111*epsilon[0]*rdx2Sq[0]-0.02222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[1], (-0.03442651863295482*kSq[7])+0.0295084445425327*kSq[6]-0.05962847939999439*kSq[5]-0.063887656499994*kSq[4]+0.05333333333333333*kSq[3]+0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.03849001794597505*kSq[1]-0.8888888888888888*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[2], (-0.04549218533640458*kSq[7])+0.04549218533640458*kSq[6]-0.0127775312999988*kSq[5]-0.0127775312999988*kSq[4]+0.04666666666666667*kSq[3]+0.03849001794597505*kSq[2]+0.5777777777777777*epsilon[0]*rdx2Sq[1]-0.03849001794597505*kSq[1]+0.5777777777777777*epsilon[0]*rdx2Sq[0]-0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[3], 0.01721325931647741*kSq[7]-0.05678902799999467*kSq[5]-0.03975231959999626*kSq[4]+0.01333333333333333*kSq[3]-0.4444444444444444*epsilon[0]*rdx2Sq[1]-0.03849001794597505*kSq[1]-0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[4], (-0.0295084445425327*kSq[7])+0.03442651863295482*kSq[6]-0.063887656499994*kSq[5]-0.05962847939999439*kSq[4]+0.05333333333333333*kSq[3]+0.03849001794597505*kSq[2]-0.8888888888888888*epsilon[0]*rdx2Sq[1]+0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[5], 0.0234254740499978*kSq[5]+0.0234254740499978*kSq[4]-0.01333333333333333*kSq[3]+0.2555555555555555*epsilon[0]*rdx2Sq[1]+0.2555555555555555*epsilon[0]*rdx2Sq[0]-0.03333333333333333*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[6], (-0.01721325931647741*kSq[6])-0.03975231959999626*kSq[5]-0.05678902799999467*kSq[4]+0.01333333333333333*kSq[3]+0.03849001794597505*kSq[2]-0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.4444444444444444*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[7], 0.006147592613027645*kSq[7]+0.02697478829999747*kSq[5]+0.03336355394999686*kSq[4]+0.3111111111111111*epsilon[0]*rdx2Sq[1]+0.01924500897298752*kSq[1]+0.1888888888888889*epsilon[0]*rdx2Sq[0]-0.02222222222222222*kSq[0]);
  gkyl_mat_triples_insert(tri, globalIdxs[3], globalIdxs[0], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[3], globalIdxs[1], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[3], globalIdxs[2], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[3], globalIdxs[3], 1.0);
  gkyl_mat_triples_insert(tri, globalIdxs[3], globalIdxs[4], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[3], globalIdxs[5], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[3], globalIdxs[6], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[3], globalIdxs[7], 0.0);
  gkyl_mat_triples_accum(tri, globalIdxs[4], globalIdxs[0], (-0.01721325931647741*kSq[7])-0.05678902799999467*kSq[5]-0.03975231959999626*kSq[4]-0.01333333333333333*kSq[3]-0.4444444444444444*epsilon[0]*rdx2Sq[1]+0.03849001794597505*kSq[1]-0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[4], globalIdxs[1], 0.03442651863295482*kSq[7]-0.03442651863295482*kSq[6]+0.09938079899999068*kSq[5]+0.09938079899999068*kSq[4]+0.02666666666666666*kSq[3]+0.0769800358919501*kSq[2]-0.0769800358919501*kSq[1]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[4], globalIdxs[2], (-0.0295084445425327*kSq[7])+0.03442651863295482*kSq[6]-0.063887656499994*kSq[5]-0.05962847939999439*kSq[4]+0.05333333333333333*kSq[3]+0.03849001794597505*kSq[2]-0.8888888888888888*epsilon[0]*rdx2Sq[1]+0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[4], globalIdxs[3], 0.1135780559999893*kSq[5]+0.07950463919999252*kSq[4]+0.8888888888888888*epsilon[0]*rdx2Sq[1]-0.5333333333333333*epsilon[0]*rdx2Sq[0]-0.1777777777777778*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[4], globalIdxs[4], 0.1967229636168847*kSq[7]+0.2271561119999787*kSq[5]-0.07950463919999252*kSq[4]+1.777777777777778*epsilon[0]*rdx2Sq[1]-0.3079201435678004*kSq[1]+0.5333333333333333*epsilon[0]*rdx2Sq[0]-0.3555555555555556*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[4], globalIdxs[5], (-0.01721325931647741*kSq[7])-0.05678902799999467*kSq[5]-0.03975231959999626*kSq[4]+0.01333333333333333*kSq[3]-0.4444444444444444*epsilon[0]*rdx2Sq[1]+0.03849001794597505*kSq[1]-0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[4], globalIdxs[6], 0.03442651863295482*kSq[7]+0.03442651863295482*kSq[6]+0.09938079899999068*kSq[5]+0.09938079899999068*kSq[4]-0.02666666666666666*kSq[3]-0.0769800358919501*kSq[2]-0.0769800358919501*kSq[1]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[4], globalIdxs[7], (-0.0295084445425327*kSq[7])-0.03442651863295482*kSq[6]-0.063887656499994*kSq[5]-0.05962847939999439*kSq[4]-0.05333333333333333*kSq[3]-0.03849001794597505*kSq[2]-0.8888888888888888*epsilon[0]*rdx2Sq[1]+0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_insert(tri, globalIdxs[5], globalIdxs[0], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[5], globalIdxs[1], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[5], globalIdxs[2], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[5], globalIdxs[3], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[5], globalIdxs[4], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[5], globalIdxs[5], 1.0);
  gkyl_mat_triples_insert(tri, globalIdxs[5], globalIdxs[6], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[5], globalIdxs[7], 0.0);
  gkyl_mat_triples_accum(tri, globalIdxs[6], globalIdxs[0], (-0.01721325931647741*kSq[6])-0.03975231959999626*kSq[5]-0.05678902799999467*kSq[4]-0.01333333333333333*kSq[3]+0.03849001794597505*kSq[2]-0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.4444444444444444*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[6], globalIdxs[1], 0.07950463919999252*kSq[5]+0.1135780559999893*kSq[4]-0.5333333333333333*epsilon[0]*rdx2Sq[1]+0.8888888888888888*epsilon[0]*rdx2Sq[0]-0.1777777777777778*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[6], globalIdxs[2], (-0.01721325931647741*kSq[6])-0.03975231959999626*kSq[5]-0.05678902799999467*kSq[4]+0.01333333333333333*kSq[3]+0.03849001794597505*kSq[2]-0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.4444444444444444*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[6], globalIdxs[3], (-0.03442651863295482*kSq[7])+0.03442651863295482*kSq[6]+0.09938079899999068*kSq[5]+0.09938079899999068*kSq[4]+0.02666666666666666*kSq[3]-0.0769800358919501*kSq[2]+0.0769800358919501*kSq[1]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[6], globalIdxs[4], 0.03442651863295482*kSq[7]+0.03442651863295482*kSq[6]+0.09938079899999068*kSq[5]+0.09938079899999068*kSq[4]-0.02666666666666666*kSq[3]-0.0769800358919501*kSq[2]-0.0769800358919501*kSq[1]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[6], globalIdxs[5], 0.03442651863295482*kSq[7]-0.0295084445425327*kSq[6]-0.05962847939999439*kSq[5]-0.063887656499994*kSq[4]+0.05333333333333333*kSq[3]+0.06666666666666667*epsilon[0]*rdx2Sq[1]+0.03849001794597505*kSq[1]-0.8888888888888888*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[6], globalIdxs[6], 0.1967229636168847*kSq[6]-0.07950463919999252*kSq[5]+0.2271561119999787*kSq[4]-0.3079201435678004*kSq[2]+0.5333333333333333*epsilon[0]*rdx2Sq[1]+1.777777777777778*epsilon[0]*rdx2Sq[0]-0.3555555555555556*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[6], globalIdxs[7], (-0.03442651863295482*kSq[7])-0.0295084445425327*kSq[6]-0.05962847939999439*kSq[5]-0.063887656499994*kSq[4]-0.05333333333333333*kSq[3]+0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.03849001794597505*kSq[1]-0.8888888888888888*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[7], globalIdxs[0], 0.0234254740499978*kSq[5]+0.0234254740499978*kSq[4]+0.01333333333333333*kSq[3]+0.2555555555555555*epsilon[0]*rdx2Sq[1]+0.2555555555555555*epsilon[0]*rdx2Sq[0]-0.03333333333333333*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[7], globalIdxs[1], 0.01721325931647741*kSq[6]-0.03975231959999626*kSq[5]-0.05678902799999467*kSq[4]-0.01333333333333333*kSq[3]-0.03849001794597505*kSq[2]-0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.4444444444444444*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[7], globalIdxs[2], 0.006147592613027645*kSq[7]+0.02697478829999747*kSq[5]+0.03336355394999686*kSq[4]+0.3111111111111111*epsilon[0]*rdx2Sq[1]+0.01924500897298752*kSq[1]+0.1888888888888889*epsilon[0]*rdx2Sq[0]-0.02222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[7], globalIdxs[3], 0.01721325931647741*kSq[7]-0.05678902799999467*kSq[5]-0.03975231959999626*kSq[4]-0.01333333333333333*kSq[3]-0.4444444444444444*epsilon[0]*rdx2Sq[1]-0.03849001794597505*kSq[1]-0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[7], globalIdxs[4], (-0.0295084445425327*kSq[7])-0.03442651863295482*kSq[6]-0.063887656499994*kSq[5]-0.05962847939999439*kSq[4]-0.05333333333333333*kSq[3]-0.03849001794597505*kSq[2]-0.8888888888888888*epsilon[0]*rdx2Sq[1]+0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[7], globalIdxs[5], 0.006147592613027645*kSq[6]+0.03336355394999686*kSq[5]+0.02697478829999747*kSq[4]+0.01924500897298752*kSq[2]+0.1888888888888889*epsilon[0]*rdx2Sq[1]+0.3111111111111111*epsilon[0]*rdx2Sq[0]-0.02222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[7], globalIdxs[6], (-0.03442651863295482*kSq[7])-0.0295084445425327*kSq[6]-0.05962847939999439*kSq[5]-0.063887656499994*kSq[4]-0.05333333333333333*kSq[3]+0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.03849001794597505*kSq[1]-0.8888888888888888*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[7], globalIdxs[7], (-0.04549218533640458*kSq[7])-0.04549218533640458*kSq[6]-0.0127775312999988*kSq[5]-0.0127775312999988*kSq[4]-0.04666666666666667*kSq[3]-0.03849001794597505*kSq[2]+0.5777777777777777*epsilon[0]*rdx2Sq[1]-0.03849001794597505*kSq[1]+0.5777777777777777*epsilon[0]*rdx2Sq[0]-0.06666666666666667*kSq[0]);

}
void fem_poisson_lhs_stencil_consteps_2x_ser_p1_lox_neumannx_iny_periodicy(const double *epsilon, const double *kSq, const double *dx, const double *bcVals, const long *globalIdxs, gkyl_mat_triples *tri) 
{ 
  // epsilon: permittivity.
  // kSq: wave number squared (factor multiplying phi).
  // dx: cell length in each direction.
  // bcVals[3]: values to impose as BCs, i.e. bcVals[0]*phi+bcVals[1]*d(phi)/dx=bcVals[2].
  // globalIdxs: global linear index of each basis function/node in current cell.
  // tri: triples object (i,j,val), i.e. contribute val to i,j element of the global matrix.

  double rdx2Sq[2];
  rdx2Sq[0] = 4.0/(dx[0]*dx[0]);
  rdx2Sq[1] = 4.0/(dx[1]*dx[1]);

  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[0], (-0.1666666666666667*kSq[3])+0.1924500897298752*kSq[2]+0.3333333333333333*epsilon[0]*rdx2Sq[1]+0.1924500897298752*kSq[1]+0.3333333333333333*epsilon[0]*rdx2Sq[0]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[1], 0.09622504486493762*kSq[2]+0.1666666666666667*epsilon[0]*rdx2Sq[1]-0.3333333333333333*epsilon[0]*rdx2Sq[0]-0.1111111111111111*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[2], (-0.3333333333333333*epsilon[0]*rdx2Sq[1])+0.09622504486493762*kSq[1]+0.1666666666666667*epsilon[0]*rdx2Sq[0]-0.1111111111111111*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[3], (-0.1666666666666667*epsilon[0]*rdx2Sq[1])-0.1666666666666667*epsilon[0]*rdx2Sq[0]-0.05555555555555555*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[0], 0.09622504486493762*kSq[2]+0.1666666666666667*epsilon[0]*rdx2Sq[1]-0.3333333333333333*epsilon[0]*rdx2Sq[0]-0.1111111111111111*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[1], 0.1666666666666667*kSq[3]+0.1924500897298752*kSq[2]+0.3333333333333333*epsilon[0]*rdx2Sq[1]-0.1924500897298752*kSq[1]+0.3333333333333333*epsilon[0]*rdx2Sq[0]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[2], (-0.1666666666666667*epsilon[0]*rdx2Sq[1])-0.1666666666666667*epsilon[0]*rdx2Sq[0]-0.05555555555555555*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[3], (-0.3333333333333333*epsilon[0]*rdx2Sq[1])-0.09622504486493762*kSq[1]+0.1666666666666667*epsilon[0]*rdx2Sq[0]-0.1111111111111111*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[0], (-0.3333333333333333*epsilon[0]*rdx2Sq[1])+0.09622504486493762*kSq[1]+0.1666666666666667*epsilon[0]*rdx2Sq[0]-0.1111111111111111*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[1], (-0.1666666666666667*epsilon[0]*rdx2Sq[1])-0.1666666666666667*epsilon[0]*rdx2Sq[0]-0.05555555555555555*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[2], 0.1666666666666667*kSq[3]-0.1924500897298752*kSq[2]+0.3333333333333333*epsilon[0]*rdx2Sq[1]+0.1924500897298752*kSq[1]+0.3333333333333333*epsilon[0]*rdx2Sq[0]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[3], (-0.09622504486493762*kSq[2])+0.1666666666666667*epsilon[0]*rdx2Sq[1]-0.3333333333333333*epsilon[0]*rdx2Sq[0]-0.1111111111111111*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[0], (-0.1666666666666667*epsilon[0]*rdx2Sq[1])-0.1666666666666667*epsilon[0]*rdx2Sq[0]-0.05555555555555555*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[1], (-0.3333333333333333*epsilon[0]*rdx2Sq[1])-0.09622504486493762*kSq[1]+0.1666666666666667*epsilon[0]*rdx2Sq[0]-0.1111111111111111*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[2], (-0.09622504486493762*kSq[2])+0.1666666666666667*epsilon[0]*rdx2Sq[1]-0.3333333333333333*epsilon[0]*rdx2Sq[0]-0.1111111111111111*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[3], (-0.1666666666666667*kSq[3])-0.1924500897298752*kSq[2]+0.3333333333333333*epsilon[0]*rdx2Sq[1]-0.1924500897298752*kSq[1]+0.3333333333333333*epsilon[0]*rdx2Sq[0]-0.2222222222222222*kSq[0]);

}
void fem_poisson_lhs_stencil_consteps_2x_ser_p2_lox_neumannx_iny_periodicy(const double *epsilon, const double *kSq, const double *dx, const double *bcVals, const long *globalIdxs, gkyl_mat_triples *tri) 
{ 
  // epsilon: permittivity.
  // kSq: wave number squared (factor multiplying phi).
  // dx: cell length in each direction.
  // bcVals[3]: values to impose as BCs, i.e. bcVals[0]*phi+bcVals[1]*d(phi)/dx=bcVals[2].
  // globalIdxs: global linear index of each basis function/node in current cell.
  // tri: triples object (i,j,val), i.e. contribute val to i,j element of the global matrix.

  double rdx2Sq[2];
  rdx2Sq[0] = 4.0/(dx[0]*dx[0]);
  rdx2Sq[1] = 4.0/(dx[1]*dx[1]);

  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[0], 0.04549218533640458*kSq[7]+0.04549218533640458*kSq[6]-0.0127775312999988*kSq[5]-0.0127775312999988*kSq[4]-0.04666666666666667*kSq[3]+0.03849001794597505*kSq[2]+0.5777777777777777*epsilon[0]*rdx2Sq[1]+0.03849001794597505*kSq[1]+0.5777777777777777*epsilon[0]*rdx2Sq[0]-0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[1], 0.03442651863295482*kSq[7]+0.0295084445425327*kSq[6]-0.05962847939999439*kSq[5]-0.063887656499994*kSq[4]-0.05333333333333333*kSq[3]+0.06666666666666667*epsilon[0]*rdx2Sq[1]+0.03849001794597505*kSq[1]-0.8888888888888888*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[2], (-0.006147592613027645*kSq[6])+0.03336355394999686*kSq[5]+0.02697478829999747*kSq[4]-0.01924500897298752*kSq[2]+0.1888888888888889*epsilon[0]*rdx2Sq[1]+0.3111111111111111*epsilon[0]*rdx2Sq[0]-0.02222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[3], 0.0295084445425327*kSq[7]+0.03442651863295482*kSq[6]-0.063887656499994*kSq[5]-0.05962847939999439*kSq[4]-0.05333333333333333*kSq[3]+0.03849001794597505*kSq[2]-0.8888888888888888*epsilon[0]*rdx2Sq[1]+0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[4], (-0.01721325931647741*kSq[7])-0.05678902799999467*kSq[5]-0.03975231959999626*kSq[4]-0.01333333333333333*kSq[3]-0.4444444444444444*epsilon[0]*rdx2Sq[1]+0.03849001794597505*kSq[1]-0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[5], (-0.006147592613027645*kSq[7])+0.02697478829999747*kSq[5]+0.03336355394999686*kSq[4]+0.3111111111111111*epsilon[0]*rdx2Sq[1]-0.01924500897298752*kSq[1]+0.1888888888888889*epsilon[0]*rdx2Sq[0]-0.02222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[6], (-0.01721325931647741*kSq[6])-0.03975231959999626*kSq[5]-0.05678902799999467*kSq[4]-0.01333333333333333*kSq[3]+0.03849001794597505*kSq[2]-0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.4444444444444444*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[7], 0.0234254740499978*kSq[5]+0.0234254740499978*kSq[4]+0.01333333333333333*kSq[3]+0.2555555555555555*epsilon[0]*rdx2Sq[1]+0.2555555555555555*epsilon[0]*rdx2Sq[0]-0.03333333333333333*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[0], 0.03442651863295482*kSq[7]+0.0295084445425327*kSq[6]-0.05962847939999439*kSq[5]-0.063887656499994*kSq[4]-0.05333333333333333*kSq[3]+0.06666666666666667*epsilon[0]*rdx2Sq[1]+0.03849001794597505*kSq[1]-0.8888888888888888*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[1], (-0.1967229636168847*kSq[6])-0.07950463919999252*kSq[5]+0.2271561119999787*kSq[4]+0.3079201435678004*kSq[2]+0.5333333333333333*epsilon[0]*rdx2Sq[1]+1.777777777777778*epsilon[0]*rdx2Sq[0]-0.3555555555555556*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[2], (-0.03442651863295482*kSq[7])+0.0295084445425327*kSq[6]-0.05962847939999439*kSq[5]-0.063887656499994*kSq[4]+0.05333333333333333*kSq[3]+0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.03849001794597505*kSq[1]-0.8888888888888888*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[3], (-0.03442651863295482*kSq[7])-0.03442651863295482*kSq[6]+0.09938079899999068*kSq[5]+0.09938079899999068*kSq[4]-0.02666666666666666*kSq[3]+0.0769800358919501*kSq[2]+0.0769800358919501*kSq[1]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[4], 0.03442651863295482*kSq[7]-0.03442651863295482*kSq[6]+0.09938079899999068*kSq[5]+0.09938079899999068*kSq[4]+0.02666666666666666*kSq[3]+0.0769800358919501*kSq[2]-0.0769800358919501*kSq[1]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[5], 0.01721325931647741*kSq[6]-0.03975231959999626*kSq[5]-0.05678902799999467*kSq[4]+0.01333333333333333*kSq[3]-0.03849001794597505*kSq[2]-0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.4444444444444444*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[6], 0.07950463919999252*kSq[5]+0.1135780559999893*kSq[4]-0.5333333333333333*epsilon[0]*rdx2Sq[1]+0.8888888888888888*epsilon[0]*rdx2Sq[0]-0.1777777777777778*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[7], 0.01721325931647741*kSq[6]-0.03975231959999626*kSq[5]-0.05678902799999467*kSq[4]-0.01333333333333333*kSq[3]-0.03849001794597505*kSq[2]-0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.4444444444444444*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[0], (-0.006147592613027645*kSq[6])+0.03336355394999686*kSq[5]+0.02697478829999747*kSq[4]-0.01924500897298752*kSq[2]+0.1888888888888889*epsilon[0]*rdx2Sq[1]+0.3111111111111111*epsilon[0]*rdx2Sq[0]-0.02222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[1], (-0.03442651863295482*kSq[7])+0.0295084445425327*kSq[6]-0.05962847939999439*kSq[5]-0.063887656499994*kSq[4]+0.05333333333333333*kSq[3]+0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.03849001794597505*kSq[1]-0.8888888888888888*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[2], (-0.04549218533640458*kSq[7])+0.04549218533640458*kSq[6]-0.0127775312999988*kSq[5]-0.0127775312999988*kSq[4]+0.04666666666666667*kSq[3]+0.03849001794597505*kSq[2]+0.5777777777777777*epsilon[0]*rdx2Sq[1]-0.03849001794597505*kSq[1]+0.5777777777777777*epsilon[0]*rdx2Sq[0]-0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[3], 0.01721325931647741*kSq[7]-0.05678902799999467*kSq[5]-0.03975231959999626*kSq[4]+0.01333333333333333*kSq[3]-0.4444444444444444*epsilon[0]*rdx2Sq[1]-0.03849001794597505*kSq[1]-0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[4], (-0.0295084445425327*kSq[7])+0.03442651863295482*kSq[6]-0.063887656499994*kSq[5]-0.05962847939999439*kSq[4]+0.05333333333333333*kSq[3]+0.03849001794597505*kSq[2]-0.8888888888888888*epsilon[0]*rdx2Sq[1]+0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[5], 0.0234254740499978*kSq[5]+0.0234254740499978*kSq[4]-0.01333333333333333*kSq[3]+0.2555555555555555*epsilon[0]*rdx2Sq[1]+0.2555555555555555*epsilon[0]*rdx2Sq[0]-0.03333333333333333*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[6], (-0.01721325931647741*kSq[6])-0.03975231959999626*kSq[5]-0.05678902799999467*kSq[4]+0.01333333333333333*kSq[3]+0.03849001794597505*kSq[2]-0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.4444444444444444*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[7], 0.006147592613027645*kSq[7]+0.02697478829999747*kSq[5]+0.03336355394999686*kSq[4]+0.3111111111111111*epsilon[0]*rdx2Sq[1]+0.01924500897298752*kSq[1]+0.1888888888888889*epsilon[0]*rdx2Sq[0]-0.02222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[0], 0.0295084445425327*kSq[7]+0.03442651863295482*kSq[6]-0.063887656499994*kSq[5]-0.05962847939999439*kSq[4]-0.05333333333333333*kSq[3]+0.03849001794597505*kSq[2]-0.8888888888888888*epsilon[0]*rdx2Sq[1]+0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[1], (-0.03442651863295482*kSq[7])-0.03442651863295482*kSq[6]+0.09938079899999068*kSq[5]+0.09938079899999068*kSq[4]-0.02666666666666666*kSq[3]+0.0769800358919501*kSq[2]+0.0769800358919501*kSq[1]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[2], 0.01721325931647741*kSq[7]-0.05678902799999467*kSq[5]-0.03975231959999626*kSq[4]+0.01333333333333333*kSq[3]-0.4444444444444444*epsilon[0]*rdx2Sq[1]-0.03849001794597505*kSq[1]-0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[3], (-0.1967229636168847*kSq[7])+0.2271561119999787*kSq[5]-0.07950463919999252*kSq[4]+1.777777777777778*epsilon[0]*rdx2Sq[1]+0.3079201435678004*kSq[1]+0.5333333333333333*epsilon[0]*rdx2Sq[0]-0.3555555555555556*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[4], 0.1135780559999893*kSq[5]+0.07950463919999252*kSq[4]+0.8888888888888888*epsilon[0]*rdx2Sq[1]-0.5333333333333333*epsilon[0]*rdx2Sq[0]-0.1777777777777778*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[5], 0.0295084445425327*kSq[7]-0.03442651863295482*kSq[6]-0.063887656499994*kSq[5]-0.05962847939999439*kSq[4]+0.05333333333333333*kSq[3]-0.03849001794597505*kSq[2]-0.8888888888888888*epsilon[0]*rdx2Sq[1]+0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[6], (-0.03442651863295482*kSq[7])+0.03442651863295482*kSq[6]+0.09938079899999068*kSq[5]+0.09938079899999068*kSq[4]+0.02666666666666666*kSq[3]-0.0769800358919501*kSq[2]+0.0769800358919501*kSq[1]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[7], 0.01721325931647741*kSq[7]-0.05678902799999467*kSq[5]-0.03975231959999626*kSq[4]-0.01333333333333333*kSq[3]-0.4444444444444444*epsilon[0]*rdx2Sq[1]-0.03849001794597505*kSq[1]-0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[4], globalIdxs[0], (-0.01721325931647741*kSq[7])-0.05678902799999467*kSq[5]-0.03975231959999626*kSq[4]-0.01333333333333333*kSq[3]-0.4444444444444444*epsilon[0]*rdx2Sq[1]+0.03849001794597505*kSq[1]-0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[4], globalIdxs[1], 0.03442651863295482*kSq[7]-0.03442651863295482*kSq[6]+0.09938079899999068*kSq[5]+0.09938079899999068*kSq[4]+0.02666666666666666*kSq[3]+0.0769800358919501*kSq[2]-0.0769800358919501*kSq[1]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[4], globalIdxs[2], (-0.0295084445425327*kSq[7])+0.03442651863295482*kSq[6]-0.063887656499994*kSq[5]-0.05962847939999439*kSq[4]+0.05333333333333333*kSq[3]+0.03849001794597505*kSq[2]-0.8888888888888888*epsilon[0]*rdx2Sq[1]+0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[4], globalIdxs[3], 0.1135780559999893*kSq[5]+0.07950463919999252*kSq[4]+0.8888888888888888*epsilon[0]*rdx2Sq[1]-0.5333333333333333*epsilon[0]*rdx2Sq[0]-0.1777777777777778*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[4], globalIdxs[4], 0.1967229636168847*kSq[7]+0.2271561119999787*kSq[5]-0.07950463919999252*kSq[4]+1.777777777777778*epsilon[0]*rdx2Sq[1]-0.3079201435678004*kSq[1]+0.5333333333333333*epsilon[0]*rdx2Sq[0]-0.3555555555555556*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[4], globalIdxs[5], (-0.01721325931647741*kSq[7])-0.05678902799999467*kSq[5]-0.03975231959999626*kSq[4]+0.01333333333333333*kSq[3]-0.4444444444444444*epsilon[0]*rdx2Sq[1]+0.03849001794597505*kSq[1]-0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[4], globalIdxs[6], 0.03442651863295482*kSq[7]+0.03442651863295482*kSq[6]+0.09938079899999068*kSq[5]+0.09938079899999068*kSq[4]-0.02666666666666666*kSq[3]-0.0769800358919501*kSq[2]-0.0769800358919501*kSq[1]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[4], globalIdxs[7], (-0.0295084445425327*kSq[7])-0.03442651863295482*kSq[6]-0.063887656499994*kSq[5]-0.05962847939999439*kSq[4]-0.05333333333333333*kSq[3]-0.03849001794597505*kSq[2]-0.8888888888888888*epsilon[0]*rdx2Sq[1]+0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[5], globalIdxs[0], (-0.006147592613027645*kSq[7])+0.02697478829999747*kSq[5]+0.03336355394999686*kSq[4]+0.3111111111111111*epsilon[0]*rdx2Sq[1]-0.01924500897298752*kSq[1]+0.1888888888888889*epsilon[0]*rdx2Sq[0]-0.02222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[5], globalIdxs[1], 0.01721325931647741*kSq[6]-0.03975231959999626*kSq[5]-0.05678902799999467*kSq[4]+0.01333333333333333*kSq[3]-0.03849001794597505*kSq[2]-0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.4444444444444444*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[5], globalIdxs[2], 0.0234254740499978*kSq[5]+0.0234254740499978*kSq[4]-0.01333333333333333*kSq[3]+0.2555555555555555*epsilon[0]*rdx2Sq[1]+0.2555555555555555*epsilon[0]*rdx2Sq[0]-0.03333333333333333*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[5], globalIdxs[3], 0.0295084445425327*kSq[7]-0.03442651863295482*kSq[6]-0.063887656499994*kSq[5]-0.05962847939999439*kSq[4]+0.05333333333333333*kSq[3]-0.03849001794597505*kSq[2]-0.8888888888888888*epsilon[0]*rdx2Sq[1]+0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[5], globalIdxs[4], (-0.01721325931647741*kSq[7])-0.05678902799999467*kSq[5]-0.03975231959999626*kSq[4]+0.01333333333333333*kSq[3]-0.4444444444444444*epsilon[0]*rdx2Sq[1]+0.03849001794597505*kSq[1]-0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[5], globalIdxs[5], 0.04549218533640458*kSq[7]-0.04549218533640458*kSq[6]-0.0127775312999988*kSq[5]-0.0127775312999988*kSq[4]+0.04666666666666667*kSq[3]-0.03849001794597505*kSq[2]+0.5777777777777777*epsilon[0]*rdx2Sq[1]+0.03849001794597505*kSq[1]+0.5777777777777777*epsilon[0]*rdx2Sq[0]-0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[5], globalIdxs[6], 0.03442651863295482*kSq[7]-0.0295084445425327*kSq[6]-0.05962847939999439*kSq[5]-0.063887656499994*kSq[4]+0.05333333333333333*kSq[3]+0.06666666666666667*epsilon[0]*rdx2Sq[1]+0.03849001794597505*kSq[1]-0.8888888888888888*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[5], globalIdxs[7], 0.006147592613027645*kSq[6]+0.03336355394999686*kSq[5]+0.02697478829999747*kSq[4]+0.01924500897298752*kSq[2]+0.1888888888888889*epsilon[0]*rdx2Sq[1]+0.3111111111111111*epsilon[0]*rdx2Sq[0]-0.02222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[6], globalIdxs[0], (-0.01721325931647741*kSq[6])-0.03975231959999626*kSq[5]-0.05678902799999467*kSq[4]-0.01333333333333333*kSq[3]+0.03849001794597505*kSq[2]-0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.4444444444444444*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[6], globalIdxs[1], 0.07950463919999252*kSq[5]+0.1135780559999893*kSq[4]-0.5333333333333333*epsilon[0]*rdx2Sq[1]+0.8888888888888888*epsilon[0]*rdx2Sq[0]-0.1777777777777778*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[6], globalIdxs[2], (-0.01721325931647741*kSq[6])-0.03975231959999626*kSq[5]-0.05678902799999467*kSq[4]+0.01333333333333333*kSq[3]+0.03849001794597505*kSq[2]-0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.4444444444444444*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[6], globalIdxs[3], (-0.03442651863295482*kSq[7])+0.03442651863295482*kSq[6]+0.09938079899999068*kSq[5]+0.09938079899999068*kSq[4]+0.02666666666666666*kSq[3]-0.0769800358919501*kSq[2]+0.0769800358919501*kSq[1]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[6], globalIdxs[4], 0.03442651863295482*kSq[7]+0.03442651863295482*kSq[6]+0.09938079899999068*kSq[5]+0.09938079899999068*kSq[4]-0.02666666666666666*kSq[3]-0.0769800358919501*kSq[2]-0.0769800358919501*kSq[1]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[6], globalIdxs[5], 0.03442651863295482*kSq[7]-0.0295084445425327*kSq[6]-0.05962847939999439*kSq[5]-0.063887656499994*kSq[4]+0.05333333333333333*kSq[3]+0.06666666666666667*epsilon[0]*rdx2Sq[1]+0.03849001794597505*kSq[1]-0.8888888888888888*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[6], globalIdxs[6], 0.1967229636168847*kSq[6]-0.07950463919999252*kSq[5]+0.2271561119999787*kSq[4]-0.3079201435678004*kSq[2]+0.5333333333333333*epsilon[0]*rdx2Sq[1]+1.777777777777778*epsilon[0]*rdx2Sq[0]-0.3555555555555556*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[6], globalIdxs[7], (-0.03442651863295482*kSq[7])-0.0295084445425327*kSq[6]-0.05962847939999439*kSq[5]-0.063887656499994*kSq[4]-0.05333333333333333*kSq[3]+0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.03849001794597505*kSq[1]-0.8888888888888888*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[7], globalIdxs[0], 0.0234254740499978*kSq[5]+0.0234254740499978*kSq[4]+0.01333333333333333*kSq[3]+0.2555555555555555*epsilon[0]*rdx2Sq[1]+0.2555555555555555*epsilon[0]*rdx2Sq[0]-0.03333333333333333*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[7], globalIdxs[1], 0.01721325931647741*kSq[6]-0.03975231959999626*kSq[5]-0.05678902799999467*kSq[4]-0.01333333333333333*kSq[3]-0.03849001794597505*kSq[2]-0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.4444444444444444*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[7], globalIdxs[2], 0.006147592613027645*kSq[7]+0.02697478829999747*kSq[5]+0.03336355394999686*kSq[4]+0.3111111111111111*epsilon[0]*rdx2Sq[1]+0.01924500897298752*kSq[1]+0.1888888888888889*epsilon[0]*rdx2Sq[0]-0.02222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[7], globalIdxs[3], 0.01721325931647741*kSq[7]-0.05678902799999467*kSq[5]-0.03975231959999626*kSq[4]-0.01333333333333333*kSq[3]-0.4444444444444444*epsilon[0]*rdx2Sq[1]-0.03849001794597505*kSq[1]-0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[7], globalIdxs[4], (-0.0295084445425327*kSq[7])-0.03442651863295482*kSq[6]-0.063887656499994*kSq[5]-0.05962847939999439*kSq[4]-0.05333333333333333*kSq[3]-0.03849001794597505*kSq[2]-0.8888888888888888*epsilon[0]*rdx2Sq[1]+0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[7], globalIdxs[5], 0.006147592613027645*kSq[6]+0.03336355394999686*kSq[5]+0.02697478829999747*kSq[4]+0.01924500897298752*kSq[2]+0.1888888888888889*epsilon[0]*rdx2Sq[1]+0.3111111111111111*epsilon[0]*rdx2Sq[0]-0.02222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[7], globalIdxs[6], (-0.03442651863295482*kSq[7])-0.0295084445425327*kSq[6]-0.05962847939999439*kSq[5]-0.063887656499994*kSq[4]-0.05333333333333333*kSq[3]+0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.03849001794597505*kSq[1]-0.8888888888888888*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[7], globalIdxs[7], (-0.04549218533640458*kSq[7])-0.04549218533640458*kSq[6]-0.0127775312999988*kSq[5]-0.0127775312999988*kSq[4]-0.04666666666666667*kSq[3]-0.03849001794597505*kSq[2]+0.5777777777777777*epsilon[0]*rdx2Sq[1]-0.03849001794597505*kSq[1]+0.5777777777777777*epsilon[0]*rdx2Sq[0]-0.06666666666666667*kSq[0]);

}
void fem_poisson_lhs_stencil_consteps_2x_ser_p1_lox_robinx_iny_periodicy(const double *epsilon, const double *kSq, const double *dx, const double *bcVals, const long *globalIdxs, gkyl_mat_triples *tri) 
{ 
  // epsilon: permittivity.
  // kSq: wave number squared (factor multiplying phi).
  // dx: cell length in each direction.
  // bcVals[3]: values to impose as BCs, i.e. bcVals[0]*phi+bcVals[1]*d(phi)/dx=bcVals[2].
  // globalIdxs: global linear index of each basis function/node in current cell.
  // tri: triples object (i,j,val), i.e. contribute val to i,j element of the global matrix.

  double rdx2Sq[2];
  rdx2Sq[0] = 4.0/(dx[0]*dx[0]);
  rdx2Sq[1] = 4.0/(dx[1]*dx[1]);

  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[0], (-0.1666666666666667*kSq[3])+0.1924500897298752*kSq[2]+0.3333333333333333*epsilon[0]*rdx2Sq[1]+0.1924500897298752*kSq[1]-(0.6666666666666666*bcVals[0]*epsilon[0]*rdx2Sq[0])/bcVals[1]+0.3333333333333333*epsilon[0]*rdx2Sq[0]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[1], 0.09622504486493762*kSq[2]+0.1666666666666667*epsilon[0]*rdx2Sq[1]-0.3333333333333333*epsilon[0]*rdx2Sq[0]-0.1111111111111111*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[2], (-0.3333333333333333*epsilon[0]*rdx2Sq[1])+0.09622504486493762*kSq[1]-(0.3333333333333333*bcVals[0]*epsilon[0]*rdx2Sq[0])/bcVals[1]+0.1666666666666667*epsilon[0]*rdx2Sq[0]-0.1111111111111111*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[3], (-0.1666666666666667*epsilon[0]*rdx2Sq[1])-0.1666666666666667*epsilon[0]*rdx2Sq[0]-0.05555555555555555*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[0], 0.09622504486493762*kSq[2]+0.1666666666666667*epsilon[0]*rdx2Sq[1]-0.3333333333333333*epsilon[0]*rdx2Sq[0]-0.1111111111111111*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[1], 0.1666666666666667*kSq[3]+0.1924500897298752*kSq[2]+0.3333333333333333*epsilon[0]*rdx2Sq[1]-0.1924500897298752*kSq[1]+0.3333333333333333*epsilon[0]*rdx2Sq[0]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[2], (-0.1666666666666667*epsilon[0]*rdx2Sq[1])-0.1666666666666667*epsilon[0]*rdx2Sq[0]-0.05555555555555555*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[3], (-0.3333333333333333*epsilon[0]*rdx2Sq[1])-0.09622504486493762*kSq[1]+0.1666666666666667*epsilon[0]*rdx2Sq[0]-0.1111111111111111*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[0], (-0.3333333333333333*epsilon[0]*rdx2Sq[1])+0.09622504486493762*kSq[1]-(0.3333333333333333*bcVals[0]*epsilon[0]*rdx2Sq[0])/bcVals[1]+0.1666666666666667*epsilon[0]*rdx2Sq[0]-0.1111111111111111*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[1], (-0.1666666666666667*epsilon[0]*rdx2Sq[1])-0.1666666666666667*epsilon[0]*rdx2Sq[0]-0.05555555555555555*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[2], 0.1666666666666667*kSq[3]-0.1924500897298752*kSq[2]+0.3333333333333333*epsilon[0]*rdx2Sq[1]+0.1924500897298752*kSq[1]-(0.6666666666666666*bcVals[0]*epsilon[0]*rdx2Sq[0])/bcVals[1]+0.3333333333333333*epsilon[0]*rdx2Sq[0]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[3], (-0.09622504486493762*kSq[2])+0.1666666666666667*epsilon[0]*rdx2Sq[1]-0.3333333333333333*epsilon[0]*rdx2Sq[0]-0.1111111111111111*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[0], (-0.1666666666666667*epsilon[0]*rdx2Sq[1])-0.1666666666666667*epsilon[0]*rdx2Sq[0]-0.05555555555555555*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[1], (-0.3333333333333333*epsilon[0]*rdx2Sq[1])-0.09622504486493762*kSq[1]+0.1666666666666667*epsilon[0]*rdx2Sq[0]-0.1111111111111111*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[2], (-0.09622504486493762*kSq[2])+0.1666666666666667*epsilon[0]*rdx2Sq[1]-0.3333333333333333*epsilon[0]*rdx2Sq[0]-0.1111111111111111*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[3], (-0.1666666666666667*kSq[3])-0.1924500897298752*kSq[2]+0.3333333333333333*epsilon[0]*rdx2Sq[1]-0.1924500897298752*kSq[1]+0.3333333333333333*epsilon[0]*rdx2Sq[0]-0.2222222222222222*kSq[0]);

}
void fem_poisson_lhs_stencil_consteps_2x_ser_p2_lox_robinx_iny_periodicy(const double *epsilon, const double *kSq, const double *dx, const double *bcVals, const long *globalIdxs, gkyl_mat_triples *tri) 
{ 
  // epsilon: permittivity.
  // kSq: wave number squared (factor multiplying phi).
  // dx: cell length in each direction.
  // bcVals[3]: values to impose as BCs, i.e. bcVals[0]*phi+bcVals[1]*d(phi)/dx=bcVals[2].
  // globalIdxs: global linear index of each basis function/node in current cell.
  // tri: triples object (i,j,val), i.e. contribute val to i,j element of the global matrix.

  double rdx2Sq[2];
  rdx2Sq[0] = 4.0/(dx[0]*dx[0]);
  rdx2Sq[1] = 4.0/(dx[1]*dx[1]);

  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[0], 0.04549218533640458*kSq[7]+0.04549218533640458*kSq[6]-0.0127775312999988*kSq[5]-0.0127775312999988*kSq[4]-0.04666666666666667*kSq[3]+0.03849001794597505*kSq[2]+0.5777777777777777*epsilon[0]*rdx2Sq[1]+0.03849001794597505*kSq[1]-(0.2666666666666667*bcVals[0]*epsilon[0]*rdx2Sq[0])/bcVals[1]+0.5777777777777777*epsilon[0]*rdx2Sq[0]-0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[1], 0.03442651863295482*kSq[7]+0.0295084445425327*kSq[6]-0.05962847939999439*kSq[5]-0.063887656499994*kSq[4]-0.05333333333333333*kSq[3]+0.06666666666666667*epsilon[0]*rdx2Sq[1]+0.03849001794597505*kSq[1]-0.8888888888888888*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[2], (-0.006147592613027645*kSq[6])+0.03336355394999686*kSq[5]+0.02697478829999747*kSq[4]-0.01924500897298752*kSq[2]+0.1888888888888889*epsilon[0]*rdx2Sq[1]+0.3111111111111111*epsilon[0]*rdx2Sq[0]-0.02222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[3], 0.0295084445425327*kSq[7]+0.03442651863295482*kSq[6]-0.063887656499994*kSq[5]-0.05962847939999439*kSq[4]-0.05333333333333333*kSq[3]+0.03849001794597505*kSq[2]-0.8888888888888888*epsilon[0]*rdx2Sq[1]-(0.1333333333333333*bcVals[0]*epsilon[0]*rdx2Sq[0])/bcVals[1]+0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[4], (-0.01721325931647741*kSq[7])-0.05678902799999467*kSq[5]-0.03975231959999626*kSq[4]-0.01333333333333333*kSq[3]-0.4444444444444444*epsilon[0]*rdx2Sq[1]+0.03849001794597505*kSq[1]-0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[5], (-0.006147592613027645*kSq[7])+0.02697478829999747*kSq[5]+0.03336355394999686*kSq[4]+0.3111111111111111*epsilon[0]*rdx2Sq[1]-0.01924500897298752*kSq[1]+(0.06666666666666667*bcVals[0]*epsilon[0]*rdx2Sq[0])/bcVals[1]+0.1888888888888889*epsilon[0]*rdx2Sq[0]-0.02222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[6], (-0.01721325931647741*kSq[6])-0.03975231959999626*kSq[5]-0.05678902799999467*kSq[4]-0.01333333333333333*kSq[3]+0.03849001794597505*kSq[2]-0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.4444444444444444*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[7], 0.0234254740499978*kSq[5]+0.0234254740499978*kSq[4]+0.01333333333333333*kSq[3]+0.2555555555555555*epsilon[0]*rdx2Sq[1]+0.2555555555555555*epsilon[0]*rdx2Sq[0]-0.03333333333333333*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[0], 0.03442651863295482*kSq[7]+0.0295084445425327*kSq[6]-0.05962847939999439*kSq[5]-0.063887656499994*kSq[4]-0.05333333333333333*kSq[3]+0.06666666666666667*epsilon[0]*rdx2Sq[1]+0.03849001794597505*kSq[1]-0.8888888888888888*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[1], (-0.1967229636168847*kSq[6])-0.07950463919999252*kSq[5]+0.2271561119999787*kSq[4]+0.3079201435678004*kSq[2]+0.5333333333333333*epsilon[0]*rdx2Sq[1]+1.777777777777778*epsilon[0]*rdx2Sq[0]-0.3555555555555556*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[2], (-0.03442651863295482*kSq[7])+0.0295084445425327*kSq[6]-0.05962847939999439*kSq[5]-0.063887656499994*kSq[4]+0.05333333333333333*kSq[3]+0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.03849001794597505*kSq[1]-0.8888888888888888*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[3], (-0.03442651863295482*kSq[7])-0.03442651863295482*kSq[6]+0.09938079899999068*kSq[5]+0.09938079899999068*kSq[4]-0.02666666666666666*kSq[3]+0.0769800358919501*kSq[2]+0.0769800358919501*kSq[1]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[4], 0.03442651863295482*kSq[7]-0.03442651863295482*kSq[6]+0.09938079899999068*kSq[5]+0.09938079899999068*kSq[4]+0.02666666666666666*kSq[3]+0.0769800358919501*kSq[2]-0.0769800358919501*kSq[1]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[5], 0.01721325931647741*kSq[6]-0.03975231959999626*kSq[5]-0.05678902799999467*kSq[4]+0.01333333333333333*kSq[3]-0.03849001794597505*kSq[2]-0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.4444444444444444*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[6], 0.07950463919999252*kSq[5]+0.1135780559999893*kSq[4]-0.5333333333333333*epsilon[0]*rdx2Sq[1]+0.8888888888888888*epsilon[0]*rdx2Sq[0]-0.1777777777777778*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[7], 0.01721325931647741*kSq[6]-0.03975231959999626*kSq[5]-0.05678902799999467*kSq[4]-0.01333333333333333*kSq[3]-0.03849001794597505*kSq[2]-0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.4444444444444444*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[0], (-0.006147592613027645*kSq[6])+0.03336355394999686*kSq[5]+0.02697478829999747*kSq[4]-0.01924500897298752*kSq[2]+0.1888888888888889*epsilon[0]*rdx2Sq[1]+0.3111111111111111*epsilon[0]*rdx2Sq[0]-0.02222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[1], (-0.03442651863295482*kSq[7])+0.0295084445425327*kSq[6]-0.05962847939999439*kSq[5]-0.063887656499994*kSq[4]+0.05333333333333333*kSq[3]+0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.03849001794597505*kSq[1]-0.8888888888888888*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[2], (-0.04549218533640458*kSq[7])+0.04549218533640458*kSq[6]-0.0127775312999988*kSq[5]-0.0127775312999988*kSq[4]+0.04666666666666667*kSq[3]+0.03849001794597505*kSq[2]+0.5777777777777777*epsilon[0]*rdx2Sq[1]-0.03849001794597505*kSq[1]+0.5777777777777777*epsilon[0]*rdx2Sq[0]-0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[3], 0.01721325931647741*kSq[7]-0.05678902799999467*kSq[5]-0.03975231959999626*kSq[4]+0.01333333333333333*kSq[3]-0.4444444444444444*epsilon[0]*rdx2Sq[1]-0.03849001794597505*kSq[1]-0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[4], (-0.0295084445425327*kSq[7])+0.03442651863295482*kSq[6]-0.063887656499994*kSq[5]-0.05962847939999439*kSq[4]+0.05333333333333333*kSq[3]+0.03849001794597505*kSq[2]-0.8888888888888888*epsilon[0]*rdx2Sq[1]+0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[5], 0.0234254740499978*kSq[5]+0.0234254740499978*kSq[4]-0.01333333333333333*kSq[3]+0.2555555555555555*epsilon[0]*rdx2Sq[1]+0.2555555555555555*epsilon[0]*rdx2Sq[0]-0.03333333333333333*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[6], (-0.01721325931647741*kSq[6])-0.03975231959999626*kSq[5]-0.05678902799999467*kSq[4]+0.01333333333333333*kSq[3]+0.03849001794597505*kSq[2]-0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.4444444444444444*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[7], 0.006147592613027645*kSq[7]+0.02697478829999747*kSq[5]+0.03336355394999686*kSq[4]+0.3111111111111111*epsilon[0]*rdx2Sq[1]+0.01924500897298752*kSq[1]+0.1888888888888889*epsilon[0]*rdx2Sq[0]-0.02222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[0], 0.0295084445425327*kSq[7]+0.03442651863295482*kSq[6]-0.063887656499994*kSq[5]-0.05962847939999439*kSq[4]-0.05333333333333333*kSq[3]+0.03849001794597505*kSq[2]-0.8888888888888888*epsilon[0]*rdx2Sq[1]-(0.1333333333333333*bcVals[0]*epsilon[0]*rdx2Sq[0])/bcVals[1]+0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[1], (-0.03442651863295482*kSq[7])-0.03442651863295482*kSq[6]+0.09938079899999068*kSq[5]+0.09938079899999068*kSq[4]-0.02666666666666666*kSq[3]+0.0769800358919501*kSq[2]+0.0769800358919501*kSq[1]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[2], 0.01721325931647741*kSq[7]-0.05678902799999467*kSq[5]-0.03975231959999626*kSq[4]+0.01333333333333333*kSq[3]-0.4444444444444444*epsilon[0]*rdx2Sq[1]-0.03849001794597505*kSq[1]-0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[3], (-0.1967229636168847*kSq[7])+0.2271561119999787*kSq[5]-0.07950463919999252*kSq[4]+1.777777777777778*epsilon[0]*rdx2Sq[1]+0.3079201435678004*kSq[1]-(1.066666666666667*bcVals[0]*epsilon[0]*rdx2Sq[0])/bcVals[1]+0.5333333333333333*epsilon[0]*rdx2Sq[0]-0.3555555555555556*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[4], 0.1135780559999893*kSq[5]+0.07950463919999252*kSq[4]+0.8888888888888888*epsilon[0]*rdx2Sq[1]-0.5333333333333333*epsilon[0]*rdx2Sq[0]-0.1777777777777778*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[5], 0.0295084445425327*kSq[7]-0.03442651863295482*kSq[6]-0.063887656499994*kSq[5]-0.05962847939999439*kSq[4]+0.05333333333333333*kSq[3]-0.03849001794597505*kSq[2]-0.8888888888888888*epsilon[0]*rdx2Sq[1]-(0.1333333333333333*bcVals[0]*epsilon[0]*rdx2Sq[0])/bcVals[1]+0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[6], (-0.03442651863295482*kSq[7])+0.03442651863295482*kSq[6]+0.09938079899999068*kSq[5]+0.09938079899999068*kSq[4]+0.02666666666666666*kSq[3]-0.0769800358919501*kSq[2]+0.0769800358919501*kSq[1]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[7], 0.01721325931647741*kSq[7]-0.05678902799999467*kSq[5]-0.03975231959999626*kSq[4]-0.01333333333333333*kSq[3]-0.4444444444444444*epsilon[0]*rdx2Sq[1]-0.03849001794597505*kSq[1]-0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[4], globalIdxs[0], (-0.01721325931647741*kSq[7])-0.05678902799999467*kSq[5]-0.03975231959999626*kSq[4]-0.01333333333333333*kSq[3]-0.4444444444444444*epsilon[0]*rdx2Sq[1]+0.03849001794597505*kSq[1]-0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[4], globalIdxs[1], 0.03442651863295482*kSq[7]-0.03442651863295482*kSq[6]+0.09938079899999068*kSq[5]+0.09938079899999068*kSq[4]+0.02666666666666666*kSq[3]+0.0769800358919501*kSq[2]-0.0769800358919501*kSq[1]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[4], globalIdxs[2], (-0.0295084445425327*kSq[7])+0.03442651863295482*kSq[6]-0.063887656499994*kSq[5]-0.05962847939999439*kSq[4]+0.05333333333333333*kSq[3]+0.03849001794597505*kSq[2]-0.8888888888888888*epsilon[0]*rdx2Sq[1]+0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[4], globalIdxs[3], 0.1135780559999893*kSq[5]+0.07950463919999252*kSq[4]+0.8888888888888888*epsilon[0]*rdx2Sq[1]-0.5333333333333333*epsilon[0]*rdx2Sq[0]-0.1777777777777778*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[4], globalIdxs[4], 0.1967229636168847*kSq[7]+0.2271561119999787*kSq[5]-0.07950463919999252*kSq[4]+1.777777777777778*epsilon[0]*rdx2Sq[1]-0.3079201435678004*kSq[1]+0.5333333333333333*epsilon[0]*rdx2Sq[0]-0.3555555555555556*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[4], globalIdxs[5], (-0.01721325931647741*kSq[7])-0.05678902799999467*kSq[5]-0.03975231959999626*kSq[4]+0.01333333333333333*kSq[3]-0.4444444444444444*epsilon[0]*rdx2Sq[1]+0.03849001794597505*kSq[1]-0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[4], globalIdxs[6], 0.03442651863295482*kSq[7]+0.03442651863295482*kSq[6]+0.09938079899999068*kSq[5]+0.09938079899999068*kSq[4]-0.02666666666666666*kSq[3]-0.0769800358919501*kSq[2]-0.0769800358919501*kSq[1]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[4], globalIdxs[7], (-0.0295084445425327*kSq[7])-0.03442651863295482*kSq[6]-0.063887656499994*kSq[5]-0.05962847939999439*kSq[4]-0.05333333333333333*kSq[3]-0.03849001794597505*kSq[2]-0.8888888888888888*epsilon[0]*rdx2Sq[1]+0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[5], globalIdxs[0], (-0.006147592613027645*kSq[7])+0.02697478829999747*kSq[5]+0.03336355394999686*kSq[4]+0.3111111111111111*epsilon[0]*rdx2Sq[1]-0.01924500897298752*kSq[1]+(0.06666666666666667*bcVals[0]*epsilon[0]*rdx2Sq[0])/bcVals[1]+0.1888888888888889*epsilon[0]*rdx2Sq[0]-0.02222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[5], globalIdxs[1], 0.01721325931647741*kSq[6]-0.03975231959999626*kSq[5]-0.05678902799999467*kSq[4]+0.01333333333333333*kSq[3]-0.03849001794597505*kSq[2]-0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.4444444444444444*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[5], globalIdxs[2], 0.0234254740499978*kSq[5]+0.0234254740499978*kSq[4]-0.01333333333333333*kSq[3]+0.2555555555555555*epsilon[0]*rdx2Sq[1]+0.2555555555555555*epsilon[0]*rdx2Sq[0]-0.03333333333333333*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[5], globalIdxs[3], 0.0295084445425327*kSq[7]-0.03442651863295482*kSq[6]-0.063887656499994*kSq[5]-0.05962847939999439*kSq[4]+0.05333333333333333*kSq[3]-0.03849001794597505*kSq[2]-0.8888888888888888*epsilon[0]*rdx2Sq[1]-(0.1333333333333333*bcVals[0]*epsilon[0]*rdx2Sq[0])/bcVals[1]+0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[5], globalIdxs[4], (-0.01721325931647741*kSq[7])-0.05678902799999467*kSq[5]-0.03975231959999626*kSq[4]+0.01333333333333333*kSq[3]-0.4444444444444444*epsilon[0]*rdx2Sq[1]+0.03849001794597505*kSq[1]-0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[5], globalIdxs[5], 0.04549218533640458*kSq[7]-0.04549218533640458*kSq[6]-0.0127775312999988*kSq[5]-0.0127775312999988*kSq[4]+0.04666666666666667*kSq[3]-0.03849001794597505*kSq[2]+0.5777777777777777*epsilon[0]*rdx2Sq[1]+0.03849001794597505*kSq[1]-(0.2666666666666667*bcVals[0]*epsilon[0]*rdx2Sq[0])/bcVals[1]+0.5777777777777777*epsilon[0]*rdx2Sq[0]-0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[5], globalIdxs[6], 0.03442651863295482*kSq[7]-0.0295084445425327*kSq[6]-0.05962847939999439*kSq[5]-0.063887656499994*kSq[4]+0.05333333333333333*kSq[3]+0.06666666666666667*epsilon[0]*rdx2Sq[1]+0.03849001794597505*kSq[1]-0.8888888888888888*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[5], globalIdxs[7], 0.006147592613027645*kSq[6]+0.03336355394999686*kSq[5]+0.02697478829999747*kSq[4]+0.01924500897298752*kSq[2]+0.1888888888888889*epsilon[0]*rdx2Sq[1]+0.3111111111111111*epsilon[0]*rdx2Sq[0]-0.02222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[6], globalIdxs[0], (-0.01721325931647741*kSq[6])-0.03975231959999626*kSq[5]-0.05678902799999467*kSq[4]-0.01333333333333333*kSq[3]+0.03849001794597505*kSq[2]-0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.4444444444444444*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[6], globalIdxs[1], 0.07950463919999252*kSq[5]+0.1135780559999893*kSq[4]-0.5333333333333333*epsilon[0]*rdx2Sq[1]+0.8888888888888888*epsilon[0]*rdx2Sq[0]-0.1777777777777778*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[6], globalIdxs[2], (-0.01721325931647741*kSq[6])-0.03975231959999626*kSq[5]-0.05678902799999467*kSq[4]+0.01333333333333333*kSq[3]+0.03849001794597505*kSq[2]-0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.4444444444444444*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[6], globalIdxs[3], (-0.03442651863295482*kSq[7])+0.03442651863295482*kSq[6]+0.09938079899999068*kSq[5]+0.09938079899999068*kSq[4]+0.02666666666666666*kSq[3]-0.0769800358919501*kSq[2]+0.0769800358919501*kSq[1]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[6], globalIdxs[4], 0.03442651863295482*kSq[7]+0.03442651863295482*kSq[6]+0.09938079899999068*kSq[5]+0.09938079899999068*kSq[4]-0.02666666666666666*kSq[3]-0.0769800358919501*kSq[2]-0.0769800358919501*kSq[1]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[6], globalIdxs[5], 0.03442651863295482*kSq[7]-0.0295084445425327*kSq[6]-0.05962847939999439*kSq[5]-0.063887656499994*kSq[4]+0.05333333333333333*kSq[3]+0.06666666666666667*epsilon[0]*rdx2Sq[1]+0.03849001794597505*kSq[1]-0.8888888888888888*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[6], globalIdxs[6], 0.1967229636168847*kSq[6]-0.07950463919999252*kSq[5]+0.2271561119999787*kSq[4]-0.3079201435678004*kSq[2]+0.5333333333333333*epsilon[0]*rdx2Sq[1]+1.777777777777778*epsilon[0]*rdx2Sq[0]-0.3555555555555556*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[6], globalIdxs[7], (-0.03442651863295482*kSq[7])-0.0295084445425327*kSq[6]-0.05962847939999439*kSq[5]-0.063887656499994*kSq[4]-0.05333333333333333*kSq[3]+0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.03849001794597505*kSq[1]-0.8888888888888888*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[7], globalIdxs[0], 0.0234254740499978*kSq[5]+0.0234254740499978*kSq[4]+0.01333333333333333*kSq[3]+0.2555555555555555*epsilon[0]*rdx2Sq[1]+0.2555555555555555*epsilon[0]*rdx2Sq[0]-0.03333333333333333*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[7], globalIdxs[1], 0.01721325931647741*kSq[6]-0.03975231959999626*kSq[5]-0.05678902799999467*kSq[4]-0.01333333333333333*kSq[3]-0.03849001794597505*kSq[2]-0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.4444444444444444*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[7], globalIdxs[2], 0.006147592613027645*kSq[7]+0.02697478829999747*kSq[5]+0.03336355394999686*kSq[4]+0.3111111111111111*epsilon[0]*rdx2Sq[1]+0.01924500897298752*kSq[1]+0.1888888888888889*epsilon[0]*rdx2Sq[0]-0.02222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[7], globalIdxs[3], 0.01721325931647741*kSq[7]-0.05678902799999467*kSq[5]-0.03975231959999626*kSq[4]-0.01333333333333333*kSq[3]-0.4444444444444444*epsilon[0]*rdx2Sq[1]-0.03849001794597505*kSq[1]-0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[7], globalIdxs[4], (-0.0295084445425327*kSq[7])-0.03442651863295482*kSq[6]-0.063887656499994*kSq[5]-0.05962847939999439*kSq[4]-0.05333333333333333*kSq[3]-0.03849001794597505*kSq[2]-0.8888888888888888*epsilon[0]*rdx2Sq[1]+0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[7], globalIdxs[5], 0.006147592613027645*kSq[6]+0.03336355394999686*kSq[5]+0.02697478829999747*kSq[4]+0.01924500897298752*kSq[2]+0.1888888888888889*epsilon[0]*rdx2Sq[1]+0.3111111111111111*epsilon[0]*rdx2Sq[0]-0.02222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[7], globalIdxs[6], (-0.03442651863295482*kSq[7])-0.0295084445425327*kSq[6]-0.05962847939999439*kSq[5]-0.063887656499994*kSq[4]-0.05333333333333333*kSq[3]+0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.03849001794597505*kSq[1]-0.8888888888888888*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[7], globalIdxs[7], (-0.04549218533640458*kSq[7])-0.04549218533640458*kSq[6]-0.0127775312999988*kSq[5]-0.0127775312999988*kSq[4]-0.04666666666666667*kSq[3]-0.03849001794597505*kSq[2]+0.5777777777777777*epsilon[0]*rdx2Sq[1]-0.03849001794597505*kSq[1]+0.5777777777777777*epsilon[0]*rdx2Sq[0]-0.06666666666666667*kSq[0]);

}
void fem_poisson_lhs_stencil_consteps_2x_ser_p1_upx_periodicx_iny_periodicy(const double *epsilon, const double *kSq, const double *dx, const double *bcVals, const long *globalIdxs, gkyl_mat_triples *tri) 
{ 
  // epsilon: permittivity.
  // kSq: wave number squared (factor multiplying phi).
  // dx: cell length in each direction.
  // bcVals[3]: values to impose as BCs, i.e. bcVals[0]*phi+bcVals[1]*d(phi)/dx=bcVals[2].
  // globalIdxs: global linear index of each basis function/node in current cell.
  // tri: triples object (i,j,val), i.e. contribute val to i,j element of the global matrix.

  double rdx2Sq[2];
  rdx2Sq[0] = 4.0/(dx[0]*dx[0]);
  rdx2Sq[1] = 4.0/(dx[1]*dx[1]);

  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[0], (-0.1666666666666667*kSq[3])+0.1924500897298752*kSq[2]+0.3333333333333333*epsilon[0]*rdx2Sq[1]+0.1924500897298752*kSq[1]+0.3333333333333333*epsilon[0]*rdx2Sq[0]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[1], 0.09622504486493762*kSq[2]+0.1666666666666667*epsilon[0]*rdx2Sq[1]-0.3333333333333333*epsilon[0]*rdx2Sq[0]-0.1111111111111111*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[2], (-0.3333333333333333*epsilon[0]*rdx2Sq[1])+0.09622504486493762*kSq[1]+0.1666666666666667*epsilon[0]*rdx2Sq[0]-0.1111111111111111*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[3], (-0.1666666666666667*epsilon[0]*rdx2Sq[1])-0.1666666666666667*epsilon[0]*rdx2Sq[0]-0.05555555555555555*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[0], 0.09622504486493762*kSq[2]+0.1666666666666667*epsilon[0]*rdx2Sq[1]-0.3333333333333333*epsilon[0]*rdx2Sq[0]-0.1111111111111111*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[1], 0.1666666666666667*kSq[3]+0.1924500897298752*kSq[2]+0.3333333333333333*epsilon[0]*rdx2Sq[1]-0.1924500897298752*kSq[1]+0.3333333333333333*epsilon[0]*rdx2Sq[0]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[2], (-0.1666666666666667*epsilon[0]*rdx2Sq[1])-0.1666666666666667*epsilon[0]*rdx2Sq[0]-0.05555555555555555*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[3], (-0.3333333333333333*epsilon[0]*rdx2Sq[1])-0.09622504486493762*kSq[1]+0.1666666666666667*epsilon[0]*rdx2Sq[0]-0.1111111111111111*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[0], (-0.3333333333333333*epsilon[0]*rdx2Sq[1])+0.09622504486493762*kSq[1]+0.1666666666666667*epsilon[0]*rdx2Sq[0]-0.1111111111111111*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[1], (-0.1666666666666667*epsilon[0]*rdx2Sq[1])-0.1666666666666667*epsilon[0]*rdx2Sq[0]-0.05555555555555555*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[2], 0.1666666666666667*kSq[3]-0.1924500897298752*kSq[2]+0.3333333333333333*epsilon[0]*rdx2Sq[1]+0.1924500897298752*kSq[1]+0.3333333333333333*epsilon[0]*rdx2Sq[0]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[3], (-0.09622504486493762*kSq[2])+0.1666666666666667*epsilon[0]*rdx2Sq[1]-0.3333333333333333*epsilon[0]*rdx2Sq[0]-0.1111111111111111*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[0], (-0.1666666666666667*epsilon[0]*rdx2Sq[1])-0.1666666666666667*epsilon[0]*rdx2Sq[0]-0.05555555555555555*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[1], (-0.3333333333333333*epsilon[0]*rdx2Sq[1])-0.09622504486493762*kSq[1]+0.1666666666666667*epsilon[0]*rdx2Sq[0]-0.1111111111111111*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[2], (-0.09622504486493762*kSq[2])+0.1666666666666667*epsilon[0]*rdx2Sq[1]-0.3333333333333333*epsilon[0]*rdx2Sq[0]-0.1111111111111111*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[3], (-0.1666666666666667*kSq[3])-0.1924500897298752*kSq[2]+0.3333333333333333*epsilon[0]*rdx2Sq[1]-0.1924500897298752*kSq[1]+0.3333333333333333*epsilon[0]*rdx2Sq[0]-0.2222222222222222*kSq[0]);

}
void fem_poisson_lhs_stencil_consteps_2x_ser_p2_upx_periodicx_iny_periodicy(const double *epsilon, const double *kSq, const double *dx, const double *bcVals, const long *globalIdxs, gkyl_mat_triples *tri) 
{ 
  // epsilon: permittivity.
  // kSq: wave number squared (factor multiplying phi).
  // dx: cell length in each direction.
  // bcVals[3]: values to impose as BCs, i.e. bcVals[0]*phi+bcVals[1]*d(phi)/dx=bcVals[2].
  // globalIdxs: global linear index of each basis function/node in current cell.
  // tri: triples object (i,j,val), i.e. contribute val to i,j element of the global matrix.

  double rdx2Sq[2];
  rdx2Sq[0] = 4.0/(dx[0]*dx[0]);
  rdx2Sq[1] = 4.0/(dx[1]*dx[1]);

  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[0], 0.04549218533640458*kSq[7]+0.04549218533640458*kSq[6]-0.0127775312999988*kSq[5]-0.0127775312999988*kSq[4]-0.04666666666666667*kSq[3]+0.03849001794597505*kSq[2]+0.5777777777777777*epsilon[0]*rdx2Sq[1]+0.03849001794597505*kSq[1]+0.5777777777777777*epsilon[0]*rdx2Sq[0]-0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[1], 0.03442651863295482*kSq[7]+0.0295084445425327*kSq[6]-0.05962847939999439*kSq[5]-0.063887656499994*kSq[4]-0.05333333333333333*kSq[3]+0.06666666666666667*epsilon[0]*rdx2Sq[1]+0.03849001794597505*kSq[1]-0.8888888888888888*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[2], (-0.006147592613027645*kSq[6])+0.03336355394999686*kSq[5]+0.02697478829999747*kSq[4]-0.01924500897298752*kSq[2]+0.1888888888888889*epsilon[0]*rdx2Sq[1]+0.3111111111111111*epsilon[0]*rdx2Sq[0]-0.02222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[3], 0.0295084445425327*kSq[7]+0.03442651863295482*kSq[6]-0.063887656499994*kSq[5]-0.05962847939999439*kSq[4]-0.05333333333333333*kSq[3]+0.03849001794597505*kSq[2]-0.8888888888888888*epsilon[0]*rdx2Sq[1]+0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[4], (-0.01721325931647741*kSq[7])-0.05678902799999467*kSq[5]-0.03975231959999626*kSq[4]-0.01333333333333333*kSq[3]-0.4444444444444444*epsilon[0]*rdx2Sq[1]+0.03849001794597505*kSq[1]-0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[5], (-0.006147592613027645*kSq[7])+0.02697478829999747*kSq[5]+0.03336355394999686*kSq[4]+0.3111111111111111*epsilon[0]*rdx2Sq[1]-0.01924500897298752*kSq[1]+0.1888888888888889*epsilon[0]*rdx2Sq[0]-0.02222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[6], (-0.01721325931647741*kSq[6])-0.03975231959999626*kSq[5]-0.05678902799999467*kSq[4]-0.01333333333333333*kSq[3]+0.03849001794597505*kSq[2]-0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.4444444444444444*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[7], 0.0234254740499978*kSq[5]+0.0234254740499978*kSq[4]+0.01333333333333333*kSq[3]+0.2555555555555555*epsilon[0]*rdx2Sq[1]+0.2555555555555555*epsilon[0]*rdx2Sq[0]-0.03333333333333333*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[0], 0.03442651863295482*kSq[7]+0.0295084445425327*kSq[6]-0.05962847939999439*kSq[5]-0.063887656499994*kSq[4]-0.05333333333333333*kSq[3]+0.06666666666666667*epsilon[0]*rdx2Sq[1]+0.03849001794597505*kSq[1]-0.8888888888888888*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[1], (-0.1967229636168847*kSq[6])-0.07950463919999252*kSq[5]+0.2271561119999787*kSq[4]+0.3079201435678004*kSq[2]+0.5333333333333333*epsilon[0]*rdx2Sq[1]+1.777777777777778*epsilon[0]*rdx2Sq[0]-0.3555555555555556*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[2], (-0.03442651863295482*kSq[7])+0.0295084445425327*kSq[6]-0.05962847939999439*kSq[5]-0.063887656499994*kSq[4]+0.05333333333333333*kSq[3]+0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.03849001794597505*kSq[1]-0.8888888888888888*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[3], (-0.03442651863295482*kSq[7])-0.03442651863295482*kSq[6]+0.09938079899999068*kSq[5]+0.09938079899999068*kSq[4]-0.02666666666666666*kSq[3]+0.0769800358919501*kSq[2]+0.0769800358919501*kSq[1]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[4], 0.03442651863295482*kSq[7]-0.03442651863295482*kSq[6]+0.09938079899999068*kSq[5]+0.09938079899999068*kSq[4]+0.02666666666666666*kSq[3]+0.0769800358919501*kSq[2]-0.0769800358919501*kSq[1]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[5], 0.01721325931647741*kSq[6]-0.03975231959999626*kSq[5]-0.05678902799999467*kSq[4]+0.01333333333333333*kSq[3]-0.03849001794597505*kSq[2]-0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.4444444444444444*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[6], 0.07950463919999252*kSq[5]+0.1135780559999893*kSq[4]-0.5333333333333333*epsilon[0]*rdx2Sq[1]+0.8888888888888888*epsilon[0]*rdx2Sq[0]-0.1777777777777778*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[7], 0.01721325931647741*kSq[6]-0.03975231959999626*kSq[5]-0.05678902799999467*kSq[4]-0.01333333333333333*kSq[3]-0.03849001794597505*kSq[2]-0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.4444444444444444*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[0], (-0.006147592613027645*kSq[6])+0.03336355394999686*kSq[5]+0.02697478829999747*kSq[4]-0.01924500897298752*kSq[2]+0.1888888888888889*epsilon[0]*rdx2Sq[1]+0.3111111111111111*epsilon[0]*rdx2Sq[0]-0.02222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[1], (-0.03442651863295482*kSq[7])+0.0295084445425327*kSq[6]-0.05962847939999439*kSq[5]-0.063887656499994*kSq[4]+0.05333333333333333*kSq[3]+0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.03849001794597505*kSq[1]-0.8888888888888888*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[2], (-0.04549218533640458*kSq[7])+0.04549218533640458*kSq[6]-0.0127775312999988*kSq[5]-0.0127775312999988*kSq[4]+0.04666666666666667*kSq[3]+0.03849001794597505*kSq[2]+0.5777777777777777*epsilon[0]*rdx2Sq[1]-0.03849001794597505*kSq[1]+0.5777777777777777*epsilon[0]*rdx2Sq[0]-0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[3], 0.01721325931647741*kSq[7]-0.05678902799999467*kSq[5]-0.03975231959999626*kSq[4]+0.01333333333333333*kSq[3]-0.4444444444444444*epsilon[0]*rdx2Sq[1]-0.03849001794597505*kSq[1]-0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[4], (-0.0295084445425327*kSq[7])+0.03442651863295482*kSq[6]-0.063887656499994*kSq[5]-0.05962847939999439*kSq[4]+0.05333333333333333*kSq[3]+0.03849001794597505*kSq[2]-0.8888888888888888*epsilon[0]*rdx2Sq[1]+0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[5], 0.0234254740499978*kSq[5]+0.0234254740499978*kSq[4]-0.01333333333333333*kSq[3]+0.2555555555555555*epsilon[0]*rdx2Sq[1]+0.2555555555555555*epsilon[0]*rdx2Sq[0]-0.03333333333333333*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[6], (-0.01721325931647741*kSq[6])-0.03975231959999626*kSq[5]-0.05678902799999467*kSq[4]+0.01333333333333333*kSq[3]+0.03849001794597505*kSq[2]-0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.4444444444444444*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[7], 0.006147592613027645*kSq[7]+0.02697478829999747*kSq[5]+0.03336355394999686*kSq[4]+0.3111111111111111*epsilon[0]*rdx2Sq[1]+0.01924500897298752*kSq[1]+0.1888888888888889*epsilon[0]*rdx2Sq[0]-0.02222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[0], 0.0295084445425327*kSq[7]+0.03442651863295482*kSq[6]-0.063887656499994*kSq[5]-0.05962847939999439*kSq[4]-0.05333333333333333*kSq[3]+0.03849001794597505*kSq[2]-0.8888888888888888*epsilon[0]*rdx2Sq[1]+0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[1], (-0.03442651863295482*kSq[7])-0.03442651863295482*kSq[6]+0.09938079899999068*kSq[5]+0.09938079899999068*kSq[4]-0.02666666666666666*kSq[3]+0.0769800358919501*kSq[2]+0.0769800358919501*kSq[1]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[2], 0.01721325931647741*kSq[7]-0.05678902799999467*kSq[5]-0.03975231959999626*kSq[4]+0.01333333333333333*kSq[3]-0.4444444444444444*epsilon[0]*rdx2Sq[1]-0.03849001794597505*kSq[1]-0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[3], (-0.1967229636168847*kSq[7])+0.2271561119999787*kSq[5]-0.07950463919999252*kSq[4]+1.777777777777778*epsilon[0]*rdx2Sq[1]+0.3079201435678004*kSq[1]+0.5333333333333333*epsilon[0]*rdx2Sq[0]-0.3555555555555556*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[4], 0.1135780559999893*kSq[5]+0.07950463919999252*kSq[4]+0.8888888888888888*epsilon[0]*rdx2Sq[1]-0.5333333333333333*epsilon[0]*rdx2Sq[0]-0.1777777777777778*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[5], 0.0295084445425327*kSq[7]-0.03442651863295482*kSq[6]-0.063887656499994*kSq[5]-0.05962847939999439*kSq[4]+0.05333333333333333*kSq[3]-0.03849001794597505*kSq[2]-0.8888888888888888*epsilon[0]*rdx2Sq[1]+0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[6], (-0.03442651863295482*kSq[7])+0.03442651863295482*kSq[6]+0.09938079899999068*kSq[5]+0.09938079899999068*kSq[4]+0.02666666666666666*kSq[3]-0.0769800358919501*kSq[2]+0.0769800358919501*kSq[1]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[7], 0.01721325931647741*kSq[7]-0.05678902799999467*kSq[5]-0.03975231959999626*kSq[4]-0.01333333333333333*kSq[3]-0.4444444444444444*epsilon[0]*rdx2Sq[1]-0.03849001794597505*kSq[1]-0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[4], globalIdxs[0], (-0.01721325931647741*kSq[7])-0.05678902799999467*kSq[5]-0.03975231959999626*kSq[4]-0.01333333333333333*kSq[3]-0.4444444444444444*epsilon[0]*rdx2Sq[1]+0.03849001794597505*kSq[1]-0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[4], globalIdxs[1], 0.03442651863295482*kSq[7]-0.03442651863295482*kSq[6]+0.09938079899999068*kSq[5]+0.09938079899999068*kSq[4]+0.02666666666666666*kSq[3]+0.0769800358919501*kSq[2]-0.0769800358919501*kSq[1]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[4], globalIdxs[2], (-0.0295084445425327*kSq[7])+0.03442651863295482*kSq[6]-0.063887656499994*kSq[5]-0.05962847939999439*kSq[4]+0.05333333333333333*kSq[3]+0.03849001794597505*kSq[2]-0.8888888888888888*epsilon[0]*rdx2Sq[1]+0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[4], globalIdxs[3], 0.1135780559999893*kSq[5]+0.07950463919999252*kSq[4]+0.8888888888888888*epsilon[0]*rdx2Sq[1]-0.5333333333333333*epsilon[0]*rdx2Sq[0]-0.1777777777777778*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[4], globalIdxs[4], 0.1967229636168847*kSq[7]+0.2271561119999787*kSq[5]-0.07950463919999252*kSq[4]+1.777777777777778*epsilon[0]*rdx2Sq[1]-0.3079201435678004*kSq[1]+0.5333333333333333*epsilon[0]*rdx2Sq[0]-0.3555555555555556*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[4], globalIdxs[5], (-0.01721325931647741*kSq[7])-0.05678902799999467*kSq[5]-0.03975231959999626*kSq[4]+0.01333333333333333*kSq[3]-0.4444444444444444*epsilon[0]*rdx2Sq[1]+0.03849001794597505*kSq[1]-0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[4], globalIdxs[6], 0.03442651863295482*kSq[7]+0.03442651863295482*kSq[6]+0.09938079899999068*kSq[5]+0.09938079899999068*kSq[4]-0.02666666666666666*kSq[3]-0.0769800358919501*kSq[2]-0.0769800358919501*kSq[1]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[4], globalIdxs[7], (-0.0295084445425327*kSq[7])-0.03442651863295482*kSq[6]-0.063887656499994*kSq[5]-0.05962847939999439*kSq[4]-0.05333333333333333*kSq[3]-0.03849001794597505*kSq[2]-0.8888888888888888*epsilon[0]*rdx2Sq[1]+0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[5], globalIdxs[0], (-0.006147592613027645*kSq[7])+0.02697478829999747*kSq[5]+0.03336355394999686*kSq[4]+0.3111111111111111*epsilon[0]*rdx2Sq[1]-0.01924500897298752*kSq[1]+0.1888888888888889*epsilon[0]*rdx2Sq[0]-0.02222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[5], globalIdxs[1], 0.01721325931647741*kSq[6]-0.03975231959999626*kSq[5]-0.05678902799999467*kSq[4]+0.01333333333333333*kSq[3]-0.03849001794597505*kSq[2]-0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.4444444444444444*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[5], globalIdxs[2], 0.0234254740499978*kSq[5]+0.0234254740499978*kSq[4]-0.01333333333333333*kSq[3]+0.2555555555555555*epsilon[0]*rdx2Sq[1]+0.2555555555555555*epsilon[0]*rdx2Sq[0]-0.03333333333333333*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[5], globalIdxs[3], 0.0295084445425327*kSq[7]-0.03442651863295482*kSq[6]-0.063887656499994*kSq[5]-0.05962847939999439*kSq[4]+0.05333333333333333*kSq[3]-0.03849001794597505*kSq[2]-0.8888888888888888*epsilon[0]*rdx2Sq[1]+0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[5], globalIdxs[4], (-0.01721325931647741*kSq[7])-0.05678902799999467*kSq[5]-0.03975231959999626*kSq[4]+0.01333333333333333*kSq[3]-0.4444444444444444*epsilon[0]*rdx2Sq[1]+0.03849001794597505*kSq[1]-0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[5], globalIdxs[5], 0.04549218533640458*kSq[7]-0.04549218533640458*kSq[6]-0.0127775312999988*kSq[5]-0.0127775312999988*kSq[4]+0.04666666666666667*kSq[3]-0.03849001794597505*kSq[2]+0.5777777777777777*epsilon[0]*rdx2Sq[1]+0.03849001794597505*kSq[1]+0.5777777777777777*epsilon[0]*rdx2Sq[0]-0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[5], globalIdxs[6], 0.03442651863295482*kSq[7]-0.0295084445425327*kSq[6]-0.05962847939999439*kSq[5]-0.063887656499994*kSq[4]+0.05333333333333333*kSq[3]+0.06666666666666667*epsilon[0]*rdx2Sq[1]+0.03849001794597505*kSq[1]-0.8888888888888888*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[5], globalIdxs[7], 0.006147592613027645*kSq[6]+0.03336355394999686*kSq[5]+0.02697478829999747*kSq[4]+0.01924500897298752*kSq[2]+0.1888888888888889*epsilon[0]*rdx2Sq[1]+0.3111111111111111*epsilon[0]*rdx2Sq[0]-0.02222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[6], globalIdxs[0], (-0.01721325931647741*kSq[6])-0.03975231959999626*kSq[5]-0.05678902799999467*kSq[4]-0.01333333333333333*kSq[3]+0.03849001794597505*kSq[2]-0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.4444444444444444*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[6], globalIdxs[1], 0.07950463919999252*kSq[5]+0.1135780559999893*kSq[4]-0.5333333333333333*epsilon[0]*rdx2Sq[1]+0.8888888888888888*epsilon[0]*rdx2Sq[0]-0.1777777777777778*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[6], globalIdxs[2], (-0.01721325931647741*kSq[6])-0.03975231959999626*kSq[5]-0.05678902799999467*kSq[4]+0.01333333333333333*kSq[3]+0.03849001794597505*kSq[2]-0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.4444444444444444*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[6], globalIdxs[3], (-0.03442651863295482*kSq[7])+0.03442651863295482*kSq[6]+0.09938079899999068*kSq[5]+0.09938079899999068*kSq[4]+0.02666666666666666*kSq[3]-0.0769800358919501*kSq[2]+0.0769800358919501*kSq[1]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[6], globalIdxs[4], 0.03442651863295482*kSq[7]+0.03442651863295482*kSq[6]+0.09938079899999068*kSq[5]+0.09938079899999068*kSq[4]-0.02666666666666666*kSq[3]-0.0769800358919501*kSq[2]-0.0769800358919501*kSq[1]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[6], globalIdxs[5], 0.03442651863295482*kSq[7]-0.0295084445425327*kSq[6]-0.05962847939999439*kSq[5]-0.063887656499994*kSq[4]+0.05333333333333333*kSq[3]+0.06666666666666667*epsilon[0]*rdx2Sq[1]+0.03849001794597505*kSq[1]-0.8888888888888888*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[6], globalIdxs[6], 0.1967229636168847*kSq[6]-0.07950463919999252*kSq[5]+0.2271561119999787*kSq[4]-0.3079201435678004*kSq[2]+0.5333333333333333*epsilon[0]*rdx2Sq[1]+1.777777777777778*epsilon[0]*rdx2Sq[0]-0.3555555555555556*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[6], globalIdxs[7], (-0.03442651863295482*kSq[7])-0.0295084445425327*kSq[6]-0.05962847939999439*kSq[5]-0.063887656499994*kSq[4]-0.05333333333333333*kSq[3]+0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.03849001794597505*kSq[1]-0.8888888888888888*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[7], globalIdxs[0], 0.0234254740499978*kSq[5]+0.0234254740499978*kSq[4]+0.01333333333333333*kSq[3]+0.2555555555555555*epsilon[0]*rdx2Sq[1]+0.2555555555555555*epsilon[0]*rdx2Sq[0]-0.03333333333333333*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[7], globalIdxs[1], 0.01721325931647741*kSq[6]-0.03975231959999626*kSq[5]-0.05678902799999467*kSq[4]-0.01333333333333333*kSq[3]-0.03849001794597505*kSq[2]-0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.4444444444444444*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[7], globalIdxs[2], 0.006147592613027645*kSq[7]+0.02697478829999747*kSq[5]+0.03336355394999686*kSq[4]+0.3111111111111111*epsilon[0]*rdx2Sq[1]+0.01924500897298752*kSq[1]+0.1888888888888889*epsilon[0]*rdx2Sq[0]-0.02222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[7], globalIdxs[3], 0.01721325931647741*kSq[7]-0.05678902799999467*kSq[5]-0.03975231959999626*kSq[4]-0.01333333333333333*kSq[3]-0.4444444444444444*epsilon[0]*rdx2Sq[1]-0.03849001794597505*kSq[1]-0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[7], globalIdxs[4], (-0.0295084445425327*kSq[7])-0.03442651863295482*kSq[6]-0.063887656499994*kSq[5]-0.05962847939999439*kSq[4]-0.05333333333333333*kSq[3]-0.03849001794597505*kSq[2]-0.8888888888888888*epsilon[0]*rdx2Sq[1]+0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[7], globalIdxs[5], 0.006147592613027645*kSq[6]+0.03336355394999686*kSq[5]+0.02697478829999747*kSq[4]+0.01924500897298752*kSq[2]+0.1888888888888889*epsilon[0]*rdx2Sq[1]+0.3111111111111111*epsilon[0]*rdx2Sq[0]-0.02222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[7], globalIdxs[6], (-0.03442651863295482*kSq[7])-0.0295084445425327*kSq[6]-0.05962847939999439*kSq[5]-0.063887656499994*kSq[4]-0.05333333333333333*kSq[3]+0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.03849001794597505*kSq[1]-0.8888888888888888*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[7], globalIdxs[7], (-0.04549218533640458*kSq[7])-0.04549218533640458*kSq[6]-0.0127775312999988*kSq[5]-0.0127775312999988*kSq[4]-0.04666666666666667*kSq[3]-0.03849001794597505*kSq[2]+0.5777777777777777*epsilon[0]*rdx2Sq[1]-0.03849001794597505*kSq[1]+0.5777777777777777*epsilon[0]*rdx2Sq[0]-0.06666666666666667*kSq[0]);

}
void fem_poisson_lhs_stencil_consteps_2x_ser_p1_upx_dirichletx_iny_periodicy(const double *epsilon, const double *kSq, const double *dx, const double *bcVals, const long *globalIdxs, gkyl_mat_triples *tri) 
{ 
  // epsilon: permittivity.
  // kSq: wave number squared (factor multiplying phi).
  // dx: cell length in each direction.
  // bcVals[3]: values to impose as BCs, i.e. bcVals[0]*phi+bcVals[1]*d(phi)/dx=bcVals[2].
  // globalIdxs: global linear index of each basis function/node in current cell.
  // tri: triples object (i,j,val), i.e. contribute val to i,j element of the global matrix.

  double rdx2Sq[2];
  rdx2Sq[0] = 4.0/(dx[0]*dx[0]);
  rdx2Sq[1] = 4.0/(dx[1]*dx[1]);

  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[0], (-0.1666666666666667*kSq[3])+0.1924500897298752*kSq[2]+0.3333333333333333*epsilon[0]*rdx2Sq[1]+0.1924500897298752*kSq[1]+0.3333333333333333*epsilon[0]*rdx2Sq[0]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[1], 0.09622504486493762*kSq[2]+0.1666666666666667*epsilon[0]*rdx2Sq[1]-0.3333333333333333*epsilon[0]*rdx2Sq[0]-0.1111111111111111*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[2], (-0.3333333333333333*epsilon[0]*rdx2Sq[1])+0.09622504486493762*kSq[1]+0.1666666666666667*epsilon[0]*rdx2Sq[0]-0.1111111111111111*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[3], (-0.1666666666666667*epsilon[0]*rdx2Sq[1])-0.1666666666666667*epsilon[0]*rdx2Sq[0]-0.05555555555555555*kSq[0]);
  gkyl_mat_triples_insert(tri, globalIdxs[1], globalIdxs[0], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[1], globalIdxs[1], 1.0);
  gkyl_mat_triples_insert(tri, globalIdxs[1], globalIdxs[2], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[1], globalIdxs[3], 0.0);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[0], (-0.3333333333333333*epsilon[0]*rdx2Sq[1])+0.09622504486493762*kSq[1]+0.1666666666666667*epsilon[0]*rdx2Sq[0]-0.1111111111111111*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[1], (-0.1666666666666667*epsilon[0]*rdx2Sq[1])-0.1666666666666667*epsilon[0]*rdx2Sq[0]-0.05555555555555555*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[2], 0.1666666666666667*kSq[3]-0.1924500897298752*kSq[2]+0.3333333333333333*epsilon[0]*rdx2Sq[1]+0.1924500897298752*kSq[1]+0.3333333333333333*epsilon[0]*rdx2Sq[0]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[3], (-0.09622504486493762*kSq[2])+0.1666666666666667*epsilon[0]*rdx2Sq[1]-0.3333333333333333*epsilon[0]*rdx2Sq[0]-0.1111111111111111*kSq[0]);
  gkyl_mat_triples_insert(tri, globalIdxs[3], globalIdxs[0], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[3], globalIdxs[1], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[3], globalIdxs[2], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[3], globalIdxs[3], 1.0);

}
void fem_poisson_lhs_stencil_consteps_2x_ser_p2_upx_dirichletx_iny_periodicy(const double *epsilon, const double *kSq, const double *dx, const double *bcVals, const long *globalIdxs, gkyl_mat_triples *tri) 
{ 
  // epsilon: permittivity.
  // kSq: wave number squared (factor multiplying phi).
  // dx: cell length in each direction.
  // bcVals[3]: values to impose as BCs, i.e. bcVals[0]*phi+bcVals[1]*d(phi)/dx=bcVals[2].
  // globalIdxs: global linear index of each basis function/node in current cell.
  // tri: triples object (i,j,val), i.e. contribute val to i,j element of the global matrix.

  double rdx2Sq[2];
  rdx2Sq[0] = 4.0/(dx[0]*dx[0]);
  rdx2Sq[1] = 4.0/(dx[1]*dx[1]);

  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[0], 0.04549218533640458*kSq[7]+0.04549218533640458*kSq[6]-0.0127775312999988*kSq[5]-0.0127775312999988*kSq[4]-0.04666666666666667*kSq[3]+0.03849001794597505*kSq[2]+0.5777777777777777*epsilon[0]*rdx2Sq[1]+0.03849001794597505*kSq[1]+0.5777777777777777*epsilon[0]*rdx2Sq[0]-0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[1], 0.03442651863295482*kSq[7]+0.0295084445425327*kSq[6]-0.05962847939999439*kSq[5]-0.063887656499994*kSq[4]-0.05333333333333333*kSq[3]+0.06666666666666667*epsilon[0]*rdx2Sq[1]+0.03849001794597505*kSq[1]-0.8888888888888888*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[2], (-0.006147592613027645*kSq[6])+0.03336355394999686*kSq[5]+0.02697478829999747*kSq[4]-0.01924500897298752*kSq[2]+0.1888888888888889*epsilon[0]*rdx2Sq[1]+0.3111111111111111*epsilon[0]*rdx2Sq[0]-0.02222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[3], 0.0295084445425327*kSq[7]+0.03442651863295482*kSq[6]-0.063887656499994*kSq[5]-0.05962847939999439*kSq[4]-0.05333333333333333*kSq[3]+0.03849001794597505*kSq[2]-0.8888888888888888*epsilon[0]*rdx2Sq[1]+0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[4], (-0.01721325931647741*kSq[7])-0.05678902799999467*kSq[5]-0.03975231959999626*kSq[4]-0.01333333333333333*kSq[3]-0.4444444444444444*epsilon[0]*rdx2Sq[1]+0.03849001794597505*kSq[1]-0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[5], (-0.006147592613027645*kSq[7])+0.02697478829999747*kSq[5]+0.03336355394999686*kSq[4]+0.3111111111111111*epsilon[0]*rdx2Sq[1]-0.01924500897298752*kSq[1]+0.1888888888888889*epsilon[0]*rdx2Sq[0]-0.02222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[6], (-0.01721325931647741*kSq[6])-0.03975231959999626*kSq[5]-0.05678902799999467*kSq[4]-0.01333333333333333*kSq[3]+0.03849001794597505*kSq[2]-0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.4444444444444444*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[7], 0.0234254740499978*kSq[5]+0.0234254740499978*kSq[4]+0.01333333333333333*kSq[3]+0.2555555555555555*epsilon[0]*rdx2Sq[1]+0.2555555555555555*epsilon[0]*rdx2Sq[0]-0.03333333333333333*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[0], 0.03442651863295482*kSq[7]+0.0295084445425327*kSq[6]-0.05962847939999439*kSq[5]-0.063887656499994*kSq[4]-0.05333333333333333*kSq[3]+0.06666666666666667*epsilon[0]*rdx2Sq[1]+0.03849001794597505*kSq[1]-0.8888888888888888*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[1], (-0.1967229636168847*kSq[6])-0.07950463919999252*kSq[5]+0.2271561119999787*kSq[4]+0.3079201435678004*kSq[2]+0.5333333333333333*epsilon[0]*rdx2Sq[1]+1.777777777777778*epsilon[0]*rdx2Sq[0]-0.3555555555555556*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[2], (-0.03442651863295482*kSq[7])+0.0295084445425327*kSq[6]-0.05962847939999439*kSq[5]-0.063887656499994*kSq[4]+0.05333333333333333*kSq[3]+0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.03849001794597505*kSq[1]-0.8888888888888888*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[3], (-0.03442651863295482*kSq[7])-0.03442651863295482*kSq[6]+0.09938079899999068*kSq[5]+0.09938079899999068*kSq[4]-0.02666666666666666*kSq[3]+0.0769800358919501*kSq[2]+0.0769800358919501*kSq[1]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[4], 0.03442651863295482*kSq[7]-0.03442651863295482*kSq[6]+0.09938079899999068*kSq[5]+0.09938079899999068*kSq[4]+0.02666666666666666*kSq[3]+0.0769800358919501*kSq[2]-0.0769800358919501*kSq[1]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[5], 0.01721325931647741*kSq[6]-0.03975231959999626*kSq[5]-0.05678902799999467*kSq[4]+0.01333333333333333*kSq[3]-0.03849001794597505*kSq[2]-0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.4444444444444444*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[6], 0.07950463919999252*kSq[5]+0.1135780559999893*kSq[4]-0.5333333333333333*epsilon[0]*rdx2Sq[1]+0.8888888888888888*epsilon[0]*rdx2Sq[0]-0.1777777777777778*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[7], 0.01721325931647741*kSq[6]-0.03975231959999626*kSq[5]-0.05678902799999467*kSq[4]-0.01333333333333333*kSq[3]-0.03849001794597505*kSq[2]-0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.4444444444444444*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_insert(tri, globalIdxs[2], globalIdxs[0], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[2], globalIdxs[1], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[2], globalIdxs[2], 1.0);
  gkyl_mat_triples_insert(tri, globalIdxs[2], globalIdxs[3], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[2], globalIdxs[4], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[2], globalIdxs[5], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[2], globalIdxs[6], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[2], globalIdxs[7], 0.0);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[0], 0.0295084445425327*kSq[7]+0.03442651863295482*kSq[6]-0.063887656499994*kSq[5]-0.05962847939999439*kSq[4]-0.05333333333333333*kSq[3]+0.03849001794597505*kSq[2]-0.8888888888888888*epsilon[0]*rdx2Sq[1]+0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[1], (-0.03442651863295482*kSq[7])-0.03442651863295482*kSq[6]+0.09938079899999068*kSq[5]+0.09938079899999068*kSq[4]-0.02666666666666666*kSq[3]+0.0769800358919501*kSq[2]+0.0769800358919501*kSq[1]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[2], 0.01721325931647741*kSq[7]-0.05678902799999467*kSq[5]-0.03975231959999626*kSq[4]+0.01333333333333333*kSq[3]-0.4444444444444444*epsilon[0]*rdx2Sq[1]-0.03849001794597505*kSq[1]-0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[3], (-0.1967229636168847*kSq[7])+0.2271561119999787*kSq[5]-0.07950463919999252*kSq[4]+1.777777777777778*epsilon[0]*rdx2Sq[1]+0.3079201435678004*kSq[1]+0.5333333333333333*epsilon[0]*rdx2Sq[0]-0.3555555555555556*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[4], 0.1135780559999893*kSq[5]+0.07950463919999252*kSq[4]+0.8888888888888888*epsilon[0]*rdx2Sq[1]-0.5333333333333333*epsilon[0]*rdx2Sq[0]-0.1777777777777778*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[5], 0.0295084445425327*kSq[7]-0.03442651863295482*kSq[6]-0.063887656499994*kSq[5]-0.05962847939999439*kSq[4]+0.05333333333333333*kSq[3]-0.03849001794597505*kSq[2]-0.8888888888888888*epsilon[0]*rdx2Sq[1]+0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[6], (-0.03442651863295482*kSq[7])+0.03442651863295482*kSq[6]+0.09938079899999068*kSq[5]+0.09938079899999068*kSq[4]+0.02666666666666666*kSq[3]-0.0769800358919501*kSq[2]+0.0769800358919501*kSq[1]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[7], 0.01721325931647741*kSq[7]-0.05678902799999467*kSq[5]-0.03975231959999626*kSq[4]-0.01333333333333333*kSq[3]-0.4444444444444444*epsilon[0]*rdx2Sq[1]-0.03849001794597505*kSq[1]-0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_insert(tri, globalIdxs[4], globalIdxs[0], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[4], globalIdxs[1], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[4], globalIdxs[2], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[4], globalIdxs[3], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[4], globalIdxs[4], 1.0);
  gkyl_mat_triples_insert(tri, globalIdxs[4], globalIdxs[5], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[4], globalIdxs[6], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[4], globalIdxs[7], 0.0);
  gkyl_mat_triples_accum(tri, globalIdxs[5], globalIdxs[0], (-0.006147592613027645*kSq[7])+0.02697478829999747*kSq[5]+0.03336355394999686*kSq[4]+0.3111111111111111*epsilon[0]*rdx2Sq[1]-0.01924500897298752*kSq[1]+0.1888888888888889*epsilon[0]*rdx2Sq[0]-0.02222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[5], globalIdxs[1], 0.01721325931647741*kSq[6]-0.03975231959999626*kSq[5]-0.05678902799999467*kSq[4]+0.01333333333333333*kSq[3]-0.03849001794597505*kSq[2]-0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.4444444444444444*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[5], globalIdxs[2], 0.0234254740499978*kSq[5]+0.0234254740499978*kSq[4]-0.01333333333333333*kSq[3]+0.2555555555555555*epsilon[0]*rdx2Sq[1]+0.2555555555555555*epsilon[0]*rdx2Sq[0]-0.03333333333333333*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[5], globalIdxs[3], 0.0295084445425327*kSq[7]-0.03442651863295482*kSq[6]-0.063887656499994*kSq[5]-0.05962847939999439*kSq[4]+0.05333333333333333*kSq[3]-0.03849001794597505*kSq[2]-0.8888888888888888*epsilon[0]*rdx2Sq[1]+0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[5], globalIdxs[4], (-0.01721325931647741*kSq[7])-0.05678902799999467*kSq[5]-0.03975231959999626*kSq[4]+0.01333333333333333*kSq[3]-0.4444444444444444*epsilon[0]*rdx2Sq[1]+0.03849001794597505*kSq[1]-0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[5], globalIdxs[5], 0.04549218533640458*kSq[7]-0.04549218533640458*kSq[6]-0.0127775312999988*kSq[5]-0.0127775312999988*kSq[4]+0.04666666666666667*kSq[3]-0.03849001794597505*kSq[2]+0.5777777777777777*epsilon[0]*rdx2Sq[1]+0.03849001794597505*kSq[1]+0.5777777777777777*epsilon[0]*rdx2Sq[0]-0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[5], globalIdxs[6], 0.03442651863295482*kSq[7]-0.0295084445425327*kSq[6]-0.05962847939999439*kSq[5]-0.063887656499994*kSq[4]+0.05333333333333333*kSq[3]+0.06666666666666667*epsilon[0]*rdx2Sq[1]+0.03849001794597505*kSq[1]-0.8888888888888888*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[5], globalIdxs[7], 0.006147592613027645*kSq[6]+0.03336355394999686*kSq[5]+0.02697478829999747*kSq[4]+0.01924500897298752*kSq[2]+0.1888888888888889*epsilon[0]*rdx2Sq[1]+0.3111111111111111*epsilon[0]*rdx2Sq[0]-0.02222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[6], globalIdxs[0], (-0.01721325931647741*kSq[6])-0.03975231959999626*kSq[5]-0.05678902799999467*kSq[4]-0.01333333333333333*kSq[3]+0.03849001794597505*kSq[2]-0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.4444444444444444*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[6], globalIdxs[1], 0.07950463919999252*kSq[5]+0.1135780559999893*kSq[4]-0.5333333333333333*epsilon[0]*rdx2Sq[1]+0.8888888888888888*epsilon[0]*rdx2Sq[0]-0.1777777777777778*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[6], globalIdxs[2], (-0.01721325931647741*kSq[6])-0.03975231959999626*kSq[5]-0.05678902799999467*kSq[4]+0.01333333333333333*kSq[3]+0.03849001794597505*kSq[2]-0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.4444444444444444*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[6], globalIdxs[3], (-0.03442651863295482*kSq[7])+0.03442651863295482*kSq[6]+0.09938079899999068*kSq[5]+0.09938079899999068*kSq[4]+0.02666666666666666*kSq[3]-0.0769800358919501*kSq[2]+0.0769800358919501*kSq[1]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[6], globalIdxs[4], 0.03442651863295482*kSq[7]+0.03442651863295482*kSq[6]+0.09938079899999068*kSq[5]+0.09938079899999068*kSq[4]-0.02666666666666666*kSq[3]-0.0769800358919501*kSq[2]-0.0769800358919501*kSq[1]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[6], globalIdxs[5], 0.03442651863295482*kSq[7]-0.0295084445425327*kSq[6]-0.05962847939999439*kSq[5]-0.063887656499994*kSq[4]+0.05333333333333333*kSq[3]+0.06666666666666667*epsilon[0]*rdx2Sq[1]+0.03849001794597505*kSq[1]-0.8888888888888888*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[6], globalIdxs[6], 0.1967229636168847*kSq[6]-0.07950463919999252*kSq[5]+0.2271561119999787*kSq[4]-0.3079201435678004*kSq[2]+0.5333333333333333*epsilon[0]*rdx2Sq[1]+1.777777777777778*epsilon[0]*rdx2Sq[0]-0.3555555555555556*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[6], globalIdxs[7], (-0.03442651863295482*kSq[7])-0.0295084445425327*kSq[6]-0.05962847939999439*kSq[5]-0.063887656499994*kSq[4]-0.05333333333333333*kSq[3]+0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.03849001794597505*kSq[1]-0.8888888888888888*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_insert(tri, globalIdxs[7], globalIdxs[0], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[7], globalIdxs[1], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[7], globalIdxs[2], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[7], globalIdxs[3], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[7], globalIdxs[4], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[7], globalIdxs[5], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[7], globalIdxs[6], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[7], globalIdxs[7], 1.0);

}
void fem_poisson_lhs_stencil_consteps_2x_ser_p1_upx_neumannx_iny_periodicy(const double *epsilon, const double *kSq, const double *dx, const double *bcVals, const long *globalIdxs, gkyl_mat_triples *tri) 
{ 
  // epsilon: permittivity.
  // kSq: wave number squared (factor multiplying phi).
  // dx: cell length in each direction.
  // bcVals[3]: values to impose as BCs, i.e. bcVals[0]*phi+bcVals[1]*d(phi)/dx=bcVals[2].
  // globalIdxs: global linear index of each basis function/node in current cell.
  // tri: triples object (i,j,val), i.e. contribute val to i,j element of the global matrix.

  double rdx2Sq[2];
  rdx2Sq[0] = 4.0/(dx[0]*dx[0]);
  rdx2Sq[1] = 4.0/(dx[1]*dx[1]);

  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[0], (-0.1666666666666667*kSq[3])+0.1924500897298752*kSq[2]+0.3333333333333333*epsilon[0]*rdx2Sq[1]+0.1924500897298752*kSq[1]+0.3333333333333333*epsilon[0]*rdx2Sq[0]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[1], 0.09622504486493762*kSq[2]+0.1666666666666667*epsilon[0]*rdx2Sq[1]-0.3333333333333333*epsilon[0]*rdx2Sq[0]-0.1111111111111111*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[2], (-0.3333333333333333*epsilon[0]*rdx2Sq[1])+0.09622504486493762*kSq[1]+0.1666666666666667*epsilon[0]*rdx2Sq[0]-0.1111111111111111*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[3], (-0.1666666666666667*epsilon[0]*rdx2Sq[1])-0.1666666666666667*epsilon[0]*rdx2Sq[0]-0.05555555555555555*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[0], 0.09622504486493762*kSq[2]+0.1666666666666667*epsilon[0]*rdx2Sq[1]-0.3333333333333333*epsilon[0]*rdx2Sq[0]-0.1111111111111111*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[1], 0.1666666666666667*kSq[3]+0.1924500897298752*kSq[2]+0.3333333333333333*epsilon[0]*rdx2Sq[1]-0.1924500897298752*kSq[1]+0.3333333333333333*epsilon[0]*rdx2Sq[0]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[2], (-0.1666666666666667*epsilon[0]*rdx2Sq[1])-0.1666666666666667*epsilon[0]*rdx2Sq[0]-0.05555555555555555*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[3], (-0.3333333333333333*epsilon[0]*rdx2Sq[1])-0.09622504486493762*kSq[1]+0.1666666666666667*epsilon[0]*rdx2Sq[0]-0.1111111111111111*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[0], (-0.3333333333333333*epsilon[0]*rdx2Sq[1])+0.09622504486493762*kSq[1]+0.1666666666666667*epsilon[0]*rdx2Sq[0]-0.1111111111111111*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[1], (-0.1666666666666667*epsilon[0]*rdx2Sq[1])-0.1666666666666667*epsilon[0]*rdx2Sq[0]-0.05555555555555555*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[2], 0.1666666666666667*kSq[3]-0.1924500897298752*kSq[2]+0.3333333333333333*epsilon[0]*rdx2Sq[1]+0.1924500897298752*kSq[1]+0.3333333333333333*epsilon[0]*rdx2Sq[0]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[3], (-0.09622504486493762*kSq[2])+0.1666666666666667*epsilon[0]*rdx2Sq[1]-0.3333333333333333*epsilon[0]*rdx2Sq[0]-0.1111111111111111*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[0], (-0.1666666666666667*epsilon[0]*rdx2Sq[1])-0.1666666666666667*epsilon[0]*rdx2Sq[0]-0.05555555555555555*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[1], (-0.3333333333333333*epsilon[0]*rdx2Sq[1])-0.09622504486493762*kSq[1]+0.1666666666666667*epsilon[0]*rdx2Sq[0]-0.1111111111111111*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[2], (-0.09622504486493762*kSq[2])+0.1666666666666667*epsilon[0]*rdx2Sq[1]-0.3333333333333333*epsilon[0]*rdx2Sq[0]-0.1111111111111111*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[3], (-0.1666666666666667*kSq[3])-0.1924500897298752*kSq[2]+0.3333333333333333*epsilon[0]*rdx2Sq[1]-0.1924500897298752*kSq[1]+0.3333333333333333*epsilon[0]*rdx2Sq[0]-0.2222222222222222*kSq[0]);

}
void fem_poisson_lhs_stencil_consteps_2x_ser_p2_upx_neumannx_iny_periodicy(const double *epsilon, const double *kSq, const double *dx, const double *bcVals, const long *globalIdxs, gkyl_mat_triples *tri) 
{ 
  // epsilon: permittivity.
  // kSq: wave number squared (factor multiplying phi).
  // dx: cell length in each direction.
  // bcVals[3]: values to impose as BCs, i.e. bcVals[0]*phi+bcVals[1]*d(phi)/dx=bcVals[2].
  // globalIdxs: global linear index of each basis function/node in current cell.
  // tri: triples object (i,j,val), i.e. contribute val to i,j element of the global matrix.

  double rdx2Sq[2];
  rdx2Sq[0] = 4.0/(dx[0]*dx[0]);
  rdx2Sq[1] = 4.0/(dx[1]*dx[1]);

  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[0], 0.04549218533640458*kSq[7]+0.04549218533640458*kSq[6]-0.0127775312999988*kSq[5]-0.0127775312999988*kSq[4]-0.04666666666666667*kSq[3]+0.03849001794597505*kSq[2]+0.5777777777777777*epsilon[0]*rdx2Sq[1]+0.03849001794597505*kSq[1]+0.5777777777777777*epsilon[0]*rdx2Sq[0]-0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[1], 0.03442651863295482*kSq[7]+0.0295084445425327*kSq[6]-0.05962847939999439*kSq[5]-0.063887656499994*kSq[4]-0.05333333333333333*kSq[3]+0.06666666666666667*epsilon[0]*rdx2Sq[1]+0.03849001794597505*kSq[1]-0.8888888888888888*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[2], (-0.006147592613027645*kSq[6])+0.03336355394999686*kSq[5]+0.02697478829999747*kSq[4]-0.01924500897298752*kSq[2]+0.1888888888888889*epsilon[0]*rdx2Sq[1]+0.3111111111111111*epsilon[0]*rdx2Sq[0]-0.02222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[3], 0.0295084445425327*kSq[7]+0.03442651863295482*kSq[6]-0.063887656499994*kSq[5]-0.05962847939999439*kSq[4]-0.05333333333333333*kSq[3]+0.03849001794597505*kSq[2]-0.8888888888888888*epsilon[0]*rdx2Sq[1]+0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[4], (-0.01721325931647741*kSq[7])-0.05678902799999467*kSq[5]-0.03975231959999626*kSq[4]-0.01333333333333333*kSq[3]-0.4444444444444444*epsilon[0]*rdx2Sq[1]+0.03849001794597505*kSq[1]-0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[5], (-0.006147592613027645*kSq[7])+0.02697478829999747*kSq[5]+0.03336355394999686*kSq[4]+0.3111111111111111*epsilon[0]*rdx2Sq[1]-0.01924500897298752*kSq[1]+0.1888888888888889*epsilon[0]*rdx2Sq[0]-0.02222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[6], (-0.01721325931647741*kSq[6])-0.03975231959999626*kSq[5]-0.05678902799999467*kSq[4]-0.01333333333333333*kSq[3]+0.03849001794597505*kSq[2]-0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.4444444444444444*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[7], 0.0234254740499978*kSq[5]+0.0234254740499978*kSq[4]+0.01333333333333333*kSq[3]+0.2555555555555555*epsilon[0]*rdx2Sq[1]+0.2555555555555555*epsilon[0]*rdx2Sq[0]-0.03333333333333333*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[0], 0.03442651863295482*kSq[7]+0.0295084445425327*kSq[6]-0.05962847939999439*kSq[5]-0.063887656499994*kSq[4]-0.05333333333333333*kSq[3]+0.06666666666666667*epsilon[0]*rdx2Sq[1]+0.03849001794597505*kSq[1]-0.8888888888888888*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[1], (-0.1967229636168847*kSq[6])-0.07950463919999252*kSq[5]+0.2271561119999787*kSq[4]+0.3079201435678004*kSq[2]+0.5333333333333333*epsilon[0]*rdx2Sq[1]+1.777777777777778*epsilon[0]*rdx2Sq[0]-0.3555555555555556*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[2], (-0.03442651863295482*kSq[7])+0.0295084445425327*kSq[6]-0.05962847939999439*kSq[5]-0.063887656499994*kSq[4]+0.05333333333333333*kSq[3]+0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.03849001794597505*kSq[1]-0.8888888888888888*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[3], (-0.03442651863295482*kSq[7])-0.03442651863295482*kSq[6]+0.09938079899999068*kSq[5]+0.09938079899999068*kSq[4]-0.02666666666666666*kSq[3]+0.0769800358919501*kSq[2]+0.0769800358919501*kSq[1]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[4], 0.03442651863295482*kSq[7]-0.03442651863295482*kSq[6]+0.09938079899999068*kSq[5]+0.09938079899999068*kSq[4]+0.02666666666666666*kSq[3]+0.0769800358919501*kSq[2]-0.0769800358919501*kSq[1]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[5], 0.01721325931647741*kSq[6]-0.03975231959999626*kSq[5]-0.05678902799999467*kSq[4]+0.01333333333333333*kSq[3]-0.03849001794597505*kSq[2]-0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.4444444444444444*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[6], 0.07950463919999252*kSq[5]+0.1135780559999893*kSq[4]-0.5333333333333333*epsilon[0]*rdx2Sq[1]+0.8888888888888888*epsilon[0]*rdx2Sq[0]-0.1777777777777778*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[7], 0.01721325931647741*kSq[6]-0.03975231959999626*kSq[5]-0.05678902799999467*kSq[4]-0.01333333333333333*kSq[3]-0.03849001794597505*kSq[2]-0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.4444444444444444*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[0], (-0.006147592613027645*kSq[6])+0.03336355394999686*kSq[5]+0.02697478829999747*kSq[4]-0.01924500897298752*kSq[2]+0.1888888888888889*epsilon[0]*rdx2Sq[1]+0.3111111111111111*epsilon[0]*rdx2Sq[0]-0.02222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[1], (-0.03442651863295482*kSq[7])+0.0295084445425327*kSq[6]-0.05962847939999439*kSq[5]-0.063887656499994*kSq[4]+0.05333333333333333*kSq[3]+0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.03849001794597505*kSq[1]-0.8888888888888888*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[2], (-0.04549218533640458*kSq[7])+0.04549218533640458*kSq[6]-0.0127775312999988*kSq[5]-0.0127775312999988*kSq[4]+0.04666666666666667*kSq[3]+0.03849001794597505*kSq[2]+0.5777777777777777*epsilon[0]*rdx2Sq[1]-0.03849001794597505*kSq[1]+0.5777777777777777*epsilon[0]*rdx2Sq[0]-0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[3], 0.01721325931647741*kSq[7]-0.05678902799999467*kSq[5]-0.03975231959999626*kSq[4]+0.01333333333333333*kSq[3]-0.4444444444444444*epsilon[0]*rdx2Sq[1]-0.03849001794597505*kSq[1]-0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[4], (-0.0295084445425327*kSq[7])+0.03442651863295482*kSq[6]-0.063887656499994*kSq[5]-0.05962847939999439*kSq[4]+0.05333333333333333*kSq[3]+0.03849001794597505*kSq[2]-0.8888888888888888*epsilon[0]*rdx2Sq[1]+0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[5], 0.0234254740499978*kSq[5]+0.0234254740499978*kSq[4]-0.01333333333333333*kSq[3]+0.2555555555555555*epsilon[0]*rdx2Sq[1]+0.2555555555555555*epsilon[0]*rdx2Sq[0]-0.03333333333333333*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[6], (-0.01721325931647741*kSq[6])-0.03975231959999626*kSq[5]-0.05678902799999467*kSq[4]+0.01333333333333333*kSq[3]+0.03849001794597505*kSq[2]-0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.4444444444444444*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[7], 0.006147592613027645*kSq[7]+0.02697478829999747*kSq[5]+0.03336355394999686*kSq[4]+0.3111111111111111*epsilon[0]*rdx2Sq[1]+0.01924500897298752*kSq[1]+0.1888888888888889*epsilon[0]*rdx2Sq[0]-0.02222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[0], 0.0295084445425327*kSq[7]+0.03442651863295482*kSq[6]-0.063887656499994*kSq[5]-0.05962847939999439*kSq[4]-0.05333333333333333*kSq[3]+0.03849001794597505*kSq[2]-0.8888888888888888*epsilon[0]*rdx2Sq[1]+0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[1], (-0.03442651863295482*kSq[7])-0.03442651863295482*kSq[6]+0.09938079899999068*kSq[5]+0.09938079899999068*kSq[4]-0.02666666666666666*kSq[3]+0.0769800358919501*kSq[2]+0.0769800358919501*kSq[1]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[2], 0.01721325931647741*kSq[7]-0.05678902799999467*kSq[5]-0.03975231959999626*kSq[4]+0.01333333333333333*kSq[3]-0.4444444444444444*epsilon[0]*rdx2Sq[1]-0.03849001794597505*kSq[1]-0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[3], (-0.1967229636168847*kSq[7])+0.2271561119999787*kSq[5]-0.07950463919999252*kSq[4]+1.777777777777778*epsilon[0]*rdx2Sq[1]+0.3079201435678004*kSq[1]+0.5333333333333333*epsilon[0]*rdx2Sq[0]-0.3555555555555556*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[4], 0.1135780559999893*kSq[5]+0.07950463919999252*kSq[4]+0.8888888888888888*epsilon[0]*rdx2Sq[1]-0.5333333333333333*epsilon[0]*rdx2Sq[0]-0.1777777777777778*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[5], 0.0295084445425327*kSq[7]-0.03442651863295482*kSq[6]-0.063887656499994*kSq[5]-0.05962847939999439*kSq[4]+0.05333333333333333*kSq[3]-0.03849001794597505*kSq[2]-0.8888888888888888*epsilon[0]*rdx2Sq[1]+0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[6], (-0.03442651863295482*kSq[7])+0.03442651863295482*kSq[6]+0.09938079899999068*kSq[5]+0.09938079899999068*kSq[4]+0.02666666666666666*kSq[3]-0.0769800358919501*kSq[2]+0.0769800358919501*kSq[1]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[7], 0.01721325931647741*kSq[7]-0.05678902799999467*kSq[5]-0.03975231959999626*kSq[4]-0.01333333333333333*kSq[3]-0.4444444444444444*epsilon[0]*rdx2Sq[1]-0.03849001794597505*kSq[1]-0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[4], globalIdxs[0], (-0.01721325931647741*kSq[7])-0.05678902799999467*kSq[5]-0.03975231959999626*kSq[4]-0.01333333333333333*kSq[3]-0.4444444444444444*epsilon[0]*rdx2Sq[1]+0.03849001794597505*kSq[1]-0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[4], globalIdxs[1], 0.03442651863295482*kSq[7]-0.03442651863295482*kSq[6]+0.09938079899999068*kSq[5]+0.09938079899999068*kSq[4]+0.02666666666666666*kSq[3]+0.0769800358919501*kSq[2]-0.0769800358919501*kSq[1]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[4], globalIdxs[2], (-0.0295084445425327*kSq[7])+0.03442651863295482*kSq[6]-0.063887656499994*kSq[5]-0.05962847939999439*kSq[4]+0.05333333333333333*kSq[3]+0.03849001794597505*kSq[2]-0.8888888888888888*epsilon[0]*rdx2Sq[1]+0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[4], globalIdxs[3], 0.1135780559999893*kSq[5]+0.07950463919999252*kSq[4]+0.8888888888888888*epsilon[0]*rdx2Sq[1]-0.5333333333333333*epsilon[0]*rdx2Sq[0]-0.1777777777777778*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[4], globalIdxs[4], 0.1967229636168847*kSq[7]+0.2271561119999787*kSq[5]-0.07950463919999252*kSq[4]+1.777777777777778*epsilon[0]*rdx2Sq[1]-0.3079201435678004*kSq[1]+0.5333333333333333*epsilon[0]*rdx2Sq[0]-0.3555555555555556*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[4], globalIdxs[5], (-0.01721325931647741*kSq[7])-0.05678902799999467*kSq[5]-0.03975231959999626*kSq[4]+0.01333333333333333*kSq[3]-0.4444444444444444*epsilon[0]*rdx2Sq[1]+0.03849001794597505*kSq[1]-0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[4], globalIdxs[6], 0.03442651863295482*kSq[7]+0.03442651863295482*kSq[6]+0.09938079899999068*kSq[5]+0.09938079899999068*kSq[4]-0.02666666666666666*kSq[3]-0.0769800358919501*kSq[2]-0.0769800358919501*kSq[1]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[4], globalIdxs[7], (-0.0295084445425327*kSq[7])-0.03442651863295482*kSq[6]-0.063887656499994*kSq[5]-0.05962847939999439*kSq[4]-0.05333333333333333*kSq[3]-0.03849001794597505*kSq[2]-0.8888888888888888*epsilon[0]*rdx2Sq[1]+0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[5], globalIdxs[0], (-0.006147592613027645*kSq[7])+0.02697478829999747*kSq[5]+0.03336355394999686*kSq[4]+0.3111111111111111*epsilon[0]*rdx2Sq[1]-0.01924500897298752*kSq[1]+0.1888888888888889*epsilon[0]*rdx2Sq[0]-0.02222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[5], globalIdxs[1], 0.01721325931647741*kSq[6]-0.03975231959999626*kSq[5]-0.05678902799999467*kSq[4]+0.01333333333333333*kSq[3]-0.03849001794597505*kSq[2]-0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.4444444444444444*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[5], globalIdxs[2], 0.0234254740499978*kSq[5]+0.0234254740499978*kSq[4]-0.01333333333333333*kSq[3]+0.2555555555555555*epsilon[0]*rdx2Sq[1]+0.2555555555555555*epsilon[0]*rdx2Sq[0]-0.03333333333333333*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[5], globalIdxs[3], 0.0295084445425327*kSq[7]-0.03442651863295482*kSq[6]-0.063887656499994*kSq[5]-0.05962847939999439*kSq[4]+0.05333333333333333*kSq[3]-0.03849001794597505*kSq[2]-0.8888888888888888*epsilon[0]*rdx2Sq[1]+0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[5], globalIdxs[4], (-0.01721325931647741*kSq[7])-0.05678902799999467*kSq[5]-0.03975231959999626*kSq[4]+0.01333333333333333*kSq[3]-0.4444444444444444*epsilon[0]*rdx2Sq[1]+0.03849001794597505*kSq[1]-0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[5], globalIdxs[5], 0.04549218533640458*kSq[7]-0.04549218533640458*kSq[6]-0.0127775312999988*kSq[5]-0.0127775312999988*kSq[4]+0.04666666666666667*kSq[3]-0.03849001794597505*kSq[2]+0.5777777777777777*epsilon[0]*rdx2Sq[1]+0.03849001794597505*kSq[1]+0.5777777777777777*epsilon[0]*rdx2Sq[0]-0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[5], globalIdxs[6], 0.03442651863295482*kSq[7]-0.0295084445425327*kSq[6]-0.05962847939999439*kSq[5]-0.063887656499994*kSq[4]+0.05333333333333333*kSq[3]+0.06666666666666667*epsilon[0]*rdx2Sq[1]+0.03849001794597505*kSq[1]-0.8888888888888888*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[5], globalIdxs[7], 0.006147592613027645*kSq[6]+0.03336355394999686*kSq[5]+0.02697478829999747*kSq[4]+0.01924500897298752*kSq[2]+0.1888888888888889*epsilon[0]*rdx2Sq[1]+0.3111111111111111*epsilon[0]*rdx2Sq[0]-0.02222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[6], globalIdxs[0], (-0.01721325931647741*kSq[6])-0.03975231959999626*kSq[5]-0.05678902799999467*kSq[4]-0.01333333333333333*kSq[3]+0.03849001794597505*kSq[2]-0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.4444444444444444*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[6], globalIdxs[1], 0.07950463919999252*kSq[5]+0.1135780559999893*kSq[4]-0.5333333333333333*epsilon[0]*rdx2Sq[1]+0.8888888888888888*epsilon[0]*rdx2Sq[0]-0.1777777777777778*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[6], globalIdxs[2], (-0.01721325931647741*kSq[6])-0.03975231959999626*kSq[5]-0.05678902799999467*kSq[4]+0.01333333333333333*kSq[3]+0.03849001794597505*kSq[2]-0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.4444444444444444*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[6], globalIdxs[3], (-0.03442651863295482*kSq[7])+0.03442651863295482*kSq[6]+0.09938079899999068*kSq[5]+0.09938079899999068*kSq[4]+0.02666666666666666*kSq[3]-0.0769800358919501*kSq[2]+0.0769800358919501*kSq[1]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[6], globalIdxs[4], 0.03442651863295482*kSq[7]+0.03442651863295482*kSq[6]+0.09938079899999068*kSq[5]+0.09938079899999068*kSq[4]-0.02666666666666666*kSq[3]-0.0769800358919501*kSq[2]-0.0769800358919501*kSq[1]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[6], globalIdxs[5], 0.03442651863295482*kSq[7]-0.0295084445425327*kSq[6]-0.05962847939999439*kSq[5]-0.063887656499994*kSq[4]+0.05333333333333333*kSq[3]+0.06666666666666667*epsilon[0]*rdx2Sq[1]+0.03849001794597505*kSq[1]-0.8888888888888888*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[6], globalIdxs[6], 0.1967229636168847*kSq[6]-0.07950463919999252*kSq[5]+0.2271561119999787*kSq[4]-0.3079201435678004*kSq[2]+0.5333333333333333*epsilon[0]*rdx2Sq[1]+1.777777777777778*epsilon[0]*rdx2Sq[0]-0.3555555555555556*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[6], globalIdxs[7], (-0.03442651863295482*kSq[7])-0.0295084445425327*kSq[6]-0.05962847939999439*kSq[5]-0.063887656499994*kSq[4]-0.05333333333333333*kSq[3]+0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.03849001794597505*kSq[1]-0.8888888888888888*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[7], globalIdxs[0], 0.0234254740499978*kSq[5]+0.0234254740499978*kSq[4]+0.01333333333333333*kSq[3]+0.2555555555555555*epsilon[0]*rdx2Sq[1]+0.2555555555555555*epsilon[0]*rdx2Sq[0]-0.03333333333333333*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[7], globalIdxs[1], 0.01721325931647741*kSq[6]-0.03975231959999626*kSq[5]-0.05678902799999467*kSq[4]-0.01333333333333333*kSq[3]-0.03849001794597505*kSq[2]-0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.4444444444444444*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[7], globalIdxs[2], 0.006147592613027645*kSq[7]+0.02697478829999747*kSq[5]+0.03336355394999686*kSq[4]+0.3111111111111111*epsilon[0]*rdx2Sq[1]+0.01924500897298752*kSq[1]+0.1888888888888889*epsilon[0]*rdx2Sq[0]-0.02222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[7], globalIdxs[3], 0.01721325931647741*kSq[7]-0.05678902799999467*kSq[5]-0.03975231959999626*kSq[4]-0.01333333333333333*kSq[3]-0.4444444444444444*epsilon[0]*rdx2Sq[1]-0.03849001794597505*kSq[1]-0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[7], globalIdxs[4], (-0.0295084445425327*kSq[7])-0.03442651863295482*kSq[6]-0.063887656499994*kSq[5]-0.05962847939999439*kSq[4]-0.05333333333333333*kSq[3]-0.03849001794597505*kSq[2]-0.8888888888888888*epsilon[0]*rdx2Sq[1]+0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[7], globalIdxs[5], 0.006147592613027645*kSq[6]+0.03336355394999686*kSq[5]+0.02697478829999747*kSq[4]+0.01924500897298752*kSq[2]+0.1888888888888889*epsilon[0]*rdx2Sq[1]+0.3111111111111111*epsilon[0]*rdx2Sq[0]-0.02222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[7], globalIdxs[6], (-0.03442651863295482*kSq[7])-0.0295084445425327*kSq[6]-0.05962847939999439*kSq[5]-0.063887656499994*kSq[4]-0.05333333333333333*kSq[3]+0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.03849001794597505*kSq[1]-0.8888888888888888*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[7], globalIdxs[7], (-0.04549218533640458*kSq[7])-0.04549218533640458*kSq[6]-0.0127775312999988*kSq[5]-0.0127775312999988*kSq[4]-0.04666666666666667*kSq[3]-0.03849001794597505*kSq[2]+0.5777777777777777*epsilon[0]*rdx2Sq[1]-0.03849001794597505*kSq[1]+0.5777777777777777*epsilon[0]*rdx2Sq[0]-0.06666666666666667*kSq[0]);

}
void fem_poisson_lhs_stencil_consteps_2x_ser_p1_upx_robinx_iny_periodicy(const double *epsilon, const double *kSq, const double *dx, const double *bcVals, const long *globalIdxs, gkyl_mat_triples *tri) 
{ 
  // epsilon: permittivity.
  // kSq: wave number squared (factor multiplying phi).
  // dx: cell length in each direction.
  // bcVals[3]: values to impose as BCs, i.e. bcVals[0]*phi+bcVals[1]*d(phi)/dx=bcVals[2].
  // globalIdxs: global linear index of each basis function/node in current cell.
  // tri: triples object (i,j,val), i.e. contribute val to i,j element of the global matrix.

  double rdx2Sq[2];
  rdx2Sq[0] = 4.0/(dx[0]*dx[0]);
  rdx2Sq[1] = 4.0/(dx[1]*dx[1]);

  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[0], (-0.1666666666666667*kSq[3])+0.1924500897298752*kSq[2]+0.3333333333333333*epsilon[0]*rdx2Sq[1]+0.1924500897298752*kSq[1]+0.3333333333333333*epsilon[0]*rdx2Sq[0]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[1], 0.09622504486493762*kSq[2]+0.1666666666666667*epsilon[0]*rdx2Sq[1]-0.3333333333333333*epsilon[0]*rdx2Sq[0]-0.1111111111111111*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[2], (-0.3333333333333333*epsilon[0]*rdx2Sq[1])+0.09622504486493762*kSq[1]+0.1666666666666667*epsilon[0]*rdx2Sq[0]-0.1111111111111111*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[3], (-0.1666666666666667*epsilon[0]*rdx2Sq[1])-0.1666666666666667*epsilon[0]*rdx2Sq[0]-0.05555555555555555*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[0], 0.09622504486493762*kSq[2]+0.1666666666666667*epsilon[0]*rdx2Sq[1]-0.3333333333333333*epsilon[0]*rdx2Sq[0]-0.1111111111111111*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[1], (0.6666666666666666*epsilon[0]*rdx2Sq[0]*bcVals[3])/bcVals[4]+0.1666666666666667*kSq[3]+0.1924500897298752*kSq[2]+0.3333333333333333*epsilon[0]*rdx2Sq[1]-0.1924500897298752*kSq[1]+0.3333333333333333*epsilon[0]*rdx2Sq[0]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[2], (-0.1666666666666667*epsilon[0]*rdx2Sq[1])-0.1666666666666667*epsilon[0]*rdx2Sq[0]-0.05555555555555555*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[3], (0.3333333333333333*epsilon[0]*rdx2Sq[0]*bcVals[3])/bcVals[4]-0.3333333333333333*epsilon[0]*rdx2Sq[1]-0.09622504486493762*kSq[1]+0.1666666666666667*epsilon[0]*rdx2Sq[0]-0.1111111111111111*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[0], (-0.3333333333333333*epsilon[0]*rdx2Sq[1])+0.09622504486493762*kSq[1]+0.1666666666666667*epsilon[0]*rdx2Sq[0]-0.1111111111111111*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[1], (-0.1666666666666667*epsilon[0]*rdx2Sq[1])-0.1666666666666667*epsilon[0]*rdx2Sq[0]-0.05555555555555555*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[2], 0.1666666666666667*kSq[3]-0.1924500897298752*kSq[2]+0.3333333333333333*epsilon[0]*rdx2Sq[1]+0.1924500897298752*kSq[1]+0.3333333333333333*epsilon[0]*rdx2Sq[0]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[3], (-0.09622504486493762*kSq[2])+0.1666666666666667*epsilon[0]*rdx2Sq[1]-0.3333333333333333*epsilon[0]*rdx2Sq[0]-0.1111111111111111*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[0], (-0.1666666666666667*epsilon[0]*rdx2Sq[1])-0.1666666666666667*epsilon[0]*rdx2Sq[0]-0.05555555555555555*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[1], (0.3333333333333333*epsilon[0]*rdx2Sq[0]*bcVals[3])/bcVals[4]-0.3333333333333333*epsilon[0]*rdx2Sq[1]-0.09622504486493762*kSq[1]+0.1666666666666667*epsilon[0]*rdx2Sq[0]-0.1111111111111111*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[2], (-0.09622504486493762*kSq[2])+0.1666666666666667*epsilon[0]*rdx2Sq[1]-0.3333333333333333*epsilon[0]*rdx2Sq[0]-0.1111111111111111*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[3], (0.6666666666666666*epsilon[0]*rdx2Sq[0]*bcVals[3])/bcVals[4]-0.1666666666666667*kSq[3]-0.1924500897298752*kSq[2]+0.3333333333333333*epsilon[0]*rdx2Sq[1]-0.1924500897298752*kSq[1]+0.3333333333333333*epsilon[0]*rdx2Sq[0]-0.2222222222222222*kSq[0]);

}
void fem_poisson_lhs_stencil_consteps_2x_ser_p2_upx_robinx_iny_periodicy(const double *epsilon, const double *kSq, const double *dx, const double *bcVals, const long *globalIdxs, gkyl_mat_triples *tri) 
{ 
  // epsilon: permittivity.
  // kSq: wave number squared (factor multiplying phi).
  // dx: cell length in each direction.
  // bcVals[3]: values to impose as BCs, i.e. bcVals[0]*phi+bcVals[1]*d(phi)/dx=bcVals[2].
  // globalIdxs: global linear index of each basis function/node in current cell.
  // tri: triples object (i,j,val), i.e. contribute val to i,j element of the global matrix.

  double rdx2Sq[2];
  rdx2Sq[0] = 4.0/(dx[0]*dx[0]);
  rdx2Sq[1] = 4.0/(dx[1]*dx[1]);

  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[0], 0.04549218533640458*kSq[7]+0.04549218533640458*kSq[6]-0.0127775312999988*kSq[5]-0.0127775312999988*kSq[4]-0.04666666666666667*kSq[3]+0.03849001794597505*kSq[2]+0.5777777777777777*epsilon[0]*rdx2Sq[1]+0.03849001794597505*kSq[1]+0.5777777777777777*epsilon[0]*rdx2Sq[0]-0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[1], 0.03442651863295482*kSq[7]+0.0295084445425327*kSq[6]-0.05962847939999439*kSq[5]-0.063887656499994*kSq[4]-0.05333333333333333*kSq[3]+0.06666666666666667*epsilon[0]*rdx2Sq[1]+0.03849001794597505*kSq[1]-0.8888888888888888*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[2], (-0.006147592613027645*kSq[6])+0.03336355394999686*kSq[5]+0.02697478829999747*kSq[4]-0.01924500897298752*kSq[2]+0.1888888888888889*epsilon[0]*rdx2Sq[1]+0.3111111111111111*epsilon[0]*rdx2Sq[0]-0.02222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[3], 0.0295084445425327*kSq[7]+0.03442651863295482*kSq[6]-0.063887656499994*kSq[5]-0.05962847939999439*kSq[4]-0.05333333333333333*kSq[3]+0.03849001794597505*kSq[2]-0.8888888888888888*epsilon[0]*rdx2Sq[1]+0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[4], (-0.01721325931647741*kSq[7])-0.05678902799999467*kSq[5]-0.03975231959999626*kSq[4]-0.01333333333333333*kSq[3]-0.4444444444444444*epsilon[0]*rdx2Sq[1]+0.03849001794597505*kSq[1]-0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[5], (-0.006147592613027645*kSq[7])+0.02697478829999747*kSq[5]+0.03336355394999686*kSq[4]+0.3111111111111111*epsilon[0]*rdx2Sq[1]-0.01924500897298752*kSq[1]+0.1888888888888889*epsilon[0]*rdx2Sq[0]-0.02222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[6], (-0.01721325931647741*kSq[6])-0.03975231959999626*kSq[5]-0.05678902799999467*kSq[4]-0.01333333333333333*kSq[3]+0.03849001794597505*kSq[2]-0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.4444444444444444*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[7], 0.0234254740499978*kSq[5]+0.0234254740499978*kSq[4]+0.01333333333333333*kSq[3]+0.2555555555555555*epsilon[0]*rdx2Sq[1]+0.2555555555555555*epsilon[0]*rdx2Sq[0]-0.03333333333333333*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[0], 0.03442651863295482*kSq[7]+0.0295084445425327*kSq[6]-0.05962847939999439*kSq[5]-0.063887656499994*kSq[4]-0.05333333333333333*kSq[3]+0.06666666666666667*epsilon[0]*rdx2Sq[1]+0.03849001794597505*kSq[1]-0.8888888888888888*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[1], (-0.1967229636168847*kSq[6])-0.07950463919999252*kSq[5]+0.2271561119999787*kSq[4]+0.3079201435678004*kSq[2]+0.5333333333333333*epsilon[0]*rdx2Sq[1]+1.777777777777778*epsilon[0]*rdx2Sq[0]-0.3555555555555556*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[2], (-0.03442651863295482*kSq[7])+0.0295084445425327*kSq[6]-0.05962847939999439*kSq[5]-0.063887656499994*kSq[4]+0.05333333333333333*kSq[3]+0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.03849001794597505*kSq[1]-0.8888888888888888*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[3], (-0.03442651863295482*kSq[7])-0.03442651863295482*kSq[6]+0.09938079899999068*kSq[5]+0.09938079899999068*kSq[4]-0.02666666666666666*kSq[3]+0.0769800358919501*kSq[2]+0.0769800358919501*kSq[1]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[4], 0.03442651863295482*kSq[7]-0.03442651863295482*kSq[6]+0.09938079899999068*kSq[5]+0.09938079899999068*kSq[4]+0.02666666666666666*kSq[3]+0.0769800358919501*kSq[2]-0.0769800358919501*kSq[1]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[5], 0.01721325931647741*kSq[6]-0.03975231959999626*kSq[5]-0.05678902799999467*kSq[4]+0.01333333333333333*kSq[3]-0.03849001794597505*kSq[2]-0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.4444444444444444*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[6], 0.07950463919999252*kSq[5]+0.1135780559999893*kSq[4]-0.5333333333333333*epsilon[0]*rdx2Sq[1]+0.8888888888888888*epsilon[0]*rdx2Sq[0]-0.1777777777777778*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[7], 0.01721325931647741*kSq[6]-0.03975231959999626*kSq[5]-0.05678902799999467*kSq[4]-0.01333333333333333*kSq[3]-0.03849001794597505*kSq[2]-0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.4444444444444444*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[0], (-0.006147592613027645*kSq[6])+0.03336355394999686*kSq[5]+0.02697478829999747*kSq[4]-0.01924500897298752*kSq[2]+0.1888888888888889*epsilon[0]*rdx2Sq[1]+0.3111111111111111*epsilon[0]*rdx2Sq[0]-0.02222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[1], (-0.03442651863295482*kSq[7])+0.0295084445425327*kSq[6]-0.05962847939999439*kSq[5]-0.063887656499994*kSq[4]+0.05333333333333333*kSq[3]+0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.03849001794597505*kSq[1]-0.8888888888888888*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[2], (-0.04549218533640458*kSq[7])+0.04549218533640458*kSq[6]-0.0127775312999988*kSq[5]-0.0127775312999988*kSq[4]+(0.2666666666666667*epsilon[0]*rdx2Sq[0]*bcVals[3])/bcVals[4]+0.04666666666666667*kSq[3]+0.03849001794597505*kSq[2]+0.5777777777777777*epsilon[0]*rdx2Sq[1]-0.03849001794597505*kSq[1]+0.5777777777777777*epsilon[0]*rdx2Sq[0]-0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[3], 0.01721325931647741*kSq[7]-0.05678902799999467*kSq[5]-0.03975231959999626*kSq[4]+0.01333333333333333*kSq[3]-0.4444444444444444*epsilon[0]*rdx2Sq[1]-0.03849001794597505*kSq[1]-0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[4], (-0.0295084445425327*kSq[7])+0.03442651863295482*kSq[6]-0.063887656499994*kSq[5]-0.05962847939999439*kSq[4]+(0.1333333333333333*epsilon[0]*rdx2Sq[0]*bcVals[3])/bcVals[4]+0.05333333333333333*kSq[3]+0.03849001794597505*kSq[2]-0.8888888888888888*epsilon[0]*rdx2Sq[1]+0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[5], 0.0234254740499978*kSq[5]+0.0234254740499978*kSq[4]-0.01333333333333333*kSq[3]+0.2555555555555555*epsilon[0]*rdx2Sq[1]+0.2555555555555555*epsilon[0]*rdx2Sq[0]-0.03333333333333333*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[6], (-0.01721325931647741*kSq[6])-0.03975231959999626*kSq[5]-0.05678902799999467*kSq[4]+0.01333333333333333*kSq[3]+0.03849001794597505*kSq[2]-0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.4444444444444444*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[7], 0.006147592613027645*kSq[7]+0.02697478829999747*kSq[5]+0.03336355394999686*kSq[4]-(0.06666666666666667*epsilon[0]*rdx2Sq[0]*bcVals[3])/bcVals[4]+0.3111111111111111*epsilon[0]*rdx2Sq[1]+0.01924500897298752*kSq[1]+0.1888888888888889*epsilon[0]*rdx2Sq[0]-0.02222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[0], 0.0295084445425327*kSq[7]+0.03442651863295482*kSq[6]-0.063887656499994*kSq[5]-0.05962847939999439*kSq[4]-0.05333333333333333*kSq[3]+0.03849001794597505*kSq[2]-0.8888888888888888*epsilon[0]*rdx2Sq[1]+0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[1], (-0.03442651863295482*kSq[7])-0.03442651863295482*kSq[6]+0.09938079899999068*kSq[5]+0.09938079899999068*kSq[4]-0.02666666666666666*kSq[3]+0.0769800358919501*kSq[2]+0.0769800358919501*kSq[1]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[2], 0.01721325931647741*kSq[7]-0.05678902799999467*kSq[5]-0.03975231959999626*kSq[4]+0.01333333333333333*kSq[3]-0.4444444444444444*epsilon[0]*rdx2Sq[1]-0.03849001794597505*kSq[1]-0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[3], (-0.1967229636168847*kSq[7])+0.2271561119999787*kSq[5]-0.07950463919999252*kSq[4]+1.777777777777778*epsilon[0]*rdx2Sq[1]+0.3079201435678004*kSq[1]+0.5333333333333333*epsilon[0]*rdx2Sq[0]-0.3555555555555556*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[4], 0.1135780559999893*kSq[5]+0.07950463919999252*kSq[4]+0.8888888888888888*epsilon[0]*rdx2Sq[1]-0.5333333333333333*epsilon[0]*rdx2Sq[0]-0.1777777777777778*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[5], 0.0295084445425327*kSq[7]-0.03442651863295482*kSq[6]-0.063887656499994*kSq[5]-0.05962847939999439*kSq[4]+0.05333333333333333*kSq[3]-0.03849001794597505*kSq[2]-0.8888888888888888*epsilon[0]*rdx2Sq[1]+0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[6], (-0.03442651863295482*kSq[7])+0.03442651863295482*kSq[6]+0.09938079899999068*kSq[5]+0.09938079899999068*kSq[4]+0.02666666666666666*kSq[3]-0.0769800358919501*kSq[2]+0.0769800358919501*kSq[1]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[7], 0.01721325931647741*kSq[7]-0.05678902799999467*kSq[5]-0.03975231959999626*kSq[4]-0.01333333333333333*kSq[3]-0.4444444444444444*epsilon[0]*rdx2Sq[1]-0.03849001794597505*kSq[1]-0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[4], globalIdxs[0], (-0.01721325931647741*kSq[7])-0.05678902799999467*kSq[5]-0.03975231959999626*kSq[4]-0.01333333333333333*kSq[3]-0.4444444444444444*epsilon[0]*rdx2Sq[1]+0.03849001794597505*kSq[1]-0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[4], globalIdxs[1], 0.03442651863295482*kSq[7]-0.03442651863295482*kSq[6]+0.09938079899999068*kSq[5]+0.09938079899999068*kSq[4]+0.02666666666666666*kSq[3]+0.0769800358919501*kSq[2]-0.0769800358919501*kSq[1]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[4], globalIdxs[2], (-0.0295084445425327*kSq[7])+0.03442651863295482*kSq[6]-0.063887656499994*kSq[5]-0.05962847939999439*kSq[4]+(0.1333333333333333*epsilon[0]*rdx2Sq[0]*bcVals[3])/bcVals[4]+0.05333333333333333*kSq[3]+0.03849001794597505*kSq[2]-0.8888888888888888*epsilon[0]*rdx2Sq[1]+0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[4], globalIdxs[3], 0.1135780559999893*kSq[5]+0.07950463919999252*kSq[4]+0.8888888888888888*epsilon[0]*rdx2Sq[1]-0.5333333333333333*epsilon[0]*rdx2Sq[0]-0.1777777777777778*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[4], globalIdxs[4], 0.1967229636168847*kSq[7]+0.2271561119999787*kSq[5]-0.07950463919999252*kSq[4]+(1.066666666666667*epsilon[0]*rdx2Sq[0]*bcVals[3])/bcVals[4]+1.777777777777778*epsilon[0]*rdx2Sq[1]-0.3079201435678004*kSq[1]+0.5333333333333333*epsilon[0]*rdx2Sq[0]-0.3555555555555556*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[4], globalIdxs[5], (-0.01721325931647741*kSq[7])-0.05678902799999467*kSq[5]-0.03975231959999626*kSq[4]+0.01333333333333333*kSq[3]-0.4444444444444444*epsilon[0]*rdx2Sq[1]+0.03849001794597505*kSq[1]-0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[4], globalIdxs[6], 0.03442651863295482*kSq[7]+0.03442651863295482*kSq[6]+0.09938079899999068*kSq[5]+0.09938079899999068*kSq[4]-0.02666666666666666*kSq[3]-0.0769800358919501*kSq[2]-0.0769800358919501*kSq[1]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[4], globalIdxs[7], (-0.0295084445425327*kSq[7])-0.03442651863295482*kSq[6]-0.063887656499994*kSq[5]-0.05962847939999439*kSq[4]+(0.1333333333333333*epsilon[0]*rdx2Sq[0]*bcVals[3])/bcVals[4]-0.05333333333333333*kSq[3]-0.03849001794597505*kSq[2]-0.8888888888888888*epsilon[0]*rdx2Sq[1]+0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[5], globalIdxs[0], (-0.006147592613027645*kSq[7])+0.02697478829999747*kSq[5]+0.03336355394999686*kSq[4]+0.3111111111111111*epsilon[0]*rdx2Sq[1]-0.01924500897298752*kSq[1]+0.1888888888888889*epsilon[0]*rdx2Sq[0]-0.02222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[5], globalIdxs[1], 0.01721325931647741*kSq[6]-0.03975231959999626*kSq[5]-0.05678902799999467*kSq[4]+0.01333333333333333*kSq[3]-0.03849001794597505*kSq[2]-0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.4444444444444444*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[5], globalIdxs[2], 0.0234254740499978*kSq[5]+0.0234254740499978*kSq[4]-0.01333333333333333*kSq[3]+0.2555555555555555*epsilon[0]*rdx2Sq[1]+0.2555555555555555*epsilon[0]*rdx2Sq[0]-0.03333333333333333*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[5], globalIdxs[3], 0.0295084445425327*kSq[7]-0.03442651863295482*kSq[6]-0.063887656499994*kSq[5]-0.05962847939999439*kSq[4]+0.05333333333333333*kSq[3]-0.03849001794597505*kSq[2]-0.8888888888888888*epsilon[0]*rdx2Sq[1]+0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[5], globalIdxs[4], (-0.01721325931647741*kSq[7])-0.05678902799999467*kSq[5]-0.03975231959999626*kSq[4]+0.01333333333333333*kSq[3]-0.4444444444444444*epsilon[0]*rdx2Sq[1]+0.03849001794597505*kSq[1]-0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[5], globalIdxs[5], 0.04549218533640458*kSq[7]-0.04549218533640458*kSq[6]-0.0127775312999988*kSq[5]-0.0127775312999988*kSq[4]+0.04666666666666667*kSq[3]-0.03849001794597505*kSq[2]+0.5777777777777777*epsilon[0]*rdx2Sq[1]+0.03849001794597505*kSq[1]+0.5777777777777777*epsilon[0]*rdx2Sq[0]-0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[5], globalIdxs[6], 0.03442651863295482*kSq[7]-0.0295084445425327*kSq[6]-0.05962847939999439*kSq[5]-0.063887656499994*kSq[4]+0.05333333333333333*kSq[3]+0.06666666666666667*epsilon[0]*rdx2Sq[1]+0.03849001794597505*kSq[1]-0.8888888888888888*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[5], globalIdxs[7], 0.006147592613027645*kSq[6]+0.03336355394999686*kSq[5]+0.02697478829999747*kSq[4]+0.01924500897298752*kSq[2]+0.1888888888888889*epsilon[0]*rdx2Sq[1]+0.3111111111111111*epsilon[0]*rdx2Sq[0]-0.02222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[6], globalIdxs[0], (-0.01721325931647741*kSq[6])-0.03975231959999626*kSq[5]-0.05678902799999467*kSq[4]-0.01333333333333333*kSq[3]+0.03849001794597505*kSq[2]-0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.4444444444444444*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[6], globalIdxs[1], 0.07950463919999252*kSq[5]+0.1135780559999893*kSq[4]-0.5333333333333333*epsilon[0]*rdx2Sq[1]+0.8888888888888888*epsilon[0]*rdx2Sq[0]-0.1777777777777778*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[6], globalIdxs[2], (-0.01721325931647741*kSq[6])-0.03975231959999626*kSq[5]-0.05678902799999467*kSq[4]+0.01333333333333333*kSq[3]+0.03849001794597505*kSq[2]-0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.4444444444444444*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[6], globalIdxs[3], (-0.03442651863295482*kSq[7])+0.03442651863295482*kSq[6]+0.09938079899999068*kSq[5]+0.09938079899999068*kSq[4]+0.02666666666666666*kSq[3]-0.0769800358919501*kSq[2]+0.0769800358919501*kSq[1]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[6], globalIdxs[4], 0.03442651863295482*kSq[7]+0.03442651863295482*kSq[6]+0.09938079899999068*kSq[5]+0.09938079899999068*kSq[4]-0.02666666666666666*kSq[3]-0.0769800358919501*kSq[2]-0.0769800358919501*kSq[1]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[6], globalIdxs[5], 0.03442651863295482*kSq[7]-0.0295084445425327*kSq[6]-0.05962847939999439*kSq[5]-0.063887656499994*kSq[4]+0.05333333333333333*kSq[3]+0.06666666666666667*epsilon[0]*rdx2Sq[1]+0.03849001794597505*kSq[1]-0.8888888888888888*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[6], globalIdxs[6], 0.1967229636168847*kSq[6]-0.07950463919999252*kSq[5]+0.2271561119999787*kSq[4]-0.3079201435678004*kSq[2]+0.5333333333333333*epsilon[0]*rdx2Sq[1]+1.777777777777778*epsilon[0]*rdx2Sq[0]-0.3555555555555556*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[6], globalIdxs[7], (-0.03442651863295482*kSq[7])-0.0295084445425327*kSq[6]-0.05962847939999439*kSq[5]-0.063887656499994*kSq[4]-0.05333333333333333*kSq[3]+0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.03849001794597505*kSq[1]-0.8888888888888888*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[7], globalIdxs[0], 0.0234254740499978*kSq[5]+0.0234254740499978*kSq[4]+0.01333333333333333*kSq[3]+0.2555555555555555*epsilon[0]*rdx2Sq[1]+0.2555555555555555*epsilon[0]*rdx2Sq[0]-0.03333333333333333*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[7], globalIdxs[1], 0.01721325931647741*kSq[6]-0.03975231959999626*kSq[5]-0.05678902799999467*kSq[4]-0.01333333333333333*kSq[3]-0.03849001794597505*kSq[2]-0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.4444444444444444*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[7], globalIdxs[2], 0.006147592613027645*kSq[7]+0.02697478829999747*kSq[5]+0.03336355394999686*kSq[4]-(0.06666666666666667*epsilon[0]*rdx2Sq[0]*bcVals[3])/bcVals[4]+0.3111111111111111*epsilon[0]*rdx2Sq[1]+0.01924500897298752*kSq[1]+0.1888888888888889*epsilon[0]*rdx2Sq[0]-0.02222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[7], globalIdxs[3], 0.01721325931647741*kSq[7]-0.05678902799999467*kSq[5]-0.03975231959999626*kSq[4]-0.01333333333333333*kSq[3]-0.4444444444444444*epsilon[0]*rdx2Sq[1]-0.03849001794597505*kSq[1]-0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[7], globalIdxs[4], (-0.0295084445425327*kSq[7])-0.03442651863295482*kSq[6]-0.063887656499994*kSq[5]-0.05962847939999439*kSq[4]+(0.1333333333333333*epsilon[0]*rdx2Sq[0]*bcVals[3])/bcVals[4]-0.05333333333333333*kSq[3]-0.03849001794597505*kSq[2]-0.8888888888888888*epsilon[0]*rdx2Sq[1]+0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[7], globalIdxs[5], 0.006147592613027645*kSq[6]+0.03336355394999686*kSq[5]+0.02697478829999747*kSq[4]+0.01924500897298752*kSq[2]+0.1888888888888889*epsilon[0]*rdx2Sq[1]+0.3111111111111111*epsilon[0]*rdx2Sq[0]-0.02222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[7], globalIdxs[6], (-0.03442651863295482*kSq[7])-0.0295084445425327*kSq[6]-0.05962847939999439*kSq[5]-0.063887656499994*kSq[4]-0.05333333333333333*kSq[3]+0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.03849001794597505*kSq[1]-0.8888888888888888*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[7], globalIdxs[7], (-0.04549218533640458*kSq[7])-0.04549218533640458*kSq[6]-0.0127775312999988*kSq[5]-0.0127775312999988*kSq[4]+(0.2666666666666667*epsilon[0]*rdx2Sq[0]*bcVals[3])/bcVals[4]-0.04666666666666667*kSq[3]-0.03849001794597505*kSq[2]+0.5777777777777777*epsilon[0]*rdx2Sq[1]-0.03849001794597505*kSq[1]+0.5777777777777777*epsilon[0]*rdx2Sq[0]-0.06666666666666667*kSq[0]);

}
void fem_poisson_lhs_stencil_consteps_2x_ser_p1_inx_periodicx_loy_periodicy(const double *epsilon, const double *kSq, const double *dx, const double *bcVals, const long *globalIdxs, gkyl_mat_triples *tri) 
{ 
  // epsilon: permittivity.
  // kSq: wave number squared (factor multiplying phi).
  // dx: cell length in each direction.
  // bcVals[3]: values to impose as BCs, i.e. bcVals[0]*phi+bcVals[1]*d(phi)/dx=bcVals[2].
  // globalIdxs: global linear index of each basis function/node in current cell.
  // tri: triples object (i,j,val), i.e. contribute val to i,j element of the global matrix.

  double rdx2Sq[2];
  rdx2Sq[0] = 4.0/(dx[0]*dx[0]);
  rdx2Sq[1] = 4.0/(dx[1]*dx[1]);

  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[0], (-0.1666666666666667*kSq[3])+0.1924500897298752*kSq[2]+0.3333333333333333*epsilon[0]*rdx2Sq[1]+0.1924500897298752*kSq[1]+0.3333333333333333*epsilon[0]*rdx2Sq[0]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[1], 0.09622504486493762*kSq[2]+0.1666666666666667*epsilon[0]*rdx2Sq[1]-0.3333333333333333*epsilon[0]*rdx2Sq[0]-0.1111111111111111*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[2], (-0.3333333333333333*epsilon[0]*rdx2Sq[1])+0.09622504486493762*kSq[1]+0.1666666666666667*epsilon[0]*rdx2Sq[0]-0.1111111111111111*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[3], (-0.1666666666666667*epsilon[0]*rdx2Sq[1])-0.1666666666666667*epsilon[0]*rdx2Sq[0]-0.05555555555555555*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[0], 0.09622504486493762*kSq[2]+0.1666666666666667*epsilon[0]*rdx2Sq[1]-0.3333333333333333*epsilon[0]*rdx2Sq[0]-0.1111111111111111*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[1], 0.1666666666666667*kSq[3]+0.1924500897298752*kSq[2]+0.3333333333333333*epsilon[0]*rdx2Sq[1]-0.1924500897298752*kSq[1]+0.3333333333333333*epsilon[0]*rdx2Sq[0]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[2], (-0.1666666666666667*epsilon[0]*rdx2Sq[1])-0.1666666666666667*epsilon[0]*rdx2Sq[0]-0.05555555555555555*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[3], (-0.3333333333333333*epsilon[0]*rdx2Sq[1])-0.09622504486493762*kSq[1]+0.1666666666666667*epsilon[0]*rdx2Sq[0]-0.1111111111111111*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[0], (-0.3333333333333333*epsilon[0]*rdx2Sq[1])+0.09622504486493762*kSq[1]+0.1666666666666667*epsilon[0]*rdx2Sq[0]-0.1111111111111111*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[1], (-0.1666666666666667*epsilon[0]*rdx2Sq[1])-0.1666666666666667*epsilon[0]*rdx2Sq[0]-0.05555555555555555*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[2], 0.1666666666666667*kSq[3]-0.1924500897298752*kSq[2]+0.3333333333333333*epsilon[0]*rdx2Sq[1]+0.1924500897298752*kSq[1]+0.3333333333333333*epsilon[0]*rdx2Sq[0]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[3], (-0.09622504486493762*kSq[2])+0.1666666666666667*epsilon[0]*rdx2Sq[1]-0.3333333333333333*epsilon[0]*rdx2Sq[0]-0.1111111111111111*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[0], (-0.1666666666666667*epsilon[0]*rdx2Sq[1])-0.1666666666666667*epsilon[0]*rdx2Sq[0]-0.05555555555555555*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[1], (-0.3333333333333333*epsilon[0]*rdx2Sq[1])-0.09622504486493762*kSq[1]+0.1666666666666667*epsilon[0]*rdx2Sq[0]-0.1111111111111111*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[2], (-0.09622504486493762*kSq[2])+0.1666666666666667*epsilon[0]*rdx2Sq[1]-0.3333333333333333*epsilon[0]*rdx2Sq[0]-0.1111111111111111*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[3], (-0.1666666666666667*kSq[3])-0.1924500897298752*kSq[2]+0.3333333333333333*epsilon[0]*rdx2Sq[1]-0.1924500897298752*kSq[1]+0.3333333333333333*epsilon[0]*rdx2Sq[0]-0.2222222222222222*kSq[0]);

}
void fem_poisson_lhs_stencil_consteps_2x_ser_p2_inx_periodicx_loy_periodicy(const double *epsilon, const double *kSq, const double *dx, const double *bcVals, const long *globalIdxs, gkyl_mat_triples *tri) 
{ 
  // epsilon: permittivity.
  // kSq: wave number squared (factor multiplying phi).
  // dx: cell length in each direction.
  // bcVals[3]: values to impose as BCs, i.e. bcVals[0]*phi+bcVals[1]*d(phi)/dx=bcVals[2].
  // globalIdxs: global linear index of each basis function/node in current cell.
  // tri: triples object (i,j,val), i.e. contribute val to i,j element of the global matrix.

  double rdx2Sq[2];
  rdx2Sq[0] = 4.0/(dx[0]*dx[0]);
  rdx2Sq[1] = 4.0/(dx[1]*dx[1]);

  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[0], 0.04549218533640458*kSq[7]+0.04549218533640458*kSq[6]-0.0127775312999988*kSq[5]-0.0127775312999988*kSq[4]-0.04666666666666667*kSq[3]+0.03849001794597505*kSq[2]+0.5777777777777777*epsilon[0]*rdx2Sq[1]+0.03849001794597505*kSq[1]+0.5777777777777777*epsilon[0]*rdx2Sq[0]-0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[1], 0.03442651863295482*kSq[7]+0.0295084445425327*kSq[6]-0.05962847939999439*kSq[5]-0.063887656499994*kSq[4]-0.05333333333333333*kSq[3]+0.06666666666666667*epsilon[0]*rdx2Sq[1]+0.03849001794597505*kSq[1]-0.8888888888888888*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[2], (-0.006147592613027645*kSq[6])+0.03336355394999686*kSq[5]+0.02697478829999747*kSq[4]-0.01924500897298752*kSq[2]+0.1888888888888889*epsilon[0]*rdx2Sq[1]+0.3111111111111111*epsilon[0]*rdx2Sq[0]-0.02222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[3], 0.0295084445425327*kSq[7]+0.03442651863295482*kSq[6]-0.063887656499994*kSq[5]-0.05962847939999439*kSq[4]-0.05333333333333333*kSq[3]+0.03849001794597505*kSq[2]-0.8888888888888888*epsilon[0]*rdx2Sq[1]+0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[4], (-0.01721325931647741*kSq[7])-0.05678902799999467*kSq[5]-0.03975231959999626*kSq[4]-0.01333333333333333*kSq[3]-0.4444444444444444*epsilon[0]*rdx2Sq[1]+0.03849001794597505*kSq[1]-0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[5], (-0.006147592613027645*kSq[7])+0.02697478829999747*kSq[5]+0.03336355394999686*kSq[4]+0.3111111111111111*epsilon[0]*rdx2Sq[1]-0.01924500897298752*kSq[1]+0.1888888888888889*epsilon[0]*rdx2Sq[0]-0.02222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[6], (-0.01721325931647741*kSq[6])-0.03975231959999626*kSq[5]-0.05678902799999467*kSq[4]-0.01333333333333333*kSq[3]+0.03849001794597505*kSq[2]-0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.4444444444444444*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[7], 0.0234254740499978*kSq[5]+0.0234254740499978*kSq[4]+0.01333333333333333*kSq[3]+0.2555555555555555*epsilon[0]*rdx2Sq[1]+0.2555555555555555*epsilon[0]*rdx2Sq[0]-0.03333333333333333*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[0], 0.03442651863295482*kSq[7]+0.0295084445425327*kSq[6]-0.05962847939999439*kSq[5]-0.063887656499994*kSq[4]-0.05333333333333333*kSq[3]+0.06666666666666667*epsilon[0]*rdx2Sq[1]+0.03849001794597505*kSq[1]-0.8888888888888888*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[1], (-0.1967229636168847*kSq[6])-0.07950463919999252*kSq[5]+0.2271561119999787*kSq[4]+0.3079201435678004*kSq[2]+0.5333333333333333*epsilon[0]*rdx2Sq[1]+1.777777777777778*epsilon[0]*rdx2Sq[0]-0.3555555555555556*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[2], (-0.03442651863295482*kSq[7])+0.0295084445425327*kSq[6]-0.05962847939999439*kSq[5]-0.063887656499994*kSq[4]+0.05333333333333333*kSq[3]+0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.03849001794597505*kSq[1]-0.8888888888888888*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[3], (-0.03442651863295482*kSq[7])-0.03442651863295482*kSq[6]+0.09938079899999068*kSq[5]+0.09938079899999068*kSq[4]-0.02666666666666666*kSq[3]+0.0769800358919501*kSq[2]+0.0769800358919501*kSq[1]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[4], 0.03442651863295482*kSq[7]-0.03442651863295482*kSq[6]+0.09938079899999068*kSq[5]+0.09938079899999068*kSq[4]+0.02666666666666666*kSq[3]+0.0769800358919501*kSq[2]-0.0769800358919501*kSq[1]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[5], 0.01721325931647741*kSq[6]-0.03975231959999626*kSq[5]-0.05678902799999467*kSq[4]+0.01333333333333333*kSq[3]-0.03849001794597505*kSq[2]-0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.4444444444444444*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[6], 0.07950463919999252*kSq[5]+0.1135780559999893*kSq[4]-0.5333333333333333*epsilon[0]*rdx2Sq[1]+0.8888888888888888*epsilon[0]*rdx2Sq[0]-0.1777777777777778*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[7], 0.01721325931647741*kSq[6]-0.03975231959999626*kSq[5]-0.05678902799999467*kSq[4]-0.01333333333333333*kSq[3]-0.03849001794597505*kSq[2]-0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.4444444444444444*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[0], (-0.006147592613027645*kSq[6])+0.03336355394999686*kSq[5]+0.02697478829999747*kSq[4]-0.01924500897298752*kSq[2]+0.1888888888888889*epsilon[0]*rdx2Sq[1]+0.3111111111111111*epsilon[0]*rdx2Sq[0]-0.02222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[1], (-0.03442651863295482*kSq[7])+0.0295084445425327*kSq[6]-0.05962847939999439*kSq[5]-0.063887656499994*kSq[4]+0.05333333333333333*kSq[3]+0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.03849001794597505*kSq[1]-0.8888888888888888*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[2], (-0.04549218533640458*kSq[7])+0.04549218533640458*kSq[6]-0.0127775312999988*kSq[5]-0.0127775312999988*kSq[4]+0.04666666666666667*kSq[3]+0.03849001794597505*kSq[2]+0.5777777777777777*epsilon[0]*rdx2Sq[1]-0.03849001794597505*kSq[1]+0.5777777777777777*epsilon[0]*rdx2Sq[0]-0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[3], 0.01721325931647741*kSq[7]-0.05678902799999467*kSq[5]-0.03975231959999626*kSq[4]+0.01333333333333333*kSq[3]-0.4444444444444444*epsilon[0]*rdx2Sq[1]-0.03849001794597505*kSq[1]-0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[4], (-0.0295084445425327*kSq[7])+0.03442651863295482*kSq[6]-0.063887656499994*kSq[5]-0.05962847939999439*kSq[4]+0.05333333333333333*kSq[3]+0.03849001794597505*kSq[2]-0.8888888888888888*epsilon[0]*rdx2Sq[1]+0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[5], 0.0234254740499978*kSq[5]+0.0234254740499978*kSq[4]-0.01333333333333333*kSq[3]+0.2555555555555555*epsilon[0]*rdx2Sq[1]+0.2555555555555555*epsilon[0]*rdx2Sq[0]-0.03333333333333333*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[6], (-0.01721325931647741*kSq[6])-0.03975231959999626*kSq[5]-0.05678902799999467*kSq[4]+0.01333333333333333*kSq[3]+0.03849001794597505*kSq[2]-0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.4444444444444444*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[7], 0.006147592613027645*kSq[7]+0.02697478829999747*kSq[5]+0.03336355394999686*kSq[4]+0.3111111111111111*epsilon[0]*rdx2Sq[1]+0.01924500897298752*kSq[1]+0.1888888888888889*epsilon[0]*rdx2Sq[0]-0.02222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[0], 0.0295084445425327*kSq[7]+0.03442651863295482*kSq[6]-0.063887656499994*kSq[5]-0.05962847939999439*kSq[4]-0.05333333333333333*kSq[3]+0.03849001794597505*kSq[2]-0.8888888888888888*epsilon[0]*rdx2Sq[1]+0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[1], (-0.03442651863295482*kSq[7])-0.03442651863295482*kSq[6]+0.09938079899999068*kSq[5]+0.09938079899999068*kSq[4]-0.02666666666666666*kSq[3]+0.0769800358919501*kSq[2]+0.0769800358919501*kSq[1]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[2], 0.01721325931647741*kSq[7]-0.05678902799999467*kSq[5]-0.03975231959999626*kSq[4]+0.01333333333333333*kSq[3]-0.4444444444444444*epsilon[0]*rdx2Sq[1]-0.03849001794597505*kSq[1]-0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[3], (-0.1967229636168847*kSq[7])+0.2271561119999787*kSq[5]-0.07950463919999252*kSq[4]+1.777777777777778*epsilon[0]*rdx2Sq[1]+0.3079201435678004*kSq[1]+0.5333333333333333*epsilon[0]*rdx2Sq[0]-0.3555555555555556*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[4], 0.1135780559999893*kSq[5]+0.07950463919999252*kSq[4]+0.8888888888888888*epsilon[0]*rdx2Sq[1]-0.5333333333333333*epsilon[0]*rdx2Sq[0]-0.1777777777777778*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[5], 0.0295084445425327*kSq[7]-0.03442651863295482*kSq[6]-0.063887656499994*kSq[5]-0.05962847939999439*kSq[4]+0.05333333333333333*kSq[3]-0.03849001794597505*kSq[2]-0.8888888888888888*epsilon[0]*rdx2Sq[1]+0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[6], (-0.03442651863295482*kSq[7])+0.03442651863295482*kSq[6]+0.09938079899999068*kSq[5]+0.09938079899999068*kSq[4]+0.02666666666666666*kSq[3]-0.0769800358919501*kSq[2]+0.0769800358919501*kSq[1]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[7], 0.01721325931647741*kSq[7]-0.05678902799999467*kSq[5]-0.03975231959999626*kSq[4]-0.01333333333333333*kSq[3]-0.4444444444444444*epsilon[0]*rdx2Sq[1]-0.03849001794597505*kSq[1]-0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[4], globalIdxs[0], (-0.01721325931647741*kSq[7])-0.05678902799999467*kSq[5]-0.03975231959999626*kSq[4]-0.01333333333333333*kSq[3]-0.4444444444444444*epsilon[0]*rdx2Sq[1]+0.03849001794597505*kSq[1]-0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[4], globalIdxs[1], 0.03442651863295482*kSq[7]-0.03442651863295482*kSq[6]+0.09938079899999068*kSq[5]+0.09938079899999068*kSq[4]+0.02666666666666666*kSq[3]+0.0769800358919501*kSq[2]-0.0769800358919501*kSq[1]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[4], globalIdxs[2], (-0.0295084445425327*kSq[7])+0.03442651863295482*kSq[6]-0.063887656499994*kSq[5]-0.05962847939999439*kSq[4]+0.05333333333333333*kSq[3]+0.03849001794597505*kSq[2]-0.8888888888888888*epsilon[0]*rdx2Sq[1]+0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[4], globalIdxs[3], 0.1135780559999893*kSq[5]+0.07950463919999252*kSq[4]+0.8888888888888888*epsilon[0]*rdx2Sq[1]-0.5333333333333333*epsilon[0]*rdx2Sq[0]-0.1777777777777778*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[4], globalIdxs[4], 0.1967229636168847*kSq[7]+0.2271561119999787*kSq[5]-0.07950463919999252*kSq[4]+1.777777777777778*epsilon[0]*rdx2Sq[1]-0.3079201435678004*kSq[1]+0.5333333333333333*epsilon[0]*rdx2Sq[0]-0.3555555555555556*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[4], globalIdxs[5], (-0.01721325931647741*kSq[7])-0.05678902799999467*kSq[5]-0.03975231959999626*kSq[4]+0.01333333333333333*kSq[3]-0.4444444444444444*epsilon[0]*rdx2Sq[1]+0.03849001794597505*kSq[1]-0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[4], globalIdxs[6], 0.03442651863295482*kSq[7]+0.03442651863295482*kSq[6]+0.09938079899999068*kSq[5]+0.09938079899999068*kSq[4]-0.02666666666666666*kSq[3]-0.0769800358919501*kSq[2]-0.0769800358919501*kSq[1]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[4], globalIdxs[7], (-0.0295084445425327*kSq[7])-0.03442651863295482*kSq[6]-0.063887656499994*kSq[5]-0.05962847939999439*kSq[4]-0.05333333333333333*kSq[3]-0.03849001794597505*kSq[2]-0.8888888888888888*epsilon[0]*rdx2Sq[1]+0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[5], globalIdxs[0], (-0.006147592613027645*kSq[7])+0.02697478829999747*kSq[5]+0.03336355394999686*kSq[4]+0.3111111111111111*epsilon[0]*rdx2Sq[1]-0.01924500897298752*kSq[1]+0.1888888888888889*epsilon[0]*rdx2Sq[0]-0.02222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[5], globalIdxs[1], 0.01721325931647741*kSq[6]-0.03975231959999626*kSq[5]-0.05678902799999467*kSq[4]+0.01333333333333333*kSq[3]-0.03849001794597505*kSq[2]-0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.4444444444444444*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[5], globalIdxs[2], 0.0234254740499978*kSq[5]+0.0234254740499978*kSq[4]-0.01333333333333333*kSq[3]+0.2555555555555555*epsilon[0]*rdx2Sq[1]+0.2555555555555555*epsilon[0]*rdx2Sq[0]-0.03333333333333333*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[5], globalIdxs[3], 0.0295084445425327*kSq[7]-0.03442651863295482*kSq[6]-0.063887656499994*kSq[5]-0.05962847939999439*kSq[4]+0.05333333333333333*kSq[3]-0.03849001794597505*kSq[2]-0.8888888888888888*epsilon[0]*rdx2Sq[1]+0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[5], globalIdxs[4], (-0.01721325931647741*kSq[7])-0.05678902799999467*kSq[5]-0.03975231959999626*kSq[4]+0.01333333333333333*kSq[3]-0.4444444444444444*epsilon[0]*rdx2Sq[1]+0.03849001794597505*kSq[1]-0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[5], globalIdxs[5], 0.04549218533640458*kSq[7]-0.04549218533640458*kSq[6]-0.0127775312999988*kSq[5]-0.0127775312999988*kSq[4]+0.04666666666666667*kSq[3]-0.03849001794597505*kSq[2]+0.5777777777777777*epsilon[0]*rdx2Sq[1]+0.03849001794597505*kSq[1]+0.5777777777777777*epsilon[0]*rdx2Sq[0]-0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[5], globalIdxs[6], 0.03442651863295482*kSq[7]-0.0295084445425327*kSq[6]-0.05962847939999439*kSq[5]-0.063887656499994*kSq[4]+0.05333333333333333*kSq[3]+0.06666666666666667*epsilon[0]*rdx2Sq[1]+0.03849001794597505*kSq[1]-0.8888888888888888*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[5], globalIdxs[7], 0.006147592613027645*kSq[6]+0.03336355394999686*kSq[5]+0.02697478829999747*kSq[4]+0.01924500897298752*kSq[2]+0.1888888888888889*epsilon[0]*rdx2Sq[1]+0.3111111111111111*epsilon[0]*rdx2Sq[0]-0.02222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[6], globalIdxs[0], (-0.01721325931647741*kSq[6])-0.03975231959999626*kSq[5]-0.05678902799999467*kSq[4]-0.01333333333333333*kSq[3]+0.03849001794597505*kSq[2]-0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.4444444444444444*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[6], globalIdxs[1], 0.07950463919999252*kSq[5]+0.1135780559999893*kSq[4]-0.5333333333333333*epsilon[0]*rdx2Sq[1]+0.8888888888888888*epsilon[0]*rdx2Sq[0]-0.1777777777777778*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[6], globalIdxs[2], (-0.01721325931647741*kSq[6])-0.03975231959999626*kSq[5]-0.05678902799999467*kSq[4]+0.01333333333333333*kSq[3]+0.03849001794597505*kSq[2]-0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.4444444444444444*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[6], globalIdxs[3], (-0.03442651863295482*kSq[7])+0.03442651863295482*kSq[6]+0.09938079899999068*kSq[5]+0.09938079899999068*kSq[4]+0.02666666666666666*kSq[3]-0.0769800358919501*kSq[2]+0.0769800358919501*kSq[1]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[6], globalIdxs[4], 0.03442651863295482*kSq[7]+0.03442651863295482*kSq[6]+0.09938079899999068*kSq[5]+0.09938079899999068*kSq[4]-0.02666666666666666*kSq[3]-0.0769800358919501*kSq[2]-0.0769800358919501*kSq[1]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[6], globalIdxs[5], 0.03442651863295482*kSq[7]-0.0295084445425327*kSq[6]-0.05962847939999439*kSq[5]-0.063887656499994*kSq[4]+0.05333333333333333*kSq[3]+0.06666666666666667*epsilon[0]*rdx2Sq[1]+0.03849001794597505*kSq[1]-0.8888888888888888*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[6], globalIdxs[6], 0.1967229636168847*kSq[6]-0.07950463919999252*kSq[5]+0.2271561119999787*kSq[4]-0.3079201435678004*kSq[2]+0.5333333333333333*epsilon[0]*rdx2Sq[1]+1.777777777777778*epsilon[0]*rdx2Sq[0]-0.3555555555555556*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[6], globalIdxs[7], (-0.03442651863295482*kSq[7])-0.0295084445425327*kSq[6]-0.05962847939999439*kSq[5]-0.063887656499994*kSq[4]-0.05333333333333333*kSq[3]+0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.03849001794597505*kSq[1]-0.8888888888888888*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[7], globalIdxs[0], 0.0234254740499978*kSq[5]+0.0234254740499978*kSq[4]+0.01333333333333333*kSq[3]+0.2555555555555555*epsilon[0]*rdx2Sq[1]+0.2555555555555555*epsilon[0]*rdx2Sq[0]-0.03333333333333333*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[7], globalIdxs[1], 0.01721325931647741*kSq[6]-0.03975231959999626*kSq[5]-0.05678902799999467*kSq[4]-0.01333333333333333*kSq[3]-0.03849001794597505*kSq[2]-0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.4444444444444444*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[7], globalIdxs[2], 0.006147592613027645*kSq[7]+0.02697478829999747*kSq[5]+0.03336355394999686*kSq[4]+0.3111111111111111*epsilon[0]*rdx2Sq[1]+0.01924500897298752*kSq[1]+0.1888888888888889*epsilon[0]*rdx2Sq[0]-0.02222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[7], globalIdxs[3], 0.01721325931647741*kSq[7]-0.05678902799999467*kSq[5]-0.03975231959999626*kSq[4]-0.01333333333333333*kSq[3]-0.4444444444444444*epsilon[0]*rdx2Sq[1]-0.03849001794597505*kSq[1]-0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[7], globalIdxs[4], (-0.0295084445425327*kSq[7])-0.03442651863295482*kSq[6]-0.063887656499994*kSq[5]-0.05962847939999439*kSq[4]-0.05333333333333333*kSq[3]-0.03849001794597505*kSq[2]-0.8888888888888888*epsilon[0]*rdx2Sq[1]+0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[7], globalIdxs[5], 0.006147592613027645*kSq[6]+0.03336355394999686*kSq[5]+0.02697478829999747*kSq[4]+0.01924500897298752*kSq[2]+0.1888888888888889*epsilon[0]*rdx2Sq[1]+0.3111111111111111*epsilon[0]*rdx2Sq[0]-0.02222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[7], globalIdxs[6], (-0.03442651863295482*kSq[7])-0.0295084445425327*kSq[6]-0.05962847939999439*kSq[5]-0.063887656499994*kSq[4]-0.05333333333333333*kSq[3]+0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.03849001794597505*kSq[1]-0.8888888888888888*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[7], globalIdxs[7], (-0.04549218533640458*kSq[7])-0.04549218533640458*kSq[6]-0.0127775312999988*kSq[5]-0.0127775312999988*kSq[4]-0.04666666666666667*kSq[3]-0.03849001794597505*kSq[2]+0.5777777777777777*epsilon[0]*rdx2Sq[1]-0.03849001794597505*kSq[1]+0.5777777777777777*epsilon[0]*rdx2Sq[0]-0.06666666666666667*kSq[0]);

}
void fem_poisson_lhs_stencil_consteps_2x_ser_p1_inx_periodicx_loy_dirichlety(const double *epsilon, const double *kSq, const double *dx, const double *bcVals, const long *globalIdxs, gkyl_mat_triples *tri) 
{ 
  // epsilon: permittivity.
  // kSq: wave number squared (factor multiplying phi).
  // dx: cell length in each direction.
  // bcVals[3]: values to impose as BCs, i.e. bcVals[0]*phi+bcVals[1]*d(phi)/dx=bcVals[2].
  // globalIdxs: global linear index of each basis function/node in current cell.
  // tri: triples object (i,j,val), i.e. contribute val to i,j element of the global matrix.

  double rdx2Sq[2];
  rdx2Sq[0] = 4.0/(dx[0]*dx[0]);
  rdx2Sq[1] = 4.0/(dx[1]*dx[1]);

  gkyl_mat_triples_insert(tri, globalIdxs[0], globalIdxs[0], 1.0);
  gkyl_mat_triples_insert(tri, globalIdxs[0], globalIdxs[1], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[0], globalIdxs[2], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[0], globalIdxs[3], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[1], globalIdxs[0], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[1], globalIdxs[1], 1.0);
  gkyl_mat_triples_insert(tri, globalIdxs[1], globalIdxs[2], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[1], globalIdxs[3], 0.0);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[0], (-0.3333333333333333*epsilon[0]*rdx2Sq[1])+0.09622504486493762*kSq[1]+0.1666666666666667*epsilon[0]*rdx2Sq[0]-0.1111111111111111*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[1], (-0.1666666666666667*epsilon[0]*rdx2Sq[1])-0.1666666666666667*epsilon[0]*rdx2Sq[0]-0.05555555555555555*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[2], 0.1666666666666667*kSq[3]-0.1924500897298752*kSq[2]+0.3333333333333333*epsilon[0]*rdx2Sq[1]+0.1924500897298752*kSq[1]+0.3333333333333333*epsilon[0]*rdx2Sq[0]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[3], (-0.09622504486493762*kSq[2])+0.1666666666666667*epsilon[0]*rdx2Sq[1]-0.3333333333333333*epsilon[0]*rdx2Sq[0]-0.1111111111111111*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[0], (-0.1666666666666667*epsilon[0]*rdx2Sq[1])-0.1666666666666667*epsilon[0]*rdx2Sq[0]-0.05555555555555555*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[1], (-0.3333333333333333*epsilon[0]*rdx2Sq[1])-0.09622504486493762*kSq[1]+0.1666666666666667*epsilon[0]*rdx2Sq[0]-0.1111111111111111*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[2], (-0.09622504486493762*kSq[2])+0.1666666666666667*epsilon[0]*rdx2Sq[1]-0.3333333333333333*epsilon[0]*rdx2Sq[0]-0.1111111111111111*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[3], (-0.1666666666666667*kSq[3])-0.1924500897298752*kSq[2]+0.3333333333333333*epsilon[0]*rdx2Sq[1]-0.1924500897298752*kSq[1]+0.3333333333333333*epsilon[0]*rdx2Sq[0]-0.2222222222222222*kSq[0]);

}
void fem_poisson_lhs_stencil_consteps_2x_ser_p2_inx_periodicx_loy_dirichlety(const double *epsilon, const double *kSq, const double *dx, const double *bcVals, const long *globalIdxs, gkyl_mat_triples *tri) 
{ 
  // epsilon: permittivity.
  // kSq: wave number squared (factor multiplying phi).
  // dx: cell length in each direction.
  // bcVals[3]: values to impose as BCs, i.e. bcVals[0]*phi+bcVals[1]*d(phi)/dx=bcVals[2].
  // globalIdxs: global linear index of each basis function/node in current cell.
  // tri: triples object (i,j,val), i.e. contribute val to i,j element of the global matrix.

  double rdx2Sq[2];
  rdx2Sq[0] = 4.0/(dx[0]*dx[0]);
  rdx2Sq[1] = 4.0/(dx[1]*dx[1]);

  gkyl_mat_triples_insert(tri, globalIdxs[0], globalIdxs[0], 1.0);
  gkyl_mat_triples_insert(tri, globalIdxs[0], globalIdxs[1], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[0], globalIdxs[2], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[0], globalIdxs[3], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[0], globalIdxs[4], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[0], globalIdxs[5], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[0], globalIdxs[6], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[0], globalIdxs[7], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[1], globalIdxs[0], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[1], globalIdxs[1], 1.0);
  gkyl_mat_triples_insert(tri, globalIdxs[1], globalIdxs[2], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[1], globalIdxs[3], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[1], globalIdxs[4], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[1], globalIdxs[5], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[1], globalIdxs[6], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[1], globalIdxs[7], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[2], globalIdxs[0], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[2], globalIdxs[1], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[2], globalIdxs[2], 1.0);
  gkyl_mat_triples_insert(tri, globalIdxs[2], globalIdxs[3], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[2], globalIdxs[4], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[2], globalIdxs[5], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[2], globalIdxs[6], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[2], globalIdxs[7], 0.0);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[0], 0.0295084445425327*kSq[7]+0.03442651863295482*kSq[6]-0.063887656499994*kSq[5]-0.05962847939999439*kSq[4]-0.05333333333333333*kSq[3]+0.03849001794597505*kSq[2]-0.8888888888888888*epsilon[0]*rdx2Sq[1]+0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[1], (-0.03442651863295482*kSq[7])-0.03442651863295482*kSq[6]+0.09938079899999068*kSq[5]+0.09938079899999068*kSq[4]-0.02666666666666666*kSq[3]+0.0769800358919501*kSq[2]+0.0769800358919501*kSq[1]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[2], 0.01721325931647741*kSq[7]-0.05678902799999467*kSq[5]-0.03975231959999626*kSq[4]+0.01333333333333333*kSq[3]-0.4444444444444444*epsilon[0]*rdx2Sq[1]-0.03849001794597505*kSq[1]-0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[3], (-0.1967229636168847*kSq[7])+0.2271561119999787*kSq[5]-0.07950463919999252*kSq[4]+1.777777777777778*epsilon[0]*rdx2Sq[1]+0.3079201435678004*kSq[1]+0.5333333333333333*epsilon[0]*rdx2Sq[0]-0.3555555555555556*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[4], 0.1135780559999893*kSq[5]+0.07950463919999252*kSq[4]+0.8888888888888888*epsilon[0]*rdx2Sq[1]-0.5333333333333333*epsilon[0]*rdx2Sq[0]-0.1777777777777778*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[5], 0.0295084445425327*kSq[7]-0.03442651863295482*kSq[6]-0.063887656499994*kSq[5]-0.05962847939999439*kSq[4]+0.05333333333333333*kSq[3]-0.03849001794597505*kSq[2]-0.8888888888888888*epsilon[0]*rdx2Sq[1]+0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[6], (-0.03442651863295482*kSq[7])+0.03442651863295482*kSq[6]+0.09938079899999068*kSq[5]+0.09938079899999068*kSq[4]+0.02666666666666666*kSq[3]-0.0769800358919501*kSq[2]+0.0769800358919501*kSq[1]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[7], 0.01721325931647741*kSq[7]-0.05678902799999467*kSq[5]-0.03975231959999626*kSq[4]-0.01333333333333333*kSq[3]-0.4444444444444444*epsilon[0]*rdx2Sq[1]-0.03849001794597505*kSq[1]-0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[4], globalIdxs[0], (-0.01721325931647741*kSq[7])-0.05678902799999467*kSq[5]-0.03975231959999626*kSq[4]-0.01333333333333333*kSq[3]-0.4444444444444444*epsilon[0]*rdx2Sq[1]+0.03849001794597505*kSq[1]-0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[4], globalIdxs[1], 0.03442651863295482*kSq[7]-0.03442651863295482*kSq[6]+0.09938079899999068*kSq[5]+0.09938079899999068*kSq[4]+0.02666666666666666*kSq[3]+0.0769800358919501*kSq[2]-0.0769800358919501*kSq[1]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[4], globalIdxs[2], (-0.0295084445425327*kSq[7])+0.03442651863295482*kSq[6]-0.063887656499994*kSq[5]-0.05962847939999439*kSq[4]+0.05333333333333333*kSq[3]+0.03849001794597505*kSq[2]-0.8888888888888888*epsilon[0]*rdx2Sq[1]+0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[4], globalIdxs[3], 0.1135780559999893*kSq[5]+0.07950463919999252*kSq[4]+0.8888888888888888*epsilon[0]*rdx2Sq[1]-0.5333333333333333*epsilon[0]*rdx2Sq[0]-0.1777777777777778*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[4], globalIdxs[4], 0.1967229636168847*kSq[7]+0.2271561119999787*kSq[5]-0.07950463919999252*kSq[4]+1.777777777777778*epsilon[0]*rdx2Sq[1]-0.3079201435678004*kSq[1]+0.5333333333333333*epsilon[0]*rdx2Sq[0]-0.3555555555555556*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[4], globalIdxs[5], (-0.01721325931647741*kSq[7])-0.05678902799999467*kSq[5]-0.03975231959999626*kSq[4]+0.01333333333333333*kSq[3]-0.4444444444444444*epsilon[0]*rdx2Sq[1]+0.03849001794597505*kSq[1]-0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[4], globalIdxs[6], 0.03442651863295482*kSq[7]+0.03442651863295482*kSq[6]+0.09938079899999068*kSq[5]+0.09938079899999068*kSq[4]-0.02666666666666666*kSq[3]-0.0769800358919501*kSq[2]-0.0769800358919501*kSq[1]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[4], globalIdxs[7], (-0.0295084445425327*kSq[7])-0.03442651863295482*kSq[6]-0.063887656499994*kSq[5]-0.05962847939999439*kSq[4]-0.05333333333333333*kSq[3]-0.03849001794597505*kSq[2]-0.8888888888888888*epsilon[0]*rdx2Sq[1]+0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[5], globalIdxs[0], (-0.006147592613027645*kSq[7])+0.02697478829999747*kSq[5]+0.03336355394999686*kSq[4]+0.3111111111111111*epsilon[0]*rdx2Sq[1]-0.01924500897298752*kSq[1]+0.1888888888888889*epsilon[0]*rdx2Sq[0]-0.02222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[5], globalIdxs[1], 0.01721325931647741*kSq[6]-0.03975231959999626*kSq[5]-0.05678902799999467*kSq[4]+0.01333333333333333*kSq[3]-0.03849001794597505*kSq[2]-0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.4444444444444444*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[5], globalIdxs[2], 0.0234254740499978*kSq[5]+0.0234254740499978*kSq[4]-0.01333333333333333*kSq[3]+0.2555555555555555*epsilon[0]*rdx2Sq[1]+0.2555555555555555*epsilon[0]*rdx2Sq[0]-0.03333333333333333*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[5], globalIdxs[3], 0.0295084445425327*kSq[7]-0.03442651863295482*kSq[6]-0.063887656499994*kSq[5]-0.05962847939999439*kSq[4]+0.05333333333333333*kSq[3]-0.03849001794597505*kSq[2]-0.8888888888888888*epsilon[0]*rdx2Sq[1]+0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[5], globalIdxs[4], (-0.01721325931647741*kSq[7])-0.05678902799999467*kSq[5]-0.03975231959999626*kSq[4]+0.01333333333333333*kSq[3]-0.4444444444444444*epsilon[0]*rdx2Sq[1]+0.03849001794597505*kSq[1]-0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[5], globalIdxs[5], 0.04549218533640458*kSq[7]-0.04549218533640458*kSq[6]-0.0127775312999988*kSq[5]-0.0127775312999988*kSq[4]+0.04666666666666667*kSq[3]-0.03849001794597505*kSq[2]+0.5777777777777777*epsilon[0]*rdx2Sq[1]+0.03849001794597505*kSq[1]+0.5777777777777777*epsilon[0]*rdx2Sq[0]-0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[5], globalIdxs[6], 0.03442651863295482*kSq[7]-0.0295084445425327*kSq[6]-0.05962847939999439*kSq[5]-0.063887656499994*kSq[4]+0.05333333333333333*kSq[3]+0.06666666666666667*epsilon[0]*rdx2Sq[1]+0.03849001794597505*kSq[1]-0.8888888888888888*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[5], globalIdxs[7], 0.006147592613027645*kSq[6]+0.03336355394999686*kSq[5]+0.02697478829999747*kSq[4]+0.01924500897298752*kSq[2]+0.1888888888888889*epsilon[0]*rdx2Sq[1]+0.3111111111111111*epsilon[0]*rdx2Sq[0]-0.02222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[6], globalIdxs[0], (-0.01721325931647741*kSq[6])-0.03975231959999626*kSq[5]-0.05678902799999467*kSq[4]-0.01333333333333333*kSq[3]+0.03849001794597505*kSq[2]-0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.4444444444444444*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[6], globalIdxs[1], 0.07950463919999252*kSq[5]+0.1135780559999893*kSq[4]-0.5333333333333333*epsilon[0]*rdx2Sq[1]+0.8888888888888888*epsilon[0]*rdx2Sq[0]-0.1777777777777778*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[6], globalIdxs[2], (-0.01721325931647741*kSq[6])-0.03975231959999626*kSq[5]-0.05678902799999467*kSq[4]+0.01333333333333333*kSq[3]+0.03849001794597505*kSq[2]-0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.4444444444444444*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[6], globalIdxs[3], (-0.03442651863295482*kSq[7])+0.03442651863295482*kSq[6]+0.09938079899999068*kSq[5]+0.09938079899999068*kSq[4]+0.02666666666666666*kSq[3]-0.0769800358919501*kSq[2]+0.0769800358919501*kSq[1]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[6], globalIdxs[4], 0.03442651863295482*kSq[7]+0.03442651863295482*kSq[6]+0.09938079899999068*kSq[5]+0.09938079899999068*kSq[4]-0.02666666666666666*kSq[3]-0.0769800358919501*kSq[2]-0.0769800358919501*kSq[1]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[6], globalIdxs[5], 0.03442651863295482*kSq[7]-0.0295084445425327*kSq[6]-0.05962847939999439*kSq[5]-0.063887656499994*kSq[4]+0.05333333333333333*kSq[3]+0.06666666666666667*epsilon[0]*rdx2Sq[1]+0.03849001794597505*kSq[1]-0.8888888888888888*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[6], globalIdxs[6], 0.1967229636168847*kSq[6]-0.07950463919999252*kSq[5]+0.2271561119999787*kSq[4]-0.3079201435678004*kSq[2]+0.5333333333333333*epsilon[0]*rdx2Sq[1]+1.777777777777778*epsilon[0]*rdx2Sq[0]-0.3555555555555556*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[6], globalIdxs[7], (-0.03442651863295482*kSq[7])-0.0295084445425327*kSq[6]-0.05962847939999439*kSq[5]-0.063887656499994*kSq[4]-0.05333333333333333*kSq[3]+0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.03849001794597505*kSq[1]-0.8888888888888888*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[7], globalIdxs[0], 0.0234254740499978*kSq[5]+0.0234254740499978*kSq[4]+0.01333333333333333*kSq[3]+0.2555555555555555*epsilon[0]*rdx2Sq[1]+0.2555555555555555*epsilon[0]*rdx2Sq[0]-0.03333333333333333*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[7], globalIdxs[1], 0.01721325931647741*kSq[6]-0.03975231959999626*kSq[5]-0.05678902799999467*kSq[4]-0.01333333333333333*kSq[3]-0.03849001794597505*kSq[2]-0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.4444444444444444*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[7], globalIdxs[2], 0.006147592613027645*kSq[7]+0.02697478829999747*kSq[5]+0.03336355394999686*kSq[4]+0.3111111111111111*epsilon[0]*rdx2Sq[1]+0.01924500897298752*kSq[1]+0.1888888888888889*epsilon[0]*rdx2Sq[0]-0.02222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[7], globalIdxs[3], 0.01721325931647741*kSq[7]-0.05678902799999467*kSq[5]-0.03975231959999626*kSq[4]-0.01333333333333333*kSq[3]-0.4444444444444444*epsilon[0]*rdx2Sq[1]-0.03849001794597505*kSq[1]-0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[7], globalIdxs[4], (-0.0295084445425327*kSq[7])-0.03442651863295482*kSq[6]-0.063887656499994*kSq[5]-0.05962847939999439*kSq[4]-0.05333333333333333*kSq[3]-0.03849001794597505*kSq[2]-0.8888888888888888*epsilon[0]*rdx2Sq[1]+0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[7], globalIdxs[5], 0.006147592613027645*kSq[6]+0.03336355394999686*kSq[5]+0.02697478829999747*kSq[4]+0.01924500897298752*kSq[2]+0.1888888888888889*epsilon[0]*rdx2Sq[1]+0.3111111111111111*epsilon[0]*rdx2Sq[0]-0.02222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[7], globalIdxs[6], (-0.03442651863295482*kSq[7])-0.0295084445425327*kSq[6]-0.05962847939999439*kSq[5]-0.063887656499994*kSq[4]-0.05333333333333333*kSq[3]+0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.03849001794597505*kSq[1]-0.8888888888888888*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[7], globalIdxs[7], (-0.04549218533640458*kSq[7])-0.04549218533640458*kSq[6]-0.0127775312999988*kSq[5]-0.0127775312999988*kSq[4]-0.04666666666666667*kSq[3]-0.03849001794597505*kSq[2]+0.5777777777777777*epsilon[0]*rdx2Sq[1]-0.03849001794597505*kSq[1]+0.5777777777777777*epsilon[0]*rdx2Sq[0]-0.06666666666666667*kSq[0]);

}
void fem_poisson_lhs_stencil_consteps_2x_ser_p1_inx_periodicx_loy_neumanny(const double *epsilon, const double *kSq, const double *dx, const double *bcVals, const long *globalIdxs, gkyl_mat_triples *tri) 
{ 
  // epsilon: permittivity.
  // kSq: wave number squared (factor multiplying phi).
  // dx: cell length in each direction.
  // bcVals[3]: values to impose as BCs, i.e. bcVals[0]*phi+bcVals[1]*d(phi)/dx=bcVals[2].
  // globalIdxs: global linear index of each basis function/node in current cell.
  // tri: triples object (i,j,val), i.e. contribute val to i,j element of the global matrix.

  double rdx2Sq[2];
  rdx2Sq[0] = 4.0/(dx[0]*dx[0]);
  rdx2Sq[1] = 4.0/(dx[1]*dx[1]);

  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[0], (-0.1666666666666667*kSq[3])+0.1924500897298752*kSq[2]+0.3333333333333333*epsilon[0]*rdx2Sq[1]+0.1924500897298752*kSq[1]+0.3333333333333333*epsilon[0]*rdx2Sq[0]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[1], 0.09622504486493762*kSq[2]+0.1666666666666667*epsilon[0]*rdx2Sq[1]-0.3333333333333333*epsilon[0]*rdx2Sq[0]-0.1111111111111111*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[2], (-0.3333333333333333*epsilon[0]*rdx2Sq[1])+0.09622504486493762*kSq[1]+0.1666666666666667*epsilon[0]*rdx2Sq[0]-0.1111111111111111*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[3], (-0.1666666666666667*epsilon[0]*rdx2Sq[1])-0.1666666666666667*epsilon[0]*rdx2Sq[0]-0.05555555555555555*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[0], 0.09622504486493762*kSq[2]+0.1666666666666667*epsilon[0]*rdx2Sq[1]-0.3333333333333333*epsilon[0]*rdx2Sq[0]-0.1111111111111111*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[1], 0.1666666666666667*kSq[3]+0.1924500897298752*kSq[2]+0.3333333333333333*epsilon[0]*rdx2Sq[1]-0.1924500897298752*kSq[1]+0.3333333333333333*epsilon[0]*rdx2Sq[0]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[2], (-0.1666666666666667*epsilon[0]*rdx2Sq[1])-0.1666666666666667*epsilon[0]*rdx2Sq[0]-0.05555555555555555*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[3], (-0.3333333333333333*epsilon[0]*rdx2Sq[1])-0.09622504486493762*kSq[1]+0.1666666666666667*epsilon[0]*rdx2Sq[0]-0.1111111111111111*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[0], (-0.3333333333333333*epsilon[0]*rdx2Sq[1])+0.09622504486493762*kSq[1]+0.1666666666666667*epsilon[0]*rdx2Sq[0]-0.1111111111111111*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[1], (-0.1666666666666667*epsilon[0]*rdx2Sq[1])-0.1666666666666667*epsilon[0]*rdx2Sq[0]-0.05555555555555555*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[2], 0.1666666666666667*kSq[3]-0.1924500897298752*kSq[2]+0.3333333333333333*epsilon[0]*rdx2Sq[1]+0.1924500897298752*kSq[1]+0.3333333333333333*epsilon[0]*rdx2Sq[0]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[3], (-0.09622504486493762*kSq[2])+0.1666666666666667*epsilon[0]*rdx2Sq[1]-0.3333333333333333*epsilon[0]*rdx2Sq[0]-0.1111111111111111*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[0], (-0.1666666666666667*epsilon[0]*rdx2Sq[1])-0.1666666666666667*epsilon[0]*rdx2Sq[0]-0.05555555555555555*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[1], (-0.3333333333333333*epsilon[0]*rdx2Sq[1])-0.09622504486493762*kSq[1]+0.1666666666666667*epsilon[0]*rdx2Sq[0]-0.1111111111111111*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[2], (-0.09622504486493762*kSq[2])+0.1666666666666667*epsilon[0]*rdx2Sq[1]-0.3333333333333333*epsilon[0]*rdx2Sq[0]-0.1111111111111111*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[3], (-0.1666666666666667*kSq[3])-0.1924500897298752*kSq[2]+0.3333333333333333*epsilon[0]*rdx2Sq[1]-0.1924500897298752*kSq[1]+0.3333333333333333*epsilon[0]*rdx2Sq[0]-0.2222222222222222*kSq[0]);

}
void fem_poisson_lhs_stencil_consteps_2x_ser_p2_inx_periodicx_loy_neumanny(const double *epsilon, const double *kSq, const double *dx, const double *bcVals, const long *globalIdxs, gkyl_mat_triples *tri) 
{ 
  // epsilon: permittivity.
  // kSq: wave number squared (factor multiplying phi).
  // dx: cell length in each direction.
  // bcVals[3]: values to impose as BCs, i.e. bcVals[0]*phi+bcVals[1]*d(phi)/dx=bcVals[2].
  // globalIdxs: global linear index of each basis function/node in current cell.
  // tri: triples object (i,j,val), i.e. contribute val to i,j element of the global matrix.

  double rdx2Sq[2];
  rdx2Sq[0] = 4.0/(dx[0]*dx[0]);
  rdx2Sq[1] = 4.0/(dx[1]*dx[1]);

  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[0], 0.04549218533640458*kSq[7]+0.04549218533640458*kSq[6]-0.0127775312999988*kSq[5]-0.0127775312999988*kSq[4]-0.04666666666666667*kSq[3]+0.03849001794597505*kSq[2]+0.5777777777777777*epsilon[0]*rdx2Sq[1]+0.03849001794597505*kSq[1]+0.5777777777777777*epsilon[0]*rdx2Sq[0]-0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[1], 0.03442651863295482*kSq[7]+0.0295084445425327*kSq[6]-0.05962847939999439*kSq[5]-0.063887656499994*kSq[4]-0.05333333333333333*kSq[3]+0.06666666666666667*epsilon[0]*rdx2Sq[1]+0.03849001794597505*kSq[1]-0.8888888888888888*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[2], (-0.006147592613027645*kSq[6])+0.03336355394999686*kSq[5]+0.02697478829999747*kSq[4]-0.01924500897298752*kSq[2]+0.1888888888888889*epsilon[0]*rdx2Sq[1]+0.3111111111111111*epsilon[0]*rdx2Sq[0]-0.02222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[3], 0.0295084445425327*kSq[7]+0.03442651863295482*kSq[6]-0.063887656499994*kSq[5]-0.05962847939999439*kSq[4]-0.05333333333333333*kSq[3]+0.03849001794597505*kSq[2]-0.8888888888888888*epsilon[0]*rdx2Sq[1]+0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[4], (-0.01721325931647741*kSq[7])-0.05678902799999467*kSq[5]-0.03975231959999626*kSq[4]-0.01333333333333333*kSq[3]-0.4444444444444444*epsilon[0]*rdx2Sq[1]+0.03849001794597505*kSq[1]-0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[5], (-0.006147592613027645*kSq[7])+0.02697478829999747*kSq[5]+0.03336355394999686*kSq[4]+0.3111111111111111*epsilon[0]*rdx2Sq[1]-0.01924500897298752*kSq[1]+0.1888888888888889*epsilon[0]*rdx2Sq[0]-0.02222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[6], (-0.01721325931647741*kSq[6])-0.03975231959999626*kSq[5]-0.05678902799999467*kSq[4]-0.01333333333333333*kSq[3]+0.03849001794597505*kSq[2]-0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.4444444444444444*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[7], 0.0234254740499978*kSq[5]+0.0234254740499978*kSq[4]+0.01333333333333333*kSq[3]+0.2555555555555555*epsilon[0]*rdx2Sq[1]+0.2555555555555555*epsilon[0]*rdx2Sq[0]-0.03333333333333333*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[0], 0.03442651863295482*kSq[7]+0.0295084445425327*kSq[6]-0.05962847939999439*kSq[5]-0.063887656499994*kSq[4]-0.05333333333333333*kSq[3]+0.06666666666666667*epsilon[0]*rdx2Sq[1]+0.03849001794597505*kSq[1]-0.8888888888888888*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[1], (-0.1967229636168847*kSq[6])-0.07950463919999252*kSq[5]+0.2271561119999787*kSq[4]+0.3079201435678004*kSq[2]+0.5333333333333333*epsilon[0]*rdx2Sq[1]+1.777777777777778*epsilon[0]*rdx2Sq[0]-0.3555555555555556*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[2], (-0.03442651863295482*kSq[7])+0.0295084445425327*kSq[6]-0.05962847939999439*kSq[5]-0.063887656499994*kSq[4]+0.05333333333333333*kSq[3]+0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.03849001794597505*kSq[1]-0.8888888888888888*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[3], (-0.03442651863295482*kSq[7])-0.03442651863295482*kSq[6]+0.09938079899999068*kSq[5]+0.09938079899999068*kSq[4]-0.02666666666666666*kSq[3]+0.0769800358919501*kSq[2]+0.0769800358919501*kSq[1]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[4], 0.03442651863295482*kSq[7]-0.03442651863295482*kSq[6]+0.09938079899999068*kSq[5]+0.09938079899999068*kSq[4]+0.02666666666666666*kSq[3]+0.0769800358919501*kSq[2]-0.0769800358919501*kSq[1]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[5], 0.01721325931647741*kSq[6]-0.03975231959999626*kSq[5]-0.05678902799999467*kSq[4]+0.01333333333333333*kSq[3]-0.03849001794597505*kSq[2]-0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.4444444444444444*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[6], 0.07950463919999252*kSq[5]+0.1135780559999893*kSq[4]-0.5333333333333333*epsilon[0]*rdx2Sq[1]+0.8888888888888888*epsilon[0]*rdx2Sq[0]-0.1777777777777778*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[7], 0.01721325931647741*kSq[6]-0.03975231959999626*kSq[5]-0.05678902799999467*kSq[4]-0.01333333333333333*kSq[3]-0.03849001794597505*kSq[2]-0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.4444444444444444*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[0], (-0.006147592613027645*kSq[6])+0.03336355394999686*kSq[5]+0.02697478829999747*kSq[4]-0.01924500897298752*kSq[2]+0.1888888888888889*epsilon[0]*rdx2Sq[1]+0.3111111111111111*epsilon[0]*rdx2Sq[0]-0.02222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[1], (-0.03442651863295482*kSq[7])+0.0295084445425327*kSq[6]-0.05962847939999439*kSq[5]-0.063887656499994*kSq[4]+0.05333333333333333*kSq[3]+0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.03849001794597505*kSq[1]-0.8888888888888888*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[2], (-0.04549218533640458*kSq[7])+0.04549218533640458*kSq[6]-0.0127775312999988*kSq[5]-0.0127775312999988*kSq[4]+0.04666666666666667*kSq[3]+0.03849001794597505*kSq[2]+0.5777777777777777*epsilon[0]*rdx2Sq[1]-0.03849001794597505*kSq[1]+0.5777777777777777*epsilon[0]*rdx2Sq[0]-0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[3], 0.01721325931647741*kSq[7]-0.05678902799999467*kSq[5]-0.03975231959999626*kSq[4]+0.01333333333333333*kSq[3]-0.4444444444444444*epsilon[0]*rdx2Sq[1]-0.03849001794597505*kSq[1]-0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[4], (-0.0295084445425327*kSq[7])+0.03442651863295482*kSq[6]-0.063887656499994*kSq[5]-0.05962847939999439*kSq[4]+0.05333333333333333*kSq[3]+0.03849001794597505*kSq[2]-0.8888888888888888*epsilon[0]*rdx2Sq[1]+0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[5], 0.0234254740499978*kSq[5]+0.0234254740499978*kSq[4]-0.01333333333333333*kSq[3]+0.2555555555555555*epsilon[0]*rdx2Sq[1]+0.2555555555555555*epsilon[0]*rdx2Sq[0]-0.03333333333333333*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[6], (-0.01721325931647741*kSq[6])-0.03975231959999626*kSq[5]-0.05678902799999467*kSq[4]+0.01333333333333333*kSq[3]+0.03849001794597505*kSq[2]-0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.4444444444444444*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[7], 0.006147592613027645*kSq[7]+0.02697478829999747*kSq[5]+0.03336355394999686*kSq[4]+0.3111111111111111*epsilon[0]*rdx2Sq[1]+0.01924500897298752*kSq[1]+0.1888888888888889*epsilon[0]*rdx2Sq[0]-0.02222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[0], 0.0295084445425327*kSq[7]+0.03442651863295482*kSq[6]-0.063887656499994*kSq[5]-0.05962847939999439*kSq[4]-0.05333333333333333*kSq[3]+0.03849001794597505*kSq[2]-0.8888888888888888*epsilon[0]*rdx2Sq[1]+0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[1], (-0.03442651863295482*kSq[7])-0.03442651863295482*kSq[6]+0.09938079899999068*kSq[5]+0.09938079899999068*kSq[4]-0.02666666666666666*kSq[3]+0.0769800358919501*kSq[2]+0.0769800358919501*kSq[1]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[2], 0.01721325931647741*kSq[7]-0.05678902799999467*kSq[5]-0.03975231959999626*kSq[4]+0.01333333333333333*kSq[3]-0.4444444444444444*epsilon[0]*rdx2Sq[1]-0.03849001794597505*kSq[1]-0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[3], (-0.1967229636168847*kSq[7])+0.2271561119999787*kSq[5]-0.07950463919999252*kSq[4]+1.777777777777778*epsilon[0]*rdx2Sq[1]+0.3079201435678004*kSq[1]+0.5333333333333333*epsilon[0]*rdx2Sq[0]-0.3555555555555556*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[4], 0.1135780559999893*kSq[5]+0.07950463919999252*kSq[4]+0.8888888888888888*epsilon[0]*rdx2Sq[1]-0.5333333333333333*epsilon[0]*rdx2Sq[0]-0.1777777777777778*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[5], 0.0295084445425327*kSq[7]-0.03442651863295482*kSq[6]-0.063887656499994*kSq[5]-0.05962847939999439*kSq[4]+0.05333333333333333*kSq[3]-0.03849001794597505*kSq[2]-0.8888888888888888*epsilon[0]*rdx2Sq[1]+0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[6], (-0.03442651863295482*kSq[7])+0.03442651863295482*kSq[6]+0.09938079899999068*kSq[5]+0.09938079899999068*kSq[4]+0.02666666666666666*kSq[3]-0.0769800358919501*kSq[2]+0.0769800358919501*kSq[1]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[7], 0.01721325931647741*kSq[7]-0.05678902799999467*kSq[5]-0.03975231959999626*kSq[4]-0.01333333333333333*kSq[3]-0.4444444444444444*epsilon[0]*rdx2Sq[1]-0.03849001794597505*kSq[1]-0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[4], globalIdxs[0], (-0.01721325931647741*kSq[7])-0.05678902799999467*kSq[5]-0.03975231959999626*kSq[4]-0.01333333333333333*kSq[3]-0.4444444444444444*epsilon[0]*rdx2Sq[1]+0.03849001794597505*kSq[1]-0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[4], globalIdxs[1], 0.03442651863295482*kSq[7]-0.03442651863295482*kSq[6]+0.09938079899999068*kSq[5]+0.09938079899999068*kSq[4]+0.02666666666666666*kSq[3]+0.0769800358919501*kSq[2]-0.0769800358919501*kSq[1]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[4], globalIdxs[2], (-0.0295084445425327*kSq[7])+0.03442651863295482*kSq[6]-0.063887656499994*kSq[5]-0.05962847939999439*kSq[4]+0.05333333333333333*kSq[3]+0.03849001794597505*kSq[2]-0.8888888888888888*epsilon[0]*rdx2Sq[1]+0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[4], globalIdxs[3], 0.1135780559999893*kSq[5]+0.07950463919999252*kSq[4]+0.8888888888888888*epsilon[0]*rdx2Sq[1]-0.5333333333333333*epsilon[0]*rdx2Sq[0]-0.1777777777777778*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[4], globalIdxs[4], 0.1967229636168847*kSq[7]+0.2271561119999787*kSq[5]-0.07950463919999252*kSq[4]+1.777777777777778*epsilon[0]*rdx2Sq[1]-0.3079201435678004*kSq[1]+0.5333333333333333*epsilon[0]*rdx2Sq[0]-0.3555555555555556*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[4], globalIdxs[5], (-0.01721325931647741*kSq[7])-0.05678902799999467*kSq[5]-0.03975231959999626*kSq[4]+0.01333333333333333*kSq[3]-0.4444444444444444*epsilon[0]*rdx2Sq[1]+0.03849001794597505*kSq[1]-0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[4], globalIdxs[6], 0.03442651863295482*kSq[7]+0.03442651863295482*kSq[6]+0.09938079899999068*kSq[5]+0.09938079899999068*kSq[4]-0.02666666666666666*kSq[3]-0.0769800358919501*kSq[2]-0.0769800358919501*kSq[1]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[4], globalIdxs[7], (-0.0295084445425327*kSq[7])-0.03442651863295482*kSq[6]-0.063887656499994*kSq[5]-0.05962847939999439*kSq[4]-0.05333333333333333*kSq[3]-0.03849001794597505*kSq[2]-0.8888888888888888*epsilon[0]*rdx2Sq[1]+0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[5], globalIdxs[0], (-0.006147592613027645*kSq[7])+0.02697478829999747*kSq[5]+0.03336355394999686*kSq[4]+0.3111111111111111*epsilon[0]*rdx2Sq[1]-0.01924500897298752*kSq[1]+0.1888888888888889*epsilon[0]*rdx2Sq[0]-0.02222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[5], globalIdxs[1], 0.01721325931647741*kSq[6]-0.03975231959999626*kSq[5]-0.05678902799999467*kSq[4]+0.01333333333333333*kSq[3]-0.03849001794597505*kSq[2]-0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.4444444444444444*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[5], globalIdxs[2], 0.0234254740499978*kSq[5]+0.0234254740499978*kSq[4]-0.01333333333333333*kSq[3]+0.2555555555555555*epsilon[0]*rdx2Sq[1]+0.2555555555555555*epsilon[0]*rdx2Sq[0]-0.03333333333333333*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[5], globalIdxs[3], 0.0295084445425327*kSq[7]-0.03442651863295482*kSq[6]-0.063887656499994*kSq[5]-0.05962847939999439*kSq[4]+0.05333333333333333*kSq[3]-0.03849001794597505*kSq[2]-0.8888888888888888*epsilon[0]*rdx2Sq[1]+0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[5], globalIdxs[4], (-0.01721325931647741*kSq[7])-0.05678902799999467*kSq[5]-0.03975231959999626*kSq[4]+0.01333333333333333*kSq[3]-0.4444444444444444*epsilon[0]*rdx2Sq[1]+0.03849001794597505*kSq[1]-0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[5], globalIdxs[5], 0.04549218533640458*kSq[7]-0.04549218533640458*kSq[6]-0.0127775312999988*kSq[5]-0.0127775312999988*kSq[4]+0.04666666666666667*kSq[3]-0.03849001794597505*kSq[2]+0.5777777777777777*epsilon[0]*rdx2Sq[1]+0.03849001794597505*kSq[1]+0.5777777777777777*epsilon[0]*rdx2Sq[0]-0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[5], globalIdxs[6], 0.03442651863295482*kSq[7]-0.0295084445425327*kSq[6]-0.05962847939999439*kSq[5]-0.063887656499994*kSq[4]+0.05333333333333333*kSq[3]+0.06666666666666667*epsilon[0]*rdx2Sq[1]+0.03849001794597505*kSq[1]-0.8888888888888888*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[5], globalIdxs[7], 0.006147592613027645*kSq[6]+0.03336355394999686*kSq[5]+0.02697478829999747*kSq[4]+0.01924500897298752*kSq[2]+0.1888888888888889*epsilon[0]*rdx2Sq[1]+0.3111111111111111*epsilon[0]*rdx2Sq[0]-0.02222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[6], globalIdxs[0], (-0.01721325931647741*kSq[6])-0.03975231959999626*kSq[5]-0.05678902799999467*kSq[4]-0.01333333333333333*kSq[3]+0.03849001794597505*kSq[2]-0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.4444444444444444*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[6], globalIdxs[1], 0.07950463919999252*kSq[5]+0.1135780559999893*kSq[4]-0.5333333333333333*epsilon[0]*rdx2Sq[1]+0.8888888888888888*epsilon[0]*rdx2Sq[0]-0.1777777777777778*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[6], globalIdxs[2], (-0.01721325931647741*kSq[6])-0.03975231959999626*kSq[5]-0.05678902799999467*kSq[4]+0.01333333333333333*kSq[3]+0.03849001794597505*kSq[2]-0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.4444444444444444*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[6], globalIdxs[3], (-0.03442651863295482*kSq[7])+0.03442651863295482*kSq[6]+0.09938079899999068*kSq[5]+0.09938079899999068*kSq[4]+0.02666666666666666*kSq[3]-0.0769800358919501*kSq[2]+0.0769800358919501*kSq[1]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[6], globalIdxs[4], 0.03442651863295482*kSq[7]+0.03442651863295482*kSq[6]+0.09938079899999068*kSq[5]+0.09938079899999068*kSq[4]-0.02666666666666666*kSq[3]-0.0769800358919501*kSq[2]-0.0769800358919501*kSq[1]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[6], globalIdxs[5], 0.03442651863295482*kSq[7]-0.0295084445425327*kSq[6]-0.05962847939999439*kSq[5]-0.063887656499994*kSq[4]+0.05333333333333333*kSq[3]+0.06666666666666667*epsilon[0]*rdx2Sq[1]+0.03849001794597505*kSq[1]-0.8888888888888888*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[6], globalIdxs[6], 0.1967229636168847*kSq[6]-0.07950463919999252*kSq[5]+0.2271561119999787*kSq[4]-0.3079201435678004*kSq[2]+0.5333333333333333*epsilon[0]*rdx2Sq[1]+1.777777777777778*epsilon[0]*rdx2Sq[0]-0.3555555555555556*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[6], globalIdxs[7], (-0.03442651863295482*kSq[7])-0.0295084445425327*kSq[6]-0.05962847939999439*kSq[5]-0.063887656499994*kSq[4]-0.05333333333333333*kSq[3]+0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.03849001794597505*kSq[1]-0.8888888888888888*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[7], globalIdxs[0], 0.0234254740499978*kSq[5]+0.0234254740499978*kSq[4]+0.01333333333333333*kSq[3]+0.2555555555555555*epsilon[0]*rdx2Sq[1]+0.2555555555555555*epsilon[0]*rdx2Sq[0]-0.03333333333333333*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[7], globalIdxs[1], 0.01721325931647741*kSq[6]-0.03975231959999626*kSq[5]-0.05678902799999467*kSq[4]-0.01333333333333333*kSq[3]-0.03849001794597505*kSq[2]-0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.4444444444444444*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[7], globalIdxs[2], 0.006147592613027645*kSq[7]+0.02697478829999747*kSq[5]+0.03336355394999686*kSq[4]+0.3111111111111111*epsilon[0]*rdx2Sq[1]+0.01924500897298752*kSq[1]+0.1888888888888889*epsilon[0]*rdx2Sq[0]-0.02222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[7], globalIdxs[3], 0.01721325931647741*kSq[7]-0.05678902799999467*kSq[5]-0.03975231959999626*kSq[4]-0.01333333333333333*kSq[3]-0.4444444444444444*epsilon[0]*rdx2Sq[1]-0.03849001794597505*kSq[1]-0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[7], globalIdxs[4], (-0.0295084445425327*kSq[7])-0.03442651863295482*kSq[6]-0.063887656499994*kSq[5]-0.05962847939999439*kSq[4]-0.05333333333333333*kSq[3]-0.03849001794597505*kSq[2]-0.8888888888888888*epsilon[0]*rdx2Sq[1]+0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[7], globalIdxs[5], 0.006147592613027645*kSq[6]+0.03336355394999686*kSq[5]+0.02697478829999747*kSq[4]+0.01924500897298752*kSq[2]+0.1888888888888889*epsilon[0]*rdx2Sq[1]+0.3111111111111111*epsilon[0]*rdx2Sq[0]-0.02222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[7], globalIdxs[6], (-0.03442651863295482*kSq[7])-0.0295084445425327*kSq[6]-0.05962847939999439*kSq[5]-0.063887656499994*kSq[4]-0.05333333333333333*kSq[3]+0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.03849001794597505*kSq[1]-0.8888888888888888*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[7], globalIdxs[7], (-0.04549218533640458*kSq[7])-0.04549218533640458*kSq[6]-0.0127775312999988*kSq[5]-0.0127775312999988*kSq[4]-0.04666666666666667*kSq[3]-0.03849001794597505*kSq[2]+0.5777777777777777*epsilon[0]*rdx2Sq[1]-0.03849001794597505*kSq[1]+0.5777777777777777*epsilon[0]*rdx2Sq[0]-0.06666666666666667*kSq[0]);

}
void fem_poisson_lhs_stencil_consteps_2x_ser_p1_inx_periodicx_loy_robiny(const double *epsilon, const double *kSq, const double *dx, const double *bcVals, const long *globalIdxs, gkyl_mat_triples *tri) 
{ 
  // epsilon: permittivity.
  // kSq: wave number squared (factor multiplying phi).
  // dx: cell length in each direction.
  // bcVals[3]: values to impose as BCs, i.e. bcVals[0]*phi+bcVals[1]*d(phi)/dx=bcVals[2].
  // globalIdxs: global linear index of each basis function/node in current cell.
  // tri: triples object (i,j,val), i.e. contribute val to i,j element of the global matrix.

  double rdx2Sq[2];
  rdx2Sq[0] = 4.0/(dx[0]*dx[0]);
  rdx2Sq[1] = 4.0/(dx[1]*dx[1]);

  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[0], (-(0.6666666666666666*epsilon[0]*rdx2Sq[1]*bcVals[6])/bcVals[7])-0.1666666666666667*kSq[3]+0.1924500897298752*kSq[2]+0.3333333333333333*epsilon[0]*rdx2Sq[1]+0.1924500897298752*kSq[1]+0.3333333333333333*epsilon[0]*rdx2Sq[0]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[1], (-(0.3333333333333333*epsilon[0]*rdx2Sq[1]*bcVals[6])/bcVals[7])+0.09622504486493762*kSq[2]+0.1666666666666667*epsilon[0]*rdx2Sq[1]-0.3333333333333333*epsilon[0]*rdx2Sq[0]-0.1111111111111111*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[2], (-0.3333333333333333*epsilon[0]*rdx2Sq[1])+0.09622504486493762*kSq[1]+0.1666666666666667*epsilon[0]*rdx2Sq[0]-0.1111111111111111*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[3], (-0.1666666666666667*epsilon[0]*rdx2Sq[1])-0.1666666666666667*epsilon[0]*rdx2Sq[0]-0.05555555555555555*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[0], (-(0.3333333333333333*epsilon[0]*rdx2Sq[1]*bcVals[6])/bcVals[7])+0.09622504486493762*kSq[2]+0.1666666666666667*epsilon[0]*rdx2Sq[1]-0.3333333333333333*epsilon[0]*rdx2Sq[0]-0.1111111111111111*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[1], (-(0.6666666666666666*epsilon[0]*rdx2Sq[1]*bcVals[6])/bcVals[7])+0.1666666666666667*kSq[3]+0.1924500897298752*kSq[2]+0.3333333333333333*epsilon[0]*rdx2Sq[1]-0.1924500897298752*kSq[1]+0.3333333333333333*epsilon[0]*rdx2Sq[0]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[2], (-0.1666666666666667*epsilon[0]*rdx2Sq[1])-0.1666666666666667*epsilon[0]*rdx2Sq[0]-0.05555555555555555*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[3], (-0.3333333333333333*epsilon[0]*rdx2Sq[1])-0.09622504486493762*kSq[1]+0.1666666666666667*epsilon[0]*rdx2Sq[0]-0.1111111111111111*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[0], (-0.3333333333333333*epsilon[0]*rdx2Sq[1])+0.09622504486493762*kSq[1]+0.1666666666666667*epsilon[0]*rdx2Sq[0]-0.1111111111111111*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[1], (-0.1666666666666667*epsilon[0]*rdx2Sq[1])-0.1666666666666667*epsilon[0]*rdx2Sq[0]-0.05555555555555555*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[2], 0.1666666666666667*kSq[3]-0.1924500897298752*kSq[2]+0.3333333333333333*epsilon[0]*rdx2Sq[1]+0.1924500897298752*kSq[1]+0.3333333333333333*epsilon[0]*rdx2Sq[0]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[3], (-0.09622504486493762*kSq[2])+0.1666666666666667*epsilon[0]*rdx2Sq[1]-0.3333333333333333*epsilon[0]*rdx2Sq[0]-0.1111111111111111*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[0], (-0.1666666666666667*epsilon[0]*rdx2Sq[1])-0.1666666666666667*epsilon[0]*rdx2Sq[0]-0.05555555555555555*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[1], (-0.3333333333333333*epsilon[0]*rdx2Sq[1])-0.09622504486493762*kSq[1]+0.1666666666666667*epsilon[0]*rdx2Sq[0]-0.1111111111111111*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[2], (-0.09622504486493762*kSq[2])+0.1666666666666667*epsilon[0]*rdx2Sq[1]-0.3333333333333333*epsilon[0]*rdx2Sq[0]-0.1111111111111111*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[3], (-0.1666666666666667*kSq[3])-0.1924500897298752*kSq[2]+0.3333333333333333*epsilon[0]*rdx2Sq[1]-0.1924500897298752*kSq[1]+0.3333333333333333*epsilon[0]*rdx2Sq[0]-0.2222222222222222*kSq[0]);

}
void fem_poisson_lhs_stencil_consteps_2x_ser_p2_inx_periodicx_loy_robiny(const double *epsilon, const double *kSq, const double *dx, const double *bcVals, const long *globalIdxs, gkyl_mat_triples *tri) 
{ 
  // epsilon: permittivity.
  // kSq: wave number squared (factor multiplying phi).
  // dx: cell length in each direction.
  // bcVals[3]: values to impose as BCs, i.e. bcVals[0]*phi+bcVals[1]*d(phi)/dx=bcVals[2].
  // globalIdxs: global linear index of each basis function/node in current cell.
  // tri: triples object (i,j,val), i.e. contribute val to i,j element of the global matrix.

  double rdx2Sq[2];
  rdx2Sq[0] = 4.0/(dx[0]*dx[0]);
  rdx2Sq[1] = 4.0/(dx[1]*dx[1]);

  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[0], 0.04549218533640458*kSq[7]-(0.2666666666666667*epsilon[0]*rdx2Sq[1]*bcVals[6])/bcVals[7]+0.04549218533640458*kSq[6]-0.0127775312999988*kSq[5]-0.0127775312999988*kSq[4]-0.04666666666666667*kSq[3]+0.03849001794597505*kSq[2]+0.5777777777777777*epsilon[0]*rdx2Sq[1]+0.03849001794597505*kSq[1]+0.5777777777777777*epsilon[0]*rdx2Sq[0]-0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[1], 0.03442651863295482*kSq[7]-(0.1333333333333333*epsilon[0]*rdx2Sq[1]*bcVals[6])/bcVals[7]+0.0295084445425327*kSq[6]-0.05962847939999439*kSq[5]-0.063887656499994*kSq[4]-0.05333333333333333*kSq[3]+0.06666666666666667*epsilon[0]*rdx2Sq[1]+0.03849001794597505*kSq[1]-0.8888888888888888*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[2], (0.06666666666666667*epsilon[0]*rdx2Sq[1]*bcVals[6])/bcVals[7]-0.006147592613027645*kSq[6]+0.03336355394999686*kSq[5]+0.02697478829999747*kSq[4]-0.01924500897298752*kSq[2]+0.1888888888888889*epsilon[0]*rdx2Sq[1]+0.3111111111111111*epsilon[0]*rdx2Sq[0]-0.02222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[3], 0.0295084445425327*kSq[7]+0.03442651863295482*kSq[6]-0.063887656499994*kSq[5]-0.05962847939999439*kSq[4]-0.05333333333333333*kSq[3]+0.03849001794597505*kSq[2]-0.8888888888888888*epsilon[0]*rdx2Sq[1]+0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[4], (-0.01721325931647741*kSq[7])-0.05678902799999467*kSq[5]-0.03975231959999626*kSq[4]-0.01333333333333333*kSq[3]-0.4444444444444444*epsilon[0]*rdx2Sq[1]+0.03849001794597505*kSq[1]-0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[5], (-0.006147592613027645*kSq[7])+0.02697478829999747*kSq[5]+0.03336355394999686*kSq[4]+0.3111111111111111*epsilon[0]*rdx2Sq[1]-0.01924500897298752*kSq[1]+0.1888888888888889*epsilon[0]*rdx2Sq[0]-0.02222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[6], (-0.01721325931647741*kSq[6])-0.03975231959999626*kSq[5]-0.05678902799999467*kSq[4]-0.01333333333333333*kSq[3]+0.03849001794597505*kSq[2]-0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.4444444444444444*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[7], 0.0234254740499978*kSq[5]+0.0234254740499978*kSq[4]+0.01333333333333333*kSq[3]+0.2555555555555555*epsilon[0]*rdx2Sq[1]+0.2555555555555555*epsilon[0]*rdx2Sq[0]-0.03333333333333333*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[0], 0.03442651863295482*kSq[7]-(0.1333333333333333*epsilon[0]*rdx2Sq[1]*bcVals[6])/bcVals[7]+0.0295084445425327*kSq[6]-0.05962847939999439*kSq[5]-0.063887656499994*kSq[4]-0.05333333333333333*kSq[3]+0.06666666666666667*epsilon[0]*rdx2Sq[1]+0.03849001794597505*kSq[1]-0.8888888888888888*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[1], (-(1.066666666666667*epsilon[0]*rdx2Sq[1]*bcVals[6])/bcVals[7])-0.1967229636168847*kSq[6]-0.07950463919999252*kSq[5]+0.2271561119999787*kSq[4]+0.3079201435678004*kSq[2]+0.5333333333333333*epsilon[0]*rdx2Sq[1]+1.777777777777778*epsilon[0]*rdx2Sq[0]-0.3555555555555556*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[2], (-0.03442651863295482*kSq[7])-(0.1333333333333333*epsilon[0]*rdx2Sq[1]*bcVals[6])/bcVals[7]+0.0295084445425327*kSq[6]-0.05962847939999439*kSq[5]-0.063887656499994*kSq[4]+0.05333333333333333*kSq[3]+0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.03849001794597505*kSq[1]-0.8888888888888888*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[3], (-0.03442651863295482*kSq[7])-0.03442651863295482*kSq[6]+0.09938079899999068*kSq[5]+0.09938079899999068*kSq[4]-0.02666666666666666*kSq[3]+0.0769800358919501*kSq[2]+0.0769800358919501*kSq[1]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[4], 0.03442651863295482*kSq[7]-0.03442651863295482*kSq[6]+0.09938079899999068*kSq[5]+0.09938079899999068*kSq[4]+0.02666666666666666*kSq[3]+0.0769800358919501*kSq[2]-0.0769800358919501*kSq[1]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[5], 0.01721325931647741*kSq[6]-0.03975231959999626*kSq[5]-0.05678902799999467*kSq[4]+0.01333333333333333*kSq[3]-0.03849001794597505*kSq[2]-0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.4444444444444444*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[6], 0.07950463919999252*kSq[5]+0.1135780559999893*kSq[4]-0.5333333333333333*epsilon[0]*rdx2Sq[1]+0.8888888888888888*epsilon[0]*rdx2Sq[0]-0.1777777777777778*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[7], 0.01721325931647741*kSq[6]-0.03975231959999626*kSq[5]-0.05678902799999467*kSq[4]-0.01333333333333333*kSq[3]-0.03849001794597505*kSq[2]-0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.4444444444444444*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[0], (0.06666666666666667*epsilon[0]*rdx2Sq[1]*bcVals[6])/bcVals[7]-0.006147592613027645*kSq[6]+0.03336355394999686*kSq[5]+0.02697478829999747*kSq[4]-0.01924500897298752*kSq[2]+0.1888888888888889*epsilon[0]*rdx2Sq[1]+0.3111111111111111*epsilon[0]*rdx2Sq[0]-0.02222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[1], (-0.03442651863295482*kSq[7])-(0.1333333333333333*epsilon[0]*rdx2Sq[1]*bcVals[6])/bcVals[7]+0.0295084445425327*kSq[6]-0.05962847939999439*kSq[5]-0.063887656499994*kSq[4]+0.05333333333333333*kSq[3]+0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.03849001794597505*kSq[1]-0.8888888888888888*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[2], (-0.04549218533640458*kSq[7])-(0.2666666666666667*epsilon[0]*rdx2Sq[1]*bcVals[6])/bcVals[7]+0.04549218533640458*kSq[6]-0.0127775312999988*kSq[5]-0.0127775312999988*kSq[4]+0.04666666666666667*kSq[3]+0.03849001794597505*kSq[2]+0.5777777777777777*epsilon[0]*rdx2Sq[1]-0.03849001794597505*kSq[1]+0.5777777777777777*epsilon[0]*rdx2Sq[0]-0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[3], 0.01721325931647741*kSq[7]-0.05678902799999467*kSq[5]-0.03975231959999626*kSq[4]+0.01333333333333333*kSq[3]-0.4444444444444444*epsilon[0]*rdx2Sq[1]-0.03849001794597505*kSq[1]-0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[4], (-0.0295084445425327*kSq[7])+0.03442651863295482*kSq[6]-0.063887656499994*kSq[5]-0.05962847939999439*kSq[4]+0.05333333333333333*kSq[3]+0.03849001794597505*kSq[2]-0.8888888888888888*epsilon[0]*rdx2Sq[1]+0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[5], 0.0234254740499978*kSq[5]+0.0234254740499978*kSq[4]-0.01333333333333333*kSq[3]+0.2555555555555555*epsilon[0]*rdx2Sq[1]+0.2555555555555555*epsilon[0]*rdx2Sq[0]-0.03333333333333333*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[6], (-0.01721325931647741*kSq[6])-0.03975231959999626*kSq[5]-0.05678902799999467*kSq[4]+0.01333333333333333*kSq[3]+0.03849001794597505*kSq[2]-0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.4444444444444444*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[7], 0.006147592613027645*kSq[7]+0.02697478829999747*kSq[5]+0.03336355394999686*kSq[4]+0.3111111111111111*epsilon[0]*rdx2Sq[1]+0.01924500897298752*kSq[1]+0.1888888888888889*epsilon[0]*rdx2Sq[0]-0.02222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[0], 0.0295084445425327*kSq[7]+0.03442651863295482*kSq[6]-0.063887656499994*kSq[5]-0.05962847939999439*kSq[4]-0.05333333333333333*kSq[3]+0.03849001794597505*kSq[2]-0.8888888888888888*epsilon[0]*rdx2Sq[1]+0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[1], (-0.03442651863295482*kSq[7])-0.03442651863295482*kSq[6]+0.09938079899999068*kSq[5]+0.09938079899999068*kSq[4]-0.02666666666666666*kSq[3]+0.0769800358919501*kSq[2]+0.0769800358919501*kSq[1]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[2], 0.01721325931647741*kSq[7]-0.05678902799999467*kSq[5]-0.03975231959999626*kSq[4]+0.01333333333333333*kSq[3]-0.4444444444444444*epsilon[0]*rdx2Sq[1]-0.03849001794597505*kSq[1]-0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[3], (-0.1967229636168847*kSq[7])+0.2271561119999787*kSq[5]-0.07950463919999252*kSq[4]+1.777777777777778*epsilon[0]*rdx2Sq[1]+0.3079201435678004*kSq[1]+0.5333333333333333*epsilon[0]*rdx2Sq[0]-0.3555555555555556*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[4], 0.1135780559999893*kSq[5]+0.07950463919999252*kSq[4]+0.8888888888888888*epsilon[0]*rdx2Sq[1]-0.5333333333333333*epsilon[0]*rdx2Sq[0]-0.1777777777777778*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[5], 0.0295084445425327*kSq[7]-0.03442651863295482*kSq[6]-0.063887656499994*kSq[5]-0.05962847939999439*kSq[4]+0.05333333333333333*kSq[3]-0.03849001794597505*kSq[2]-0.8888888888888888*epsilon[0]*rdx2Sq[1]+0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[6], (-0.03442651863295482*kSq[7])+0.03442651863295482*kSq[6]+0.09938079899999068*kSq[5]+0.09938079899999068*kSq[4]+0.02666666666666666*kSq[3]-0.0769800358919501*kSq[2]+0.0769800358919501*kSq[1]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[7], 0.01721325931647741*kSq[7]-0.05678902799999467*kSq[5]-0.03975231959999626*kSq[4]-0.01333333333333333*kSq[3]-0.4444444444444444*epsilon[0]*rdx2Sq[1]-0.03849001794597505*kSq[1]-0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[4], globalIdxs[0], (-0.01721325931647741*kSq[7])-0.05678902799999467*kSq[5]-0.03975231959999626*kSq[4]-0.01333333333333333*kSq[3]-0.4444444444444444*epsilon[0]*rdx2Sq[1]+0.03849001794597505*kSq[1]-0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[4], globalIdxs[1], 0.03442651863295482*kSq[7]-0.03442651863295482*kSq[6]+0.09938079899999068*kSq[5]+0.09938079899999068*kSq[4]+0.02666666666666666*kSq[3]+0.0769800358919501*kSq[2]-0.0769800358919501*kSq[1]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[4], globalIdxs[2], (-0.0295084445425327*kSq[7])+0.03442651863295482*kSq[6]-0.063887656499994*kSq[5]-0.05962847939999439*kSq[4]+0.05333333333333333*kSq[3]+0.03849001794597505*kSq[2]-0.8888888888888888*epsilon[0]*rdx2Sq[1]+0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[4], globalIdxs[3], 0.1135780559999893*kSq[5]+0.07950463919999252*kSq[4]+0.8888888888888888*epsilon[0]*rdx2Sq[1]-0.5333333333333333*epsilon[0]*rdx2Sq[0]-0.1777777777777778*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[4], globalIdxs[4], 0.1967229636168847*kSq[7]+0.2271561119999787*kSq[5]-0.07950463919999252*kSq[4]+1.777777777777778*epsilon[0]*rdx2Sq[1]-0.3079201435678004*kSq[1]+0.5333333333333333*epsilon[0]*rdx2Sq[0]-0.3555555555555556*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[4], globalIdxs[5], (-0.01721325931647741*kSq[7])-0.05678902799999467*kSq[5]-0.03975231959999626*kSq[4]+0.01333333333333333*kSq[3]-0.4444444444444444*epsilon[0]*rdx2Sq[1]+0.03849001794597505*kSq[1]-0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[4], globalIdxs[6], 0.03442651863295482*kSq[7]+0.03442651863295482*kSq[6]+0.09938079899999068*kSq[5]+0.09938079899999068*kSq[4]-0.02666666666666666*kSq[3]-0.0769800358919501*kSq[2]-0.0769800358919501*kSq[1]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[4], globalIdxs[7], (-0.0295084445425327*kSq[7])-0.03442651863295482*kSq[6]-0.063887656499994*kSq[5]-0.05962847939999439*kSq[4]-0.05333333333333333*kSq[3]-0.03849001794597505*kSq[2]-0.8888888888888888*epsilon[0]*rdx2Sq[1]+0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[5], globalIdxs[0], (-0.006147592613027645*kSq[7])+0.02697478829999747*kSq[5]+0.03336355394999686*kSq[4]+0.3111111111111111*epsilon[0]*rdx2Sq[1]-0.01924500897298752*kSq[1]+0.1888888888888889*epsilon[0]*rdx2Sq[0]-0.02222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[5], globalIdxs[1], 0.01721325931647741*kSq[6]-0.03975231959999626*kSq[5]-0.05678902799999467*kSq[4]+0.01333333333333333*kSq[3]-0.03849001794597505*kSq[2]-0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.4444444444444444*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[5], globalIdxs[2], 0.0234254740499978*kSq[5]+0.0234254740499978*kSq[4]-0.01333333333333333*kSq[3]+0.2555555555555555*epsilon[0]*rdx2Sq[1]+0.2555555555555555*epsilon[0]*rdx2Sq[0]-0.03333333333333333*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[5], globalIdxs[3], 0.0295084445425327*kSq[7]-0.03442651863295482*kSq[6]-0.063887656499994*kSq[5]-0.05962847939999439*kSq[4]+0.05333333333333333*kSq[3]-0.03849001794597505*kSq[2]-0.8888888888888888*epsilon[0]*rdx2Sq[1]+0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[5], globalIdxs[4], (-0.01721325931647741*kSq[7])-0.05678902799999467*kSq[5]-0.03975231959999626*kSq[4]+0.01333333333333333*kSq[3]-0.4444444444444444*epsilon[0]*rdx2Sq[1]+0.03849001794597505*kSq[1]-0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[5], globalIdxs[5], 0.04549218533640458*kSq[7]-0.04549218533640458*kSq[6]-0.0127775312999988*kSq[5]-0.0127775312999988*kSq[4]+0.04666666666666667*kSq[3]-0.03849001794597505*kSq[2]+0.5777777777777777*epsilon[0]*rdx2Sq[1]+0.03849001794597505*kSq[1]+0.5777777777777777*epsilon[0]*rdx2Sq[0]-0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[5], globalIdxs[6], 0.03442651863295482*kSq[7]-0.0295084445425327*kSq[6]-0.05962847939999439*kSq[5]-0.063887656499994*kSq[4]+0.05333333333333333*kSq[3]+0.06666666666666667*epsilon[0]*rdx2Sq[1]+0.03849001794597505*kSq[1]-0.8888888888888888*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[5], globalIdxs[7], 0.006147592613027645*kSq[6]+0.03336355394999686*kSq[5]+0.02697478829999747*kSq[4]+0.01924500897298752*kSq[2]+0.1888888888888889*epsilon[0]*rdx2Sq[1]+0.3111111111111111*epsilon[0]*rdx2Sq[0]-0.02222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[6], globalIdxs[0], (-0.01721325931647741*kSq[6])-0.03975231959999626*kSq[5]-0.05678902799999467*kSq[4]-0.01333333333333333*kSq[3]+0.03849001794597505*kSq[2]-0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.4444444444444444*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[6], globalIdxs[1], 0.07950463919999252*kSq[5]+0.1135780559999893*kSq[4]-0.5333333333333333*epsilon[0]*rdx2Sq[1]+0.8888888888888888*epsilon[0]*rdx2Sq[0]-0.1777777777777778*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[6], globalIdxs[2], (-0.01721325931647741*kSq[6])-0.03975231959999626*kSq[5]-0.05678902799999467*kSq[4]+0.01333333333333333*kSq[3]+0.03849001794597505*kSq[2]-0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.4444444444444444*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[6], globalIdxs[3], (-0.03442651863295482*kSq[7])+0.03442651863295482*kSq[6]+0.09938079899999068*kSq[5]+0.09938079899999068*kSq[4]+0.02666666666666666*kSq[3]-0.0769800358919501*kSq[2]+0.0769800358919501*kSq[1]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[6], globalIdxs[4], 0.03442651863295482*kSq[7]+0.03442651863295482*kSq[6]+0.09938079899999068*kSq[5]+0.09938079899999068*kSq[4]-0.02666666666666666*kSq[3]-0.0769800358919501*kSq[2]-0.0769800358919501*kSq[1]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[6], globalIdxs[5], 0.03442651863295482*kSq[7]-0.0295084445425327*kSq[6]-0.05962847939999439*kSq[5]-0.063887656499994*kSq[4]+0.05333333333333333*kSq[3]+0.06666666666666667*epsilon[0]*rdx2Sq[1]+0.03849001794597505*kSq[1]-0.8888888888888888*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[6], globalIdxs[6], 0.1967229636168847*kSq[6]-0.07950463919999252*kSq[5]+0.2271561119999787*kSq[4]-0.3079201435678004*kSq[2]+0.5333333333333333*epsilon[0]*rdx2Sq[1]+1.777777777777778*epsilon[0]*rdx2Sq[0]-0.3555555555555556*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[6], globalIdxs[7], (-0.03442651863295482*kSq[7])-0.0295084445425327*kSq[6]-0.05962847939999439*kSq[5]-0.063887656499994*kSq[4]-0.05333333333333333*kSq[3]+0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.03849001794597505*kSq[1]-0.8888888888888888*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[7], globalIdxs[0], 0.0234254740499978*kSq[5]+0.0234254740499978*kSq[4]+0.01333333333333333*kSq[3]+0.2555555555555555*epsilon[0]*rdx2Sq[1]+0.2555555555555555*epsilon[0]*rdx2Sq[0]-0.03333333333333333*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[7], globalIdxs[1], 0.01721325931647741*kSq[6]-0.03975231959999626*kSq[5]-0.05678902799999467*kSq[4]-0.01333333333333333*kSq[3]-0.03849001794597505*kSq[2]-0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.4444444444444444*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[7], globalIdxs[2], 0.006147592613027645*kSq[7]+0.02697478829999747*kSq[5]+0.03336355394999686*kSq[4]+0.3111111111111111*epsilon[0]*rdx2Sq[1]+0.01924500897298752*kSq[1]+0.1888888888888889*epsilon[0]*rdx2Sq[0]-0.02222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[7], globalIdxs[3], 0.01721325931647741*kSq[7]-0.05678902799999467*kSq[5]-0.03975231959999626*kSq[4]-0.01333333333333333*kSq[3]-0.4444444444444444*epsilon[0]*rdx2Sq[1]-0.03849001794597505*kSq[1]-0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[7], globalIdxs[4], (-0.0295084445425327*kSq[7])-0.03442651863295482*kSq[6]-0.063887656499994*kSq[5]-0.05962847939999439*kSq[4]-0.05333333333333333*kSq[3]-0.03849001794597505*kSq[2]-0.8888888888888888*epsilon[0]*rdx2Sq[1]+0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[7], globalIdxs[5], 0.006147592613027645*kSq[6]+0.03336355394999686*kSq[5]+0.02697478829999747*kSq[4]+0.01924500897298752*kSq[2]+0.1888888888888889*epsilon[0]*rdx2Sq[1]+0.3111111111111111*epsilon[0]*rdx2Sq[0]-0.02222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[7], globalIdxs[6], (-0.03442651863295482*kSq[7])-0.0295084445425327*kSq[6]-0.05962847939999439*kSq[5]-0.063887656499994*kSq[4]-0.05333333333333333*kSq[3]+0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.03849001794597505*kSq[1]-0.8888888888888888*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[7], globalIdxs[7], (-0.04549218533640458*kSq[7])-0.04549218533640458*kSq[6]-0.0127775312999988*kSq[5]-0.0127775312999988*kSq[4]-0.04666666666666667*kSq[3]-0.03849001794597505*kSq[2]+0.5777777777777777*epsilon[0]*rdx2Sq[1]-0.03849001794597505*kSq[1]+0.5777777777777777*epsilon[0]*rdx2Sq[0]-0.06666666666666667*kSq[0]);

}
void fem_poisson_lhs_stencil_consteps_2x_ser_p1_inx_periodicx_upy_periodicy(const double *epsilon, const double *kSq, const double *dx, const double *bcVals, const long *globalIdxs, gkyl_mat_triples *tri) 
{ 
  // epsilon: permittivity.
  // kSq: wave number squared (factor multiplying phi).
  // dx: cell length in each direction.
  // bcVals[3]: values to impose as BCs, i.e. bcVals[0]*phi+bcVals[1]*d(phi)/dx=bcVals[2].
  // globalIdxs: global linear index of each basis function/node in current cell.
  // tri: triples object (i,j,val), i.e. contribute val to i,j element of the global matrix.

  double rdx2Sq[2];
  rdx2Sq[0] = 4.0/(dx[0]*dx[0]);
  rdx2Sq[1] = 4.0/(dx[1]*dx[1]);

  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[0], (-0.1666666666666667*kSq[3])+0.1924500897298752*kSq[2]+0.3333333333333333*epsilon[0]*rdx2Sq[1]+0.1924500897298752*kSq[1]+0.3333333333333333*epsilon[0]*rdx2Sq[0]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[1], 0.09622504486493762*kSq[2]+0.1666666666666667*epsilon[0]*rdx2Sq[1]-0.3333333333333333*epsilon[0]*rdx2Sq[0]-0.1111111111111111*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[2], (-0.3333333333333333*epsilon[0]*rdx2Sq[1])+0.09622504486493762*kSq[1]+0.1666666666666667*epsilon[0]*rdx2Sq[0]-0.1111111111111111*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[3], (-0.1666666666666667*epsilon[0]*rdx2Sq[1])-0.1666666666666667*epsilon[0]*rdx2Sq[0]-0.05555555555555555*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[0], 0.09622504486493762*kSq[2]+0.1666666666666667*epsilon[0]*rdx2Sq[1]-0.3333333333333333*epsilon[0]*rdx2Sq[0]-0.1111111111111111*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[1], 0.1666666666666667*kSq[3]+0.1924500897298752*kSq[2]+0.3333333333333333*epsilon[0]*rdx2Sq[1]-0.1924500897298752*kSq[1]+0.3333333333333333*epsilon[0]*rdx2Sq[0]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[2], (-0.1666666666666667*epsilon[0]*rdx2Sq[1])-0.1666666666666667*epsilon[0]*rdx2Sq[0]-0.05555555555555555*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[3], (-0.3333333333333333*epsilon[0]*rdx2Sq[1])-0.09622504486493762*kSq[1]+0.1666666666666667*epsilon[0]*rdx2Sq[0]-0.1111111111111111*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[0], (-0.3333333333333333*epsilon[0]*rdx2Sq[1])+0.09622504486493762*kSq[1]+0.1666666666666667*epsilon[0]*rdx2Sq[0]-0.1111111111111111*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[1], (-0.1666666666666667*epsilon[0]*rdx2Sq[1])-0.1666666666666667*epsilon[0]*rdx2Sq[0]-0.05555555555555555*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[2], 0.1666666666666667*kSq[3]-0.1924500897298752*kSq[2]+0.3333333333333333*epsilon[0]*rdx2Sq[1]+0.1924500897298752*kSq[1]+0.3333333333333333*epsilon[0]*rdx2Sq[0]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[3], (-0.09622504486493762*kSq[2])+0.1666666666666667*epsilon[0]*rdx2Sq[1]-0.3333333333333333*epsilon[0]*rdx2Sq[0]-0.1111111111111111*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[0], (-0.1666666666666667*epsilon[0]*rdx2Sq[1])-0.1666666666666667*epsilon[0]*rdx2Sq[0]-0.05555555555555555*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[1], (-0.3333333333333333*epsilon[0]*rdx2Sq[1])-0.09622504486493762*kSq[1]+0.1666666666666667*epsilon[0]*rdx2Sq[0]-0.1111111111111111*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[2], (-0.09622504486493762*kSq[2])+0.1666666666666667*epsilon[0]*rdx2Sq[1]-0.3333333333333333*epsilon[0]*rdx2Sq[0]-0.1111111111111111*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[3], (-0.1666666666666667*kSq[3])-0.1924500897298752*kSq[2]+0.3333333333333333*epsilon[0]*rdx2Sq[1]-0.1924500897298752*kSq[1]+0.3333333333333333*epsilon[0]*rdx2Sq[0]-0.2222222222222222*kSq[0]);

}
void fem_poisson_lhs_stencil_consteps_2x_ser_p2_inx_periodicx_upy_periodicy(const double *epsilon, const double *kSq, const double *dx, const double *bcVals, const long *globalIdxs, gkyl_mat_triples *tri) 
{ 
  // epsilon: permittivity.
  // kSq: wave number squared (factor multiplying phi).
  // dx: cell length in each direction.
  // bcVals[3]: values to impose as BCs, i.e. bcVals[0]*phi+bcVals[1]*d(phi)/dx=bcVals[2].
  // globalIdxs: global linear index of each basis function/node in current cell.
  // tri: triples object (i,j,val), i.e. contribute val to i,j element of the global matrix.

  double rdx2Sq[2];
  rdx2Sq[0] = 4.0/(dx[0]*dx[0]);
  rdx2Sq[1] = 4.0/(dx[1]*dx[1]);

  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[0], 0.04549218533640458*kSq[7]+0.04549218533640458*kSq[6]-0.0127775312999988*kSq[5]-0.0127775312999988*kSq[4]-0.04666666666666667*kSq[3]+0.03849001794597505*kSq[2]+0.5777777777777777*epsilon[0]*rdx2Sq[1]+0.03849001794597505*kSq[1]+0.5777777777777777*epsilon[0]*rdx2Sq[0]-0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[1], 0.03442651863295482*kSq[7]+0.0295084445425327*kSq[6]-0.05962847939999439*kSq[5]-0.063887656499994*kSq[4]-0.05333333333333333*kSq[3]+0.06666666666666667*epsilon[0]*rdx2Sq[1]+0.03849001794597505*kSq[1]-0.8888888888888888*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[2], (-0.006147592613027645*kSq[6])+0.03336355394999686*kSq[5]+0.02697478829999747*kSq[4]-0.01924500897298752*kSq[2]+0.1888888888888889*epsilon[0]*rdx2Sq[1]+0.3111111111111111*epsilon[0]*rdx2Sq[0]-0.02222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[3], 0.0295084445425327*kSq[7]+0.03442651863295482*kSq[6]-0.063887656499994*kSq[5]-0.05962847939999439*kSq[4]-0.05333333333333333*kSq[3]+0.03849001794597505*kSq[2]-0.8888888888888888*epsilon[0]*rdx2Sq[1]+0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[4], (-0.01721325931647741*kSq[7])-0.05678902799999467*kSq[5]-0.03975231959999626*kSq[4]-0.01333333333333333*kSq[3]-0.4444444444444444*epsilon[0]*rdx2Sq[1]+0.03849001794597505*kSq[1]-0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[5], (-0.006147592613027645*kSq[7])+0.02697478829999747*kSq[5]+0.03336355394999686*kSq[4]+0.3111111111111111*epsilon[0]*rdx2Sq[1]-0.01924500897298752*kSq[1]+0.1888888888888889*epsilon[0]*rdx2Sq[0]-0.02222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[6], (-0.01721325931647741*kSq[6])-0.03975231959999626*kSq[5]-0.05678902799999467*kSq[4]-0.01333333333333333*kSq[3]+0.03849001794597505*kSq[2]-0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.4444444444444444*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[7], 0.0234254740499978*kSq[5]+0.0234254740499978*kSq[4]+0.01333333333333333*kSq[3]+0.2555555555555555*epsilon[0]*rdx2Sq[1]+0.2555555555555555*epsilon[0]*rdx2Sq[0]-0.03333333333333333*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[0], 0.03442651863295482*kSq[7]+0.0295084445425327*kSq[6]-0.05962847939999439*kSq[5]-0.063887656499994*kSq[4]-0.05333333333333333*kSq[3]+0.06666666666666667*epsilon[0]*rdx2Sq[1]+0.03849001794597505*kSq[1]-0.8888888888888888*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[1], (-0.1967229636168847*kSq[6])-0.07950463919999252*kSq[5]+0.2271561119999787*kSq[4]+0.3079201435678004*kSq[2]+0.5333333333333333*epsilon[0]*rdx2Sq[1]+1.777777777777778*epsilon[0]*rdx2Sq[0]-0.3555555555555556*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[2], (-0.03442651863295482*kSq[7])+0.0295084445425327*kSq[6]-0.05962847939999439*kSq[5]-0.063887656499994*kSq[4]+0.05333333333333333*kSq[3]+0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.03849001794597505*kSq[1]-0.8888888888888888*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[3], (-0.03442651863295482*kSq[7])-0.03442651863295482*kSq[6]+0.09938079899999068*kSq[5]+0.09938079899999068*kSq[4]-0.02666666666666666*kSq[3]+0.0769800358919501*kSq[2]+0.0769800358919501*kSq[1]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[4], 0.03442651863295482*kSq[7]-0.03442651863295482*kSq[6]+0.09938079899999068*kSq[5]+0.09938079899999068*kSq[4]+0.02666666666666666*kSq[3]+0.0769800358919501*kSq[2]-0.0769800358919501*kSq[1]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[5], 0.01721325931647741*kSq[6]-0.03975231959999626*kSq[5]-0.05678902799999467*kSq[4]+0.01333333333333333*kSq[3]-0.03849001794597505*kSq[2]-0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.4444444444444444*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[6], 0.07950463919999252*kSq[5]+0.1135780559999893*kSq[4]-0.5333333333333333*epsilon[0]*rdx2Sq[1]+0.8888888888888888*epsilon[0]*rdx2Sq[0]-0.1777777777777778*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[7], 0.01721325931647741*kSq[6]-0.03975231959999626*kSq[5]-0.05678902799999467*kSq[4]-0.01333333333333333*kSq[3]-0.03849001794597505*kSq[2]-0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.4444444444444444*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[0], (-0.006147592613027645*kSq[6])+0.03336355394999686*kSq[5]+0.02697478829999747*kSq[4]-0.01924500897298752*kSq[2]+0.1888888888888889*epsilon[0]*rdx2Sq[1]+0.3111111111111111*epsilon[0]*rdx2Sq[0]-0.02222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[1], (-0.03442651863295482*kSq[7])+0.0295084445425327*kSq[6]-0.05962847939999439*kSq[5]-0.063887656499994*kSq[4]+0.05333333333333333*kSq[3]+0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.03849001794597505*kSq[1]-0.8888888888888888*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[2], (-0.04549218533640458*kSq[7])+0.04549218533640458*kSq[6]-0.0127775312999988*kSq[5]-0.0127775312999988*kSq[4]+0.04666666666666667*kSq[3]+0.03849001794597505*kSq[2]+0.5777777777777777*epsilon[0]*rdx2Sq[1]-0.03849001794597505*kSq[1]+0.5777777777777777*epsilon[0]*rdx2Sq[0]-0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[3], 0.01721325931647741*kSq[7]-0.05678902799999467*kSq[5]-0.03975231959999626*kSq[4]+0.01333333333333333*kSq[3]-0.4444444444444444*epsilon[0]*rdx2Sq[1]-0.03849001794597505*kSq[1]-0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[4], (-0.0295084445425327*kSq[7])+0.03442651863295482*kSq[6]-0.063887656499994*kSq[5]-0.05962847939999439*kSq[4]+0.05333333333333333*kSq[3]+0.03849001794597505*kSq[2]-0.8888888888888888*epsilon[0]*rdx2Sq[1]+0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[5], 0.0234254740499978*kSq[5]+0.0234254740499978*kSq[4]-0.01333333333333333*kSq[3]+0.2555555555555555*epsilon[0]*rdx2Sq[1]+0.2555555555555555*epsilon[0]*rdx2Sq[0]-0.03333333333333333*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[6], (-0.01721325931647741*kSq[6])-0.03975231959999626*kSq[5]-0.05678902799999467*kSq[4]+0.01333333333333333*kSq[3]+0.03849001794597505*kSq[2]-0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.4444444444444444*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[7], 0.006147592613027645*kSq[7]+0.02697478829999747*kSq[5]+0.03336355394999686*kSq[4]+0.3111111111111111*epsilon[0]*rdx2Sq[1]+0.01924500897298752*kSq[1]+0.1888888888888889*epsilon[0]*rdx2Sq[0]-0.02222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[0], 0.0295084445425327*kSq[7]+0.03442651863295482*kSq[6]-0.063887656499994*kSq[5]-0.05962847939999439*kSq[4]-0.05333333333333333*kSq[3]+0.03849001794597505*kSq[2]-0.8888888888888888*epsilon[0]*rdx2Sq[1]+0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[1], (-0.03442651863295482*kSq[7])-0.03442651863295482*kSq[6]+0.09938079899999068*kSq[5]+0.09938079899999068*kSq[4]-0.02666666666666666*kSq[3]+0.0769800358919501*kSq[2]+0.0769800358919501*kSq[1]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[2], 0.01721325931647741*kSq[7]-0.05678902799999467*kSq[5]-0.03975231959999626*kSq[4]+0.01333333333333333*kSq[3]-0.4444444444444444*epsilon[0]*rdx2Sq[1]-0.03849001794597505*kSq[1]-0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[3], (-0.1967229636168847*kSq[7])+0.2271561119999787*kSq[5]-0.07950463919999252*kSq[4]+1.777777777777778*epsilon[0]*rdx2Sq[1]+0.3079201435678004*kSq[1]+0.5333333333333333*epsilon[0]*rdx2Sq[0]-0.3555555555555556*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[4], 0.1135780559999893*kSq[5]+0.07950463919999252*kSq[4]+0.8888888888888888*epsilon[0]*rdx2Sq[1]-0.5333333333333333*epsilon[0]*rdx2Sq[0]-0.1777777777777778*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[5], 0.0295084445425327*kSq[7]-0.03442651863295482*kSq[6]-0.063887656499994*kSq[5]-0.05962847939999439*kSq[4]+0.05333333333333333*kSq[3]-0.03849001794597505*kSq[2]-0.8888888888888888*epsilon[0]*rdx2Sq[1]+0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[6], (-0.03442651863295482*kSq[7])+0.03442651863295482*kSq[6]+0.09938079899999068*kSq[5]+0.09938079899999068*kSq[4]+0.02666666666666666*kSq[3]-0.0769800358919501*kSq[2]+0.0769800358919501*kSq[1]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[7], 0.01721325931647741*kSq[7]-0.05678902799999467*kSq[5]-0.03975231959999626*kSq[4]-0.01333333333333333*kSq[3]-0.4444444444444444*epsilon[0]*rdx2Sq[1]-0.03849001794597505*kSq[1]-0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[4], globalIdxs[0], (-0.01721325931647741*kSq[7])-0.05678902799999467*kSq[5]-0.03975231959999626*kSq[4]-0.01333333333333333*kSq[3]-0.4444444444444444*epsilon[0]*rdx2Sq[1]+0.03849001794597505*kSq[1]-0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[4], globalIdxs[1], 0.03442651863295482*kSq[7]-0.03442651863295482*kSq[6]+0.09938079899999068*kSq[5]+0.09938079899999068*kSq[4]+0.02666666666666666*kSq[3]+0.0769800358919501*kSq[2]-0.0769800358919501*kSq[1]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[4], globalIdxs[2], (-0.0295084445425327*kSq[7])+0.03442651863295482*kSq[6]-0.063887656499994*kSq[5]-0.05962847939999439*kSq[4]+0.05333333333333333*kSq[3]+0.03849001794597505*kSq[2]-0.8888888888888888*epsilon[0]*rdx2Sq[1]+0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[4], globalIdxs[3], 0.1135780559999893*kSq[5]+0.07950463919999252*kSq[4]+0.8888888888888888*epsilon[0]*rdx2Sq[1]-0.5333333333333333*epsilon[0]*rdx2Sq[0]-0.1777777777777778*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[4], globalIdxs[4], 0.1967229636168847*kSq[7]+0.2271561119999787*kSq[5]-0.07950463919999252*kSq[4]+1.777777777777778*epsilon[0]*rdx2Sq[1]-0.3079201435678004*kSq[1]+0.5333333333333333*epsilon[0]*rdx2Sq[0]-0.3555555555555556*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[4], globalIdxs[5], (-0.01721325931647741*kSq[7])-0.05678902799999467*kSq[5]-0.03975231959999626*kSq[4]+0.01333333333333333*kSq[3]-0.4444444444444444*epsilon[0]*rdx2Sq[1]+0.03849001794597505*kSq[1]-0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[4], globalIdxs[6], 0.03442651863295482*kSq[7]+0.03442651863295482*kSq[6]+0.09938079899999068*kSq[5]+0.09938079899999068*kSq[4]-0.02666666666666666*kSq[3]-0.0769800358919501*kSq[2]-0.0769800358919501*kSq[1]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[4], globalIdxs[7], (-0.0295084445425327*kSq[7])-0.03442651863295482*kSq[6]-0.063887656499994*kSq[5]-0.05962847939999439*kSq[4]-0.05333333333333333*kSq[3]-0.03849001794597505*kSq[2]-0.8888888888888888*epsilon[0]*rdx2Sq[1]+0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[5], globalIdxs[0], (-0.006147592613027645*kSq[7])+0.02697478829999747*kSq[5]+0.03336355394999686*kSq[4]+0.3111111111111111*epsilon[0]*rdx2Sq[1]-0.01924500897298752*kSq[1]+0.1888888888888889*epsilon[0]*rdx2Sq[0]-0.02222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[5], globalIdxs[1], 0.01721325931647741*kSq[6]-0.03975231959999626*kSq[5]-0.05678902799999467*kSq[4]+0.01333333333333333*kSq[3]-0.03849001794597505*kSq[2]-0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.4444444444444444*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[5], globalIdxs[2], 0.0234254740499978*kSq[5]+0.0234254740499978*kSq[4]-0.01333333333333333*kSq[3]+0.2555555555555555*epsilon[0]*rdx2Sq[1]+0.2555555555555555*epsilon[0]*rdx2Sq[0]-0.03333333333333333*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[5], globalIdxs[3], 0.0295084445425327*kSq[7]-0.03442651863295482*kSq[6]-0.063887656499994*kSq[5]-0.05962847939999439*kSq[4]+0.05333333333333333*kSq[3]-0.03849001794597505*kSq[2]-0.8888888888888888*epsilon[0]*rdx2Sq[1]+0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[5], globalIdxs[4], (-0.01721325931647741*kSq[7])-0.05678902799999467*kSq[5]-0.03975231959999626*kSq[4]+0.01333333333333333*kSq[3]-0.4444444444444444*epsilon[0]*rdx2Sq[1]+0.03849001794597505*kSq[1]-0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[5], globalIdxs[5], 0.04549218533640458*kSq[7]-0.04549218533640458*kSq[6]-0.0127775312999988*kSq[5]-0.0127775312999988*kSq[4]+0.04666666666666667*kSq[3]-0.03849001794597505*kSq[2]+0.5777777777777777*epsilon[0]*rdx2Sq[1]+0.03849001794597505*kSq[1]+0.5777777777777777*epsilon[0]*rdx2Sq[0]-0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[5], globalIdxs[6], 0.03442651863295482*kSq[7]-0.0295084445425327*kSq[6]-0.05962847939999439*kSq[5]-0.063887656499994*kSq[4]+0.05333333333333333*kSq[3]+0.06666666666666667*epsilon[0]*rdx2Sq[1]+0.03849001794597505*kSq[1]-0.8888888888888888*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[5], globalIdxs[7], 0.006147592613027645*kSq[6]+0.03336355394999686*kSq[5]+0.02697478829999747*kSq[4]+0.01924500897298752*kSq[2]+0.1888888888888889*epsilon[0]*rdx2Sq[1]+0.3111111111111111*epsilon[0]*rdx2Sq[0]-0.02222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[6], globalIdxs[0], (-0.01721325931647741*kSq[6])-0.03975231959999626*kSq[5]-0.05678902799999467*kSq[4]-0.01333333333333333*kSq[3]+0.03849001794597505*kSq[2]-0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.4444444444444444*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[6], globalIdxs[1], 0.07950463919999252*kSq[5]+0.1135780559999893*kSq[4]-0.5333333333333333*epsilon[0]*rdx2Sq[1]+0.8888888888888888*epsilon[0]*rdx2Sq[0]-0.1777777777777778*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[6], globalIdxs[2], (-0.01721325931647741*kSq[6])-0.03975231959999626*kSq[5]-0.05678902799999467*kSq[4]+0.01333333333333333*kSq[3]+0.03849001794597505*kSq[2]-0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.4444444444444444*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[6], globalIdxs[3], (-0.03442651863295482*kSq[7])+0.03442651863295482*kSq[6]+0.09938079899999068*kSq[5]+0.09938079899999068*kSq[4]+0.02666666666666666*kSq[3]-0.0769800358919501*kSq[2]+0.0769800358919501*kSq[1]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[6], globalIdxs[4], 0.03442651863295482*kSq[7]+0.03442651863295482*kSq[6]+0.09938079899999068*kSq[5]+0.09938079899999068*kSq[4]-0.02666666666666666*kSq[3]-0.0769800358919501*kSq[2]-0.0769800358919501*kSq[1]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[6], globalIdxs[5], 0.03442651863295482*kSq[7]-0.0295084445425327*kSq[6]-0.05962847939999439*kSq[5]-0.063887656499994*kSq[4]+0.05333333333333333*kSq[3]+0.06666666666666667*epsilon[0]*rdx2Sq[1]+0.03849001794597505*kSq[1]-0.8888888888888888*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[6], globalIdxs[6], 0.1967229636168847*kSq[6]-0.07950463919999252*kSq[5]+0.2271561119999787*kSq[4]-0.3079201435678004*kSq[2]+0.5333333333333333*epsilon[0]*rdx2Sq[1]+1.777777777777778*epsilon[0]*rdx2Sq[0]-0.3555555555555556*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[6], globalIdxs[7], (-0.03442651863295482*kSq[7])-0.0295084445425327*kSq[6]-0.05962847939999439*kSq[5]-0.063887656499994*kSq[4]-0.05333333333333333*kSq[3]+0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.03849001794597505*kSq[1]-0.8888888888888888*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[7], globalIdxs[0], 0.0234254740499978*kSq[5]+0.0234254740499978*kSq[4]+0.01333333333333333*kSq[3]+0.2555555555555555*epsilon[0]*rdx2Sq[1]+0.2555555555555555*epsilon[0]*rdx2Sq[0]-0.03333333333333333*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[7], globalIdxs[1], 0.01721325931647741*kSq[6]-0.03975231959999626*kSq[5]-0.05678902799999467*kSq[4]-0.01333333333333333*kSq[3]-0.03849001794597505*kSq[2]-0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.4444444444444444*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[7], globalIdxs[2], 0.006147592613027645*kSq[7]+0.02697478829999747*kSq[5]+0.03336355394999686*kSq[4]+0.3111111111111111*epsilon[0]*rdx2Sq[1]+0.01924500897298752*kSq[1]+0.1888888888888889*epsilon[0]*rdx2Sq[0]-0.02222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[7], globalIdxs[3], 0.01721325931647741*kSq[7]-0.05678902799999467*kSq[5]-0.03975231959999626*kSq[4]-0.01333333333333333*kSq[3]-0.4444444444444444*epsilon[0]*rdx2Sq[1]-0.03849001794597505*kSq[1]-0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[7], globalIdxs[4], (-0.0295084445425327*kSq[7])-0.03442651863295482*kSq[6]-0.063887656499994*kSq[5]-0.05962847939999439*kSq[4]-0.05333333333333333*kSq[3]-0.03849001794597505*kSq[2]-0.8888888888888888*epsilon[0]*rdx2Sq[1]+0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[7], globalIdxs[5], 0.006147592613027645*kSq[6]+0.03336355394999686*kSq[5]+0.02697478829999747*kSq[4]+0.01924500897298752*kSq[2]+0.1888888888888889*epsilon[0]*rdx2Sq[1]+0.3111111111111111*epsilon[0]*rdx2Sq[0]-0.02222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[7], globalIdxs[6], (-0.03442651863295482*kSq[7])-0.0295084445425327*kSq[6]-0.05962847939999439*kSq[5]-0.063887656499994*kSq[4]-0.05333333333333333*kSq[3]+0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.03849001794597505*kSq[1]-0.8888888888888888*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[7], globalIdxs[7], (-0.04549218533640458*kSq[7])-0.04549218533640458*kSq[6]-0.0127775312999988*kSq[5]-0.0127775312999988*kSq[4]-0.04666666666666667*kSq[3]-0.03849001794597505*kSq[2]+0.5777777777777777*epsilon[0]*rdx2Sq[1]-0.03849001794597505*kSq[1]+0.5777777777777777*epsilon[0]*rdx2Sq[0]-0.06666666666666667*kSq[0]);

}
void fem_poisson_lhs_stencil_consteps_2x_ser_p1_inx_periodicx_upy_dirichlety(const double *epsilon, const double *kSq, const double *dx, const double *bcVals, const long *globalIdxs, gkyl_mat_triples *tri) 
{ 
  // epsilon: permittivity.
  // kSq: wave number squared (factor multiplying phi).
  // dx: cell length in each direction.
  // bcVals[3]: values to impose as BCs, i.e. bcVals[0]*phi+bcVals[1]*d(phi)/dx=bcVals[2].
  // globalIdxs: global linear index of each basis function/node in current cell.
  // tri: triples object (i,j,val), i.e. contribute val to i,j element of the global matrix.

  double rdx2Sq[2];
  rdx2Sq[0] = 4.0/(dx[0]*dx[0]);
  rdx2Sq[1] = 4.0/(dx[1]*dx[1]);

  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[0], (-0.1666666666666667*kSq[3])+0.1924500897298752*kSq[2]+0.3333333333333333*epsilon[0]*rdx2Sq[1]+0.1924500897298752*kSq[1]+0.3333333333333333*epsilon[0]*rdx2Sq[0]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[1], 0.09622504486493762*kSq[2]+0.1666666666666667*epsilon[0]*rdx2Sq[1]-0.3333333333333333*epsilon[0]*rdx2Sq[0]-0.1111111111111111*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[2], (-0.3333333333333333*epsilon[0]*rdx2Sq[1])+0.09622504486493762*kSq[1]+0.1666666666666667*epsilon[0]*rdx2Sq[0]-0.1111111111111111*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[3], (-0.1666666666666667*epsilon[0]*rdx2Sq[1])-0.1666666666666667*epsilon[0]*rdx2Sq[0]-0.05555555555555555*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[0], 0.09622504486493762*kSq[2]+0.1666666666666667*epsilon[0]*rdx2Sq[1]-0.3333333333333333*epsilon[0]*rdx2Sq[0]-0.1111111111111111*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[1], 0.1666666666666667*kSq[3]+0.1924500897298752*kSq[2]+0.3333333333333333*epsilon[0]*rdx2Sq[1]-0.1924500897298752*kSq[1]+0.3333333333333333*epsilon[0]*rdx2Sq[0]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[2], (-0.1666666666666667*epsilon[0]*rdx2Sq[1])-0.1666666666666667*epsilon[0]*rdx2Sq[0]-0.05555555555555555*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[3], (-0.3333333333333333*epsilon[0]*rdx2Sq[1])-0.09622504486493762*kSq[1]+0.1666666666666667*epsilon[0]*rdx2Sq[0]-0.1111111111111111*kSq[0]);
  gkyl_mat_triples_insert(tri, globalIdxs[2], globalIdxs[0], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[2], globalIdxs[1], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[2], globalIdxs[2], 1.0);
  gkyl_mat_triples_insert(tri, globalIdxs[2], globalIdxs[3], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[3], globalIdxs[0], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[3], globalIdxs[1], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[3], globalIdxs[2], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[3], globalIdxs[3], 1.0);

}
void fem_poisson_lhs_stencil_consteps_2x_ser_p2_inx_periodicx_upy_dirichlety(const double *epsilon, const double *kSq, const double *dx, const double *bcVals, const long *globalIdxs, gkyl_mat_triples *tri) 
{ 
  // epsilon: permittivity.
  // kSq: wave number squared (factor multiplying phi).
  // dx: cell length in each direction.
  // bcVals[3]: values to impose as BCs, i.e. bcVals[0]*phi+bcVals[1]*d(phi)/dx=bcVals[2].
  // globalIdxs: global linear index of each basis function/node in current cell.
  // tri: triples object (i,j,val), i.e. contribute val to i,j element of the global matrix.

  double rdx2Sq[2];
  rdx2Sq[0] = 4.0/(dx[0]*dx[0]);
  rdx2Sq[1] = 4.0/(dx[1]*dx[1]);

  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[0], 0.04549218533640458*kSq[7]+0.04549218533640458*kSq[6]-0.0127775312999988*kSq[5]-0.0127775312999988*kSq[4]-0.04666666666666667*kSq[3]+0.03849001794597505*kSq[2]+0.5777777777777777*epsilon[0]*rdx2Sq[1]+0.03849001794597505*kSq[1]+0.5777777777777777*epsilon[0]*rdx2Sq[0]-0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[1], 0.03442651863295482*kSq[7]+0.0295084445425327*kSq[6]-0.05962847939999439*kSq[5]-0.063887656499994*kSq[4]-0.05333333333333333*kSq[3]+0.06666666666666667*epsilon[0]*rdx2Sq[1]+0.03849001794597505*kSq[1]-0.8888888888888888*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[2], (-0.006147592613027645*kSq[6])+0.03336355394999686*kSq[5]+0.02697478829999747*kSq[4]-0.01924500897298752*kSq[2]+0.1888888888888889*epsilon[0]*rdx2Sq[1]+0.3111111111111111*epsilon[0]*rdx2Sq[0]-0.02222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[3], 0.0295084445425327*kSq[7]+0.03442651863295482*kSq[6]-0.063887656499994*kSq[5]-0.05962847939999439*kSq[4]-0.05333333333333333*kSq[3]+0.03849001794597505*kSq[2]-0.8888888888888888*epsilon[0]*rdx2Sq[1]+0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[4], (-0.01721325931647741*kSq[7])-0.05678902799999467*kSq[5]-0.03975231959999626*kSq[4]-0.01333333333333333*kSq[3]-0.4444444444444444*epsilon[0]*rdx2Sq[1]+0.03849001794597505*kSq[1]-0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[5], (-0.006147592613027645*kSq[7])+0.02697478829999747*kSq[5]+0.03336355394999686*kSq[4]+0.3111111111111111*epsilon[0]*rdx2Sq[1]-0.01924500897298752*kSq[1]+0.1888888888888889*epsilon[0]*rdx2Sq[0]-0.02222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[6], (-0.01721325931647741*kSq[6])-0.03975231959999626*kSq[5]-0.05678902799999467*kSq[4]-0.01333333333333333*kSq[3]+0.03849001794597505*kSq[2]-0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.4444444444444444*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[7], 0.0234254740499978*kSq[5]+0.0234254740499978*kSq[4]+0.01333333333333333*kSq[3]+0.2555555555555555*epsilon[0]*rdx2Sq[1]+0.2555555555555555*epsilon[0]*rdx2Sq[0]-0.03333333333333333*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[0], 0.03442651863295482*kSq[7]+0.0295084445425327*kSq[6]-0.05962847939999439*kSq[5]-0.063887656499994*kSq[4]-0.05333333333333333*kSq[3]+0.06666666666666667*epsilon[0]*rdx2Sq[1]+0.03849001794597505*kSq[1]-0.8888888888888888*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[1], (-0.1967229636168847*kSq[6])-0.07950463919999252*kSq[5]+0.2271561119999787*kSq[4]+0.3079201435678004*kSq[2]+0.5333333333333333*epsilon[0]*rdx2Sq[1]+1.777777777777778*epsilon[0]*rdx2Sq[0]-0.3555555555555556*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[2], (-0.03442651863295482*kSq[7])+0.0295084445425327*kSq[6]-0.05962847939999439*kSq[5]-0.063887656499994*kSq[4]+0.05333333333333333*kSq[3]+0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.03849001794597505*kSq[1]-0.8888888888888888*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[3], (-0.03442651863295482*kSq[7])-0.03442651863295482*kSq[6]+0.09938079899999068*kSq[5]+0.09938079899999068*kSq[4]-0.02666666666666666*kSq[3]+0.0769800358919501*kSq[2]+0.0769800358919501*kSq[1]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[4], 0.03442651863295482*kSq[7]-0.03442651863295482*kSq[6]+0.09938079899999068*kSq[5]+0.09938079899999068*kSq[4]+0.02666666666666666*kSq[3]+0.0769800358919501*kSq[2]-0.0769800358919501*kSq[1]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[5], 0.01721325931647741*kSq[6]-0.03975231959999626*kSq[5]-0.05678902799999467*kSq[4]+0.01333333333333333*kSq[3]-0.03849001794597505*kSq[2]-0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.4444444444444444*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[6], 0.07950463919999252*kSq[5]+0.1135780559999893*kSq[4]-0.5333333333333333*epsilon[0]*rdx2Sq[1]+0.8888888888888888*epsilon[0]*rdx2Sq[0]-0.1777777777777778*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[7], 0.01721325931647741*kSq[6]-0.03975231959999626*kSq[5]-0.05678902799999467*kSq[4]-0.01333333333333333*kSq[3]-0.03849001794597505*kSq[2]-0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.4444444444444444*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[0], (-0.006147592613027645*kSq[6])+0.03336355394999686*kSq[5]+0.02697478829999747*kSq[4]-0.01924500897298752*kSq[2]+0.1888888888888889*epsilon[0]*rdx2Sq[1]+0.3111111111111111*epsilon[0]*rdx2Sq[0]-0.02222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[1], (-0.03442651863295482*kSq[7])+0.0295084445425327*kSq[6]-0.05962847939999439*kSq[5]-0.063887656499994*kSq[4]+0.05333333333333333*kSq[3]+0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.03849001794597505*kSq[1]-0.8888888888888888*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[2], (-0.04549218533640458*kSq[7])+0.04549218533640458*kSq[6]-0.0127775312999988*kSq[5]-0.0127775312999988*kSq[4]+0.04666666666666667*kSq[3]+0.03849001794597505*kSq[2]+0.5777777777777777*epsilon[0]*rdx2Sq[1]-0.03849001794597505*kSq[1]+0.5777777777777777*epsilon[0]*rdx2Sq[0]-0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[3], 0.01721325931647741*kSq[7]-0.05678902799999467*kSq[5]-0.03975231959999626*kSq[4]+0.01333333333333333*kSq[3]-0.4444444444444444*epsilon[0]*rdx2Sq[1]-0.03849001794597505*kSq[1]-0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[4], (-0.0295084445425327*kSq[7])+0.03442651863295482*kSq[6]-0.063887656499994*kSq[5]-0.05962847939999439*kSq[4]+0.05333333333333333*kSq[3]+0.03849001794597505*kSq[2]-0.8888888888888888*epsilon[0]*rdx2Sq[1]+0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[5], 0.0234254740499978*kSq[5]+0.0234254740499978*kSq[4]-0.01333333333333333*kSq[3]+0.2555555555555555*epsilon[0]*rdx2Sq[1]+0.2555555555555555*epsilon[0]*rdx2Sq[0]-0.03333333333333333*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[6], (-0.01721325931647741*kSq[6])-0.03975231959999626*kSq[5]-0.05678902799999467*kSq[4]+0.01333333333333333*kSq[3]+0.03849001794597505*kSq[2]-0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.4444444444444444*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[7], 0.006147592613027645*kSq[7]+0.02697478829999747*kSq[5]+0.03336355394999686*kSq[4]+0.3111111111111111*epsilon[0]*rdx2Sq[1]+0.01924500897298752*kSq[1]+0.1888888888888889*epsilon[0]*rdx2Sq[0]-0.02222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[0], 0.0295084445425327*kSq[7]+0.03442651863295482*kSq[6]-0.063887656499994*kSq[5]-0.05962847939999439*kSq[4]-0.05333333333333333*kSq[3]+0.03849001794597505*kSq[2]-0.8888888888888888*epsilon[0]*rdx2Sq[1]+0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[1], (-0.03442651863295482*kSq[7])-0.03442651863295482*kSq[6]+0.09938079899999068*kSq[5]+0.09938079899999068*kSq[4]-0.02666666666666666*kSq[3]+0.0769800358919501*kSq[2]+0.0769800358919501*kSq[1]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[2], 0.01721325931647741*kSq[7]-0.05678902799999467*kSq[5]-0.03975231959999626*kSq[4]+0.01333333333333333*kSq[3]-0.4444444444444444*epsilon[0]*rdx2Sq[1]-0.03849001794597505*kSq[1]-0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[3], (-0.1967229636168847*kSq[7])+0.2271561119999787*kSq[5]-0.07950463919999252*kSq[4]+1.777777777777778*epsilon[0]*rdx2Sq[1]+0.3079201435678004*kSq[1]+0.5333333333333333*epsilon[0]*rdx2Sq[0]-0.3555555555555556*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[4], 0.1135780559999893*kSq[5]+0.07950463919999252*kSq[4]+0.8888888888888888*epsilon[0]*rdx2Sq[1]-0.5333333333333333*epsilon[0]*rdx2Sq[0]-0.1777777777777778*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[5], 0.0295084445425327*kSq[7]-0.03442651863295482*kSq[6]-0.063887656499994*kSq[5]-0.05962847939999439*kSq[4]+0.05333333333333333*kSq[3]-0.03849001794597505*kSq[2]-0.8888888888888888*epsilon[0]*rdx2Sq[1]+0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[6], (-0.03442651863295482*kSq[7])+0.03442651863295482*kSq[6]+0.09938079899999068*kSq[5]+0.09938079899999068*kSq[4]+0.02666666666666666*kSq[3]-0.0769800358919501*kSq[2]+0.0769800358919501*kSq[1]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[7], 0.01721325931647741*kSq[7]-0.05678902799999467*kSq[5]-0.03975231959999626*kSq[4]-0.01333333333333333*kSq[3]-0.4444444444444444*epsilon[0]*rdx2Sq[1]-0.03849001794597505*kSq[1]-0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[4], globalIdxs[0], (-0.01721325931647741*kSq[7])-0.05678902799999467*kSq[5]-0.03975231959999626*kSq[4]-0.01333333333333333*kSq[3]-0.4444444444444444*epsilon[0]*rdx2Sq[1]+0.03849001794597505*kSq[1]-0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[4], globalIdxs[1], 0.03442651863295482*kSq[7]-0.03442651863295482*kSq[6]+0.09938079899999068*kSq[5]+0.09938079899999068*kSq[4]+0.02666666666666666*kSq[3]+0.0769800358919501*kSq[2]-0.0769800358919501*kSq[1]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[4], globalIdxs[2], (-0.0295084445425327*kSq[7])+0.03442651863295482*kSq[6]-0.063887656499994*kSq[5]-0.05962847939999439*kSq[4]+0.05333333333333333*kSq[3]+0.03849001794597505*kSq[2]-0.8888888888888888*epsilon[0]*rdx2Sq[1]+0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[4], globalIdxs[3], 0.1135780559999893*kSq[5]+0.07950463919999252*kSq[4]+0.8888888888888888*epsilon[0]*rdx2Sq[1]-0.5333333333333333*epsilon[0]*rdx2Sq[0]-0.1777777777777778*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[4], globalIdxs[4], 0.1967229636168847*kSq[7]+0.2271561119999787*kSq[5]-0.07950463919999252*kSq[4]+1.777777777777778*epsilon[0]*rdx2Sq[1]-0.3079201435678004*kSq[1]+0.5333333333333333*epsilon[0]*rdx2Sq[0]-0.3555555555555556*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[4], globalIdxs[5], (-0.01721325931647741*kSq[7])-0.05678902799999467*kSq[5]-0.03975231959999626*kSq[4]+0.01333333333333333*kSq[3]-0.4444444444444444*epsilon[0]*rdx2Sq[1]+0.03849001794597505*kSq[1]-0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[4], globalIdxs[6], 0.03442651863295482*kSq[7]+0.03442651863295482*kSq[6]+0.09938079899999068*kSq[5]+0.09938079899999068*kSq[4]-0.02666666666666666*kSq[3]-0.0769800358919501*kSq[2]-0.0769800358919501*kSq[1]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[4], globalIdxs[7], (-0.0295084445425327*kSq[7])-0.03442651863295482*kSq[6]-0.063887656499994*kSq[5]-0.05962847939999439*kSq[4]-0.05333333333333333*kSq[3]-0.03849001794597505*kSq[2]-0.8888888888888888*epsilon[0]*rdx2Sq[1]+0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_insert(tri, globalIdxs[5], globalIdxs[0], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[5], globalIdxs[1], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[5], globalIdxs[2], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[5], globalIdxs[3], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[5], globalIdxs[4], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[5], globalIdxs[5], 1.0);
  gkyl_mat_triples_insert(tri, globalIdxs[5], globalIdxs[6], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[5], globalIdxs[7], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[6], globalIdxs[0], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[6], globalIdxs[1], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[6], globalIdxs[2], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[6], globalIdxs[3], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[6], globalIdxs[4], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[6], globalIdxs[5], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[6], globalIdxs[6], 1.0);
  gkyl_mat_triples_insert(tri, globalIdxs[6], globalIdxs[7], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[7], globalIdxs[0], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[7], globalIdxs[1], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[7], globalIdxs[2], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[7], globalIdxs[3], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[7], globalIdxs[4], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[7], globalIdxs[5], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[7], globalIdxs[6], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[7], globalIdxs[7], 1.0);

}
void fem_poisson_lhs_stencil_consteps_2x_ser_p1_inx_periodicx_upy_neumanny(const double *epsilon, const double *kSq, const double *dx, const double *bcVals, const long *globalIdxs, gkyl_mat_triples *tri) 
{ 
  // epsilon: permittivity.
  // kSq: wave number squared (factor multiplying phi).
  // dx: cell length in each direction.
  // bcVals[3]: values to impose as BCs, i.e. bcVals[0]*phi+bcVals[1]*d(phi)/dx=bcVals[2].
  // globalIdxs: global linear index of each basis function/node in current cell.
  // tri: triples object (i,j,val), i.e. contribute val to i,j element of the global matrix.

  double rdx2Sq[2];
  rdx2Sq[0] = 4.0/(dx[0]*dx[0]);
  rdx2Sq[1] = 4.0/(dx[1]*dx[1]);

  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[0], (-0.1666666666666667*kSq[3])+0.1924500897298752*kSq[2]+0.3333333333333333*epsilon[0]*rdx2Sq[1]+0.1924500897298752*kSq[1]+0.3333333333333333*epsilon[0]*rdx2Sq[0]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[1], 0.09622504486493762*kSq[2]+0.1666666666666667*epsilon[0]*rdx2Sq[1]-0.3333333333333333*epsilon[0]*rdx2Sq[0]-0.1111111111111111*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[2], (-0.3333333333333333*epsilon[0]*rdx2Sq[1])+0.09622504486493762*kSq[1]+0.1666666666666667*epsilon[0]*rdx2Sq[0]-0.1111111111111111*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[3], (-0.1666666666666667*epsilon[0]*rdx2Sq[1])-0.1666666666666667*epsilon[0]*rdx2Sq[0]-0.05555555555555555*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[0], 0.09622504486493762*kSq[2]+0.1666666666666667*epsilon[0]*rdx2Sq[1]-0.3333333333333333*epsilon[0]*rdx2Sq[0]-0.1111111111111111*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[1], 0.1666666666666667*kSq[3]+0.1924500897298752*kSq[2]+0.3333333333333333*epsilon[0]*rdx2Sq[1]-0.1924500897298752*kSq[1]+0.3333333333333333*epsilon[0]*rdx2Sq[0]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[2], (-0.1666666666666667*epsilon[0]*rdx2Sq[1])-0.1666666666666667*epsilon[0]*rdx2Sq[0]-0.05555555555555555*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[3], (-0.3333333333333333*epsilon[0]*rdx2Sq[1])-0.09622504486493762*kSq[1]+0.1666666666666667*epsilon[0]*rdx2Sq[0]-0.1111111111111111*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[0], (-0.3333333333333333*epsilon[0]*rdx2Sq[1])+0.09622504486493762*kSq[1]+0.1666666666666667*epsilon[0]*rdx2Sq[0]-0.1111111111111111*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[1], (-0.1666666666666667*epsilon[0]*rdx2Sq[1])-0.1666666666666667*epsilon[0]*rdx2Sq[0]-0.05555555555555555*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[2], 0.1666666666666667*kSq[3]-0.1924500897298752*kSq[2]+0.3333333333333333*epsilon[0]*rdx2Sq[1]+0.1924500897298752*kSq[1]+0.3333333333333333*epsilon[0]*rdx2Sq[0]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[3], (-0.09622504486493762*kSq[2])+0.1666666666666667*epsilon[0]*rdx2Sq[1]-0.3333333333333333*epsilon[0]*rdx2Sq[0]-0.1111111111111111*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[0], (-0.1666666666666667*epsilon[0]*rdx2Sq[1])-0.1666666666666667*epsilon[0]*rdx2Sq[0]-0.05555555555555555*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[1], (-0.3333333333333333*epsilon[0]*rdx2Sq[1])-0.09622504486493762*kSq[1]+0.1666666666666667*epsilon[0]*rdx2Sq[0]-0.1111111111111111*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[2], (-0.09622504486493762*kSq[2])+0.1666666666666667*epsilon[0]*rdx2Sq[1]-0.3333333333333333*epsilon[0]*rdx2Sq[0]-0.1111111111111111*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[3], (-0.1666666666666667*kSq[3])-0.1924500897298752*kSq[2]+0.3333333333333333*epsilon[0]*rdx2Sq[1]-0.1924500897298752*kSq[1]+0.3333333333333333*epsilon[0]*rdx2Sq[0]-0.2222222222222222*kSq[0]);

}
void fem_poisson_lhs_stencil_consteps_2x_ser_p2_inx_periodicx_upy_neumanny(const double *epsilon, const double *kSq, const double *dx, const double *bcVals, const long *globalIdxs, gkyl_mat_triples *tri) 
{ 
  // epsilon: permittivity.
  // kSq: wave number squared (factor multiplying phi).
  // dx: cell length in each direction.
  // bcVals[3]: values to impose as BCs, i.e. bcVals[0]*phi+bcVals[1]*d(phi)/dx=bcVals[2].
  // globalIdxs: global linear index of each basis function/node in current cell.
  // tri: triples object (i,j,val), i.e. contribute val to i,j element of the global matrix.

  double rdx2Sq[2];
  rdx2Sq[0] = 4.0/(dx[0]*dx[0]);
  rdx2Sq[1] = 4.0/(dx[1]*dx[1]);

  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[0], 0.04549218533640458*kSq[7]+0.04549218533640458*kSq[6]-0.0127775312999988*kSq[5]-0.0127775312999988*kSq[4]-0.04666666666666667*kSq[3]+0.03849001794597505*kSq[2]+0.5777777777777777*epsilon[0]*rdx2Sq[1]+0.03849001794597505*kSq[1]+0.5777777777777777*epsilon[0]*rdx2Sq[0]-0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[1], 0.03442651863295482*kSq[7]+0.0295084445425327*kSq[6]-0.05962847939999439*kSq[5]-0.063887656499994*kSq[4]-0.05333333333333333*kSq[3]+0.06666666666666667*epsilon[0]*rdx2Sq[1]+0.03849001794597505*kSq[1]-0.8888888888888888*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[2], (-0.006147592613027645*kSq[6])+0.03336355394999686*kSq[5]+0.02697478829999747*kSq[4]-0.01924500897298752*kSq[2]+0.1888888888888889*epsilon[0]*rdx2Sq[1]+0.3111111111111111*epsilon[0]*rdx2Sq[0]-0.02222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[3], 0.0295084445425327*kSq[7]+0.03442651863295482*kSq[6]-0.063887656499994*kSq[5]-0.05962847939999439*kSq[4]-0.05333333333333333*kSq[3]+0.03849001794597505*kSq[2]-0.8888888888888888*epsilon[0]*rdx2Sq[1]+0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[4], (-0.01721325931647741*kSq[7])-0.05678902799999467*kSq[5]-0.03975231959999626*kSq[4]-0.01333333333333333*kSq[3]-0.4444444444444444*epsilon[0]*rdx2Sq[1]+0.03849001794597505*kSq[1]-0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[5], (-0.006147592613027645*kSq[7])+0.02697478829999747*kSq[5]+0.03336355394999686*kSq[4]+0.3111111111111111*epsilon[0]*rdx2Sq[1]-0.01924500897298752*kSq[1]+0.1888888888888889*epsilon[0]*rdx2Sq[0]-0.02222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[6], (-0.01721325931647741*kSq[6])-0.03975231959999626*kSq[5]-0.05678902799999467*kSq[4]-0.01333333333333333*kSq[3]+0.03849001794597505*kSq[2]-0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.4444444444444444*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[7], 0.0234254740499978*kSq[5]+0.0234254740499978*kSq[4]+0.01333333333333333*kSq[3]+0.2555555555555555*epsilon[0]*rdx2Sq[1]+0.2555555555555555*epsilon[0]*rdx2Sq[0]-0.03333333333333333*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[0], 0.03442651863295482*kSq[7]+0.0295084445425327*kSq[6]-0.05962847939999439*kSq[5]-0.063887656499994*kSq[4]-0.05333333333333333*kSq[3]+0.06666666666666667*epsilon[0]*rdx2Sq[1]+0.03849001794597505*kSq[1]-0.8888888888888888*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[1], (-0.1967229636168847*kSq[6])-0.07950463919999252*kSq[5]+0.2271561119999787*kSq[4]+0.3079201435678004*kSq[2]+0.5333333333333333*epsilon[0]*rdx2Sq[1]+1.777777777777778*epsilon[0]*rdx2Sq[0]-0.3555555555555556*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[2], (-0.03442651863295482*kSq[7])+0.0295084445425327*kSq[6]-0.05962847939999439*kSq[5]-0.063887656499994*kSq[4]+0.05333333333333333*kSq[3]+0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.03849001794597505*kSq[1]-0.8888888888888888*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[3], (-0.03442651863295482*kSq[7])-0.03442651863295482*kSq[6]+0.09938079899999068*kSq[5]+0.09938079899999068*kSq[4]-0.02666666666666666*kSq[3]+0.0769800358919501*kSq[2]+0.0769800358919501*kSq[1]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[4], 0.03442651863295482*kSq[7]-0.03442651863295482*kSq[6]+0.09938079899999068*kSq[5]+0.09938079899999068*kSq[4]+0.02666666666666666*kSq[3]+0.0769800358919501*kSq[2]-0.0769800358919501*kSq[1]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[5], 0.01721325931647741*kSq[6]-0.03975231959999626*kSq[5]-0.05678902799999467*kSq[4]+0.01333333333333333*kSq[3]-0.03849001794597505*kSq[2]-0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.4444444444444444*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[6], 0.07950463919999252*kSq[5]+0.1135780559999893*kSq[4]-0.5333333333333333*epsilon[0]*rdx2Sq[1]+0.8888888888888888*epsilon[0]*rdx2Sq[0]-0.1777777777777778*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[7], 0.01721325931647741*kSq[6]-0.03975231959999626*kSq[5]-0.05678902799999467*kSq[4]-0.01333333333333333*kSq[3]-0.03849001794597505*kSq[2]-0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.4444444444444444*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[0], (-0.006147592613027645*kSq[6])+0.03336355394999686*kSq[5]+0.02697478829999747*kSq[4]-0.01924500897298752*kSq[2]+0.1888888888888889*epsilon[0]*rdx2Sq[1]+0.3111111111111111*epsilon[0]*rdx2Sq[0]-0.02222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[1], (-0.03442651863295482*kSq[7])+0.0295084445425327*kSq[6]-0.05962847939999439*kSq[5]-0.063887656499994*kSq[4]+0.05333333333333333*kSq[3]+0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.03849001794597505*kSq[1]-0.8888888888888888*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[2], (-0.04549218533640458*kSq[7])+0.04549218533640458*kSq[6]-0.0127775312999988*kSq[5]-0.0127775312999988*kSq[4]+0.04666666666666667*kSq[3]+0.03849001794597505*kSq[2]+0.5777777777777777*epsilon[0]*rdx2Sq[1]-0.03849001794597505*kSq[1]+0.5777777777777777*epsilon[0]*rdx2Sq[0]-0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[3], 0.01721325931647741*kSq[7]-0.05678902799999467*kSq[5]-0.03975231959999626*kSq[4]+0.01333333333333333*kSq[3]-0.4444444444444444*epsilon[0]*rdx2Sq[1]-0.03849001794597505*kSq[1]-0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[4], (-0.0295084445425327*kSq[7])+0.03442651863295482*kSq[6]-0.063887656499994*kSq[5]-0.05962847939999439*kSq[4]+0.05333333333333333*kSq[3]+0.03849001794597505*kSq[2]-0.8888888888888888*epsilon[0]*rdx2Sq[1]+0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[5], 0.0234254740499978*kSq[5]+0.0234254740499978*kSq[4]-0.01333333333333333*kSq[3]+0.2555555555555555*epsilon[0]*rdx2Sq[1]+0.2555555555555555*epsilon[0]*rdx2Sq[0]-0.03333333333333333*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[6], (-0.01721325931647741*kSq[6])-0.03975231959999626*kSq[5]-0.05678902799999467*kSq[4]+0.01333333333333333*kSq[3]+0.03849001794597505*kSq[2]-0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.4444444444444444*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[7], 0.006147592613027645*kSq[7]+0.02697478829999747*kSq[5]+0.03336355394999686*kSq[4]+0.3111111111111111*epsilon[0]*rdx2Sq[1]+0.01924500897298752*kSq[1]+0.1888888888888889*epsilon[0]*rdx2Sq[0]-0.02222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[0], 0.0295084445425327*kSq[7]+0.03442651863295482*kSq[6]-0.063887656499994*kSq[5]-0.05962847939999439*kSq[4]-0.05333333333333333*kSq[3]+0.03849001794597505*kSq[2]-0.8888888888888888*epsilon[0]*rdx2Sq[1]+0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[1], (-0.03442651863295482*kSq[7])-0.03442651863295482*kSq[6]+0.09938079899999068*kSq[5]+0.09938079899999068*kSq[4]-0.02666666666666666*kSq[3]+0.0769800358919501*kSq[2]+0.0769800358919501*kSq[1]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[2], 0.01721325931647741*kSq[7]-0.05678902799999467*kSq[5]-0.03975231959999626*kSq[4]+0.01333333333333333*kSq[3]-0.4444444444444444*epsilon[0]*rdx2Sq[1]-0.03849001794597505*kSq[1]-0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[3], (-0.1967229636168847*kSq[7])+0.2271561119999787*kSq[5]-0.07950463919999252*kSq[4]+1.777777777777778*epsilon[0]*rdx2Sq[1]+0.3079201435678004*kSq[1]+0.5333333333333333*epsilon[0]*rdx2Sq[0]-0.3555555555555556*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[4], 0.1135780559999893*kSq[5]+0.07950463919999252*kSq[4]+0.8888888888888888*epsilon[0]*rdx2Sq[1]-0.5333333333333333*epsilon[0]*rdx2Sq[0]-0.1777777777777778*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[5], 0.0295084445425327*kSq[7]-0.03442651863295482*kSq[6]-0.063887656499994*kSq[5]-0.05962847939999439*kSq[4]+0.05333333333333333*kSq[3]-0.03849001794597505*kSq[2]-0.8888888888888888*epsilon[0]*rdx2Sq[1]+0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[6], (-0.03442651863295482*kSq[7])+0.03442651863295482*kSq[6]+0.09938079899999068*kSq[5]+0.09938079899999068*kSq[4]+0.02666666666666666*kSq[3]-0.0769800358919501*kSq[2]+0.0769800358919501*kSq[1]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[7], 0.01721325931647741*kSq[7]-0.05678902799999467*kSq[5]-0.03975231959999626*kSq[4]-0.01333333333333333*kSq[3]-0.4444444444444444*epsilon[0]*rdx2Sq[1]-0.03849001794597505*kSq[1]-0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[4], globalIdxs[0], (-0.01721325931647741*kSq[7])-0.05678902799999467*kSq[5]-0.03975231959999626*kSq[4]-0.01333333333333333*kSq[3]-0.4444444444444444*epsilon[0]*rdx2Sq[1]+0.03849001794597505*kSq[1]-0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[4], globalIdxs[1], 0.03442651863295482*kSq[7]-0.03442651863295482*kSq[6]+0.09938079899999068*kSq[5]+0.09938079899999068*kSq[4]+0.02666666666666666*kSq[3]+0.0769800358919501*kSq[2]-0.0769800358919501*kSq[1]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[4], globalIdxs[2], (-0.0295084445425327*kSq[7])+0.03442651863295482*kSq[6]-0.063887656499994*kSq[5]-0.05962847939999439*kSq[4]+0.05333333333333333*kSq[3]+0.03849001794597505*kSq[2]-0.8888888888888888*epsilon[0]*rdx2Sq[1]+0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[4], globalIdxs[3], 0.1135780559999893*kSq[5]+0.07950463919999252*kSq[4]+0.8888888888888888*epsilon[0]*rdx2Sq[1]-0.5333333333333333*epsilon[0]*rdx2Sq[0]-0.1777777777777778*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[4], globalIdxs[4], 0.1967229636168847*kSq[7]+0.2271561119999787*kSq[5]-0.07950463919999252*kSq[4]+1.777777777777778*epsilon[0]*rdx2Sq[1]-0.3079201435678004*kSq[1]+0.5333333333333333*epsilon[0]*rdx2Sq[0]-0.3555555555555556*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[4], globalIdxs[5], (-0.01721325931647741*kSq[7])-0.05678902799999467*kSq[5]-0.03975231959999626*kSq[4]+0.01333333333333333*kSq[3]-0.4444444444444444*epsilon[0]*rdx2Sq[1]+0.03849001794597505*kSq[1]-0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[4], globalIdxs[6], 0.03442651863295482*kSq[7]+0.03442651863295482*kSq[6]+0.09938079899999068*kSq[5]+0.09938079899999068*kSq[4]-0.02666666666666666*kSq[3]-0.0769800358919501*kSq[2]-0.0769800358919501*kSq[1]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[4], globalIdxs[7], (-0.0295084445425327*kSq[7])-0.03442651863295482*kSq[6]-0.063887656499994*kSq[5]-0.05962847939999439*kSq[4]-0.05333333333333333*kSq[3]-0.03849001794597505*kSq[2]-0.8888888888888888*epsilon[0]*rdx2Sq[1]+0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[5], globalIdxs[0], (-0.006147592613027645*kSq[7])+0.02697478829999747*kSq[5]+0.03336355394999686*kSq[4]+0.3111111111111111*epsilon[0]*rdx2Sq[1]-0.01924500897298752*kSq[1]+0.1888888888888889*epsilon[0]*rdx2Sq[0]-0.02222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[5], globalIdxs[1], 0.01721325931647741*kSq[6]-0.03975231959999626*kSq[5]-0.05678902799999467*kSq[4]+0.01333333333333333*kSq[3]-0.03849001794597505*kSq[2]-0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.4444444444444444*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[5], globalIdxs[2], 0.0234254740499978*kSq[5]+0.0234254740499978*kSq[4]-0.01333333333333333*kSq[3]+0.2555555555555555*epsilon[0]*rdx2Sq[1]+0.2555555555555555*epsilon[0]*rdx2Sq[0]-0.03333333333333333*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[5], globalIdxs[3], 0.0295084445425327*kSq[7]-0.03442651863295482*kSq[6]-0.063887656499994*kSq[5]-0.05962847939999439*kSq[4]+0.05333333333333333*kSq[3]-0.03849001794597505*kSq[2]-0.8888888888888888*epsilon[0]*rdx2Sq[1]+0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[5], globalIdxs[4], (-0.01721325931647741*kSq[7])-0.05678902799999467*kSq[5]-0.03975231959999626*kSq[4]+0.01333333333333333*kSq[3]-0.4444444444444444*epsilon[0]*rdx2Sq[1]+0.03849001794597505*kSq[1]-0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[5], globalIdxs[5], 0.04549218533640458*kSq[7]-0.04549218533640458*kSq[6]-0.0127775312999988*kSq[5]-0.0127775312999988*kSq[4]+0.04666666666666667*kSq[3]-0.03849001794597505*kSq[2]+0.5777777777777777*epsilon[0]*rdx2Sq[1]+0.03849001794597505*kSq[1]+0.5777777777777777*epsilon[0]*rdx2Sq[0]-0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[5], globalIdxs[6], 0.03442651863295482*kSq[7]-0.0295084445425327*kSq[6]-0.05962847939999439*kSq[5]-0.063887656499994*kSq[4]+0.05333333333333333*kSq[3]+0.06666666666666667*epsilon[0]*rdx2Sq[1]+0.03849001794597505*kSq[1]-0.8888888888888888*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[5], globalIdxs[7], 0.006147592613027645*kSq[6]+0.03336355394999686*kSq[5]+0.02697478829999747*kSq[4]+0.01924500897298752*kSq[2]+0.1888888888888889*epsilon[0]*rdx2Sq[1]+0.3111111111111111*epsilon[0]*rdx2Sq[0]-0.02222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[6], globalIdxs[0], (-0.01721325931647741*kSq[6])-0.03975231959999626*kSq[5]-0.05678902799999467*kSq[4]-0.01333333333333333*kSq[3]+0.03849001794597505*kSq[2]-0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.4444444444444444*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[6], globalIdxs[1], 0.07950463919999252*kSq[5]+0.1135780559999893*kSq[4]-0.5333333333333333*epsilon[0]*rdx2Sq[1]+0.8888888888888888*epsilon[0]*rdx2Sq[0]-0.1777777777777778*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[6], globalIdxs[2], (-0.01721325931647741*kSq[6])-0.03975231959999626*kSq[5]-0.05678902799999467*kSq[4]+0.01333333333333333*kSq[3]+0.03849001794597505*kSq[2]-0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.4444444444444444*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[6], globalIdxs[3], (-0.03442651863295482*kSq[7])+0.03442651863295482*kSq[6]+0.09938079899999068*kSq[5]+0.09938079899999068*kSq[4]+0.02666666666666666*kSq[3]-0.0769800358919501*kSq[2]+0.0769800358919501*kSq[1]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[6], globalIdxs[4], 0.03442651863295482*kSq[7]+0.03442651863295482*kSq[6]+0.09938079899999068*kSq[5]+0.09938079899999068*kSq[4]-0.02666666666666666*kSq[3]-0.0769800358919501*kSq[2]-0.0769800358919501*kSq[1]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[6], globalIdxs[5], 0.03442651863295482*kSq[7]-0.0295084445425327*kSq[6]-0.05962847939999439*kSq[5]-0.063887656499994*kSq[4]+0.05333333333333333*kSq[3]+0.06666666666666667*epsilon[0]*rdx2Sq[1]+0.03849001794597505*kSq[1]-0.8888888888888888*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[6], globalIdxs[6], 0.1967229636168847*kSq[6]-0.07950463919999252*kSq[5]+0.2271561119999787*kSq[4]-0.3079201435678004*kSq[2]+0.5333333333333333*epsilon[0]*rdx2Sq[1]+1.777777777777778*epsilon[0]*rdx2Sq[0]-0.3555555555555556*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[6], globalIdxs[7], (-0.03442651863295482*kSq[7])-0.0295084445425327*kSq[6]-0.05962847939999439*kSq[5]-0.063887656499994*kSq[4]-0.05333333333333333*kSq[3]+0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.03849001794597505*kSq[1]-0.8888888888888888*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[7], globalIdxs[0], 0.0234254740499978*kSq[5]+0.0234254740499978*kSq[4]+0.01333333333333333*kSq[3]+0.2555555555555555*epsilon[0]*rdx2Sq[1]+0.2555555555555555*epsilon[0]*rdx2Sq[0]-0.03333333333333333*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[7], globalIdxs[1], 0.01721325931647741*kSq[6]-0.03975231959999626*kSq[5]-0.05678902799999467*kSq[4]-0.01333333333333333*kSq[3]-0.03849001794597505*kSq[2]-0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.4444444444444444*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[7], globalIdxs[2], 0.006147592613027645*kSq[7]+0.02697478829999747*kSq[5]+0.03336355394999686*kSq[4]+0.3111111111111111*epsilon[0]*rdx2Sq[1]+0.01924500897298752*kSq[1]+0.1888888888888889*epsilon[0]*rdx2Sq[0]-0.02222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[7], globalIdxs[3], 0.01721325931647741*kSq[7]-0.05678902799999467*kSq[5]-0.03975231959999626*kSq[4]-0.01333333333333333*kSq[3]-0.4444444444444444*epsilon[0]*rdx2Sq[1]-0.03849001794597505*kSq[1]-0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[7], globalIdxs[4], (-0.0295084445425327*kSq[7])-0.03442651863295482*kSq[6]-0.063887656499994*kSq[5]-0.05962847939999439*kSq[4]-0.05333333333333333*kSq[3]-0.03849001794597505*kSq[2]-0.8888888888888888*epsilon[0]*rdx2Sq[1]+0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[7], globalIdxs[5], 0.006147592613027645*kSq[6]+0.03336355394999686*kSq[5]+0.02697478829999747*kSq[4]+0.01924500897298752*kSq[2]+0.1888888888888889*epsilon[0]*rdx2Sq[1]+0.3111111111111111*epsilon[0]*rdx2Sq[0]-0.02222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[7], globalIdxs[6], (-0.03442651863295482*kSq[7])-0.0295084445425327*kSq[6]-0.05962847939999439*kSq[5]-0.063887656499994*kSq[4]-0.05333333333333333*kSq[3]+0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.03849001794597505*kSq[1]-0.8888888888888888*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[7], globalIdxs[7], (-0.04549218533640458*kSq[7])-0.04549218533640458*kSq[6]-0.0127775312999988*kSq[5]-0.0127775312999988*kSq[4]-0.04666666666666667*kSq[3]-0.03849001794597505*kSq[2]+0.5777777777777777*epsilon[0]*rdx2Sq[1]-0.03849001794597505*kSq[1]+0.5777777777777777*epsilon[0]*rdx2Sq[0]-0.06666666666666667*kSq[0]);

}
void fem_poisson_lhs_stencil_consteps_2x_ser_p1_inx_periodicx_upy_robiny(const double *epsilon, const double *kSq, const double *dx, const double *bcVals, const long *globalIdxs, gkyl_mat_triples *tri) 
{ 
  // epsilon: permittivity.
  // kSq: wave number squared (factor multiplying phi).
  // dx: cell length in each direction.
  // bcVals[3]: values to impose as BCs, i.e. bcVals[0]*phi+bcVals[1]*d(phi)/dx=bcVals[2].
  // globalIdxs: global linear index of each basis function/node in current cell.
  // tri: triples object (i,j,val), i.e. contribute val to i,j element of the global matrix.

  double rdx2Sq[2];
  rdx2Sq[0] = 4.0/(dx[0]*dx[0]);
  rdx2Sq[1] = 4.0/(dx[1]*dx[1]);

  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[0], (-0.1666666666666667*kSq[3])+0.1924500897298752*kSq[2]+0.3333333333333333*epsilon[0]*rdx2Sq[1]+0.1924500897298752*kSq[1]+0.3333333333333333*epsilon[0]*rdx2Sq[0]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[1], 0.09622504486493762*kSq[2]+0.1666666666666667*epsilon[0]*rdx2Sq[1]-0.3333333333333333*epsilon[0]*rdx2Sq[0]-0.1111111111111111*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[2], (-0.3333333333333333*epsilon[0]*rdx2Sq[1])+0.09622504486493762*kSq[1]+0.1666666666666667*epsilon[0]*rdx2Sq[0]-0.1111111111111111*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[3], (-0.1666666666666667*epsilon[0]*rdx2Sq[1])-0.1666666666666667*epsilon[0]*rdx2Sq[0]-0.05555555555555555*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[0], 0.09622504486493762*kSq[2]+0.1666666666666667*epsilon[0]*rdx2Sq[1]-0.3333333333333333*epsilon[0]*rdx2Sq[0]-0.1111111111111111*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[1], 0.1666666666666667*kSq[3]+0.1924500897298752*kSq[2]+0.3333333333333333*epsilon[0]*rdx2Sq[1]-0.1924500897298752*kSq[1]+0.3333333333333333*epsilon[0]*rdx2Sq[0]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[2], (-0.1666666666666667*epsilon[0]*rdx2Sq[1])-0.1666666666666667*epsilon[0]*rdx2Sq[0]-0.05555555555555555*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[3], (-0.3333333333333333*epsilon[0]*rdx2Sq[1])-0.09622504486493762*kSq[1]+0.1666666666666667*epsilon[0]*rdx2Sq[0]-0.1111111111111111*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[0], (-0.3333333333333333*epsilon[0]*rdx2Sq[1])+0.09622504486493762*kSq[1]+0.1666666666666667*epsilon[0]*rdx2Sq[0]-0.1111111111111111*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[1], (-0.1666666666666667*epsilon[0]*rdx2Sq[1])-0.1666666666666667*epsilon[0]*rdx2Sq[0]-0.05555555555555555*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[2], (0.6666666666666666*epsilon[0]*rdx2Sq[1]*bcVals[9])/bcVals[10]+0.1666666666666667*kSq[3]-0.1924500897298752*kSq[2]+0.3333333333333333*epsilon[0]*rdx2Sq[1]+0.1924500897298752*kSq[1]+0.3333333333333333*epsilon[0]*rdx2Sq[0]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[3], (0.3333333333333333*epsilon[0]*rdx2Sq[1]*bcVals[9])/bcVals[10]-0.09622504486493762*kSq[2]+0.1666666666666667*epsilon[0]*rdx2Sq[1]-0.3333333333333333*epsilon[0]*rdx2Sq[0]-0.1111111111111111*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[0], (-0.1666666666666667*epsilon[0]*rdx2Sq[1])-0.1666666666666667*epsilon[0]*rdx2Sq[0]-0.05555555555555555*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[1], (-0.3333333333333333*epsilon[0]*rdx2Sq[1])-0.09622504486493762*kSq[1]+0.1666666666666667*epsilon[0]*rdx2Sq[0]-0.1111111111111111*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[2], (0.3333333333333333*epsilon[0]*rdx2Sq[1]*bcVals[9])/bcVals[10]-0.09622504486493762*kSq[2]+0.1666666666666667*epsilon[0]*rdx2Sq[1]-0.3333333333333333*epsilon[0]*rdx2Sq[0]-0.1111111111111111*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[3], (0.6666666666666666*epsilon[0]*rdx2Sq[1]*bcVals[9])/bcVals[10]-0.1666666666666667*kSq[3]-0.1924500897298752*kSq[2]+0.3333333333333333*epsilon[0]*rdx2Sq[1]-0.1924500897298752*kSq[1]+0.3333333333333333*epsilon[0]*rdx2Sq[0]-0.2222222222222222*kSq[0]);

}
void fem_poisson_lhs_stencil_consteps_2x_ser_p2_inx_periodicx_upy_robiny(const double *epsilon, const double *kSq, const double *dx, const double *bcVals, const long *globalIdxs, gkyl_mat_triples *tri) 
{ 
  // epsilon: permittivity.
  // kSq: wave number squared (factor multiplying phi).
  // dx: cell length in each direction.
  // bcVals[3]: values to impose as BCs, i.e. bcVals[0]*phi+bcVals[1]*d(phi)/dx=bcVals[2].
  // globalIdxs: global linear index of each basis function/node in current cell.
  // tri: triples object (i,j,val), i.e. contribute val to i,j element of the global matrix.

  double rdx2Sq[2];
  rdx2Sq[0] = 4.0/(dx[0]*dx[0]);
  rdx2Sq[1] = 4.0/(dx[1]*dx[1]);

  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[0], 0.04549218533640458*kSq[7]+0.04549218533640458*kSq[6]-0.0127775312999988*kSq[5]-0.0127775312999988*kSq[4]-0.04666666666666667*kSq[3]+0.03849001794597505*kSq[2]+0.5777777777777777*epsilon[0]*rdx2Sq[1]+0.03849001794597505*kSq[1]+0.5777777777777777*epsilon[0]*rdx2Sq[0]-0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[1], 0.03442651863295482*kSq[7]+0.0295084445425327*kSq[6]-0.05962847939999439*kSq[5]-0.063887656499994*kSq[4]-0.05333333333333333*kSq[3]+0.06666666666666667*epsilon[0]*rdx2Sq[1]+0.03849001794597505*kSq[1]-0.8888888888888888*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[2], (-0.006147592613027645*kSq[6])+0.03336355394999686*kSq[5]+0.02697478829999747*kSq[4]-0.01924500897298752*kSq[2]+0.1888888888888889*epsilon[0]*rdx2Sq[1]+0.3111111111111111*epsilon[0]*rdx2Sq[0]-0.02222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[3], 0.0295084445425327*kSq[7]+0.03442651863295482*kSq[6]-0.063887656499994*kSq[5]-0.05962847939999439*kSq[4]-0.05333333333333333*kSq[3]+0.03849001794597505*kSq[2]-0.8888888888888888*epsilon[0]*rdx2Sq[1]+0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[4], (-0.01721325931647741*kSq[7])-0.05678902799999467*kSq[5]-0.03975231959999626*kSq[4]-0.01333333333333333*kSq[3]-0.4444444444444444*epsilon[0]*rdx2Sq[1]+0.03849001794597505*kSq[1]-0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[5], (-0.006147592613027645*kSq[7])+0.02697478829999747*kSq[5]+0.03336355394999686*kSq[4]+0.3111111111111111*epsilon[0]*rdx2Sq[1]-0.01924500897298752*kSq[1]+0.1888888888888889*epsilon[0]*rdx2Sq[0]-0.02222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[6], (-0.01721325931647741*kSq[6])-0.03975231959999626*kSq[5]-0.05678902799999467*kSq[4]-0.01333333333333333*kSq[3]+0.03849001794597505*kSq[2]-0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.4444444444444444*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[7], 0.0234254740499978*kSq[5]+0.0234254740499978*kSq[4]+0.01333333333333333*kSq[3]+0.2555555555555555*epsilon[0]*rdx2Sq[1]+0.2555555555555555*epsilon[0]*rdx2Sq[0]-0.03333333333333333*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[0], 0.03442651863295482*kSq[7]+0.0295084445425327*kSq[6]-0.05962847939999439*kSq[5]-0.063887656499994*kSq[4]-0.05333333333333333*kSq[3]+0.06666666666666667*epsilon[0]*rdx2Sq[1]+0.03849001794597505*kSq[1]-0.8888888888888888*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[1], (-0.1967229636168847*kSq[6])-0.07950463919999252*kSq[5]+0.2271561119999787*kSq[4]+0.3079201435678004*kSq[2]+0.5333333333333333*epsilon[0]*rdx2Sq[1]+1.777777777777778*epsilon[0]*rdx2Sq[0]-0.3555555555555556*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[2], (-0.03442651863295482*kSq[7])+0.0295084445425327*kSq[6]-0.05962847939999439*kSq[5]-0.063887656499994*kSq[4]+0.05333333333333333*kSq[3]+0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.03849001794597505*kSq[1]-0.8888888888888888*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[3], (-0.03442651863295482*kSq[7])-0.03442651863295482*kSq[6]+0.09938079899999068*kSq[5]+0.09938079899999068*kSq[4]-0.02666666666666666*kSq[3]+0.0769800358919501*kSq[2]+0.0769800358919501*kSq[1]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[4], 0.03442651863295482*kSq[7]-0.03442651863295482*kSq[6]+0.09938079899999068*kSq[5]+0.09938079899999068*kSq[4]+0.02666666666666666*kSq[3]+0.0769800358919501*kSq[2]-0.0769800358919501*kSq[1]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[5], 0.01721325931647741*kSq[6]-0.03975231959999626*kSq[5]-0.05678902799999467*kSq[4]+0.01333333333333333*kSq[3]-0.03849001794597505*kSq[2]-0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.4444444444444444*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[6], 0.07950463919999252*kSq[5]+0.1135780559999893*kSq[4]-0.5333333333333333*epsilon[0]*rdx2Sq[1]+0.8888888888888888*epsilon[0]*rdx2Sq[0]-0.1777777777777778*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[7], 0.01721325931647741*kSq[6]-0.03975231959999626*kSq[5]-0.05678902799999467*kSq[4]-0.01333333333333333*kSq[3]-0.03849001794597505*kSq[2]-0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.4444444444444444*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[0], (-0.006147592613027645*kSq[6])+0.03336355394999686*kSq[5]+0.02697478829999747*kSq[4]-0.01924500897298752*kSq[2]+0.1888888888888889*epsilon[0]*rdx2Sq[1]+0.3111111111111111*epsilon[0]*rdx2Sq[0]-0.02222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[1], (-0.03442651863295482*kSq[7])+0.0295084445425327*kSq[6]-0.05962847939999439*kSq[5]-0.063887656499994*kSq[4]+0.05333333333333333*kSq[3]+0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.03849001794597505*kSq[1]-0.8888888888888888*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[2], (-0.04549218533640458*kSq[7])+0.04549218533640458*kSq[6]-0.0127775312999988*kSq[5]-0.0127775312999988*kSq[4]+0.04666666666666667*kSq[3]+0.03849001794597505*kSq[2]+0.5777777777777777*epsilon[0]*rdx2Sq[1]-0.03849001794597505*kSq[1]+0.5777777777777777*epsilon[0]*rdx2Sq[0]-0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[3], 0.01721325931647741*kSq[7]-0.05678902799999467*kSq[5]-0.03975231959999626*kSq[4]+0.01333333333333333*kSq[3]-0.4444444444444444*epsilon[0]*rdx2Sq[1]-0.03849001794597505*kSq[1]-0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[4], (-0.0295084445425327*kSq[7])+0.03442651863295482*kSq[6]-0.063887656499994*kSq[5]-0.05962847939999439*kSq[4]+0.05333333333333333*kSq[3]+0.03849001794597505*kSq[2]-0.8888888888888888*epsilon[0]*rdx2Sq[1]+0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[5], 0.0234254740499978*kSq[5]+0.0234254740499978*kSq[4]-0.01333333333333333*kSq[3]+0.2555555555555555*epsilon[0]*rdx2Sq[1]+0.2555555555555555*epsilon[0]*rdx2Sq[0]-0.03333333333333333*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[6], (-0.01721325931647741*kSq[6])-0.03975231959999626*kSq[5]-0.05678902799999467*kSq[4]+0.01333333333333333*kSq[3]+0.03849001794597505*kSq[2]-0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.4444444444444444*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[7], 0.006147592613027645*kSq[7]+0.02697478829999747*kSq[5]+0.03336355394999686*kSq[4]+0.3111111111111111*epsilon[0]*rdx2Sq[1]+0.01924500897298752*kSq[1]+0.1888888888888889*epsilon[0]*rdx2Sq[0]-0.02222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[0], 0.0295084445425327*kSq[7]+0.03442651863295482*kSq[6]-0.063887656499994*kSq[5]-0.05962847939999439*kSq[4]-0.05333333333333333*kSq[3]+0.03849001794597505*kSq[2]-0.8888888888888888*epsilon[0]*rdx2Sq[1]+0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[1], (-0.03442651863295482*kSq[7])-0.03442651863295482*kSq[6]+0.09938079899999068*kSq[5]+0.09938079899999068*kSq[4]-0.02666666666666666*kSq[3]+0.0769800358919501*kSq[2]+0.0769800358919501*kSq[1]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[2], 0.01721325931647741*kSq[7]-0.05678902799999467*kSq[5]-0.03975231959999626*kSq[4]+0.01333333333333333*kSq[3]-0.4444444444444444*epsilon[0]*rdx2Sq[1]-0.03849001794597505*kSq[1]-0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[3], (-0.1967229636168847*kSq[7])+0.2271561119999787*kSq[5]-0.07950463919999252*kSq[4]+1.777777777777778*epsilon[0]*rdx2Sq[1]+0.3079201435678004*kSq[1]+0.5333333333333333*epsilon[0]*rdx2Sq[0]-0.3555555555555556*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[4], 0.1135780559999893*kSq[5]+0.07950463919999252*kSq[4]+0.8888888888888888*epsilon[0]*rdx2Sq[1]-0.5333333333333333*epsilon[0]*rdx2Sq[0]-0.1777777777777778*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[5], 0.0295084445425327*kSq[7]-0.03442651863295482*kSq[6]-0.063887656499994*kSq[5]-0.05962847939999439*kSq[4]+0.05333333333333333*kSq[3]-0.03849001794597505*kSq[2]-0.8888888888888888*epsilon[0]*rdx2Sq[1]+0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[6], (-0.03442651863295482*kSq[7])+0.03442651863295482*kSq[6]+0.09938079899999068*kSq[5]+0.09938079899999068*kSq[4]+0.02666666666666666*kSq[3]-0.0769800358919501*kSq[2]+0.0769800358919501*kSq[1]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[7], 0.01721325931647741*kSq[7]-0.05678902799999467*kSq[5]-0.03975231959999626*kSq[4]-0.01333333333333333*kSq[3]-0.4444444444444444*epsilon[0]*rdx2Sq[1]-0.03849001794597505*kSq[1]-0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[4], globalIdxs[0], (-0.01721325931647741*kSq[7])-0.05678902799999467*kSq[5]-0.03975231959999626*kSq[4]-0.01333333333333333*kSq[3]-0.4444444444444444*epsilon[0]*rdx2Sq[1]+0.03849001794597505*kSq[1]-0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[4], globalIdxs[1], 0.03442651863295482*kSq[7]-0.03442651863295482*kSq[6]+0.09938079899999068*kSq[5]+0.09938079899999068*kSq[4]+0.02666666666666666*kSq[3]+0.0769800358919501*kSq[2]-0.0769800358919501*kSq[1]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[4], globalIdxs[2], (-0.0295084445425327*kSq[7])+0.03442651863295482*kSq[6]-0.063887656499994*kSq[5]-0.05962847939999439*kSq[4]+0.05333333333333333*kSq[3]+0.03849001794597505*kSq[2]-0.8888888888888888*epsilon[0]*rdx2Sq[1]+0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[4], globalIdxs[3], 0.1135780559999893*kSq[5]+0.07950463919999252*kSq[4]+0.8888888888888888*epsilon[0]*rdx2Sq[1]-0.5333333333333333*epsilon[0]*rdx2Sq[0]-0.1777777777777778*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[4], globalIdxs[4], 0.1967229636168847*kSq[7]+0.2271561119999787*kSq[5]-0.07950463919999252*kSq[4]+1.777777777777778*epsilon[0]*rdx2Sq[1]-0.3079201435678004*kSq[1]+0.5333333333333333*epsilon[0]*rdx2Sq[0]-0.3555555555555556*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[4], globalIdxs[5], (-0.01721325931647741*kSq[7])-0.05678902799999467*kSq[5]-0.03975231959999626*kSq[4]+0.01333333333333333*kSq[3]-0.4444444444444444*epsilon[0]*rdx2Sq[1]+0.03849001794597505*kSq[1]-0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[4], globalIdxs[6], 0.03442651863295482*kSq[7]+0.03442651863295482*kSq[6]+0.09938079899999068*kSq[5]+0.09938079899999068*kSq[4]-0.02666666666666666*kSq[3]-0.0769800358919501*kSq[2]-0.0769800358919501*kSq[1]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[4], globalIdxs[7], (-0.0295084445425327*kSq[7])-0.03442651863295482*kSq[6]-0.063887656499994*kSq[5]-0.05962847939999439*kSq[4]-0.05333333333333333*kSq[3]-0.03849001794597505*kSq[2]-0.8888888888888888*epsilon[0]*rdx2Sq[1]+0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[5], globalIdxs[0], (-0.006147592613027645*kSq[7])+0.02697478829999747*kSq[5]+0.03336355394999686*kSq[4]+0.3111111111111111*epsilon[0]*rdx2Sq[1]-0.01924500897298752*kSq[1]+0.1888888888888889*epsilon[0]*rdx2Sq[0]-0.02222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[5], globalIdxs[1], 0.01721325931647741*kSq[6]-0.03975231959999626*kSq[5]-0.05678902799999467*kSq[4]+0.01333333333333333*kSq[3]-0.03849001794597505*kSq[2]-0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.4444444444444444*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[5], globalIdxs[2], 0.0234254740499978*kSq[5]+0.0234254740499978*kSq[4]-0.01333333333333333*kSq[3]+0.2555555555555555*epsilon[0]*rdx2Sq[1]+0.2555555555555555*epsilon[0]*rdx2Sq[0]-0.03333333333333333*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[5], globalIdxs[3], 0.0295084445425327*kSq[7]-0.03442651863295482*kSq[6]-0.063887656499994*kSq[5]-0.05962847939999439*kSq[4]+0.05333333333333333*kSq[3]-0.03849001794597505*kSq[2]-0.8888888888888888*epsilon[0]*rdx2Sq[1]+0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[5], globalIdxs[4], (-0.01721325931647741*kSq[7])-0.05678902799999467*kSq[5]-0.03975231959999626*kSq[4]+0.01333333333333333*kSq[3]-0.4444444444444444*epsilon[0]*rdx2Sq[1]+0.03849001794597505*kSq[1]-0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[5], globalIdxs[5], (0.2666666666666667*epsilon[0]*rdx2Sq[1]*bcVals[9])/bcVals[10]+0.04549218533640458*kSq[7]-0.04549218533640458*kSq[6]-0.0127775312999988*kSq[5]-0.0127775312999988*kSq[4]+0.04666666666666667*kSq[3]-0.03849001794597505*kSq[2]+0.5777777777777777*epsilon[0]*rdx2Sq[1]+0.03849001794597505*kSq[1]+0.5777777777777777*epsilon[0]*rdx2Sq[0]-0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[5], globalIdxs[6], (0.1333333333333333*epsilon[0]*rdx2Sq[1]*bcVals[9])/bcVals[10]+0.03442651863295482*kSq[7]-0.0295084445425327*kSq[6]-0.05962847939999439*kSq[5]-0.063887656499994*kSq[4]+0.05333333333333333*kSq[3]+0.06666666666666667*epsilon[0]*rdx2Sq[1]+0.03849001794597505*kSq[1]-0.8888888888888888*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[5], globalIdxs[7], (-(0.06666666666666667*epsilon[0]*rdx2Sq[1]*bcVals[9])/bcVals[10])+0.006147592613027645*kSq[6]+0.03336355394999686*kSq[5]+0.02697478829999747*kSq[4]+0.01924500897298752*kSq[2]+0.1888888888888889*epsilon[0]*rdx2Sq[1]+0.3111111111111111*epsilon[0]*rdx2Sq[0]-0.02222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[6], globalIdxs[0], (-0.01721325931647741*kSq[6])-0.03975231959999626*kSq[5]-0.05678902799999467*kSq[4]-0.01333333333333333*kSq[3]+0.03849001794597505*kSq[2]-0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.4444444444444444*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[6], globalIdxs[1], 0.07950463919999252*kSq[5]+0.1135780559999893*kSq[4]-0.5333333333333333*epsilon[0]*rdx2Sq[1]+0.8888888888888888*epsilon[0]*rdx2Sq[0]-0.1777777777777778*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[6], globalIdxs[2], (-0.01721325931647741*kSq[6])-0.03975231959999626*kSq[5]-0.05678902799999467*kSq[4]+0.01333333333333333*kSq[3]+0.03849001794597505*kSq[2]-0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.4444444444444444*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[6], globalIdxs[3], (-0.03442651863295482*kSq[7])+0.03442651863295482*kSq[6]+0.09938079899999068*kSq[5]+0.09938079899999068*kSq[4]+0.02666666666666666*kSq[3]-0.0769800358919501*kSq[2]+0.0769800358919501*kSq[1]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[6], globalIdxs[4], 0.03442651863295482*kSq[7]+0.03442651863295482*kSq[6]+0.09938079899999068*kSq[5]+0.09938079899999068*kSq[4]-0.02666666666666666*kSq[3]-0.0769800358919501*kSq[2]-0.0769800358919501*kSq[1]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[6], globalIdxs[5], (0.1333333333333333*epsilon[0]*rdx2Sq[1]*bcVals[9])/bcVals[10]+0.03442651863295482*kSq[7]-0.0295084445425327*kSq[6]-0.05962847939999439*kSq[5]-0.063887656499994*kSq[4]+0.05333333333333333*kSq[3]+0.06666666666666667*epsilon[0]*rdx2Sq[1]+0.03849001794597505*kSq[1]-0.8888888888888888*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[6], globalIdxs[6], (1.066666666666667*epsilon[0]*rdx2Sq[1]*bcVals[9])/bcVals[10]+0.1967229636168847*kSq[6]-0.07950463919999252*kSq[5]+0.2271561119999787*kSq[4]-0.3079201435678004*kSq[2]+0.5333333333333333*epsilon[0]*rdx2Sq[1]+1.777777777777778*epsilon[0]*rdx2Sq[0]-0.3555555555555556*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[6], globalIdxs[7], (0.1333333333333333*epsilon[0]*rdx2Sq[1]*bcVals[9])/bcVals[10]-0.03442651863295482*kSq[7]-0.0295084445425327*kSq[6]-0.05962847939999439*kSq[5]-0.063887656499994*kSq[4]-0.05333333333333333*kSq[3]+0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.03849001794597505*kSq[1]-0.8888888888888888*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[7], globalIdxs[0], 0.0234254740499978*kSq[5]+0.0234254740499978*kSq[4]+0.01333333333333333*kSq[3]+0.2555555555555555*epsilon[0]*rdx2Sq[1]+0.2555555555555555*epsilon[0]*rdx2Sq[0]-0.03333333333333333*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[7], globalIdxs[1], 0.01721325931647741*kSq[6]-0.03975231959999626*kSq[5]-0.05678902799999467*kSq[4]-0.01333333333333333*kSq[3]-0.03849001794597505*kSq[2]-0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.4444444444444444*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[7], globalIdxs[2], 0.006147592613027645*kSq[7]+0.02697478829999747*kSq[5]+0.03336355394999686*kSq[4]+0.3111111111111111*epsilon[0]*rdx2Sq[1]+0.01924500897298752*kSq[1]+0.1888888888888889*epsilon[0]*rdx2Sq[0]-0.02222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[7], globalIdxs[3], 0.01721325931647741*kSq[7]-0.05678902799999467*kSq[5]-0.03975231959999626*kSq[4]-0.01333333333333333*kSq[3]-0.4444444444444444*epsilon[0]*rdx2Sq[1]-0.03849001794597505*kSq[1]-0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[7], globalIdxs[4], (-0.0295084445425327*kSq[7])-0.03442651863295482*kSq[6]-0.063887656499994*kSq[5]-0.05962847939999439*kSq[4]-0.05333333333333333*kSq[3]-0.03849001794597505*kSq[2]-0.8888888888888888*epsilon[0]*rdx2Sq[1]+0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[7], globalIdxs[5], (-(0.06666666666666667*epsilon[0]*rdx2Sq[1]*bcVals[9])/bcVals[10])+0.006147592613027645*kSq[6]+0.03336355394999686*kSq[5]+0.02697478829999747*kSq[4]+0.01924500897298752*kSq[2]+0.1888888888888889*epsilon[0]*rdx2Sq[1]+0.3111111111111111*epsilon[0]*rdx2Sq[0]-0.02222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[7], globalIdxs[6], (0.1333333333333333*epsilon[0]*rdx2Sq[1]*bcVals[9])/bcVals[10]-0.03442651863295482*kSq[7]-0.0295084445425327*kSq[6]-0.05962847939999439*kSq[5]-0.063887656499994*kSq[4]-0.05333333333333333*kSq[3]+0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.03849001794597505*kSq[1]-0.8888888888888888*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[7], globalIdxs[7], (0.2666666666666667*epsilon[0]*rdx2Sq[1]*bcVals[9])/bcVals[10]-0.04549218533640458*kSq[7]-0.04549218533640458*kSq[6]-0.0127775312999988*kSq[5]-0.0127775312999988*kSq[4]-0.04666666666666667*kSq[3]-0.03849001794597505*kSq[2]+0.5777777777777777*epsilon[0]*rdx2Sq[1]-0.03849001794597505*kSq[1]+0.5777777777777777*epsilon[0]*rdx2Sq[0]-0.06666666666666667*kSq[0]);

}
void fem_poisson_lhs_stencil_consteps_2x_ser_p1_lox_periodicx_loy_periodicy(const double *epsilon, const double *kSq, const double *dx, const double *bcVals, const long *globalIdxs, gkyl_mat_triples *tri) 
{ 
  // epsilon: permittivity.
  // kSq: wave number squared (factor multiplying phi).
  // dx: cell length in each direction.
  // bcVals[3]: values to impose as BCs, i.e. bcVals[0]*phi+bcVals[1]*d(phi)/dx=bcVals[2].
  // globalIdxs: global linear index of each basis function/node in current cell.
  // tri: triples object (i,j,val), i.e. contribute val to i,j element of the global matrix.

  double rdx2Sq[2];
  rdx2Sq[0] = 4.0/(dx[0]*dx[0]);
  rdx2Sq[1] = 4.0/(dx[1]*dx[1]);

  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[0], (-0.1666666666666667*kSq[3])+0.1924500897298752*kSq[2]+0.3333333333333333*epsilon[0]*rdx2Sq[1]+0.1924500897298752*kSq[1]+0.3333333333333333*epsilon[0]*rdx2Sq[0]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[1], 0.09622504486493762*kSq[2]+0.1666666666666667*epsilon[0]*rdx2Sq[1]-0.3333333333333333*epsilon[0]*rdx2Sq[0]-0.1111111111111111*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[2], (-0.3333333333333333*epsilon[0]*rdx2Sq[1])+0.09622504486493762*kSq[1]+0.1666666666666667*epsilon[0]*rdx2Sq[0]-0.1111111111111111*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[3], (-0.1666666666666667*epsilon[0]*rdx2Sq[1])-0.1666666666666667*epsilon[0]*rdx2Sq[0]-0.05555555555555555*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[0], 0.09622504486493762*kSq[2]+0.1666666666666667*epsilon[0]*rdx2Sq[1]-0.3333333333333333*epsilon[0]*rdx2Sq[0]-0.1111111111111111*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[1], 0.1666666666666667*kSq[3]+0.1924500897298752*kSq[2]+0.3333333333333333*epsilon[0]*rdx2Sq[1]-0.1924500897298752*kSq[1]+0.3333333333333333*epsilon[0]*rdx2Sq[0]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[2], (-0.1666666666666667*epsilon[0]*rdx2Sq[1])-0.1666666666666667*epsilon[0]*rdx2Sq[0]-0.05555555555555555*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[3], (-0.3333333333333333*epsilon[0]*rdx2Sq[1])-0.09622504486493762*kSq[1]+0.1666666666666667*epsilon[0]*rdx2Sq[0]-0.1111111111111111*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[0], (-0.3333333333333333*epsilon[0]*rdx2Sq[1])+0.09622504486493762*kSq[1]+0.1666666666666667*epsilon[0]*rdx2Sq[0]-0.1111111111111111*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[1], (-0.1666666666666667*epsilon[0]*rdx2Sq[1])-0.1666666666666667*epsilon[0]*rdx2Sq[0]-0.05555555555555555*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[2], 0.1666666666666667*kSq[3]-0.1924500897298752*kSq[2]+0.3333333333333333*epsilon[0]*rdx2Sq[1]+0.1924500897298752*kSq[1]+0.3333333333333333*epsilon[0]*rdx2Sq[0]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[3], (-0.09622504486493762*kSq[2])+0.1666666666666667*epsilon[0]*rdx2Sq[1]-0.3333333333333333*epsilon[0]*rdx2Sq[0]-0.1111111111111111*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[0], (-0.1666666666666667*epsilon[0]*rdx2Sq[1])-0.1666666666666667*epsilon[0]*rdx2Sq[0]-0.05555555555555555*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[1], (-0.3333333333333333*epsilon[0]*rdx2Sq[1])-0.09622504486493762*kSq[1]+0.1666666666666667*epsilon[0]*rdx2Sq[0]-0.1111111111111111*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[2], (-0.09622504486493762*kSq[2])+0.1666666666666667*epsilon[0]*rdx2Sq[1]-0.3333333333333333*epsilon[0]*rdx2Sq[0]-0.1111111111111111*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[3], (-0.1666666666666667*kSq[3])-0.1924500897298752*kSq[2]+0.3333333333333333*epsilon[0]*rdx2Sq[1]-0.1924500897298752*kSq[1]+0.3333333333333333*epsilon[0]*rdx2Sq[0]-0.2222222222222222*kSq[0]);

}
void fem_poisson_lhs_stencil_consteps_2x_ser_p2_lox_periodicx_loy_periodicy(const double *epsilon, const double *kSq, const double *dx, const double *bcVals, const long *globalIdxs, gkyl_mat_triples *tri) 
{ 
  // epsilon: permittivity.
  // kSq: wave number squared (factor multiplying phi).
  // dx: cell length in each direction.
  // bcVals[3]: values to impose as BCs, i.e. bcVals[0]*phi+bcVals[1]*d(phi)/dx=bcVals[2].
  // globalIdxs: global linear index of each basis function/node in current cell.
  // tri: triples object (i,j,val), i.e. contribute val to i,j element of the global matrix.

  double rdx2Sq[2];
  rdx2Sq[0] = 4.0/(dx[0]*dx[0]);
  rdx2Sq[1] = 4.0/(dx[1]*dx[1]);

  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[0], 0.04549218533640458*kSq[7]+0.04549218533640458*kSq[6]-0.0127775312999988*kSq[5]-0.0127775312999988*kSq[4]-0.04666666666666667*kSq[3]+0.03849001794597505*kSq[2]+0.5777777777777777*epsilon[0]*rdx2Sq[1]+0.03849001794597505*kSq[1]+0.5777777777777777*epsilon[0]*rdx2Sq[0]-0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[1], 0.03442651863295482*kSq[7]+0.0295084445425327*kSq[6]-0.05962847939999439*kSq[5]-0.063887656499994*kSq[4]-0.05333333333333333*kSq[3]+0.06666666666666667*epsilon[0]*rdx2Sq[1]+0.03849001794597505*kSq[1]-0.8888888888888888*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[2], (-0.006147592613027645*kSq[6])+0.03336355394999686*kSq[5]+0.02697478829999747*kSq[4]-0.01924500897298752*kSq[2]+0.1888888888888889*epsilon[0]*rdx2Sq[1]+0.3111111111111111*epsilon[0]*rdx2Sq[0]-0.02222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[3], 0.0295084445425327*kSq[7]+0.03442651863295482*kSq[6]-0.063887656499994*kSq[5]-0.05962847939999439*kSq[4]-0.05333333333333333*kSq[3]+0.03849001794597505*kSq[2]-0.8888888888888888*epsilon[0]*rdx2Sq[1]+0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[4], (-0.01721325931647741*kSq[7])-0.05678902799999467*kSq[5]-0.03975231959999626*kSq[4]-0.01333333333333333*kSq[3]-0.4444444444444444*epsilon[0]*rdx2Sq[1]+0.03849001794597505*kSq[1]-0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[5], (-0.006147592613027645*kSq[7])+0.02697478829999747*kSq[5]+0.03336355394999686*kSq[4]+0.3111111111111111*epsilon[0]*rdx2Sq[1]-0.01924500897298752*kSq[1]+0.1888888888888889*epsilon[0]*rdx2Sq[0]-0.02222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[6], (-0.01721325931647741*kSq[6])-0.03975231959999626*kSq[5]-0.05678902799999467*kSq[4]-0.01333333333333333*kSq[3]+0.03849001794597505*kSq[2]-0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.4444444444444444*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[7], 0.0234254740499978*kSq[5]+0.0234254740499978*kSq[4]+0.01333333333333333*kSq[3]+0.2555555555555555*epsilon[0]*rdx2Sq[1]+0.2555555555555555*epsilon[0]*rdx2Sq[0]-0.03333333333333333*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[0], 0.03442651863295482*kSq[7]+0.0295084445425327*kSq[6]-0.05962847939999439*kSq[5]-0.063887656499994*kSq[4]-0.05333333333333333*kSq[3]+0.06666666666666667*epsilon[0]*rdx2Sq[1]+0.03849001794597505*kSq[1]-0.8888888888888888*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[1], (-0.1967229636168847*kSq[6])-0.07950463919999252*kSq[5]+0.2271561119999787*kSq[4]+0.3079201435678004*kSq[2]+0.5333333333333333*epsilon[0]*rdx2Sq[1]+1.777777777777778*epsilon[0]*rdx2Sq[0]-0.3555555555555556*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[2], (-0.03442651863295482*kSq[7])+0.0295084445425327*kSq[6]-0.05962847939999439*kSq[5]-0.063887656499994*kSq[4]+0.05333333333333333*kSq[3]+0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.03849001794597505*kSq[1]-0.8888888888888888*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[3], (-0.03442651863295482*kSq[7])-0.03442651863295482*kSq[6]+0.09938079899999068*kSq[5]+0.09938079899999068*kSq[4]-0.02666666666666666*kSq[3]+0.0769800358919501*kSq[2]+0.0769800358919501*kSq[1]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[4], 0.03442651863295482*kSq[7]-0.03442651863295482*kSq[6]+0.09938079899999068*kSq[5]+0.09938079899999068*kSq[4]+0.02666666666666666*kSq[3]+0.0769800358919501*kSq[2]-0.0769800358919501*kSq[1]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[5], 0.01721325931647741*kSq[6]-0.03975231959999626*kSq[5]-0.05678902799999467*kSq[4]+0.01333333333333333*kSq[3]-0.03849001794597505*kSq[2]-0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.4444444444444444*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[6], 0.07950463919999252*kSq[5]+0.1135780559999893*kSq[4]-0.5333333333333333*epsilon[0]*rdx2Sq[1]+0.8888888888888888*epsilon[0]*rdx2Sq[0]-0.1777777777777778*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[7], 0.01721325931647741*kSq[6]-0.03975231959999626*kSq[5]-0.05678902799999467*kSq[4]-0.01333333333333333*kSq[3]-0.03849001794597505*kSq[2]-0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.4444444444444444*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[0], (-0.006147592613027645*kSq[6])+0.03336355394999686*kSq[5]+0.02697478829999747*kSq[4]-0.01924500897298752*kSq[2]+0.1888888888888889*epsilon[0]*rdx2Sq[1]+0.3111111111111111*epsilon[0]*rdx2Sq[0]-0.02222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[1], (-0.03442651863295482*kSq[7])+0.0295084445425327*kSq[6]-0.05962847939999439*kSq[5]-0.063887656499994*kSq[4]+0.05333333333333333*kSq[3]+0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.03849001794597505*kSq[1]-0.8888888888888888*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[2], (-0.04549218533640458*kSq[7])+0.04549218533640458*kSq[6]-0.0127775312999988*kSq[5]-0.0127775312999988*kSq[4]+0.04666666666666667*kSq[3]+0.03849001794597505*kSq[2]+0.5777777777777777*epsilon[0]*rdx2Sq[1]-0.03849001794597505*kSq[1]+0.5777777777777777*epsilon[0]*rdx2Sq[0]-0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[3], 0.01721325931647741*kSq[7]-0.05678902799999467*kSq[5]-0.03975231959999626*kSq[4]+0.01333333333333333*kSq[3]-0.4444444444444444*epsilon[0]*rdx2Sq[1]-0.03849001794597505*kSq[1]-0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[4], (-0.0295084445425327*kSq[7])+0.03442651863295482*kSq[6]-0.063887656499994*kSq[5]-0.05962847939999439*kSq[4]+0.05333333333333333*kSq[3]+0.03849001794597505*kSq[2]-0.8888888888888888*epsilon[0]*rdx2Sq[1]+0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[5], 0.0234254740499978*kSq[5]+0.0234254740499978*kSq[4]-0.01333333333333333*kSq[3]+0.2555555555555555*epsilon[0]*rdx2Sq[1]+0.2555555555555555*epsilon[0]*rdx2Sq[0]-0.03333333333333333*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[6], (-0.01721325931647741*kSq[6])-0.03975231959999626*kSq[5]-0.05678902799999467*kSq[4]+0.01333333333333333*kSq[3]+0.03849001794597505*kSq[2]-0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.4444444444444444*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[7], 0.006147592613027645*kSq[7]+0.02697478829999747*kSq[5]+0.03336355394999686*kSq[4]+0.3111111111111111*epsilon[0]*rdx2Sq[1]+0.01924500897298752*kSq[1]+0.1888888888888889*epsilon[0]*rdx2Sq[0]-0.02222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[0], 0.0295084445425327*kSq[7]+0.03442651863295482*kSq[6]-0.063887656499994*kSq[5]-0.05962847939999439*kSq[4]-0.05333333333333333*kSq[3]+0.03849001794597505*kSq[2]-0.8888888888888888*epsilon[0]*rdx2Sq[1]+0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[1], (-0.03442651863295482*kSq[7])-0.03442651863295482*kSq[6]+0.09938079899999068*kSq[5]+0.09938079899999068*kSq[4]-0.02666666666666666*kSq[3]+0.0769800358919501*kSq[2]+0.0769800358919501*kSq[1]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[2], 0.01721325931647741*kSq[7]-0.05678902799999467*kSq[5]-0.03975231959999626*kSq[4]+0.01333333333333333*kSq[3]-0.4444444444444444*epsilon[0]*rdx2Sq[1]-0.03849001794597505*kSq[1]-0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[3], (-0.1967229636168847*kSq[7])+0.2271561119999787*kSq[5]-0.07950463919999252*kSq[4]+1.777777777777778*epsilon[0]*rdx2Sq[1]+0.3079201435678004*kSq[1]+0.5333333333333333*epsilon[0]*rdx2Sq[0]-0.3555555555555556*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[4], 0.1135780559999893*kSq[5]+0.07950463919999252*kSq[4]+0.8888888888888888*epsilon[0]*rdx2Sq[1]-0.5333333333333333*epsilon[0]*rdx2Sq[0]-0.1777777777777778*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[5], 0.0295084445425327*kSq[7]-0.03442651863295482*kSq[6]-0.063887656499994*kSq[5]-0.05962847939999439*kSq[4]+0.05333333333333333*kSq[3]-0.03849001794597505*kSq[2]-0.8888888888888888*epsilon[0]*rdx2Sq[1]+0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[6], (-0.03442651863295482*kSq[7])+0.03442651863295482*kSq[6]+0.09938079899999068*kSq[5]+0.09938079899999068*kSq[4]+0.02666666666666666*kSq[3]-0.0769800358919501*kSq[2]+0.0769800358919501*kSq[1]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[7], 0.01721325931647741*kSq[7]-0.05678902799999467*kSq[5]-0.03975231959999626*kSq[4]-0.01333333333333333*kSq[3]-0.4444444444444444*epsilon[0]*rdx2Sq[1]-0.03849001794597505*kSq[1]-0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[4], globalIdxs[0], (-0.01721325931647741*kSq[7])-0.05678902799999467*kSq[5]-0.03975231959999626*kSq[4]-0.01333333333333333*kSq[3]-0.4444444444444444*epsilon[0]*rdx2Sq[1]+0.03849001794597505*kSq[1]-0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[4], globalIdxs[1], 0.03442651863295482*kSq[7]-0.03442651863295482*kSq[6]+0.09938079899999068*kSq[5]+0.09938079899999068*kSq[4]+0.02666666666666666*kSq[3]+0.0769800358919501*kSq[2]-0.0769800358919501*kSq[1]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[4], globalIdxs[2], (-0.0295084445425327*kSq[7])+0.03442651863295482*kSq[6]-0.063887656499994*kSq[5]-0.05962847939999439*kSq[4]+0.05333333333333333*kSq[3]+0.03849001794597505*kSq[2]-0.8888888888888888*epsilon[0]*rdx2Sq[1]+0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[4], globalIdxs[3], 0.1135780559999893*kSq[5]+0.07950463919999252*kSq[4]+0.8888888888888888*epsilon[0]*rdx2Sq[1]-0.5333333333333333*epsilon[0]*rdx2Sq[0]-0.1777777777777778*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[4], globalIdxs[4], 0.1967229636168847*kSq[7]+0.2271561119999787*kSq[5]-0.07950463919999252*kSq[4]+1.777777777777778*epsilon[0]*rdx2Sq[1]-0.3079201435678004*kSq[1]+0.5333333333333333*epsilon[0]*rdx2Sq[0]-0.3555555555555556*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[4], globalIdxs[5], (-0.01721325931647741*kSq[7])-0.05678902799999467*kSq[5]-0.03975231959999626*kSq[4]+0.01333333333333333*kSq[3]-0.4444444444444444*epsilon[0]*rdx2Sq[1]+0.03849001794597505*kSq[1]-0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[4], globalIdxs[6], 0.03442651863295482*kSq[7]+0.03442651863295482*kSq[6]+0.09938079899999068*kSq[5]+0.09938079899999068*kSq[4]-0.02666666666666666*kSq[3]-0.0769800358919501*kSq[2]-0.0769800358919501*kSq[1]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[4], globalIdxs[7], (-0.0295084445425327*kSq[7])-0.03442651863295482*kSq[6]-0.063887656499994*kSq[5]-0.05962847939999439*kSq[4]-0.05333333333333333*kSq[3]-0.03849001794597505*kSq[2]-0.8888888888888888*epsilon[0]*rdx2Sq[1]+0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[5], globalIdxs[0], (-0.006147592613027645*kSq[7])+0.02697478829999747*kSq[5]+0.03336355394999686*kSq[4]+0.3111111111111111*epsilon[0]*rdx2Sq[1]-0.01924500897298752*kSq[1]+0.1888888888888889*epsilon[0]*rdx2Sq[0]-0.02222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[5], globalIdxs[1], 0.01721325931647741*kSq[6]-0.03975231959999626*kSq[5]-0.05678902799999467*kSq[4]+0.01333333333333333*kSq[3]-0.03849001794597505*kSq[2]-0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.4444444444444444*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[5], globalIdxs[2], 0.0234254740499978*kSq[5]+0.0234254740499978*kSq[4]-0.01333333333333333*kSq[3]+0.2555555555555555*epsilon[0]*rdx2Sq[1]+0.2555555555555555*epsilon[0]*rdx2Sq[0]-0.03333333333333333*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[5], globalIdxs[3], 0.0295084445425327*kSq[7]-0.03442651863295482*kSq[6]-0.063887656499994*kSq[5]-0.05962847939999439*kSq[4]+0.05333333333333333*kSq[3]-0.03849001794597505*kSq[2]-0.8888888888888888*epsilon[0]*rdx2Sq[1]+0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[5], globalIdxs[4], (-0.01721325931647741*kSq[7])-0.05678902799999467*kSq[5]-0.03975231959999626*kSq[4]+0.01333333333333333*kSq[3]-0.4444444444444444*epsilon[0]*rdx2Sq[1]+0.03849001794597505*kSq[1]-0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[5], globalIdxs[5], 0.04549218533640458*kSq[7]-0.04549218533640458*kSq[6]-0.0127775312999988*kSq[5]-0.0127775312999988*kSq[4]+0.04666666666666667*kSq[3]-0.03849001794597505*kSq[2]+0.5777777777777777*epsilon[0]*rdx2Sq[1]+0.03849001794597505*kSq[1]+0.5777777777777777*epsilon[0]*rdx2Sq[0]-0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[5], globalIdxs[6], 0.03442651863295482*kSq[7]-0.0295084445425327*kSq[6]-0.05962847939999439*kSq[5]-0.063887656499994*kSq[4]+0.05333333333333333*kSq[3]+0.06666666666666667*epsilon[0]*rdx2Sq[1]+0.03849001794597505*kSq[1]-0.8888888888888888*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[5], globalIdxs[7], 0.006147592613027645*kSq[6]+0.03336355394999686*kSq[5]+0.02697478829999747*kSq[4]+0.01924500897298752*kSq[2]+0.1888888888888889*epsilon[0]*rdx2Sq[1]+0.3111111111111111*epsilon[0]*rdx2Sq[0]-0.02222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[6], globalIdxs[0], (-0.01721325931647741*kSq[6])-0.03975231959999626*kSq[5]-0.05678902799999467*kSq[4]-0.01333333333333333*kSq[3]+0.03849001794597505*kSq[2]-0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.4444444444444444*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[6], globalIdxs[1], 0.07950463919999252*kSq[5]+0.1135780559999893*kSq[4]-0.5333333333333333*epsilon[0]*rdx2Sq[1]+0.8888888888888888*epsilon[0]*rdx2Sq[0]-0.1777777777777778*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[6], globalIdxs[2], (-0.01721325931647741*kSq[6])-0.03975231959999626*kSq[5]-0.05678902799999467*kSq[4]+0.01333333333333333*kSq[3]+0.03849001794597505*kSq[2]-0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.4444444444444444*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[6], globalIdxs[3], (-0.03442651863295482*kSq[7])+0.03442651863295482*kSq[6]+0.09938079899999068*kSq[5]+0.09938079899999068*kSq[4]+0.02666666666666666*kSq[3]-0.0769800358919501*kSq[2]+0.0769800358919501*kSq[1]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[6], globalIdxs[4], 0.03442651863295482*kSq[7]+0.03442651863295482*kSq[6]+0.09938079899999068*kSq[5]+0.09938079899999068*kSq[4]-0.02666666666666666*kSq[3]-0.0769800358919501*kSq[2]-0.0769800358919501*kSq[1]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[6], globalIdxs[5], 0.03442651863295482*kSq[7]-0.0295084445425327*kSq[6]-0.05962847939999439*kSq[5]-0.063887656499994*kSq[4]+0.05333333333333333*kSq[3]+0.06666666666666667*epsilon[0]*rdx2Sq[1]+0.03849001794597505*kSq[1]-0.8888888888888888*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[6], globalIdxs[6], 0.1967229636168847*kSq[6]-0.07950463919999252*kSq[5]+0.2271561119999787*kSq[4]-0.3079201435678004*kSq[2]+0.5333333333333333*epsilon[0]*rdx2Sq[1]+1.777777777777778*epsilon[0]*rdx2Sq[0]-0.3555555555555556*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[6], globalIdxs[7], (-0.03442651863295482*kSq[7])-0.0295084445425327*kSq[6]-0.05962847939999439*kSq[5]-0.063887656499994*kSq[4]-0.05333333333333333*kSq[3]+0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.03849001794597505*kSq[1]-0.8888888888888888*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[7], globalIdxs[0], 0.0234254740499978*kSq[5]+0.0234254740499978*kSq[4]+0.01333333333333333*kSq[3]+0.2555555555555555*epsilon[0]*rdx2Sq[1]+0.2555555555555555*epsilon[0]*rdx2Sq[0]-0.03333333333333333*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[7], globalIdxs[1], 0.01721325931647741*kSq[6]-0.03975231959999626*kSq[5]-0.05678902799999467*kSq[4]-0.01333333333333333*kSq[3]-0.03849001794597505*kSq[2]-0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.4444444444444444*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[7], globalIdxs[2], 0.006147592613027645*kSq[7]+0.02697478829999747*kSq[5]+0.03336355394999686*kSq[4]+0.3111111111111111*epsilon[0]*rdx2Sq[1]+0.01924500897298752*kSq[1]+0.1888888888888889*epsilon[0]*rdx2Sq[0]-0.02222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[7], globalIdxs[3], 0.01721325931647741*kSq[7]-0.05678902799999467*kSq[5]-0.03975231959999626*kSq[4]-0.01333333333333333*kSq[3]-0.4444444444444444*epsilon[0]*rdx2Sq[1]-0.03849001794597505*kSq[1]-0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[7], globalIdxs[4], (-0.0295084445425327*kSq[7])-0.03442651863295482*kSq[6]-0.063887656499994*kSq[5]-0.05962847939999439*kSq[4]-0.05333333333333333*kSq[3]-0.03849001794597505*kSq[2]-0.8888888888888888*epsilon[0]*rdx2Sq[1]+0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[7], globalIdxs[5], 0.006147592613027645*kSq[6]+0.03336355394999686*kSq[5]+0.02697478829999747*kSq[4]+0.01924500897298752*kSq[2]+0.1888888888888889*epsilon[0]*rdx2Sq[1]+0.3111111111111111*epsilon[0]*rdx2Sq[0]-0.02222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[7], globalIdxs[6], (-0.03442651863295482*kSq[7])-0.0295084445425327*kSq[6]-0.05962847939999439*kSq[5]-0.063887656499994*kSq[4]-0.05333333333333333*kSq[3]+0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.03849001794597505*kSq[1]-0.8888888888888888*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[7], globalIdxs[7], (-0.04549218533640458*kSq[7])-0.04549218533640458*kSq[6]-0.0127775312999988*kSq[5]-0.0127775312999988*kSq[4]-0.04666666666666667*kSq[3]-0.03849001794597505*kSq[2]+0.5777777777777777*epsilon[0]*rdx2Sq[1]-0.03849001794597505*kSq[1]+0.5777777777777777*epsilon[0]*rdx2Sq[0]-0.06666666666666667*kSq[0]);

}
void fem_poisson_lhs_stencil_consteps_2x_ser_p1_lox_periodicx_loy_dirichlety(const double *epsilon, const double *kSq, const double *dx, const double *bcVals, const long *globalIdxs, gkyl_mat_triples *tri) 
{ 
  // epsilon: permittivity.
  // kSq: wave number squared (factor multiplying phi).
  // dx: cell length in each direction.
  // bcVals[3]: values to impose as BCs, i.e. bcVals[0]*phi+bcVals[1]*d(phi)/dx=bcVals[2].
  // globalIdxs: global linear index of each basis function/node in current cell.
  // tri: triples object (i,j,val), i.e. contribute val to i,j element of the global matrix.

  double rdx2Sq[2];
  rdx2Sq[0] = 4.0/(dx[0]*dx[0]);
  rdx2Sq[1] = 4.0/(dx[1]*dx[1]);

  gkyl_mat_triples_insert(tri, globalIdxs[0], globalIdxs[0], 1.0);
  gkyl_mat_triples_insert(tri, globalIdxs[0], globalIdxs[1], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[0], globalIdxs[2], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[0], globalIdxs[3], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[1], globalIdxs[0], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[1], globalIdxs[1], 1.0);
  gkyl_mat_triples_insert(tri, globalIdxs[1], globalIdxs[2], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[1], globalIdxs[3], 0.0);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[0], (-0.3333333333333333*epsilon[0]*rdx2Sq[1])+0.09622504486493762*kSq[1]+0.1666666666666667*epsilon[0]*rdx2Sq[0]-0.1111111111111111*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[1], (-0.1666666666666667*epsilon[0]*rdx2Sq[1])-0.1666666666666667*epsilon[0]*rdx2Sq[0]-0.05555555555555555*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[2], 0.1666666666666667*kSq[3]-0.1924500897298752*kSq[2]+0.3333333333333333*epsilon[0]*rdx2Sq[1]+0.1924500897298752*kSq[1]+0.3333333333333333*epsilon[0]*rdx2Sq[0]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[3], (-0.09622504486493762*kSq[2])+0.1666666666666667*epsilon[0]*rdx2Sq[1]-0.3333333333333333*epsilon[0]*rdx2Sq[0]-0.1111111111111111*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[0], (-0.1666666666666667*epsilon[0]*rdx2Sq[1])-0.1666666666666667*epsilon[0]*rdx2Sq[0]-0.05555555555555555*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[1], (-0.3333333333333333*epsilon[0]*rdx2Sq[1])-0.09622504486493762*kSq[1]+0.1666666666666667*epsilon[0]*rdx2Sq[0]-0.1111111111111111*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[2], (-0.09622504486493762*kSq[2])+0.1666666666666667*epsilon[0]*rdx2Sq[1]-0.3333333333333333*epsilon[0]*rdx2Sq[0]-0.1111111111111111*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[3], (-0.1666666666666667*kSq[3])-0.1924500897298752*kSq[2]+0.3333333333333333*epsilon[0]*rdx2Sq[1]-0.1924500897298752*kSq[1]+0.3333333333333333*epsilon[0]*rdx2Sq[0]-0.2222222222222222*kSq[0]);

}
void fem_poisson_lhs_stencil_consteps_2x_ser_p2_lox_periodicx_loy_dirichlety(const double *epsilon, const double *kSq, const double *dx, const double *bcVals, const long *globalIdxs, gkyl_mat_triples *tri) 
{ 
  // epsilon: permittivity.
  // kSq: wave number squared (factor multiplying phi).
  // dx: cell length in each direction.
  // bcVals[3]: values to impose as BCs, i.e. bcVals[0]*phi+bcVals[1]*d(phi)/dx=bcVals[2].
  // globalIdxs: global linear index of each basis function/node in current cell.
  // tri: triples object (i,j,val), i.e. contribute val to i,j element of the global matrix.

  double rdx2Sq[2];
  rdx2Sq[0] = 4.0/(dx[0]*dx[0]);
  rdx2Sq[1] = 4.0/(dx[1]*dx[1]);

  gkyl_mat_triples_insert(tri, globalIdxs[0], globalIdxs[0], 1.0);
  gkyl_mat_triples_insert(tri, globalIdxs[0], globalIdxs[1], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[0], globalIdxs[2], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[0], globalIdxs[3], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[0], globalIdxs[4], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[0], globalIdxs[5], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[0], globalIdxs[6], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[0], globalIdxs[7], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[1], globalIdxs[0], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[1], globalIdxs[1], 1.0);
  gkyl_mat_triples_insert(tri, globalIdxs[1], globalIdxs[2], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[1], globalIdxs[3], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[1], globalIdxs[4], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[1], globalIdxs[5], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[1], globalIdxs[6], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[1], globalIdxs[7], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[2], globalIdxs[0], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[2], globalIdxs[1], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[2], globalIdxs[2], 1.0);
  gkyl_mat_triples_insert(tri, globalIdxs[2], globalIdxs[3], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[2], globalIdxs[4], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[2], globalIdxs[5], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[2], globalIdxs[6], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[2], globalIdxs[7], 0.0);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[0], 0.0295084445425327*kSq[7]+0.03442651863295482*kSq[6]-0.063887656499994*kSq[5]-0.05962847939999439*kSq[4]-0.05333333333333333*kSq[3]+0.03849001794597505*kSq[2]-0.8888888888888888*epsilon[0]*rdx2Sq[1]+0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[1], (-0.03442651863295482*kSq[7])-0.03442651863295482*kSq[6]+0.09938079899999068*kSq[5]+0.09938079899999068*kSq[4]-0.02666666666666666*kSq[3]+0.0769800358919501*kSq[2]+0.0769800358919501*kSq[1]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[2], 0.01721325931647741*kSq[7]-0.05678902799999467*kSq[5]-0.03975231959999626*kSq[4]+0.01333333333333333*kSq[3]-0.4444444444444444*epsilon[0]*rdx2Sq[1]-0.03849001794597505*kSq[1]-0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[3], (-0.1967229636168847*kSq[7])+0.2271561119999787*kSq[5]-0.07950463919999252*kSq[4]+1.777777777777778*epsilon[0]*rdx2Sq[1]+0.3079201435678004*kSq[1]+0.5333333333333333*epsilon[0]*rdx2Sq[0]-0.3555555555555556*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[4], 0.1135780559999893*kSq[5]+0.07950463919999252*kSq[4]+0.8888888888888888*epsilon[0]*rdx2Sq[1]-0.5333333333333333*epsilon[0]*rdx2Sq[0]-0.1777777777777778*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[5], 0.0295084445425327*kSq[7]-0.03442651863295482*kSq[6]-0.063887656499994*kSq[5]-0.05962847939999439*kSq[4]+0.05333333333333333*kSq[3]-0.03849001794597505*kSq[2]-0.8888888888888888*epsilon[0]*rdx2Sq[1]+0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[6], (-0.03442651863295482*kSq[7])+0.03442651863295482*kSq[6]+0.09938079899999068*kSq[5]+0.09938079899999068*kSq[4]+0.02666666666666666*kSq[3]-0.0769800358919501*kSq[2]+0.0769800358919501*kSq[1]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[7], 0.01721325931647741*kSq[7]-0.05678902799999467*kSq[5]-0.03975231959999626*kSq[4]-0.01333333333333333*kSq[3]-0.4444444444444444*epsilon[0]*rdx2Sq[1]-0.03849001794597505*kSq[1]-0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[4], globalIdxs[0], (-0.01721325931647741*kSq[7])-0.05678902799999467*kSq[5]-0.03975231959999626*kSq[4]-0.01333333333333333*kSq[3]-0.4444444444444444*epsilon[0]*rdx2Sq[1]+0.03849001794597505*kSq[1]-0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[4], globalIdxs[1], 0.03442651863295482*kSq[7]-0.03442651863295482*kSq[6]+0.09938079899999068*kSq[5]+0.09938079899999068*kSq[4]+0.02666666666666666*kSq[3]+0.0769800358919501*kSq[2]-0.0769800358919501*kSq[1]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[4], globalIdxs[2], (-0.0295084445425327*kSq[7])+0.03442651863295482*kSq[6]-0.063887656499994*kSq[5]-0.05962847939999439*kSq[4]+0.05333333333333333*kSq[3]+0.03849001794597505*kSq[2]-0.8888888888888888*epsilon[0]*rdx2Sq[1]+0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[4], globalIdxs[3], 0.1135780559999893*kSq[5]+0.07950463919999252*kSq[4]+0.8888888888888888*epsilon[0]*rdx2Sq[1]-0.5333333333333333*epsilon[0]*rdx2Sq[0]-0.1777777777777778*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[4], globalIdxs[4], 0.1967229636168847*kSq[7]+0.2271561119999787*kSq[5]-0.07950463919999252*kSq[4]+1.777777777777778*epsilon[0]*rdx2Sq[1]-0.3079201435678004*kSq[1]+0.5333333333333333*epsilon[0]*rdx2Sq[0]-0.3555555555555556*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[4], globalIdxs[5], (-0.01721325931647741*kSq[7])-0.05678902799999467*kSq[5]-0.03975231959999626*kSq[4]+0.01333333333333333*kSq[3]-0.4444444444444444*epsilon[0]*rdx2Sq[1]+0.03849001794597505*kSq[1]-0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[4], globalIdxs[6], 0.03442651863295482*kSq[7]+0.03442651863295482*kSq[6]+0.09938079899999068*kSq[5]+0.09938079899999068*kSq[4]-0.02666666666666666*kSq[3]-0.0769800358919501*kSq[2]-0.0769800358919501*kSq[1]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[4], globalIdxs[7], (-0.0295084445425327*kSq[7])-0.03442651863295482*kSq[6]-0.063887656499994*kSq[5]-0.05962847939999439*kSq[4]-0.05333333333333333*kSq[3]-0.03849001794597505*kSq[2]-0.8888888888888888*epsilon[0]*rdx2Sq[1]+0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[5], globalIdxs[0], (-0.006147592613027645*kSq[7])+0.02697478829999747*kSq[5]+0.03336355394999686*kSq[4]+0.3111111111111111*epsilon[0]*rdx2Sq[1]-0.01924500897298752*kSq[1]+0.1888888888888889*epsilon[0]*rdx2Sq[0]-0.02222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[5], globalIdxs[1], 0.01721325931647741*kSq[6]-0.03975231959999626*kSq[5]-0.05678902799999467*kSq[4]+0.01333333333333333*kSq[3]-0.03849001794597505*kSq[2]-0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.4444444444444444*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[5], globalIdxs[2], 0.0234254740499978*kSq[5]+0.0234254740499978*kSq[4]-0.01333333333333333*kSq[3]+0.2555555555555555*epsilon[0]*rdx2Sq[1]+0.2555555555555555*epsilon[0]*rdx2Sq[0]-0.03333333333333333*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[5], globalIdxs[3], 0.0295084445425327*kSq[7]-0.03442651863295482*kSq[6]-0.063887656499994*kSq[5]-0.05962847939999439*kSq[4]+0.05333333333333333*kSq[3]-0.03849001794597505*kSq[2]-0.8888888888888888*epsilon[0]*rdx2Sq[1]+0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[5], globalIdxs[4], (-0.01721325931647741*kSq[7])-0.05678902799999467*kSq[5]-0.03975231959999626*kSq[4]+0.01333333333333333*kSq[3]-0.4444444444444444*epsilon[0]*rdx2Sq[1]+0.03849001794597505*kSq[1]-0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[5], globalIdxs[5], 0.04549218533640458*kSq[7]-0.04549218533640458*kSq[6]-0.0127775312999988*kSq[5]-0.0127775312999988*kSq[4]+0.04666666666666667*kSq[3]-0.03849001794597505*kSq[2]+0.5777777777777777*epsilon[0]*rdx2Sq[1]+0.03849001794597505*kSq[1]+0.5777777777777777*epsilon[0]*rdx2Sq[0]-0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[5], globalIdxs[6], 0.03442651863295482*kSq[7]-0.0295084445425327*kSq[6]-0.05962847939999439*kSq[5]-0.063887656499994*kSq[4]+0.05333333333333333*kSq[3]+0.06666666666666667*epsilon[0]*rdx2Sq[1]+0.03849001794597505*kSq[1]-0.8888888888888888*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[5], globalIdxs[7], 0.006147592613027645*kSq[6]+0.03336355394999686*kSq[5]+0.02697478829999747*kSq[4]+0.01924500897298752*kSq[2]+0.1888888888888889*epsilon[0]*rdx2Sq[1]+0.3111111111111111*epsilon[0]*rdx2Sq[0]-0.02222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[6], globalIdxs[0], (-0.01721325931647741*kSq[6])-0.03975231959999626*kSq[5]-0.05678902799999467*kSq[4]-0.01333333333333333*kSq[3]+0.03849001794597505*kSq[2]-0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.4444444444444444*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[6], globalIdxs[1], 0.07950463919999252*kSq[5]+0.1135780559999893*kSq[4]-0.5333333333333333*epsilon[0]*rdx2Sq[1]+0.8888888888888888*epsilon[0]*rdx2Sq[0]-0.1777777777777778*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[6], globalIdxs[2], (-0.01721325931647741*kSq[6])-0.03975231959999626*kSq[5]-0.05678902799999467*kSq[4]+0.01333333333333333*kSq[3]+0.03849001794597505*kSq[2]-0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.4444444444444444*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[6], globalIdxs[3], (-0.03442651863295482*kSq[7])+0.03442651863295482*kSq[6]+0.09938079899999068*kSq[5]+0.09938079899999068*kSq[4]+0.02666666666666666*kSq[3]-0.0769800358919501*kSq[2]+0.0769800358919501*kSq[1]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[6], globalIdxs[4], 0.03442651863295482*kSq[7]+0.03442651863295482*kSq[6]+0.09938079899999068*kSq[5]+0.09938079899999068*kSq[4]-0.02666666666666666*kSq[3]-0.0769800358919501*kSq[2]-0.0769800358919501*kSq[1]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[6], globalIdxs[5], 0.03442651863295482*kSq[7]-0.0295084445425327*kSq[6]-0.05962847939999439*kSq[5]-0.063887656499994*kSq[4]+0.05333333333333333*kSq[3]+0.06666666666666667*epsilon[0]*rdx2Sq[1]+0.03849001794597505*kSq[1]-0.8888888888888888*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[6], globalIdxs[6], 0.1967229636168847*kSq[6]-0.07950463919999252*kSq[5]+0.2271561119999787*kSq[4]-0.3079201435678004*kSq[2]+0.5333333333333333*epsilon[0]*rdx2Sq[1]+1.777777777777778*epsilon[0]*rdx2Sq[0]-0.3555555555555556*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[6], globalIdxs[7], (-0.03442651863295482*kSq[7])-0.0295084445425327*kSq[6]-0.05962847939999439*kSq[5]-0.063887656499994*kSq[4]-0.05333333333333333*kSq[3]+0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.03849001794597505*kSq[1]-0.8888888888888888*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[7], globalIdxs[0], 0.0234254740499978*kSq[5]+0.0234254740499978*kSq[4]+0.01333333333333333*kSq[3]+0.2555555555555555*epsilon[0]*rdx2Sq[1]+0.2555555555555555*epsilon[0]*rdx2Sq[0]-0.03333333333333333*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[7], globalIdxs[1], 0.01721325931647741*kSq[6]-0.03975231959999626*kSq[5]-0.05678902799999467*kSq[4]-0.01333333333333333*kSq[3]-0.03849001794597505*kSq[2]-0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.4444444444444444*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[7], globalIdxs[2], 0.006147592613027645*kSq[7]+0.02697478829999747*kSq[5]+0.03336355394999686*kSq[4]+0.3111111111111111*epsilon[0]*rdx2Sq[1]+0.01924500897298752*kSq[1]+0.1888888888888889*epsilon[0]*rdx2Sq[0]-0.02222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[7], globalIdxs[3], 0.01721325931647741*kSq[7]-0.05678902799999467*kSq[5]-0.03975231959999626*kSq[4]-0.01333333333333333*kSq[3]-0.4444444444444444*epsilon[0]*rdx2Sq[1]-0.03849001794597505*kSq[1]-0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[7], globalIdxs[4], (-0.0295084445425327*kSq[7])-0.03442651863295482*kSq[6]-0.063887656499994*kSq[5]-0.05962847939999439*kSq[4]-0.05333333333333333*kSq[3]-0.03849001794597505*kSq[2]-0.8888888888888888*epsilon[0]*rdx2Sq[1]+0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[7], globalIdxs[5], 0.006147592613027645*kSq[6]+0.03336355394999686*kSq[5]+0.02697478829999747*kSq[4]+0.01924500897298752*kSq[2]+0.1888888888888889*epsilon[0]*rdx2Sq[1]+0.3111111111111111*epsilon[0]*rdx2Sq[0]-0.02222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[7], globalIdxs[6], (-0.03442651863295482*kSq[7])-0.0295084445425327*kSq[6]-0.05962847939999439*kSq[5]-0.063887656499994*kSq[4]-0.05333333333333333*kSq[3]+0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.03849001794597505*kSq[1]-0.8888888888888888*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[7], globalIdxs[7], (-0.04549218533640458*kSq[7])-0.04549218533640458*kSq[6]-0.0127775312999988*kSq[5]-0.0127775312999988*kSq[4]-0.04666666666666667*kSq[3]-0.03849001794597505*kSq[2]+0.5777777777777777*epsilon[0]*rdx2Sq[1]-0.03849001794597505*kSq[1]+0.5777777777777777*epsilon[0]*rdx2Sq[0]-0.06666666666666667*kSq[0]);

}
void fem_poisson_lhs_stencil_consteps_2x_ser_p1_lox_periodicx_loy_neumanny(const double *epsilon, const double *kSq, const double *dx, const double *bcVals, const long *globalIdxs, gkyl_mat_triples *tri) 
{ 
  // epsilon: permittivity.
  // kSq: wave number squared (factor multiplying phi).
  // dx: cell length in each direction.
  // bcVals[3]: values to impose as BCs, i.e. bcVals[0]*phi+bcVals[1]*d(phi)/dx=bcVals[2].
  // globalIdxs: global linear index of each basis function/node in current cell.
  // tri: triples object (i,j,val), i.e. contribute val to i,j element of the global matrix.

  double rdx2Sq[2];
  rdx2Sq[0] = 4.0/(dx[0]*dx[0]);
  rdx2Sq[1] = 4.0/(dx[1]*dx[1]);

  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[0], (-0.1666666666666667*kSq[3])+0.1924500897298752*kSq[2]+0.3333333333333333*epsilon[0]*rdx2Sq[1]+0.1924500897298752*kSq[1]+0.3333333333333333*epsilon[0]*rdx2Sq[0]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[1], 0.09622504486493762*kSq[2]+0.1666666666666667*epsilon[0]*rdx2Sq[1]-0.3333333333333333*epsilon[0]*rdx2Sq[0]-0.1111111111111111*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[2], (-0.3333333333333333*epsilon[0]*rdx2Sq[1])+0.09622504486493762*kSq[1]+0.1666666666666667*epsilon[0]*rdx2Sq[0]-0.1111111111111111*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[3], (-0.1666666666666667*epsilon[0]*rdx2Sq[1])-0.1666666666666667*epsilon[0]*rdx2Sq[0]-0.05555555555555555*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[0], 0.09622504486493762*kSq[2]+0.1666666666666667*epsilon[0]*rdx2Sq[1]-0.3333333333333333*epsilon[0]*rdx2Sq[0]-0.1111111111111111*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[1], 0.1666666666666667*kSq[3]+0.1924500897298752*kSq[2]+0.3333333333333333*epsilon[0]*rdx2Sq[1]-0.1924500897298752*kSq[1]+0.3333333333333333*epsilon[0]*rdx2Sq[0]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[2], (-0.1666666666666667*epsilon[0]*rdx2Sq[1])-0.1666666666666667*epsilon[0]*rdx2Sq[0]-0.05555555555555555*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[3], (-0.3333333333333333*epsilon[0]*rdx2Sq[1])-0.09622504486493762*kSq[1]+0.1666666666666667*epsilon[0]*rdx2Sq[0]-0.1111111111111111*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[0], (-0.3333333333333333*epsilon[0]*rdx2Sq[1])+0.09622504486493762*kSq[1]+0.1666666666666667*epsilon[0]*rdx2Sq[0]-0.1111111111111111*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[1], (-0.1666666666666667*epsilon[0]*rdx2Sq[1])-0.1666666666666667*epsilon[0]*rdx2Sq[0]-0.05555555555555555*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[2], 0.1666666666666667*kSq[3]-0.1924500897298752*kSq[2]+0.3333333333333333*epsilon[0]*rdx2Sq[1]+0.1924500897298752*kSq[1]+0.3333333333333333*epsilon[0]*rdx2Sq[0]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[3], (-0.09622504486493762*kSq[2])+0.1666666666666667*epsilon[0]*rdx2Sq[1]-0.3333333333333333*epsilon[0]*rdx2Sq[0]-0.1111111111111111*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[0], (-0.1666666666666667*epsilon[0]*rdx2Sq[1])-0.1666666666666667*epsilon[0]*rdx2Sq[0]-0.05555555555555555*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[1], (-0.3333333333333333*epsilon[0]*rdx2Sq[1])-0.09622504486493762*kSq[1]+0.1666666666666667*epsilon[0]*rdx2Sq[0]-0.1111111111111111*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[2], (-0.09622504486493762*kSq[2])+0.1666666666666667*epsilon[0]*rdx2Sq[1]-0.3333333333333333*epsilon[0]*rdx2Sq[0]-0.1111111111111111*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[3], (-0.1666666666666667*kSq[3])-0.1924500897298752*kSq[2]+0.3333333333333333*epsilon[0]*rdx2Sq[1]-0.1924500897298752*kSq[1]+0.3333333333333333*epsilon[0]*rdx2Sq[0]-0.2222222222222222*kSq[0]);

}
void fem_poisson_lhs_stencil_consteps_2x_ser_p2_lox_periodicx_loy_neumanny(const double *epsilon, const double *kSq, const double *dx, const double *bcVals, const long *globalIdxs, gkyl_mat_triples *tri) 
{ 
  // epsilon: permittivity.
  // kSq: wave number squared (factor multiplying phi).
  // dx: cell length in each direction.
  // bcVals[3]: values to impose as BCs, i.e. bcVals[0]*phi+bcVals[1]*d(phi)/dx=bcVals[2].
  // globalIdxs: global linear index of each basis function/node in current cell.
  // tri: triples object (i,j,val), i.e. contribute val to i,j element of the global matrix.

  double rdx2Sq[2];
  rdx2Sq[0] = 4.0/(dx[0]*dx[0]);
  rdx2Sq[1] = 4.0/(dx[1]*dx[1]);

  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[0], 0.04549218533640458*kSq[7]+0.04549218533640458*kSq[6]-0.0127775312999988*kSq[5]-0.0127775312999988*kSq[4]-0.04666666666666667*kSq[3]+0.03849001794597505*kSq[2]+0.5777777777777777*epsilon[0]*rdx2Sq[1]+0.03849001794597505*kSq[1]+0.5777777777777777*epsilon[0]*rdx2Sq[0]-0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[1], 0.03442651863295482*kSq[7]+0.0295084445425327*kSq[6]-0.05962847939999439*kSq[5]-0.063887656499994*kSq[4]-0.05333333333333333*kSq[3]+0.06666666666666667*epsilon[0]*rdx2Sq[1]+0.03849001794597505*kSq[1]-0.8888888888888888*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[2], (-0.006147592613027645*kSq[6])+0.03336355394999686*kSq[5]+0.02697478829999747*kSq[4]-0.01924500897298752*kSq[2]+0.1888888888888889*epsilon[0]*rdx2Sq[1]+0.3111111111111111*epsilon[0]*rdx2Sq[0]-0.02222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[3], 0.0295084445425327*kSq[7]+0.03442651863295482*kSq[6]-0.063887656499994*kSq[5]-0.05962847939999439*kSq[4]-0.05333333333333333*kSq[3]+0.03849001794597505*kSq[2]-0.8888888888888888*epsilon[0]*rdx2Sq[1]+0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[4], (-0.01721325931647741*kSq[7])-0.05678902799999467*kSq[5]-0.03975231959999626*kSq[4]-0.01333333333333333*kSq[3]-0.4444444444444444*epsilon[0]*rdx2Sq[1]+0.03849001794597505*kSq[1]-0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[5], (-0.006147592613027645*kSq[7])+0.02697478829999747*kSq[5]+0.03336355394999686*kSq[4]+0.3111111111111111*epsilon[0]*rdx2Sq[1]-0.01924500897298752*kSq[1]+0.1888888888888889*epsilon[0]*rdx2Sq[0]-0.02222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[6], (-0.01721325931647741*kSq[6])-0.03975231959999626*kSq[5]-0.05678902799999467*kSq[4]-0.01333333333333333*kSq[3]+0.03849001794597505*kSq[2]-0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.4444444444444444*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[7], 0.0234254740499978*kSq[5]+0.0234254740499978*kSq[4]+0.01333333333333333*kSq[3]+0.2555555555555555*epsilon[0]*rdx2Sq[1]+0.2555555555555555*epsilon[0]*rdx2Sq[0]-0.03333333333333333*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[0], 0.03442651863295482*kSq[7]+0.0295084445425327*kSq[6]-0.05962847939999439*kSq[5]-0.063887656499994*kSq[4]-0.05333333333333333*kSq[3]+0.06666666666666667*epsilon[0]*rdx2Sq[1]+0.03849001794597505*kSq[1]-0.8888888888888888*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[1], (-0.1967229636168847*kSq[6])-0.07950463919999252*kSq[5]+0.2271561119999787*kSq[4]+0.3079201435678004*kSq[2]+0.5333333333333333*epsilon[0]*rdx2Sq[1]+1.777777777777778*epsilon[0]*rdx2Sq[0]-0.3555555555555556*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[2], (-0.03442651863295482*kSq[7])+0.0295084445425327*kSq[6]-0.05962847939999439*kSq[5]-0.063887656499994*kSq[4]+0.05333333333333333*kSq[3]+0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.03849001794597505*kSq[1]-0.8888888888888888*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[3], (-0.03442651863295482*kSq[7])-0.03442651863295482*kSq[6]+0.09938079899999068*kSq[5]+0.09938079899999068*kSq[4]-0.02666666666666666*kSq[3]+0.0769800358919501*kSq[2]+0.0769800358919501*kSq[1]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[4], 0.03442651863295482*kSq[7]-0.03442651863295482*kSq[6]+0.09938079899999068*kSq[5]+0.09938079899999068*kSq[4]+0.02666666666666666*kSq[3]+0.0769800358919501*kSq[2]-0.0769800358919501*kSq[1]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[5], 0.01721325931647741*kSq[6]-0.03975231959999626*kSq[5]-0.05678902799999467*kSq[4]+0.01333333333333333*kSq[3]-0.03849001794597505*kSq[2]-0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.4444444444444444*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[6], 0.07950463919999252*kSq[5]+0.1135780559999893*kSq[4]-0.5333333333333333*epsilon[0]*rdx2Sq[1]+0.8888888888888888*epsilon[0]*rdx2Sq[0]-0.1777777777777778*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[7], 0.01721325931647741*kSq[6]-0.03975231959999626*kSq[5]-0.05678902799999467*kSq[4]-0.01333333333333333*kSq[3]-0.03849001794597505*kSq[2]-0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.4444444444444444*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[0], (-0.006147592613027645*kSq[6])+0.03336355394999686*kSq[5]+0.02697478829999747*kSq[4]-0.01924500897298752*kSq[2]+0.1888888888888889*epsilon[0]*rdx2Sq[1]+0.3111111111111111*epsilon[0]*rdx2Sq[0]-0.02222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[1], (-0.03442651863295482*kSq[7])+0.0295084445425327*kSq[6]-0.05962847939999439*kSq[5]-0.063887656499994*kSq[4]+0.05333333333333333*kSq[3]+0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.03849001794597505*kSq[1]-0.8888888888888888*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[2], (-0.04549218533640458*kSq[7])+0.04549218533640458*kSq[6]-0.0127775312999988*kSq[5]-0.0127775312999988*kSq[4]+0.04666666666666667*kSq[3]+0.03849001794597505*kSq[2]+0.5777777777777777*epsilon[0]*rdx2Sq[1]-0.03849001794597505*kSq[1]+0.5777777777777777*epsilon[0]*rdx2Sq[0]-0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[3], 0.01721325931647741*kSq[7]-0.05678902799999467*kSq[5]-0.03975231959999626*kSq[4]+0.01333333333333333*kSq[3]-0.4444444444444444*epsilon[0]*rdx2Sq[1]-0.03849001794597505*kSq[1]-0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[4], (-0.0295084445425327*kSq[7])+0.03442651863295482*kSq[6]-0.063887656499994*kSq[5]-0.05962847939999439*kSq[4]+0.05333333333333333*kSq[3]+0.03849001794597505*kSq[2]-0.8888888888888888*epsilon[0]*rdx2Sq[1]+0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[5], 0.0234254740499978*kSq[5]+0.0234254740499978*kSq[4]-0.01333333333333333*kSq[3]+0.2555555555555555*epsilon[0]*rdx2Sq[1]+0.2555555555555555*epsilon[0]*rdx2Sq[0]-0.03333333333333333*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[6], (-0.01721325931647741*kSq[6])-0.03975231959999626*kSq[5]-0.05678902799999467*kSq[4]+0.01333333333333333*kSq[3]+0.03849001794597505*kSq[2]-0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.4444444444444444*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[7], 0.006147592613027645*kSq[7]+0.02697478829999747*kSq[5]+0.03336355394999686*kSq[4]+0.3111111111111111*epsilon[0]*rdx2Sq[1]+0.01924500897298752*kSq[1]+0.1888888888888889*epsilon[0]*rdx2Sq[0]-0.02222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[0], 0.0295084445425327*kSq[7]+0.03442651863295482*kSq[6]-0.063887656499994*kSq[5]-0.05962847939999439*kSq[4]-0.05333333333333333*kSq[3]+0.03849001794597505*kSq[2]-0.8888888888888888*epsilon[0]*rdx2Sq[1]+0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[1], (-0.03442651863295482*kSq[7])-0.03442651863295482*kSq[6]+0.09938079899999068*kSq[5]+0.09938079899999068*kSq[4]-0.02666666666666666*kSq[3]+0.0769800358919501*kSq[2]+0.0769800358919501*kSq[1]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[2], 0.01721325931647741*kSq[7]-0.05678902799999467*kSq[5]-0.03975231959999626*kSq[4]+0.01333333333333333*kSq[3]-0.4444444444444444*epsilon[0]*rdx2Sq[1]-0.03849001794597505*kSq[1]-0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[3], (-0.1967229636168847*kSq[7])+0.2271561119999787*kSq[5]-0.07950463919999252*kSq[4]+1.777777777777778*epsilon[0]*rdx2Sq[1]+0.3079201435678004*kSq[1]+0.5333333333333333*epsilon[0]*rdx2Sq[0]-0.3555555555555556*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[4], 0.1135780559999893*kSq[5]+0.07950463919999252*kSq[4]+0.8888888888888888*epsilon[0]*rdx2Sq[1]-0.5333333333333333*epsilon[0]*rdx2Sq[0]-0.1777777777777778*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[5], 0.0295084445425327*kSq[7]-0.03442651863295482*kSq[6]-0.063887656499994*kSq[5]-0.05962847939999439*kSq[4]+0.05333333333333333*kSq[3]-0.03849001794597505*kSq[2]-0.8888888888888888*epsilon[0]*rdx2Sq[1]+0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[6], (-0.03442651863295482*kSq[7])+0.03442651863295482*kSq[6]+0.09938079899999068*kSq[5]+0.09938079899999068*kSq[4]+0.02666666666666666*kSq[3]-0.0769800358919501*kSq[2]+0.0769800358919501*kSq[1]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[7], 0.01721325931647741*kSq[7]-0.05678902799999467*kSq[5]-0.03975231959999626*kSq[4]-0.01333333333333333*kSq[3]-0.4444444444444444*epsilon[0]*rdx2Sq[1]-0.03849001794597505*kSq[1]-0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[4], globalIdxs[0], (-0.01721325931647741*kSq[7])-0.05678902799999467*kSq[5]-0.03975231959999626*kSq[4]-0.01333333333333333*kSq[3]-0.4444444444444444*epsilon[0]*rdx2Sq[1]+0.03849001794597505*kSq[1]-0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[4], globalIdxs[1], 0.03442651863295482*kSq[7]-0.03442651863295482*kSq[6]+0.09938079899999068*kSq[5]+0.09938079899999068*kSq[4]+0.02666666666666666*kSq[3]+0.0769800358919501*kSq[2]-0.0769800358919501*kSq[1]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[4], globalIdxs[2], (-0.0295084445425327*kSq[7])+0.03442651863295482*kSq[6]-0.063887656499994*kSq[5]-0.05962847939999439*kSq[4]+0.05333333333333333*kSq[3]+0.03849001794597505*kSq[2]-0.8888888888888888*epsilon[0]*rdx2Sq[1]+0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[4], globalIdxs[3], 0.1135780559999893*kSq[5]+0.07950463919999252*kSq[4]+0.8888888888888888*epsilon[0]*rdx2Sq[1]-0.5333333333333333*epsilon[0]*rdx2Sq[0]-0.1777777777777778*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[4], globalIdxs[4], 0.1967229636168847*kSq[7]+0.2271561119999787*kSq[5]-0.07950463919999252*kSq[4]+1.777777777777778*epsilon[0]*rdx2Sq[1]-0.3079201435678004*kSq[1]+0.5333333333333333*epsilon[0]*rdx2Sq[0]-0.3555555555555556*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[4], globalIdxs[5], (-0.01721325931647741*kSq[7])-0.05678902799999467*kSq[5]-0.03975231959999626*kSq[4]+0.01333333333333333*kSq[3]-0.4444444444444444*epsilon[0]*rdx2Sq[1]+0.03849001794597505*kSq[1]-0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[4], globalIdxs[6], 0.03442651863295482*kSq[7]+0.03442651863295482*kSq[6]+0.09938079899999068*kSq[5]+0.09938079899999068*kSq[4]-0.02666666666666666*kSq[3]-0.0769800358919501*kSq[2]-0.0769800358919501*kSq[1]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[4], globalIdxs[7], (-0.0295084445425327*kSq[7])-0.03442651863295482*kSq[6]-0.063887656499994*kSq[5]-0.05962847939999439*kSq[4]-0.05333333333333333*kSq[3]-0.03849001794597505*kSq[2]-0.8888888888888888*epsilon[0]*rdx2Sq[1]+0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[5], globalIdxs[0], (-0.006147592613027645*kSq[7])+0.02697478829999747*kSq[5]+0.03336355394999686*kSq[4]+0.3111111111111111*epsilon[0]*rdx2Sq[1]-0.01924500897298752*kSq[1]+0.1888888888888889*epsilon[0]*rdx2Sq[0]-0.02222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[5], globalIdxs[1], 0.01721325931647741*kSq[6]-0.03975231959999626*kSq[5]-0.05678902799999467*kSq[4]+0.01333333333333333*kSq[3]-0.03849001794597505*kSq[2]-0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.4444444444444444*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[5], globalIdxs[2], 0.0234254740499978*kSq[5]+0.0234254740499978*kSq[4]-0.01333333333333333*kSq[3]+0.2555555555555555*epsilon[0]*rdx2Sq[1]+0.2555555555555555*epsilon[0]*rdx2Sq[0]-0.03333333333333333*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[5], globalIdxs[3], 0.0295084445425327*kSq[7]-0.03442651863295482*kSq[6]-0.063887656499994*kSq[5]-0.05962847939999439*kSq[4]+0.05333333333333333*kSq[3]-0.03849001794597505*kSq[2]-0.8888888888888888*epsilon[0]*rdx2Sq[1]+0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[5], globalIdxs[4], (-0.01721325931647741*kSq[7])-0.05678902799999467*kSq[5]-0.03975231959999626*kSq[4]+0.01333333333333333*kSq[3]-0.4444444444444444*epsilon[0]*rdx2Sq[1]+0.03849001794597505*kSq[1]-0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[5], globalIdxs[5], 0.04549218533640458*kSq[7]-0.04549218533640458*kSq[6]-0.0127775312999988*kSq[5]-0.0127775312999988*kSq[4]+0.04666666666666667*kSq[3]-0.03849001794597505*kSq[2]+0.5777777777777777*epsilon[0]*rdx2Sq[1]+0.03849001794597505*kSq[1]+0.5777777777777777*epsilon[0]*rdx2Sq[0]-0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[5], globalIdxs[6], 0.03442651863295482*kSq[7]-0.0295084445425327*kSq[6]-0.05962847939999439*kSq[5]-0.063887656499994*kSq[4]+0.05333333333333333*kSq[3]+0.06666666666666667*epsilon[0]*rdx2Sq[1]+0.03849001794597505*kSq[1]-0.8888888888888888*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[5], globalIdxs[7], 0.006147592613027645*kSq[6]+0.03336355394999686*kSq[5]+0.02697478829999747*kSq[4]+0.01924500897298752*kSq[2]+0.1888888888888889*epsilon[0]*rdx2Sq[1]+0.3111111111111111*epsilon[0]*rdx2Sq[0]-0.02222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[6], globalIdxs[0], (-0.01721325931647741*kSq[6])-0.03975231959999626*kSq[5]-0.05678902799999467*kSq[4]-0.01333333333333333*kSq[3]+0.03849001794597505*kSq[2]-0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.4444444444444444*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[6], globalIdxs[1], 0.07950463919999252*kSq[5]+0.1135780559999893*kSq[4]-0.5333333333333333*epsilon[0]*rdx2Sq[1]+0.8888888888888888*epsilon[0]*rdx2Sq[0]-0.1777777777777778*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[6], globalIdxs[2], (-0.01721325931647741*kSq[6])-0.03975231959999626*kSq[5]-0.05678902799999467*kSq[4]+0.01333333333333333*kSq[3]+0.03849001794597505*kSq[2]-0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.4444444444444444*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[6], globalIdxs[3], (-0.03442651863295482*kSq[7])+0.03442651863295482*kSq[6]+0.09938079899999068*kSq[5]+0.09938079899999068*kSq[4]+0.02666666666666666*kSq[3]-0.0769800358919501*kSq[2]+0.0769800358919501*kSq[1]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[6], globalIdxs[4], 0.03442651863295482*kSq[7]+0.03442651863295482*kSq[6]+0.09938079899999068*kSq[5]+0.09938079899999068*kSq[4]-0.02666666666666666*kSq[3]-0.0769800358919501*kSq[2]-0.0769800358919501*kSq[1]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[6], globalIdxs[5], 0.03442651863295482*kSq[7]-0.0295084445425327*kSq[6]-0.05962847939999439*kSq[5]-0.063887656499994*kSq[4]+0.05333333333333333*kSq[3]+0.06666666666666667*epsilon[0]*rdx2Sq[1]+0.03849001794597505*kSq[1]-0.8888888888888888*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[6], globalIdxs[6], 0.1967229636168847*kSq[6]-0.07950463919999252*kSq[5]+0.2271561119999787*kSq[4]-0.3079201435678004*kSq[2]+0.5333333333333333*epsilon[0]*rdx2Sq[1]+1.777777777777778*epsilon[0]*rdx2Sq[0]-0.3555555555555556*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[6], globalIdxs[7], (-0.03442651863295482*kSq[7])-0.0295084445425327*kSq[6]-0.05962847939999439*kSq[5]-0.063887656499994*kSq[4]-0.05333333333333333*kSq[3]+0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.03849001794597505*kSq[1]-0.8888888888888888*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[7], globalIdxs[0], 0.0234254740499978*kSq[5]+0.0234254740499978*kSq[4]+0.01333333333333333*kSq[3]+0.2555555555555555*epsilon[0]*rdx2Sq[1]+0.2555555555555555*epsilon[0]*rdx2Sq[0]-0.03333333333333333*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[7], globalIdxs[1], 0.01721325931647741*kSq[6]-0.03975231959999626*kSq[5]-0.05678902799999467*kSq[4]-0.01333333333333333*kSq[3]-0.03849001794597505*kSq[2]-0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.4444444444444444*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[7], globalIdxs[2], 0.006147592613027645*kSq[7]+0.02697478829999747*kSq[5]+0.03336355394999686*kSq[4]+0.3111111111111111*epsilon[0]*rdx2Sq[1]+0.01924500897298752*kSq[1]+0.1888888888888889*epsilon[0]*rdx2Sq[0]-0.02222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[7], globalIdxs[3], 0.01721325931647741*kSq[7]-0.05678902799999467*kSq[5]-0.03975231959999626*kSq[4]-0.01333333333333333*kSq[3]-0.4444444444444444*epsilon[0]*rdx2Sq[1]-0.03849001794597505*kSq[1]-0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[7], globalIdxs[4], (-0.0295084445425327*kSq[7])-0.03442651863295482*kSq[6]-0.063887656499994*kSq[5]-0.05962847939999439*kSq[4]-0.05333333333333333*kSq[3]-0.03849001794597505*kSq[2]-0.8888888888888888*epsilon[0]*rdx2Sq[1]+0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[7], globalIdxs[5], 0.006147592613027645*kSq[6]+0.03336355394999686*kSq[5]+0.02697478829999747*kSq[4]+0.01924500897298752*kSq[2]+0.1888888888888889*epsilon[0]*rdx2Sq[1]+0.3111111111111111*epsilon[0]*rdx2Sq[0]-0.02222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[7], globalIdxs[6], (-0.03442651863295482*kSq[7])-0.0295084445425327*kSq[6]-0.05962847939999439*kSq[5]-0.063887656499994*kSq[4]-0.05333333333333333*kSq[3]+0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.03849001794597505*kSq[1]-0.8888888888888888*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[7], globalIdxs[7], (-0.04549218533640458*kSq[7])-0.04549218533640458*kSq[6]-0.0127775312999988*kSq[5]-0.0127775312999988*kSq[4]-0.04666666666666667*kSq[3]-0.03849001794597505*kSq[2]+0.5777777777777777*epsilon[0]*rdx2Sq[1]-0.03849001794597505*kSq[1]+0.5777777777777777*epsilon[0]*rdx2Sq[0]-0.06666666666666667*kSq[0]);

}
void fem_poisson_lhs_stencil_consteps_2x_ser_p1_lox_periodicx_loy_robiny(const double *epsilon, const double *kSq, const double *dx, const double *bcVals, const long *globalIdxs, gkyl_mat_triples *tri) 
{ 
  // epsilon: permittivity.
  // kSq: wave number squared (factor multiplying phi).
  // dx: cell length in each direction.
  // bcVals[3]: values to impose as BCs, i.e. bcVals[0]*phi+bcVals[1]*d(phi)/dx=bcVals[2].
  // globalIdxs: global linear index of each basis function/node in current cell.
  // tri: triples object (i,j,val), i.e. contribute val to i,j element of the global matrix.

  double rdx2Sq[2];
  rdx2Sq[0] = 4.0/(dx[0]*dx[0]);
  rdx2Sq[1] = 4.0/(dx[1]*dx[1]);

  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[0], (-(0.6666666666666666*epsilon[0]*rdx2Sq[1]*bcVals[6])/bcVals[7])-0.1666666666666667*kSq[3]+0.1924500897298752*kSq[2]+0.3333333333333333*epsilon[0]*rdx2Sq[1]+0.1924500897298752*kSq[1]+0.3333333333333333*epsilon[0]*rdx2Sq[0]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[1], (-(0.3333333333333333*epsilon[0]*rdx2Sq[1]*bcVals[6])/bcVals[7])+0.09622504486493762*kSq[2]+0.1666666666666667*epsilon[0]*rdx2Sq[1]-0.3333333333333333*epsilon[0]*rdx2Sq[0]-0.1111111111111111*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[2], (-0.3333333333333333*epsilon[0]*rdx2Sq[1])+0.09622504486493762*kSq[1]+0.1666666666666667*epsilon[0]*rdx2Sq[0]-0.1111111111111111*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[3], (-0.1666666666666667*epsilon[0]*rdx2Sq[1])-0.1666666666666667*epsilon[0]*rdx2Sq[0]-0.05555555555555555*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[0], (-(0.3333333333333333*epsilon[0]*rdx2Sq[1]*bcVals[6])/bcVals[7])+0.09622504486493762*kSq[2]+0.1666666666666667*epsilon[0]*rdx2Sq[1]-0.3333333333333333*epsilon[0]*rdx2Sq[0]-0.1111111111111111*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[1], (-(0.6666666666666666*epsilon[0]*rdx2Sq[1]*bcVals[6])/bcVals[7])+0.1666666666666667*kSq[3]+0.1924500897298752*kSq[2]+0.3333333333333333*epsilon[0]*rdx2Sq[1]-0.1924500897298752*kSq[1]+0.3333333333333333*epsilon[0]*rdx2Sq[0]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[2], (-0.1666666666666667*epsilon[0]*rdx2Sq[1])-0.1666666666666667*epsilon[0]*rdx2Sq[0]-0.05555555555555555*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[3], (-0.3333333333333333*epsilon[0]*rdx2Sq[1])-0.09622504486493762*kSq[1]+0.1666666666666667*epsilon[0]*rdx2Sq[0]-0.1111111111111111*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[0], (-0.3333333333333333*epsilon[0]*rdx2Sq[1])+0.09622504486493762*kSq[1]+0.1666666666666667*epsilon[0]*rdx2Sq[0]-0.1111111111111111*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[1], (-0.1666666666666667*epsilon[0]*rdx2Sq[1])-0.1666666666666667*epsilon[0]*rdx2Sq[0]-0.05555555555555555*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[2], 0.1666666666666667*kSq[3]-0.1924500897298752*kSq[2]+0.3333333333333333*epsilon[0]*rdx2Sq[1]+0.1924500897298752*kSq[1]+0.3333333333333333*epsilon[0]*rdx2Sq[0]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[3], (-0.09622504486493762*kSq[2])+0.1666666666666667*epsilon[0]*rdx2Sq[1]-0.3333333333333333*epsilon[0]*rdx2Sq[0]-0.1111111111111111*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[0], (-0.1666666666666667*epsilon[0]*rdx2Sq[1])-0.1666666666666667*epsilon[0]*rdx2Sq[0]-0.05555555555555555*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[1], (-0.3333333333333333*epsilon[0]*rdx2Sq[1])-0.09622504486493762*kSq[1]+0.1666666666666667*epsilon[0]*rdx2Sq[0]-0.1111111111111111*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[2], (-0.09622504486493762*kSq[2])+0.1666666666666667*epsilon[0]*rdx2Sq[1]-0.3333333333333333*epsilon[0]*rdx2Sq[0]-0.1111111111111111*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[3], (-0.1666666666666667*kSq[3])-0.1924500897298752*kSq[2]+0.3333333333333333*epsilon[0]*rdx2Sq[1]-0.1924500897298752*kSq[1]+0.3333333333333333*epsilon[0]*rdx2Sq[0]-0.2222222222222222*kSq[0]);

}
void fem_poisson_lhs_stencil_consteps_2x_ser_p2_lox_periodicx_loy_robiny(const double *epsilon, const double *kSq, const double *dx, const double *bcVals, const long *globalIdxs, gkyl_mat_triples *tri) 
{ 
  // epsilon: permittivity.
  // kSq: wave number squared (factor multiplying phi).
  // dx: cell length in each direction.
  // bcVals[3]: values to impose as BCs, i.e. bcVals[0]*phi+bcVals[1]*d(phi)/dx=bcVals[2].
  // globalIdxs: global linear index of each basis function/node in current cell.
  // tri: triples object (i,j,val), i.e. contribute val to i,j element of the global matrix.

  double rdx2Sq[2];
  rdx2Sq[0] = 4.0/(dx[0]*dx[0]);
  rdx2Sq[1] = 4.0/(dx[1]*dx[1]);

  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[0], 0.04549218533640458*kSq[7]-(0.2666666666666667*epsilon[0]*rdx2Sq[1]*bcVals[6])/bcVals[7]+0.04549218533640458*kSq[6]-0.0127775312999988*kSq[5]-0.0127775312999988*kSq[4]-0.04666666666666667*kSq[3]+0.03849001794597505*kSq[2]+0.5777777777777777*epsilon[0]*rdx2Sq[1]+0.03849001794597505*kSq[1]+0.5777777777777777*epsilon[0]*rdx2Sq[0]-0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[1], 0.03442651863295482*kSq[7]-(0.1333333333333333*epsilon[0]*rdx2Sq[1]*bcVals[6])/bcVals[7]+0.0295084445425327*kSq[6]-0.05962847939999439*kSq[5]-0.063887656499994*kSq[4]-0.05333333333333333*kSq[3]+0.06666666666666667*epsilon[0]*rdx2Sq[1]+0.03849001794597505*kSq[1]-0.8888888888888888*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[2], (0.06666666666666667*epsilon[0]*rdx2Sq[1]*bcVals[6])/bcVals[7]-0.006147592613027645*kSq[6]+0.03336355394999686*kSq[5]+0.02697478829999747*kSq[4]-0.01924500897298752*kSq[2]+0.1888888888888889*epsilon[0]*rdx2Sq[1]+0.3111111111111111*epsilon[0]*rdx2Sq[0]-0.02222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[3], 0.0295084445425327*kSq[7]+0.03442651863295482*kSq[6]-0.063887656499994*kSq[5]-0.05962847939999439*kSq[4]-0.05333333333333333*kSq[3]+0.03849001794597505*kSq[2]-0.8888888888888888*epsilon[0]*rdx2Sq[1]+0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[4], (-0.01721325931647741*kSq[7])-0.05678902799999467*kSq[5]-0.03975231959999626*kSq[4]-0.01333333333333333*kSq[3]-0.4444444444444444*epsilon[0]*rdx2Sq[1]+0.03849001794597505*kSq[1]-0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[5], (-0.006147592613027645*kSq[7])+0.02697478829999747*kSq[5]+0.03336355394999686*kSq[4]+0.3111111111111111*epsilon[0]*rdx2Sq[1]-0.01924500897298752*kSq[1]+0.1888888888888889*epsilon[0]*rdx2Sq[0]-0.02222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[6], (-0.01721325931647741*kSq[6])-0.03975231959999626*kSq[5]-0.05678902799999467*kSq[4]-0.01333333333333333*kSq[3]+0.03849001794597505*kSq[2]-0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.4444444444444444*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[7], 0.0234254740499978*kSq[5]+0.0234254740499978*kSq[4]+0.01333333333333333*kSq[3]+0.2555555555555555*epsilon[0]*rdx2Sq[1]+0.2555555555555555*epsilon[0]*rdx2Sq[0]-0.03333333333333333*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[0], 0.03442651863295482*kSq[7]-(0.1333333333333333*epsilon[0]*rdx2Sq[1]*bcVals[6])/bcVals[7]+0.0295084445425327*kSq[6]-0.05962847939999439*kSq[5]-0.063887656499994*kSq[4]-0.05333333333333333*kSq[3]+0.06666666666666667*epsilon[0]*rdx2Sq[1]+0.03849001794597505*kSq[1]-0.8888888888888888*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[1], (-(1.066666666666667*epsilon[0]*rdx2Sq[1]*bcVals[6])/bcVals[7])-0.1967229636168847*kSq[6]-0.07950463919999252*kSq[5]+0.2271561119999787*kSq[4]+0.3079201435678004*kSq[2]+0.5333333333333333*epsilon[0]*rdx2Sq[1]+1.777777777777778*epsilon[0]*rdx2Sq[0]-0.3555555555555556*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[2], (-0.03442651863295482*kSq[7])-(0.1333333333333333*epsilon[0]*rdx2Sq[1]*bcVals[6])/bcVals[7]+0.0295084445425327*kSq[6]-0.05962847939999439*kSq[5]-0.063887656499994*kSq[4]+0.05333333333333333*kSq[3]+0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.03849001794597505*kSq[1]-0.8888888888888888*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[3], (-0.03442651863295482*kSq[7])-0.03442651863295482*kSq[6]+0.09938079899999068*kSq[5]+0.09938079899999068*kSq[4]-0.02666666666666666*kSq[3]+0.0769800358919501*kSq[2]+0.0769800358919501*kSq[1]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[4], 0.03442651863295482*kSq[7]-0.03442651863295482*kSq[6]+0.09938079899999068*kSq[5]+0.09938079899999068*kSq[4]+0.02666666666666666*kSq[3]+0.0769800358919501*kSq[2]-0.0769800358919501*kSq[1]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[5], 0.01721325931647741*kSq[6]-0.03975231959999626*kSq[5]-0.05678902799999467*kSq[4]+0.01333333333333333*kSq[3]-0.03849001794597505*kSq[2]-0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.4444444444444444*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[6], 0.07950463919999252*kSq[5]+0.1135780559999893*kSq[4]-0.5333333333333333*epsilon[0]*rdx2Sq[1]+0.8888888888888888*epsilon[0]*rdx2Sq[0]-0.1777777777777778*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[7], 0.01721325931647741*kSq[6]-0.03975231959999626*kSq[5]-0.05678902799999467*kSq[4]-0.01333333333333333*kSq[3]-0.03849001794597505*kSq[2]-0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.4444444444444444*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[0], (0.06666666666666667*epsilon[0]*rdx2Sq[1]*bcVals[6])/bcVals[7]-0.006147592613027645*kSq[6]+0.03336355394999686*kSq[5]+0.02697478829999747*kSq[4]-0.01924500897298752*kSq[2]+0.1888888888888889*epsilon[0]*rdx2Sq[1]+0.3111111111111111*epsilon[0]*rdx2Sq[0]-0.02222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[1], (-0.03442651863295482*kSq[7])-(0.1333333333333333*epsilon[0]*rdx2Sq[1]*bcVals[6])/bcVals[7]+0.0295084445425327*kSq[6]-0.05962847939999439*kSq[5]-0.063887656499994*kSq[4]+0.05333333333333333*kSq[3]+0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.03849001794597505*kSq[1]-0.8888888888888888*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[2], (-0.04549218533640458*kSq[7])-(0.2666666666666667*epsilon[0]*rdx2Sq[1]*bcVals[6])/bcVals[7]+0.04549218533640458*kSq[6]-0.0127775312999988*kSq[5]-0.0127775312999988*kSq[4]+0.04666666666666667*kSq[3]+0.03849001794597505*kSq[2]+0.5777777777777777*epsilon[0]*rdx2Sq[1]-0.03849001794597505*kSq[1]+0.5777777777777777*epsilon[0]*rdx2Sq[0]-0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[3], 0.01721325931647741*kSq[7]-0.05678902799999467*kSq[5]-0.03975231959999626*kSq[4]+0.01333333333333333*kSq[3]-0.4444444444444444*epsilon[0]*rdx2Sq[1]-0.03849001794597505*kSq[1]-0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[4], (-0.0295084445425327*kSq[7])+0.03442651863295482*kSq[6]-0.063887656499994*kSq[5]-0.05962847939999439*kSq[4]+0.05333333333333333*kSq[3]+0.03849001794597505*kSq[2]-0.8888888888888888*epsilon[0]*rdx2Sq[1]+0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[5], 0.0234254740499978*kSq[5]+0.0234254740499978*kSq[4]-0.01333333333333333*kSq[3]+0.2555555555555555*epsilon[0]*rdx2Sq[1]+0.2555555555555555*epsilon[0]*rdx2Sq[0]-0.03333333333333333*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[6], (-0.01721325931647741*kSq[6])-0.03975231959999626*kSq[5]-0.05678902799999467*kSq[4]+0.01333333333333333*kSq[3]+0.03849001794597505*kSq[2]-0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.4444444444444444*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[7], 0.006147592613027645*kSq[7]+0.02697478829999747*kSq[5]+0.03336355394999686*kSq[4]+0.3111111111111111*epsilon[0]*rdx2Sq[1]+0.01924500897298752*kSq[1]+0.1888888888888889*epsilon[0]*rdx2Sq[0]-0.02222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[0], 0.0295084445425327*kSq[7]+0.03442651863295482*kSq[6]-0.063887656499994*kSq[5]-0.05962847939999439*kSq[4]-0.05333333333333333*kSq[3]+0.03849001794597505*kSq[2]-0.8888888888888888*epsilon[0]*rdx2Sq[1]+0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[1], (-0.03442651863295482*kSq[7])-0.03442651863295482*kSq[6]+0.09938079899999068*kSq[5]+0.09938079899999068*kSq[4]-0.02666666666666666*kSq[3]+0.0769800358919501*kSq[2]+0.0769800358919501*kSq[1]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[2], 0.01721325931647741*kSq[7]-0.05678902799999467*kSq[5]-0.03975231959999626*kSq[4]+0.01333333333333333*kSq[3]-0.4444444444444444*epsilon[0]*rdx2Sq[1]-0.03849001794597505*kSq[1]-0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[3], (-0.1967229636168847*kSq[7])+0.2271561119999787*kSq[5]-0.07950463919999252*kSq[4]+1.777777777777778*epsilon[0]*rdx2Sq[1]+0.3079201435678004*kSq[1]+0.5333333333333333*epsilon[0]*rdx2Sq[0]-0.3555555555555556*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[4], 0.1135780559999893*kSq[5]+0.07950463919999252*kSq[4]+0.8888888888888888*epsilon[0]*rdx2Sq[1]-0.5333333333333333*epsilon[0]*rdx2Sq[0]-0.1777777777777778*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[5], 0.0295084445425327*kSq[7]-0.03442651863295482*kSq[6]-0.063887656499994*kSq[5]-0.05962847939999439*kSq[4]+0.05333333333333333*kSq[3]-0.03849001794597505*kSq[2]-0.8888888888888888*epsilon[0]*rdx2Sq[1]+0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[6], (-0.03442651863295482*kSq[7])+0.03442651863295482*kSq[6]+0.09938079899999068*kSq[5]+0.09938079899999068*kSq[4]+0.02666666666666666*kSq[3]-0.0769800358919501*kSq[2]+0.0769800358919501*kSq[1]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[7], 0.01721325931647741*kSq[7]-0.05678902799999467*kSq[5]-0.03975231959999626*kSq[4]-0.01333333333333333*kSq[3]-0.4444444444444444*epsilon[0]*rdx2Sq[1]-0.03849001794597505*kSq[1]-0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[4], globalIdxs[0], (-0.01721325931647741*kSq[7])-0.05678902799999467*kSq[5]-0.03975231959999626*kSq[4]-0.01333333333333333*kSq[3]-0.4444444444444444*epsilon[0]*rdx2Sq[1]+0.03849001794597505*kSq[1]-0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[4], globalIdxs[1], 0.03442651863295482*kSq[7]-0.03442651863295482*kSq[6]+0.09938079899999068*kSq[5]+0.09938079899999068*kSq[4]+0.02666666666666666*kSq[3]+0.0769800358919501*kSq[2]-0.0769800358919501*kSq[1]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[4], globalIdxs[2], (-0.0295084445425327*kSq[7])+0.03442651863295482*kSq[6]-0.063887656499994*kSq[5]-0.05962847939999439*kSq[4]+0.05333333333333333*kSq[3]+0.03849001794597505*kSq[2]-0.8888888888888888*epsilon[0]*rdx2Sq[1]+0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[4], globalIdxs[3], 0.1135780559999893*kSq[5]+0.07950463919999252*kSq[4]+0.8888888888888888*epsilon[0]*rdx2Sq[1]-0.5333333333333333*epsilon[0]*rdx2Sq[0]-0.1777777777777778*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[4], globalIdxs[4], 0.1967229636168847*kSq[7]+0.2271561119999787*kSq[5]-0.07950463919999252*kSq[4]+1.777777777777778*epsilon[0]*rdx2Sq[1]-0.3079201435678004*kSq[1]+0.5333333333333333*epsilon[0]*rdx2Sq[0]-0.3555555555555556*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[4], globalIdxs[5], (-0.01721325931647741*kSq[7])-0.05678902799999467*kSq[5]-0.03975231959999626*kSq[4]+0.01333333333333333*kSq[3]-0.4444444444444444*epsilon[0]*rdx2Sq[1]+0.03849001794597505*kSq[1]-0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[4], globalIdxs[6], 0.03442651863295482*kSq[7]+0.03442651863295482*kSq[6]+0.09938079899999068*kSq[5]+0.09938079899999068*kSq[4]-0.02666666666666666*kSq[3]-0.0769800358919501*kSq[2]-0.0769800358919501*kSq[1]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[4], globalIdxs[7], (-0.0295084445425327*kSq[7])-0.03442651863295482*kSq[6]-0.063887656499994*kSq[5]-0.05962847939999439*kSq[4]-0.05333333333333333*kSq[3]-0.03849001794597505*kSq[2]-0.8888888888888888*epsilon[0]*rdx2Sq[1]+0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[5], globalIdxs[0], (-0.006147592613027645*kSq[7])+0.02697478829999747*kSq[5]+0.03336355394999686*kSq[4]+0.3111111111111111*epsilon[0]*rdx2Sq[1]-0.01924500897298752*kSq[1]+0.1888888888888889*epsilon[0]*rdx2Sq[0]-0.02222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[5], globalIdxs[1], 0.01721325931647741*kSq[6]-0.03975231959999626*kSq[5]-0.05678902799999467*kSq[4]+0.01333333333333333*kSq[3]-0.03849001794597505*kSq[2]-0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.4444444444444444*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[5], globalIdxs[2], 0.0234254740499978*kSq[5]+0.0234254740499978*kSq[4]-0.01333333333333333*kSq[3]+0.2555555555555555*epsilon[0]*rdx2Sq[1]+0.2555555555555555*epsilon[0]*rdx2Sq[0]-0.03333333333333333*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[5], globalIdxs[3], 0.0295084445425327*kSq[7]-0.03442651863295482*kSq[6]-0.063887656499994*kSq[5]-0.05962847939999439*kSq[4]+0.05333333333333333*kSq[3]-0.03849001794597505*kSq[2]-0.8888888888888888*epsilon[0]*rdx2Sq[1]+0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[5], globalIdxs[4], (-0.01721325931647741*kSq[7])-0.05678902799999467*kSq[5]-0.03975231959999626*kSq[4]+0.01333333333333333*kSq[3]-0.4444444444444444*epsilon[0]*rdx2Sq[1]+0.03849001794597505*kSq[1]-0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[5], globalIdxs[5], 0.04549218533640458*kSq[7]-0.04549218533640458*kSq[6]-0.0127775312999988*kSq[5]-0.0127775312999988*kSq[4]+0.04666666666666667*kSq[3]-0.03849001794597505*kSq[2]+0.5777777777777777*epsilon[0]*rdx2Sq[1]+0.03849001794597505*kSq[1]+0.5777777777777777*epsilon[0]*rdx2Sq[0]-0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[5], globalIdxs[6], 0.03442651863295482*kSq[7]-0.0295084445425327*kSq[6]-0.05962847939999439*kSq[5]-0.063887656499994*kSq[4]+0.05333333333333333*kSq[3]+0.06666666666666667*epsilon[0]*rdx2Sq[1]+0.03849001794597505*kSq[1]-0.8888888888888888*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[5], globalIdxs[7], 0.006147592613027645*kSq[6]+0.03336355394999686*kSq[5]+0.02697478829999747*kSq[4]+0.01924500897298752*kSq[2]+0.1888888888888889*epsilon[0]*rdx2Sq[1]+0.3111111111111111*epsilon[0]*rdx2Sq[0]-0.02222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[6], globalIdxs[0], (-0.01721325931647741*kSq[6])-0.03975231959999626*kSq[5]-0.05678902799999467*kSq[4]-0.01333333333333333*kSq[3]+0.03849001794597505*kSq[2]-0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.4444444444444444*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[6], globalIdxs[1], 0.07950463919999252*kSq[5]+0.1135780559999893*kSq[4]-0.5333333333333333*epsilon[0]*rdx2Sq[1]+0.8888888888888888*epsilon[0]*rdx2Sq[0]-0.1777777777777778*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[6], globalIdxs[2], (-0.01721325931647741*kSq[6])-0.03975231959999626*kSq[5]-0.05678902799999467*kSq[4]+0.01333333333333333*kSq[3]+0.03849001794597505*kSq[2]-0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.4444444444444444*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[6], globalIdxs[3], (-0.03442651863295482*kSq[7])+0.03442651863295482*kSq[6]+0.09938079899999068*kSq[5]+0.09938079899999068*kSq[4]+0.02666666666666666*kSq[3]-0.0769800358919501*kSq[2]+0.0769800358919501*kSq[1]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[6], globalIdxs[4], 0.03442651863295482*kSq[7]+0.03442651863295482*kSq[6]+0.09938079899999068*kSq[5]+0.09938079899999068*kSq[4]-0.02666666666666666*kSq[3]-0.0769800358919501*kSq[2]-0.0769800358919501*kSq[1]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[6], globalIdxs[5], 0.03442651863295482*kSq[7]-0.0295084445425327*kSq[6]-0.05962847939999439*kSq[5]-0.063887656499994*kSq[4]+0.05333333333333333*kSq[3]+0.06666666666666667*epsilon[0]*rdx2Sq[1]+0.03849001794597505*kSq[1]-0.8888888888888888*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[6], globalIdxs[6], 0.1967229636168847*kSq[6]-0.07950463919999252*kSq[5]+0.2271561119999787*kSq[4]-0.3079201435678004*kSq[2]+0.5333333333333333*epsilon[0]*rdx2Sq[1]+1.777777777777778*epsilon[0]*rdx2Sq[0]-0.3555555555555556*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[6], globalIdxs[7], (-0.03442651863295482*kSq[7])-0.0295084445425327*kSq[6]-0.05962847939999439*kSq[5]-0.063887656499994*kSq[4]-0.05333333333333333*kSq[3]+0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.03849001794597505*kSq[1]-0.8888888888888888*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[7], globalIdxs[0], 0.0234254740499978*kSq[5]+0.0234254740499978*kSq[4]+0.01333333333333333*kSq[3]+0.2555555555555555*epsilon[0]*rdx2Sq[1]+0.2555555555555555*epsilon[0]*rdx2Sq[0]-0.03333333333333333*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[7], globalIdxs[1], 0.01721325931647741*kSq[6]-0.03975231959999626*kSq[5]-0.05678902799999467*kSq[4]-0.01333333333333333*kSq[3]-0.03849001794597505*kSq[2]-0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.4444444444444444*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[7], globalIdxs[2], 0.006147592613027645*kSq[7]+0.02697478829999747*kSq[5]+0.03336355394999686*kSq[4]+0.3111111111111111*epsilon[0]*rdx2Sq[1]+0.01924500897298752*kSq[1]+0.1888888888888889*epsilon[0]*rdx2Sq[0]-0.02222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[7], globalIdxs[3], 0.01721325931647741*kSq[7]-0.05678902799999467*kSq[5]-0.03975231959999626*kSq[4]-0.01333333333333333*kSq[3]-0.4444444444444444*epsilon[0]*rdx2Sq[1]-0.03849001794597505*kSq[1]-0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[7], globalIdxs[4], (-0.0295084445425327*kSq[7])-0.03442651863295482*kSq[6]-0.063887656499994*kSq[5]-0.05962847939999439*kSq[4]-0.05333333333333333*kSq[3]-0.03849001794597505*kSq[2]-0.8888888888888888*epsilon[0]*rdx2Sq[1]+0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[7], globalIdxs[5], 0.006147592613027645*kSq[6]+0.03336355394999686*kSq[5]+0.02697478829999747*kSq[4]+0.01924500897298752*kSq[2]+0.1888888888888889*epsilon[0]*rdx2Sq[1]+0.3111111111111111*epsilon[0]*rdx2Sq[0]-0.02222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[7], globalIdxs[6], (-0.03442651863295482*kSq[7])-0.0295084445425327*kSq[6]-0.05962847939999439*kSq[5]-0.063887656499994*kSq[4]-0.05333333333333333*kSq[3]+0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.03849001794597505*kSq[1]-0.8888888888888888*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[7], globalIdxs[7], (-0.04549218533640458*kSq[7])-0.04549218533640458*kSq[6]-0.0127775312999988*kSq[5]-0.0127775312999988*kSq[4]-0.04666666666666667*kSq[3]-0.03849001794597505*kSq[2]+0.5777777777777777*epsilon[0]*rdx2Sq[1]-0.03849001794597505*kSq[1]+0.5777777777777777*epsilon[0]*rdx2Sq[0]-0.06666666666666667*kSq[0]);

}
void fem_poisson_lhs_stencil_consteps_2x_ser_p1_lox_dirichletx_loy_periodicy(const double *epsilon, const double *kSq, const double *dx, const double *bcVals, const long *globalIdxs, gkyl_mat_triples *tri) 
{ 
  // epsilon: permittivity.
  // kSq: wave number squared (factor multiplying phi).
  // dx: cell length in each direction.
  // bcVals[3]: values to impose as BCs, i.e. bcVals[0]*phi+bcVals[1]*d(phi)/dx=bcVals[2].
  // globalIdxs: global linear index of each basis function/node in current cell.
  // tri: triples object (i,j,val), i.e. contribute val to i,j element of the global matrix.

  double rdx2Sq[2];
  rdx2Sq[0] = 4.0/(dx[0]*dx[0]);
  rdx2Sq[1] = 4.0/(dx[1]*dx[1]);

  gkyl_mat_triples_insert(tri, globalIdxs[0], globalIdxs[0], 1.0);
  gkyl_mat_triples_insert(tri, globalIdxs[0], globalIdxs[1], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[0], globalIdxs[2], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[0], globalIdxs[3], 0.0);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[0], 0.09622504486493762*kSq[2]+0.1666666666666667*epsilon[0]*rdx2Sq[1]-0.3333333333333333*epsilon[0]*rdx2Sq[0]-0.1111111111111111*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[1], 0.1666666666666667*kSq[3]+0.1924500897298752*kSq[2]+0.3333333333333333*epsilon[0]*rdx2Sq[1]-0.1924500897298752*kSq[1]+0.3333333333333333*epsilon[0]*rdx2Sq[0]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[2], (-0.1666666666666667*epsilon[0]*rdx2Sq[1])-0.1666666666666667*epsilon[0]*rdx2Sq[0]-0.05555555555555555*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[3], (-0.3333333333333333*epsilon[0]*rdx2Sq[1])-0.09622504486493762*kSq[1]+0.1666666666666667*epsilon[0]*rdx2Sq[0]-0.1111111111111111*kSq[0]);
  gkyl_mat_triples_insert(tri, globalIdxs[2], globalIdxs[0], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[2], globalIdxs[1], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[2], globalIdxs[2], 1.0);
  gkyl_mat_triples_insert(tri, globalIdxs[2], globalIdxs[3], 0.0);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[0], (-0.1666666666666667*epsilon[0]*rdx2Sq[1])-0.1666666666666667*epsilon[0]*rdx2Sq[0]-0.05555555555555555*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[1], (-0.3333333333333333*epsilon[0]*rdx2Sq[1])-0.09622504486493762*kSq[1]+0.1666666666666667*epsilon[0]*rdx2Sq[0]-0.1111111111111111*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[2], (-0.09622504486493762*kSq[2])+0.1666666666666667*epsilon[0]*rdx2Sq[1]-0.3333333333333333*epsilon[0]*rdx2Sq[0]-0.1111111111111111*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[3], (-0.1666666666666667*kSq[3])-0.1924500897298752*kSq[2]+0.3333333333333333*epsilon[0]*rdx2Sq[1]-0.1924500897298752*kSq[1]+0.3333333333333333*epsilon[0]*rdx2Sq[0]-0.2222222222222222*kSq[0]);

}
void fem_poisson_lhs_stencil_consteps_2x_ser_p2_lox_dirichletx_loy_periodicy(const double *epsilon, const double *kSq, const double *dx, const double *bcVals, const long *globalIdxs, gkyl_mat_triples *tri) 
{ 
  // epsilon: permittivity.
  // kSq: wave number squared (factor multiplying phi).
  // dx: cell length in each direction.
  // bcVals[3]: values to impose as BCs, i.e. bcVals[0]*phi+bcVals[1]*d(phi)/dx=bcVals[2].
  // globalIdxs: global linear index of each basis function/node in current cell.
  // tri: triples object (i,j,val), i.e. contribute val to i,j element of the global matrix.

  double rdx2Sq[2];
  rdx2Sq[0] = 4.0/(dx[0]*dx[0]);
  rdx2Sq[1] = 4.0/(dx[1]*dx[1]);

  gkyl_mat_triples_insert(tri, globalIdxs[0], globalIdxs[0], 1.0);
  gkyl_mat_triples_insert(tri, globalIdxs[0], globalIdxs[1], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[0], globalIdxs[2], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[0], globalIdxs[3], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[0], globalIdxs[4], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[0], globalIdxs[5], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[0], globalIdxs[6], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[0], globalIdxs[7], 0.0);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[0], 0.03442651863295482*kSq[7]+0.0295084445425327*kSq[6]-0.05962847939999439*kSq[5]-0.063887656499994*kSq[4]-0.05333333333333333*kSq[3]+0.06666666666666667*epsilon[0]*rdx2Sq[1]+0.03849001794597505*kSq[1]-0.8888888888888888*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[1], (-0.1967229636168847*kSq[6])-0.07950463919999252*kSq[5]+0.2271561119999787*kSq[4]+0.3079201435678004*kSq[2]+0.5333333333333333*epsilon[0]*rdx2Sq[1]+1.777777777777778*epsilon[0]*rdx2Sq[0]-0.3555555555555556*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[2], (-0.03442651863295482*kSq[7])+0.0295084445425327*kSq[6]-0.05962847939999439*kSq[5]-0.063887656499994*kSq[4]+0.05333333333333333*kSq[3]+0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.03849001794597505*kSq[1]-0.8888888888888888*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[3], (-0.03442651863295482*kSq[7])-0.03442651863295482*kSq[6]+0.09938079899999068*kSq[5]+0.09938079899999068*kSq[4]-0.02666666666666666*kSq[3]+0.0769800358919501*kSq[2]+0.0769800358919501*kSq[1]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[4], 0.03442651863295482*kSq[7]-0.03442651863295482*kSq[6]+0.09938079899999068*kSq[5]+0.09938079899999068*kSq[4]+0.02666666666666666*kSq[3]+0.0769800358919501*kSq[2]-0.0769800358919501*kSq[1]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[5], 0.01721325931647741*kSq[6]-0.03975231959999626*kSq[5]-0.05678902799999467*kSq[4]+0.01333333333333333*kSq[3]-0.03849001794597505*kSq[2]-0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.4444444444444444*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[6], 0.07950463919999252*kSq[5]+0.1135780559999893*kSq[4]-0.5333333333333333*epsilon[0]*rdx2Sq[1]+0.8888888888888888*epsilon[0]*rdx2Sq[0]-0.1777777777777778*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[7], 0.01721325931647741*kSq[6]-0.03975231959999626*kSq[5]-0.05678902799999467*kSq[4]-0.01333333333333333*kSq[3]-0.03849001794597505*kSq[2]-0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.4444444444444444*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[0], (-0.006147592613027645*kSq[6])+0.03336355394999686*kSq[5]+0.02697478829999747*kSq[4]-0.01924500897298752*kSq[2]+0.1888888888888889*epsilon[0]*rdx2Sq[1]+0.3111111111111111*epsilon[0]*rdx2Sq[0]-0.02222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[1], (-0.03442651863295482*kSq[7])+0.0295084445425327*kSq[6]-0.05962847939999439*kSq[5]-0.063887656499994*kSq[4]+0.05333333333333333*kSq[3]+0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.03849001794597505*kSq[1]-0.8888888888888888*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[2], (-0.04549218533640458*kSq[7])+0.04549218533640458*kSq[6]-0.0127775312999988*kSq[5]-0.0127775312999988*kSq[4]+0.04666666666666667*kSq[3]+0.03849001794597505*kSq[2]+0.5777777777777777*epsilon[0]*rdx2Sq[1]-0.03849001794597505*kSq[1]+0.5777777777777777*epsilon[0]*rdx2Sq[0]-0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[3], 0.01721325931647741*kSq[7]-0.05678902799999467*kSq[5]-0.03975231959999626*kSq[4]+0.01333333333333333*kSq[3]-0.4444444444444444*epsilon[0]*rdx2Sq[1]-0.03849001794597505*kSq[1]-0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[4], (-0.0295084445425327*kSq[7])+0.03442651863295482*kSq[6]-0.063887656499994*kSq[5]-0.05962847939999439*kSq[4]+0.05333333333333333*kSq[3]+0.03849001794597505*kSq[2]-0.8888888888888888*epsilon[0]*rdx2Sq[1]+0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[5], 0.0234254740499978*kSq[5]+0.0234254740499978*kSq[4]-0.01333333333333333*kSq[3]+0.2555555555555555*epsilon[0]*rdx2Sq[1]+0.2555555555555555*epsilon[0]*rdx2Sq[0]-0.03333333333333333*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[6], (-0.01721325931647741*kSq[6])-0.03975231959999626*kSq[5]-0.05678902799999467*kSq[4]+0.01333333333333333*kSq[3]+0.03849001794597505*kSq[2]-0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.4444444444444444*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[7], 0.006147592613027645*kSq[7]+0.02697478829999747*kSq[5]+0.03336355394999686*kSq[4]+0.3111111111111111*epsilon[0]*rdx2Sq[1]+0.01924500897298752*kSq[1]+0.1888888888888889*epsilon[0]*rdx2Sq[0]-0.02222222222222222*kSq[0]);
  gkyl_mat_triples_insert(tri, globalIdxs[3], globalIdxs[0], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[3], globalIdxs[1], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[3], globalIdxs[2], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[3], globalIdxs[3], 1.0);
  gkyl_mat_triples_insert(tri, globalIdxs[3], globalIdxs[4], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[3], globalIdxs[5], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[3], globalIdxs[6], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[3], globalIdxs[7], 0.0);
  gkyl_mat_triples_accum(tri, globalIdxs[4], globalIdxs[0], (-0.01721325931647741*kSq[7])-0.05678902799999467*kSq[5]-0.03975231959999626*kSq[4]-0.01333333333333333*kSq[3]-0.4444444444444444*epsilon[0]*rdx2Sq[1]+0.03849001794597505*kSq[1]-0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[4], globalIdxs[1], 0.03442651863295482*kSq[7]-0.03442651863295482*kSq[6]+0.09938079899999068*kSq[5]+0.09938079899999068*kSq[4]+0.02666666666666666*kSq[3]+0.0769800358919501*kSq[2]-0.0769800358919501*kSq[1]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[4], globalIdxs[2], (-0.0295084445425327*kSq[7])+0.03442651863295482*kSq[6]-0.063887656499994*kSq[5]-0.05962847939999439*kSq[4]+0.05333333333333333*kSq[3]+0.03849001794597505*kSq[2]-0.8888888888888888*epsilon[0]*rdx2Sq[1]+0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[4], globalIdxs[3], 0.1135780559999893*kSq[5]+0.07950463919999252*kSq[4]+0.8888888888888888*epsilon[0]*rdx2Sq[1]-0.5333333333333333*epsilon[0]*rdx2Sq[0]-0.1777777777777778*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[4], globalIdxs[4], 0.1967229636168847*kSq[7]+0.2271561119999787*kSq[5]-0.07950463919999252*kSq[4]+1.777777777777778*epsilon[0]*rdx2Sq[1]-0.3079201435678004*kSq[1]+0.5333333333333333*epsilon[0]*rdx2Sq[0]-0.3555555555555556*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[4], globalIdxs[5], (-0.01721325931647741*kSq[7])-0.05678902799999467*kSq[5]-0.03975231959999626*kSq[4]+0.01333333333333333*kSq[3]-0.4444444444444444*epsilon[0]*rdx2Sq[1]+0.03849001794597505*kSq[1]-0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[4], globalIdxs[6], 0.03442651863295482*kSq[7]+0.03442651863295482*kSq[6]+0.09938079899999068*kSq[5]+0.09938079899999068*kSq[4]-0.02666666666666666*kSq[3]-0.0769800358919501*kSq[2]-0.0769800358919501*kSq[1]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[4], globalIdxs[7], (-0.0295084445425327*kSq[7])-0.03442651863295482*kSq[6]-0.063887656499994*kSq[5]-0.05962847939999439*kSq[4]-0.05333333333333333*kSq[3]-0.03849001794597505*kSq[2]-0.8888888888888888*epsilon[0]*rdx2Sq[1]+0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_insert(tri, globalIdxs[5], globalIdxs[0], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[5], globalIdxs[1], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[5], globalIdxs[2], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[5], globalIdxs[3], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[5], globalIdxs[4], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[5], globalIdxs[5], 1.0);
  gkyl_mat_triples_insert(tri, globalIdxs[5], globalIdxs[6], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[5], globalIdxs[7], 0.0);
  gkyl_mat_triples_accum(tri, globalIdxs[6], globalIdxs[0], (-0.01721325931647741*kSq[6])-0.03975231959999626*kSq[5]-0.05678902799999467*kSq[4]-0.01333333333333333*kSq[3]+0.03849001794597505*kSq[2]-0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.4444444444444444*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[6], globalIdxs[1], 0.07950463919999252*kSq[5]+0.1135780559999893*kSq[4]-0.5333333333333333*epsilon[0]*rdx2Sq[1]+0.8888888888888888*epsilon[0]*rdx2Sq[0]-0.1777777777777778*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[6], globalIdxs[2], (-0.01721325931647741*kSq[6])-0.03975231959999626*kSq[5]-0.05678902799999467*kSq[4]+0.01333333333333333*kSq[3]+0.03849001794597505*kSq[2]-0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.4444444444444444*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[6], globalIdxs[3], (-0.03442651863295482*kSq[7])+0.03442651863295482*kSq[6]+0.09938079899999068*kSq[5]+0.09938079899999068*kSq[4]+0.02666666666666666*kSq[3]-0.0769800358919501*kSq[2]+0.0769800358919501*kSq[1]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[6], globalIdxs[4], 0.03442651863295482*kSq[7]+0.03442651863295482*kSq[6]+0.09938079899999068*kSq[5]+0.09938079899999068*kSq[4]-0.02666666666666666*kSq[3]-0.0769800358919501*kSq[2]-0.0769800358919501*kSq[1]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[6], globalIdxs[5], 0.03442651863295482*kSq[7]-0.0295084445425327*kSq[6]-0.05962847939999439*kSq[5]-0.063887656499994*kSq[4]+0.05333333333333333*kSq[3]+0.06666666666666667*epsilon[0]*rdx2Sq[1]+0.03849001794597505*kSq[1]-0.8888888888888888*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[6], globalIdxs[6], 0.1967229636168847*kSq[6]-0.07950463919999252*kSq[5]+0.2271561119999787*kSq[4]-0.3079201435678004*kSq[2]+0.5333333333333333*epsilon[0]*rdx2Sq[1]+1.777777777777778*epsilon[0]*rdx2Sq[0]-0.3555555555555556*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[6], globalIdxs[7], (-0.03442651863295482*kSq[7])-0.0295084445425327*kSq[6]-0.05962847939999439*kSq[5]-0.063887656499994*kSq[4]-0.05333333333333333*kSq[3]+0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.03849001794597505*kSq[1]-0.8888888888888888*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[7], globalIdxs[0], 0.0234254740499978*kSq[5]+0.0234254740499978*kSq[4]+0.01333333333333333*kSq[3]+0.2555555555555555*epsilon[0]*rdx2Sq[1]+0.2555555555555555*epsilon[0]*rdx2Sq[0]-0.03333333333333333*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[7], globalIdxs[1], 0.01721325931647741*kSq[6]-0.03975231959999626*kSq[5]-0.05678902799999467*kSq[4]-0.01333333333333333*kSq[3]-0.03849001794597505*kSq[2]-0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.4444444444444444*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[7], globalIdxs[2], 0.006147592613027645*kSq[7]+0.02697478829999747*kSq[5]+0.03336355394999686*kSq[4]+0.3111111111111111*epsilon[0]*rdx2Sq[1]+0.01924500897298752*kSq[1]+0.1888888888888889*epsilon[0]*rdx2Sq[0]-0.02222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[7], globalIdxs[3], 0.01721325931647741*kSq[7]-0.05678902799999467*kSq[5]-0.03975231959999626*kSq[4]-0.01333333333333333*kSq[3]-0.4444444444444444*epsilon[0]*rdx2Sq[1]-0.03849001794597505*kSq[1]-0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[7], globalIdxs[4], (-0.0295084445425327*kSq[7])-0.03442651863295482*kSq[6]-0.063887656499994*kSq[5]-0.05962847939999439*kSq[4]-0.05333333333333333*kSq[3]-0.03849001794597505*kSq[2]-0.8888888888888888*epsilon[0]*rdx2Sq[1]+0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[7], globalIdxs[5], 0.006147592613027645*kSq[6]+0.03336355394999686*kSq[5]+0.02697478829999747*kSq[4]+0.01924500897298752*kSq[2]+0.1888888888888889*epsilon[0]*rdx2Sq[1]+0.3111111111111111*epsilon[0]*rdx2Sq[0]-0.02222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[7], globalIdxs[6], (-0.03442651863295482*kSq[7])-0.0295084445425327*kSq[6]-0.05962847939999439*kSq[5]-0.063887656499994*kSq[4]-0.05333333333333333*kSq[3]+0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.03849001794597505*kSq[1]-0.8888888888888888*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[7], globalIdxs[7], (-0.04549218533640458*kSq[7])-0.04549218533640458*kSq[6]-0.0127775312999988*kSq[5]-0.0127775312999988*kSq[4]-0.04666666666666667*kSq[3]-0.03849001794597505*kSq[2]+0.5777777777777777*epsilon[0]*rdx2Sq[1]-0.03849001794597505*kSq[1]+0.5777777777777777*epsilon[0]*rdx2Sq[0]-0.06666666666666667*kSq[0]);

}
void fem_poisson_lhs_stencil_consteps_2x_ser_p1_lox_dirichletx_loy_dirichlety(const double *epsilon, const double *kSq, const double *dx, const double *bcVals, const long *globalIdxs, gkyl_mat_triples *tri) 
{ 
  // epsilon: permittivity.
  // kSq: wave number squared (factor multiplying phi).
  // dx: cell length in each direction.
  // bcVals[3]: values to impose as BCs, i.e. bcVals[0]*phi+bcVals[1]*d(phi)/dx=bcVals[2].
  // globalIdxs: global linear index of each basis function/node in current cell.
  // tri: triples object (i,j,val), i.e. contribute val to i,j element of the global matrix.

  double rdx2Sq[2];
  rdx2Sq[0] = 4.0/(dx[0]*dx[0]);
  rdx2Sq[1] = 4.0/(dx[1]*dx[1]);

  gkyl_mat_triples_insert(tri, globalIdxs[0], globalIdxs[0], 1.0);
  gkyl_mat_triples_insert(tri, globalIdxs[0], globalIdxs[1], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[0], globalIdxs[2], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[0], globalIdxs[3], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[1], globalIdxs[0], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[1], globalIdxs[1], 1.0);
  gkyl_mat_triples_insert(tri, globalIdxs[1], globalIdxs[2], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[1], globalIdxs[3], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[2], globalIdxs[0], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[2], globalIdxs[1], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[2], globalIdxs[2], 1.0);
  gkyl_mat_triples_insert(tri, globalIdxs[2], globalIdxs[3], 0.0);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[0], (-0.1666666666666667*epsilon[0]*rdx2Sq[1])-0.1666666666666667*epsilon[0]*rdx2Sq[0]-0.05555555555555555*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[1], (-0.3333333333333333*epsilon[0]*rdx2Sq[1])-0.09622504486493762*kSq[1]+0.1666666666666667*epsilon[0]*rdx2Sq[0]-0.1111111111111111*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[2], (-0.09622504486493762*kSq[2])+0.1666666666666667*epsilon[0]*rdx2Sq[1]-0.3333333333333333*epsilon[0]*rdx2Sq[0]-0.1111111111111111*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[3], (-0.1666666666666667*kSq[3])-0.1924500897298752*kSq[2]+0.3333333333333333*epsilon[0]*rdx2Sq[1]-0.1924500897298752*kSq[1]+0.3333333333333333*epsilon[0]*rdx2Sq[0]-0.2222222222222222*kSq[0]);

}
void fem_poisson_lhs_stencil_consteps_2x_ser_p2_lox_dirichletx_loy_dirichlety(const double *epsilon, const double *kSq, const double *dx, const double *bcVals, const long *globalIdxs, gkyl_mat_triples *tri) 
{ 
  // epsilon: permittivity.
  // kSq: wave number squared (factor multiplying phi).
  // dx: cell length in each direction.
  // bcVals[3]: values to impose as BCs, i.e. bcVals[0]*phi+bcVals[1]*d(phi)/dx=bcVals[2].
  // globalIdxs: global linear index of each basis function/node in current cell.
  // tri: triples object (i,j,val), i.e. contribute val to i,j element of the global matrix.

  double rdx2Sq[2];
  rdx2Sq[0] = 4.0/(dx[0]*dx[0]);
  rdx2Sq[1] = 4.0/(dx[1]*dx[1]);

  gkyl_mat_triples_insert(tri, globalIdxs[0], globalIdxs[0], 1.0);
  gkyl_mat_triples_insert(tri, globalIdxs[0], globalIdxs[1], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[0], globalIdxs[2], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[0], globalIdxs[3], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[0], globalIdxs[4], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[0], globalIdxs[5], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[0], globalIdxs[6], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[0], globalIdxs[7], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[1], globalIdxs[0], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[1], globalIdxs[1], 1.0);
  gkyl_mat_triples_insert(tri, globalIdxs[1], globalIdxs[2], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[1], globalIdxs[3], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[1], globalIdxs[4], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[1], globalIdxs[5], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[1], globalIdxs[6], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[1], globalIdxs[7], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[2], globalIdxs[0], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[2], globalIdxs[1], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[2], globalIdxs[2], 1.0);
  gkyl_mat_triples_insert(tri, globalIdxs[2], globalIdxs[3], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[2], globalIdxs[4], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[2], globalIdxs[5], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[2], globalIdxs[6], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[2], globalIdxs[7], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[3], globalIdxs[0], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[3], globalIdxs[1], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[3], globalIdxs[2], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[3], globalIdxs[3], 1.0);
  gkyl_mat_triples_insert(tri, globalIdxs[3], globalIdxs[4], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[3], globalIdxs[5], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[3], globalIdxs[6], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[3], globalIdxs[7], 0.0);
  gkyl_mat_triples_accum(tri, globalIdxs[4], globalIdxs[0], (-0.01721325931647741*kSq[7])-0.05678902799999467*kSq[5]-0.03975231959999626*kSq[4]-0.01333333333333333*kSq[3]-0.4444444444444444*epsilon[0]*rdx2Sq[1]+0.03849001794597505*kSq[1]-0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[4], globalIdxs[1], 0.03442651863295482*kSq[7]-0.03442651863295482*kSq[6]+0.09938079899999068*kSq[5]+0.09938079899999068*kSq[4]+0.02666666666666666*kSq[3]+0.0769800358919501*kSq[2]-0.0769800358919501*kSq[1]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[4], globalIdxs[2], (-0.0295084445425327*kSq[7])+0.03442651863295482*kSq[6]-0.063887656499994*kSq[5]-0.05962847939999439*kSq[4]+0.05333333333333333*kSq[3]+0.03849001794597505*kSq[2]-0.8888888888888888*epsilon[0]*rdx2Sq[1]+0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[4], globalIdxs[3], 0.1135780559999893*kSq[5]+0.07950463919999252*kSq[4]+0.8888888888888888*epsilon[0]*rdx2Sq[1]-0.5333333333333333*epsilon[0]*rdx2Sq[0]-0.1777777777777778*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[4], globalIdxs[4], 0.1967229636168847*kSq[7]+0.2271561119999787*kSq[5]-0.07950463919999252*kSq[4]+1.777777777777778*epsilon[0]*rdx2Sq[1]-0.3079201435678004*kSq[1]+0.5333333333333333*epsilon[0]*rdx2Sq[0]-0.3555555555555556*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[4], globalIdxs[5], (-0.01721325931647741*kSq[7])-0.05678902799999467*kSq[5]-0.03975231959999626*kSq[4]+0.01333333333333333*kSq[3]-0.4444444444444444*epsilon[0]*rdx2Sq[1]+0.03849001794597505*kSq[1]-0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[4], globalIdxs[6], 0.03442651863295482*kSq[7]+0.03442651863295482*kSq[6]+0.09938079899999068*kSq[5]+0.09938079899999068*kSq[4]-0.02666666666666666*kSq[3]-0.0769800358919501*kSq[2]-0.0769800358919501*kSq[1]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[4], globalIdxs[7], (-0.0295084445425327*kSq[7])-0.03442651863295482*kSq[6]-0.063887656499994*kSq[5]-0.05962847939999439*kSq[4]-0.05333333333333333*kSq[3]-0.03849001794597505*kSq[2]-0.8888888888888888*epsilon[0]*rdx2Sq[1]+0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_insert(tri, globalIdxs[5], globalIdxs[0], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[5], globalIdxs[1], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[5], globalIdxs[2], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[5], globalIdxs[3], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[5], globalIdxs[4], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[5], globalIdxs[5], 1.0);
  gkyl_mat_triples_insert(tri, globalIdxs[5], globalIdxs[6], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[5], globalIdxs[7], 0.0);
  gkyl_mat_triples_accum(tri, globalIdxs[6], globalIdxs[0], (-0.01721325931647741*kSq[6])-0.03975231959999626*kSq[5]-0.05678902799999467*kSq[4]-0.01333333333333333*kSq[3]+0.03849001794597505*kSq[2]-0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.4444444444444444*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[6], globalIdxs[1], 0.07950463919999252*kSq[5]+0.1135780559999893*kSq[4]-0.5333333333333333*epsilon[0]*rdx2Sq[1]+0.8888888888888888*epsilon[0]*rdx2Sq[0]-0.1777777777777778*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[6], globalIdxs[2], (-0.01721325931647741*kSq[6])-0.03975231959999626*kSq[5]-0.05678902799999467*kSq[4]+0.01333333333333333*kSq[3]+0.03849001794597505*kSq[2]-0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.4444444444444444*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[6], globalIdxs[3], (-0.03442651863295482*kSq[7])+0.03442651863295482*kSq[6]+0.09938079899999068*kSq[5]+0.09938079899999068*kSq[4]+0.02666666666666666*kSq[3]-0.0769800358919501*kSq[2]+0.0769800358919501*kSq[1]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[6], globalIdxs[4], 0.03442651863295482*kSq[7]+0.03442651863295482*kSq[6]+0.09938079899999068*kSq[5]+0.09938079899999068*kSq[4]-0.02666666666666666*kSq[3]-0.0769800358919501*kSq[2]-0.0769800358919501*kSq[1]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[6], globalIdxs[5], 0.03442651863295482*kSq[7]-0.0295084445425327*kSq[6]-0.05962847939999439*kSq[5]-0.063887656499994*kSq[4]+0.05333333333333333*kSq[3]+0.06666666666666667*epsilon[0]*rdx2Sq[1]+0.03849001794597505*kSq[1]-0.8888888888888888*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[6], globalIdxs[6], 0.1967229636168847*kSq[6]-0.07950463919999252*kSq[5]+0.2271561119999787*kSq[4]-0.3079201435678004*kSq[2]+0.5333333333333333*epsilon[0]*rdx2Sq[1]+1.777777777777778*epsilon[0]*rdx2Sq[0]-0.3555555555555556*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[6], globalIdxs[7], (-0.03442651863295482*kSq[7])-0.0295084445425327*kSq[6]-0.05962847939999439*kSq[5]-0.063887656499994*kSq[4]-0.05333333333333333*kSq[3]+0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.03849001794597505*kSq[1]-0.8888888888888888*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[7], globalIdxs[0], 0.0234254740499978*kSq[5]+0.0234254740499978*kSq[4]+0.01333333333333333*kSq[3]+0.2555555555555555*epsilon[0]*rdx2Sq[1]+0.2555555555555555*epsilon[0]*rdx2Sq[0]-0.03333333333333333*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[7], globalIdxs[1], 0.01721325931647741*kSq[6]-0.03975231959999626*kSq[5]-0.05678902799999467*kSq[4]-0.01333333333333333*kSq[3]-0.03849001794597505*kSq[2]-0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.4444444444444444*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[7], globalIdxs[2], 0.006147592613027645*kSq[7]+0.02697478829999747*kSq[5]+0.03336355394999686*kSq[4]+0.3111111111111111*epsilon[0]*rdx2Sq[1]+0.01924500897298752*kSq[1]+0.1888888888888889*epsilon[0]*rdx2Sq[0]-0.02222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[7], globalIdxs[3], 0.01721325931647741*kSq[7]-0.05678902799999467*kSq[5]-0.03975231959999626*kSq[4]-0.01333333333333333*kSq[3]-0.4444444444444444*epsilon[0]*rdx2Sq[1]-0.03849001794597505*kSq[1]-0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[7], globalIdxs[4], (-0.0295084445425327*kSq[7])-0.03442651863295482*kSq[6]-0.063887656499994*kSq[5]-0.05962847939999439*kSq[4]-0.05333333333333333*kSq[3]-0.03849001794597505*kSq[2]-0.8888888888888888*epsilon[0]*rdx2Sq[1]+0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[7], globalIdxs[5], 0.006147592613027645*kSq[6]+0.03336355394999686*kSq[5]+0.02697478829999747*kSq[4]+0.01924500897298752*kSq[2]+0.1888888888888889*epsilon[0]*rdx2Sq[1]+0.3111111111111111*epsilon[0]*rdx2Sq[0]-0.02222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[7], globalIdxs[6], (-0.03442651863295482*kSq[7])-0.0295084445425327*kSq[6]-0.05962847939999439*kSq[5]-0.063887656499994*kSq[4]-0.05333333333333333*kSq[3]+0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.03849001794597505*kSq[1]-0.8888888888888888*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[7], globalIdxs[7], (-0.04549218533640458*kSq[7])-0.04549218533640458*kSq[6]-0.0127775312999988*kSq[5]-0.0127775312999988*kSq[4]-0.04666666666666667*kSq[3]-0.03849001794597505*kSq[2]+0.5777777777777777*epsilon[0]*rdx2Sq[1]-0.03849001794597505*kSq[1]+0.5777777777777777*epsilon[0]*rdx2Sq[0]-0.06666666666666667*kSq[0]);

}
void fem_poisson_lhs_stencil_consteps_2x_ser_p1_lox_dirichletx_loy_neumanny(const double *epsilon, const double *kSq, const double *dx, const double *bcVals, const long *globalIdxs, gkyl_mat_triples *tri) 
{ 
  // epsilon: permittivity.
  // kSq: wave number squared (factor multiplying phi).
  // dx: cell length in each direction.
  // bcVals[3]: values to impose as BCs, i.e. bcVals[0]*phi+bcVals[1]*d(phi)/dx=bcVals[2].
  // globalIdxs: global linear index of each basis function/node in current cell.
  // tri: triples object (i,j,val), i.e. contribute val to i,j element of the global matrix.

  double rdx2Sq[2];
  rdx2Sq[0] = 4.0/(dx[0]*dx[0]);
  rdx2Sq[1] = 4.0/(dx[1]*dx[1]);

  gkyl_mat_triples_insert(tri, globalIdxs[0], globalIdxs[0], 1.0);
  gkyl_mat_triples_insert(tri, globalIdxs[0], globalIdxs[1], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[0], globalIdxs[2], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[0], globalIdxs[3], 0.0);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[0], 0.09622504486493762*kSq[2]+0.1666666666666667*epsilon[0]*rdx2Sq[1]-0.3333333333333333*epsilon[0]*rdx2Sq[0]-0.1111111111111111*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[1], 0.1666666666666667*kSq[3]+0.1924500897298752*kSq[2]+0.3333333333333333*epsilon[0]*rdx2Sq[1]-0.1924500897298752*kSq[1]+0.3333333333333333*epsilon[0]*rdx2Sq[0]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[2], (-0.1666666666666667*epsilon[0]*rdx2Sq[1])-0.1666666666666667*epsilon[0]*rdx2Sq[0]-0.05555555555555555*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[3], (-0.3333333333333333*epsilon[0]*rdx2Sq[1])-0.09622504486493762*kSq[1]+0.1666666666666667*epsilon[0]*rdx2Sq[0]-0.1111111111111111*kSq[0]);
  gkyl_mat_triples_insert(tri, globalIdxs[2], globalIdxs[0], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[2], globalIdxs[1], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[2], globalIdxs[2], 1.0);
  gkyl_mat_triples_insert(tri, globalIdxs[2], globalIdxs[3], 0.0);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[0], (-0.1666666666666667*epsilon[0]*rdx2Sq[1])-0.1666666666666667*epsilon[0]*rdx2Sq[0]-0.05555555555555555*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[1], (-0.3333333333333333*epsilon[0]*rdx2Sq[1])-0.09622504486493762*kSq[1]+0.1666666666666667*epsilon[0]*rdx2Sq[0]-0.1111111111111111*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[2], (-0.09622504486493762*kSq[2])+0.1666666666666667*epsilon[0]*rdx2Sq[1]-0.3333333333333333*epsilon[0]*rdx2Sq[0]-0.1111111111111111*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[3], (-0.1666666666666667*kSq[3])-0.1924500897298752*kSq[2]+0.3333333333333333*epsilon[0]*rdx2Sq[1]-0.1924500897298752*kSq[1]+0.3333333333333333*epsilon[0]*rdx2Sq[0]-0.2222222222222222*kSq[0]);

}
void fem_poisson_lhs_stencil_consteps_2x_ser_p2_lox_dirichletx_loy_neumanny(const double *epsilon, const double *kSq, const double *dx, const double *bcVals, const long *globalIdxs, gkyl_mat_triples *tri) 
{ 
  // epsilon: permittivity.
  // kSq: wave number squared (factor multiplying phi).
  // dx: cell length in each direction.
  // bcVals[3]: values to impose as BCs, i.e. bcVals[0]*phi+bcVals[1]*d(phi)/dx=bcVals[2].
  // globalIdxs: global linear index of each basis function/node in current cell.
  // tri: triples object (i,j,val), i.e. contribute val to i,j element of the global matrix.

  double rdx2Sq[2];
  rdx2Sq[0] = 4.0/(dx[0]*dx[0]);
  rdx2Sq[1] = 4.0/(dx[1]*dx[1]);

  gkyl_mat_triples_insert(tri, globalIdxs[0], globalIdxs[0], 1.0);
  gkyl_mat_triples_insert(tri, globalIdxs[0], globalIdxs[1], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[0], globalIdxs[2], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[0], globalIdxs[3], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[0], globalIdxs[4], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[0], globalIdxs[5], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[0], globalIdxs[6], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[0], globalIdxs[7], 0.0);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[0], 0.03442651863295482*kSq[7]+0.0295084445425327*kSq[6]-0.05962847939999439*kSq[5]-0.063887656499994*kSq[4]-0.05333333333333333*kSq[3]+0.06666666666666667*epsilon[0]*rdx2Sq[1]+0.03849001794597505*kSq[1]-0.8888888888888888*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[1], (-0.1967229636168847*kSq[6])-0.07950463919999252*kSq[5]+0.2271561119999787*kSq[4]+0.3079201435678004*kSq[2]+0.5333333333333333*epsilon[0]*rdx2Sq[1]+1.777777777777778*epsilon[0]*rdx2Sq[0]-0.3555555555555556*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[2], (-0.03442651863295482*kSq[7])+0.0295084445425327*kSq[6]-0.05962847939999439*kSq[5]-0.063887656499994*kSq[4]+0.05333333333333333*kSq[3]+0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.03849001794597505*kSq[1]-0.8888888888888888*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[3], (-0.03442651863295482*kSq[7])-0.03442651863295482*kSq[6]+0.09938079899999068*kSq[5]+0.09938079899999068*kSq[4]-0.02666666666666666*kSq[3]+0.0769800358919501*kSq[2]+0.0769800358919501*kSq[1]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[4], 0.03442651863295482*kSq[7]-0.03442651863295482*kSq[6]+0.09938079899999068*kSq[5]+0.09938079899999068*kSq[4]+0.02666666666666666*kSq[3]+0.0769800358919501*kSq[2]-0.0769800358919501*kSq[1]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[5], 0.01721325931647741*kSq[6]-0.03975231959999626*kSq[5]-0.05678902799999467*kSq[4]+0.01333333333333333*kSq[3]-0.03849001794597505*kSq[2]-0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.4444444444444444*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[6], 0.07950463919999252*kSq[5]+0.1135780559999893*kSq[4]-0.5333333333333333*epsilon[0]*rdx2Sq[1]+0.8888888888888888*epsilon[0]*rdx2Sq[0]-0.1777777777777778*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[7], 0.01721325931647741*kSq[6]-0.03975231959999626*kSq[5]-0.05678902799999467*kSq[4]-0.01333333333333333*kSq[3]-0.03849001794597505*kSq[2]-0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.4444444444444444*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[0], (-0.006147592613027645*kSq[6])+0.03336355394999686*kSq[5]+0.02697478829999747*kSq[4]-0.01924500897298752*kSq[2]+0.1888888888888889*epsilon[0]*rdx2Sq[1]+0.3111111111111111*epsilon[0]*rdx2Sq[0]-0.02222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[1], (-0.03442651863295482*kSq[7])+0.0295084445425327*kSq[6]-0.05962847939999439*kSq[5]-0.063887656499994*kSq[4]+0.05333333333333333*kSq[3]+0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.03849001794597505*kSq[1]-0.8888888888888888*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[2], (-0.04549218533640458*kSq[7])+0.04549218533640458*kSq[6]-0.0127775312999988*kSq[5]-0.0127775312999988*kSq[4]+0.04666666666666667*kSq[3]+0.03849001794597505*kSq[2]+0.5777777777777777*epsilon[0]*rdx2Sq[1]-0.03849001794597505*kSq[1]+0.5777777777777777*epsilon[0]*rdx2Sq[0]-0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[3], 0.01721325931647741*kSq[7]-0.05678902799999467*kSq[5]-0.03975231959999626*kSq[4]+0.01333333333333333*kSq[3]-0.4444444444444444*epsilon[0]*rdx2Sq[1]-0.03849001794597505*kSq[1]-0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[4], (-0.0295084445425327*kSq[7])+0.03442651863295482*kSq[6]-0.063887656499994*kSq[5]-0.05962847939999439*kSq[4]+0.05333333333333333*kSq[3]+0.03849001794597505*kSq[2]-0.8888888888888888*epsilon[0]*rdx2Sq[1]+0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[5], 0.0234254740499978*kSq[5]+0.0234254740499978*kSq[4]-0.01333333333333333*kSq[3]+0.2555555555555555*epsilon[0]*rdx2Sq[1]+0.2555555555555555*epsilon[0]*rdx2Sq[0]-0.03333333333333333*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[6], (-0.01721325931647741*kSq[6])-0.03975231959999626*kSq[5]-0.05678902799999467*kSq[4]+0.01333333333333333*kSq[3]+0.03849001794597505*kSq[2]-0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.4444444444444444*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[7], 0.006147592613027645*kSq[7]+0.02697478829999747*kSq[5]+0.03336355394999686*kSq[4]+0.3111111111111111*epsilon[0]*rdx2Sq[1]+0.01924500897298752*kSq[1]+0.1888888888888889*epsilon[0]*rdx2Sq[0]-0.02222222222222222*kSq[0]);
  gkyl_mat_triples_insert(tri, globalIdxs[3], globalIdxs[0], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[3], globalIdxs[1], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[3], globalIdxs[2], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[3], globalIdxs[3], 1.0);
  gkyl_mat_triples_insert(tri, globalIdxs[3], globalIdxs[4], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[3], globalIdxs[5], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[3], globalIdxs[6], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[3], globalIdxs[7], 0.0);
  gkyl_mat_triples_accum(tri, globalIdxs[4], globalIdxs[0], (-0.01721325931647741*kSq[7])-0.05678902799999467*kSq[5]-0.03975231959999626*kSq[4]-0.01333333333333333*kSq[3]-0.4444444444444444*epsilon[0]*rdx2Sq[1]+0.03849001794597505*kSq[1]-0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[4], globalIdxs[1], 0.03442651863295482*kSq[7]-0.03442651863295482*kSq[6]+0.09938079899999068*kSq[5]+0.09938079899999068*kSq[4]+0.02666666666666666*kSq[3]+0.0769800358919501*kSq[2]-0.0769800358919501*kSq[1]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[4], globalIdxs[2], (-0.0295084445425327*kSq[7])+0.03442651863295482*kSq[6]-0.063887656499994*kSq[5]-0.05962847939999439*kSq[4]+0.05333333333333333*kSq[3]+0.03849001794597505*kSq[2]-0.8888888888888888*epsilon[0]*rdx2Sq[1]+0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[4], globalIdxs[3], 0.1135780559999893*kSq[5]+0.07950463919999252*kSq[4]+0.8888888888888888*epsilon[0]*rdx2Sq[1]-0.5333333333333333*epsilon[0]*rdx2Sq[0]-0.1777777777777778*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[4], globalIdxs[4], 0.1967229636168847*kSq[7]+0.2271561119999787*kSq[5]-0.07950463919999252*kSq[4]+1.777777777777778*epsilon[0]*rdx2Sq[1]-0.3079201435678004*kSq[1]+0.5333333333333333*epsilon[0]*rdx2Sq[0]-0.3555555555555556*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[4], globalIdxs[5], (-0.01721325931647741*kSq[7])-0.05678902799999467*kSq[5]-0.03975231959999626*kSq[4]+0.01333333333333333*kSq[3]-0.4444444444444444*epsilon[0]*rdx2Sq[1]+0.03849001794597505*kSq[1]-0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[4], globalIdxs[6], 0.03442651863295482*kSq[7]+0.03442651863295482*kSq[6]+0.09938079899999068*kSq[5]+0.09938079899999068*kSq[4]-0.02666666666666666*kSq[3]-0.0769800358919501*kSq[2]-0.0769800358919501*kSq[1]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[4], globalIdxs[7], (-0.0295084445425327*kSq[7])-0.03442651863295482*kSq[6]-0.063887656499994*kSq[5]-0.05962847939999439*kSq[4]-0.05333333333333333*kSq[3]-0.03849001794597505*kSq[2]-0.8888888888888888*epsilon[0]*rdx2Sq[1]+0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_insert(tri, globalIdxs[5], globalIdxs[0], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[5], globalIdxs[1], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[5], globalIdxs[2], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[5], globalIdxs[3], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[5], globalIdxs[4], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[5], globalIdxs[5], 1.0);
  gkyl_mat_triples_insert(tri, globalIdxs[5], globalIdxs[6], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[5], globalIdxs[7], 0.0);
  gkyl_mat_triples_accum(tri, globalIdxs[6], globalIdxs[0], (-0.01721325931647741*kSq[6])-0.03975231959999626*kSq[5]-0.05678902799999467*kSq[4]-0.01333333333333333*kSq[3]+0.03849001794597505*kSq[2]-0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.4444444444444444*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[6], globalIdxs[1], 0.07950463919999252*kSq[5]+0.1135780559999893*kSq[4]-0.5333333333333333*epsilon[0]*rdx2Sq[1]+0.8888888888888888*epsilon[0]*rdx2Sq[0]-0.1777777777777778*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[6], globalIdxs[2], (-0.01721325931647741*kSq[6])-0.03975231959999626*kSq[5]-0.05678902799999467*kSq[4]+0.01333333333333333*kSq[3]+0.03849001794597505*kSq[2]-0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.4444444444444444*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[6], globalIdxs[3], (-0.03442651863295482*kSq[7])+0.03442651863295482*kSq[6]+0.09938079899999068*kSq[5]+0.09938079899999068*kSq[4]+0.02666666666666666*kSq[3]-0.0769800358919501*kSq[2]+0.0769800358919501*kSq[1]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[6], globalIdxs[4], 0.03442651863295482*kSq[7]+0.03442651863295482*kSq[6]+0.09938079899999068*kSq[5]+0.09938079899999068*kSq[4]-0.02666666666666666*kSq[3]-0.0769800358919501*kSq[2]-0.0769800358919501*kSq[1]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[6], globalIdxs[5], 0.03442651863295482*kSq[7]-0.0295084445425327*kSq[6]-0.05962847939999439*kSq[5]-0.063887656499994*kSq[4]+0.05333333333333333*kSq[3]+0.06666666666666667*epsilon[0]*rdx2Sq[1]+0.03849001794597505*kSq[1]-0.8888888888888888*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[6], globalIdxs[6], 0.1967229636168847*kSq[6]-0.07950463919999252*kSq[5]+0.2271561119999787*kSq[4]-0.3079201435678004*kSq[2]+0.5333333333333333*epsilon[0]*rdx2Sq[1]+1.777777777777778*epsilon[0]*rdx2Sq[0]-0.3555555555555556*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[6], globalIdxs[7], (-0.03442651863295482*kSq[7])-0.0295084445425327*kSq[6]-0.05962847939999439*kSq[5]-0.063887656499994*kSq[4]-0.05333333333333333*kSq[3]+0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.03849001794597505*kSq[1]-0.8888888888888888*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[7], globalIdxs[0], 0.0234254740499978*kSq[5]+0.0234254740499978*kSq[4]+0.01333333333333333*kSq[3]+0.2555555555555555*epsilon[0]*rdx2Sq[1]+0.2555555555555555*epsilon[0]*rdx2Sq[0]-0.03333333333333333*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[7], globalIdxs[1], 0.01721325931647741*kSq[6]-0.03975231959999626*kSq[5]-0.05678902799999467*kSq[4]-0.01333333333333333*kSq[3]-0.03849001794597505*kSq[2]-0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.4444444444444444*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[7], globalIdxs[2], 0.006147592613027645*kSq[7]+0.02697478829999747*kSq[5]+0.03336355394999686*kSq[4]+0.3111111111111111*epsilon[0]*rdx2Sq[1]+0.01924500897298752*kSq[1]+0.1888888888888889*epsilon[0]*rdx2Sq[0]-0.02222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[7], globalIdxs[3], 0.01721325931647741*kSq[7]-0.05678902799999467*kSq[5]-0.03975231959999626*kSq[4]-0.01333333333333333*kSq[3]-0.4444444444444444*epsilon[0]*rdx2Sq[1]-0.03849001794597505*kSq[1]-0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[7], globalIdxs[4], (-0.0295084445425327*kSq[7])-0.03442651863295482*kSq[6]-0.063887656499994*kSq[5]-0.05962847939999439*kSq[4]-0.05333333333333333*kSq[3]-0.03849001794597505*kSq[2]-0.8888888888888888*epsilon[0]*rdx2Sq[1]+0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[7], globalIdxs[5], 0.006147592613027645*kSq[6]+0.03336355394999686*kSq[5]+0.02697478829999747*kSq[4]+0.01924500897298752*kSq[2]+0.1888888888888889*epsilon[0]*rdx2Sq[1]+0.3111111111111111*epsilon[0]*rdx2Sq[0]-0.02222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[7], globalIdxs[6], (-0.03442651863295482*kSq[7])-0.0295084445425327*kSq[6]-0.05962847939999439*kSq[5]-0.063887656499994*kSq[4]-0.05333333333333333*kSq[3]+0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.03849001794597505*kSq[1]-0.8888888888888888*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[7], globalIdxs[7], (-0.04549218533640458*kSq[7])-0.04549218533640458*kSq[6]-0.0127775312999988*kSq[5]-0.0127775312999988*kSq[4]-0.04666666666666667*kSq[3]-0.03849001794597505*kSq[2]+0.5777777777777777*epsilon[0]*rdx2Sq[1]-0.03849001794597505*kSq[1]+0.5777777777777777*epsilon[0]*rdx2Sq[0]-0.06666666666666667*kSq[0]);

}
void fem_poisson_lhs_stencil_consteps_2x_ser_p1_lox_dirichletx_loy_robiny(const double *epsilon, const double *kSq, const double *dx, const double *bcVals, const long *globalIdxs, gkyl_mat_triples *tri) 
{ 
  // epsilon: permittivity.
  // kSq: wave number squared (factor multiplying phi).
  // dx: cell length in each direction.
  // bcVals[3]: values to impose as BCs, i.e. bcVals[0]*phi+bcVals[1]*d(phi)/dx=bcVals[2].
  // globalIdxs: global linear index of each basis function/node in current cell.
  // tri: triples object (i,j,val), i.e. contribute val to i,j element of the global matrix.

  double rdx2Sq[2];
  rdx2Sq[0] = 4.0/(dx[0]*dx[0]);
  rdx2Sq[1] = 4.0/(dx[1]*dx[1]);

  gkyl_mat_triples_insert(tri, globalIdxs[0], globalIdxs[0], 1.0);
  gkyl_mat_triples_insert(tri, globalIdxs[0], globalIdxs[1], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[0], globalIdxs[2], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[0], globalIdxs[3], 0.0);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[0], (-(0.3333333333333333*epsilon[0]*rdx2Sq[1]*bcVals[6])/bcVals[7])+0.09622504486493762*kSq[2]+0.1666666666666667*epsilon[0]*rdx2Sq[1]-0.3333333333333333*epsilon[0]*rdx2Sq[0]-0.1111111111111111*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[1], (-(0.6666666666666666*epsilon[0]*rdx2Sq[1]*bcVals[6])/bcVals[7])+0.1666666666666667*kSq[3]+0.1924500897298752*kSq[2]+0.3333333333333333*epsilon[0]*rdx2Sq[1]-0.1924500897298752*kSq[1]+0.3333333333333333*epsilon[0]*rdx2Sq[0]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[2], (-0.1666666666666667*epsilon[0]*rdx2Sq[1])-0.1666666666666667*epsilon[0]*rdx2Sq[0]-0.05555555555555555*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[3], (-0.3333333333333333*epsilon[0]*rdx2Sq[1])-0.09622504486493762*kSq[1]+0.1666666666666667*epsilon[0]*rdx2Sq[0]-0.1111111111111111*kSq[0]);
  gkyl_mat_triples_insert(tri, globalIdxs[2], globalIdxs[0], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[2], globalIdxs[1], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[2], globalIdxs[2], 1.0);
  gkyl_mat_triples_insert(tri, globalIdxs[2], globalIdxs[3], 0.0);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[0], (-0.1666666666666667*epsilon[0]*rdx2Sq[1])-0.1666666666666667*epsilon[0]*rdx2Sq[0]-0.05555555555555555*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[1], (-0.3333333333333333*epsilon[0]*rdx2Sq[1])-0.09622504486493762*kSq[1]+0.1666666666666667*epsilon[0]*rdx2Sq[0]-0.1111111111111111*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[2], (-0.09622504486493762*kSq[2])+0.1666666666666667*epsilon[0]*rdx2Sq[1]-0.3333333333333333*epsilon[0]*rdx2Sq[0]-0.1111111111111111*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[3], (-0.1666666666666667*kSq[3])-0.1924500897298752*kSq[2]+0.3333333333333333*epsilon[0]*rdx2Sq[1]-0.1924500897298752*kSq[1]+0.3333333333333333*epsilon[0]*rdx2Sq[0]-0.2222222222222222*kSq[0]);

}
void fem_poisson_lhs_stencil_consteps_2x_ser_p2_lox_dirichletx_loy_robiny(const double *epsilon, const double *kSq, const double *dx, const double *bcVals, const long *globalIdxs, gkyl_mat_triples *tri) 
{ 
  // epsilon: permittivity.
  // kSq: wave number squared (factor multiplying phi).
  // dx: cell length in each direction.
  // bcVals[3]: values to impose as BCs, i.e. bcVals[0]*phi+bcVals[1]*d(phi)/dx=bcVals[2].
  // globalIdxs: global linear index of each basis function/node in current cell.
  // tri: triples object (i,j,val), i.e. contribute val to i,j element of the global matrix.

  double rdx2Sq[2];
  rdx2Sq[0] = 4.0/(dx[0]*dx[0]);
  rdx2Sq[1] = 4.0/(dx[1]*dx[1]);

  gkyl_mat_triples_insert(tri, globalIdxs[0], globalIdxs[0], 1.0);
  gkyl_mat_triples_insert(tri, globalIdxs[0], globalIdxs[1], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[0], globalIdxs[2], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[0], globalIdxs[3], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[0], globalIdxs[4], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[0], globalIdxs[5], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[0], globalIdxs[6], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[0], globalIdxs[7], 0.0);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[0], 0.03442651863295482*kSq[7]-(0.1333333333333333*epsilon[0]*rdx2Sq[1]*bcVals[6])/bcVals[7]+0.0295084445425327*kSq[6]-0.05962847939999439*kSq[5]-0.063887656499994*kSq[4]-0.05333333333333333*kSq[3]+0.06666666666666667*epsilon[0]*rdx2Sq[1]+0.03849001794597505*kSq[1]-0.8888888888888888*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[1], (-(1.066666666666667*epsilon[0]*rdx2Sq[1]*bcVals[6])/bcVals[7])-0.1967229636168847*kSq[6]-0.07950463919999252*kSq[5]+0.2271561119999787*kSq[4]+0.3079201435678004*kSq[2]+0.5333333333333333*epsilon[0]*rdx2Sq[1]+1.777777777777778*epsilon[0]*rdx2Sq[0]-0.3555555555555556*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[2], (-0.03442651863295482*kSq[7])-(0.1333333333333333*epsilon[0]*rdx2Sq[1]*bcVals[6])/bcVals[7]+0.0295084445425327*kSq[6]-0.05962847939999439*kSq[5]-0.063887656499994*kSq[4]+0.05333333333333333*kSq[3]+0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.03849001794597505*kSq[1]-0.8888888888888888*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[3], (-0.03442651863295482*kSq[7])-0.03442651863295482*kSq[6]+0.09938079899999068*kSq[5]+0.09938079899999068*kSq[4]-0.02666666666666666*kSq[3]+0.0769800358919501*kSq[2]+0.0769800358919501*kSq[1]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[4], 0.03442651863295482*kSq[7]-0.03442651863295482*kSq[6]+0.09938079899999068*kSq[5]+0.09938079899999068*kSq[4]+0.02666666666666666*kSq[3]+0.0769800358919501*kSq[2]-0.0769800358919501*kSq[1]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[5], 0.01721325931647741*kSq[6]-0.03975231959999626*kSq[5]-0.05678902799999467*kSq[4]+0.01333333333333333*kSq[3]-0.03849001794597505*kSq[2]-0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.4444444444444444*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[6], 0.07950463919999252*kSq[5]+0.1135780559999893*kSq[4]-0.5333333333333333*epsilon[0]*rdx2Sq[1]+0.8888888888888888*epsilon[0]*rdx2Sq[0]-0.1777777777777778*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[7], 0.01721325931647741*kSq[6]-0.03975231959999626*kSq[5]-0.05678902799999467*kSq[4]-0.01333333333333333*kSq[3]-0.03849001794597505*kSq[2]-0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.4444444444444444*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[0], (0.06666666666666667*epsilon[0]*rdx2Sq[1]*bcVals[6])/bcVals[7]-0.006147592613027645*kSq[6]+0.03336355394999686*kSq[5]+0.02697478829999747*kSq[4]-0.01924500897298752*kSq[2]+0.1888888888888889*epsilon[0]*rdx2Sq[1]+0.3111111111111111*epsilon[0]*rdx2Sq[0]-0.02222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[1], (-0.03442651863295482*kSq[7])-(0.1333333333333333*epsilon[0]*rdx2Sq[1]*bcVals[6])/bcVals[7]+0.0295084445425327*kSq[6]-0.05962847939999439*kSq[5]-0.063887656499994*kSq[4]+0.05333333333333333*kSq[3]+0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.03849001794597505*kSq[1]-0.8888888888888888*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[2], (-0.04549218533640458*kSq[7])-(0.2666666666666667*epsilon[0]*rdx2Sq[1]*bcVals[6])/bcVals[7]+0.04549218533640458*kSq[6]-0.0127775312999988*kSq[5]-0.0127775312999988*kSq[4]+0.04666666666666667*kSq[3]+0.03849001794597505*kSq[2]+0.5777777777777777*epsilon[0]*rdx2Sq[1]-0.03849001794597505*kSq[1]+0.5777777777777777*epsilon[0]*rdx2Sq[0]-0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[3], 0.01721325931647741*kSq[7]-0.05678902799999467*kSq[5]-0.03975231959999626*kSq[4]+0.01333333333333333*kSq[3]-0.4444444444444444*epsilon[0]*rdx2Sq[1]-0.03849001794597505*kSq[1]-0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[4], (-0.0295084445425327*kSq[7])+0.03442651863295482*kSq[6]-0.063887656499994*kSq[5]-0.05962847939999439*kSq[4]+0.05333333333333333*kSq[3]+0.03849001794597505*kSq[2]-0.8888888888888888*epsilon[0]*rdx2Sq[1]+0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[5], 0.0234254740499978*kSq[5]+0.0234254740499978*kSq[4]-0.01333333333333333*kSq[3]+0.2555555555555555*epsilon[0]*rdx2Sq[1]+0.2555555555555555*epsilon[0]*rdx2Sq[0]-0.03333333333333333*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[6], (-0.01721325931647741*kSq[6])-0.03975231959999626*kSq[5]-0.05678902799999467*kSq[4]+0.01333333333333333*kSq[3]+0.03849001794597505*kSq[2]-0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.4444444444444444*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[7], 0.006147592613027645*kSq[7]+0.02697478829999747*kSq[5]+0.03336355394999686*kSq[4]+0.3111111111111111*epsilon[0]*rdx2Sq[1]+0.01924500897298752*kSq[1]+0.1888888888888889*epsilon[0]*rdx2Sq[0]-0.02222222222222222*kSq[0]);
  gkyl_mat_triples_insert(tri, globalIdxs[3], globalIdxs[0], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[3], globalIdxs[1], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[3], globalIdxs[2], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[3], globalIdxs[3], 1.0);
  gkyl_mat_triples_insert(tri, globalIdxs[3], globalIdxs[4], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[3], globalIdxs[5], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[3], globalIdxs[6], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[3], globalIdxs[7], 0.0);
  gkyl_mat_triples_accum(tri, globalIdxs[4], globalIdxs[0], (-0.01721325931647741*kSq[7])-0.05678902799999467*kSq[5]-0.03975231959999626*kSq[4]-0.01333333333333333*kSq[3]-0.4444444444444444*epsilon[0]*rdx2Sq[1]+0.03849001794597505*kSq[1]-0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[4], globalIdxs[1], 0.03442651863295482*kSq[7]-0.03442651863295482*kSq[6]+0.09938079899999068*kSq[5]+0.09938079899999068*kSq[4]+0.02666666666666666*kSq[3]+0.0769800358919501*kSq[2]-0.0769800358919501*kSq[1]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[4], globalIdxs[2], (-0.0295084445425327*kSq[7])+0.03442651863295482*kSq[6]-0.063887656499994*kSq[5]-0.05962847939999439*kSq[4]+0.05333333333333333*kSq[3]+0.03849001794597505*kSq[2]-0.8888888888888888*epsilon[0]*rdx2Sq[1]+0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[4], globalIdxs[3], 0.1135780559999893*kSq[5]+0.07950463919999252*kSq[4]+0.8888888888888888*epsilon[0]*rdx2Sq[1]-0.5333333333333333*epsilon[0]*rdx2Sq[0]-0.1777777777777778*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[4], globalIdxs[4], 0.1967229636168847*kSq[7]+0.2271561119999787*kSq[5]-0.07950463919999252*kSq[4]+1.777777777777778*epsilon[0]*rdx2Sq[1]-0.3079201435678004*kSq[1]+0.5333333333333333*epsilon[0]*rdx2Sq[0]-0.3555555555555556*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[4], globalIdxs[5], (-0.01721325931647741*kSq[7])-0.05678902799999467*kSq[5]-0.03975231959999626*kSq[4]+0.01333333333333333*kSq[3]-0.4444444444444444*epsilon[0]*rdx2Sq[1]+0.03849001794597505*kSq[1]-0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[4], globalIdxs[6], 0.03442651863295482*kSq[7]+0.03442651863295482*kSq[6]+0.09938079899999068*kSq[5]+0.09938079899999068*kSq[4]-0.02666666666666666*kSq[3]-0.0769800358919501*kSq[2]-0.0769800358919501*kSq[1]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[4], globalIdxs[7], (-0.0295084445425327*kSq[7])-0.03442651863295482*kSq[6]-0.063887656499994*kSq[5]-0.05962847939999439*kSq[4]-0.05333333333333333*kSq[3]-0.03849001794597505*kSq[2]-0.8888888888888888*epsilon[0]*rdx2Sq[1]+0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_insert(tri, globalIdxs[5], globalIdxs[0], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[5], globalIdxs[1], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[5], globalIdxs[2], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[5], globalIdxs[3], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[5], globalIdxs[4], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[5], globalIdxs[5], 1.0);
  gkyl_mat_triples_insert(tri, globalIdxs[5], globalIdxs[6], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[5], globalIdxs[7], 0.0);
  gkyl_mat_triples_accum(tri, globalIdxs[6], globalIdxs[0], (-0.01721325931647741*kSq[6])-0.03975231959999626*kSq[5]-0.05678902799999467*kSq[4]-0.01333333333333333*kSq[3]+0.03849001794597505*kSq[2]-0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.4444444444444444*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[6], globalIdxs[1], 0.07950463919999252*kSq[5]+0.1135780559999893*kSq[4]-0.5333333333333333*epsilon[0]*rdx2Sq[1]+0.8888888888888888*epsilon[0]*rdx2Sq[0]-0.1777777777777778*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[6], globalIdxs[2], (-0.01721325931647741*kSq[6])-0.03975231959999626*kSq[5]-0.05678902799999467*kSq[4]+0.01333333333333333*kSq[3]+0.03849001794597505*kSq[2]-0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.4444444444444444*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[6], globalIdxs[3], (-0.03442651863295482*kSq[7])+0.03442651863295482*kSq[6]+0.09938079899999068*kSq[5]+0.09938079899999068*kSq[4]+0.02666666666666666*kSq[3]-0.0769800358919501*kSq[2]+0.0769800358919501*kSq[1]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[6], globalIdxs[4], 0.03442651863295482*kSq[7]+0.03442651863295482*kSq[6]+0.09938079899999068*kSq[5]+0.09938079899999068*kSq[4]-0.02666666666666666*kSq[3]-0.0769800358919501*kSq[2]-0.0769800358919501*kSq[1]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[6], globalIdxs[5], 0.03442651863295482*kSq[7]-0.0295084445425327*kSq[6]-0.05962847939999439*kSq[5]-0.063887656499994*kSq[4]+0.05333333333333333*kSq[3]+0.06666666666666667*epsilon[0]*rdx2Sq[1]+0.03849001794597505*kSq[1]-0.8888888888888888*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[6], globalIdxs[6], 0.1967229636168847*kSq[6]-0.07950463919999252*kSq[5]+0.2271561119999787*kSq[4]-0.3079201435678004*kSq[2]+0.5333333333333333*epsilon[0]*rdx2Sq[1]+1.777777777777778*epsilon[0]*rdx2Sq[0]-0.3555555555555556*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[6], globalIdxs[7], (-0.03442651863295482*kSq[7])-0.0295084445425327*kSq[6]-0.05962847939999439*kSq[5]-0.063887656499994*kSq[4]-0.05333333333333333*kSq[3]+0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.03849001794597505*kSq[1]-0.8888888888888888*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[7], globalIdxs[0], 0.0234254740499978*kSq[5]+0.0234254740499978*kSq[4]+0.01333333333333333*kSq[3]+0.2555555555555555*epsilon[0]*rdx2Sq[1]+0.2555555555555555*epsilon[0]*rdx2Sq[0]-0.03333333333333333*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[7], globalIdxs[1], 0.01721325931647741*kSq[6]-0.03975231959999626*kSq[5]-0.05678902799999467*kSq[4]-0.01333333333333333*kSq[3]-0.03849001794597505*kSq[2]-0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.4444444444444444*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[7], globalIdxs[2], 0.006147592613027645*kSq[7]+0.02697478829999747*kSq[5]+0.03336355394999686*kSq[4]+0.3111111111111111*epsilon[0]*rdx2Sq[1]+0.01924500897298752*kSq[1]+0.1888888888888889*epsilon[0]*rdx2Sq[0]-0.02222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[7], globalIdxs[3], 0.01721325931647741*kSq[7]-0.05678902799999467*kSq[5]-0.03975231959999626*kSq[4]-0.01333333333333333*kSq[3]-0.4444444444444444*epsilon[0]*rdx2Sq[1]-0.03849001794597505*kSq[1]-0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[7], globalIdxs[4], (-0.0295084445425327*kSq[7])-0.03442651863295482*kSq[6]-0.063887656499994*kSq[5]-0.05962847939999439*kSq[4]-0.05333333333333333*kSq[3]-0.03849001794597505*kSq[2]-0.8888888888888888*epsilon[0]*rdx2Sq[1]+0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[7], globalIdxs[5], 0.006147592613027645*kSq[6]+0.03336355394999686*kSq[5]+0.02697478829999747*kSq[4]+0.01924500897298752*kSq[2]+0.1888888888888889*epsilon[0]*rdx2Sq[1]+0.3111111111111111*epsilon[0]*rdx2Sq[0]-0.02222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[7], globalIdxs[6], (-0.03442651863295482*kSq[7])-0.0295084445425327*kSq[6]-0.05962847939999439*kSq[5]-0.063887656499994*kSq[4]-0.05333333333333333*kSq[3]+0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.03849001794597505*kSq[1]-0.8888888888888888*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[7], globalIdxs[7], (-0.04549218533640458*kSq[7])-0.04549218533640458*kSq[6]-0.0127775312999988*kSq[5]-0.0127775312999988*kSq[4]-0.04666666666666667*kSq[3]-0.03849001794597505*kSq[2]+0.5777777777777777*epsilon[0]*rdx2Sq[1]-0.03849001794597505*kSq[1]+0.5777777777777777*epsilon[0]*rdx2Sq[0]-0.06666666666666667*kSq[0]);

}
void fem_poisson_lhs_stencil_consteps_2x_ser_p1_lox_neumannx_loy_periodicy(const double *epsilon, const double *kSq, const double *dx, const double *bcVals, const long *globalIdxs, gkyl_mat_triples *tri) 
{ 
  // epsilon: permittivity.
  // kSq: wave number squared (factor multiplying phi).
  // dx: cell length in each direction.
  // bcVals[3]: values to impose as BCs, i.e. bcVals[0]*phi+bcVals[1]*d(phi)/dx=bcVals[2].
  // globalIdxs: global linear index of each basis function/node in current cell.
  // tri: triples object (i,j,val), i.e. contribute val to i,j element of the global matrix.

  double rdx2Sq[2];
  rdx2Sq[0] = 4.0/(dx[0]*dx[0]);
  rdx2Sq[1] = 4.0/(dx[1]*dx[1]);

  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[0], (-0.1666666666666667*kSq[3])+0.1924500897298752*kSq[2]+0.3333333333333333*epsilon[0]*rdx2Sq[1]+0.1924500897298752*kSq[1]+0.3333333333333333*epsilon[0]*rdx2Sq[0]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[1], 0.09622504486493762*kSq[2]+0.1666666666666667*epsilon[0]*rdx2Sq[1]-0.3333333333333333*epsilon[0]*rdx2Sq[0]-0.1111111111111111*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[2], (-0.3333333333333333*epsilon[0]*rdx2Sq[1])+0.09622504486493762*kSq[1]+0.1666666666666667*epsilon[0]*rdx2Sq[0]-0.1111111111111111*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[3], (-0.1666666666666667*epsilon[0]*rdx2Sq[1])-0.1666666666666667*epsilon[0]*rdx2Sq[0]-0.05555555555555555*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[0], 0.09622504486493762*kSq[2]+0.1666666666666667*epsilon[0]*rdx2Sq[1]-0.3333333333333333*epsilon[0]*rdx2Sq[0]-0.1111111111111111*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[1], 0.1666666666666667*kSq[3]+0.1924500897298752*kSq[2]+0.3333333333333333*epsilon[0]*rdx2Sq[1]-0.1924500897298752*kSq[1]+0.3333333333333333*epsilon[0]*rdx2Sq[0]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[2], (-0.1666666666666667*epsilon[0]*rdx2Sq[1])-0.1666666666666667*epsilon[0]*rdx2Sq[0]-0.05555555555555555*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[3], (-0.3333333333333333*epsilon[0]*rdx2Sq[1])-0.09622504486493762*kSq[1]+0.1666666666666667*epsilon[0]*rdx2Sq[0]-0.1111111111111111*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[0], (-0.3333333333333333*epsilon[0]*rdx2Sq[1])+0.09622504486493762*kSq[1]+0.1666666666666667*epsilon[0]*rdx2Sq[0]-0.1111111111111111*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[1], (-0.1666666666666667*epsilon[0]*rdx2Sq[1])-0.1666666666666667*epsilon[0]*rdx2Sq[0]-0.05555555555555555*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[2], 0.1666666666666667*kSq[3]-0.1924500897298752*kSq[2]+0.3333333333333333*epsilon[0]*rdx2Sq[1]+0.1924500897298752*kSq[1]+0.3333333333333333*epsilon[0]*rdx2Sq[0]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[3], (-0.09622504486493762*kSq[2])+0.1666666666666667*epsilon[0]*rdx2Sq[1]-0.3333333333333333*epsilon[0]*rdx2Sq[0]-0.1111111111111111*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[0], (-0.1666666666666667*epsilon[0]*rdx2Sq[1])-0.1666666666666667*epsilon[0]*rdx2Sq[0]-0.05555555555555555*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[1], (-0.3333333333333333*epsilon[0]*rdx2Sq[1])-0.09622504486493762*kSq[1]+0.1666666666666667*epsilon[0]*rdx2Sq[0]-0.1111111111111111*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[2], (-0.09622504486493762*kSq[2])+0.1666666666666667*epsilon[0]*rdx2Sq[1]-0.3333333333333333*epsilon[0]*rdx2Sq[0]-0.1111111111111111*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[3], (-0.1666666666666667*kSq[3])-0.1924500897298752*kSq[2]+0.3333333333333333*epsilon[0]*rdx2Sq[1]-0.1924500897298752*kSq[1]+0.3333333333333333*epsilon[0]*rdx2Sq[0]-0.2222222222222222*kSq[0]);

}
void fem_poisson_lhs_stencil_consteps_2x_ser_p2_lox_neumannx_loy_periodicy(const double *epsilon, const double *kSq, const double *dx, const double *bcVals, const long *globalIdxs, gkyl_mat_triples *tri) 
{ 
  // epsilon: permittivity.
  // kSq: wave number squared (factor multiplying phi).
  // dx: cell length in each direction.
  // bcVals[3]: values to impose as BCs, i.e. bcVals[0]*phi+bcVals[1]*d(phi)/dx=bcVals[2].
  // globalIdxs: global linear index of each basis function/node in current cell.
  // tri: triples object (i,j,val), i.e. contribute val to i,j element of the global matrix.

  double rdx2Sq[2];
  rdx2Sq[0] = 4.0/(dx[0]*dx[0]);
  rdx2Sq[1] = 4.0/(dx[1]*dx[1]);

  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[0], 0.04549218533640458*kSq[7]+0.04549218533640458*kSq[6]-0.0127775312999988*kSq[5]-0.0127775312999988*kSq[4]-0.04666666666666667*kSq[3]+0.03849001794597505*kSq[2]+0.5777777777777777*epsilon[0]*rdx2Sq[1]+0.03849001794597505*kSq[1]+0.5777777777777777*epsilon[0]*rdx2Sq[0]-0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[1], 0.03442651863295482*kSq[7]+0.0295084445425327*kSq[6]-0.05962847939999439*kSq[5]-0.063887656499994*kSq[4]-0.05333333333333333*kSq[3]+0.06666666666666667*epsilon[0]*rdx2Sq[1]+0.03849001794597505*kSq[1]-0.8888888888888888*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[2], (-0.006147592613027645*kSq[6])+0.03336355394999686*kSq[5]+0.02697478829999747*kSq[4]-0.01924500897298752*kSq[2]+0.1888888888888889*epsilon[0]*rdx2Sq[1]+0.3111111111111111*epsilon[0]*rdx2Sq[0]-0.02222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[3], 0.0295084445425327*kSq[7]+0.03442651863295482*kSq[6]-0.063887656499994*kSq[5]-0.05962847939999439*kSq[4]-0.05333333333333333*kSq[3]+0.03849001794597505*kSq[2]-0.8888888888888888*epsilon[0]*rdx2Sq[1]+0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[4], (-0.01721325931647741*kSq[7])-0.05678902799999467*kSq[5]-0.03975231959999626*kSq[4]-0.01333333333333333*kSq[3]-0.4444444444444444*epsilon[0]*rdx2Sq[1]+0.03849001794597505*kSq[1]-0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[5], (-0.006147592613027645*kSq[7])+0.02697478829999747*kSq[5]+0.03336355394999686*kSq[4]+0.3111111111111111*epsilon[0]*rdx2Sq[1]-0.01924500897298752*kSq[1]+0.1888888888888889*epsilon[0]*rdx2Sq[0]-0.02222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[6], (-0.01721325931647741*kSq[6])-0.03975231959999626*kSq[5]-0.05678902799999467*kSq[4]-0.01333333333333333*kSq[3]+0.03849001794597505*kSq[2]-0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.4444444444444444*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[7], 0.0234254740499978*kSq[5]+0.0234254740499978*kSq[4]+0.01333333333333333*kSq[3]+0.2555555555555555*epsilon[0]*rdx2Sq[1]+0.2555555555555555*epsilon[0]*rdx2Sq[0]-0.03333333333333333*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[0], 0.03442651863295482*kSq[7]+0.0295084445425327*kSq[6]-0.05962847939999439*kSq[5]-0.063887656499994*kSq[4]-0.05333333333333333*kSq[3]+0.06666666666666667*epsilon[0]*rdx2Sq[1]+0.03849001794597505*kSq[1]-0.8888888888888888*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[1], (-0.1967229636168847*kSq[6])-0.07950463919999252*kSq[5]+0.2271561119999787*kSq[4]+0.3079201435678004*kSq[2]+0.5333333333333333*epsilon[0]*rdx2Sq[1]+1.777777777777778*epsilon[0]*rdx2Sq[0]-0.3555555555555556*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[2], (-0.03442651863295482*kSq[7])+0.0295084445425327*kSq[6]-0.05962847939999439*kSq[5]-0.063887656499994*kSq[4]+0.05333333333333333*kSq[3]+0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.03849001794597505*kSq[1]-0.8888888888888888*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[3], (-0.03442651863295482*kSq[7])-0.03442651863295482*kSq[6]+0.09938079899999068*kSq[5]+0.09938079899999068*kSq[4]-0.02666666666666666*kSq[3]+0.0769800358919501*kSq[2]+0.0769800358919501*kSq[1]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[4], 0.03442651863295482*kSq[7]-0.03442651863295482*kSq[6]+0.09938079899999068*kSq[5]+0.09938079899999068*kSq[4]+0.02666666666666666*kSq[3]+0.0769800358919501*kSq[2]-0.0769800358919501*kSq[1]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[5], 0.01721325931647741*kSq[6]-0.03975231959999626*kSq[5]-0.05678902799999467*kSq[4]+0.01333333333333333*kSq[3]-0.03849001794597505*kSq[2]-0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.4444444444444444*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[6], 0.07950463919999252*kSq[5]+0.1135780559999893*kSq[4]-0.5333333333333333*epsilon[0]*rdx2Sq[1]+0.8888888888888888*epsilon[0]*rdx2Sq[0]-0.1777777777777778*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[7], 0.01721325931647741*kSq[6]-0.03975231959999626*kSq[5]-0.05678902799999467*kSq[4]-0.01333333333333333*kSq[3]-0.03849001794597505*kSq[2]-0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.4444444444444444*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[0], (-0.006147592613027645*kSq[6])+0.03336355394999686*kSq[5]+0.02697478829999747*kSq[4]-0.01924500897298752*kSq[2]+0.1888888888888889*epsilon[0]*rdx2Sq[1]+0.3111111111111111*epsilon[0]*rdx2Sq[0]-0.02222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[1], (-0.03442651863295482*kSq[7])+0.0295084445425327*kSq[6]-0.05962847939999439*kSq[5]-0.063887656499994*kSq[4]+0.05333333333333333*kSq[3]+0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.03849001794597505*kSq[1]-0.8888888888888888*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[2], (-0.04549218533640458*kSq[7])+0.04549218533640458*kSq[6]-0.0127775312999988*kSq[5]-0.0127775312999988*kSq[4]+0.04666666666666667*kSq[3]+0.03849001794597505*kSq[2]+0.5777777777777777*epsilon[0]*rdx2Sq[1]-0.03849001794597505*kSq[1]+0.5777777777777777*epsilon[0]*rdx2Sq[0]-0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[3], 0.01721325931647741*kSq[7]-0.05678902799999467*kSq[5]-0.03975231959999626*kSq[4]+0.01333333333333333*kSq[3]-0.4444444444444444*epsilon[0]*rdx2Sq[1]-0.03849001794597505*kSq[1]-0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[4], (-0.0295084445425327*kSq[7])+0.03442651863295482*kSq[6]-0.063887656499994*kSq[5]-0.05962847939999439*kSq[4]+0.05333333333333333*kSq[3]+0.03849001794597505*kSq[2]-0.8888888888888888*epsilon[0]*rdx2Sq[1]+0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[5], 0.0234254740499978*kSq[5]+0.0234254740499978*kSq[4]-0.01333333333333333*kSq[3]+0.2555555555555555*epsilon[0]*rdx2Sq[1]+0.2555555555555555*epsilon[0]*rdx2Sq[0]-0.03333333333333333*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[6], (-0.01721325931647741*kSq[6])-0.03975231959999626*kSq[5]-0.05678902799999467*kSq[4]+0.01333333333333333*kSq[3]+0.03849001794597505*kSq[2]-0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.4444444444444444*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[7], 0.006147592613027645*kSq[7]+0.02697478829999747*kSq[5]+0.03336355394999686*kSq[4]+0.3111111111111111*epsilon[0]*rdx2Sq[1]+0.01924500897298752*kSq[1]+0.1888888888888889*epsilon[0]*rdx2Sq[0]-0.02222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[0], 0.0295084445425327*kSq[7]+0.03442651863295482*kSq[6]-0.063887656499994*kSq[5]-0.05962847939999439*kSq[4]-0.05333333333333333*kSq[3]+0.03849001794597505*kSq[2]-0.8888888888888888*epsilon[0]*rdx2Sq[1]+0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[1], (-0.03442651863295482*kSq[7])-0.03442651863295482*kSq[6]+0.09938079899999068*kSq[5]+0.09938079899999068*kSq[4]-0.02666666666666666*kSq[3]+0.0769800358919501*kSq[2]+0.0769800358919501*kSq[1]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[2], 0.01721325931647741*kSq[7]-0.05678902799999467*kSq[5]-0.03975231959999626*kSq[4]+0.01333333333333333*kSq[3]-0.4444444444444444*epsilon[0]*rdx2Sq[1]-0.03849001794597505*kSq[1]-0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[3], (-0.1967229636168847*kSq[7])+0.2271561119999787*kSq[5]-0.07950463919999252*kSq[4]+1.777777777777778*epsilon[0]*rdx2Sq[1]+0.3079201435678004*kSq[1]+0.5333333333333333*epsilon[0]*rdx2Sq[0]-0.3555555555555556*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[4], 0.1135780559999893*kSq[5]+0.07950463919999252*kSq[4]+0.8888888888888888*epsilon[0]*rdx2Sq[1]-0.5333333333333333*epsilon[0]*rdx2Sq[0]-0.1777777777777778*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[5], 0.0295084445425327*kSq[7]-0.03442651863295482*kSq[6]-0.063887656499994*kSq[5]-0.05962847939999439*kSq[4]+0.05333333333333333*kSq[3]-0.03849001794597505*kSq[2]-0.8888888888888888*epsilon[0]*rdx2Sq[1]+0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[6], (-0.03442651863295482*kSq[7])+0.03442651863295482*kSq[6]+0.09938079899999068*kSq[5]+0.09938079899999068*kSq[4]+0.02666666666666666*kSq[3]-0.0769800358919501*kSq[2]+0.0769800358919501*kSq[1]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[7], 0.01721325931647741*kSq[7]-0.05678902799999467*kSq[5]-0.03975231959999626*kSq[4]-0.01333333333333333*kSq[3]-0.4444444444444444*epsilon[0]*rdx2Sq[1]-0.03849001794597505*kSq[1]-0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[4], globalIdxs[0], (-0.01721325931647741*kSq[7])-0.05678902799999467*kSq[5]-0.03975231959999626*kSq[4]-0.01333333333333333*kSq[3]-0.4444444444444444*epsilon[0]*rdx2Sq[1]+0.03849001794597505*kSq[1]-0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[4], globalIdxs[1], 0.03442651863295482*kSq[7]-0.03442651863295482*kSq[6]+0.09938079899999068*kSq[5]+0.09938079899999068*kSq[4]+0.02666666666666666*kSq[3]+0.0769800358919501*kSq[2]-0.0769800358919501*kSq[1]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[4], globalIdxs[2], (-0.0295084445425327*kSq[7])+0.03442651863295482*kSq[6]-0.063887656499994*kSq[5]-0.05962847939999439*kSq[4]+0.05333333333333333*kSq[3]+0.03849001794597505*kSq[2]-0.8888888888888888*epsilon[0]*rdx2Sq[1]+0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[4], globalIdxs[3], 0.1135780559999893*kSq[5]+0.07950463919999252*kSq[4]+0.8888888888888888*epsilon[0]*rdx2Sq[1]-0.5333333333333333*epsilon[0]*rdx2Sq[0]-0.1777777777777778*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[4], globalIdxs[4], 0.1967229636168847*kSq[7]+0.2271561119999787*kSq[5]-0.07950463919999252*kSq[4]+1.777777777777778*epsilon[0]*rdx2Sq[1]-0.3079201435678004*kSq[1]+0.5333333333333333*epsilon[0]*rdx2Sq[0]-0.3555555555555556*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[4], globalIdxs[5], (-0.01721325931647741*kSq[7])-0.05678902799999467*kSq[5]-0.03975231959999626*kSq[4]+0.01333333333333333*kSq[3]-0.4444444444444444*epsilon[0]*rdx2Sq[1]+0.03849001794597505*kSq[1]-0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[4], globalIdxs[6], 0.03442651863295482*kSq[7]+0.03442651863295482*kSq[6]+0.09938079899999068*kSq[5]+0.09938079899999068*kSq[4]-0.02666666666666666*kSq[3]-0.0769800358919501*kSq[2]-0.0769800358919501*kSq[1]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[4], globalIdxs[7], (-0.0295084445425327*kSq[7])-0.03442651863295482*kSq[6]-0.063887656499994*kSq[5]-0.05962847939999439*kSq[4]-0.05333333333333333*kSq[3]-0.03849001794597505*kSq[2]-0.8888888888888888*epsilon[0]*rdx2Sq[1]+0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[5], globalIdxs[0], (-0.006147592613027645*kSq[7])+0.02697478829999747*kSq[5]+0.03336355394999686*kSq[4]+0.3111111111111111*epsilon[0]*rdx2Sq[1]-0.01924500897298752*kSq[1]+0.1888888888888889*epsilon[0]*rdx2Sq[0]-0.02222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[5], globalIdxs[1], 0.01721325931647741*kSq[6]-0.03975231959999626*kSq[5]-0.05678902799999467*kSq[4]+0.01333333333333333*kSq[3]-0.03849001794597505*kSq[2]-0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.4444444444444444*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[5], globalIdxs[2], 0.0234254740499978*kSq[5]+0.0234254740499978*kSq[4]-0.01333333333333333*kSq[3]+0.2555555555555555*epsilon[0]*rdx2Sq[1]+0.2555555555555555*epsilon[0]*rdx2Sq[0]-0.03333333333333333*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[5], globalIdxs[3], 0.0295084445425327*kSq[7]-0.03442651863295482*kSq[6]-0.063887656499994*kSq[5]-0.05962847939999439*kSq[4]+0.05333333333333333*kSq[3]-0.03849001794597505*kSq[2]-0.8888888888888888*epsilon[0]*rdx2Sq[1]+0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[5], globalIdxs[4], (-0.01721325931647741*kSq[7])-0.05678902799999467*kSq[5]-0.03975231959999626*kSq[4]+0.01333333333333333*kSq[3]-0.4444444444444444*epsilon[0]*rdx2Sq[1]+0.03849001794597505*kSq[1]-0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[5], globalIdxs[5], 0.04549218533640458*kSq[7]-0.04549218533640458*kSq[6]-0.0127775312999988*kSq[5]-0.0127775312999988*kSq[4]+0.04666666666666667*kSq[3]-0.03849001794597505*kSq[2]+0.5777777777777777*epsilon[0]*rdx2Sq[1]+0.03849001794597505*kSq[1]+0.5777777777777777*epsilon[0]*rdx2Sq[0]-0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[5], globalIdxs[6], 0.03442651863295482*kSq[7]-0.0295084445425327*kSq[6]-0.05962847939999439*kSq[5]-0.063887656499994*kSq[4]+0.05333333333333333*kSq[3]+0.06666666666666667*epsilon[0]*rdx2Sq[1]+0.03849001794597505*kSq[1]-0.8888888888888888*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[5], globalIdxs[7], 0.006147592613027645*kSq[6]+0.03336355394999686*kSq[5]+0.02697478829999747*kSq[4]+0.01924500897298752*kSq[2]+0.1888888888888889*epsilon[0]*rdx2Sq[1]+0.3111111111111111*epsilon[0]*rdx2Sq[0]-0.02222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[6], globalIdxs[0], (-0.01721325931647741*kSq[6])-0.03975231959999626*kSq[5]-0.05678902799999467*kSq[4]-0.01333333333333333*kSq[3]+0.03849001794597505*kSq[2]-0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.4444444444444444*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[6], globalIdxs[1], 0.07950463919999252*kSq[5]+0.1135780559999893*kSq[4]-0.5333333333333333*epsilon[0]*rdx2Sq[1]+0.8888888888888888*epsilon[0]*rdx2Sq[0]-0.1777777777777778*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[6], globalIdxs[2], (-0.01721325931647741*kSq[6])-0.03975231959999626*kSq[5]-0.05678902799999467*kSq[4]+0.01333333333333333*kSq[3]+0.03849001794597505*kSq[2]-0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.4444444444444444*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[6], globalIdxs[3], (-0.03442651863295482*kSq[7])+0.03442651863295482*kSq[6]+0.09938079899999068*kSq[5]+0.09938079899999068*kSq[4]+0.02666666666666666*kSq[3]-0.0769800358919501*kSq[2]+0.0769800358919501*kSq[1]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[6], globalIdxs[4], 0.03442651863295482*kSq[7]+0.03442651863295482*kSq[6]+0.09938079899999068*kSq[5]+0.09938079899999068*kSq[4]-0.02666666666666666*kSq[3]-0.0769800358919501*kSq[2]-0.0769800358919501*kSq[1]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[6], globalIdxs[5], 0.03442651863295482*kSq[7]-0.0295084445425327*kSq[6]-0.05962847939999439*kSq[5]-0.063887656499994*kSq[4]+0.05333333333333333*kSq[3]+0.06666666666666667*epsilon[0]*rdx2Sq[1]+0.03849001794597505*kSq[1]-0.8888888888888888*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[6], globalIdxs[6], 0.1967229636168847*kSq[6]-0.07950463919999252*kSq[5]+0.2271561119999787*kSq[4]-0.3079201435678004*kSq[2]+0.5333333333333333*epsilon[0]*rdx2Sq[1]+1.777777777777778*epsilon[0]*rdx2Sq[0]-0.3555555555555556*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[6], globalIdxs[7], (-0.03442651863295482*kSq[7])-0.0295084445425327*kSq[6]-0.05962847939999439*kSq[5]-0.063887656499994*kSq[4]-0.05333333333333333*kSq[3]+0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.03849001794597505*kSq[1]-0.8888888888888888*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[7], globalIdxs[0], 0.0234254740499978*kSq[5]+0.0234254740499978*kSq[4]+0.01333333333333333*kSq[3]+0.2555555555555555*epsilon[0]*rdx2Sq[1]+0.2555555555555555*epsilon[0]*rdx2Sq[0]-0.03333333333333333*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[7], globalIdxs[1], 0.01721325931647741*kSq[6]-0.03975231959999626*kSq[5]-0.05678902799999467*kSq[4]-0.01333333333333333*kSq[3]-0.03849001794597505*kSq[2]-0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.4444444444444444*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[7], globalIdxs[2], 0.006147592613027645*kSq[7]+0.02697478829999747*kSq[5]+0.03336355394999686*kSq[4]+0.3111111111111111*epsilon[0]*rdx2Sq[1]+0.01924500897298752*kSq[1]+0.1888888888888889*epsilon[0]*rdx2Sq[0]-0.02222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[7], globalIdxs[3], 0.01721325931647741*kSq[7]-0.05678902799999467*kSq[5]-0.03975231959999626*kSq[4]-0.01333333333333333*kSq[3]-0.4444444444444444*epsilon[0]*rdx2Sq[1]-0.03849001794597505*kSq[1]-0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[7], globalIdxs[4], (-0.0295084445425327*kSq[7])-0.03442651863295482*kSq[6]-0.063887656499994*kSq[5]-0.05962847939999439*kSq[4]-0.05333333333333333*kSq[3]-0.03849001794597505*kSq[2]-0.8888888888888888*epsilon[0]*rdx2Sq[1]+0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[7], globalIdxs[5], 0.006147592613027645*kSq[6]+0.03336355394999686*kSq[5]+0.02697478829999747*kSq[4]+0.01924500897298752*kSq[2]+0.1888888888888889*epsilon[0]*rdx2Sq[1]+0.3111111111111111*epsilon[0]*rdx2Sq[0]-0.02222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[7], globalIdxs[6], (-0.03442651863295482*kSq[7])-0.0295084445425327*kSq[6]-0.05962847939999439*kSq[5]-0.063887656499994*kSq[4]-0.05333333333333333*kSq[3]+0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.03849001794597505*kSq[1]-0.8888888888888888*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[7], globalIdxs[7], (-0.04549218533640458*kSq[7])-0.04549218533640458*kSq[6]-0.0127775312999988*kSq[5]-0.0127775312999988*kSq[4]-0.04666666666666667*kSq[3]-0.03849001794597505*kSq[2]+0.5777777777777777*epsilon[0]*rdx2Sq[1]-0.03849001794597505*kSq[1]+0.5777777777777777*epsilon[0]*rdx2Sq[0]-0.06666666666666667*kSq[0]);

}
void fem_poisson_lhs_stencil_consteps_2x_ser_p1_lox_neumannx_loy_dirichlety(const double *epsilon, const double *kSq, const double *dx, const double *bcVals, const long *globalIdxs, gkyl_mat_triples *tri) 
{ 
  // epsilon: permittivity.
  // kSq: wave number squared (factor multiplying phi).
  // dx: cell length in each direction.
  // bcVals[3]: values to impose as BCs, i.e. bcVals[0]*phi+bcVals[1]*d(phi)/dx=bcVals[2].
  // globalIdxs: global linear index of each basis function/node in current cell.
  // tri: triples object (i,j,val), i.e. contribute val to i,j element of the global matrix.

  double rdx2Sq[2];
  rdx2Sq[0] = 4.0/(dx[0]*dx[0]);
  rdx2Sq[1] = 4.0/(dx[1]*dx[1]);

  gkyl_mat_triples_insert(tri, globalIdxs[0], globalIdxs[0], 1.0);
  gkyl_mat_triples_insert(tri, globalIdxs[0], globalIdxs[1], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[0], globalIdxs[2], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[0], globalIdxs[3], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[1], globalIdxs[0], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[1], globalIdxs[1], 1.0);
  gkyl_mat_triples_insert(tri, globalIdxs[1], globalIdxs[2], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[1], globalIdxs[3], 0.0);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[0], (-0.3333333333333333*epsilon[0]*rdx2Sq[1])+0.09622504486493762*kSq[1]+0.1666666666666667*epsilon[0]*rdx2Sq[0]-0.1111111111111111*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[1], (-0.1666666666666667*epsilon[0]*rdx2Sq[1])-0.1666666666666667*epsilon[0]*rdx2Sq[0]-0.05555555555555555*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[2], 0.1666666666666667*kSq[3]-0.1924500897298752*kSq[2]+0.3333333333333333*epsilon[0]*rdx2Sq[1]+0.1924500897298752*kSq[1]+0.3333333333333333*epsilon[0]*rdx2Sq[0]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[3], (-0.09622504486493762*kSq[2])+0.1666666666666667*epsilon[0]*rdx2Sq[1]-0.3333333333333333*epsilon[0]*rdx2Sq[0]-0.1111111111111111*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[0], (-0.1666666666666667*epsilon[0]*rdx2Sq[1])-0.1666666666666667*epsilon[0]*rdx2Sq[0]-0.05555555555555555*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[1], (-0.3333333333333333*epsilon[0]*rdx2Sq[1])-0.09622504486493762*kSq[1]+0.1666666666666667*epsilon[0]*rdx2Sq[0]-0.1111111111111111*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[2], (-0.09622504486493762*kSq[2])+0.1666666666666667*epsilon[0]*rdx2Sq[1]-0.3333333333333333*epsilon[0]*rdx2Sq[0]-0.1111111111111111*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[3], (-0.1666666666666667*kSq[3])-0.1924500897298752*kSq[2]+0.3333333333333333*epsilon[0]*rdx2Sq[1]-0.1924500897298752*kSq[1]+0.3333333333333333*epsilon[0]*rdx2Sq[0]-0.2222222222222222*kSq[0]);

}
void fem_poisson_lhs_stencil_consteps_2x_ser_p2_lox_neumannx_loy_dirichlety(const double *epsilon, const double *kSq, const double *dx, const double *bcVals, const long *globalIdxs, gkyl_mat_triples *tri) 
{ 
  // epsilon: permittivity.
  // kSq: wave number squared (factor multiplying phi).
  // dx: cell length in each direction.
  // bcVals[3]: values to impose as BCs, i.e. bcVals[0]*phi+bcVals[1]*d(phi)/dx=bcVals[2].
  // globalIdxs: global linear index of each basis function/node in current cell.
  // tri: triples object (i,j,val), i.e. contribute val to i,j element of the global matrix.

  double rdx2Sq[2];
  rdx2Sq[0] = 4.0/(dx[0]*dx[0]);
  rdx2Sq[1] = 4.0/(dx[1]*dx[1]);

  gkyl_mat_triples_insert(tri, globalIdxs[0], globalIdxs[0], 1.0);
  gkyl_mat_triples_insert(tri, globalIdxs[0], globalIdxs[1], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[0], globalIdxs[2], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[0], globalIdxs[3], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[0], globalIdxs[4], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[0], globalIdxs[5], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[0], globalIdxs[6], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[0], globalIdxs[7], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[1], globalIdxs[0], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[1], globalIdxs[1], 1.0);
  gkyl_mat_triples_insert(tri, globalIdxs[1], globalIdxs[2], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[1], globalIdxs[3], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[1], globalIdxs[4], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[1], globalIdxs[5], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[1], globalIdxs[6], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[1], globalIdxs[7], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[2], globalIdxs[0], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[2], globalIdxs[1], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[2], globalIdxs[2], 1.0);
  gkyl_mat_triples_insert(tri, globalIdxs[2], globalIdxs[3], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[2], globalIdxs[4], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[2], globalIdxs[5], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[2], globalIdxs[6], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[2], globalIdxs[7], 0.0);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[0], 0.0295084445425327*kSq[7]+0.03442651863295482*kSq[6]-0.063887656499994*kSq[5]-0.05962847939999439*kSq[4]-0.05333333333333333*kSq[3]+0.03849001794597505*kSq[2]-0.8888888888888888*epsilon[0]*rdx2Sq[1]+0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[1], (-0.03442651863295482*kSq[7])-0.03442651863295482*kSq[6]+0.09938079899999068*kSq[5]+0.09938079899999068*kSq[4]-0.02666666666666666*kSq[3]+0.0769800358919501*kSq[2]+0.0769800358919501*kSq[1]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[2], 0.01721325931647741*kSq[7]-0.05678902799999467*kSq[5]-0.03975231959999626*kSq[4]+0.01333333333333333*kSq[3]-0.4444444444444444*epsilon[0]*rdx2Sq[1]-0.03849001794597505*kSq[1]-0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[3], (-0.1967229636168847*kSq[7])+0.2271561119999787*kSq[5]-0.07950463919999252*kSq[4]+1.777777777777778*epsilon[0]*rdx2Sq[1]+0.3079201435678004*kSq[1]+0.5333333333333333*epsilon[0]*rdx2Sq[0]-0.3555555555555556*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[4], 0.1135780559999893*kSq[5]+0.07950463919999252*kSq[4]+0.8888888888888888*epsilon[0]*rdx2Sq[1]-0.5333333333333333*epsilon[0]*rdx2Sq[0]-0.1777777777777778*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[5], 0.0295084445425327*kSq[7]-0.03442651863295482*kSq[6]-0.063887656499994*kSq[5]-0.05962847939999439*kSq[4]+0.05333333333333333*kSq[3]-0.03849001794597505*kSq[2]-0.8888888888888888*epsilon[0]*rdx2Sq[1]+0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[6], (-0.03442651863295482*kSq[7])+0.03442651863295482*kSq[6]+0.09938079899999068*kSq[5]+0.09938079899999068*kSq[4]+0.02666666666666666*kSq[3]-0.0769800358919501*kSq[2]+0.0769800358919501*kSq[1]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[7], 0.01721325931647741*kSq[7]-0.05678902799999467*kSq[5]-0.03975231959999626*kSq[4]-0.01333333333333333*kSq[3]-0.4444444444444444*epsilon[0]*rdx2Sq[1]-0.03849001794597505*kSq[1]-0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[4], globalIdxs[0], (-0.01721325931647741*kSq[7])-0.05678902799999467*kSq[5]-0.03975231959999626*kSq[4]-0.01333333333333333*kSq[3]-0.4444444444444444*epsilon[0]*rdx2Sq[1]+0.03849001794597505*kSq[1]-0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[4], globalIdxs[1], 0.03442651863295482*kSq[7]-0.03442651863295482*kSq[6]+0.09938079899999068*kSq[5]+0.09938079899999068*kSq[4]+0.02666666666666666*kSq[3]+0.0769800358919501*kSq[2]-0.0769800358919501*kSq[1]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[4], globalIdxs[2], (-0.0295084445425327*kSq[7])+0.03442651863295482*kSq[6]-0.063887656499994*kSq[5]-0.05962847939999439*kSq[4]+0.05333333333333333*kSq[3]+0.03849001794597505*kSq[2]-0.8888888888888888*epsilon[0]*rdx2Sq[1]+0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[4], globalIdxs[3], 0.1135780559999893*kSq[5]+0.07950463919999252*kSq[4]+0.8888888888888888*epsilon[0]*rdx2Sq[1]-0.5333333333333333*epsilon[0]*rdx2Sq[0]-0.1777777777777778*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[4], globalIdxs[4], 0.1967229636168847*kSq[7]+0.2271561119999787*kSq[5]-0.07950463919999252*kSq[4]+1.777777777777778*epsilon[0]*rdx2Sq[1]-0.3079201435678004*kSq[1]+0.5333333333333333*epsilon[0]*rdx2Sq[0]-0.3555555555555556*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[4], globalIdxs[5], (-0.01721325931647741*kSq[7])-0.05678902799999467*kSq[5]-0.03975231959999626*kSq[4]+0.01333333333333333*kSq[3]-0.4444444444444444*epsilon[0]*rdx2Sq[1]+0.03849001794597505*kSq[1]-0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[4], globalIdxs[6], 0.03442651863295482*kSq[7]+0.03442651863295482*kSq[6]+0.09938079899999068*kSq[5]+0.09938079899999068*kSq[4]-0.02666666666666666*kSq[3]-0.0769800358919501*kSq[2]-0.0769800358919501*kSq[1]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[4], globalIdxs[7], (-0.0295084445425327*kSq[7])-0.03442651863295482*kSq[6]-0.063887656499994*kSq[5]-0.05962847939999439*kSq[4]-0.05333333333333333*kSq[3]-0.03849001794597505*kSq[2]-0.8888888888888888*epsilon[0]*rdx2Sq[1]+0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[5], globalIdxs[0], (-0.006147592613027645*kSq[7])+0.02697478829999747*kSq[5]+0.03336355394999686*kSq[4]+0.3111111111111111*epsilon[0]*rdx2Sq[1]-0.01924500897298752*kSq[1]+0.1888888888888889*epsilon[0]*rdx2Sq[0]-0.02222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[5], globalIdxs[1], 0.01721325931647741*kSq[6]-0.03975231959999626*kSq[5]-0.05678902799999467*kSq[4]+0.01333333333333333*kSq[3]-0.03849001794597505*kSq[2]-0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.4444444444444444*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[5], globalIdxs[2], 0.0234254740499978*kSq[5]+0.0234254740499978*kSq[4]-0.01333333333333333*kSq[3]+0.2555555555555555*epsilon[0]*rdx2Sq[1]+0.2555555555555555*epsilon[0]*rdx2Sq[0]-0.03333333333333333*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[5], globalIdxs[3], 0.0295084445425327*kSq[7]-0.03442651863295482*kSq[6]-0.063887656499994*kSq[5]-0.05962847939999439*kSq[4]+0.05333333333333333*kSq[3]-0.03849001794597505*kSq[2]-0.8888888888888888*epsilon[0]*rdx2Sq[1]+0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[5], globalIdxs[4], (-0.01721325931647741*kSq[7])-0.05678902799999467*kSq[5]-0.03975231959999626*kSq[4]+0.01333333333333333*kSq[3]-0.4444444444444444*epsilon[0]*rdx2Sq[1]+0.03849001794597505*kSq[1]-0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[5], globalIdxs[5], 0.04549218533640458*kSq[7]-0.04549218533640458*kSq[6]-0.0127775312999988*kSq[5]-0.0127775312999988*kSq[4]+0.04666666666666667*kSq[3]-0.03849001794597505*kSq[2]+0.5777777777777777*epsilon[0]*rdx2Sq[1]+0.03849001794597505*kSq[1]+0.5777777777777777*epsilon[0]*rdx2Sq[0]-0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[5], globalIdxs[6], 0.03442651863295482*kSq[7]-0.0295084445425327*kSq[6]-0.05962847939999439*kSq[5]-0.063887656499994*kSq[4]+0.05333333333333333*kSq[3]+0.06666666666666667*epsilon[0]*rdx2Sq[1]+0.03849001794597505*kSq[1]-0.8888888888888888*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[5], globalIdxs[7], 0.006147592613027645*kSq[6]+0.03336355394999686*kSq[5]+0.02697478829999747*kSq[4]+0.01924500897298752*kSq[2]+0.1888888888888889*epsilon[0]*rdx2Sq[1]+0.3111111111111111*epsilon[0]*rdx2Sq[0]-0.02222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[6], globalIdxs[0], (-0.01721325931647741*kSq[6])-0.03975231959999626*kSq[5]-0.05678902799999467*kSq[4]-0.01333333333333333*kSq[3]+0.03849001794597505*kSq[2]-0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.4444444444444444*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[6], globalIdxs[1], 0.07950463919999252*kSq[5]+0.1135780559999893*kSq[4]-0.5333333333333333*epsilon[0]*rdx2Sq[1]+0.8888888888888888*epsilon[0]*rdx2Sq[0]-0.1777777777777778*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[6], globalIdxs[2], (-0.01721325931647741*kSq[6])-0.03975231959999626*kSq[5]-0.05678902799999467*kSq[4]+0.01333333333333333*kSq[3]+0.03849001794597505*kSq[2]-0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.4444444444444444*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[6], globalIdxs[3], (-0.03442651863295482*kSq[7])+0.03442651863295482*kSq[6]+0.09938079899999068*kSq[5]+0.09938079899999068*kSq[4]+0.02666666666666666*kSq[3]-0.0769800358919501*kSq[2]+0.0769800358919501*kSq[1]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[6], globalIdxs[4], 0.03442651863295482*kSq[7]+0.03442651863295482*kSq[6]+0.09938079899999068*kSq[5]+0.09938079899999068*kSq[4]-0.02666666666666666*kSq[3]-0.0769800358919501*kSq[2]-0.0769800358919501*kSq[1]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[6], globalIdxs[5], 0.03442651863295482*kSq[7]-0.0295084445425327*kSq[6]-0.05962847939999439*kSq[5]-0.063887656499994*kSq[4]+0.05333333333333333*kSq[3]+0.06666666666666667*epsilon[0]*rdx2Sq[1]+0.03849001794597505*kSq[1]-0.8888888888888888*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[6], globalIdxs[6], 0.1967229636168847*kSq[6]-0.07950463919999252*kSq[5]+0.2271561119999787*kSq[4]-0.3079201435678004*kSq[2]+0.5333333333333333*epsilon[0]*rdx2Sq[1]+1.777777777777778*epsilon[0]*rdx2Sq[0]-0.3555555555555556*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[6], globalIdxs[7], (-0.03442651863295482*kSq[7])-0.0295084445425327*kSq[6]-0.05962847939999439*kSq[5]-0.063887656499994*kSq[4]-0.05333333333333333*kSq[3]+0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.03849001794597505*kSq[1]-0.8888888888888888*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[7], globalIdxs[0], 0.0234254740499978*kSq[5]+0.0234254740499978*kSq[4]+0.01333333333333333*kSq[3]+0.2555555555555555*epsilon[0]*rdx2Sq[1]+0.2555555555555555*epsilon[0]*rdx2Sq[0]-0.03333333333333333*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[7], globalIdxs[1], 0.01721325931647741*kSq[6]-0.03975231959999626*kSq[5]-0.05678902799999467*kSq[4]-0.01333333333333333*kSq[3]-0.03849001794597505*kSq[2]-0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.4444444444444444*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[7], globalIdxs[2], 0.006147592613027645*kSq[7]+0.02697478829999747*kSq[5]+0.03336355394999686*kSq[4]+0.3111111111111111*epsilon[0]*rdx2Sq[1]+0.01924500897298752*kSq[1]+0.1888888888888889*epsilon[0]*rdx2Sq[0]-0.02222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[7], globalIdxs[3], 0.01721325931647741*kSq[7]-0.05678902799999467*kSq[5]-0.03975231959999626*kSq[4]-0.01333333333333333*kSq[3]-0.4444444444444444*epsilon[0]*rdx2Sq[1]-0.03849001794597505*kSq[1]-0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[7], globalIdxs[4], (-0.0295084445425327*kSq[7])-0.03442651863295482*kSq[6]-0.063887656499994*kSq[5]-0.05962847939999439*kSq[4]-0.05333333333333333*kSq[3]-0.03849001794597505*kSq[2]-0.8888888888888888*epsilon[0]*rdx2Sq[1]+0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[7], globalIdxs[5], 0.006147592613027645*kSq[6]+0.03336355394999686*kSq[5]+0.02697478829999747*kSq[4]+0.01924500897298752*kSq[2]+0.1888888888888889*epsilon[0]*rdx2Sq[1]+0.3111111111111111*epsilon[0]*rdx2Sq[0]-0.02222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[7], globalIdxs[6], (-0.03442651863295482*kSq[7])-0.0295084445425327*kSq[6]-0.05962847939999439*kSq[5]-0.063887656499994*kSq[4]-0.05333333333333333*kSq[3]+0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.03849001794597505*kSq[1]-0.8888888888888888*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[7], globalIdxs[7], (-0.04549218533640458*kSq[7])-0.04549218533640458*kSq[6]-0.0127775312999988*kSq[5]-0.0127775312999988*kSq[4]-0.04666666666666667*kSq[3]-0.03849001794597505*kSq[2]+0.5777777777777777*epsilon[0]*rdx2Sq[1]-0.03849001794597505*kSq[1]+0.5777777777777777*epsilon[0]*rdx2Sq[0]-0.06666666666666667*kSq[0]);

}
void fem_poisson_lhs_stencil_consteps_2x_ser_p1_lox_neumannx_loy_neumanny(const double *epsilon, const double *kSq, const double *dx, const double *bcVals, const long *globalIdxs, gkyl_mat_triples *tri) 
{ 
  // epsilon: permittivity.
  // kSq: wave number squared (factor multiplying phi).
  // dx: cell length in each direction.
  // bcVals[3]: values to impose as BCs, i.e. bcVals[0]*phi+bcVals[1]*d(phi)/dx=bcVals[2].
  // globalIdxs: global linear index of each basis function/node in current cell.
  // tri: triples object (i,j,val), i.e. contribute val to i,j element of the global matrix.

  double rdx2Sq[2];
  rdx2Sq[0] = 4.0/(dx[0]*dx[0]);
  rdx2Sq[1] = 4.0/(dx[1]*dx[1]);

  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[0], (-0.1666666666666667*kSq[3])+0.1924500897298752*kSq[2]+0.3333333333333333*epsilon[0]*rdx2Sq[1]+0.1924500897298752*kSq[1]+0.3333333333333333*epsilon[0]*rdx2Sq[0]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[1], 0.09622504486493762*kSq[2]+0.1666666666666667*epsilon[0]*rdx2Sq[1]-0.3333333333333333*epsilon[0]*rdx2Sq[0]-0.1111111111111111*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[2], (-0.3333333333333333*epsilon[0]*rdx2Sq[1])+0.09622504486493762*kSq[1]+0.1666666666666667*epsilon[0]*rdx2Sq[0]-0.1111111111111111*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[3], (-0.1666666666666667*epsilon[0]*rdx2Sq[1])-0.1666666666666667*epsilon[0]*rdx2Sq[0]-0.05555555555555555*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[0], 0.09622504486493762*kSq[2]+0.1666666666666667*epsilon[0]*rdx2Sq[1]-0.3333333333333333*epsilon[0]*rdx2Sq[0]-0.1111111111111111*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[1], 0.1666666666666667*kSq[3]+0.1924500897298752*kSq[2]+0.3333333333333333*epsilon[0]*rdx2Sq[1]-0.1924500897298752*kSq[1]+0.3333333333333333*epsilon[0]*rdx2Sq[0]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[2], (-0.1666666666666667*epsilon[0]*rdx2Sq[1])-0.1666666666666667*epsilon[0]*rdx2Sq[0]-0.05555555555555555*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[3], (-0.3333333333333333*epsilon[0]*rdx2Sq[1])-0.09622504486493762*kSq[1]+0.1666666666666667*epsilon[0]*rdx2Sq[0]-0.1111111111111111*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[0], (-0.3333333333333333*epsilon[0]*rdx2Sq[1])+0.09622504486493762*kSq[1]+0.1666666666666667*epsilon[0]*rdx2Sq[0]-0.1111111111111111*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[1], (-0.1666666666666667*epsilon[0]*rdx2Sq[1])-0.1666666666666667*epsilon[0]*rdx2Sq[0]-0.05555555555555555*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[2], 0.1666666666666667*kSq[3]-0.1924500897298752*kSq[2]+0.3333333333333333*epsilon[0]*rdx2Sq[1]+0.1924500897298752*kSq[1]+0.3333333333333333*epsilon[0]*rdx2Sq[0]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[3], (-0.09622504486493762*kSq[2])+0.1666666666666667*epsilon[0]*rdx2Sq[1]-0.3333333333333333*epsilon[0]*rdx2Sq[0]-0.1111111111111111*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[0], (-0.1666666666666667*epsilon[0]*rdx2Sq[1])-0.1666666666666667*epsilon[0]*rdx2Sq[0]-0.05555555555555555*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[1], (-0.3333333333333333*epsilon[0]*rdx2Sq[1])-0.09622504486493762*kSq[1]+0.1666666666666667*epsilon[0]*rdx2Sq[0]-0.1111111111111111*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[2], (-0.09622504486493762*kSq[2])+0.1666666666666667*epsilon[0]*rdx2Sq[1]-0.3333333333333333*epsilon[0]*rdx2Sq[0]-0.1111111111111111*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[3], (-0.1666666666666667*kSq[3])-0.1924500897298752*kSq[2]+0.3333333333333333*epsilon[0]*rdx2Sq[1]-0.1924500897298752*kSq[1]+0.3333333333333333*epsilon[0]*rdx2Sq[0]-0.2222222222222222*kSq[0]);

}
void fem_poisson_lhs_stencil_consteps_2x_ser_p2_lox_neumannx_loy_neumanny(const double *epsilon, const double *kSq, const double *dx, const double *bcVals, const long *globalIdxs, gkyl_mat_triples *tri) 
{ 
  // epsilon: permittivity.
  // kSq: wave number squared (factor multiplying phi).
  // dx: cell length in each direction.
  // bcVals[3]: values to impose as BCs, i.e. bcVals[0]*phi+bcVals[1]*d(phi)/dx=bcVals[2].
  // globalIdxs: global linear index of each basis function/node in current cell.
  // tri: triples object (i,j,val), i.e. contribute val to i,j element of the global matrix.

  double rdx2Sq[2];
  rdx2Sq[0] = 4.0/(dx[0]*dx[0]);
  rdx2Sq[1] = 4.0/(dx[1]*dx[1]);

  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[0], 0.04549218533640458*kSq[7]+0.04549218533640458*kSq[6]-0.0127775312999988*kSq[5]-0.0127775312999988*kSq[4]-0.04666666666666667*kSq[3]+0.03849001794597505*kSq[2]+0.5777777777777777*epsilon[0]*rdx2Sq[1]+0.03849001794597505*kSq[1]+0.5777777777777777*epsilon[0]*rdx2Sq[0]-0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[1], 0.03442651863295482*kSq[7]+0.0295084445425327*kSq[6]-0.05962847939999439*kSq[5]-0.063887656499994*kSq[4]-0.05333333333333333*kSq[3]+0.06666666666666667*epsilon[0]*rdx2Sq[1]+0.03849001794597505*kSq[1]-0.8888888888888888*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[2], (-0.006147592613027645*kSq[6])+0.03336355394999686*kSq[5]+0.02697478829999747*kSq[4]-0.01924500897298752*kSq[2]+0.1888888888888889*epsilon[0]*rdx2Sq[1]+0.3111111111111111*epsilon[0]*rdx2Sq[0]-0.02222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[3], 0.0295084445425327*kSq[7]+0.03442651863295482*kSq[6]-0.063887656499994*kSq[5]-0.05962847939999439*kSq[4]-0.05333333333333333*kSq[3]+0.03849001794597505*kSq[2]-0.8888888888888888*epsilon[0]*rdx2Sq[1]+0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[4], (-0.01721325931647741*kSq[7])-0.05678902799999467*kSq[5]-0.03975231959999626*kSq[4]-0.01333333333333333*kSq[3]-0.4444444444444444*epsilon[0]*rdx2Sq[1]+0.03849001794597505*kSq[1]-0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[5], (-0.006147592613027645*kSq[7])+0.02697478829999747*kSq[5]+0.03336355394999686*kSq[4]+0.3111111111111111*epsilon[0]*rdx2Sq[1]-0.01924500897298752*kSq[1]+0.1888888888888889*epsilon[0]*rdx2Sq[0]-0.02222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[6], (-0.01721325931647741*kSq[6])-0.03975231959999626*kSq[5]-0.05678902799999467*kSq[4]-0.01333333333333333*kSq[3]+0.03849001794597505*kSq[2]-0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.4444444444444444*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[7], 0.0234254740499978*kSq[5]+0.0234254740499978*kSq[4]+0.01333333333333333*kSq[3]+0.2555555555555555*epsilon[0]*rdx2Sq[1]+0.2555555555555555*epsilon[0]*rdx2Sq[0]-0.03333333333333333*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[0], 0.03442651863295482*kSq[7]+0.0295084445425327*kSq[6]-0.05962847939999439*kSq[5]-0.063887656499994*kSq[4]-0.05333333333333333*kSq[3]+0.06666666666666667*epsilon[0]*rdx2Sq[1]+0.03849001794597505*kSq[1]-0.8888888888888888*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[1], (-0.1967229636168847*kSq[6])-0.07950463919999252*kSq[5]+0.2271561119999787*kSq[4]+0.3079201435678004*kSq[2]+0.5333333333333333*epsilon[0]*rdx2Sq[1]+1.777777777777778*epsilon[0]*rdx2Sq[0]-0.3555555555555556*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[2], (-0.03442651863295482*kSq[7])+0.0295084445425327*kSq[6]-0.05962847939999439*kSq[5]-0.063887656499994*kSq[4]+0.05333333333333333*kSq[3]+0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.03849001794597505*kSq[1]-0.8888888888888888*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[3], (-0.03442651863295482*kSq[7])-0.03442651863295482*kSq[6]+0.09938079899999068*kSq[5]+0.09938079899999068*kSq[4]-0.02666666666666666*kSq[3]+0.0769800358919501*kSq[2]+0.0769800358919501*kSq[1]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[4], 0.03442651863295482*kSq[7]-0.03442651863295482*kSq[6]+0.09938079899999068*kSq[5]+0.09938079899999068*kSq[4]+0.02666666666666666*kSq[3]+0.0769800358919501*kSq[2]-0.0769800358919501*kSq[1]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[5], 0.01721325931647741*kSq[6]-0.03975231959999626*kSq[5]-0.05678902799999467*kSq[4]+0.01333333333333333*kSq[3]-0.03849001794597505*kSq[2]-0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.4444444444444444*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[6], 0.07950463919999252*kSq[5]+0.1135780559999893*kSq[4]-0.5333333333333333*epsilon[0]*rdx2Sq[1]+0.8888888888888888*epsilon[0]*rdx2Sq[0]-0.1777777777777778*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[7], 0.01721325931647741*kSq[6]-0.03975231959999626*kSq[5]-0.05678902799999467*kSq[4]-0.01333333333333333*kSq[3]-0.03849001794597505*kSq[2]-0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.4444444444444444*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[0], (-0.006147592613027645*kSq[6])+0.03336355394999686*kSq[5]+0.02697478829999747*kSq[4]-0.01924500897298752*kSq[2]+0.1888888888888889*epsilon[0]*rdx2Sq[1]+0.3111111111111111*epsilon[0]*rdx2Sq[0]-0.02222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[1], (-0.03442651863295482*kSq[7])+0.0295084445425327*kSq[6]-0.05962847939999439*kSq[5]-0.063887656499994*kSq[4]+0.05333333333333333*kSq[3]+0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.03849001794597505*kSq[1]-0.8888888888888888*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[2], (-0.04549218533640458*kSq[7])+0.04549218533640458*kSq[6]-0.0127775312999988*kSq[5]-0.0127775312999988*kSq[4]+0.04666666666666667*kSq[3]+0.03849001794597505*kSq[2]+0.5777777777777777*epsilon[0]*rdx2Sq[1]-0.03849001794597505*kSq[1]+0.5777777777777777*epsilon[0]*rdx2Sq[0]-0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[3], 0.01721325931647741*kSq[7]-0.05678902799999467*kSq[5]-0.03975231959999626*kSq[4]+0.01333333333333333*kSq[3]-0.4444444444444444*epsilon[0]*rdx2Sq[1]-0.03849001794597505*kSq[1]-0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[4], (-0.0295084445425327*kSq[7])+0.03442651863295482*kSq[6]-0.063887656499994*kSq[5]-0.05962847939999439*kSq[4]+0.05333333333333333*kSq[3]+0.03849001794597505*kSq[2]-0.8888888888888888*epsilon[0]*rdx2Sq[1]+0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[5], 0.0234254740499978*kSq[5]+0.0234254740499978*kSq[4]-0.01333333333333333*kSq[3]+0.2555555555555555*epsilon[0]*rdx2Sq[1]+0.2555555555555555*epsilon[0]*rdx2Sq[0]-0.03333333333333333*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[6], (-0.01721325931647741*kSq[6])-0.03975231959999626*kSq[5]-0.05678902799999467*kSq[4]+0.01333333333333333*kSq[3]+0.03849001794597505*kSq[2]-0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.4444444444444444*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[7], 0.006147592613027645*kSq[7]+0.02697478829999747*kSq[5]+0.03336355394999686*kSq[4]+0.3111111111111111*epsilon[0]*rdx2Sq[1]+0.01924500897298752*kSq[1]+0.1888888888888889*epsilon[0]*rdx2Sq[0]-0.02222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[0], 0.0295084445425327*kSq[7]+0.03442651863295482*kSq[6]-0.063887656499994*kSq[5]-0.05962847939999439*kSq[4]-0.05333333333333333*kSq[3]+0.03849001794597505*kSq[2]-0.8888888888888888*epsilon[0]*rdx2Sq[1]+0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[1], (-0.03442651863295482*kSq[7])-0.03442651863295482*kSq[6]+0.09938079899999068*kSq[5]+0.09938079899999068*kSq[4]-0.02666666666666666*kSq[3]+0.0769800358919501*kSq[2]+0.0769800358919501*kSq[1]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[2], 0.01721325931647741*kSq[7]-0.05678902799999467*kSq[5]-0.03975231959999626*kSq[4]+0.01333333333333333*kSq[3]-0.4444444444444444*epsilon[0]*rdx2Sq[1]-0.03849001794597505*kSq[1]-0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[3], (-0.1967229636168847*kSq[7])+0.2271561119999787*kSq[5]-0.07950463919999252*kSq[4]+1.777777777777778*epsilon[0]*rdx2Sq[1]+0.3079201435678004*kSq[1]+0.5333333333333333*epsilon[0]*rdx2Sq[0]-0.3555555555555556*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[4], 0.1135780559999893*kSq[5]+0.07950463919999252*kSq[4]+0.8888888888888888*epsilon[0]*rdx2Sq[1]-0.5333333333333333*epsilon[0]*rdx2Sq[0]-0.1777777777777778*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[5], 0.0295084445425327*kSq[7]-0.03442651863295482*kSq[6]-0.063887656499994*kSq[5]-0.05962847939999439*kSq[4]+0.05333333333333333*kSq[3]-0.03849001794597505*kSq[2]-0.8888888888888888*epsilon[0]*rdx2Sq[1]+0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[6], (-0.03442651863295482*kSq[7])+0.03442651863295482*kSq[6]+0.09938079899999068*kSq[5]+0.09938079899999068*kSq[4]+0.02666666666666666*kSq[3]-0.0769800358919501*kSq[2]+0.0769800358919501*kSq[1]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[7], 0.01721325931647741*kSq[7]-0.05678902799999467*kSq[5]-0.03975231959999626*kSq[4]-0.01333333333333333*kSq[3]-0.4444444444444444*epsilon[0]*rdx2Sq[1]-0.03849001794597505*kSq[1]-0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[4], globalIdxs[0], (-0.01721325931647741*kSq[7])-0.05678902799999467*kSq[5]-0.03975231959999626*kSq[4]-0.01333333333333333*kSq[3]-0.4444444444444444*epsilon[0]*rdx2Sq[1]+0.03849001794597505*kSq[1]-0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[4], globalIdxs[1], 0.03442651863295482*kSq[7]-0.03442651863295482*kSq[6]+0.09938079899999068*kSq[5]+0.09938079899999068*kSq[4]+0.02666666666666666*kSq[3]+0.0769800358919501*kSq[2]-0.0769800358919501*kSq[1]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[4], globalIdxs[2], (-0.0295084445425327*kSq[7])+0.03442651863295482*kSq[6]-0.063887656499994*kSq[5]-0.05962847939999439*kSq[4]+0.05333333333333333*kSq[3]+0.03849001794597505*kSq[2]-0.8888888888888888*epsilon[0]*rdx2Sq[1]+0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[4], globalIdxs[3], 0.1135780559999893*kSq[5]+0.07950463919999252*kSq[4]+0.8888888888888888*epsilon[0]*rdx2Sq[1]-0.5333333333333333*epsilon[0]*rdx2Sq[0]-0.1777777777777778*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[4], globalIdxs[4], 0.1967229636168847*kSq[7]+0.2271561119999787*kSq[5]-0.07950463919999252*kSq[4]+1.777777777777778*epsilon[0]*rdx2Sq[1]-0.3079201435678004*kSq[1]+0.5333333333333333*epsilon[0]*rdx2Sq[0]-0.3555555555555556*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[4], globalIdxs[5], (-0.01721325931647741*kSq[7])-0.05678902799999467*kSq[5]-0.03975231959999626*kSq[4]+0.01333333333333333*kSq[3]-0.4444444444444444*epsilon[0]*rdx2Sq[1]+0.03849001794597505*kSq[1]-0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[4], globalIdxs[6], 0.03442651863295482*kSq[7]+0.03442651863295482*kSq[6]+0.09938079899999068*kSq[5]+0.09938079899999068*kSq[4]-0.02666666666666666*kSq[3]-0.0769800358919501*kSq[2]-0.0769800358919501*kSq[1]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[4], globalIdxs[7], (-0.0295084445425327*kSq[7])-0.03442651863295482*kSq[6]-0.063887656499994*kSq[5]-0.05962847939999439*kSq[4]-0.05333333333333333*kSq[3]-0.03849001794597505*kSq[2]-0.8888888888888888*epsilon[0]*rdx2Sq[1]+0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[5], globalIdxs[0], (-0.006147592613027645*kSq[7])+0.02697478829999747*kSq[5]+0.03336355394999686*kSq[4]+0.3111111111111111*epsilon[0]*rdx2Sq[1]-0.01924500897298752*kSq[1]+0.1888888888888889*epsilon[0]*rdx2Sq[0]-0.02222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[5], globalIdxs[1], 0.01721325931647741*kSq[6]-0.03975231959999626*kSq[5]-0.05678902799999467*kSq[4]+0.01333333333333333*kSq[3]-0.03849001794597505*kSq[2]-0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.4444444444444444*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[5], globalIdxs[2], 0.0234254740499978*kSq[5]+0.0234254740499978*kSq[4]-0.01333333333333333*kSq[3]+0.2555555555555555*epsilon[0]*rdx2Sq[1]+0.2555555555555555*epsilon[0]*rdx2Sq[0]-0.03333333333333333*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[5], globalIdxs[3], 0.0295084445425327*kSq[7]-0.03442651863295482*kSq[6]-0.063887656499994*kSq[5]-0.05962847939999439*kSq[4]+0.05333333333333333*kSq[3]-0.03849001794597505*kSq[2]-0.8888888888888888*epsilon[0]*rdx2Sq[1]+0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[5], globalIdxs[4], (-0.01721325931647741*kSq[7])-0.05678902799999467*kSq[5]-0.03975231959999626*kSq[4]+0.01333333333333333*kSq[3]-0.4444444444444444*epsilon[0]*rdx2Sq[1]+0.03849001794597505*kSq[1]-0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[5], globalIdxs[5], 0.04549218533640458*kSq[7]-0.04549218533640458*kSq[6]-0.0127775312999988*kSq[5]-0.0127775312999988*kSq[4]+0.04666666666666667*kSq[3]-0.03849001794597505*kSq[2]+0.5777777777777777*epsilon[0]*rdx2Sq[1]+0.03849001794597505*kSq[1]+0.5777777777777777*epsilon[0]*rdx2Sq[0]-0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[5], globalIdxs[6], 0.03442651863295482*kSq[7]-0.0295084445425327*kSq[6]-0.05962847939999439*kSq[5]-0.063887656499994*kSq[4]+0.05333333333333333*kSq[3]+0.06666666666666667*epsilon[0]*rdx2Sq[1]+0.03849001794597505*kSq[1]-0.8888888888888888*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[5], globalIdxs[7], 0.006147592613027645*kSq[6]+0.03336355394999686*kSq[5]+0.02697478829999747*kSq[4]+0.01924500897298752*kSq[2]+0.1888888888888889*epsilon[0]*rdx2Sq[1]+0.3111111111111111*epsilon[0]*rdx2Sq[0]-0.02222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[6], globalIdxs[0], (-0.01721325931647741*kSq[6])-0.03975231959999626*kSq[5]-0.05678902799999467*kSq[4]-0.01333333333333333*kSq[3]+0.03849001794597505*kSq[2]-0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.4444444444444444*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[6], globalIdxs[1], 0.07950463919999252*kSq[5]+0.1135780559999893*kSq[4]-0.5333333333333333*epsilon[0]*rdx2Sq[1]+0.8888888888888888*epsilon[0]*rdx2Sq[0]-0.1777777777777778*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[6], globalIdxs[2], (-0.01721325931647741*kSq[6])-0.03975231959999626*kSq[5]-0.05678902799999467*kSq[4]+0.01333333333333333*kSq[3]+0.03849001794597505*kSq[2]-0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.4444444444444444*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[6], globalIdxs[3], (-0.03442651863295482*kSq[7])+0.03442651863295482*kSq[6]+0.09938079899999068*kSq[5]+0.09938079899999068*kSq[4]+0.02666666666666666*kSq[3]-0.0769800358919501*kSq[2]+0.0769800358919501*kSq[1]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[6], globalIdxs[4], 0.03442651863295482*kSq[7]+0.03442651863295482*kSq[6]+0.09938079899999068*kSq[5]+0.09938079899999068*kSq[4]-0.02666666666666666*kSq[3]-0.0769800358919501*kSq[2]-0.0769800358919501*kSq[1]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[6], globalIdxs[5], 0.03442651863295482*kSq[7]-0.0295084445425327*kSq[6]-0.05962847939999439*kSq[5]-0.063887656499994*kSq[4]+0.05333333333333333*kSq[3]+0.06666666666666667*epsilon[0]*rdx2Sq[1]+0.03849001794597505*kSq[1]-0.8888888888888888*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[6], globalIdxs[6], 0.1967229636168847*kSq[6]-0.07950463919999252*kSq[5]+0.2271561119999787*kSq[4]-0.3079201435678004*kSq[2]+0.5333333333333333*epsilon[0]*rdx2Sq[1]+1.777777777777778*epsilon[0]*rdx2Sq[0]-0.3555555555555556*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[6], globalIdxs[7], (-0.03442651863295482*kSq[7])-0.0295084445425327*kSq[6]-0.05962847939999439*kSq[5]-0.063887656499994*kSq[4]-0.05333333333333333*kSq[3]+0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.03849001794597505*kSq[1]-0.8888888888888888*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[7], globalIdxs[0], 0.0234254740499978*kSq[5]+0.0234254740499978*kSq[4]+0.01333333333333333*kSq[3]+0.2555555555555555*epsilon[0]*rdx2Sq[1]+0.2555555555555555*epsilon[0]*rdx2Sq[0]-0.03333333333333333*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[7], globalIdxs[1], 0.01721325931647741*kSq[6]-0.03975231959999626*kSq[5]-0.05678902799999467*kSq[4]-0.01333333333333333*kSq[3]-0.03849001794597505*kSq[2]-0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.4444444444444444*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[7], globalIdxs[2], 0.006147592613027645*kSq[7]+0.02697478829999747*kSq[5]+0.03336355394999686*kSq[4]+0.3111111111111111*epsilon[0]*rdx2Sq[1]+0.01924500897298752*kSq[1]+0.1888888888888889*epsilon[0]*rdx2Sq[0]-0.02222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[7], globalIdxs[3], 0.01721325931647741*kSq[7]-0.05678902799999467*kSq[5]-0.03975231959999626*kSq[4]-0.01333333333333333*kSq[3]-0.4444444444444444*epsilon[0]*rdx2Sq[1]-0.03849001794597505*kSq[1]-0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[7], globalIdxs[4], (-0.0295084445425327*kSq[7])-0.03442651863295482*kSq[6]-0.063887656499994*kSq[5]-0.05962847939999439*kSq[4]-0.05333333333333333*kSq[3]-0.03849001794597505*kSq[2]-0.8888888888888888*epsilon[0]*rdx2Sq[1]+0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[7], globalIdxs[5], 0.006147592613027645*kSq[6]+0.03336355394999686*kSq[5]+0.02697478829999747*kSq[4]+0.01924500897298752*kSq[2]+0.1888888888888889*epsilon[0]*rdx2Sq[1]+0.3111111111111111*epsilon[0]*rdx2Sq[0]-0.02222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[7], globalIdxs[6], (-0.03442651863295482*kSq[7])-0.0295084445425327*kSq[6]-0.05962847939999439*kSq[5]-0.063887656499994*kSq[4]-0.05333333333333333*kSq[3]+0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.03849001794597505*kSq[1]-0.8888888888888888*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[7], globalIdxs[7], (-0.04549218533640458*kSq[7])-0.04549218533640458*kSq[6]-0.0127775312999988*kSq[5]-0.0127775312999988*kSq[4]-0.04666666666666667*kSq[3]-0.03849001794597505*kSq[2]+0.5777777777777777*epsilon[0]*rdx2Sq[1]-0.03849001794597505*kSq[1]+0.5777777777777777*epsilon[0]*rdx2Sq[0]-0.06666666666666667*kSq[0]);

}
void fem_poisson_lhs_stencil_consteps_2x_ser_p1_lox_neumannx_loy_robiny(const double *epsilon, const double *kSq, const double *dx, const double *bcVals, const long *globalIdxs, gkyl_mat_triples *tri) 
{ 
  // epsilon: permittivity.
  // kSq: wave number squared (factor multiplying phi).
  // dx: cell length in each direction.
  // bcVals[3]: values to impose as BCs, i.e. bcVals[0]*phi+bcVals[1]*d(phi)/dx=bcVals[2].
  // globalIdxs: global linear index of each basis function/node in current cell.
  // tri: triples object (i,j,val), i.e. contribute val to i,j element of the global matrix.

  double rdx2Sq[2];
  rdx2Sq[0] = 4.0/(dx[0]*dx[0]);
  rdx2Sq[1] = 4.0/(dx[1]*dx[1]);

  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[0], (-(0.6666666666666666*epsilon[0]*rdx2Sq[1]*bcVals[6])/bcVals[7])-0.1666666666666667*kSq[3]+0.1924500897298752*kSq[2]+0.3333333333333333*epsilon[0]*rdx2Sq[1]+0.1924500897298752*kSq[1]+0.3333333333333333*epsilon[0]*rdx2Sq[0]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[1], (-(0.3333333333333333*epsilon[0]*rdx2Sq[1]*bcVals[6])/bcVals[7])+0.09622504486493762*kSq[2]+0.1666666666666667*epsilon[0]*rdx2Sq[1]-0.3333333333333333*epsilon[0]*rdx2Sq[0]-0.1111111111111111*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[2], (-0.3333333333333333*epsilon[0]*rdx2Sq[1])+0.09622504486493762*kSq[1]+0.1666666666666667*epsilon[0]*rdx2Sq[0]-0.1111111111111111*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[3], (-0.1666666666666667*epsilon[0]*rdx2Sq[1])-0.1666666666666667*epsilon[0]*rdx2Sq[0]-0.05555555555555555*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[0], (-(0.3333333333333333*epsilon[0]*rdx2Sq[1]*bcVals[6])/bcVals[7])+0.09622504486493762*kSq[2]+0.1666666666666667*epsilon[0]*rdx2Sq[1]-0.3333333333333333*epsilon[0]*rdx2Sq[0]-0.1111111111111111*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[1], (-(0.6666666666666666*epsilon[0]*rdx2Sq[1]*bcVals[6])/bcVals[7])+0.1666666666666667*kSq[3]+0.1924500897298752*kSq[2]+0.3333333333333333*epsilon[0]*rdx2Sq[1]-0.1924500897298752*kSq[1]+0.3333333333333333*epsilon[0]*rdx2Sq[0]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[2], (-0.1666666666666667*epsilon[0]*rdx2Sq[1])-0.1666666666666667*epsilon[0]*rdx2Sq[0]-0.05555555555555555*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[3], (-0.3333333333333333*epsilon[0]*rdx2Sq[1])-0.09622504486493762*kSq[1]+0.1666666666666667*epsilon[0]*rdx2Sq[0]-0.1111111111111111*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[0], (-0.3333333333333333*epsilon[0]*rdx2Sq[1])+0.09622504486493762*kSq[1]+0.1666666666666667*epsilon[0]*rdx2Sq[0]-0.1111111111111111*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[1], (-0.1666666666666667*epsilon[0]*rdx2Sq[1])-0.1666666666666667*epsilon[0]*rdx2Sq[0]-0.05555555555555555*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[2], 0.1666666666666667*kSq[3]-0.1924500897298752*kSq[2]+0.3333333333333333*epsilon[0]*rdx2Sq[1]+0.1924500897298752*kSq[1]+0.3333333333333333*epsilon[0]*rdx2Sq[0]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[3], (-0.09622504486493762*kSq[2])+0.1666666666666667*epsilon[0]*rdx2Sq[1]-0.3333333333333333*epsilon[0]*rdx2Sq[0]-0.1111111111111111*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[0], (-0.1666666666666667*epsilon[0]*rdx2Sq[1])-0.1666666666666667*epsilon[0]*rdx2Sq[0]-0.05555555555555555*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[1], (-0.3333333333333333*epsilon[0]*rdx2Sq[1])-0.09622504486493762*kSq[1]+0.1666666666666667*epsilon[0]*rdx2Sq[0]-0.1111111111111111*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[2], (-0.09622504486493762*kSq[2])+0.1666666666666667*epsilon[0]*rdx2Sq[1]-0.3333333333333333*epsilon[0]*rdx2Sq[0]-0.1111111111111111*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[3], (-0.1666666666666667*kSq[3])-0.1924500897298752*kSq[2]+0.3333333333333333*epsilon[0]*rdx2Sq[1]-0.1924500897298752*kSq[1]+0.3333333333333333*epsilon[0]*rdx2Sq[0]-0.2222222222222222*kSq[0]);

}
void fem_poisson_lhs_stencil_consteps_2x_ser_p2_lox_neumannx_loy_robiny(const double *epsilon, const double *kSq, const double *dx, const double *bcVals, const long *globalIdxs, gkyl_mat_triples *tri) 
{ 
  // epsilon: permittivity.
  // kSq: wave number squared (factor multiplying phi).
  // dx: cell length in each direction.
  // bcVals[3]: values to impose as BCs, i.e. bcVals[0]*phi+bcVals[1]*d(phi)/dx=bcVals[2].
  // globalIdxs: global linear index of each basis function/node in current cell.
  // tri: triples object (i,j,val), i.e. contribute val to i,j element of the global matrix.

  double rdx2Sq[2];
  rdx2Sq[0] = 4.0/(dx[0]*dx[0]);
  rdx2Sq[1] = 4.0/(dx[1]*dx[1]);

  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[0], 0.04549218533640458*kSq[7]-(0.2666666666666667*epsilon[0]*rdx2Sq[1]*bcVals[6])/bcVals[7]+0.04549218533640458*kSq[6]-0.0127775312999988*kSq[5]-0.0127775312999988*kSq[4]-0.04666666666666667*kSq[3]+0.03849001794597505*kSq[2]+0.5777777777777777*epsilon[0]*rdx2Sq[1]+0.03849001794597505*kSq[1]+0.5777777777777777*epsilon[0]*rdx2Sq[0]-0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[1], 0.03442651863295482*kSq[7]-(0.1333333333333333*epsilon[0]*rdx2Sq[1]*bcVals[6])/bcVals[7]+0.0295084445425327*kSq[6]-0.05962847939999439*kSq[5]-0.063887656499994*kSq[4]-0.05333333333333333*kSq[3]+0.06666666666666667*epsilon[0]*rdx2Sq[1]+0.03849001794597505*kSq[1]-0.8888888888888888*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[2], (0.06666666666666667*epsilon[0]*rdx2Sq[1]*bcVals[6])/bcVals[7]-0.006147592613027645*kSq[6]+0.03336355394999686*kSq[5]+0.02697478829999747*kSq[4]-0.01924500897298752*kSq[2]+0.1888888888888889*epsilon[0]*rdx2Sq[1]+0.3111111111111111*epsilon[0]*rdx2Sq[0]-0.02222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[3], 0.0295084445425327*kSq[7]+0.03442651863295482*kSq[6]-0.063887656499994*kSq[5]-0.05962847939999439*kSq[4]-0.05333333333333333*kSq[3]+0.03849001794597505*kSq[2]-0.8888888888888888*epsilon[0]*rdx2Sq[1]+0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[4], (-0.01721325931647741*kSq[7])-0.05678902799999467*kSq[5]-0.03975231959999626*kSq[4]-0.01333333333333333*kSq[3]-0.4444444444444444*epsilon[0]*rdx2Sq[1]+0.03849001794597505*kSq[1]-0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[5], (-0.006147592613027645*kSq[7])+0.02697478829999747*kSq[5]+0.03336355394999686*kSq[4]+0.3111111111111111*epsilon[0]*rdx2Sq[1]-0.01924500897298752*kSq[1]+0.1888888888888889*epsilon[0]*rdx2Sq[0]-0.02222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[6], (-0.01721325931647741*kSq[6])-0.03975231959999626*kSq[5]-0.05678902799999467*kSq[4]-0.01333333333333333*kSq[3]+0.03849001794597505*kSq[2]-0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.4444444444444444*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[7], 0.0234254740499978*kSq[5]+0.0234254740499978*kSq[4]+0.01333333333333333*kSq[3]+0.2555555555555555*epsilon[0]*rdx2Sq[1]+0.2555555555555555*epsilon[0]*rdx2Sq[0]-0.03333333333333333*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[0], 0.03442651863295482*kSq[7]-(0.1333333333333333*epsilon[0]*rdx2Sq[1]*bcVals[6])/bcVals[7]+0.0295084445425327*kSq[6]-0.05962847939999439*kSq[5]-0.063887656499994*kSq[4]-0.05333333333333333*kSq[3]+0.06666666666666667*epsilon[0]*rdx2Sq[1]+0.03849001794597505*kSq[1]-0.8888888888888888*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[1], (-(1.066666666666667*epsilon[0]*rdx2Sq[1]*bcVals[6])/bcVals[7])-0.1967229636168847*kSq[6]-0.07950463919999252*kSq[5]+0.2271561119999787*kSq[4]+0.3079201435678004*kSq[2]+0.5333333333333333*epsilon[0]*rdx2Sq[1]+1.777777777777778*epsilon[0]*rdx2Sq[0]-0.3555555555555556*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[2], (-0.03442651863295482*kSq[7])-(0.1333333333333333*epsilon[0]*rdx2Sq[1]*bcVals[6])/bcVals[7]+0.0295084445425327*kSq[6]-0.05962847939999439*kSq[5]-0.063887656499994*kSq[4]+0.05333333333333333*kSq[3]+0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.03849001794597505*kSq[1]-0.8888888888888888*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[3], (-0.03442651863295482*kSq[7])-0.03442651863295482*kSq[6]+0.09938079899999068*kSq[5]+0.09938079899999068*kSq[4]-0.02666666666666666*kSq[3]+0.0769800358919501*kSq[2]+0.0769800358919501*kSq[1]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[4], 0.03442651863295482*kSq[7]-0.03442651863295482*kSq[6]+0.09938079899999068*kSq[5]+0.09938079899999068*kSq[4]+0.02666666666666666*kSq[3]+0.0769800358919501*kSq[2]-0.0769800358919501*kSq[1]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[5], 0.01721325931647741*kSq[6]-0.03975231959999626*kSq[5]-0.05678902799999467*kSq[4]+0.01333333333333333*kSq[3]-0.03849001794597505*kSq[2]-0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.4444444444444444*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[6], 0.07950463919999252*kSq[5]+0.1135780559999893*kSq[4]-0.5333333333333333*epsilon[0]*rdx2Sq[1]+0.8888888888888888*epsilon[0]*rdx2Sq[0]-0.1777777777777778*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[7], 0.01721325931647741*kSq[6]-0.03975231959999626*kSq[5]-0.05678902799999467*kSq[4]-0.01333333333333333*kSq[3]-0.03849001794597505*kSq[2]-0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.4444444444444444*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[0], (0.06666666666666667*epsilon[0]*rdx2Sq[1]*bcVals[6])/bcVals[7]-0.006147592613027645*kSq[6]+0.03336355394999686*kSq[5]+0.02697478829999747*kSq[4]-0.01924500897298752*kSq[2]+0.1888888888888889*epsilon[0]*rdx2Sq[1]+0.3111111111111111*epsilon[0]*rdx2Sq[0]-0.02222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[1], (-0.03442651863295482*kSq[7])-(0.1333333333333333*epsilon[0]*rdx2Sq[1]*bcVals[6])/bcVals[7]+0.0295084445425327*kSq[6]-0.05962847939999439*kSq[5]-0.063887656499994*kSq[4]+0.05333333333333333*kSq[3]+0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.03849001794597505*kSq[1]-0.8888888888888888*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[2], (-0.04549218533640458*kSq[7])-(0.2666666666666667*epsilon[0]*rdx2Sq[1]*bcVals[6])/bcVals[7]+0.04549218533640458*kSq[6]-0.0127775312999988*kSq[5]-0.0127775312999988*kSq[4]+0.04666666666666667*kSq[3]+0.03849001794597505*kSq[2]+0.5777777777777777*epsilon[0]*rdx2Sq[1]-0.03849001794597505*kSq[1]+0.5777777777777777*epsilon[0]*rdx2Sq[0]-0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[3], 0.01721325931647741*kSq[7]-0.05678902799999467*kSq[5]-0.03975231959999626*kSq[4]+0.01333333333333333*kSq[3]-0.4444444444444444*epsilon[0]*rdx2Sq[1]-0.03849001794597505*kSq[1]-0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[4], (-0.0295084445425327*kSq[7])+0.03442651863295482*kSq[6]-0.063887656499994*kSq[5]-0.05962847939999439*kSq[4]+0.05333333333333333*kSq[3]+0.03849001794597505*kSq[2]-0.8888888888888888*epsilon[0]*rdx2Sq[1]+0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[5], 0.0234254740499978*kSq[5]+0.0234254740499978*kSq[4]-0.01333333333333333*kSq[3]+0.2555555555555555*epsilon[0]*rdx2Sq[1]+0.2555555555555555*epsilon[0]*rdx2Sq[0]-0.03333333333333333*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[6], (-0.01721325931647741*kSq[6])-0.03975231959999626*kSq[5]-0.05678902799999467*kSq[4]+0.01333333333333333*kSq[3]+0.03849001794597505*kSq[2]-0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.4444444444444444*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[7], 0.006147592613027645*kSq[7]+0.02697478829999747*kSq[5]+0.03336355394999686*kSq[4]+0.3111111111111111*epsilon[0]*rdx2Sq[1]+0.01924500897298752*kSq[1]+0.1888888888888889*epsilon[0]*rdx2Sq[0]-0.02222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[0], 0.0295084445425327*kSq[7]+0.03442651863295482*kSq[6]-0.063887656499994*kSq[5]-0.05962847939999439*kSq[4]-0.05333333333333333*kSq[3]+0.03849001794597505*kSq[2]-0.8888888888888888*epsilon[0]*rdx2Sq[1]+0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[1], (-0.03442651863295482*kSq[7])-0.03442651863295482*kSq[6]+0.09938079899999068*kSq[5]+0.09938079899999068*kSq[4]-0.02666666666666666*kSq[3]+0.0769800358919501*kSq[2]+0.0769800358919501*kSq[1]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[2], 0.01721325931647741*kSq[7]-0.05678902799999467*kSq[5]-0.03975231959999626*kSq[4]+0.01333333333333333*kSq[3]-0.4444444444444444*epsilon[0]*rdx2Sq[1]-0.03849001794597505*kSq[1]-0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[3], (-0.1967229636168847*kSq[7])+0.2271561119999787*kSq[5]-0.07950463919999252*kSq[4]+1.777777777777778*epsilon[0]*rdx2Sq[1]+0.3079201435678004*kSq[1]+0.5333333333333333*epsilon[0]*rdx2Sq[0]-0.3555555555555556*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[4], 0.1135780559999893*kSq[5]+0.07950463919999252*kSq[4]+0.8888888888888888*epsilon[0]*rdx2Sq[1]-0.5333333333333333*epsilon[0]*rdx2Sq[0]-0.1777777777777778*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[5], 0.0295084445425327*kSq[7]-0.03442651863295482*kSq[6]-0.063887656499994*kSq[5]-0.05962847939999439*kSq[4]+0.05333333333333333*kSq[3]-0.03849001794597505*kSq[2]-0.8888888888888888*epsilon[0]*rdx2Sq[1]+0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[6], (-0.03442651863295482*kSq[7])+0.03442651863295482*kSq[6]+0.09938079899999068*kSq[5]+0.09938079899999068*kSq[4]+0.02666666666666666*kSq[3]-0.0769800358919501*kSq[2]+0.0769800358919501*kSq[1]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[7], 0.01721325931647741*kSq[7]-0.05678902799999467*kSq[5]-0.03975231959999626*kSq[4]-0.01333333333333333*kSq[3]-0.4444444444444444*epsilon[0]*rdx2Sq[1]-0.03849001794597505*kSq[1]-0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[4], globalIdxs[0], (-0.01721325931647741*kSq[7])-0.05678902799999467*kSq[5]-0.03975231959999626*kSq[4]-0.01333333333333333*kSq[3]-0.4444444444444444*epsilon[0]*rdx2Sq[1]+0.03849001794597505*kSq[1]-0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[4], globalIdxs[1], 0.03442651863295482*kSq[7]-0.03442651863295482*kSq[6]+0.09938079899999068*kSq[5]+0.09938079899999068*kSq[4]+0.02666666666666666*kSq[3]+0.0769800358919501*kSq[2]-0.0769800358919501*kSq[1]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[4], globalIdxs[2], (-0.0295084445425327*kSq[7])+0.03442651863295482*kSq[6]-0.063887656499994*kSq[5]-0.05962847939999439*kSq[4]+0.05333333333333333*kSq[3]+0.03849001794597505*kSq[2]-0.8888888888888888*epsilon[0]*rdx2Sq[1]+0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[4], globalIdxs[3], 0.1135780559999893*kSq[5]+0.07950463919999252*kSq[4]+0.8888888888888888*epsilon[0]*rdx2Sq[1]-0.5333333333333333*epsilon[0]*rdx2Sq[0]-0.1777777777777778*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[4], globalIdxs[4], 0.1967229636168847*kSq[7]+0.2271561119999787*kSq[5]-0.07950463919999252*kSq[4]+1.777777777777778*epsilon[0]*rdx2Sq[1]-0.3079201435678004*kSq[1]+0.5333333333333333*epsilon[0]*rdx2Sq[0]-0.3555555555555556*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[4], globalIdxs[5], (-0.01721325931647741*kSq[7])-0.05678902799999467*kSq[5]-0.03975231959999626*kSq[4]+0.01333333333333333*kSq[3]-0.4444444444444444*epsilon[0]*rdx2Sq[1]+0.03849001794597505*kSq[1]-0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[4], globalIdxs[6], 0.03442651863295482*kSq[7]+0.03442651863295482*kSq[6]+0.09938079899999068*kSq[5]+0.09938079899999068*kSq[4]-0.02666666666666666*kSq[3]-0.0769800358919501*kSq[2]-0.0769800358919501*kSq[1]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[4], globalIdxs[7], (-0.0295084445425327*kSq[7])-0.03442651863295482*kSq[6]-0.063887656499994*kSq[5]-0.05962847939999439*kSq[4]-0.05333333333333333*kSq[3]-0.03849001794597505*kSq[2]-0.8888888888888888*epsilon[0]*rdx2Sq[1]+0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[5], globalIdxs[0], (-0.006147592613027645*kSq[7])+0.02697478829999747*kSq[5]+0.03336355394999686*kSq[4]+0.3111111111111111*epsilon[0]*rdx2Sq[1]-0.01924500897298752*kSq[1]+0.1888888888888889*epsilon[0]*rdx2Sq[0]-0.02222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[5], globalIdxs[1], 0.01721325931647741*kSq[6]-0.03975231959999626*kSq[5]-0.05678902799999467*kSq[4]+0.01333333333333333*kSq[3]-0.03849001794597505*kSq[2]-0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.4444444444444444*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[5], globalIdxs[2], 0.0234254740499978*kSq[5]+0.0234254740499978*kSq[4]-0.01333333333333333*kSq[3]+0.2555555555555555*epsilon[0]*rdx2Sq[1]+0.2555555555555555*epsilon[0]*rdx2Sq[0]-0.03333333333333333*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[5], globalIdxs[3], 0.0295084445425327*kSq[7]-0.03442651863295482*kSq[6]-0.063887656499994*kSq[5]-0.05962847939999439*kSq[4]+0.05333333333333333*kSq[3]-0.03849001794597505*kSq[2]-0.8888888888888888*epsilon[0]*rdx2Sq[1]+0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[5], globalIdxs[4], (-0.01721325931647741*kSq[7])-0.05678902799999467*kSq[5]-0.03975231959999626*kSq[4]+0.01333333333333333*kSq[3]-0.4444444444444444*epsilon[0]*rdx2Sq[1]+0.03849001794597505*kSq[1]-0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[5], globalIdxs[5], 0.04549218533640458*kSq[7]-0.04549218533640458*kSq[6]-0.0127775312999988*kSq[5]-0.0127775312999988*kSq[4]+0.04666666666666667*kSq[3]-0.03849001794597505*kSq[2]+0.5777777777777777*epsilon[0]*rdx2Sq[1]+0.03849001794597505*kSq[1]+0.5777777777777777*epsilon[0]*rdx2Sq[0]-0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[5], globalIdxs[6], 0.03442651863295482*kSq[7]-0.0295084445425327*kSq[6]-0.05962847939999439*kSq[5]-0.063887656499994*kSq[4]+0.05333333333333333*kSq[3]+0.06666666666666667*epsilon[0]*rdx2Sq[1]+0.03849001794597505*kSq[1]-0.8888888888888888*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[5], globalIdxs[7], 0.006147592613027645*kSq[6]+0.03336355394999686*kSq[5]+0.02697478829999747*kSq[4]+0.01924500897298752*kSq[2]+0.1888888888888889*epsilon[0]*rdx2Sq[1]+0.3111111111111111*epsilon[0]*rdx2Sq[0]-0.02222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[6], globalIdxs[0], (-0.01721325931647741*kSq[6])-0.03975231959999626*kSq[5]-0.05678902799999467*kSq[4]-0.01333333333333333*kSq[3]+0.03849001794597505*kSq[2]-0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.4444444444444444*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[6], globalIdxs[1], 0.07950463919999252*kSq[5]+0.1135780559999893*kSq[4]-0.5333333333333333*epsilon[0]*rdx2Sq[1]+0.8888888888888888*epsilon[0]*rdx2Sq[0]-0.1777777777777778*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[6], globalIdxs[2], (-0.01721325931647741*kSq[6])-0.03975231959999626*kSq[5]-0.05678902799999467*kSq[4]+0.01333333333333333*kSq[3]+0.03849001794597505*kSq[2]-0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.4444444444444444*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[6], globalIdxs[3], (-0.03442651863295482*kSq[7])+0.03442651863295482*kSq[6]+0.09938079899999068*kSq[5]+0.09938079899999068*kSq[4]+0.02666666666666666*kSq[3]-0.0769800358919501*kSq[2]+0.0769800358919501*kSq[1]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[6], globalIdxs[4], 0.03442651863295482*kSq[7]+0.03442651863295482*kSq[6]+0.09938079899999068*kSq[5]+0.09938079899999068*kSq[4]-0.02666666666666666*kSq[3]-0.0769800358919501*kSq[2]-0.0769800358919501*kSq[1]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[6], globalIdxs[5], 0.03442651863295482*kSq[7]-0.0295084445425327*kSq[6]-0.05962847939999439*kSq[5]-0.063887656499994*kSq[4]+0.05333333333333333*kSq[3]+0.06666666666666667*epsilon[0]*rdx2Sq[1]+0.03849001794597505*kSq[1]-0.8888888888888888*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[6], globalIdxs[6], 0.1967229636168847*kSq[6]-0.07950463919999252*kSq[5]+0.2271561119999787*kSq[4]-0.3079201435678004*kSq[2]+0.5333333333333333*epsilon[0]*rdx2Sq[1]+1.777777777777778*epsilon[0]*rdx2Sq[0]-0.3555555555555556*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[6], globalIdxs[7], (-0.03442651863295482*kSq[7])-0.0295084445425327*kSq[6]-0.05962847939999439*kSq[5]-0.063887656499994*kSq[4]-0.05333333333333333*kSq[3]+0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.03849001794597505*kSq[1]-0.8888888888888888*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[7], globalIdxs[0], 0.0234254740499978*kSq[5]+0.0234254740499978*kSq[4]+0.01333333333333333*kSq[3]+0.2555555555555555*epsilon[0]*rdx2Sq[1]+0.2555555555555555*epsilon[0]*rdx2Sq[0]-0.03333333333333333*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[7], globalIdxs[1], 0.01721325931647741*kSq[6]-0.03975231959999626*kSq[5]-0.05678902799999467*kSq[4]-0.01333333333333333*kSq[3]-0.03849001794597505*kSq[2]-0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.4444444444444444*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[7], globalIdxs[2], 0.006147592613027645*kSq[7]+0.02697478829999747*kSq[5]+0.03336355394999686*kSq[4]+0.3111111111111111*epsilon[0]*rdx2Sq[1]+0.01924500897298752*kSq[1]+0.1888888888888889*epsilon[0]*rdx2Sq[0]-0.02222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[7], globalIdxs[3], 0.01721325931647741*kSq[7]-0.05678902799999467*kSq[5]-0.03975231959999626*kSq[4]-0.01333333333333333*kSq[3]-0.4444444444444444*epsilon[0]*rdx2Sq[1]-0.03849001794597505*kSq[1]-0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[7], globalIdxs[4], (-0.0295084445425327*kSq[7])-0.03442651863295482*kSq[6]-0.063887656499994*kSq[5]-0.05962847939999439*kSq[4]-0.05333333333333333*kSq[3]-0.03849001794597505*kSq[2]-0.8888888888888888*epsilon[0]*rdx2Sq[1]+0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[7], globalIdxs[5], 0.006147592613027645*kSq[6]+0.03336355394999686*kSq[5]+0.02697478829999747*kSq[4]+0.01924500897298752*kSq[2]+0.1888888888888889*epsilon[0]*rdx2Sq[1]+0.3111111111111111*epsilon[0]*rdx2Sq[0]-0.02222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[7], globalIdxs[6], (-0.03442651863295482*kSq[7])-0.0295084445425327*kSq[6]-0.05962847939999439*kSq[5]-0.063887656499994*kSq[4]-0.05333333333333333*kSq[3]+0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.03849001794597505*kSq[1]-0.8888888888888888*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[7], globalIdxs[7], (-0.04549218533640458*kSq[7])-0.04549218533640458*kSq[6]-0.0127775312999988*kSq[5]-0.0127775312999988*kSq[4]-0.04666666666666667*kSq[3]-0.03849001794597505*kSq[2]+0.5777777777777777*epsilon[0]*rdx2Sq[1]-0.03849001794597505*kSq[1]+0.5777777777777777*epsilon[0]*rdx2Sq[0]-0.06666666666666667*kSq[0]);

}
void fem_poisson_lhs_stencil_consteps_2x_ser_p1_lox_robinx_loy_periodicy(const double *epsilon, const double *kSq, const double *dx, const double *bcVals, const long *globalIdxs, gkyl_mat_triples *tri) 
{ 
  // epsilon: permittivity.
  // kSq: wave number squared (factor multiplying phi).
  // dx: cell length in each direction.
  // bcVals[3]: values to impose as BCs, i.e. bcVals[0]*phi+bcVals[1]*d(phi)/dx=bcVals[2].
  // globalIdxs: global linear index of each basis function/node in current cell.
  // tri: triples object (i,j,val), i.e. contribute val to i,j element of the global matrix.

  double rdx2Sq[2];
  rdx2Sq[0] = 4.0/(dx[0]*dx[0]);
  rdx2Sq[1] = 4.0/(dx[1]*dx[1]);

  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[0], (-0.1666666666666667*kSq[3])+0.1924500897298752*kSq[2]+0.3333333333333333*epsilon[0]*rdx2Sq[1]+0.1924500897298752*kSq[1]-(0.6666666666666666*bcVals[0]*epsilon[0]*rdx2Sq[0])/bcVals[1]+0.3333333333333333*epsilon[0]*rdx2Sq[0]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[1], 0.09622504486493762*kSq[2]+0.1666666666666667*epsilon[0]*rdx2Sq[1]-0.3333333333333333*epsilon[0]*rdx2Sq[0]-0.1111111111111111*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[2], (-0.3333333333333333*epsilon[0]*rdx2Sq[1])+0.09622504486493762*kSq[1]-(0.3333333333333333*bcVals[0]*epsilon[0]*rdx2Sq[0])/bcVals[1]+0.1666666666666667*epsilon[0]*rdx2Sq[0]-0.1111111111111111*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[3], (-0.1666666666666667*epsilon[0]*rdx2Sq[1])-0.1666666666666667*epsilon[0]*rdx2Sq[0]-0.05555555555555555*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[0], 0.09622504486493762*kSq[2]+0.1666666666666667*epsilon[0]*rdx2Sq[1]-0.3333333333333333*epsilon[0]*rdx2Sq[0]-0.1111111111111111*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[1], 0.1666666666666667*kSq[3]+0.1924500897298752*kSq[2]+0.3333333333333333*epsilon[0]*rdx2Sq[1]-0.1924500897298752*kSq[1]+0.3333333333333333*epsilon[0]*rdx2Sq[0]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[2], (-0.1666666666666667*epsilon[0]*rdx2Sq[1])-0.1666666666666667*epsilon[0]*rdx2Sq[0]-0.05555555555555555*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[3], (-0.3333333333333333*epsilon[0]*rdx2Sq[1])-0.09622504486493762*kSq[1]+0.1666666666666667*epsilon[0]*rdx2Sq[0]-0.1111111111111111*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[0], (-0.3333333333333333*epsilon[0]*rdx2Sq[1])+0.09622504486493762*kSq[1]-(0.3333333333333333*bcVals[0]*epsilon[0]*rdx2Sq[0])/bcVals[1]+0.1666666666666667*epsilon[0]*rdx2Sq[0]-0.1111111111111111*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[1], (-0.1666666666666667*epsilon[0]*rdx2Sq[1])-0.1666666666666667*epsilon[0]*rdx2Sq[0]-0.05555555555555555*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[2], 0.1666666666666667*kSq[3]-0.1924500897298752*kSq[2]+0.3333333333333333*epsilon[0]*rdx2Sq[1]+0.1924500897298752*kSq[1]-(0.6666666666666666*bcVals[0]*epsilon[0]*rdx2Sq[0])/bcVals[1]+0.3333333333333333*epsilon[0]*rdx2Sq[0]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[3], (-0.09622504486493762*kSq[2])+0.1666666666666667*epsilon[0]*rdx2Sq[1]-0.3333333333333333*epsilon[0]*rdx2Sq[0]-0.1111111111111111*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[0], (-0.1666666666666667*epsilon[0]*rdx2Sq[1])-0.1666666666666667*epsilon[0]*rdx2Sq[0]-0.05555555555555555*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[1], (-0.3333333333333333*epsilon[0]*rdx2Sq[1])-0.09622504486493762*kSq[1]+0.1666666666666667*epsilon[0]*rdx2Sq[0]-0.1111111111111111*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[2], (-0.09622504486493762*kSq[2])+0.1666666666666667*epsilon[0]*rdx2Sq[1]-0.3333333333333333*epsilon[0]*rdx2Sq[0]-0.1111111111111111*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[3], (-0.1666666666666667*kSq[3])-0.1924500897298752*kSq[2]+0.3333333333333333*epsilon[0]*rdx2Sq[1]-0.1924500897298752*kSq[1]+0.3333333333333333*epsilon[0]*rdx2Sq[0]-0.2222222222222222*kSq[0]);

}
void fem_poisson_lhs_stencil_consteps_2x_ser_p2_lox_robinx_loy_periodicy(const double *epsilon, const double *kSq, const double *dx, const double *bcVals, const long *globalIdxs, gkyl_mat_triples *tri) 
{ 
  // epsilon: permittivity.
  // kSq: wave number squared (factor multiplying phi).
  // dx: cell length in each direction.
  // bcVals[3]: values to impose as BCs, i.e. bcVals[0]*phi+bcVals[1]*d(phi)/dx=bcVals[2].
  // globalIdxs: global linear index of each basis function/node in current cell.
  // tri: triples object (i,j,val), i.e. contribute val to i,j element of the global matrix.

  double rdx2Sq[2];
  rdx2Sq[0] = 4.0/(dx[0]*dx[0]);
  rdx2Sq[1] = 4.0/(dx[1]*dx[1]);

  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[0], 0.04549218533640458*kSq[7]+0.04549218533640458*kSq[6]-0.0127775312999988*kSq[5]-0.0127775312999988*kSq[4]-0.04666666666666667*kSq[3]+0.03849001794597505*kSq[2]+0.5777777777777777*epsilon[0]*rdx2Sq[1]+0.03849001794597505*kSq[1]-(0.2666666666666667*bcVals[0]*epsilon[0]*rdx2Sq[0])/bcVals[1]+0.5777777777777777*epsilon[0]*rdx2Sq[0]-0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[1], 0.03442651863295482*kSq[7]+0.0295084445425327*kSq[6]-0.05962847939999439*kSq[5]-0.063887656499994*kSq[4]-0.05333333333333333*kSq[3]+0.06666666666666667*epsilon[0]*rdx2Sq[1]+0.03849001794597505*kSq[1]-0.8888888888888888*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[2], (-0.006147592613027645*kSq[6])+0.03336355394999686*kSq[5]+0.02697478829999747*kSq[4]-0.01924500897298752*kSq[2]+0.1888888888888889*epsilon[0]*rdx2Sq[1]+0.3111111111111111*epsilon[0]*rdx2Sq[0]-0.02222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[3], 0.0295084445425327*kSq[7]+0.03442651863295482*kSq[6]-0.063887656499994*kSq[5]-0.05962847939999439*kSq[4]-0.05333333333333333*kSq[3]+0.03849001794597505*kSq[2]-0.8888888888888888*epsilon[0]*rdx2Sq[1]-(0.1333333333333333*bcVals[0]*epsilon[0]*rdx2Sq[0])/bcVals[1]+0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[4], (-0.01721325931647741*kSq[7])-0.05678902799999467*kSq[5]-0.03975231959999626*kSq[4]-0.01333333333333333*kSq[3]-0.4444444444444444*epsilon[0]*rdx2Sq[1]+0.03849001794597505*kSq[1]-0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[5], (-0.006147592613027645*kSq[7])+0.02697478829999747*kSq[5]+0.03336355394999686*kSq[4]+0.3111111111111111*epsilon[0]*rdx2Sq[1]-0.01924500897298752*kSq[1]+(0.06666666666666667*bcVals[0]*epsilon[0]*rdx2Sq[0])/bcVals[1]+0.1888888888888889*epsilon[0]*rdx2Sq[0]-0.02222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[6], (-0.01721325931647741*kSq[6])-0.03975231959999626*kSq[5]-0.05678902799999467*kSq[4]-0.01333333333333333*kSq[3]+0.03849001794597505*kSq[2]-0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.4444444444444444*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[7], 0.0234254740499978*kSq[5]+0.0234254740499978*kSq[4]+0.01333333333333333*kSq[3]+0.2555555555555555*epsilon[0]*rdx2Sq[1]+0.2555555555555555*epsilon[0]*rdx2Sq[0]-0.03333333333333333*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[0], 0.03442651863295482*kSq[7]+0.0295084445425327*kSq[6]-0.05962847939999439*kSq[5]-0.063887656499994*kSq[4]-0.05333333333333333*kSq[3]+0.06666666666666667*epsilon[0]*rdx2Sq[1]+0.03849001794597505*kSq[1]-0.8888888888888888*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[1], (-0.1967229636168847*kSq[6])-0.07950463919999252*kSq[5]+0.2271561119999787*kSq[4]+0.3079201435678004*kSq[2]+0.5333333333333333*epsilon[0]*rdx2Sq[1]+1.777777777777778*epsilon[0]*rdx2Sq[0]-0.3555555555555556*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[2], (-0.03442651863295482*kSq[7])+0.0295084445425327*kSq[6]-0.05962847939999439*kSq[5]-0.063887656499994*kSq[4]+0.05333333333333333*kSq[3]+0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.03849001794597505*kSq[1]-0.8888888888888888*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[3], (-0.03442651863295482*kSq[7])-0.03442651863295482*kSq[6]+0.09938079899999068*kSq[5]+0.09938079899999068*kSq[4]-0.02666666666666666*kSq[3]+0.0769800358919501*kSq[2]+0.0769800358919501*kSq[1]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[4], 0.03442651863295482*kSq[7]-0.03442651863295482*kSq[6]+0.09938079899999068*kSq[5]+0.09938079899999068*kSq[4]+0.02666666666666666*kSq[3]+0.0769800358919501*kSq[2]-0.0769800358919501*kSq[1]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[5], 0.01721325931647741*kSq[6]-0.03975231959999626*kSq[5]-0.05678902799999467*kSq[4]+0.01333333333333333*kSq[3]-0.03849001794597505*kSq[2]-0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.4444444444444444*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[6], 0.07950463919999252*kSq[5]+0.1135780559999893*kSq[4]-0.5333333333333333*epsilon[0]*rdx2Sq[1]+0.8888888888888888*epsilon[0]*rdx2Sq[0]-0.1777777777777778*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[7], 0.01721325931647741*kSq[6]-0.03975231959999626*kSq[5]-0.05678902799999467*kSq[4]-0.01333333333333333*kSq[3]-0.03849001794597505*kSq[2]-0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.4444444444444444*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[0], (-0.006147592613027645*kSq[6])+0.03336355394999686*kSq[5]+0.02697478829999747*kSq[4]-0.01924500897298752*kSq[2]+0.1888888888888889*epsilon[0]*rdx2Sq[1]+0.3111111111111111*epsilon[0]*rdx2Sq[0]-0.02222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[1], (-0.03442651863295482*kSq[7])+0.0295084445425327*kSq[6]-0.05962847939999439*kSq[5]-0.063887656499994*kSq[4]+0.05333333333333333*kSq[3]+0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.03849001794597505*kSq[1]-0.8888888888888888*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[2], (-0.04549218533640458*kSq[7])+0.04549218533640458*kSq[6]-0.0127775312999988*kSq[5]-0.0127775312999988*kSq[4]+0.04666666666666667*kSq[3]+0.03849001794597505*kSq[2]+0.5777777777777777*epsilon[0]*rdx2Sq[1]-0.03849001794597505*kSq[1]+0.5777777777777777*epsilon[0]*rdx2Sq[0]-0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[3], 0.01721325931647741*kSq[7]-0.05678902799999467*kSq[5]-0.03975231959999626*kSq[4]+0.01333333333333333*kSq[3]-0.4444444444444444*epsilon[0]*rdx2Sq[1]-0.03849001794597505*kSq[1]-0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[4], (-0.0295084445425327*kSq[7])+0.03442651863295482*kSq[6]-0.063887656499994*kSq[5]-0.05962847939999439*kSq[4]+0.05333333333333333*kSq[3]+0.03849001794597505*kSq[2]-0.8888888888888888*epsilon[0]*rdx2Sq[1]+0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[5], 0.0234254740499978*kSq[5]+0.0234254740499978*kSq[4]-0.01333333333333333*kSq[3]+0.2555555555555555*epsilon[0]*rdx2Sq[1]+0.2555555555555555*epsilon[0]*rdx2Sq[0]-0.03333333333333333*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[6], (-0.01721325931647741*kSq[6])-0.03975231959999626*kSq[5]-0.05678902799999467*kSq[4]+0.01333333333333333*kSq[3]+0.03849001794597505*kSq[2]-0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.4444444444444444*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[7], 0.006147592613027645*kSq[7]+0.02697478829999747*kSq[5]+0.03336355394999686*kSq[4]+0.3111111111111111*epsilon[0]*rdx2Sq[1]+0.01924500897298752*kSq[1]+0.1888888888888889*epsilon[0]*rdx2Sq[0]-0.02222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[0], 0.0295084445425327*kSq[7]+0.03442651863295482*kSq[6]-0.063887656499994*kSq[5]-0.05962847939999439*kSq[4]-0.05333333333333333*kSq[3]+0.03849001794597505*kSq[2]-0.8888888888888888*epsilon[0]*rdx2Sq[1]-(0.1333333333333333*bcVals[0]*epsilon[0]*rdx2Sq[0])/bcVals[1]+0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[1], (-0.03442651863295482*kSq[7])-0.03442651863295482*kSq[6]+0.09938079899999068*kSq[5]+0.09938079899999068*kSq[4]-0.02666666666666666*kSq[3]+0.0769800358919501*kSq[2]+0.0769800358919501*kSq[1]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[2], 0.01721325931647741*kSq[7]-0.05678902799999467*kSq[5]-0.03975231959999626*kSq[4]+0.01333333333333333*kSq[3]-0.4444444444444444*epsilon[0]*rdx2Sq[1]-0.03849001794597505*kSq[1]-0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[3], (-0.1967229636168847*kSq[7])+0.2271561119999787*kSq[5]-0.07950463919999252*kSq[4]+1.777777777777778*epsilon[0]*rdx2Sq[1]+0.3079201435678004*kSq[1]-(1.066666666666667*bcVals[0]*epsilon[0]*rdx2Sq[0])/bcVals[1]+0.5333333333333333*epsilon[0]*rdx2Sq[0]-0.3555555555555556*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[4], 0.1135780559999893*kSq[5]+0.07950463919999252*kSq[4]+0.8888888888888888*epsilon[0]*rdx2Sq[1]-0.5333333333333333*epsilon[0]*rdx2Sq[0]-0.1777777777777778*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[5], 0.0295084445425327*kSq[7]-0.03442651863295482*kSq[6]-0.063887656499994*kSq[5]-0.05962847939999439*kSq[4]+0.05333333333333333*kSq[3]-0.03849001794597505*kSq[2]-0.8888888888888888*epsilon[0]*rdx2Sq[1]-(0.1333333333333333*bcVals[0]*epsilon[0]*rdx2Sq[0])/bcVals[1]+0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[6], (-0.03442651863295482*kSq[7])+0.03442651863295482*kSq[6]+0.09938079899999068*kSq[5]+0.09938079899999068*kSq[4]+0.02666666666666666*kSq[3]-0.0769800358919501*kSq[2]+0.0769800358919501*kSq[1]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[7], 0.01721325931647741*kSq[7]-0.05678902799999467*kSq[5]-0.03975231959999626*kSq[4]-0.01333333333333333*kSq[3]-0.4444444444444444*epsilon[0]*rdx2Sq[1]-0.03849001794597505*kSq[1]-0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[4], globalIdxs[0], (-0.01721325931647741*kSq[7])-0.05678902799999467*kSq[5]-0.03975231959999626*kSq[4]-0.01333333333333333*kSq[3]-0.4444444444444444*epsilon[0]*rdx2Sq[1]+0.03849001794597505*kSq[1]-0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[4], globalIdxs[1], 0.03442651863295482*kSq[7]-0.03442651863295482*kSq[6]+0.09938079899999068*kSq[5]+0.09938079899999068*kSq[4]+0.02666666666666666*kSq[3]+0.0769800358919501*kSq[2]-0.0769800358919501*kSq[1]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[4], globalIdxs[2], (-0.0295084445425327*kSq[7])+0.03442651863295482*kSq[6]-0.063887656499994*kSq[5]-0.05962847939999439*kSq[4]+0.05333333333333333*kSq[3]+0.03849001794597505*kSq[2]-0.8888888888888888*epsilon[0]*rdx2Sq[1]+0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[4], globalIdxs[3], 0.1135780559999893*kSq[5]+0.07950463919999252*kSq[4]+0.8888888888888888*epsilon[0]*rdx2Sq[1]-0.5333333333333333*epsilon[0]*rdx2Sq[0]-0.1777777777777778*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[4], globalIdxs[4], 0.1967229636168847*kSq[7]+0.2271561119999787*kSq[5]-0.07950463919999252*kSq[4]+1.777777777777778*epsilon[0]*rdx2Sq[1]-0.3079201435678004*kSq[1]+0.5333333333333333*epsilon[0]*rdx2Sq[0]-0.3555555555555556*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[4], globalIdxs[5], (-0.01721325931647741*kSq[7])-0.05678902799999467*kSq[5]-0.03975231959999626*kSq[4]+0.01333333333333333*kSq[3]-0.4444444444444444*epsilon[0]*rdx2Sq[1]+0.03849001794597505*kSq[1]-0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[4], globalIdxs[6], 0.03442651863295482*kSq[7]+0.03442651863295482*kSq[6]+0.09938079899999068*kSq[5]+0.09938079899999068*kSq[4]-0.02666666666666666*kSq[3]-0.0769800358919501*kSq[2]-0.0769800358919501*kSq[1]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[4], globalIdxs[7], (-0.0295084445425327*kSq[7])-0.03442651863295482*kSq[6]-0.063887656499994*kSq[5]-0.05962847939999439*kSq[4]-0.05333333333333333*kSq[3]-0.03849001794597505*kSq[2]-0.8888888888888888*epsilon[0]*rdx2Sq[1]+0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[5], globalIdxs[0], (-0.006147592613027645*kSq[7])+0.02697478829999747*kSq[5]+0.03336355394999686*kSq[4]+0.3111111111111111*epsilon[0]*rdx2Sq[1]-0.01924500897298752*kSq[1]+(0.06666666666666667*bcVals[0]*epsilon[0]*rdx2Sq[0])/bcVals[1]+0.1888888888888889*epsilon[0]*rdx2Sq[0]-0.02222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[5], globalIdxs[1], 0.01721325931647741*kSq[6]-0.03975231959999626*kSq[5]-0.05678902799999467*kSq[4]+0.01333333333333333*kSq[3]-0.03849001794597505*kSq[2]-0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.4444444444444444*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[5], globalIdxs[2], 0.0234254740499978*kSq[5]+0.0234254740499978*kSq[4]-0.01333333333333333*kSq[3]+0.2555555555555555*epsilon[0]*rdx2Sq[1]+0.2555555555555555*epsilon[0]*rdx2Sq[0]-0.03333333333333333*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[5], globalIdxs[3], 0.0295084445425327*kSq[7]-0.03442651863295482*kSq[6]-0.063887656499994*kSq[5]-0.05962847939999439*kSq[4]+0.05333333333333333*kSq[3]-0.03849001794597505*kSq[2]-0.8888888888888888*epsilon[0]*rdx2Sq[1]-(0.1333333333333333*bcVals[0]*epsilon[0]*rdx2Sq[0])/bcVals[1]+0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[5], globalIdxs[4], (-0.01721325931647741*kSq[7])-0.05678902799999467*kSq[5]-0.03975231959999626*kSq[4]+0.01333333333333333*kSq[3]-0.4444444444444444*epsilon[0]*rdx2Sq[1]+0.03849001794597505*kSq[1]-0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[5], globalIdxs[5], 0.04549218533640458*kSq[7]-0.04549218533640458*kSq[6]-0.0127775312999988*kSq[5]-0.0127775312999988*kSq[4]+0.04666666666666667*kSq[3]-0.03849001794597505*kSq[2]+0.5777777777777777*epsilon[0]*rdx2Sq[1]+0.03849001794597505*kSq[1]-(0.2666666666666667*bcVals[0]*epsilon[0]*rdx2Sq[0])/bcVals[1]+0.5777777777777777*epsilon[0]*rdx2Sq[0]-0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[5], globalIdxs[6], 0.03442651863295482*kSq[7]-0.0295084445425327*kSq[6]-0.05962847939999439*kSq[5]-0.063887656499994*kSq[4]+0.05333333333333333*kSq[3]+0.06666666666666667*epsilon[0]*rdx2Sq[1]+0.03849001794597505*kSq[1]-0.8888888888888888*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[5], globalIdxs[7], 0.006147592613027645*kSq[6]+0.03336355394999686*kSq[5]+0.02697478829999747*kSq[4]+0.01924500897298752*kSq[2]+0.1888888888888889*epsilon[0]*rdx2Sq[1]+0.3111111111111111*epsilon[0]*rdx2Sq[0]-0.02222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[6], globalIdxs[0], (-0.01721325931647741*kSq[6])-0.03975231959999626*kSq[5]-0.05678902799999467*kSq[4]-0.01333333333333333*kSq[3]+0.03849001794597505*kSq[2]-0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.4444444444444444*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[6], globalIdxs[1], 0.07950463919999252*kSq[5]+0.1135780559999893*kSq[4]-0.5333333333333333*epsilon[0]*rdx2Sq[1]+0.8888888888888888*epsilon[0]*rdx2Sq[0]-0.1777777777777778*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[6], globalIdxs[2], (-0.01721325931647741*kSq[6])-0.03975231959999626*kSq[5]-0.05678902799999467*kSq[4]+0.01333333333333333*kSq[3]+0.03849001794597505*kSq[2]-0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.4444444444444444*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[6], globalIdxs[3], (-0.03442651863295482*kSq[7])+0.03442651863295482*kSq[6]+0.09938079899999068*kSq[5]+0.09938079899999068*kSq[4]+0.02666666666666666*kSq[3]-0.0769800358919501*kSq[2]+0.0769800358919501*kSq[1]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[6], globalIdxs[4], 0.03442651863295482*kSq[7]+0.03442651863295482*kSq[6]+0.09938079899999068*kSq[5]+0.09938079899999068*kSq[4]-0.02666666666666666*kSq[3]-0.0769800358919501*kSq[2]-0.0769800358919501*kSq[1]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[6], globalIdxs[5], 0.03442651863295482*kSq[7]-0.0295084445425327*kSq[6]-0.05962847939999439*kSq[5]-0.063887656499994*kSq[4]+0.05333333333333333*kSq[3]+0.06666666666666667*epsilon[0]*rdx2Sq[1]+0.03849001794597505*kSq[1]-0.8888888888888888*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[6], globalIdxs[6], 0.1967229636168847*kSq[6]-0.07950463919999252*kSq[5]+0.2271561119999787*kSq[4]-0.3079201435678004*kSq[2]+0.5333333333333333*epsilon[0]*rdx2Sq[1]+1.777777777777778*epsilon[0]*rdx2Sq[0]-0.3555555555555556*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[6], globalIdxs[7], (-0.03442651863295482*kSq[7])-0.0295084445425327*kSq[6]-0.05962847939999439*kSq[5]-0.063887656499994*kSq[4]-0.05333333333333333*kSq[3]+0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.03849001794597505*kSq[1]-0.8888888888888888*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[7], globalIdxs[0], 0.0234254740499978*kSq[5]+0.0234254740499978*kSq[4]+0.01333333333333333*kSq[3]+0.2555555555555555*epsilon[0]*rdx2Sq[1]+0.2555555555555555*epsilon[0]*rdx2Sq[0]-0.03333333333333333*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[7], globalIdxs[1], 0.01721325931647741*kSq[6]-0.03975231959999626*kSq[5]-0.05678902799999467*kSq[4]-0.01333333333333333*kSq[3]-0.03849001794597505*kSq[2]-0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.4444444444444444*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[7], globalIdxs[2], 0.006147592613027645*kSq[7]+0.02697478829999747*kSq[5]+0.03336355394999686*kSq[4]+0.3111111111111111*epsilon[0]*rdx2Sq[1]+0.01924500897298752*kSq[1]+0.1888888888888889*epsilon[0]*rdx2Sq[0]-0.02222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[7], globalIdxs[3], 0.01721325931647741*kSq[7]-0.05678902799999467*kSq[5]-0.03975231959999626*kSq[4]-0.01333333333333333*kSq[3]-0.4444444444444444*epsilon[0]*rdx2Sq[1]-0.03849001794597505*kSq[1]-0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[7], globalIdxs[4], (-0.0295084445425327*kSq[7])-0.03442651863295482*kSq[6]-0.063887656499994*kSq[5]-0.05962847939999439*kSq[4]-0.05333333333333333*kSq[3]-0.03849001794597505*kSq[2]-0.8888888888888888*epsilon[0]*rdx2Sq[1]+0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[7], globalIdxs[5], 0.006147592613027645*kSq[6]+0.03336355394999686*kSq[5]+0.02697478829999747*kSq[4]+0.01924500897298752*kSq[2]+0.1888888888888889*epsilon[0]*rdx2Sq[1]+0.3111111111111111*epsilon[0]*rdx2Sq[0]-0.02222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[7], globalIdxs[6], (-0.03442651863295482*kSq[7])-0.0295084445425327*kSq[6]-0.05962847939999439*kSq[5]-0.063887656499994*kSq[4]-0.05333333333333333*kSq[3]+0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.03849001794597505*kSq[1]-0.8888888888888888*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[7], globalIdxs[7], (-0.04549218533640458*kSq[7])-0.04549218533640458*kSq[6]-0.0127775312999988*kSq[5]-0.0127775312999988*kSq[4]-0.04666666666666667*kSq[3]-0.03849001794597505*kSq[2]+0.5777777777777777*epsilon[0]*rdx2Sq[1]-0.03849001794597505*kSq[1]+0.5777777777777777*epsilon[0]*rdx2Sq[0]-0.06666666666666667*kSq[0]);

}
void fem_poisson_lhs_stencil_consteps_2x_ser_p1_lox_robinx_loy_dirichlety(const double *epsilon, const double *kSq, const double *dx, const double *bcVals, const long *globalIdxs, gkyl_mat_triples *tri) 
{ 
  // epsilon: permittivity.
  // kSq: wave number squared (factor multiplying phi).
  // dx: cell length in each direction.
  // bcVals[3]: values to impose as BCs, i.e. bcVals[0]*phi+bcVals[1]*d(phi)/dx=bcVals[2].
  // globalIdxs: global linear index of each basis function/node in current cell.
  // tri: triples object (i,j,val), i.e. contribute val to i,j element of the global matrix.

  double rdx2Sq[2];
  rdx2Sq[0] = 4.0/(dx[0]*dx[0]);
  rdx2Sq[1] = 4.0/(dx[1]*dx[1]);

  gkyl_mat_triples_insert(tri, globalIdxs[0], globalIdxs[0], 1.0);
  gkyl_mat_triples_insert(tri, globalIdxs[0], globalIdxs[1], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[0], globalIdxs[2], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[0], globalIdxs[3], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[1], globalIdxs[0], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[1], globalIdxs[1], 1.0);
  gkyl_mat_triples_insert(tri, globalIdxs[1], globalIdxs[2], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[1], globalIdxs[3], 0.0);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[0], (-0.3333333333333333*epsilon[0]*rdx2Sq[1])+0.09622504486493762*kSq[1]-(0.3333333333333333*bcVals[0]*epsilon[0]*rdx2Sq[0])/bcVals[1]+0.1666666666666667*epsilon[0]*rdx2Sq[0]-0.1111111111111111*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[1], (-0.1666666666666667*epsilon[0]*rdx2Sq[1])-0.1666666666666667*epsilon[0]*rdx2Sq[0]-0.05555555555555555*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[2], 0.1666666666666667*kSq[3]-0.1924500897298752*kSq[2]+0.3333333333333333*epsilon[0]*rdx2Sq[1]+0.1924500897298752*kSq[1]-(0.6666666666666666*bcVals[0]*epsilon[0]*rdx2Sq[0])/bcVals[1]+0.3333333333333333*epsilon[0]*rdx2Sq[0]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[3], (-0.09622504486493762*kSq[2])+0.1666666666666667*epsilon[0]*rdx2Sq[1]-0.3333333333333333*epsilon[0]*rdx2Sq[0]-0.1111111111111111*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[0], (-0.1666666666666667*epsilon[0]*rdx2Sq[1])-0.1666666666666667*epsilon[0]*rdx2Sq[0]-0.05555555555555555*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[1], (-0.3333333333333333*epsilon[0]*rdx2Sq[1])-0.09622504486493762*kSq[1]+0.1666666666666667*epsilon[0]*rdx2Sq[0]-0.1111111111111111*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[2], (-0.09622504486493762*kSq[2])+0.1666666666666667*epsilon[0]*rdx2Sq[1]-0.3333333333333333*epsilon[0]*rdx2Sq[0]-0.1111111111111111*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[3], (-0.1666666666666667*kSq[3])-0.1924500897298752*kSq[2]+0.3333333333333333*epsilon[0]*rdx2Sq[1]-0.1924500897298752*kSq[1]+0.3333333333333333*epsilon[0]*rdx2Sq[0]-0.2222222222222222*kSq[0]);

}
void fem_poisson_lhs_stencil_consteps_2x_ser_p2_lox_robinx_loy_dirichlety(const double *epsilon, const double *kSq, const double *dx, const double *bcVals, const long *globalIdxs, gkyl_mat_triples *tri) 
{ 
  // epsilon: permittivity.
  // kSq: wave number squared (factor multiplying phi).
  // dx: cell length in each direction.
  // bcVals[3]: values to impose as BCs, i.e. bcVals[0]*phi+bcVals[1]*d(phi)/dx=bcVals[2].
  // globalIdxs: global linear index of each basis function/node in current cell.
  // tri: triples object (i,j,val), i.e. contribute val to i,j element of the global matrix.

  double rdx2Sq[2];
  rdx2Sq[0] = 4.0/(dx[0]*dx[0]);
  rdx2Sq[1] = 4.0/(dx[1]*dx[1]);

  gkyl_mat_triples_insert(tri, globalIdxs[0], globalIdxs[0], 1.0);
  gkyl_mat_triples_insert(tri, globalIdxs[0], globalIdxs[1], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[0], globalIdxs[2], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[0], globalIdxs[3], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[0], globalIdxs[4], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[0], globalIdxs[5], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[0], globalIdxs[6], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[0], globalIdxs[7], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[1], globalIdxs[0], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[1], globalIdxs[1], 1.0);
  gkyl_mat_triples_insert(tri, globalIdxs[1], globalIdxs[2], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[1], globalIdxs[3], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[1], globalIdxs[4], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[1], globalIdxs[5], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[1], globalIdxs[6], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[1], globalIdxs[7], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[2], globalIdxs[0], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[2], globalIdxs[1], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[2], globalIdxs[2], 1.0);
  gkyl_mat_triples_insert(tri, globalIdxs[2], globalIdxs[3], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[2], globalIdxs[4], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[2], globalIdxs[5], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[2], globalIdxs[6], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[2], globalIdxs[7], 0.0);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[0], 0.0295084445425327*kSq[7]+0.03442651863295482*kSq[6]-0.063887656499994*kSq[5]-0.05962847939999439*kSq[4]-0.05333333333333333*kSq[3]+0.03849001794597505*kSq[2]-0.8888888888888888*epsilon[0]*rdx2Sq[1]-(0.1333333333333333*bcVals[0]*epsilon[0]*rdx2Sq[0])/bcVals[1]+0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[1], (-0.03442651863295482*kSq[7])-0.03442651863295482*kSq[6]+0.09938079899999068*kSq[5]+0.09938079899999068*kSq[4]-0.02666666666666666*kSq[3]+0.0769800358919501*kSq[2]+0.0769800358919501*kSq[1]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[2], 0.01721325931647741*kSq[7]-0.05678902799999467*kSq[5]-0.03975231959999626*kSq[4]+0.01333333333333333*kSq[3]-0.4444444444444444*epsilon[0]*rdx2Sq[1]-0.03849001794597505*kSq[1]-0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[3], (-0.1967229636168847*kSq[7])+0.2271561119999787*kSq[5]-0.07950463919999252*kSq[4]+1.777777777777778*epsilon[0]*rdx2Sq[1]+0.3079201435678004*kSq[1]-(1.066666666666667*bcVals[0]*epsilon[0]*rdx2Sq[0])/bcVals[1]+0.5333333333333333*epsilon[0]*rdx2Sq[0]-0.3555555555555556*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[4], 0.1135780559999893*kSq[5]+0.07950463919999252*kSq[4]+0.8888888888888888*epsilon[0]*rdx2Sq[1]-0.5333333333333333*epsilon[0]*rdx2Sq[0]-0.1777777777777778*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[5], 0.0295084445425327*kSq[7]-0.03442651863295482*kSq[6]-0.063887656499994*kSq[5]-0.05962847939999439*kSq[4]+0.05333333333333333*kSq[3]-0.03849001794597505*kSq[2]-0.8888888888888888*epsilon[0]*rdx2Sq[1]-(0.1333333333333333*bcVals[0]*epsilon[0]*rdx2Sq[0])/bcVals[1]+0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[6], (-0.03442651863295482*kSq[7])+0.03442651863295482*kSq[6]+0.09938079899999068*kSq[5]+0.09938079899999068*kSq[4]+0.02666666666666666*kSq[3]-0.0769800358919501*kSq[2]+0.0769800358919501*kSq[1]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[7], 0.01721325931647741*kSq[7]-0.05678902799999467*kSq[5]-0.03975231959999626*kSq[4]-0.01333333333333333*kSq[3]-0.4444444444444444*epsilon[0]*rdx2Sq[1]-0.03849001794597505*kSq[1]-0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[4], globalIdxs[0], (-0.01721325931647741*kSq[7])-0.05678902799999467*kSq[5]-0.03975231959999626*kSq[4]-0.01333333333333333*kSq[3]-0.4444444444444444*epsilon[0]*rdx2Sq[1]+0.03849001794597505*kSq[1]-0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[4], globalIdxs[1], 0.03442651863295482*kSq[7]-0.03442651863295482*kSq[6]+0.09938079899999068*kSq[5]+0.09938079899999068*kSq[4]+0.02666666666666666*kSq[3]+0.0769800358919501*kSq[2]-0.0769800358919501*kSq[1]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[4], globalIdxs[2], (-0.0295084445425327*kSq[7])+0.03442651863295482*kSq[6]-0.063887656499994*kSq[5]-0.05962847939999439*kSq[4]+0.05333333333333333*kSq[3]+0.03849001794597505*kSq[2]-0.8888888888888888*epsilon[0]*rdx2Sq[1]+0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[4], globalIdxs[3], 0.1135780559999893*kSq[5]+0.07950463919999252*kSq[4]+0.8888888888888888*epsilon[0]*rdx2Sq[1]-0.5333333333333333*epsilon[0]*rdx2Sq[0]-0.1777777777777778*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[4], globalIdxs[4], 0.1967229636168847*kSq[7]+0.2271561119999787*kSq[5]-0.07950463919999252*kSq[4]+1.777777777777778*epsilon[0]*rdx2Sq[1]-0.3079201435678004*kSq[1]+0.5333333333333333*epsilon[0]*rdx2Sq[0]-0.3555555555555556*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[4], globalIdxs[5], (-0.01721325931647741*kSq[7])-0.05678902799999467*kSq[5]-0.03975231959999626*kSq[4]+0.01333333333333333*kSq[3]-0.4444444444444444*epsilon[0]*rdx2Sq[1]+0.03849001794597505*kSq[1]-0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[4], globalIdxs[6], 0.03442651863295482*kSq[7]+0.03442651863295482*kSq[6]+0.09938079899999068*kSq[5]+0.09938079899999068*kSq[4]-0.02666666666666666*kSq[3]-0.0769800358919501*kSq[2]-0.0769800358919501*kSq[1]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[4], globalIdxs[7], (-0.0295084445425327*kSq[7])-0.03442651863295482*kSq[6]-0.063887656499994*kSq[5]-0.05962847939999439*kSq[4]-0.05333333333333333*kSq[3]-0.03849001794597505*kSq[2]-0.8888888888888888*epsilon[0]*rdx2Sq[1]+0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[5], globalIdxs[0], (-0.006147592613027645*kSq[7])+0.02697478829999747*kSq[5]+0.03336355394999686*kSq[4]+0.3111111111111111*epsilon[0]*rdx2Sq[1]-0.01924500897298752*kSq[1]+(0.06666666666666667*bcVals[0]*epsilon[0]*rdx2Sq[0])/bcVals[1]+0.1888888888888889*epsilon[0]*rdx2Sq[0]-0.02222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[5], globalIdxs[1], 0.01721325931647741*kSq[6]-0.03975231959999626*kSq[5]-0.05678902799999467*kSq[4]+0.01333333333333333*kSq[3]-0.03849001794597505*kSq[2]-0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.4444444444444444*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[5], globalIdxs[2], 0.0234254740499978*kSq[5]+0.0234254740499978*kSq[4]-0.01333333333333333*kSq[3]+0.2555555555555555*epsilon[0]*rdx2Sq[1]+0.2555555555555555*epsilon[0]*rdx2Sq[0]-0.03333333333333333*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[5], globalIdxs[3], 0.0295084445425327*kSq[7]-0.03442651863295482*kSq[6]-0.063887656499994*kSq[5]-0.05962847939999439*kSq[4]+0.05333333333333333*kSq[3]-0.03849001794597505*kSq[2]-0.8888888888888888*epsilon[0]*rdx2Sq[1]-(0.1333333333333333*bcVals[0]*epsilon[0]*rdx2Sq[0])/bcVals[1]+0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[5], globalIdxs[4], (-0.01721325931647741*kSq[7])-0.05678902799999467*kSq[5]-0.03975231959999626*kSq[4]+0.01333333333333333*kSq[3]-0.4444444444444444*epsilon[0]*rdx2Sq[1]+0.03849001794597505*kSq[1]-0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[5], globalIdxs[5], 0.04549218533640458*kSq[7]-0.04549218533640458*kSq[6]-0.0127775312999988*kSq[5]-0.0127775312999988*kSq[4]+0.04666666666666667*kSq[3]-0.03849001794597505*kSq[2]+0.5777777777777777*epsilon[0]*rdx2Sq[1]+0.03849001794597505*kSq[1]-(0.2666666666666667*bcVals[0]*epsilon[0]*rdx2Sq[0])/bcVals[1]+0.5777777777777777*epsilon[0]*rdx2Sq[0]-0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[5], globalIdxs[6], 0.03442651863295482*kSq[7]-0.0295084445425327*kSq[6]-0.05962847939999439*kSq[5]-0.063887656499994*kSq[4]+0.05333333333333333*kSq[3]+0.06666666666666667*epsilon[0]*rdx2Sq[1]+0.03849001794597505*kSq[1]-0.8888888888888888*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[5], globalIdxs[7], 0.006147592613027645*kSq[6]+0.03336355394999686*kSq[5]+0.02697478829999747*kSq[4]+0.01924500897298752*kSq[2]+0.1888888888888889*epsilon[0]*rdx2Sq[1]+0.3111111111111111*epsilon[0]*rdx2Sq[0]-0.02222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[6], globalIdxs[0], (-0.01721325931647741*kSq[6])-0.03975231959999626*kSq[5]-0.05678902799999467*kSq[4]-0.01333333333333333*kSq[3]+0.03849001794597505*kSq[2]-0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.4444444444444444*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[6], globalIdxs[1], 0.07950463919999252*kSq[5]+0.1135780559999893*kSq[4]-0.5333333333333333*epsilon[0]*rdx2Sq[1]+0.8888888888888888*epsilon[0]*rdx2Sq[0]-0.1777777777777778*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[6], globalIdxs[2], (-0.01721325931647741*kSq[6])-0.03975231959999626*kSq[5]-0.05678902799999467*kSq[4]+0.01333333333333333*kSq[3]+0.03849001794597505*kSq[2]-0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.4444444444444444*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[6], globalIdxs[3], (-0.03442651863295482*kSq[7])+0.03442651863295482*kSq[6]+0.09938079899999068*kSq[5]+0.09938079899999068*kSq[4]+0.02666666666666666*kSq[3]-0.0769800358919501*kSq[2]+0.0769800358919501*kSq[1]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[6], globalIdxs[4], 0.03442651863295482*kSq[7]+0.03442651863295482*kSq[6]+0.09938079899999068*kSq[5]+0.09938079899999068*kSq[4]-0.02666666666666666*kSq[3]-0.0769800358919501*kSq[2]-0.0769800358919501*kSq[1]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[6], globalIdxs[5], 0.03442651863295482*kSq[7]-0.0295084445425327*kSq[6]-0.05962847939999439*kSq[5]-0.063887656499994*kSq[4]+0.05333333333333333*kSq[3]+0.06666666666666667*epsilon[0]*rdx2Sq[1]+0.03849001794597505*kSq[1]-0.8888888888888888*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[6], globalIdxs[6], 0.1967229636168847*kSq[6]-0.07950463919999252*kSq[5]+0.2271561119999787*kSq[4]-0.3079201435678004*kSq[2]+0.5333333333333333*epsilon[0]*rdx2Sq[1]+1.777777777777778*epsilon[0]*rdx2Sq[0]-0.3555555555555556*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[6], globalIdxs[7], (-0.03442651863295482*kSq[7])-0.0295084445425327*kSq[6]-0.05962847939999439*kSq[5]-0.063887656499994*kSq[4]-0.05333333333333333*kSq[3]+0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.03849001794597505*kSq[1]-0.8888888888888888*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[7], globalIdxs[0], 0.0234254740499978*kSq[5]+0.0234254740499978*kSq[4]+0.01333333333333333*kSq[3]+0.2555555555555555*epsilon[0]*rdx2Sq[1]+0.2555555555555555*epsilon[0]*rdx2Sq[0]-0.03333333333333333*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[7], globalIdxs[1], 0.01721325931647741*kSq[6]-0.03975231959999626*kSq[5]-0.05678902799999467*kSq[4]-0.01333333333333333*kSq[3]-0.03849001794597505*kSq[2]-0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.4444444444444444*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[7], globalIdxs[2], 0.006147592613027645*kSq[7]+0.02697478829999747*kSq[5]+0.03336355394999686*kSq[4]+0.3111111111111111*epsilon[0]*rdx2Sq[1]+0.01924500897298752*kSq[1]+0.1888888888888889*epsilon[0]*rdx2Sq[0]-0.02222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[7], globalIdxs[3], 0.01721325931647741*kSq[7]-0.05678902799999467*kSq[5]-0.03975231959999626*kSq[4]-0.01333333333333333*kSq[3]-0.4444444444444444*epsilon[0]*rdx2Sq[1]-0.03849001794597505*kSq[1]-0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[7], globalIdxs[4], (-0.0295084445425327*kSq[7])-0.03442651863295482*kSq[6]-0.063887656499994*kSq[5]-0.05962847939999439*kSq[4]-0.05333333333333333*kSq[3]-0.03849001794597505*kSq[2]-0.8888888888888888*epsilon[0]*rdx2Sq[1]+0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[7], globalIdxs[5], 0.006147592613027645*kSq[6]+0.03336355394999686*kSq[5]+0.02697478829999747*kSq[4]+0.01924500897298752*kSq[2]+0.1888888888888889*epsilon[0]*rdx2Sq[1]+0.3111111111111111*epsilon[0]*rdx2Sq[0]-0.02222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[7], globalIdxs[6], (-0.03442651863295482*kSq[7])-0.0295084445425327*kSq[6]-0.05962847939999439*kSq[5]-0.063887656499994*kSq[4]-0.05333333333333333*kSq[3]+0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.03849001794597505*kSq[1]-0.8888888888888888*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[7], globalIdxs[7], (-0.04549218533640458*kSq[7])-0.04549218533640458*kSq[6]-0.0127775312999988*kSq[5]-0.0127775312999988*kSq[4]-0.04666666666666667*kSq[3]-0.03849001794597505*kSq[2]+0.5777777777777777*epsilon[0]*rdx2Sq[1]-0.03849001794597505*kSq[1]+0.5777777777777777*epsilon[0]*rdx2Sq[0]-0.06666666666666667*kSq[0]);

}
void fem_poisson_lhs_stencil_consteps_2x_ser_p1_lox_robinx_loy_neumanny(const double *epsilon, const double *kSq, const double *dx, const double *bcVals, const long *globalIdxs, gkyl_mat_triples *tri) 
{ 
  // epsilon: permittivity.
  // kSq: wave number squared (factor multiplying phi).
  // dx: cell length in each direction.
  // bcVals[3]: values to impose as BCs, i.e. bcVals[0]*phi+bcVals[1]*d(phi)/dx=bcVals[2].
  // globalIdxs: global linear index of each basis function/node in current cell.
  // tri: triples object (i,j,val), i.e. contribute val to i,j element of the global matrix.

  double rdx2Sq[2];
  rdx2Sq[0] = 4.0/(dx[0]*dx[0]);
  rdx2Sq[1] = 4.0/(dx[1]*dx[1]);

  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[0], (-0.1666666666666667*kSq[3])+0.1924500897298752*kSq[2]+0.3333333333333333*epsilon[0]*rdx2Sq[1]+0.1924500897298752*kSq[1]-(0.6666666666666666*bcVals[0]*epsilon[0]*rdx2Sq[0])/bcVals[1]+0.3333333333333333*epsilon[0]*rdx2Sq[0]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[1], 0.09622504486493762*kSq[2]+0.1666666666666667*epsilon[0]*rdx2Sq[1]-0.3333333333333333*epsilon[0]*rdx2Sq[0]-0.1111111111111111*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[2], (-0.3333333333333333*epsilon[0]*rdx2Sq[1])+0.09622504486493762*kSq[1]-(0.3333333333333333*bcVals[0]*epsilon[0]*rdx2Sq[0])/bcVals[1]+0.1666666666666667*epsilon[0]*rdx2Sq[0]-0.1111111111111111*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[3], (-0.1666666666666667*epsilon[0]*rdx2Sq[1])-0.1666666666666667*epsilon[0]*rdx2Sq[0]-0.05555555555555555*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[0], 0.09622504486493762*kSq[2]+0.1666666666666667*epsilon[0]*rdx2Sq[1]-0.3333333333333333*epsilon[0]*rdx2Sq[0]-0.1111111111111111*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[1], 0.1666666666666667*kSq[3]+0.1924500897298752*kSq[2]+0.3333333333333333*epsilon[0]*rdx2Sq[1]-0.1924500897298752*kSq[1]+0.3333333333333333*epsilon[0]*rdx2Sq[0]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[2], (-0.1666666666666667*epsilon[0]*rdx2Sq[1])-0.1666666666666667*epsilon[0]*rdx2Sq[0]-0.05555555555555555*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[3], (-0.3333333333333333*epsilon[0]*rdx2Sq[1])-0.09622504486493762*kSq[1]+0.1666666666666667*epsilon[0]*rdx2Sq[0]-0.1111111111111111*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[0], (-0.3333333333333333*epsilon[0]*rdx2Sq[1])+0.09622504486493762*kSq[1]-(0.3333333333333333*bcVals[0]*epsilon[0]*rdx2Sq[0])/bcVals[1]+0.1666666666666667*epsilon[0]*rdx2Sq[0]-0.1111111111111111*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[1], (-0.1666666666666667*epsilon[0]*rdx2Sq[1])-0.1666666666666667*epsilon[0]*rdx2Sq[0]-0.05555555555555555*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[2], 0.1666666666666667*kSq[3]-0.1924500897298752*kSq[2]+0.3333333333333333*epsilon[0]*rdx2Sq[1]+0.1924500897298752*kSq[1]-(0.6666666666666666*bcVals[0]*epsilon[0]*rdx2Sq[0])/bcVals[1]+0.3333333333333333*epsilon[0]*rdx2Sq[0]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[3], (-0.09622504486493762*kSq[2])+0.1666666666666667*epsilon[0]*rdx2Sq[1]-0.3333333333333333*epsilon[0]*rdx2Sq[0]-0.1111111111111111*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[0], (-0.1666666666666667*epsilon[0]*rdx2Sq[1])-0.1666666666666667*epsilon[0]*rdx2Sq[0]-0.05555555555555555*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[1], (-0.3333333333333333*epsilon[0]*rdx2Sq[1])-0.09622504486493762*kSq[1]+0.1666666666666667*epsilon[0]*rdx2Sq[0]-0.1111111111111111*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[2], (-0.09622504486493762*kSq[2])+0.1666666666666667*epsilon[0]*rdx2Sq[1]-0.3333333333333333*epsilon[0]*rdx2Sq[0]-0.1111111111111111*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[3], (-0.1666666666666667*kSq[3])-0.1924500897298752*kSq[2]+0.3333333333333333*epsilon[0]*rdx2Sq[1]-0.1924500897298752*kSq[1]+0.3333333333333333*epsilon[0]*rdx2Sq[0]-0.2222222222222222*kSq[0]);

}
void fem_poisson_lhs_stencil_consteps_2x_ser_p2_lox_robinx_loy_neumanny(const double *epsilon, const double *kSq, const double *dx, const double *bcVals, const long *globalIdxs, gkyl_mat_triples *tri) 
{ 
  // epsilon: permittivity.
  // kSq: wave number squared (factor multiplying phi).
  // dx: cell length in each direction.
  // bcVals[3]: values to impose as BCs, i.e. bcVals[0]*phi+bcVals[1]*d(phi)/dx=bcVals[2].
  // globalIdxs: global linear index of each basis function/node in current cell.
  // tri: triples object (i,j,val), i.e. contribute val to i,j element of the global matrix.

  double rdx2Sq[2];
  rdx2Sq[0] = 4.0/(dx[0]*dx[0]);
  rdx2Sq[1] = 4.0/(dx[1]*dx[1]);

  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[0], 0.04549218533640458*kSq[7]+0.04549218533640458*kSq[6]-0.0127775312999988*kSq[5]-0.0127775312999988*kSq[4]-0.04666666666666667*kSq[3]+0.03849001794597505*kSq[2]+0.5777777777777777*epsilon[0]*rdx2Sq[1]+0.03849001794597505*kSq[1]-(0.2666666666666667*bcVals[0]*epsilon[0]*rdx2Sq[0])/bcVals[1]+0.5777777777777777*epsilon[0]*rdx2Sq[0]-0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[1], 0.03442651863295482*kSq[7]+0.0295084445425327*kSq[6]-0.05962847939999439*kSq[5]-0.063887656499994*kSq[4]-0.05333333333333333*kSq[3]+0.06666666666666667*epsilon[0]*rdx2Sq[1]+0.03849001794597505*kSq[1]-0.8888888888888888*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[2], (-0.006147592613027645*kSq[6])+0.03336355394999686*kSq[5]+0.02697478829999747*kSq[4]-0.01924500897298752*kSq[2]+0.1888888888888889*epsilon[0]*rdx2Sq[1]+0.3111111111111111*epsilon[0]*rdx2Sq[0]-0.02222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[3], 0.0295084445425327*kSq[7]+0.03442651863295482*kSq[6]-0.063887656499994*kSq[5]-0.05962847939999439*kSq[4]-0.05333333333333333*kSq[3]+0.03849001794597505*kSq[2]-0.8888888888888888*epsilon[0]*rdx2Sq[1]-(0.1333333333333333*bcVals[0]*epsilon[0]*rdx2Sq[0])/bcVals[1]+0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[4], (-0.01721325931647741*kSq[7])-0.05678902799999467*kSq[5]-0.03975231959999626*kSq[4]-0.01333333333333333*kSq[3]-0.4444444444444444*epsilon[0]*rdx2Sq[1]+0.03849001794597505*kSq[1]-0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[5], (-0.006147592613027645*kSq[7])+0.02697478829999747*kSq[5]+0.03336355394999686*kSq[4]+0.3111111111111111*epsilon[0]*rdx2Sq[1]-0.01924500897298752*kSq[1]+(0.06666666666666667*bcVals[0]*epsilon[0]*rdx2Sq[0])/bcVals[1]+0.1888888888888889*epsilon[0]*rdx2Sq[0]-0.02222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[6], (-0.01721325931647741*kSq[6])-0.03975231959999626*kSq[5]-0.05678902799999467*kSq[4]-0.01333333333333333*kSq[3]+0.03849001794597505*kSq[2]-0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.4444444444444444*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[7], 0.0234254740499978*kSq[5]+0.0234254740499978*kSq[4]+0.01333333333333333*kSq[3]+0.2555555555555555*epsilon[0]*rdx2Sq[1]+0.2555555555555555*epsilon[0]*rdx2Sq[0]-0.03333333333333333*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[0], 0.03442651863295482*kSq[7]+0.0295084445425327*kSq[6]-0.05962847939999439*kSq[5]-0.063887656499994*kSq[4]-0.05333333333333333*kSq[3]+0.06666666666666667*epsilon[0]*rdx2Sq[1]+0.03849001794597505*kSq[1]-0.8888888888888888*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[1], (-0.1967229636168847*kSq[6])-0.07950463919999252*kSq[5]+0.2271561119999787*kSq[4]+0.3079201435678004*kSq[2]+0.5333333333333333*epsilon[0]*rdx2Sq[1]+1.777777777777778*epsilon[0]*rdx2Sq[0]-0.3555555555555556*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[2], (-0.03442651863295482*kSq[7])+0.0295084445425327*kSq[6]-0.05962847939999439*kSq[5]-0.063887656499994*kSq[4]+0.05333333333333333*kSq[3]+0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.03849001794597505*kSq[1]-0.8888888888888888*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[3], (-0.03442651863295482*kSq[7])-0.03442651863295482*kSq[6]+0.09938079899999068*kSq[5]+0.09938079899999068*kSq[4]-0.02666666666666666*kSq[3]+0.0769800358919501*kSq[2]+0.0769800358919501*kSq[1]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[4], 0.03442651863295482*kSq[7]-0.03442651863295482*kSq[6]+0.09938079899999068*kSq[5]+0.09938079899999068*kSq[4]+0.02666666666666666*kSq[3]+0.0769800358919501*kSq[2]-0.0769800358919501*kSq[1]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[5], 0.01721325931647741*kSq[6]-0.03975231959999626*kSq[5]-0.05678902799999467*kSq[4]+0.01333333333333333*kSq[3]-0.03849001794597505*kSq[2]-0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.4444444444444444*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[6], 0.07950463919999252*kSq[5]+0.1135780559999893*kSq[4]-0.5333333333333333*epsilon[0]*rdx2Sq[1]+0.8888888888888888*epsilon[0]*rdx2Sq[0]-0.1777777777777778*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[7], 0.01721325931647741*kSq[6]-0.03975231959999626*kSq[5]-0.05678902799999467*kSq[4]-0.01333333333333333*kSq[3]-0.03849001794597505*kSq[2]-0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.4444444444444444*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[0], (-0.006147592613027645*kSq[6])+0.03336355394999686*kSq[5]+0.02697478829999747*kSq[4]-0.01924500897298752*kSq[2]+0.1888888888888889*epsilon[0]*rdx2Sq[1]+0.3111111111111111*epsilon[0]*rdx2Sq[0]-0.02222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[1], (-0.03442651863295482*kSq[7])+0.0295084445425327*kSq[6]-0.05962847939999439*kSq[5]-0.063887656499994*kSq[4]+0.05333333333333333*kSq[3]+0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.03849001794597505*kSq[1]-0.8888888888888888*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[2], (-0.04549218533640458*kSq[7])+0.04549218533640458*kSq[6]-0.0127775312999988*kSq[5]-0.0127775312999988*kSq[4]+0.04666666666666667*kSq[3]+0.03849001794597505*kSq[2]+0.5777777777777777*epsilon[0]*rdx2Sq[1]-0.03849001794597505*kSq[1]+0.5777777777777777*epsilon[0]*rdx2Sq[0]-0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[3], 0.01721325931647741*kSq[7]-0.05678902799999467*kSq[5]-0.03975231959999626*kSq[4]+0.01333333333333333*kSq[3]-0.4444444444444444*epsilon[0]*rdx2Sq[1]-0.03849001794597505*kSq[1]-0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[4], (-0.0295084445425327*kSq[7])+0.03442651863295482*kSq[6]-0.063887656499994*kSq[5]-0.05962847939999439*kSq[4]+0.05333333333333333*kSq[3]+0.03849001794597505*kSq[2]-0.8888888888888888*epsilon[0]*rdx2Sq[1]+0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[5], 0.0234254740499978*kSq[5]+0.0234254740499978*kSq[4]-0.01333333333333333*kSq[3]+0.2555555555555555*epsilon[0]*rdx2Sq[1]+0.2555555555555555*epsilon[0]*rdx2Sq[0]-0.03333333333333333*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[6], (-0.01721325931647741*kSq[6])-0.03975231959999626*kSq[5]-0.05678902799999467*kSq[4]+0.01333333333333333*kSq[3]+0.03849001794597505*kSq[2]-0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.4444444444444444*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[7], 0.006147592613027645*kSq[7]+0.02697478829999747*kSq[5]+0.03336355394999686*kSq[4]+0.3111111111111111*epsilon[0]*rdx2Sq[1]+0.01924500897298752*kSq[1]+0.1888888888888889*epsilon[0]*rdx2Sq[0]-0.02222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[0], 0.0295084445425327*kSq[7]+0.03442651863295482*kSq[6]-0.063887656499994*kSq[5]-0.05962847939999439*kSq[4]-0.05333333333333333*kSq[3]+0.03849001794597505*kSq[2]-0.8888888888888888*epsilon[0]*rdx2Sq[1]-(0.1333333333333333*bcVals[0]*epsilon[0]*rdx2Sq[0])/bcVals[1]+0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[1], (-0.03442651863295482*kSq[7])-0.03442651863295482*kSq[6]+0.09938079899999068*kSq[5]+0.09938079899999068*kSq[4]-0.02666666666666666*kSq[3]+0.0769800358919501*kSq[2]+0.0769800358919501*kSq[1]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[2], 0.01721325931647741*kSq[7]-0.05678902799999467*kSq[5]-0.03975231959999626*kSq[4]+0.01333333333333333*kSq[3]-0.4444444444444444*epsilon[0]*rdx2Sq[1]-0.03849001794597505*kSq[1]-0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[3], (-0.1967229636168847*kSq[7])+0.2271561119999787*kSq[5]-0.07950463919999252*kSq[4]+1.777777777777778*epsilon[0]*rdx2Sq[1]+0.3079201435678004*kSq[1]-(1.066666666666667*bcVals[0]*epsilon[0]*rdx2Sq[0])/bcVals[1]+0.5333333333333333*epsilon[0]*rdx2Sq[0]-0.3555555555555556*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[4], 0.1135780559999893*kSq[5]+0.07950463919999252*kSq[4]+0.8888888888888888*epsilon[0]*rdx2Sq[1]-0.5333333333333333*epsilon[0]*rdx2Sq[0]-0.1777777777777778*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[5], 0.0295084445425327*kSq[7]-0.03442651863295482*kSq[6]-0.063887656499994*kSq[5]-0.05962847939999439*kSq[4]+0.05333333333333333*kSq[3]-0.03849001794597505*kSq[2]-0.8888888888888888*epsilon[0]*rdx2Sq[1]-(0.1333333333333333*bcVals[0]*epsilon[0]*rdx2Sq[0])/bcVals[1]+0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[6], (-0.03442651863295482*kSq[7])+0.03442651863295482*kSq[6]+0.09938079899999068*kSq[5]+0.09938079899999068*kSq[4]+0.02666666666666666*kSq[3]-0.0769800358919501*kSq[2]+0.0769800358919501*kSq[1]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[7], 0.01721325931647741*kSq[7]-0.05678902799999467*kSq[5]-0.03975231959999626*kSq[4]-0.01333333333333333*kSq[3]-0.4444444444444444*epsilon[0]*rdx2Sq[1]-0.03849001794597505*kSq[1]-0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[4], globalIdxs[0], (-0.01721325931647741*kSq[7])-0.05678902799999467*kSq[5]-0.03975231959999626*kSq[4]-0.01333333333333333*kSq[3]-0.4444444444444444*epsilon[0]*rdx2Sq[1]+0.03849001794597505*kSq[1]-0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[4], globalIdxs[1], 0.03442651863295482*kSq[7]-0.03442651863295482*kSq[6]+0.09938079899999068*kSq[5]+0.09938079899999068*kSq[4]+0.02666666666666666*kSq[3]+0.0769800358919501*kSq[2]-0.0769800358919501*kSq[1]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[4], globalIdxs[2], (-0.0295084445425327*kSq[7])+0.03442651863295482*kSq[6]-0.063887656499994*kSq[5]-0.05962847939999439*kSq[4]+0.05333333333333333*kSq[3]+0.03849001794597505*kSq[2]-0.8888888888888888*epsilon[0]*rdx2Sq[1]+0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[4], globalIdxs[3], 0.1135780559999893*kSq[5]+0.07950463919999252*kSq[4]+0.8888888888888888*epsilon[0]*rdx2Sq[1]-0.5333333333333333*epsilon[0]*rdx2Sq[0]-0.1777777777777778*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[4], globalIdxs[4], 0.1967229636168847*kSq[7]+0.2271561119999787*kSq[5]-0.07950463919999252*kSq[4]+1.777777777777778*epsilon[0]*rdx2Sq[1]-0.3079201435678004*kSq[1]+0.5333333333333333*epsilon[0]*rdx2Sq[0]-0.3555555555555556*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[4], globalIdxs[5], (-0.01721325931647741*kSq[7])-0.05678902799999467*kSq[5]-0.03975231959999626*kSq[4]+0.01333333333333333*kSq[3]-0.4444444444444444*epsilon[0]*rdx2Sq[1]+0.03849001794597505*kSq[1]-0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[4], globalIdxs[6], 0.03442651863295482*kSq[7]+0.03442651863295482*kSq[6]+0.09938079899999068*kSq[5]+0.09938079899999068*kSq[4]-0.02666666666666666*kSq[3]-0.0769800358919501*kSq[2]-0.0769800358919501*kSq[1]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[4], globalIdxs[7], (-0.0295084445425327*kSq[7])-0.03442651863295482*kSq[6]-0.063887656499994*kSq[5]-0.05962847939999439*kSq[4]-0.05333333333333333*kSq[3]-0.03849001794597505*kSq[2]-0.8888888888888888*epsilon[0]*rdx2Sq[1]+0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[5], globalIdxs[0], (-0.006147592613027645*kSq[7])+0.02697478829999747*kSq[5]+0.03336355394999686*kSq[4]+0.3111111111111111*epsilon[0]*rdx2Sq[1]-0.01924500897298752*kSq[1]+(0.06666666666666667*bcVals[0]*epsilon[0]*rdx2Sq[0])/bcVals[1]+0.1888888888888889*epsilon[0]*rdx2Sq[0]-0.02222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[5], globalIdxs[1], 0.01721325931647741*kSq[6]-0.03975231959999626*kSq[5]-0.05678902799999467*kSq[4]+0.01333333333333333*kSq[3]-0.03849001794597505*kSq[2]-0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.4444444444444444*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[5], globalIdxs[2], 0.0234254740499978*kSq[5]+0.0234254740499978*kSq[4]-0.01333333333333333*kSq[3]+0.2555555555555555*epsilon[0]*rdx2Sq[1]+0.2555555555555555*epsilon[0]*rdx2Sq[0]-0.03333333333333333*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[5], globalIdxs[3], 0.0295084445425327*kSq[7]-0.03442651863295482*kSq[6]-0.063887656499994*kSq[5]-0.05962847939999439*kSq[4]+0.05333333333333333*kSq[3]-0.03849001794597505*kSq[2]-0.8888888888888888*epsilon[0]*rdx2Sq[1]-(0.1333333333333333*bcVals[0]*epsilon[0]*rdx2Sq[0])/bcVals[1]+0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[5], globalIdxs[4], (-0.01721325931647741*kSq[7])-0.05678902799999467*kSq[5]-0.03975231959999626*kSq[4]+0.01333333333333333*kSq[3]-0.4444444444444444*epsilon[0]*rdx2Sq[1]+0.03849001794597505*kSq[1]-0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[5], globalIdxs[5], 0.04549218533640458*kSq[7]-0.04549218533640458*kSq[6]-0.0127775312999988*kSq[5]-0.0127775312999988*kSq[4]+0.04666666666666667*kSq[3]-0.03849001794597505*kSq[2]+0.5777777777777777*epsilon[0]*rdx2Sq[1]+0.03849001794597505*kSq[1]-(0.2666666666666667*bcVals[0]*epsilon[0]*rdx2Sq[0])/bcVals[1]+0.5777777777777777*epsilon[0]*rdx2Sq[0]-0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[5], globalIdxs[6], 0.03442651863295482*kSq[7]-0.0295084445425327*kSq[6]-0.05962847939999439*kSq[5]-0.063887656499994*kSq[4]+0.05333333333333333*kSq[3]+0.06666666666666667*epsilon[0]*rdx2Sq[1]+0.03849001794597505*kSq[1]-0.8888888888888888*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[5], globalIdxs[7], 0.006147592613027645*kSq[6]+0.03336355394999686*kSq[5]+0.02697478829999747*kSq[4]+0.01924500897298752*kSq[2]+0.1888888888888889*epsilon[0]*rdx2Sq[1]+0.3111111111111111*epsilon[0]*rdx2Sq[0]-0.02222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[6], globalIdxs[0], (-0.01721325931647741*kSq[6])-0.03975231959999626*kSq[5]-0.05678902799999467*kSq[4]-0.01333333333333333*kSq[3]+0.03849001794597505*kSq[2]-0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.4444444444444444*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[6], globalIdxs[1], 0.07950463919999252*kSq[5]+0.1135780559999893*kSq[4]-0.5333333333333333*epsilon[0]*rdx2Sq[1]+0.8888888888888888*epsilon[0]*rdx2Sq[0]-0.1777777777777778*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[6], globalIdxs[2], (-0.01721325931647741*kSq[6])-0.03975231959999626*kSq[5]-0.05678902799999467*kSq[4]+0.01333333333333333*kSq[3]+0.03849001794597505*kSq[2]-0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.4444444444444444*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[6], globalIdxs[3], (-0.03442651863295482*kSq[7])+0.03442651863295482*kSq[6]+0.09938079899999068*kSq[5]+0.09938079899999068*kSq[4]+0.02666666666666666*kSq[3]-0.0769800358919501*kSq[2]+0.0769800358919501*kSq[1]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[6], globalIdxs[4], 0.03442651863295482*kSq[7]+0.03442651863295482*kSq[6]+0.09938079899999068*kSq[5]+0.09938079899999068*kSq[4]-0.02666666666666666*kSq[3]-0.0769800358919501*kSq[2]-0.0769800358919501*kSq[1]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[6], globalIdxs[5], 0.03442651863295482*kSq[7]-0.0295084445425327*kSq[6]-0.05962847939999439*kSq[5]-0.063887656499994*kSq[4]+0.05333333333333333*kSq[3]+0.06666666666666667*epsilon[0]*rdx2Sq[1]+0.03849001794597505*kSq[1]-0.8888888888888888*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[6], globalIdxs[6], 0.1967229636168847*kSq[6]-0.07950463919999252*kSq[5]+0.2271561119999787*kSq[4]-0.3079201435678004*kSq[2]+0.5333333333333333*epsilon[0]*rdx2Sq[1]+1.777777777777778*epsilon[0]*rdx2Sq[0]-0.3555555555555556*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[6], globalIdxs[7], (-0.03442651863295482*kSq[7])-0.0295084445425327*kSq[6]-0.05962847939999439*kSq[5]-0.063887656499994*kSq[4]-0.05333333333333333*kSq[3]+0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.03849001794597505*kSq[1]-0.8888888888888888*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[7], globalIdxs[0], 0.0234254740499978*kSq[5]+0.0234254740499978*kSq[4]+0.01333333333333333*kSq[3]+0.2555555555555555*epsilon[0]*rdx2Sq[1]+0.2555555555555555*epsilon[0]*rdx2Sq[0]-0.03333333333333333*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[7], globalIdxs[1], 0.01721325931647741*kSq[6]-0.03975231959999626*kSq[5]-0.05678902799999467*kSq[4]-0.01333333333333333*kSq[3]-0.03849001794597505*kSq[2]-0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.4444444444444444*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[7], globalIdxs[2], 0.006147592613027645*kSq[7]+0.02697478829999747*kSq[5]+0.03336355394999686*kSq[4]+0.3111111111111111*epsilon[0]*rdx2Sq[1]+0.01924500897298752*kSq[1]+0.1888888888888889*epsilon[0]*rdx2Sq[0]-0.02222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[7], globalIdxs[3], 0.01721325931647741*kSq[7]-0.05678902799999467*kSq[5]-0.03975231959999626*kSq[4]-0.01333333333333333*kSq[3]-0.4444444444444444*epsilon[0]*rdx2Sq[1]-0.03849001794597505*kSq[1]-0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[7], globalIdxs[4], (-0.0295084445425327*kSq[7])-0.03442651863295482*kSq[6]-0.063887656499994*kSq[5]-0.05962847939999439*kSq[4]-0.05333333333333333*kSq[3]-0.03849001794597505*kSq[2]-0.8888888888888888*epsilon[0]*rdx2Sq[1]+0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[7], globalIdxs[5], 0.006147592613027645*kSq[6]+0.03336355394999686*kSq[5]+0.02697478829999747*kSq[4]+0.01924500897298752*kSq[2]+0.1888888888888889*epsilon[0]*rdx2Sq[1]+0.3111111111111111*epsilon[0]*rdx2Sq[0]-0.02222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[7], globalIdxs[6], (-0.03442651863295482*kSq[7])-0.0295084445425327*kSq[6]-0.05962847939999439*kSq[5]-0.063887656499994*kSq[4]-0.05333333333333333*kSq[3]+0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.03849001794597505*kSq[1]-0.8888888888888888*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[7], globalIdxs[7], (-0.04549218533640458*kSq[7])-0.04549218533640458*kSq[6]-0.0127775312999988*kSq[5]-0.0127775312999988*kSq[4]-0.04666666666666667*kSq[3]-0.03849001794597505*kSq[2]+0.5777777777777777*epsilon[0]*rdx2Sq[1]-0.03849001794597505*kSq[1]+0.5777777777777777*epsilon[0]*rdx2Sq[0]-0.06666666666666667*kSq[0]);

}
void fem_poisson_lhs_stencil_consteps_2x_ser_p1_lox_robinx_loy_robiny(const double *epsilon, const double *kSq, const double *dx, const double *bcVals, const long *globalIdxs, gkyl_mat_triples *tri) 
{ 
  // epsilon: permittivity.
  // kSq: wave number squared (factor multiplying phi).
  // dx: cell length in each direction.
  // bcVals[3]: values to impose as BCs, i.e. bcVals[0]*phi+bcVals[1]*d(phi)/dx=bcVals[2].
  // globalIdxs: global linear index of each basis function/node in current cell.
  // tri: triples object (i,j,val), i.e. contribute val to i,j element of the global matrix.

  double rdx2Sq[2];
  rdx2Sq[0] = 4.0/(dx[0]*dx[0]);
  rdx2Sq[1] = 4.0/(dx[1]*dx[1]);

  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[0], (-(0.6666666666666666*epsilon[0]*rdx2Sq[1]*bcVals[6])/bcVals[7])-0.1666666666666667*kSq[3]+0.1924500897298752*kSq[2]+0.3333333333333333*epsilon[0]*rdx2Sq[1]+0.1924500897298752*kSq[1]-(0.6666666666666666*bcVals[0]*epsilon[0]*rdx2Sq[0])/bcVals[1]+0.3333333333333333*epsilon[0]*rdx2Sq[0]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[1], (-(0.3333333333333333*epsilon[0]*rdx2Sq[1]*bcVals[6])/bcVals[7])+0.09622504486493762*kSq[2]+0.1666666666666667*epsilon[0]*rdx2Sq[1]-0.3333333333333333*epsilon[0]*rdx2Sq[0]-0.1111111111111111*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[2], (-0.3333333333333333*epsilon[0]*rdx2Sq[1])+0.09622504486493762*kSq[1]-(0.3333333333333333*bcVals[0]*epsilon[0]*rdx2Sq[0])/bcVals[1]+0.1666666666666667*epsilon[0]*rdx2Sq[0]-0.1111111111111111*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[3], (-0.1666666666666667*epsilon[0]*rdx2Sq[1])-0.1666666666666667*epsilon[0]*rdx2Sq[0]-0.05555555555555555*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[0], (-(0.3333333333333333*epsilon[0]*rdx2Sq[1]*bcVals[6])/bcVals[7])+0.09622504486493762*kSq[2]+0.1666666666666667*epsilon[0]*rdx2Sq[1]-0.3333333333333333*epsilon[0]*rdx2Sq[0]-0.1111111111111111*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[1], (-(0.6666666666666666*epsilon[0]*rdx2Sq[1]*bcVals[6])/bcVals[7])+0.1666666666666667*kSq[3]+0.1924500897298752*kSq[2]+0.3333333333333333*epsilon[0]*rdx2Sq[1]-0.1924500897298752*kSq[1]+0.3333333333333333*epsilon[0]*rdx2Sq[0]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[2], (-0.1666666666666667*epsilon[0]*rdx2Sq[1])-0.1666666666666667*epsilon[0]*rdx2Sq[0]-0.05555555555555555*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[3], (-0.3333333333333333*epsilon[0]*rdx2Sq[1])-0.09622504486493762*kSq[1]+0.1666666666666667*epsilon[0]*rdx2Sq[0]-0.1111111111111111*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[0], (-0.3333333333333333*epsilon[0]*rdx2Sq[1])+0.09622504486493762*kSq[1]-(0.3333333333333333*bcVals[0]*epsilon[0]*rdx2Sq[0])/bcVals[1]+0.1666666666666667*epsilon[0]*rdx2Sq[0]-0.1111111111111111*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[1], (-0.1666666666666667*epsilon[0]*rdx2Sq[1])-0.1666666666666667*epsilon[0]*rdx2Sq[0]-0.05555555555555555*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[2], 0.1666666666666667*kSq[3]-0.1924500897298752*kSq[2]+0.3333333333333333*epsilon[0]*rdx2Sq[1]+0.1924500897298752*kSq[1]-(0.6666666666666666*bcVals[0]*epsilon[0]*rdx2Sq[0])/bcVals[1]+0.3333333333333333*epsilon[0]*rdx2Sq[0]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[3], (-0.09622504486493762*kSq[2])+0.1666666666666667*epsilon[0]*rdx2Sq[1]-0.3333333333333333*epsilon[0]*rdx2Sq[0]-0.1111111111111111*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[0], (-0.1666666666666667*epsilon[0]*rdx2Sq[1])-0.1666666666666667*epsilon[0]*rdx2Sq[0]-0.05555555555555555*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[1], (-0.3333333333333333*epsilon[0]*rdx2Sq[1])-0.09622504486493762*kSq[1]+0.1666666666666667*epsilon[0]*rdx2Sq[0]-0.1111111111111111*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[2], (-0.09622504486493762*kSq[2])+0.1666666666666667*epsilon[0]*rdx2Sq[1]-0.3333333333333333*epsilon[0]*rdx2Sq[0]-0.1111111111111111*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[3], (-0.1666666666666667*kSq[3])-0.1924500897298752*kSq[2]+0.3333333333333333*epsilon[0]*rdx2Sq[1]-0.1924500897298752*kSq[1]+0.3333333333333333*epsilon[0]*rdx2Sq[0]-0.2222222222222222*kSq[0]);

}
void fem_poisson_lhs_stencil_consteps_2x_ser_p2_lox_robinx_loy_robiny(const double *epsilon, const double *kSq, const double *dx, const double *bcVals, const long *globalIdxs, gkyl_mat_triples *tri) 
{ 
  // epsilon: permittivity.
  // kSq: wave number squared (factor multiplying phi).
  // dx: cell length in each direction.
  // bcVals[3]: values to impose as BCs, i.e. bcVals[0]*phi+bcVals[1]*d(phi)/dx=bcVals[2].
  // globalIdxs: global linear index of each basis function/node in current cell.
  // tri: triples object (i,j,val), i.e. contribute val to i,j element of the global matrix.

  double rdx2Sq[2];
  rdx2Sq[0] = 4.0/(dx[0]*dx[0]);
  rdx2Sq[1] = 4.0/(dx[1]*dx[1]);

  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[0], 0.04549218533640458*kSq[7]-(0.2666666666666667*epsilon[0]*rdx2Sq[1]*bcVals[6])/bcVals[7]+0.04549218533640458*kSq[6]-0.0127775312999988*kSq[5]-0.0127775312999988*kSq[4]-0.04666666666666667*kSq[3]+0.03849001794597505*kSq[2]+0.5777777777777777*epsilon[0]*rdx2Sq[1]+0.03849001794597505*kSq[1]-(0.2666666666666667*bcVals[0]*epsilon[0]*rdx2Sq[0])/bcVals[1]+0.5777777777777777*epsilon[0]*rdx2Sq[0]-0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[1], 0.03442651863295482*kSq[7]-(0.1333333333333333*epsilon[0]*rdx2Sq[1]*bcVals[6])/bcVals[7]+0.0295084445425327*kSq[6]-0.05962847939999439*kSq[5]-0.063887656499994*kSq[4]-0.05333333333333333*kSq[3]+0.06666666666666667*epsilon[0]*rdx2Sq[1]+0.03849001794597505*kSq[1]-0.8888888888888888*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[2], (0.06666666666666667*epsilon[0]*rdx2Sq[1]*bcVals[6])/bcVals[7]-0.006147592613027645*kSq[6]+0.03336355394999686*kSq[5]+0.02697478829999747*kSq[4]-0.01924500897298752*kSq[2]+0.1888888888888889*epsilon[0]*rdx2Sq[1]+0.3111111111111111*epsilon[0]*rdx2Sq[0]-0.02222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[3], 0.0295084445425327*kSq[7]+0.03442651863295482*kSq[6]-0.063887656499994*kSq[5]-0.05962847939999439*kSq[4]-0.05333333333333333*kSq[3]+0.03849001794597505*kSq[2]-0.8888888888888888*epsilon[0]*rdx2Sq[1]-(0.1333333333333333*bcVals[0]*epsilon[0]*rdx2Sq[0])/bcVals[1]+0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[4], (-0.01721325931647741*kSq[7])-0.05678902799999467*kSq[5]-0.03975231959999626*kSq[4]-0.01333333333333333*kSq[3]-0.4444444444444444*epsilon[0]*rdx2Sq[1]+0.03849001794597505*kSq[1]-0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[5], (-0.006147592613027645*kSq[7])+0.02697478829999747*kSq[5]+0.03336355394999686*kSq[4]+0.3111111111111111*epsilon[0]*rdx2Sq[1]-0.01924500897298752*kSq[1]+(0.06666666666666667*bcVals[0]*epsilon[0]*rdx2Sq[0])/bcVals[1]+0.1888888888888889*epsilon[0]*rdx2Sq[0]-0.02222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[6], (-0.01721325931647741*kSq[6])-0.03975231959999626*kSq[5]-0.05678902799999467*kSq[4]-0.01333333333333333*kSq[3]+0.03849001794597505*kSq[2]-0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.4444444444444444*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[7], 0.0234254740499978*kSq[5]+0.0234254740499978*kSq[4]+0.01333333333333333*kSq[3]+0.2555555555555555*epsilon[0]*rdx2Sq[1]+0.2555555555555555*epsilon[0]*rdx2Sq[0]-0.03333333333333333*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[0], 0.03442651863295482*kSq[7]-(0.1333333333333333*epsilon[0]*rdx2Sq[1]*bcVals[6])/bcVals[7]+0.0295084445425327*kSq[6]-0.05962847939999439*kSq[5]-0.063887656499994*kSq[4]-0.05333333333333333*kSq[3]+0.06666666666666667*epsilon[0]*rdx2Sq[1]+0.03849001794597505*kSq[1]-0.8888888888888888*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[1], (-(1.066666666666667*epsilon[0]*rdx2Sq[1]*bcVals[6])/bcVals[7])-0.1967229636168847*kSq[6]-0.07950463919999252*kSq[5]+0.2271561119999787*kSq[4]+0.3079201435678004*kSq[2]+0.5333333333333333*epsilon[0]*rdx2Sq[1]+1.777777777777778*epsilon[0]*rdx2Sq[0]-0.3555555555555556*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[2], (-0.03442651863295482*kSq[7])-(0.1333333333333333*epsilon[0]*rdx2Sq[1]*bcVals[6])/bcVals[7]+0.0295084445425327*kSq[6]-0.05962847939999439*kSq[5]-0.063887656499994*kSq[4]+0.05333333333333333*kSq[3]+0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.03849001794597505*kSq[1]-0.8888888888888888*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[3], (-0.03442651863295482*kSq[7])-0.03442651863295482*kSq[6]+0.09938079899999068*kSq[5]+0.09938079899999068*kSq[4]-0.02666666666666666*kSq[3]+0.0769800358919501*kSq[2]+0.0769800358919501*kSq[1]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[4], 0.03442651863295482*kSq[7]-0.03442651863295482*kSq[6]+0.09938079899999068*kSq[5]+0.09938079899999068*kSq[4]+0.02666666666666666*kSq[3]+0.0769800358919501*kSq[2]-0.0769800358919501*kSq[1]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[5], 0.01721325931647741*kSq[6]-0.03975231959999626*kSq[5]-0.05678902799999467*kSq[4]+0.01333333333333333*kSq[3]-0.03849001794597505*kSq[2]-0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.4444444444444444*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[6], 0.07950463919999252*kSq[5]+0.1135780559999893*kSq[4]-0.5333333333333333*epsilon[0]*rdx2Sq[1]+0.8888888888888888*epsilon[0]*rdx2Sq[0]-0.1777777777777778*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[7], 0.01721325931647741*kSq[6]-0.03975231959999626*kSq[5]-0.05678902799999467*kSq[4]-0.01333333333333333*kSq[3]-0.03849001794597505*kSq[2]-0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.4444444444444444*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[0], (0.06666666666666667*epsilon[0]*rdx2Sq[1]*bcVals[6])/bcVals[7]-0.006147592613027645*kSq[6]+0.03336355394999686*kSq[5]+0.02697478829999747*kSq[4]-0.01924500897298752*kSq[2]+0.1888888888888889*epsilon[0]*rdx2Sq[1]+0.3111111111111111*epsilon[0]*rdx2Sq[0]-0.02222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[1], (-0.03442651863295482*kSq[7])-(0.1333333333333333*epsilon[0]*rdx2Sq[1]*bcVals[6])/bcVals[7]+0.0295084445425327*kSq[6]-0.05962847939999439*kSq[5]-0.063887656499994*kSq[4]+0.05333333333333333*kSq[3]+0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.03849001794597505*kSq[1]-0.8888888888888888*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[2], (-0.04549218533640458*kSq[7])-(0.2666666666666667*epsilon[0]*rdx2Sq[1]*bcVals[6])/bcVals[7]+0.04549218533640458*kSq[6]-0.0127775312999988*kSq[5]-0.0127775312999988*kSq[4]+0.04666666666666667*kSq[3]+0.03849001794597505*kSq[2]+0.5777777777777777*epsilon[0]*rdx2Sq[1]-0.03849001794597505*kSq[1]+0.5777777777777777*epsilon[0]*rdx2Sq[0]-0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[3], 0.01721325931647741*kSq[7]-0.05678902799999467*kSq[5]-0.03975231959999626*kSq[4]+0.01333333333333333*kSq[3]-0.4444444444444444*epsilon[0]*rdx2Sq[1]-0.03849001794597505*kSq[1]-0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[4], (-0.0295084445425327*kSq[7])+0.03442651863295482*kSq[6]-0.063887656499994*kSq[5]-0.05962847939999439*kSq[4]+0.05333333333333333*kSq[3]+0.03849001794597505*kSq[2]-0.8888888888888888*epsilon[0]*rdx2Sq[1]+0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[5], 0.0234254740499978*kSq[5]+0.0234254740499978*kSq[4]-0.01333333333333333*kSq[3]+0.2555555555555555*epsilon[0]*rdx2Sq[1]+0.2555555555555555*epsilon[0]*rdx2Sq[0]-0.03333333333333333*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[6], (-0.01721325931647741*kSq[6])-0.03975231959999626*kSq[5]-0.05678902799999467*kSq[4]+0.01333333333333333*kSq[3]+0.03849001794597505*kSq[2]-0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.4444444444444444*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[7], 0.006147592613027645*kSq[7]+0.02697478829999747*kSq[5]+0.03336355394999686*kSq[4]+0.3111111111111111*epsilon[0]*rdx2Sq[1]+0.01924500897298752*kSq[1]+0.1888888888888889*epsilon[0]*rdx2Sq[0]-0.02222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[0], 0.0295084445425327*kSq[7]+0.03442651863295482*kSq[6]-0.063887656499994*kSq[5]-0.05962847939999439*kSq[4]-0.05333333333333333*kSq[3]+0.03849001794597505*kSq[2]-0.8888888888888888*epsilon[0]*rdx2Sq[1]-(0.1333333333333333*bcVals[0]*epsilon[0]*rdx2Sq[0])/bcVals[1]+0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[1], (-0.03442651863295482*kSq[7])-0.03442651863295482*kSq[6]+0.09938079899999068*kSq[5]+0.09938079899999068*kSq[4]-0.02666666666666666*kSq[3]+0.0769800358919501*kSq[2]+0.0769800358919501*kSq[1]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[2], 0.01721325931647741*kSq[7]-0.05678902799999467*kSq[5]-0.03975231959999626*kSq[4]+0.01333333333333333*kSq[3]-0.4444444444444444*epsilon[0]*rdx2Sq[1]-0.03849001794597505*kSq[1]-0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[3], (-0.1967229636168847*kSq[7])+0.2271561119999787*kSq[5]-0.07950463919999252*kSq[4]+1.777777777777778*epsilon[0]*rdx2Sq[1]+0.3079201435678004*kSq[1]-(1.066666666666667*bcVals[0]*epsilon[0]*rdx2Sq[0])/bcVals[1]+0.5333333333333333*epsilon[0]*rdx2Sq[0]-0.3555555555555556*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[4], 0.1135780559999893*kSq[5]+0.07950463919999252*kSq[4]+0.8888888888888888*epsilon[0]*rdx2Sq[1]-0.5333333333333333*epsilon[0]*rdx2Sq[0]-0.1777777777777778*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[5], 0.0295084445425327*kSq[7]-0.03442651863295482*kSq[6]-0.063887656499994*kSq[5]-0.05962847939999439*kSq[4]+0.05333333333333333*kSq[3]-0.03849001794597505*kSq[2]-0.8888888888888888*epsilon[0]*rdx2Sq[1]-(0.1333333333333333*bcVals[0]*epsilon[0]*rdx2Sq[0])/bcVals[1]+0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[6], (-0.03442651863295482*kSq[7])+0.03442651863295482*kSq[6]+0.09938079899999068*kSq[5]+0.09938079899999068*kSq[4]+0.02666666666666666*kSq[3]-0.0769800358919501*kSq[2]+0.0769800358919501*kSq[1]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[7], 0.01721325931647741*kSq[7]-0.05678902799999467*kSq[5]-0.03975231959999626*kSq[4]-0.01333333333333333*kSq[3]-0.4444444444444444*epsilon[0]*rdx2Sq[1]-0.03849001794597505*kSq[1]-0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[4], globalIdxs[0], (-0.01721325931647741*kSq[7])-0.05678902799999467*kSq[5]-0.03975231959999626*kSq[4]-0.01333333333333333*kSq[3]-0.4444444444444444*epsilon[0]*rdx2Sq[1]+0.03849001794597505*kSq[1]-0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[4], globalIdxs[1], 0.03442651863295482*kSq[7]-0.03442651863295482*kSq[6]+0.09938079899999068*kSq[5]+0.09938079899999068*kSq[4]+0.02666666666666666*kSq[3]+0.0769800358919501*kSq[2]-0.0769800358919501*kSq[1]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[4], globalIdxs[2], (-0.0295084445425327*kSq[7])+0.03442651863295482*kSq[6]-0.063887656499994*kSq[5]-0.05962847939999439*kSq[4]+0.05333333333333333*kSq[3]+0.03849001794597505*kSq[2]-0.8888888888888888*epsilon[0]*rdx2Sq[1]+0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[4], globalIdxs[3], 0.1135780559999893*kSq[5]+0.07950463919999252*kSq[4]+0.8888888888888888*epsilon[0]*rdx2Sq[1]-0.5333333333333333*epsilon[0]*rdx2Sq[0]-0.1777777777777778*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[4], globalIdxs[4], 0.1967229636168847*kSq[7]+0.2271561119999787*kSq[5]-0.07950463919999252*kSq[4]+1.777777777777778*epsilon[0]*rdx2Sq[1]-0.3079201435678004*kSq[1]+0.5333333333333333*epsilon[0]*rdx2Sq[0]-0.3555555555555556*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[4], globalIdxs[5], (-0.01721325931647741*kSq[7])-0.05678902799999467*kSq[5]-0.03975231959999626*kSq[4]+0.01333333333333333*kSq[3]-0.4444444444444444*epsilon[0]*rdx2Sq[1]+0.03849001794597505*kSq[1]-0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[4], globalIdxs[6], 0.03442651863295482*kSq[7]+0.03442651863295482*kSq[6]+0.09938079899999068*kSq[5]+0.09938079899999068*kSq[4]-0.02666666666666666*kSq[3]-0.0769800358919501*kSq[2]-0.0769800358919501*kSq[1]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[4], globalIdxs[7], (-0.0295084445425327*kSq[7])-0.03442651863295482*kSq[6]-0.063887656499994*kSq[5]-0.05962847939999439*kSq[4]-0.05333333333333333*kSq[3]-0.03849001794597505*kSq[2]-0.8888888888888888*epsilon[0]*rdx2Sq[1]+0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[5], globalIdxs[0], (-0.006147592613027645*kSq[7])+0.02697478829999747*kSq[5]+0.03336355394999686*kSq[4]+0.3111111111111111*epsilon[0]*rdx2Sq[1]-0.01924500897298752*kSq[1]+(0.06666666666666667*bcVals[0]*epsilon[0]*rdx2Sq[0])/bcVals[1]+0.1888888888888889*epsilon[0]*rdx2Sq[0]-0.02222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[5], globalIdxs[1], 0.01721325931647741*kSq[6]-0.03975231959999626*kSq[5]-0.05678902799999467*kSq[4]+0.01333333333333333*kSq[3]-0.03849001794597505*kSq[2]-0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.4444444444444444*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[5], globalIdxs[2], 0.0234254740499978*kSq[5]+0.0234254740499978*kSq[4]-0.01333333333333333*kSq[3]+0.2555555555555555*epsilon[0]*rdx2Sq[1]+0.2555555555555555*epsilon[0]*rdx2Sq[0]-0.03333333333333333*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[5], globalIdxs[3], 0.0295084445425327*kSq[7]-0.03442651863295482*kSq[6]-0.063887656499994*kSq[5]-0.05962847939999439*kSq[4]+0.05333333333333333*kSq[3]-0.03849001794597505*kSq[2]-0.8888888888888888*epsilon[0]*rdx2Sq[1]-(0.1333333333333333*bcVals[0]*epsilon[0]*rdx2Sq[0])/bcVals[1]+0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[5], globalIdxs[4], (-0.01721325931647741*kSq[7])-0.05678902799999467*kSq[5]-0.03975231959999626*kSq[4]+0.01333333333333333*kSq[3]-0.4444444444444444*epsilon[0]*rdx2Sq[1]+0.03849001794597505*kSq[1]-0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[5], globalIdxs[5], 0.04549218533640458*kSq[7]-0.04549218533640458*kSq[6]-0.0127775312999988*kSq[5]-0.0127775312999988*kSq[4]+0.04666666666666667*kSq[3]-0.03849001794597505*kSq[2]+0.5777777777777777*epsilon[0]*rdx2Sq[1]+0.03849001794597505*kSq[1]-(0.2666666666666667*bcVals[0]*epsilon[0]*rdx2Sq[0])/bcVals[1]+0.5777777777777777*epsilon[0]*rdx2Sq[0]-0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[5], globalIdxs[6], 0.03442651863295482*kSq[7]-0.0295084445425327*kSq[6]-0.05962847939999439*kSq[5]-0.063887656499994*kSq[4]+0.05333333333333333*kSq[3]+0.06666666666666667*epsilon[0]*rdx2Sq[1]+0.03849001794597505*kSq[1]-0.8888888888888888*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[5], globalIdxs[7], 0.006147592613027645*kSq[6]+0.03336355394999686*kSq[5]+0.02697478829999747*kSq[4]+0.01924500897298752*kSq[2]+0.1888888888888889*epsilon[0]*rdx2Sq[1]+0.3111111111111111*epsilon[0]*rdx2Sq[0]-0.02222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[6], globalIdxs[0], (-0.01721325931647741*kSq[6])-0.03975231959999626*kSq[5]-0.05678902799999467*kSq[4]-0.01333333333333333*kSq[3]+0.03849001794597505*kSq[2]-0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.4444444444444444*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[6], globalIdxs[1], 0.07950463919999252*kSq[5]+0.1135780559999893*kSq[4]-0.5333333333333333*epsilon[0]*rdx2Sq[1]+0.8888888888888888*epsilon[0]*rdx2Sq[0]-0.1777777777777778*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[6], globalIdxs[2], (-0.01721325931647741*kSq[6])-0.03975231959999626*kSq[5]-0.05678902799999467*kSq[4]+0.01333333333333333*kSq[3]+0.03849001794597505*kSq[2]-0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.4444444444444444*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[6], globalIdxs[3], (-0.03442651863295482*kSq[7])+0.03442651863295482*kSq[6]+0.09938079899999068*kSq[5]+0.09938079899999068*kSq[4]+0.02666666666666666*kSq[3]-0.0769800358919501*kSq[2]+0.0769800358919501*kSq[1]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[6], globalIdxs[4], 0.03442651863295482*kSq[7]+0.03442651863295482*kSq[6]+0.09938079899999068*kSq[5]+0.09938079899999068*kSq[4]-0.02666666666666666*kSq[3]-0.0769800358919501*kSq[2]-0.0769800358919501*kSq[1]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[6], globalIdxs[5], 0.03442651863295482*kSq[7]-0.0295084445425327*kSq[6]-0.05962847939999439*kSq[5]-0.063887656499994*kSq[4]+0.05333333333333333*kSq[3]+0.06666666666666667*epsilon[0]*rdx2Sq[1]+0.03849001794597505*kSq[1]-0.8888888888888888*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[6], globalIdxs[6], 0.1967229636168847*kSq[6]-0.07950463919999252*kSq[5]+0.2271561119999787*kSq[4]-0.3079201435678004*kSq[2]+0.5333333333333333*epsilon[0]*rdx2Sq[1]+1.777777777777778*epsilon[0]*rdx2Sq[0]-0.3555555555555556*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[6], globalIdxs[7], (-0.03442651863295482*kSq[7])-0.0295084445425327*kSq[6]-0.05962847939999439*kSq[5]-0.063887656499994*kSq[4]-0.05333333333333333*kSq[3]+0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.03849001794597505*kSq[1]-0.8888888888888888*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[7], globalIdxs[0], 0.0234254740499978*kSq[5]+0.0234254740499978*kSq[4]+0.01333333333333333*kSq[3]+0.2555555555555555*epsilon[0]*rdx2Sq[1]+0.2555555555555555*epsilon[0]*rdx2Sq[0]-0.03333333333333333*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[7], globalIdxs[1], 0.01721325931647741*kSq[6]-0.03975231959999626*kSq[5]-0.05678902799999467*kSq[4]-0.01333333333333333*kSq[3]-0.03849001794597505*kSq[2]-0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.4444444444444444*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[7], globalIdxs[2], 0.006147592613027645*kSq[7]+0.02697478829999747*kSq[5]+0.03336355394999686*kSq[4]+0.3111111111111111*epsilon[0]*rdx2Sq[1]+0.01924500897298752*kSq[1]+0.1888888888888889*epsilon[0]*rdx2Sq[0]-0.02222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[7], globalIdxs[3], 0.01721325931647741*kSq[7]-0.05678902799999467*kSq[5]-0.03975231959999626*kSq[4]-0.01333333333333333*kSq[3]-0.4444444444444444*epsilon[0]*rdx2Sq[1]-0.03849001794597505*kSq[1]-0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[7], globalIdxs[4], (-0.0295084445425327*kSq[7])-0.03442651863295482*kSq[6]-0.063887656499994*kSq[5]-0.05962847939999439*kSq[4]-0.05333333333333333*kSq[3]-0.03849001794597505*kSq[2]-0.8888888888888888*epsilon[0]*rdx2Sq[1]+0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[7], globalIdxs[5], 0.006147592613027645*kSq[6]+0.03336355394999686*kSq[5]+0.02697478829999747*kSq[4]+0.01924500897298752*kSq[2]+0.1888888888888889*epsilon[0]*rdx2Sq[1]+0.3111111111111111*epsilon[0]*rdx2Sq[0]-0.02222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[7], globalIdxs[6], (-0.03442651863295482*kSq[7])-0.0295084445425327*kSq[6]-0.05962847939999439*kSq[5]-0.063887656499994*kSq[4]-0.05333333333333333*kSq[3]+0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.03849001794597505*kSq[1]-0.8888888888888888*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[7], globalIdxs[7], (-0.04549218533640458*kSq[7])-0.04549218533640458*kSq[6]-0.0127775312999988*kSq[5]-0.0127775312999988*kSq[4]-0.04666666666666667*kSq[3]-0.03849001794597505*kSq[2]+0.5777777777777777*epsilon[0]*rdx2Sq[1]-0.03849001794597505*kSq[1]+0.5777777777777777*epsilon[0]*rdx2Sq[0]-0.06666666666666667*kSq[0]);

}
void fem_poisson_lhs_stencil_consteps_2x_ser_p1_lox_periodicx_upy_periodicy(const double *epsilon, const double *kSq, const double *dx, const double *bcVals, const long *globalIdxs, gkyl_mat_triples *tri) 
{ 
  // epsilon: permittivity.
  // kSq: wave number squared (factor multiplying phi).
  // dx: cell length in each direction.
  // bcVals[3]: values to impose as BCs, i.e. bcVals[0]*phi+bcVals[1]*d(phi)/dx=bcVals[2].
  // globalIdxs: global linear index of each basis function/node in current cell.
  // tri: triples object (i,j,val), i.e. contribute val to i,j element of the global matrix.

  double rdx2Sq[2];
  rdx2Sq[0] = 4.0/(dx[0]*dx[0]);
  rdx2Sq[1] = 4.0/(dx[1]*dx[1]);

  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[0], (-0.1666666666666667*kSq[3])+0.1924500897298752*kSq[2]+0.3333333333333333*epsilon[0]*rdx2Sq[1]+0.1924500897298752*kSq[1]+0.3333333333333333*epsilon[0]*rdx2Sq[0]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[1], 0.09622504486493762*kSq[2]+0.1666666666666667*epsilon[0]*rdx2Sq[1]-0.3333333333333333*epsilon[0]*rdx2Sq[0]-0.1111111111111111*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[2], (-0.3333333333333333*epsilon[0]*rdx2Sq[1])+0.09622504486493762*kSq[1]+0.1666666666666667*epsilon[0]*rdx2Sq[0]-0.1111111111111111*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[3], (-0.1666666666666667*epsilon[0]*rdx2Sq[1])-0.1666666666666667*epsilon[0]*rdx2Sq[0]-0.05555555555555555*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[0], 0.09622504486493762*kSq[2]+0.1666666666666667*epsilon[0]*rdx2Sq[1]-0.3333333333333333*epsilon[0]*rdx2Sq[0]-0.1111111111111111*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[1], 0.1666666666666667*kSq[3]+0.1924500897298752*kSq[2]+0.3333333333333333*epsilon[0]*rdx2Sq[1]-0.1924500897298752*kSq[1]+0.3333333333333333*epsilon[0]*rdx2Sq[0]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[2], (-0.1666666666666667*epsilon[0]*rdx2Sq[1])-0.1666666666666667*epsilon[0]*rdx2Sq[0]-0.05555555555555555*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[3], (-0.3333333333333333*epsilon[0]*rdx2Sq[1])-0.09622504486493762*kSq[1]+0.1666666666666667*epsilon[0]*rdx2Sq[0]-0.1111111111111111*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[0], (-0.3333333333333333*epsilon[0]*rdx2Sq[1])+0.09622504486493762*kSq[1]+0.1666666666666667*epsilon[0]*rdx2Sq[0]-0.1111111111111111*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[1], (-0.1666666666666667*epsilon[0]*rdx2Sq[1])-0.1666666666666667*epsilon[0]*rdx2Sq[0]-0.05555555555555555*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[2], 0.1666666666666667*kSq[3]-0.1924500897298752*kSq[2]+0.3333333333333333*epsilon[0]*rdx2Sq[1]+0.1924500897298752*kSq[1]+0.3333333333333333*epsilon[0]*rdx2Sq[0]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[3], (-0.09622504486493762*kSq[2])+0.1666666666666667*epsilon[0]*rdx2Sq[1]-0.3333333333333333*epsilon[0]*rdx2Sq[0]-0.1111111111111111*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[0], (-0.1666666666666667*epsilon[0]*rdx2Sq[1])-0.1666666666666667*epsilon[0]*rdx2Sq[0]-0.05555555555555555*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[1], (-0.3333333333333333*epsilon[0]*rdx2Sq[1])-0.09622504486493762*kSq[1]+0.1666666666666667*epsilon[0]*rdx2Sq[0]-0.1111111111111111*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[2], (-0.09622504486493762*kSq[2])+0.1666666666666667*epsilon[0]*rdx2Sq[1]-0.3333333333333333*epsilon[0]*rdx2Sq[0]-0.1111111111111111*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[3], (-0.1666666666666667*kSq[3])-0.1924500897298752*kSq[2]+0.3333333333333333*epsilon[0]*rdx2Sq[1]-0.1924500897298752*kSq[1]+0.3333333333333333*epsilon[0]*rdx2Sq[0]-0.2222222222222222*kSq[0]);

}
void fem_poisson_lhs_stencil_consteps_2x_ser_p2_lox_periodicx_upy_periodicy(const double *epsilon, const double *kSq, const double *dx, const double *bcVals, const long *globalIdxs, gkyl_mat_triples *tri) 
{ 
  // epsilon: permittivity.
  // kSq: wave number squared (factor multiplying phi).
  // dx: cell length in each direction.
  // bcVals[3]: values to impose as BCs, i.e. bcVals[0]*phi+bcVals[1]*d(phi)/dx=bcVals[2].
  // globalIdxs: global linear index of each basis function/node in current cell.
  // tri: triples object (i,j,val), i.e. contribute val to i,j element of the global matrix.

  double rdx2Sq[2];
  rdx2Sq[0] = 4.0/(dx[0]*dx[0]);
  rdx2Sq[1] = 4.0/(dx[1]*dx[1]);

  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[0], 0.04549218533640458*kSq[7]+0.04549218533640458*kSq[6]-0.0127775312999988*kSq[5]-0.0127775312999988*kSq[4]-0.04666666666666667*kSq[3]+0.03849001794597505*kSq[2]+0.5777777777777777*epsilon[0]*rdx2Sq[1]+0.03849001794597505*kSq[1]+0.5777777777777777*epsilon[0]*rdx2Sq[0]-0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[1], 0.03442651863295482*kSq[7]+0.0295084445425327*kSq[6]-0.05962847939999439*kSq[5]-0.063887656499994*kSq[4]-0.05333333333333333*kSq[3]+0.06666666666666667*epsilon[0]*rdx2Sq[1]+0.03849001794597505*kSq[1]-0.8888888888888888*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[2], (-0.006147592613027645*kSq[6])+0.03336355394999686*kSq[5]+0.02697478829999747*kSq[4]-0.01924500897298752*kSq[2]+0.1888888888888889*epsilon[0]*rdx2Sq[1]+0.3111111111111111*epsilon[0]*rdx2Sq[0]-0.02222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[3], 0.0295084445425327*kSq[7]+0.03442651863295482*kSq[6]-0.063887656499994*kSq[5]-0.05962847939999439*kSq[4]-0.05333333333333333*kSq[3]+0.03849001794597505*kSq[2]-0.8888888888888888*epsilon[0]*rdx2Sq[1]+0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[4], (-0.01721325931647741*kSq[7])-0.05678902799999467*kSq[5]-0.03975231959999626*kSq[4]-0.01333333333333333*kSq[3]-0.4444444444444444*epsilon[0]*rdx2Sq[1]+0.03849001794597505*kSq[1]-0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[5], (-0.006147592613027645*kSq[7])+0.02697478829999747*kSq[5]+0.03336355394999686*kSq[4]+0.3111111111111111*epsilon[0]*rdx2Sq[1]-0.01924500897298752*kSq[1]+0.1888888888888889*epsilon[0]*rdx2Sq[0]-0.02222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[6], (-0.01721325931647741*kSq[6])-0.03975231959999626*kSq[5]-0.05678902799999467*kSq[4]-0.01333333333333333*kSq[3]+0.03849001794597505*kSq[2]-0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.4444444444444444*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[7], 0.0234254740499978*kSq[5]+0.0234254740499978*kSq[4]+0.01333333333333333*kSq[3]+0.2555555555555555*epsilon[0]*rdx2Sq[1]+0.2555555555555555*epsilon[0]*rdx2Sq[0]-0.03333333333333333*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[0], 0.03442651863295482*kSq[7]+0.0295084445425327*kSq[6]-0.05962847939999439*kSq[5]-0.063887656499994*kSq[4]-0.05333333333333333*kSq[3]+0.06666666666666667*epsilon[0]*rdx2Sq[1]+0.03849001794597505*kSq[1]-0.8888888888888888*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[1], (-0.1967229636168847*kSq[6])-0.07950463919999252*kSq[5]+0.2271561119999787*kSq[4]+0.3079201435678004*kSq[2]+0.5333333333333333*epsilon[0]*rdx2Sq[1]+1.777777777777778*epsilon[0]*rdx2Sq[0]-0.3555555555555556*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[2], (-0.03442651863295482*kSq[7])+0.0295084445425327*kSq[6]-0.05962847939999439*kSq[5]-0.063887656499994*kSq[4]+0.05333333333333333*kSq[3]+0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.03849001794597505*kSq[1]-0.8888888888888888*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[3], (-0.03442651863295482*kSq[7])-0.03442651863295482*kSq[6]+0.09938079899999068*kSq[5]+0.09938079899999068*kSq[4]-0.02666666666666666*kSq[3]+0.0769800358919501*kSq[2]+0.0769800358919501*kSq[1]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[4], 0.03442651863295482*kSq[7]-0.03442651863295482*kSq[6]+0.09938079899999068*kSq[5]+0.09938079899999068*kSq[4]+0.02666666666666666*kSq[3]+0.0769800358919501*kSq[2]-0.0769800358919501*kSq[1]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[5], 0.01721325931647741*kSq[6]-0.03975231959999626*kSq[5]-0.05678902799999467*kSq[4]+0.01333333333333333*kSq[3]-0.03849001794597505*kSq[2]-0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.4444444444444444*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[6], 0.07950463919999252*kSq[5]+0.1135780559999893*kSq[4]-0.5333333333333333*epsilon[0]*rdx2Sq[1]+0.8888888888888888*epsilon[0]*rdx2Sq[0]-0.1777777777777778*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[7], 0.01721325931647741*kSq[6]-0.03975231959999626*kSq[5]-0.05678902799999467*kSq[4]-0.01333333333333333*kSq[3]-0.03849001794597505*kSq[2]-0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.4444444444444444*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[0], (-0.006147592613027645*kSq[6])+0.03336355394999686*kSq[5]+0.02697478829999747*kSq[4]-0.01924500897298752*kSq[2]+0.1888888888888889*epsilon[0]*rdx2Sq[1]+0.3111111111111111*epsilon[0]*rdx2Sq[0]-0.02222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[1], (-0.03442651863295482*kSq[7])+0.0295084445425327*kSq[6]-0.05962847939999439*kSq[5]-0.063887656499994*kSq[4]+0.05333333333333333*kSq[3]+0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.03849001794597505*kSq[1]-0.8888888888888888*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[2], (-0.04549218533640458*kSq[7])+0.04549218533640458*kSq[6]-0.0127775312999988*kSq[5]-0.0127775312999988*kSq[4]+0.04666666666666667*kSq[3]+0.03849001794597505*kSq[2]+0.5777777777777777*epsilon[0]*rdx2Sq[1]-0.03849001794597505*kSq[1]+0.5777777777777777*epsilon[0]*rdx2Sq[0]-0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[3], 0.01721325931647741*kSq[7]-0.05678902799999467*kSq[5]-0.03975231959999626*kSq[4]+0.01333333333333333*kSq[3]-0.4444444444444444*epsilon[0]*rdx2Sq[1]-0.03849001794597505*kSq[1]-0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[4], (-0.0295084445425327*kSq[7])+0.03442651863295482*kSq[6]-0.063887656499994*kSq[5]-0.05962847939999439*kSq[4]+0.05333333333333333*kSq[3]+0.03849001794597505*kSq[2]-0.8888888888888888*epsilon[0]*rdx2Sq[1]+0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[5], 0.0234254740499978*kSq[5]+0.0234254740499978*kSq[4]-0.01333333333333333*kSq[3]+0.2555555555555555*epsilon[0]*rdx2Sq[1]+0.2555555555555555*epsilon[0]*rdx2Sq[0]-0.03333333333333333*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[6], (-0.01721325931647741*kSq[6])-0.03975231959999626*kSq[5]-0.05678902799999467*kSq[4]+0.01333333333333333*kSq[3]+0.03849001794597505*kSq[2]-0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.4444444444444444*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[7], 0.006147592613027645*kSq[7]+0.02697478829999747*kSq[5]+0.03336355394999686*kSq[4]+0.3111111111111111*epsilon[0]*rdx2Sq[1]+0.01924500897298752*kSq[1]+0.1888888888888889*epsilon[0]*rdx2Sq[0]-0.02222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[0], 0.0295084445425327*kSq[7]+0.03442651863295482*kSq[6]-0.063887656499994*kSq[5]-0.05962847939999439*kSq[4]-0.05333333333333333*kSq[3]+0.03849001794597505*kSq[2]-0.8888888888888888*epsilon[0]*rdx2Sq[1]+0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[1], (-0.03442651863295482*kSq[7])-0.03442651863295482*kSq[6]+0.09938079899999068*kSq[5]+0.09938079899999068*kSq[4]-0.02666666666666666*kSq[3]+0.0769800358919501*kSq[2]+0.0769800358919501*kSq[1]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[2], 0.01721325931647741*kSq[7]-0.05678902799999467*kSq[5]-0.03975231959999626*kSq[4]+0.01333333333333333*kSq[3]-0.4444444444444444*epsilon[0]*rdx2Sq[1]-0.03849001794597505*kSq[1]-0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[3], (-0.1967229636168847*kSq[7])+0.2271561119999787*kSq[5]-0.07950463919999252*kSq[4]+1.777777777777778*epsilon[0]*rdx2Sq[1]+0.3079201435678004*kSq[1]+0.5333333333333333*epsilon[0]*rdx2Sq[0]-0.3555555555555556*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[4], 0.1135780559999893*kSq[5]+0.07950463919999252*kSq[4]+0.8888888888888888*epsilon[0]*rdx2Sq[1]-0.5333333333333333*epsilon[0]*rdx2Sq[0]-0.1777777777777778*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[5], 0.0295084445425327*kSq[7]-0.03442651863295482*kSq[6]-0.063887656499994*kSq[5]-0.05962847939999439*kSq[4]+0.05333333333333333*kSq[3]-0.03849001794597505*kSq[2]-0.8888888888888888*epsilon[0]*rdx2Sq[1]+0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[6], (-0.03442651863295482*kSq[7])+0.03442651863295482*kSq[6]+0.09938079899999068*kSq[5]+0.09938079899999068*kSq[4]+0.02666666666666666*kSq[3]-0.0769800358919501*kSq[2]+0.0769800358919501*kSq[1]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[7], 0.01721325931647741*kSq[7]-0.05678902799999467*kSq[5]-0.03975231959999626*kSq[4]-0.01333333333333333*kSq[3]-0.4444444444444444*epsilon[0]*rdx2Sq[1]-0.03849001794597505*kSq[1]-0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[4], globalIdxs[0], (-0.01721325931647741*kSq[7])-0.05678902799999467*kSq[5]-0.03975231959999626*kSq[4]-0.01333333333333333*kSq[3]-0.4444444444444444*epsilon[0]*rdx2Sq[1]+0.03849001794597505*kSq[1]-0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[4], globalIdxs[1], 0.03442651863295482*kSq[7]-0.03442651863295482*kSq[6]+0.09938079899999068*kSq[5]+0.09938079899999068*kSq[4]+0.02666666666666666*kSq[3]+0.0769800358919501*kSq[2]-0.0769800358919501*kSq[1]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[4], globalIdxs[2], (-0.0295084445425327*kSq[7])+0.03442651863295482*kSq[6]-0.063887656499994*kSq[5]-0.05962847939999439*kSq[4]+0.05333333333333333*kSq[3]+0.03849001794597505*kSq[2]-0.8888888888888888*epsilon[0]*rdx2Sq[1]+0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[4], globalIdxs[3], 0.1135780559999893*kSq[5]+0.07950463919999252*kSq[4]+0.8888888888888888*epsilon[0]*rdx2Sq[1]-0.5333333333333333*epsilon[0]*rdx2Sq[0]-0.1777777777777778*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[4], globalIdxs[4], 0.1967229636168847*kSq[7]+0.2271561119999787*kSq[5]-0.07950463919999252*kSq[4]+1.777777777777778*epsilon[0]*rdx2Sq[1]-0.3079201435678004*kSq[1]+0.5333333333333333*epsilon[0]*rdx2Sq[0]-0.3555555555555556*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[4], globalIdxs[5], (-0.01721325931647741*kSq[7])-0.05678902799999467*kSq[5]-0.03975231959999626*kSq[4]+0.01333333333333333*kSq[3]-0.4444444444444444*epsilon[0]*rdx2Sq[1]+0.03849001794597505*kSq[1]-0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[4], globalIdxs[6], 0.03442651863295482*kSq[7]+0.03442651863295482*kSq[6]+0.09938079899999068*kSq[5]+0.09938079899999068*kSq[4]-0.02666666666666666*kSq[3]-0.0769800358919501*kSq[2]-0.0769800358919501*kSq[1]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[4], globalIdxs[7], (-0.0295084445425327*kSq[7])-0.03442651863295482*kSq[6]-0.063887656499994*kSq[5]-0.05962847939999439*kSq[4]-0.05333333333333333*kSq[3]-0.03849001794597505*kSq[2]-0.8888888888888888*epsilon[0]*rdx2Sq[1]+0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[5], globalIdxs[0], (-0.006147592613027645*kSq[7])+0.02697478829999747*kSq[5]+0.03336355394999686*kSq[4]+0.3111111111111111*epsilon[0]*rdx2Sq[1]-0.01924500897298752*kSq[1]+0.1888888888888889*epsilon[0]*rdx2Sq[0]-0.02222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[5], globalIdxs[1], 0.01721325931647741*kSq[6]-0.03975231959999626*kSq[5]-0.05678902799999467*kSq[4]+0.01333333333333333*kSq[3]-0.03849001794597505*kSq[2]-0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.4444444444444444*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[5], globalIdxs[2], 0.0234254740499978*kSq[5]+0.0234254740499978*kSq[4]-0.01333333333333333*kSq[3]+0.2555555555555555*epsilon[0]*rdx2Sq[1]+0.2555555555555555*epsilon[0]*rdx2Sq[0]-0.03333333333333333*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[5], globalIdxs[3], 0.0295084445425327*kSq[7]-0.03442651863295482*kSq[6]-0.063887656499994*kSq[5]-0.05962847939999439*kSq[4]+0.05333333333333333*kSq[3]-0.03849001794597505*kSq[2]-0.8888888888888888*epsilon[0]*rdx2Sq[1]+0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[5], globalIdxs[4], (-0.01721325931647741*kSq[7])-0.05678902799999467*kSq[5]-0.03975231959999626*kSq[4]+0.01333333333333333*kSq[3]-0.4444444444444444*epsilon[0]*rdx2Sq[1]+0.03849001794597505*kSq[1]-0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[5], globalIdxs[5], 0.04549218533640458*kSq[7]-0.04549218533640458*kSq[6]-0.0127775312999988*kSq[5]-0.0127775312999988*kSq[4]+0.04666666666666667*kSq[3]-0.03849001794597505*kSq[2]+0.5777777777777777*epsilon[0]*rdx2Sq[1]+0.03849001794597505*kSq[1]+0.5777777777777777*epsilon[0]*rdx2Sq[0]-0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[5], globalIdxs[6], 0.03442651863295482*kSq[7]-0.0295084445425327*kSq[6]-0.05962847939999439*kSq[5]-0.063887656499994*kSq[4]+0.05333333333333333*kSq[3]+0.06666666666666667*epsilon[0]*rdx2Sq[1]+0.03849001794597505*kSq[1]-0.8888888888888888*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[5], globalIdxs[7], 0.006147592613027645*kSq[6]+0.03336355394999686*kSq[5]+0.02697478829999747*kSq[4]+0.01924500897298752*kSq[2]+0.1888888888888889*epsilon[0]*rdx2Sq[1]+0.3111111111111111*epsilon[0]*rdx2Sq[0]-0.02222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[6], globalIdxs[0], (-0.01721325931647741*kSq[6])-0.03975231959999626*kSq[5]-0.05678902799999467*kSq[4]-0.01333333333333333*kSq[3]+0.03849001794597505*kSq[2]-0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.4444444444444444*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[6], globalIdxs[1], 0.07950463919999252*kSq[5]+0.1135780559999893*kSq[4]-0.5333333333333333*epsilon[0]*rdx2Sq[1]+0.8888888888888888*epsilon[0]*rdx2Sq[0]-0.1777777777777778*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[6], globalIdxs[2], (-0.01721325931647741*kSq[6])-0.03975231959999626*kSq[5]-0.05678902799999467*kSq[4]+0.01333333333333333*kSq[3]+0.03849001794597505*kSq[2]-0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.4444444444444444*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[6], globalIdxs[3], (-0.03442651863295482*kSq[7])+0.03442651863295482*kSq[6]+0.09938079899999068*kSq[5]+0.09938079899999068*kSq[4]+0.02666666666666666*kSq[3]-0.0769800358919501*kSq[2]+0.0769800358919501*kSq[1]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[6], globalIdxs[4], 0.03442651863295482*kSq[7]+0.03442651863295482*kSq[6]+0.09938079899999068*kSq[5]+0.09938079899999068*kSq[4]-0.02666666666666666*kSq[3]-0.0769800358919501*kSq[2]-0.0769800358919501*kSq[1]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[6], globalIdxs[5], 0.03442651863295482*kSq[7]-0.0295084445425327*kSq[6]-0.05962847939999439*kSq[5]-0.063887656499994*kSq[4]+0.05333333333333333*kSq[3]+0.06666666666666667*epsilon[0]*rdx2Sq[1]+0.03849001794597505*kSq[1]-0.8888888888888888*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[6], globalIdxs[6], 0.1967229636168847*kSq[6]-0.07950463919999252*kSq[5]+0.2271561119999787*kSq[4]-0.3079201435678004*kSq[2]+0.5333333333333333*epsilon[0]*rdx2Sq[1]+1.777777777777778*epsilon[0]*rdx2Sq[0]-0.3555555555555556*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[6], globalIdxs[7], (-0.03442651863295482*kSq[7])-0.0295084445425327*kSq[6]-0.05962847939999439*kSq[5]-0.063887656499994*kSq[4]-0.05333333333333333*kSq[3]+0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.03849001794597505*kSq[1]-0.8888888888888888*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[7], globalIdxs[0], 0.0234254740499978*kSq[5]+0.0234254740499978*kSq[4]+0.01333333333333333*kSq[3]+0.2555555555555555*epsilon[0]*rdx2Sq[1]+0.2555555555555555*epsilon[0]*rdx2Sq[0]-0.03333333333333333*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[7], globalIdxs[1], 0.01721325931647741*kSq[6]-0.03975231959999626*kSq[5]-0.05678902799999467*kSq[4]-0.01333333333333333*kSq[3]-0.03849001794597505*kSq[2]-0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.4444444444444444*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[7], globalIdxs[2], 0.006147592613027645*kSq[7]+0.02697478829999747*kSq[5]+0.03336355394999686*kSq[4]+0.3111111111111111*epsilon[0]*rdx2Sq[1]+0.01924500897298752*kSq[1]+0.1888888888888889*epsilon[0]*rdx2Sq[0]-0.02222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[7], globalIdxs[3], 0.01721325931647741*kSq[7]-0.05678902799999467*kSq[5]-0.03975231959999626*kSq[4]-0.01333333333333333*kSq[3]-0.4444444444444444*epsilon[0]*rdx2Sq[1]-0.03849001794597505*kSq[1]-0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[7], globalIdxs[4], (-0.0295084445425327*kSq[7])-0.03442651863295482*kSq[6]-0.063887656499994*kSq[5]-0.05962847939999439*kSq[4]-0.05333333333333333*kSq[3]-0.03849001794597505*kSq[2]-0.8888888888888888*epsilon[0]*rdx2Sq[1]+0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[7], globalIdxs[5], 0.006147592613027645*kSq[6]+0.03336355394999686*kSq[5]+0.02697478829999747*kSq[4]+0.01924500897298752*kSq[2]+0.1888888888888889*epsilon[0]*rdx2Sq[1]+0.3111111111111111*epsilon[0]*rdx2Sq[0]-0.02222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[7], globalIdxs[6], (-0.03442651863295482*kSq[7])-0.0295084445425327*kSq[6]-0.05962847939999439*kSq[5]-0.063887656499994*kSq[4]-0.05333333333333333*kSq[3]+0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.03849001794597505*kSq[1]-0.8888888888888888*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[7], globalIdxs[7], (-0.04549218533640458*kSq[7])-0.04549218533640458*kSq[6]-0.0127775312999988*kSq[5]-0.0127775312999988*kSq[4]-0.04666666666666667*kSq[3]-0.03849001794597505*kSq[2]+0.5777777777777777*epsilon[0]*rdx2Sq[1]-0.03849001794597505*kSq[1]+0.5777777777777777*epsilon[0]*rdx2Sq[0]-0.06666666666666667*kSq[0]);

}
void fem_poisson_lhs_stencil_consteps_2x_ser_p1_lox_periodicx_upy_dirichlety(const double *epsilon, const double *kSq, const double *dx, const double *bcVals, const long *globalIdxs, gkyl_mat_triples *tri) 
{ 
  // epsilon: permittivity.
  // kSq: wave number squared (factor multiplying phi).
  // dx: cell length in each direction.
  // bcVals[3]: values to impose as BCs, i.e. bcVals[0]*phi+bcVals[1]*d(phi)/dx=bcVals[2].
  // globalIdxs: global linear index of each basis function/node in current cell.
  // tri: triples object (i,j,val), i.e. contribute val to i,j element of the global matrix.

  double rdx2Sq[2];
  rdx2Sq[0] = 4.0/(dx[0]*dx[0]);
  rdx2Sq[1] = 4.0/(dx[1]*dx[1]);

  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[0], (-0.1666666666666667*kSq[3])+0.1924500897298752*kSq[2]+0.3333333333333333*epsilon[0]*rdx2Sq[1]+0.1924500897298752*kSq[1]+0.3333333333333333*epsilon[0]*rdx2Sq[0]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[1], 0.09622504486493762*kSq[2]+0.1666666666666667*epsilon[0]*rdx2Sq[1]-0.3333333333333333*epsilon[0]*rdx2Sq[0]-0.1111111111111111*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[2], (-0.3333333333333333*epsilon[0]*rdx2Sq[1])+0.09622504486493762*kSq[1]+0.1666666666666667*epsilon[0]*rdx2Sq[0]-0.1111111111111111*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[3], (-0.1666666666666667*epsilon[0]*rdx2Sq[1])-0.1666666666666667*epsilon[0]*rdx2Sq[0]-0.05555555555555555*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[0], 0.09622504486493762*kSq[2]+0.1666666666666667*epsilon[0]*rdx2Sq[1]-0.3333333333333333*epsilon[0]*rdx2Sq[0]-0.1111111111111111*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[1], 0.1666666666666667*kSq[3]+0.1924500897298752*kSq[2]+0.3333333333333333*epsilon[0]*rdx2Sq[1]-0.1924500897298752*kSq[1]+0.3333333333333333*epsilon[0]*rdx2Sq[0]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[2], (-0.1666666666666667*epsilon[0]*rdx2Sq[1])-0.1666666666666667*epsilon[0]*rdx2Sq[0]-0.05555555555555555*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[3], (-0.3333333333333333*epsilon[0]*rdx2Sq[1])-0.09622504486493762*kSq[1]+0.1666666666666667*epsilon[0]*rdx2Sq[0]-0.1111111111111111*kSq[0]);
  gkyl_mat_triples_insert(tri, globalIdxs[2], globalIdxs[0], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[2], globalIdxs[1], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[2], globalIdxs[2], 1.0);
  gkyl_mat_triples_insert(tri, globalIdxs[2], globalIdxs[3], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[3], globalIdxs[0], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[3], globalIdxs[1], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[3], globalIdxs[2], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[3], globalIdxs[3], 1.0);

}
void fem_poisson_lhs_stencil_consteps_2x_ser_p2_lox_periodicx_upy_dirichlety(const double *epsilon, const double *kSq, const double *dx, const double *bcVals, const long *globalIdxs, gkyl_mat_triples *tri) 
{ 
  // epsilon: permittivity.
  // kSq: wave number squared (factor multiplying phi).
  // dx: cell length in each direction.
  // bcVals[3]: values to impose as BCs, i.e. bcVals[0]*phi+bcVals[1]*d(phi)/dx=bcVals[2].
  // globalIdxs: global linear index of each basis function/node in current cell.
  // tri: triples object (i,j,val), i.e. contribute val to i,j element of the global matrix.

  double rdx2Sq[2];
  rdx2Sq[0] = 4.0/(dx[0]*dx[0]);
  rdx2Sq[1] = 4.0/(dx[1]*dx[1]);

  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[0], 0.04549218533640458*kSq[7]+0.04549218533640458*kSq[6]-0.0127775312999988*kSq[5]-0.0127775312999988*kSq[4]-0.04666666666666667*kSq[3]+0.03849001794597505*kSq[2]+0.5777777777777777*epsilon[0]*rdx2Sq[1]+0.03849001794597505*kSq[1]+0.5777777777777777*epsilon[0]*rdx2Sq[0]-0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[1], 0.03442651863295482*kSq[7]+0.0295084445425327*kSq[6]-0.05962847939999439*kSq[5]-0.063887656499994*kSq[4]-0.05333333333333333*kSq[3]+0.06666666666666667*epsilon[0]*rdx2Sq[1]+0.03849001794597505*kSq[1]-0.8888888888888888*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[2], (-0.006147592613027645*kSq[6])+0.03336355394999686*kSq[5]+0.02697478829999747*kSq[4]-0.01924500897298752*kSq[2]+0.1888888888888889*epsilon[0]*rdx2Sq[1]+0.3111111111111111*epsilon[0]*rdx2Sq[0]-0.02222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[3], 0.0295084445425327*kSq[7]+0.03442651863295482*kSq[6]-0.063887656499994*kSq[5]-0.05962847939999439*kSq[4]-0.05333333333333333*kSq[3]+0.03849001794597505*kSq[2]-0.8888888888888888*epsilon[0]*rdx2Sq[1]+0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[4], (-0.01721325931647741*kSq[7])-0.05678902799999467*kSq[5]-0.03975231959999626*kSq[4]-0.01333333333333333*kSq[3]-0.4444444444444444*epsilon[0]*rdx2Sq[1]+0.03849001794597505*kSq[1]-0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[5], (-0.006147592613027645*kSq[7])+0.02697478829999747*kSq[5]+0.03336355394999686*kSq[4]+0.3111111111111111*epsilon[0]*rdx2Sq[1]-0.01924500897298752*kSq[1]+0.1888888888888889*epsilon[0]*rdx2Sq[0]-0.02222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[6], (-0.01721325931647741*kSq[6])-0.03975231959999626*kSq[5]-0.05678902799999467*kSq[4]-0.01333333333333333*kSq[3]+0.03849001794597505*kSq[2]-0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.4444444444444444*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[7], 0.0234254740499978*kSq[5]+0.0234254740499978*kSq[4]+0.01333333333333333*kSq[3]+0.2555555555555555*epsilon[0]*rdx2Sq[1]+0.2555555555555555*epsilon[0]*rdx2Sq[0]-0.03333333333333333*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[0], 0.03442651863295482*kSq[7]+0.0295084445425327*kSq[6]-0.05962847939999439*kSq[5]-0.063887656499994*kSq[4]-0.05333333333333333*kSq[3]+0.06666666666666667*epsilon[0]*rdx2Sq[1]+0.03849001794597505*kSq[1]-0.8888888888888888*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[1], (-0.1967229636168847*kSq[6])-0.07950463919999252*kSq[5]+0.2271561119999787*kSq[4]+0.3079201435678004*kSq[2]+0.5333333333333333*epsilon[0]*rdx2Sq[1]+1.777777777777778*epsilon[0]*rdx2Sq[0]-0.3555555555555556*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[2], (-0.03442651863295482*kSq[7])+0.0295084445425327*kSq[6]-0.05962847939999439*kSq[5]-0.063887656499994*kSq[4]+0.05333333333333333*kSq[3]+0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.03849001794597505*kSq[1]-0.8888888888888888*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[3], (-0.03442651863295482*kSq[7])-0.03442651863295482*kSq[6]+0.09938079899999068*kSq[5]+0.09938079899999068*kSq[4]-0.02666666666666666*kSq[3]+0.0769800358919501*kSq[2]+0.0769800358919501*kSq[1]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[4], 0.03442651863295482*kSq[7]-0.03442651863295482*kSq[6]+0.09938079899999068*kSq[5]+0.09938079899999068*kSq[4]+0.02666666666666666*kSq[3]+0.0769800358919501*kSq[2]-0.0769800358919501*kSq[1]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[5], 0.01721325931647741*kSq[6]-0.03975231959999626*kSq[5]-0.05678902799999467*kSq[4]+0.01333333333333333*kSq[3]-0.03849001794597505*kSq[2]-0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.4444444444444444*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[6], 0.07950463919999252*kSq[5]+0.1135780559999893*kSq[4]-0.5333333333333333*epsilon[0]*rdx2Sq[1]+0.8888888888888888*epsilon[0]*rdx2Sq[0]-0.1777777777777778*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[7], 0.01721325931647741*kSq[6]-0.03975231959999626*kSq[5]-0.05678902799999467*kSq[4]-0.01333333333333333*kSq[3]-0.03849001794597505*kSq[2]-0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.4444444444444444*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[0], (-0.006147592613027645*kSq[6])+0.03336355394999686*kSq[5]+0.02697478829999747*kSq[4]-0.01924500897298752*kSq[2]+0.1888888888888889*epsilon[0]*rdx2Sq[1]+0.3111111111111111*epsilon[0]*rdx2Sq[0]-0.02222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[1], (-0.03442651863295482*kSq[7])+0.0295084445425327*kSq[6]-0.05962847939999439*kSq[5]-0.063887656499994*kSq[4]+0.05333333333333333*kSq[3]+0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.03849001794597505*kSq[1]-0.8888888888888888*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[2], (-0.04549218533640458*kSq[7])+0.04549218533640458*kSq[6]-0.0127775312999988*kSq[5]-0.0127775312999988*kSq[4]+0.04666666666666667*kSq[3]+0.03849001794597505*kSq[2]+0.5777777777777777*epsilon[0]*rdx2Sq[1]-0.03849001794597505*kSq[1]+0.5777777777777777*epsilon[0]*rdx2Sq[0]-0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[3], 0.01721325931647741*kSq[7]-0.05678902799999467*kSq[5]-0.03975231959999626*kSq[4]+0.01333333333333333*kSq[3]-0.4444444444444444*epsilon[0]*rdx2Sq[1]-0.03849001794597505*kSq[1]-0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[4], (-0.0295084445425327*kSq[7])+0.03442651863295482*kSq[6]-0.063887656499994*kSq[5]-0.05962847939999439*kSq[4]+0.05333333333333333*kSq[3]+0.03849001794597505*kSq[2]-0.8888888888888888*epsilon[0]*rdx2Sq[1]+0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[5], 0.0234254740499978*kSq[5]+0.0234254740499978*kSq[4]-0.01333333333333333*kSq[3]+0.2555555555555555*epsilon[0]*rdx2Sq[1]+0.2555555555555555*epsilon[0]*rdx2Sq[0]-0.03333333333333333*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[6], (-0.01721325931647741*kSq[6])-0.03975231959999626*kSq[5]-0.05678902799999467*kSq[4]+0.01333333333333333*kSq[3]+0.03849001794597505*kSq[2]-0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.4444444444444444*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[7], 0.006147592613027645*kSq[7]+0.02697478829999747*kSq[5]+0.03336355394999686*kSq[4]+0.3111111111111111*epsilon[0]*rdx2Sq[1]+0.01924500897298752*kSq[1]+0.1888888888888889*epsilon[0]*rdx2Sq[0]-0.02222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[0], 0.0295084445425327*kSq[7]+0.03442651863295482*kSq[6]-0.063887656499994*kSq[5]-0.05962847939999439*kSq[4]-0.05333333333333333*kSq[3]+0.03849001794597505*kSq[2]-0.8888888888888888*epsilon[0]*rdx2Sq[1]+0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[1], (-0.03442651863295482*kSq[7])-0.03442651863295482*kSq[6]+0.09938079899999068*kSq[5]+0.09938079899999068*kSq[4]-0.02666666666666666*kSq[3]+0.0769800358919501*kSq[2]+0.0769800358919501*kSq[1]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[2], 0.01721325931647741*kSq[7]-0.05678902799999467*kSq[5]-0.03975231959999626*kSq[4]+0.01333333333333333*kSq[3]-0.4444444444444444*epsilon[0]*rdx2Sq[1]-0.03849001794597505*kSq[1]-0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[3], (-0.1967229636168847*kSq[7])+0.2271561119999787*kSq[5]-0.07950463919999252*kSq[4]+1.777777777777778*epsilon[0]*rdx2Sq[1]+0.3079201435678004*kSq[1]+0.5333333333333333*epsilon[0]*rdx2Sq[0]-0.3555555555555556*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[4], 0.1135780559999893*kSq[5]+0.07950463919999252*kSq[4]+0.8888888888888888*epsilon[0]*rdx2Sq[1]-0.5333333333333333*epsilon[0]*rdx2Sq[0]-0.1777777777777778*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[5], 0.0295084445425327*kSq[7]-0.03442651863295482*kSq[6]-0.063887656499994*kSq[5]-0.05962847939999439*kSq[4]+0.05333333333333333*kSq[3]-0.03849001794597505*kSq[2]-0.8888888888888888*epsilon[0]*rdx2Sq[1]+0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[6], (-0.03442651863295482*kSq[7])+0.03442651863295482*kSq[6]+0.09938079899999068*kSq[5]+0.09938079899999068*kSq[4]+0.02666666666666666*kSq[3]-0.0769800358919501*kSq[2]+0.0769800358919501*kSq[1]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[7], 0.01721325931647741*kSq[7]-0.05678902799999467*kSq[5]-0.03975231959999626*kSq[4]-0.01333333333333333*kSq[3]-0.4444444444444444*epsilon[0]*rdx2Sq[1]-0.03849001794597505*kSq[1]-0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[4], globalIdxs[0], (-0.01721325931647741*kSq[7])-0.05678902799999467*kSq[5]-0.03975231959999626*kSq[4]-0.01333333333333333*kSq[3]-0.4444444444444444*epsilon[0]*rdx2Sq[1]+0.03849001794597505*kSq[1]-0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[4], globalIdxs[1], 0.03442651863295482*kSq[7]-0.03442651863295482*kSq[6]+0.09938079899999068*kSq[5]+0.09938079899999068*kSq[4]+0.02666666666666666*kSq[3]+0.0769800358919501*kSq[2]-0.0769800358919501*kSq[1]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[4], globalIdxs[2], (-0.0295084445425327*kSq[7])+0.03442651863295482*kSq[6]-0.063887656499994*kSq[5]-0.05962847939999439*kSq[4]+0.05333333333333333*kSq[3]+0.03849001794597505*kSq[2]-0.8888888888888888*epsilon[0]*rdx2Sq[1]+0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[4], globalIdxs[3], 0.1135780559999893*kSq[5]+0.07950463919999252*kSq[4]+0.8888888888888888*epsilon[0]*rdx2Sq[1]-0.5333333333333333*epsilon[0]*rdx2Sq[0]-0.1777777777777778*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[4], globalIdxs[4], 0.1967229636168847*kSq[7]+0.2271561119999787*kSq[5]-0.07950463919999252*kSq[4]+1.777777777777778*epsilon[0]*rdx2Sq[1]-0.3079201435678004*kSq[1]+0.5333333333333333*epsilon[0]*rdx2Sq[0]-0.3555555555555556*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[4], globalIdxs[5], (-0.01721325931647741*kSq[7])-0.05678902799999467*kSq[5]-0.03975231959999626*kSq[4]+0.01333333333333333*kSq[3]-0.4444444444444444*epsilon[0]*rdx2Sq[1]+0.03849001794597505*kSq[1]-0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[4], globalIdxs[6], 0.03442651863295482*kSq[7]+0.03442651863295482*kSq[6]+0.09938079899999068*kSq[5]+0.09938079899999068*kSq[4]-0.02666666666666666*kSq[3]-0.0769800358919501*kSq[2]-0.0769800358919501*kSq[1]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[4], globalIdxs[7], (-0.0295084445425327*kSq[7])-0.03442651863295482*kSq[6]-0.063887656499994*kSq[5]-0.05962847939999439*kSq[4]-0.05333333333333333*kSq[3]-0.03849001794597505*kSq[2]-0.8888888888888888*epsilon[0]*rdx2Sq[1]+0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_insert(tri, globalIdxs[5], globalIdxs[0], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[5], globalIdxs[1], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[5], globalIdxs[2], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[5], globalIdxs[3], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[5], globalIdxs[4], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[5], globalIdxs[5], 1.0);
  gkyl_mat_triples_insert(tri, globalIdxs[5], globalIdxs[6], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[5], globalIdxs[7], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[6], globalIdxs[0], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[6], globalIdxs[1], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[6], globalIdxs[2], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[6], globalIdxs[3], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[6], globalIdxs[4], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[6], globalIdxs[5], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[6], globalIdxs[6], 1.0);
  gkyl_mat_triples_insert(tri, globalIdxs[6], globalIdxs[7], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[7], globalIdxs[0], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[7], globalIdxs[1], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[7], globalIdxs[2], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[7], globalIdxs[3], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[7], globalIdxs[4], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[7], globalIdxs[5], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[7], globalIdxs[6], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[7], globalIdxs[7], 1.0);

}
void fem_poisson_lhs_stencil_consteps_2x_ser_p1_lox_periodicx_upy_neumanny(const double *epsilon, const double *kSq, const double *dx, const double *bcVals, const long *globalIdxs, gkyl_mat_triples *tri) 
{ 
  // epsilon: permittivity.
  // kSq: wave number squared (factor multiplying phi).
  // dx: cell length in each direction.
  // bcVals[3]: values to impose as BCs, i.e. bcVals[0]*phi+bcVals[1]*d(phi)/dx=bcVals[2].
  // globalIdxs: global linear index of each basis function/node in current cell.
  // tri: triples object (i,j,val), i.e. contribute val to i,j element of the global matrix.

  double rdx2Sq[2];
  rdx2Sq[0] = 4.0/(dx[0]*dx[0]);
  rdx2Sq[1] = 4.0/(dx[1]*dx[1]);

  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[0], (-0.1666666666666667*kSq[3])+0.1924500897298752*kSq[2]+0.3333333333333333*epsilon[0]*rdx2Sq[1]+0.1924500897298752*kSq[1]+0.3333333333333333*epsilon[0]*rdx2Sq[0]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[1], 0.09622504486493762*kSq[2]+0.1666666666666667*epsilon[0]*rdx2Sq[1]-0.3333333333333333*epsilon[0]*rdx2Sq[0]-0.1111111111111111*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[2], (-0.3333333333333333*epsilon[0]*rdx2Sq[1])+0.09622504486493762*kSq[1]+0.1666666666666667*epsilon[0]*rdx2Sq[0]-0.1111111111111111*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[3], (-0.1666666666666667*epsilon[0]*rdx2Sq[1])-0.1666666666666667*epsilon[0]*rdx2Sq[0]-0.05555555555555555*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[0], 0.09622504486493762*kSq[2]+0.1666666666666667*epsilon[0]*rdx2Sq[1]-0.3333333333333333*epsilon[0]*rdx2Sq[0]-0.1111111111111111*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[1], 0.1666666666666667*kSq[3]+0.1924500897298752*kSq[2]+0.3333333333333333*epsilon[0]*rdx2Sq[1]-0.1924500897298752*kSq[1]+0.3333333333333333*epsilon[0]*rdx2Sq[0]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[2], (-0.1666666666666667*epsilon[0]*rdx2Sq[1])-0.1666666666666667*epsilon[0]*rdx2Sq[0]-0.05555555555555555*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[3], (-0.3333333333333333*epsilon[0]*rdx2Sq[1])-0.09622504486493762*kSq[1]+0.1666666666666667*epsilon[0]*rdx2Sq[0]-0.1111111111111111*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[0], (-0.3333333333333333*epsilon[0]*rdx2Sq[1])+0.09622504486493762*kSq[1]+0.1666666666666667*epsilon[0]*rdx2Sq[0]-0.1111111111111111*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[1], (-0.1666666666666667*epsilon[0]*rdx2Sq[1])-0.1666666666666667*epsilon[0]*rdx2Sq[0]-0.05555555555555555*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[2], 0.1666666666666667*kSq[3]-0.1924500897298752*kSq[2]+0.3333333333333333*epsilon[0]*rdx2Sq[1]+0.1924500897298752*kSq[1]+0.3333333333333333*epsilon[0]*rdx2Sq[0]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[3], (-0.09622504486493762*kSq[2])+0.1666666666666667*epsilon[0]*rdx2Sq[1]-0.3333333333333333*epsilon[0]*rdx2Sq[0]-0.1111111111111111*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[0], (-0.1666666666666667*epsilon[0]*rdx2Sq[1])-0.1666666666666667*epsilon[0]*rdx2Sq[0]-0.05555555555555555*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[1], (-0.3333333333333333*epsilon[0]*rdx2Sq[1])-0.09622504486493762*kSq[1]+0.1666666666666667*epsilon[0]*rdx2Sq[0]-0.1111111111111111*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[2], (-0.09622504486493762*kSq[2])+0.1666666666666667*epsilon[0]*rdx2Sq[1]-0.3333333333333333*epsilon[0]*rdx2Sq[0]-0.1111111111111111*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[3], (-0.1666666666666667*kSq[3])-0.1924500897298752*kSq[2]+0.3333333333333333*epsilon[0]*rdx2Sq[1]-0.1924500897298752*kSq[1]+0.3333333333333333*epsilon[0]*rdx2Sq[0]-0.2222222222222222*kSq[0]);

}
void fem_poisson_lhs_stencil_consteps_2x_ser_p2_lox_periodicx_upy_neumanny(const double *epsilon, const double *kSq, const double *dx, const double *bcVals, const long *globalIdxs, gkyl_mat_triples *tri) 
{ 
  // epsilon: permittivity.
  // kSq: wave number squared (factor multiplying phi).
  // dx: cell length in each direction.
  // bcVals[3]: values to impose as BCs, i.e. bcVals[0]*phi+bcVals[1]*d(phi)/dx=bcVals[2].
  // globalIdxs: global linear index of each basis function/node in current cell.
  // tri: triples object (i,j,val), i.e. contribute val to i,j element of the global matrix.

  double rdx2Sq[2];
  rdx2Sq[0] = 4.0/(dx[0]*dx[0]);
  rdx2Sq[1] = 4.0/(dx[1]*dx[1]);

  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[0], 0.04549218533640458*kSq[7]+0.04549218533640458*kSq[6]-0.0127775312999988*kSq[5]-0.0127775312999988*kSq[4]-0.04666666666666667*kSq[3]+0.03849001794597505*kSq[2]+0.5777777777777777*epsilon[0]*rdx2Sq[1]+0.03849001794597505*kSq[1]+0.5777777777777777*epsilon[0]*rdx2Sq[0]-0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[1], 0.03442651863295482*kSq[7]+0.0295084445425327*kSq[6]-0.05962847939999439*kSq[5]-0.063887656499994*kSq[4]-0.05333333333333333*kSq[3]+0.06666666666666667*epsilon[0]*rdx2Sq[1]+0.03849001794597505*kSq[1]-0.8888888888888888*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[2], (-0.006147592613027645*kSq[6])+0.03336355394999686*kSq[5]+0.02697478829999747*kSq[4]-0.01924500897298752*kSq[2]+0.1888888888888889*epsilon[0]*rdx2Sq[1]+0.3111111111111111*epsilon[0]*rdx2Sq[0]-0.02222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[3], 0.0295084445425327*kSq[7]+0.03442651863295482*kSq[6]-0.063887656499994*kSq[5]-0.05962847939999439*kSq[4]-0.05333333333333333*kSq[3]+0.03849001794597505*kSq[2]-0.8888888888888888*epsilon[0]*rdx2Sq[1]+0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[4], (-0.01721325931647741*kSq[7])-0.05678902799999467*kSq[5]-0.03975231959999626*kSq[4]-0.01333333333333333*kSq[3]-0.4444444444444444*epsilon[0]*rdx2Sq[1]+0.03849001794597505*kSq[1]-0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[5], (-0.006147592613027645*kSq[7])+0.02697478829999747*kSq[5]+0.03336355394999686*kSq[4]+0.3111111111111111*epsilon[0]*rdx2Sq[1]-0.01924500897298752*kSq[1]+0.1888888888888889*epsilon[0]*rdx2Sq[0]-0.02222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[6], (-0.01721325931647741*kSq[6])-0.03975231959999626*kSq[5]-0.05678902799999467*kSq[4]-0.01333333333333333*kSq[3]+0.03849001794597505*kSq[2]-0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.4444444444444444*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[7], 0.0234254740499978*kSq[5]+0.0234254740499978*kSq[4]+0.01333333333333333*kSq[3]+0.2555555555555555*epsilon[0]*rdx2Sq[1]+0.2555555555555555*epsilon[0]*rdx2Sq[0]-0.03333333333333333*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[0], 0.03442651863295482*kSq[7]+0.0295084445425327*kSq[6]-0.05962847939999439*kSq[5]-0.063887656499994*kSq[4]-0.05333333333333333*kSq[3]+0.06666666666666667*epsilon[0]*rdx2Sq[1]+0.03849001794597505*kSq[1]-0.8888888888888888*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[1], (-0.1967229636168847*kSq[6])-0.07950463919999252*kSq[5]+0.2271561119999787*kSq[4]+0.3079201435678004*kSq[2]+0.5333333333333333*epsilon[0]*rdx2Sq[1]+1.777777777777778*epsilon[0]*rdx2Sq[0]-0.3555555555555556*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[2], (-0.03442651863295482*kSq[7])+0.0295084445425327*kSq[6]-0.05962847939999439*kSq[5]-0.063887656499994*kSq[4]+0.05333333333333333*kSq[3]+0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.03849001794597505*kSq[1]-0.8888888888888888*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[3], (-0.03442651863295482*kSq[7])-0.03442651863295482*kSq[6]+0.09938079899999068*kSq[5]+0.09938079899999068*kSq[4]-0.02666666666666666*kSq[3]+0.0769800358919501*kSq[2]+0.0769800358919501*kSq[1]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[4], 0.03442651863295482*kSq[7]-0.03442651863295482*kSq[6]+0.09938079899999068*kSq[5]+0.09938079899999068*kSq[4]+0.02666666666666666*kSq[3]+0.0769800358919501*kSq[2]-0.0769800358919501*kSq[1]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[5], 0.01721325931647741*kSq[6]-0.03975231959999626*kSq[5]-0.05678902799999467*kSq[4]+0.01333333333333333*kSq[3]-0.03849001794597505*kSq[2]-0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.4444444444444444*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[6], 0.07950463919999252*kSq[5]+0.1135780559999893*kSq[4]-0.5333333333333333*epsilon[0]*rdx2Sq[1]+0.8888888888888888*epsilon[0]*rdx2Sq[0]-0.1777777777777778*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[7], 0.01721325931647741*kSq[6]-0.03975231959999626*kSq[5]-0.05678902799999467*kSq[4]-0.01333333333333333*kSq[3]-0.03849001794597505*kSq[2]-0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.4444444444444444*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[0], (-0.006147592613027645*kSq[6])+0.03336355394999686*kSq[5]+0.02697478829999747*kSq[4]-0.01924500897298752*kSq[2]+0.1888888888888889*epsilon[0]*rdx2Sq[1]+0.3111111111111111*epsilon[0]*rdx2Sq[0]-0.02222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[1], (-0.03442651863295482*kSq[7])+0.0295084445425327*kSq[6]-0.05962847939999439*kSq[5]-0.063887656499994*kSq[4]+0.05333333333333333*kSq[3]+0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.03849001794597505*kSq[1]-0.8888888888888888*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[2], (-0.04549218533640458*kSq[7])+0.04549218533640458*kSq[6]-0.0127775312999988*kSq[5]-0.0127775312999988*kSq[4]+0.04666666666666667*kSq[3]+0.03849001794597505*kSq[2]+0.5777777777777777*epsilon[0]*rdx2Sq[1]-0.03849001794597505*kSq[1]+0.5777777777777777*epsilon[0]*rdx2Sq[0]-0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[3], 0.01721325931647741*kSq[7]-0.05678902799999467*kSq[5]-0.03975231959999626*kSq[4]+0.01333333333333333*kSq[3]-0.4444444444444444*epsilon[0]*rdx2Sq[1]-0.03849001794597505*kSq[1]-0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[4], (-0.0295084445425327*kSq[7])+0.03442651863295482*kSq[6]-0.063887656499994*kSq[5]-0.05962847939999439*kSq[4]+0.05333333333333333*kSq[3]+0.03849001794597505*kSq[2]-0.8888888888888888*epsilon[0]*rdx2Sq[1]+0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[5], 0.0234254740499978*kSq[5]+0.0234254740499978*kSq[4]-0.01333333333333333*kSq[3]+0.2555555555555555*epsilon[0]*rdx2Sq[1]+0.2555555555555555*epsilon[0]*rdx2Sq[0]-0.03333333333333333*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[6], (-0.01721325931647741*kSq[6])-0.03975231959999626*kSq[5]-0.05678902799999467*kSq[4]+0.01333333333333333*kSq[3]+0.03849001794597505*kSq[2]-0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.4444444444444444*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[7], 0.006147592613027645*kSq[7]+0.02697478829999747*kSq[5]+0.03336355394999686*kSq[4]+0.3111111111111111*epsilon[0]*rdx2Sq[1]+0.01924500897298752*kSq[1]+0.1888888888888889*epsilon[0]*rdx2Sq[0]-0.02222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[0], 0.0295084445425327*kSq[7]+0.03442651863295482*kSq[6]-0.063887656499994*kSq[5]-0.05962847939999439*kSq[4]-0.05333333333333333*kSq[3]+0.03849001794597505*kSq[2]-0.8888888888888888*epsilon[0]*rdx2Sq[1]+0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[1], (-0.03442651863295482*kSq[7])-0.03442651863295482*kSq[6]+0.09938079899999068*kSq[5]+0.09938079899999068*kSq[4]-0.02666666666666666*kSq[3]+0.0769800358919501*kSq[2]+0.0769800358919501*kSq[1]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[2], 0.01721325931647741*kSq[7]-0.05678902799999467*kSq[5]-0.03975231959999626*kSq[4]+0.01333333333333333*kSq[3]-0.4444444444444444*epsilon[0]*rdx2Sq[1]-0.03849001794597505*kSq[1]-0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[3], (-0.1967229636168847*kSq[7])+0.2271561119999787*kSq[5]-0.07950463919999252*kSq[4]+1.777777777777778*epsilon[0]*rdx2Sq[1]+0.3079201435678004*kSq[1]+0.5333333333333333*epsilon[0]*rdx2Sq[0]-0.3555555555555556*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[4], 0.1135780559999893*kSq[5]+0.07950463919999252*kSq[4]+0.8888888888888888*epsilon[0]*rdx2Sq[1]-0.5333333333333333*epsilon[0]*rdx2Sq[0]-0.1777777777777778*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[5], 0.0295084445425327*kSq[7]-0.03442651863295482*kSq[6]-0.063887656499994*kSq[5]-0.05962847939999439*kSq[4]+0.05333333333333333*kSq[3]-0.03849001794597505*kSq[2]-0.8888888888888888*epsilon[0]*rdx2Sq[1]+0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[6], (-0.03442651863295482*kSq[7])+0.03442651863295482*kSq[6]+0.09938079899999068*kSq[5]+0.09938079899999068*kSq[4]+0.02666666666666666*kSq[3]-0.0769800358919501*kSq[2]+0.0769800358919501*kSq[1]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[7], 0.01721325931647741*kSq[7]-0.05678902799999467*kSq[5]-0.03975231959999626*kSq[4]-0.01333333333333333*kSq[3]-0.4444444444444444*epsilon[0]*rdx2Sq[1]-0.03849001794597505*kSq[1]-0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[4], globalIdxs[0], (-0.01721325931647741*kSq[7])-0.05678902799999467*kSq[5]-0.03975231959999626*kSq[4]-0.01333333333333333*kSq[3]-0.4444444444444444*epsilon[0]*rdx2Sq[1]+0.03849001794597505*kSq[1]-0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[4], globalIdxs[1], 0.03442651863295482*kSq[7]-0.03442651863295482*kSq[6]+0.09938079899999068*kSq[5]+0.09938079899999068*kSq[4]+0.02666666666666666*kSq[3]+0.0769800358919501*kSq[2]-0.0769800358919501*kSq[1]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[4], globalIdxs[2], (-0.0295084445425327*kSq[7])+0.03442651863295482*kSq[6]-0.063887656499994*kSq[5]-0.05962847939999439*kSq[4]+0.05333333333333333*kSq[3]+0.03849001794597505*kSq[2]-0.8888888888888888*epsilon[0]*rdx2Sq[1]+0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[4], globalIdxs[3], 0.1135780559999893*kSq[5]+0.07950463919999252*kSq[4]+0.8888888888888888*epsilon[0]*rdx2Sq[1]-0.5333333333333333*epsilon[0]*rdx2Sq[0]-0.1777777777777778*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[4], globalIdxs[4], 0.1967229636168847*kSq[7]+0.2271561119999787*kSq[5]-0.07950463919999252*kSq[4]+1.777777777777778*epsilon[0]*rdx2Sq[1]-0.3079201435678004*kSq[1]+0.5333333333333333*epsilon[0]*rdx2Sq[0]-0.3555555555555556*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[4], globalIdxs[5], (-0.01721325931647741*kSq[7])-0.05678902799999467*kSq[5]-0.03975231959999626*kSq[4]+0.01333333333333333*kSq[3]-0.4444444444444444*epsilon[0]*rdx2Sq[1]+0.03849001794597505*kSq[1]-0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[4], globalIdxs[6], 0.03442651863295482*kSq[7]+0.03442651863295482*kSq[6]+0.09938079899999068*kSq[5]+0.09938079899999068*kSq[4]-0.02666666666666666*kSq[3]-0.0769800358919501*kSq[2]-0.0769800358919501*kSq[1]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[4], globalIdxs[7], (-0.0295084445425327*kSq[7])-0.03442651863295482*kSq[6]-0.063887656499994*kSq[5]-0.05962847939999439*kSq[4]-0.05333333333333333*kSq[3]-0.03849001794597505*kSq[2]-0.8888888888888888*epsilon[0]*rdx2Sq[1]+0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[5], globalIdxs[0], (-0.006147592613027645*kSq[7])+0.02697478829999747*kSq[5]+0.03336355394999686*kSq[4]+0.3111111111111111*epsilon[0]*rdx2Sq[1]-0.01924500897298752*kSq[1]+0.1888888888888889*epsilon[0]*rdx2Sq[0]-0.02222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[5], globalIdxs[1], 0.01721325931647741*kSq[6]-0.03975231959999626*kSq[5]-0.05678902799999467*kSq[4]+0.01333333333333333*kSq[3]-0.03849001794597505*kSq[2]-0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.4444444444444444*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[5], globalIdxs[2], 0.0234254740499978*kSq[5]+0.0234254740499978*kSq[4]-0.01333333333333333*kSq[3]+0.2555555555555555*epsilon[0]*rdx2Sq[1]+0.2555555555555555*epsilon[0]*rdx2Sq[0]-0.03333333333333333*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[5], globalIdxs[3], 0.0295084445425327*kSq[7]-0.03442651863295482*kSq[6]-0.063887656499994*kSq[5]-0.05962847939999439*kSq[4]+0.05333333333333333*kSq[3]-0.03849001794597505*kSq[2]-0.8888888888888888*epsilon[0]*rdx2Sq[1]+0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[5], globalIdxs[4], (-0.01721325931647741*kSq[7])-0.05678902799999467*kSq[5]-0.03975231959999626*kSq[4]+0.01333333333333333*kSq[3]-0.4444444444444444*epsilon[0]*rdx2Sq[1]+0.03849001794597505*kSq[1]-0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[5], globalIdxs[5], 0.04549218533640458*kSq[7]-0.04549218533640458*kSq[6]-0.0127775312999988*kSq[5]-0.0127775312999988*kSq[4]+0.04666666666666667*kSq[3]-0.03849001794597505*kSq[2]+0.5777777777777777*epsilon[0]*rdx2Sq[1]+0.03849001794597505*kSq[1]+0.5777777777777777*epsilon[0]*rdx2Sq[0]-0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[5], globalIdxs[6], 0.03442651863295482*kSq[7]-0.0295084445425327*kSq[6]-0.05962847939999439*kSq[5]-0.063887656499994*kSq[4]+0.05333333333333333*kSq[3]+0.06666666666666667*epsilon[0]*rdx2Sq[1]+0.03849001794597505*kSq[1]-0.8888888888888888*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[5], globalIdxs[7], 0.006147592613027645*kSq[6]+0.03336355394999686*kSq[5]+0.02697478829999747*kSq[4]+0.01924500897298752*kSq[2]+0.1888888888888889*epsilon[0]*rdx2Sq[1]+0.3111111111111111*epsilon[0]*rdx2Sq[0]-0.02222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[6], globalIdxs[0], (-0.01721325931647741*kSq[6])-0.03975231959999626*kSq[5]-0.05678902799999467*kSq[4]-0.01333333333333333*kSq[3]+0.03849001794597505*kSq[2]-0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.4444444444444444*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[6], globalIdxs[1], 0.07950463919999252*kSq[5]+0.1135780559999893*kSq[4]-0.5333333333333333*epsilon[0]*rdx2Sq[1]+0.8888888888888888*epsilon[0]*rdx2Sq[0]-0.1777777777777778*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[6], globalIdxs[2], (-0.01721325931647741*kSq[6])-0.03975231959999626*kSq[5]-0.05678902799999467*kSq[4]+0.01333333333333333*kSq[3]+0.03849001794597505*kSq[2]-0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.4444444444444444*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[6], globalIdxs[3], (-0.03442651863295482*kSq[7])+0.03442651863295482*kSq[6]+0.09938079899999068*kSq[5]+0.09938079899999068*kSq[4]+0.02666666666666666*kSq[3]-0.0769800358919501*kSq[2]+0.0769800358919501*kSq[1]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[6], globalIdxs[4], 0.03442651863295482*kSq[7]+0.03442651863295482*kSq[6]+0.09938079899999068*kSq[5]+0.09938079899999068*kSq[4]-0.02666666666666666*kSq[3]-0.0769800358919501*kSq[2]-0.0769800358919501*kSq[1]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[6], globalIdxs[5], 0.03442651863295482*kSq[7]-0.0295084445425327*kSq[6]-0.05962847939999439*kSq[5]-0.063887656499994*kSq[4]+0.05333333333333333*kSq[3]+0.06666666666666667*epsilon[0]*rdx2Sq[1]+0.03849001794597505*kSq[1]-0.8888888888888888*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[6], globalIdxs[6], 0.1967229636168847*kSq[6]-0.07950463919999252*kSq[5]+0.2271561119999787*kSq[4]-0.3079201435678004*kSq[2]+0.5333333333333333*epsilon[0]*rdx2Sq[1]+1.777777777777778*epsilon[0]*rdx2Sq[0]-0.3555555555555556*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[6], globalIdxs[7], (-0.03442651863295482*kSq[7])-0.0295084445425327*kSq[6]-0.05962847939999439*kSq[5]-0.063887656499994*kSq[4]-0.05333333333333333*kSq[3]+0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.03849001794597505*kSq[1]-0.8888888888888888*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[7], globalIdxs[0], 0.0234254740499978*kSq[5]+0.0234254740499978*kSq[4]+0.01333333333333333*kSq[3]+0.2555555555555555*epsilon[0]*rdx2Sq[1]+0.2555555555555555*epsilon[0]*rdx2Sq[0]-0.03333333333333333*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[7], globalIdxs[1], 0.01721325931647741*kSq[6]-0.03975231959999626*kSq[5]-0.05678902799999467*kSq[4]-0.01333333333333333*kSq[3]-0.03849001794597505*kSq[2]-0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.4444444444444444*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[7], globalIdxs[2], 0.006147592613027645*kSq[7]+0.02697478829999747*kSq[5]+0.03336355394999686*kSq[4]+0.3111111111111111*epsilon[0]*rdx2Sq[1]+0.01924500897298752*kSq[1]+0.1888888888888889*epsilon[0]*rdx2Sq[0]-0.02222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[7], globalIdxs[3], 0.01721325931647741*kSq[7]-0.05678902799999467*kSq[5]-0.03975231959999626*kSq[4]-0.01333333333333333*kSq[3]-0.4444444444444444*epsilon[0]*rdx2Sq[1]-0.03849001794597505*kSq[1]-0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[7], globalIdxs[4], (-0.0295084445425327*kSq[7])-0.03442651863295482*kSq[6]-0.063887656499994*kSq[5]-0.05962847939999439*kSq[4]-0.05333333333333333*kSq[3]-0.03849001794597505*kSq[2]-0.8888888888888888*epsilon[0]*rdx2Sq[1]+0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[7], globalIdxs[5], 0.006147592613027645*kSq[6]+0.03336355394999686*kSq[5]+0.02697478829999747*kSq[4]+0.01924500897298752*kSq[2]+0.1888888888888889*epsilon[0]*rdx2Sq[1]+0.3111111111111111*epsilon[0]*rdx2Sq[0]-0.02222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[7], globalIdxs[6], (-0.03442651863295482*kSq[7])-0.0295084445425327*kSq[6]-0.05962847939999439*kSq[5]-0.063887656499994*kSq[4]-0.05333333333333333*kSq[3]+0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.03849001794597505*kSq[1]-0.8888888888888888*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[7], globalIdxs[7], (-0.04549218533640458*kSq[7])-0.04549218533640458*kSq[6]-0.0127775312999988*kSq[5]-0.0127775312999988*kSq[4]-0.04666666666666667*kSq[3]-0.03849001794597505*kSq[2]+0.5777777777777777*epsilon[0]*rdx2Sq[1]-0.03849001794597505*kSq[1]+0.5777777777777777*epsilon[0]*rdx2Sq[0]-0.06666666666666667*kSq[0]);

}
void fem_poisson_lhs_stencil_consteps_2x_ser_p1_lox_periodicx_upy_robiny(const double *epsilon, const double *kSq, const double *dx, const double *bcVals, const long *globalIdxs, gkyl_mat_triples *tri) 
{ 
  // epsilon: permittivity.
  // kSq: wave number squared (factor multiplying phi).
  // dx: cell length in each direction.
  // bcVals[3]: values to impose as BCs, i.e. bcVals[0]*phi+bcVals[1]*d(phi)/dx=bcVals[2].
  // globalIdxs: global linear index of each basis function/node in current cell.
  // tri: triples object (i,j,val), i.e. contribute val to i,j element of the global matrix.

  double rdx2Sq[2];
  rdx2Sq[0] = 4.0/(dx[0]*dx[0]);
  rdx2Sq[1] = 4.0/(dx[1]*dx[1]);

  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[0], (-0.1666666666666667*kSq[3])+0.1924500897298752*kSq[2]+0.3333333333333333*epsilon[0]*rdx2Sq[1]+0.1924500897298752*kSq[1]+0.3333333333333333*epsilon[0]*rdx2Sq[0]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[1], 0.09622504486493762*kSq[2]+0.1666666666666667*epsilon[0]*rdx2Sq[1]-0.3333333333333333*epsilon[0]*rdx2Sq[0]-0.1111111111111111*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[2], (-0.3333333333333333*epsilon[0]*rdx2Sq[1])+0.09622504486493762*kSq[1]+0.1666666666666667*epsilon[0]*rdx2Sq[0]-0.1111111111111111*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[3], (-0.1666666666666667*epsilon[0]*rdx2Sq[1])-0.1666666666666667*epsilon[0]*rdx2Sq[0]-0.05555555555555555*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[0], 0.09622504486493762*kSq[2]+0.1666666666666667*epsilon[0]*rdx2Sq[1]-0.3333333333333333*epsilon[0]*rdx2Sq[0]-0.1111111111111111*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[1], 0.1666666666666667*kSq[3]+0.1924500897298752*kSq[2]+0.3333333333333333*epsilon[0]*rdx2Sq[1]-0.1924500897298752*kSq[1]+0.3333333333333333*epsilon[0]*rdx2Sq[0]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[2], (-0.1666666666666667*epsilon[0]*rdx2Sq[1])-0.1666666666666667*epsilon[0]*rdx2Sq[0]-0.05555555555555555*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[3], (-0.3333333333333333*epsilon[0]*rdx2Sq[1])-0.09622504486493762*kSq[1]+0.1666666666666667*epsilon[0]*rdx2Sq[0]-0.1111111111111111*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[0], (-0.3333333333333333*epsilon[0]*rdx2Sq[1])+0.09622504486493762*kSq[1]+0.1666666666666667*epsilon[0]*rdx2Sq[0]-0.1111111111111111*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[1], (-0.1666666666666667*epsilon[0]*rdx2Sq[1])-0.1666666666666667*epsilon[0]*rdx2Sq[0]-0.05555555555555555*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[2], (0.6666666666666666*epsilon[0]*rdx2Sq[1]*bcVals[9])/bcVals[10]+0.1666666666666667*kSq[3]-0.1924500897298752*kSq[2]+0.3333333333333333*epsilon[0]*rdx2Sq[1]+0.1924500897298752*kSq[1]+0.3333333333333333*epsilon[0]*rdx2Sq[0]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[3], (0.3333333333333333*epsilon[0]*rdx2Sq[1]*bcVals[9])/bcVals[10]-0.09622504486493762*kSq[2]+0.1666666666666667*epsilon[0]*rdx2Sq[1]-0.3333333333333333*epsilon[0]*rdx2Sq[0]-0.1111111111111111*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[0], (-0.1666666666666667*epsilon[0]*rdx2Sq[1])-0.1666666666666667*epsilon[0]*rdx2Sq[0]-0.05555555555555555*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[1], (-0.3333333333333333*epsilon[0]*rdx2Sq[1])-0.09622504486493762*kSq[1]+0.1666666666666667*epsilon[0]*rdx2Sq[0]-0.1111111111111111*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[2], (0.3333333333333333*epsilon[0]*rdx2Sq[1]*bcVals[9])/bcVals[10]-0.09622504486493762*kSq[2]+0.1666666666666667*epsilon[0]*rdx2Sq[1]-0.3333333333333333*epsilon[0]*rdx2Sq[0]-0.1111111111111111*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[3], (0.6666666666666666*epsilon[0]*rdx2Sq[1]*bcVals[9])/bcVals[10]-0.1666666666666667*kSq[3]-0.1924500897298752*kSq[2]+0.3333333333333333*epsilon[0]*rdx2Sq[1]-0.1924500897298752*kSq[1]+0.3333333333333333*epsilon[0]*rdx2Sq[0]-0.2222222222222222*kSq[0]);

}
void fem_poisson_lhs_stencil_consteps_2x_ser_p2_lox_periodicx_upy_robiny(const double *epsilon, const double *kSq, const double *dx, const double *bcVals, const long *globalIdxs, gkyl_mat_triples *tri) 
{ 
  // epsilon: permittivity.
  // kSq: wave number squared (factor multiplying phi).
  // dx: cell length in each direction.
  // bcVals[3]: values to impose as BCs, i.e. bcVals[0]*phi+bcVals[1]*d(phi)/dx=bcVals[2].
  // globalIdxs: global linear index of each basis function/node in current cell.
  // tri: triples object (i,j,val), i.e. contribute val to i,j element of the global matrix.

  double rdx2Sq[2];
  rdx2Sq[0] = 4.0/(dx[0]*dx[0]);
  rdx2Sq[1] = 4.0/(dx[1]*dx[1]);

  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[0], 0.04549218533640458*kSq[7]+0.04549218533640458*kSq[6]-0.0127775312999988*kSq[5]-0.0127775312999988*kSq[4]-0.04666666666666667*kSq[3]+0.03849001794597505*kSq[2]+0.5777777777777777*epsilon[0]*rdx2Sq[1]+0.03849001794597505*kSq[1]+0.5777777777777777*epsilon[0]*rdx2Sq[0]-0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[1], 0.03442651863295482*kSq[7]+0.0295084445425327*kSq[6]-0.05962847939999439*kSq[5]-0.063887656499994*kSq[4]-0.05333333333333333*kSq[3]+0.06666666666666667*epsilon[0]*rdx2Sq[1]+0.03849001794597505*kSq[1]-0.8888888888888888*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[2], (-0.006147592613027645*kSq[6])+0.03336355394999686*kSq[5]+0.02697478829999747*kSq[4]-0.01924500897298752*kSq[2]+0.1888888888888889*epsilon[0]*rdx2Sq[1]+0.3111111111111111*epsilon[0]*rdx2Sq[0]-0.02222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[3], 0.0295084445425327*kSq[7]+0.03442651863295482*kSq[6]-0.063887656499994*kSq[5]-0.05962847939999439*kSq[4]-0.05333333333333333*kSq[3]+0.03849001794597505*kSq[2]-0.8888888888888888*epsilon[0]*rdx2Sq[1]+0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[4], (-0.01721325931647741*kSq[7])-0.05678902799999467*kSq[5]-0.03975231959999626*kSq[4]-0.01333333333333333*kSq[3]-0.4444444444444444*epsilon[0]*rdx2Sq[1]+0.03849001794597505*kSq[1]-0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[5], (-0.006147592613027645*kSq[7])+0.02697478829999747*kSq[5]+0.03336355394999686*kSq[4]+0.3111111111111111*epsilon[0]*rdx2Sq[1]-0.01924500897298752*kSq[1]+0.1888888888888889*epsilon[0]*rdx2Sq[0]-0.02222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[6], (-0.01721325931647741*kSq[6])-0.03975231959999626*kSq[5]-0.05678902799999467*kSq[4]-0.01333333333333333*kSq[3]+0.03849001794597505*kSq[2]-0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.4444444444444444*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[7], 0.0234254740499978*kSq[5]+0.0234254740499978*kSq[4]+0.01333333333333333*kSq[3]+0.2555555555555555*epsilon[0]*rdx2Sq[1]+0.2555555555555555*epsilon[0]*rdx2Sq[0]-0.03333333333333333*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[0], 0.03442651863295482*kSq[7]+0.0295084445425327*kSq[6]-0.05962847939999439*kSq[5]-0.063887656499994*kSq[4]-0.05333333333333333*kSq[3]+0.06666666666666667*epsilon[0]*rdx2Sq[1]+0.03849001794597505*kSq[1]-0.8888888888888888*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[1], (-0.1967229636168847*kSq[6])-0.07950463919999252*kSq[5]+0.2271561119999787*kSq[4]+0.3079201435678004*kSq[2]+0.5333333333333333*epsilon[0]*rdx2Sq[1]+1.777777777777778*epsilon[0]*rdx2Sq[0]-0.3555555555555556*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[2], (-0.03442651863295482*kSq[7])+0.0295084445425327*kSq[6]-0.05962847939999439*kSq[5]-0.063887656499994*kSq[4]+0.05333333333333333*kSq[3]+0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.03849001794597505*kSq[1]-0.8888888888888888*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[3], (-0.03442651863295482*kSq[7])-0.03442651863295482*kSq[6]+0.09938079899999068*kSq[5]+0.09938079899999068*kSq[4]-0.02666666666666666*kSq[3]+0.0769800358919501*kSq[2]+0.0769800358919501*kSq[1]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[4], 0.03442651863295482*kSq[7]-0.03442651863295482*kSq[6]+0.09938079899999068*kSq[5]+0.09938079899999068*kSq[4]+0.02666666666666666*kSq[3]+0.0769800358919501*kSq[2]-0.0769800358919501*kSq[1]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[5], 0.01721325931647741*kSq[6]-0.03975231959999626*kSq[5]-0.05678902799999467*kSq[4]+0.01333333333333333*kSq[3]-0.03849001794597505*kSq[2]-0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.4444444444444444*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[6], 0.07950463919999252*kSq[5]+0.1135780559999893*kSq[4]-0.5333333333333333*epsilon[0]*rdx2Sq[1]+0.8888888888888888*epsilon[0]*rdx2Sq[0]-0.1777777777777778*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[7], 0.01721325931647741*kSq[6]-0.03975231959999626*kSq[5]-0.05678902799999467*kSq[4]-0.01333333333333333*kSq[3]-0.03849001794597505*kSq[2]-0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.4444444444444444*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[0], (-0.006147592613027645*kSq[6])+0.03336355394999686*kSq[5]+0.02697478829999747*kSq[4]-0.01924500897298752*kSq[2]+0.1888888888888889*epsilon[0]*rdx2Sq[1]+0.3111111111111111*epsilon[0]*rdx2Sq[0]-0.02222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[1], (-0.03442651863295482*kSq[7])+0.0295084445425327*kSq[6]-0.05962847939999439*kSq[5]-0.063887656499994*kSq[4]+0.05333333333333333*kSq[3]+0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.03849001794597505*kSq[1]-0.8888888888888888*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[2], (-0.04549218533640458*kSq[7])+0.04549218533640458*kSq[6]-0.0127775312999988*kSq[5]-0.0127775312999988*kSq[4]+0.04666666666666667*kSq[3]+0.03849001794597505*kSq[2]+0.5777777777777777*epsilon[0]*rdx2Sq[1]-0.03849001794597505*kSq[1]+0.5777777777777777*epsilon[0]*rdx2Sq[0]-0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[3], 0.01721325931647741*kSq[7]-0.05678902799999467*kSq[5]-0.03975231959999626*kSq[4]+0.01333333333333333*kSq[3]-0.4444444444444444*epsilon[0]*rdx2Sq[1]-0.03849001794597505*kSq[1]-0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[4], (-0.0295084445425327*kSq[7])+0.03442651863295482*kSq[6]-0.063887656499994*kSq[5]-0.05962847939999439*kSq[4]+0.05333333333333333*kSq[3]+0.03849001794597505*kSq[2]-0.8888888888888888*epsilon[0]*rdx2Sq[1]+0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[5], 0.0234254740499978*kSq[5]+0.0234254740499978*kSq[4]-0.01333333333333333*kSq[3]+0.2555555555555555*epsilon[0]*rdx2Sq[1]+0.2555555555555555*epsilon[0]*rdx2Sq[0]-0.03333333333333333*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[6], (-0.01721325931647741*kSq[6])-0.03975231959999626*kSq[5]-0.05678902799999467*kSq[4]+0.01333333333333333*kSq[3]+0.03849001794597505*kSq[2]-0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.4444444444444444*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[7], 0.006147592613027645*kSq[7]+0.02697478829999747*kSq[5]+0.03336355394999686*kSq[4]+0.3111111111111111*epsilon[0]*rdx2Sq[1]+0.01924500897298752*kSq[1]+0.1888888888888889*epsilon[0]*rdx2Sq[0]-0.02222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[0], 0.0295084445425327*kSq[7]+0.03442651863295482*kSq[6]-0.063887656499994*kSq[5]-0.05962847939999439*kSq[4]-0.05333333333333333*kSq[3]+0.03849001794597505*kSq[2]-0.8888888888888888*epsilon[0]*rdx2Sq[1]+0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[1], (-0.03442651863295482*kSq[7])-0.03442651863295482*kSq[6]+0.09938079899999068*kSq[5]+0.09938079899999068*kSq[4]-0.02666666666666666*kSq[3]+0.0769800358919501*kSq[2]+0.0769800358919501*kSq[1]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[2], 0.01721325931647741*kSq[7]-0.05678902799999467*kSq[5]-0.03975231959999626*kSq[4]+0.01333333333333333*kSq[3]-0.4444444444444444*epsilon[0]*rdx2Sq[1]-0.03849001794597505*kSq[1]-0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[3], (-0.1967229636168847*kSq[7])+0.2271561119999787*kSq[5]-0.07950463919999252*kSq[4]+1.777777777777778*epsilon[0]*rdx2Sq[1]+0.3079201435678004*kSq[1]+0.5333333333333333*epsilon[0]*rdx2Sq[0]-0.3555555555555556*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[4], 0.1135780559999893*kSq[5]+0.07950463919999252*kSq[4]+0.8888888888888888*epsilon[0]*rdx2Sq[1]-0.5333333333333333*epsilon[0]*rdx2Sq[0]-0.1777777777777778*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[5], 0.0295084445425327*kSq[7]-0.03442651863295482*kSq[6]-0.063887656499994*kSq[5]-0.05962847939999439*kSq[4]+0.05333333333333333*kSq[3]-0.03849001794597505*kSq[2]-0.8888888888888888*epsilon[0]*rdx2Sq[1]+0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[6], (-0.03442651863295482*kSq[7])+0.03442651863295482*kSq[6]+0.09938079899999068*kSq[5]+0.09938079899999068*kSq[4]+0.02666666666666666*kSq[3]-0.0769800358919501*kSq[2]+0.0769800358919501*kSq[1]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[7], 0.01721325931647741*kSq[7]-0.05678902799999467*kSq[5]-0.03975231959999626*kSq[4]-0.01333333333333333*kSq[3]-0.4444444444444444*epsilon[0]*rdx2Sq[1]-0.03849001794597505*kSq[1]-0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[4], globalIdxs[0], (-0.01721325931647741*kSq[7])-0.05678902799999467*kSq[5]-0.03975231959999626*kSq[4]-0.01333333333333333*kSq[3]-0.4444444444444444*epsilon[0]*rdx2Sq[1]+0.03849001794597505*kSq[1]-0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[4], globalIdxs[1], 0.03442651863295482*kSq[7]-0.03442651863295482*kSq[6]+0.09938079899999068*kSq[5]+0.09938079899999068*kSq[4]+0.02666666666666666*kSq[3]+0.0769800358919501*kSq[2]-0.0769800358919501*kSq[1]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[4], globalIdxs[2], (-0.0295084445425327*kSq[7])+0.03442651863295482*kSq[6]-0.063887656499994*kSq[5]-0.05962847939999439*kSq[4]+0.05333333333333333*kSq[3]+0.03849001794597505*kSq[2]-0.8888888888888888*epsilon[0]*rdx2Sq[1]+0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[4], globalIdxs[3], 0.1135780559999893*kSq[5]+0.07950463919999252*kSq[4]+0.8888888888888888*epsilon[0]*rdx2Sq[1]-0.5333333333333333*epsilon[0]*rdx2Sq[0]-0.1777777777777778*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[4], globalIdxs[4], 0.1967229636168847*kSq[7]+0.2271561119999787*kSq[5]-0.07950463919999252*kSq[4]+1.777777777777778*epsilon[0]*rdx2Sq[1]-0.3079201435678004*kSq[1]+0.5333333333333333*epsilon[0]*rdx2Sq[0]-0.3555555555555556*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[4], globalIdxs[5], (-0.01721325931647741*kSq[7])-0.05678902799999467*kSq[5]-0.03975231959999626*kSq[4]+0.01333333333333333*kSq[3]-0.4444444444444444*epsilon[0]*rdx2Sq[1]+0.03849001794597505*kSq[1]-0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[4], globalIdxs[6], 0.03442651863295482*kSq[7]+0.03442651863295482*kSq[6]+0.09938079899999068*kSq[5]+0.09938079899999068*kSq[4]-0.02666666666666666*kSq[3]-0.0769800358919501*kSq[2]-0.0769800358919501*kSq[1]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[4], globalIdxs[7], (-0.0295084445425327*kSq[7])-0.03442651863295482*kSq[6]-0.063887656499994*kSq[5]-0.05962847939999439*kSq[4]-0.05333333333333333*kSq[3]-0.03849001794597505*kSq[2]-0.8888888888888888*epsilon[0]*rdx2Sq[1]+0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[5], globalIdxs[0], (-0.006147592613027645*kSq[7])+0.02697478829999747*kSq[5]+0.03336355394999686*kSq[4]+0.3111111111111111*epsilon[0]*rdx2Sq[1]-0.01924500897298752*kSq[1]+0.1888888888888889*epsilon[0]*rdx2Sq[0]-0.02222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[5], globalIdxs[1], 0.01721325931647741*kSq[6]-0.03975231959999626*kSq[5]-0.05678902799999467*kSq[4]+0.01333333333333333*kSq[3]-0.03849001794597505*kSq[2]-0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.4444444444444444*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[5], globalIdxs[2], 0.0234254740499978*kSq[5]+0.0234254740499978*kSq[4]-0.01333333333333333*kSq[3]+0.2555555555555555*epsilon[0]*rdx2Sq[1]+0.2555555555555555*epsilon[0]*rdx2Sq[0]-0.03333333333333333*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[5], globalIdxs[3], 0.0295084445425327*kSq[7]-0.03442651863295482*kSq[6]-0.063887656499994*kSq[5]-0.05962847939999439*kSq[4]+0.05333333333333333*kSq[3]-0.03849001794597505*kSq[2]-0.8888888888888888*epsilon[0]*rdx2Sq[1]+0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[5], globalIdxs[4], (-0.01721325931647741*kSq[7])-0.05678902799999467*kSq[5]-0.03975231959999626*kSq[4]+0.01333333333333333*kSq[3]-0.4444444444444444*epsilon[0]*rdx2Sq[1]+0.03849001794597505*kSq[1]-0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[5], globalIdxs[5], (0.2666666666666667*epsilon[0]*rdx2Sq[1]*bcVals[9])/bcVals[10]+0.04549218533640458*kSq[7]-0.04549218533640458*kSq[6]-0.0127775312999988*kSq[5]-0.0127775312999988*kSq[4]+0.04666666666666667*kSq[3]-0.03849001794597505*kSq[2]+0.5777777777777777*epsilon[0]*rdx2Sq[1]+0.03849001794597505*kSq[1]+0.5777777777777777*epsilon[0]*rdx2Sq[0]-0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[5], globalIdxs[6], (0.1333333333333333*epsilon[0]*rdx2Sq[1]*bcVals[9])/bcVals[10]+0.03442651863295482*kSq[7]-0.0295084445425327*kSq[6]-0.05962847939999439*kSq[5]-0.063887656499994*kSq[4]+0.05333333333333333*kSq[3]+0.06666666666666667*epsilon[0]*rdx2Sq[1]+0.03849001794597505*kSq[1]-0.8888888888888888*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[5], globalIdxs[7], (-(0.06666666666666667*epsilon[0]*rdx2Sq[1]*bcVals[9])/bcVals[10])+0.006147592613027645*kSq[6]+0.03336355394999686*kSq[5]+0.02697478829999747*kSq[4]+0.01924500897298752*kSq[2]+0.1888888888888889*epsilon[0]*rdx2Sq[1]+0.3111111111111111*epsilon[0]*rdx2Sq[0]-0.02222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[6], globalIdxs[0], (-0.01721325931647741*kSq[6])-0.03975231959999626*kSq[5]-0.05678902799999467*kSq[4]-0.01333333333333333*kSq[3]+0.03849001794597505*kSq[2]-0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.4444444444444444*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[6], globalIdxs[1], 0.07950463919999252*kSq[5]+0.1135780559999893*kSq[4]-0.5333333333333333*epsilon[0]*rdx2Sq[1]+0.8888888888888888*epsilon[0]*rdx2Sq[0]-0.1777777777777778*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[6], globalIdxs[2], (-0.01721325931647741*kSq[6])-0.03975231959999626*kSq[5]-0.05678902799999467*kSq[4]+0.01333333333333333*kSq[3]+0.03849001794597505*kSq[2]-0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.4444444444444444*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[6], globalIdxs[3], (-0.03442651863295482*kSq[7])+0.03442651863295482*kSq[6]+0.09938079899999068*kSq[5]+0.09938079899999068*kSq[4]+0.02666666666666666*kSq[3]-0.0769800358919501*kSq[2]+0.0769800358919501*kSq[1]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[6], globalIdxs[4], 0.03442651863295482*kSq[7]+0.03442651863295482*kSq[6]+0.09938079899999068*kSq[5]+0.09938079899999068*kSq[4]-0.02666666666666666*kSq[3]-0.0769800358919501*kSq[2]-0.0769800358919501*kSq[1]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[6], globalIdxs[5], (0.1333333333333333*epsilon[0]*rdx2Sq[1]*bcVals[9])/bcVals[10]+0.03442651863295482*kSq[7]-0.0295084445425327*kSq[6]-0.05962847939999439*kSq[5]-0.063887656499994*kSq[4]+0.05333333333333333*kSq[3]+0.06666666666666667*epsilon[0]*rdx2Sq[1]+0.03849001794597505*kSq[1]-0.8888888888888888*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[6], globalIdxs[6], (1.066666666666667*epsilon[0]*rdx2Sq[1]*bcVals[9])/bcVals[10]+0.1967229636168847*kSq[6]-0.07950463919999252*kSq[5]+0.2271561119999787*kSq[4]-0.3079201435678004*kSq[2]+0.5333333333333333*epsilon[0]*rdx2Sq[1]+1.777777777777778*epsilon[0]*rdx2Sq[0]-0.3555555555555556*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[6], globalIdxs[7], (0.1333333333333333*epsilon[0]*rdx2Sq[1]*bcVals[9])/bcVals[10]-0.03442651863295482*kSq[7]-0.0295084445425327*kSq[6]-0.05962847939999439*kSq[5]-0.063887656499994*kSq[4]-0.05333333333333333*kSq[3]+0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.03849001794597505*kSq[1]-0.8888888888888888*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[7], globalIdxs[0], 0.0234254740499978*kSq[5]+0.0234254740499978*kSq[4]+0.01333333333333333*kSq[3]+0.2555555555555555*epsilon[0]*rdx2Sq[1]+0.2555555555555555*epsilon[0]*rdx2Sq[0]-0.03333333333333333*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[7], globalIdxs[1], 0.01721325931647741*kSq[6]-0.03975231959999626*kSq[5]-0.05678902799999467*kSq[4]-0.01333333333333333*kSq[3]-0.03849001794597505*kSq[2]-0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.4444444444444444*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[7], globalIdxs[2], 0.006147592613027645*kSq[7]+0.02697478829999747*kSq[5]+0.03336355394999686*kSq[4]+0.3111111111111111*epsilon[0]*rdx2Sq[1]+0.01924500897298752*kSq[1]+0.1888888888888889*epsilon[0]*rdx2Sq[0]-0.02222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[7], globalIdxs[3], 0.01721325931647741*kSq[7]-0.05678902799999467*kSq[5]-0.03975231959999626*kSq[4]-0.01333333333333333*kSq[3]-0.4444444444444444*epsilon[0]*rdx2Sq[1]-0.03849001794597505*kSq[1]-0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[7], globalIdxs[4], (-0.0295084445425327*kSq[7])-0.03442651863295482*kSq[6]-0.063887656499994*kSq[5]-0.05962847939999439*kSq[4]-0.05333333333333333*kSq[3]-0.03849001794597505*kSq[2]-0.8888888888888888*epsilon[0]*rdx2Sq[1]+0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[7], globalIdxs[5], (-(0.06666666666666667*epsilon[0]*rdx2Sq[1]*bcVals[9])/bcVals[10])+0.006147592613027645*kSq[6]+0.03336355394999686*kSq[5]+0.02697478829999747*kSq[4]+0.01924500897298752*kSq[2]+0.1888888888888889*epsilon[0]*rdx2Sq[1]+0.3111111111111111*epsilon[0]*rdx2Sq[0]-0.02222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[7], globalIdxs[6], (0.1333333333333333*epsilon[0]*rdx2Sq[1]*bcVals[9])/bcVals[10]-0.03442651863295482*kSq[7]-0.0295084445425327*kSq[6]-0.05962847939999439*kSq[5]-0.063887656499994*kSq[4]-0.05333333333333333*kSq[3]+0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.03849001794597505*kSq[1]-0.8888888888888888*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[7], globalIdxs[7], (0.2666666666666667*epsilon[0]*rdx2Sq[1]*bcVals[9])/bcVals[10]-0.04549218533640458*kSq[7]-0.04549218533640458*kSq[6]-0.0127775312999988*kSq[5]-0.0127775312999988*kSq[4]-0.04666666666666667*kSq[3]-0.03849001794597505*kSq[2]+0.5777777777777777*epsilon[0]*rdx2Sq[1]-0.03849001794597505*kSq[1]+0.5777777777777777*epsilon[0]*rdx2Sq[0]-0.06666666666666667*kSq[0]);

}
void fem_poisson_lhs_stencil_consteps_2x_ser_p1_lox_dirichletx_upy_periodicy(const double *epsilon, const double *kSq, const double *dx, const double *bcVals, const long *globalIdxs, gkyl_mat_triples *tri) 
{ 
  // epsilon: permittivity.
  // kSq: wave number squared (factor multiplying phi).
  // dx: cell length in each direction.
  // bcVals[3]: values to impose as BCs, i.e. bcVals[0]*phi+bcVals[1]*d(phi)/dx=bcVals[2].
  // globalIdxs: global linear index of each basis function/node in current cell.
  // tri: triples object (i,j,val), i.e. contribute val to i,j element of the global matrix.

  double rdx2Sq[2];
  rdx2Sq[0] = 4.0/(dx[0]*dx[0]);
  rdx2Sq[1] = 4.0/(dx[1]*dx[1]);

  gkyl_mat_triples_insert(tri, globalIdxs[0], globalIdxs[0], 1.0);
  gkyl_mat_triples_insert(tri, globalIdxs[0], globalIdxs[1], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[0], globalIdxs[2], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[0], globalIdxs[3], 0.0);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[0], 0.09622504486493762*kSq[2]+0.1666666666666667*epsilon[0]*rdx2Sq[1]-0.3333333333333333*epsilon[0]*rdx2Sq[0]-0.1111111111111111*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[1], 0.1666666666666667*kSq[3]+0.1924500897298752*kSq[2]+0.3333333333333333*epsilon[0]*rdx2Sq[1]-0.1924500897298752*kSq[1]+0.3333333333333333*epsilon[0]*rdx2Sq[0]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[2], (-0.1666666666666667*epsilon[0]*rdx2Sq[1])-0.1666666666666667*epsilon[0]*rdx2Sq[0]-0.05555555555555555*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[3], (-0.3333333333333333*epsilon[0]*rdx2Sq[1])-0.09622504486493762*kSq[1]+0.1666666666666667*epsilon[0]*rdx2Sq[0]-0.1111111111111111*kSq[0]);
  gkyl_mat_triples_insert(tri, globalIdxs[2], globalIdxs[0], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[2], globalIdxs[1], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[2], globalIdxs[2], 1.0);
  gkyl_mat_triples_insert(tri, globalIdxs[2], globalIdxs[3], 0.0);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[0], (-0.1666666666666667*epsilon[0]*rdx2Sq[1])-0.1666666666666667*epsilon[0]*rdx2Sq[0]-0.05555555555555555*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[1], (-0.3333333333333333*epsilon[0]*rdx2Sq[1])-0.09622504486493762*kSq[1]+0.1666666666666667*epsilon[0]*rdx2Sq[0]-0.1111111111111111*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[2], (-0.09622504486493762*kSq[2])+0.1666666666666667*epsilon[0]*rdx2Sq[1]-0.3333333333333333*epsilon[0]*rdx2Sq[0]-0.1111111111111111*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[3], (-0.1666666666666667*kSq[3])-0.1924500897298752*kSq[2]+0.3333333333333333*epsilon[0]*rdx2Sq[1]-0.1924500897298752*kSq[1]+0.3333333333333333*epsilon[0]*rdx2Sq[0]-0.2222222222222222*kSq[0]);

}
void fem_poisson_lhs_stencil_consteps_2x_ser_p2_lox_dirichletx_upy_periodicy(const double *epsilon, const double *kSq, const double *dx, const double *bcVals, const long *globalIdxs, gkyl_mat_triples *tri) 
{ 
  // epsilon: permittivity.
  // kSq: wave number squared (factor multiplying phi).
  // dx: cell length in each direction.
  // bcVals[3]: values to impose as BCs, i.e. bcVals[0]*phi+bcVals[1]*d(phi)/dx=bcVals[2].
  // globalIdxs: global linear index of each basis function/node in current cell.
  // tri: triples object (i,j,val), i.e. contribute val to i,j element of the global matrix.

  double rdx2Sq[2];
  rdx2Sq[0] = 4.0/(dx[0]*dx[0]);
  rdx2Sq[1] = 4.0/(dx[1]*dx[1]);

  gkyl_mat_triples_insert(tri, globalIdxs[0], globalIdxs[0], 1.0);
  gkyl_mat_triples_insert(tri, globalIdxs[0], globalIdxs[1], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[0], globalIdxs[2], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[0], globalIdxs[3], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[0], globalIdxs[4], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[0], globalIdxs[5], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[0], globalIdxs[6], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[0], globalIdxs[7], 0.0);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[0], 0.03442651863295482*kSq[7]+0.0295084445425327*kSq[6]-0.05962847939999439*kSq[5]-0.063887656499994*kSq[4]-0.05333333333333333*kSq[3]+0.06666666666666667*epsilon[0]*rdx2Sq[1]+0.03849001794597505*kSq[1]-0.8888888888888888*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[1], (-0.1967229636168847*kSq[6])-0.07950463919999252*kSq[5]+0.2271561119999787*kSq[4]+0.3079201435678004*kSq[2]+0.5333333333333333*epsilon[0]*rdx2Sq[1]+1.777777777777778*epsilon[0]*rdx2Sq[0]-0.3555555555555556*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[2], (-0.03442651863295482*kSq[7])+0.0295084445425327*kSq[6]-0.05962847939999439*kSq[5]-0.063887656499994*kSq[4]+0.05333333333333333*kSq[3]+0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.03849001794597505*kSq[1]-0.8888888888888888*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[3], (-0.03442651863295482*kSq[7])-0.03442651863295482*kSq[6]+0.09938079899999068*kSq[5]+0.09938079899999068*kSq[4]-0.02666666666666666*kSq[3]+0.0769800358919501*kSq[2]+0.0769800358919501*kSq[1]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[4], 0.03442651863295482*kSq[7]-0.03442651863295482*kSq[6]+0.09938079899999068*kSq[5]+0.09938079899999068*kSq[4]+0.02666666666666666*kSq[3]+0.0769800358919501*kSq[2]-0.0769800358919501*kSq[1]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[5], 0.01721325931647741*kSq[6]-0.03975231959999626*kSq[5]-0.05678902799999467*kSq[4]+0.01333333333333333*kSq[3]-0.03849001794597505*kSq[2]-0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.4444444444444444*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[6], 0.07950463919999252*kSq[5]+0.1135780559999893*kSq[4]-0.5333333333333333*epsilon[0]*rdx2Sq[1]+0.8888888888888888*epsilon[0]*rdx2Sq[0]-0.1777777777777778*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[7], 0.01721325931647741*kSq[6]-0.03975231959999626*kSq[5]-0.05678902799999467*kSq[4]-0.01333333333333333*kSq[3]-0.03849001794597505*kSq[2]-0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.4444444444444444*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[0], (-0.006147592613027645*kSq[6])+0.03336355394999686*kSq[5]+0.02697478829999747*kSq[4]-0.01924500897298752*kSq[2]+0.1888888888888889*epsilon[0]*rdx2Sq[1]+0.3111111111111111*epsilon[0]*rdx2Sq[0]-0.02222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[1], (-0.03442651863295482*kSq[7])+0.0295084445425327*kSq[6]-0.05962847939999439*kSq[5]-0.063887656499994*kSq[4]+0.05333333333333333*kSq[3]+0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.03849001794597505*kSq[1]-0.8888888888888888*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[2], (-0.04549218533640458*kSq[7])+0.04549218533640458*kSq[6]-0.0127775312999988*kSq[5]-0.0127775312999988*kSq[4]+0.04666666666666667*kSq[3]+0.03849001794597505*kSq[2]+0.5777777777777777*epsilon[0]*rdx2Sq[1]-0.03849001794597505*kSq[1]+0.5777777777777777*epsilon[0]*rdx2Sq[0]-0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[3], 0.01721325931647741*kSq[7]-0.05678902799999467*kSq[5]-0.03975231959999626*kSq[4]+0.01333333333333333*kSq[3]-0.4444444444444444*epsilon[0]*rdx2Sq[1]-0.03849001794597505*kSq[1]-0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[4], (-0.0295084445425327*kSq[7])+0.03442651863295482*kSq[6]-0.063887656499994*kSq[5]-0.05962847939999439*kSq[4]+0.05333333333333333*kSq[3]+0.03849001794597505*kSq[2]-0.8888888888888888*epsilon[0]*rdx2Sq[1]+0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[5], 0.0234254740499978*kSq[5]+0.0234254740499978*kSq[4]-0.01333333333333333*kSq[3]+0.2555555555555555*epsilon[0]*rdx2Sq[1]+0.2555555555555555*epsilon[0]*rdx2Sq[0]-0.03333333333333333*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[6], (-0.01721325931647741*kSq[6])-0.03975231959999626*kSq[5]-0.05678902799999467*kSq[4]+0.01333333333333333*kSq[3]+0.03849001794597505*kSq[2]-0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.4444444444444444*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[7], 0.006147592613027645*kSq[7]+0.02697478829999747*kSq[5]+0.03336355394999686*kSq[4]+0.3111111111111111*epsilon[0]*rdx2Sq[1]+0.01924500897298752*kSq[1]+0.1888888888888889*epsilon[0]*rdx2Sq[0]-0.02222222222222222*kSq[0]);
  gkyl_mat_triples_insert(tri, globalIdxs[3], globalIdxs[0], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[3], globalIdxs[1], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[3], globalIdxs[2], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[3], globalIdxs[3], 1.0);
  gkyl_mat_triples_insert(tri, globalIdxs[3], globalIdxs[4], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[3], globalIdxs[5], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[3], globalIdxs[6], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[3], globalIdxs[7], 0.0);
  gkyl_mat_triples_accum(tri, globalIdxs[4], globalIdxs[0], (-0.01721325931647741*kSq[7])-0.05678902799999467*kSq[5]-0.03975231959999626*kSq[4]-0.01333333333333333*kSq[3]-0.4444444444444444*epsilon[0]*rdx2Sq[1]+0.03849001794597505*kSq[1]-0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[4], globalIdxs[1], 0.03442651863295482*kSq[7]-0.03442651863295482*kSq[6]+0.09938079899999068*kSq[5]+0.09938079899999068*kSq[4]+0.02666666666666666*kSq[3]+0.0769800358919501*kSq[2]-0.0769800358919501*kSq[1]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[4], globalIdxs[2], (-0.0295084445425327*kSq[7])+0.03442651863295482*kSq[6]-0.063887656499994*kSq[5]-0.05962847939999439*kSq[4]+0.05333333333333333*kSq[3]+0.03849001794597505*kSq[2]-0.8888888888888888*epsilon[0]*rdx2Sq[1]+0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[4], globalIdxs[3], 0.1135780559999893*kSq[5]+0.07950463919999252*kSq[4]+0.8888888888888888*epsilon[0]*rdx2Sq[1]-0.5333333333333333*epsilon[0]*rdx2Sq[0]-0.1777777777777778*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[4], globalIdxs[4], 0.1967229636168847*kSq[7]+0.2271561119999787*kSq[5]-0.07950463919999252*kSq[4]+1.777777777777778*epsilon[0]*rdx2Sq[1]-0.3079201435678004*kSq[1]+0.5333333333333333*epsilon[0]*rdx2Sq[0]-0.3555555555555556*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[4], globalIdxs[5], (-0.01721325931647741*kSq[7])-0.05678902799999467*kSq[5]-0.03975231959999626*kSq[4]+0.01333333333333333*kSq[3]-0.4444444444444444*epsilon[0]*rdx2Sq[1]+0.03849001794597505*kSq[1]-0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[4], globalIdxs[6], 0.03442651863295482*kSq[7]+0.03442651863295482*kSq[6]+0.09938079899999068*kSq[5]+0.09938079899999068*kSq[4]-0.02666666666666666*kSq[3]-0.0769800358919501*kSq[2]-0.0769800358919501*kSq[1]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[4], globalIdxs[7], (-0.0295084445425327*kSq[7])-0.03442651863295482*kSq[6]-0.063887656499994*kSq[5]-0.05962847939999439*kSq[4]-0.05333333333333333*kSq[3]-0.03849001794597505*kSq[2]-0.8888888888888888*epsilon[0]*rdx2Sq[1]+0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_insert(tri, globalIdxs[5], globalIdxs[0], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[5], globalIdxs[1], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[5], globalIdxs[2], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[5], globalIdxs[3], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[5], globalIdxs[4], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[5], globalIdxs[5], 1.0);
  gkyl_mat_triples_insert(tri, globalIdxs[5], globalIdxs[6], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[5], globalIdxs[7], 0.0);
  gkyl_mat_triples_accum(tri, globalIdxs[6], globalIdxs[0], (-0.01721325931647741*kSq[6])-0.03975231959999626*kSq[5]-0.05678902799999467*kSq[4]-0.01333333333333333*kSq[3]+0.03849001794597505*kSq[2]-0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.4444444444444444*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[6], globalIdxs[1], 0.07950463919999252*kSq[5]+0.1135780559999893*kSq[4]-0.5333333333333333*epsilon[0]*rdx2Sq[1]+0.8888888888888888*epsilon[0]*rdx2Sq[0]-0.1777777777777778*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[6], globalIdxs[2], (-0.01721325931647741*kSq[6])-0.03975231959999626*kSq[5]-0.05678902799999467*kSq[4]+0.01333333333333333*kSq[3]+0.03849001794597505*kSq[2]-0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.4444444444444444*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[6], globalIdxs[3], (-0.03442651863295482*kSq[7])+0.03442651863295482*kSq[6]+0.09938079899999068*kSq[5]+0.09938079899999068*kSq[4]+0.02666666666666666*kSq[3]-0.0769800358919501*kSq[2]+0.0769800358919501*kSq[1]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[6], globalIdxs[4], 0.03442651863295482*kSq[7]+0.03442651863295482*kSq[6]+0.09938079899999068*kSq[5]+0.09938079899999068*kSq[4]-0.02666666666666666*kSq[3]-0.0769800358919501*kSq[2]-0.0769800358919501*kSq[1]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[6], globalIdxs[5], 0.03442651863295482*kSq[7]-0.0295084445425327*kSq[6]-0.05962847939999439*kSq[5]-0.063887656499994*kSq[4]+0.05333333333333333*kSq[3]+0.06666666666666667*epsilon[0]*rdx2Sq[1]+0.03849001794597505*kSq[1]-0.8888888888888888*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[6], globalIdxs[6], 0.1967229636168847*kSq[6]-0.07950463919999252*kSq[5]+0.2271561119999787*kSq[4]-0.3079201435678004*kSq[2]+0.5333333333333333*epsilon[0]*rdx2Sq[1]+1.777777777777778*epsilon[0]*rdx2Sq[0]-0.3555555555555556*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[6], globalIdxs[7], (-0.03442651863295482*kSq[7])-0.0295084445425327*kSq[6]-0.05962847939999439*kSq[5]-0.063887656499994*kSq[4]-0.05333333333333333*kSq[3]+0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.03849001794597505*kSq[1]-0.8888888888888888*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[7], globalIdxs[0], 0.0234254740499978*kSq[5]+0.0234254740499978*kSq[4]+0.01333333333333333*kSq[3]+0.2555555555555555*epsilon[0]*rdx2Sq[1]+0.2555555555555555*epsilon[0]*rdx2Sq[0]-0.03333333333333333*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[7], globalIdxs[1], 0.01721325931647741*kSq[6]-0.03975231959999626*kSq[5]-0.05678902799999467*kSq[4]-0.01333333333333333*kSq[3]-0.03849001794597505*kSq[2]-0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.4444444444444444*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[7], globalIdxs[2], 0.006147592613027645*kSq[7]+0.02697478829999747*kSq[5]+0.03336355394999686*kSq[4]+0.3111111111111111*epsilon[0]*rdx2Sq[1]+0.01924500897298752*kSq[1]+0.1888888888888889*epsilon[0]*rdx2Sq[0]-0.02222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[7], globalIdxs[3], 0.01721325931647741*kSq[7]-0.05678902799999467*kSq[5]-0.03975231959999626*kSq[4]-0.01333333333333333*kSq[3]-0.4444444444444444*epsilon[0]*rdx2Sq[1]-0.03849001794597505*kSq[1]-0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[7], globalIdxs[4], (-0.0295084445425327*kSq[7])-0.03442651863295482*kSq[6]-0.063887656499994*kSq[5]-0.05962847939999439*kSq[4]-0.05333333333333333*kSq[3]-0.03849001794597505*kSq[2]-0.8888888888888888*epsilon[0]*rdx2Sq[1]+0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[7], globalIdxs[5], 0.006147592613027645*kSq[6]+0.03336355394999686*kSq[5]+0.02697478829999747*kSq[4]+0.01924500897298752*kSq[2]+0.1888888888888889*epsilon[0]*rdx2Sq[1]+0.3111111111111111*epsilon[0]*rdx2Sq[0]-0.02222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[7], globalIdxs[6], (-0.03442651863295482*kSq[7])-0.0295084445425327*kSq[6]-0.05962847939999439*kSq[5]-0.063887656499994*kSq[4]-0.05333333333333333*kSq[3]+0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.03849001794597505*kSq[1]-0.8888888888888888*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[7], globalIdxs[7], (-0.04549218533640458*kSq[7])-0.04549218533640458*kSq[6]-0.0127775312999988*kSq[5]-0.0127775312999988*kSq[4]-0.04666666666666667*kSq[3]-0.03849001794597505*kSq[2]+0.5777777777777777*epsilon[0]*rdx2Sq[1]-0.03849001794597505*kSq[1]+0.5777777777777777*epsilon[0]*rdx2Sq[0]-0.06666666666666667*kSq[0]);

}
void fem_poisson_lhs_stencil_consteps_2x_ser_p1_lox_dirichletx_upy_dirichlety(const double *epsilon, const double *kSq, const double *dx, const double *bcVals, const long *globalIdxs, gkyl_mat_triples *tri) 
{ 
  // epsilon: permittivity.
  // kSq: wave number squared (factor multiplying phi).
  // dx: cell length in each direction.
  // bcVals[3]: values to impose as BCs, i.e. bcVals[0]*phi+bcVals[1]*d(phi)/dx=bcVals[2].
  // globalIdxs: global linear index of each basis function/node in current cell.
  // tri: triples object (i,j,val), i.e. contribute val to i,j element of the global matrix.

  double rdx2Sq[2];
  rdx2Sq[0] = 4.0/(dx[0]*dx[0]);
  rdx2Sq[1] = 4.0/(dx[1]*dx[1]);

  gkyl_mat_triples_insert(tri, globalIdxs[0], globalIdxs[0], 1.0);
  gkyl_mat_triples_insert(tri, globalIdxs[0], globalIdxs[1], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[0], globalIdxs[2], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[0], globalIdxs[3], 0.0);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[0], 0.09622504486493762*kSq[2]+0.1666666666666667*epsilon[0]*rdx2Sq[1]-0.3333333333333333*epsilon[0]*rdx2Sq[0]-0.1111111111111111*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[1], 0.1666666666666667*kSq[3]+0.1924500897298752*kSq[2]+0.3333333333333333*epsilon[0]*rdx2Sq[1]-0.1924500897298752*kSq[1]+0.3333333333333333*epsilon[0]*rdx2Sq[0]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[2], (-0.1666666666666667*epsilon[0]*rdx2Sq[1])-0.1666666666666667*epsilon[0]*rdx2Sq[0]-0.05555555555555555*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[3], (-0.3333333333333333*epsilon[0]*rdx2Sq[1])-0.09622504486493762*kSq[1]+0.1666666666666667*epsilon[0]*rdx2Sq[0]-0.1111111111111111*kSq[0]);
  gkyl_mat_triples_insert(tri, globalIdxs[2], globalIdxs[0], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[2], globalIdxs[1], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[2], globalIdxs[2], 1.0);
  gkyl_mat_triples_insert(tri, globalIdxs[2], globalIdxs[3], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[3], globalIdxs[0], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[3], globalIdxs[1], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[3], globalIdxs[2], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[3], globalIdxs[3], 1.0);

}
void fem_poisson_lhs_stencil_consteps_2x_ser_p2_lox_dirichletx_upy_dirichlety(const double *epsilon, const double *kSq, const double *dx, const double *bcVals, const long *globalIdxs, gkyl_mat_triples *tri) 
{ 
  // epsilon: permittivity.
  // kSq: wave number squared (factor multiplying phi).
  // dx: cell length in each direction.
  // bcVals[3]: values to impose as BCs, i.e. bcVals[0]*phi+bcVals[1]*d(phi)/dx=bcVals[2].
  // globalIdxs: global linear index of each basis function/node in current cell.
  // tri: triples object (i,j,val), i.e. contribute val to i,j element of the global matrix.

  double rdx2Sq[2];
  rdx2Sq[0] = 4.0/(dx[0]*dx[0]);
  rdx2Sq[1] = 4.0/(dx[1]*dx[1]);

  gkyl_mat_triples_insert(tri, globalIdxs[0], globalIdxs[0], 1.0);
  gkyl_mat_triples_insert(tri, globalIdxs[0], globalIdxs[1], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[0], globalIdxs[2], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[0], globalIdxs[3], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[0], globalIdxs[4], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[0], globalIdxs[5], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[0], globalIdxs[6], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[0], globalIdxs[7], 0.0);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[0], 0.03442651863295482*kSq[7]+0.0295084445425327*kSq[6]-0.05962847939999439*kSq[5]-0.063887656499994*kSq[4]-0.05333333333333333*kSq[3]+0.06666666666666667*epsilon[0]*rdx2Sq[1]+0.03849001794597505*kSq[1]-0.8888888888888888*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[1], (-0.1967229636168847*kSq[6])-0.07950463919999252*kSq[5]+0.2271561119999787*kSq[4]+0.3079201435678004*kSq[2]+0.5333333333333333*epsilon[0]*rdx2Sq[1]+1.777777777777778*epsilon[0]*rdx2Sq[0]-0.3555555555555556*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[2], (-0.03442651863295482*kSq[7])+0.0295084445425327*kSq[6]-0.05962847939999439*kSq[5]-0.063887656499994*kSq[4]+0.05333333333333333*kSq[3]+0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.03849001794597505*kSq[1]-0.8888888888888888*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[3], (-0.03442651863295482*kSq[7])-0.03442651863295482*kSq[6]+0.09938079899999068*kSq[5]+0.09938079899999068*kSq[4]-0.02666666666666666*kSq[3]+0.0769800358919501*kSq[2]+0.0769800358919501*kSq[1]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[4], 0.03442651863295482*kSq[7]-0.03442651863295482*kSq[6]+0.09938079899999068*kSq[5]+0.09938079899999068*kSq[4]+0.02666666666666666*kSq[3]+0.0769800358919501*kSq[2]-0.0769800358919501*kSq[1]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[5], 0.01721325931647741*kSq[6]-0.03975231959999626*kSq[5]-0.05678902799999467*kSq[4]+0.01333333333333333*kSq[3]-0.03849001794597505*kSq[2]-0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.4444444444444444*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[6], 0.07950463919999252*kSq[5]+0.1135780559999893*kSq[4]-0.5333333333333333*epsilon[0]*rdx2Sq[1]+0.8888888888888888*epsilon[0]*rdx2Sq[0]-0.1777777777777778*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[7], 0.01721325931647741*kSq[6]-0.03975231959999626*kSq[5]-0.05678902799999467*kSq[4]-0.01333333333333333*kSq[3]-0.03849001794597505*kSq[2]-0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.4444444444444444*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[0], (-0.006147592613027645*kSq[6])+0.03336355394999686*kSq[5]+0.02697478829999747*kSq[4]-0.01924500897298752*kSq[2]+0.1888888888888889*epsilon[0]*rdx2Sq[1]+0.3111111111111111*epsilon[0]*rdx2Sq[0]-0.02222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[1], (-0.03442651863295482*kSq[7])+0.0295084445425327*kSq[6]-0.05962847939999439*kSq[5]-0.063887656499994*kSq[4]+0.05333333333333333*kSq[3]+0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.03849001794597505*kSq[1]-0.8888888888888888*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[2], (-0.04549218533640458*kSq[7])+0.04549218533640458*kSq[6]-0.0127775312999988*kSq[5]-0.0127775312999988*kSq[4]+0.04666666666666667*kSq[3]+0.03849001794597505*kSq[2]+0.5777777777777777*epsilon[0]*rdx2Sq[1]-0.03849001794597505*kSq[1]+0.5777777777777777*epsilon[0]*rdx2Sq[0]-0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[3], 0.01721325931647741*kSq[7]-0.05678902799999467*kSq[5]-0.03975231959999626*kSq[4]+0.01333333333333333*kSq[3]-0.4444444444444444*epsilon[0]*rdx2Sq[1]-0.03849001794597505*kSq[1]-0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[4], (-0.0295084445425327*kSq[7])+0.03442651863295482*kSq[6]-0.063887656499994*kSq[5]-0.05962847939999439*kSq[4]+0.05333333333333333*kSq[3]+0.03849001794597505*kSq[2]-0.8888888888888888*epsilon[0]*rdx2Sq[1]+0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[5], 0.0234254740499978*kSq[5]+0.0234254740499978*kSq[4]-0.01333333333333333*kSq[3]+0.2555555555555555*epsilon[0]*rdx2Sq[1]+0.2555555555555555*epsilon[0]*rdx2Sq[0]-0.03333333333333333*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[6], (-0.01721325931647741*kSq[6])-0.03975231959999626*kSq[5]-0.05678902799999467*kSq[4]+0.01333333333333333*kSq[3]+0.03849001794597505*kSq[2]-0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.4444444444444444*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[7], 0.006147592613027645*kSq[7]+0.02697478829999747*kSq[5]+0.03336355394999686*kSq[4]+0.3111111111111111*epsilon[0]*rdx2Sq[1]+0.01924500897298752*kSq[1]+0.1888888888888889*epsilon[0]*rdx2Sq[0]-0.02222222222222222*kSq[0]);
  gkyl_mat_triples_insert(tri, globalIdxs[3], globalIdxs[0], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[3], globalIdxs[1], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[3], globalIdxs[2], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[3], globalIdxs[3], 1.0);
  gkyl_mat_triples_insert(tri, globalIdxs[3], globalIdxs[4], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[3], globalIdxs[5], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[3], globalIdxs[6], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[3], globalIdxs[7], 0.0);
  gkyl_mat_triples_accum(tri, globalIdxs[4], globalIdxs[0], (-0.01721325931647741*kSq[7])-0.05678902799999467*kSq[5]-0.03975231959999626*kSq[4]-0.01333333333333333*kSq[3]-0.4444444444444444*epsilon[0]*rdx2Sq[1]+0.03849001794597505*kSq[1]-0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[4], globalIdxs[1], 0.03442651863295482*kSq[7]-0.03442651863295482*kSq[6]+0.09938079899999068*kSq[5]+0.09938079899999068*kSq[4]+0.02666666666666666*kSq[3]+0.0769800358919501*kSq[2]-0.0769800358919501*kSq[1]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[4], globalIdxs[2], (-0.0295084445425327*kSq[7])+0.03442651863295482*kSq[6]-0.063887656499994*kSq[5]-0.05962847939999439*kSq[4]+0.05333333333333333*kSq[3]+0.03849001794597505*kSq[2]-0.8888888888888888*epsilon[0]*rdx2Sq[1]+0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[4], globalIdxs[3], 0.1135780559999893*kSq[5]+0.07950463919999252*kSq[4]+0.8888888888888888*epsilon[0]*rdx2Sq[1]-0.5333333333333333*epsilon[0]*rdx2Sq[0]-0.1777777777777778*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[4], globalIdxs[4], 0.1967229636168847*kSq[7]+0.2271561119999787*kSq[5]-0.07950463919999252*kSq[4]+1.777777777777778*epsilon[0]*rdx2Sq[1]-0.3079201435678004*kSq[1]+0.5333333333333333*epsilon[0]*rdx2Sq[0]-0.3555555555555556*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[4], globalIdxs[5], (-0.01721325931647741*kSq[7])-0.05678902799999467*kSq[5]-0.03975231959999626*kSq[4]+0.01333333333333333*kSq[3]-0.4444444444444444*epsilon[0]*rdx2Sq[1]+0.03849001794597505*kSq[1]-0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[4], globalIdxs[6], 0.03442651863295482*kSq[7]+0.03442651863295482*kSq[6]+0.09938079899999068*kSq[5]+0.09938079899999068*kSq[4]-0.02666666666666666*kSq[3]-0.0769800358919501*kSq[2]-0.0769800358919501*kSq[1]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[4], globalIdxs[7], (-0.0295084445425327*kSq[7])-0.03442651863295482*kSq[6]-0.063887656499994*kSq[5]-0.05962847939999439*kSq[4]-0.05333333333333333*kSq[3]-0.03849001794597505*kSq[2]-0.8888888888888888*epsilon[0]*rdx2Sq[1]+0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_insert(tri, globalIdxs[5], globalIdxs[0], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[5], globalIdxs[1], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[5], globalIdxs[2], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[5], globalIdxs[3], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[5], globalIdxs[4], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[5], globalIdxs[5], 1.0);
  gkyl_mat_triples_insert(tri, globalIdxs[5], globalIdxs[6], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[5], globalIdxs[7], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[6], globalIdxs[0], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[6], globalIdxs[1], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[6], globalIdxs[2], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[6], globalIdxs[3], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[6], globalIdxs[4], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[6], globalIdxs[5], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[6], globalIdxs[6], 1.0);
  gkyl_mat_triples_insert(tri, globalIdxs[6], globalIdxs[7], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[7], globalIdxs[0], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[7], globalIdxs[1], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[7], globalIdxs[2], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[7], globalIdxs[3], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[7], globalIdxs[4], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[7], globalIdxs[5], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[7], globalIdxs[6], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[7], globalIdxs[7], 1.0);

}
void fem_poisson_lhs_stencil_consteps_2x_ser_p1_lox_dirichletx_upy_neumanny(const double *epsilon, const double *kSq, const double *dx, const double *bcVals, const long *globalIdxs, gkyl_mat_triples *tri) 
{ 
  // epsilon: permittivity.
  // kSq: wave number squared (factor multiplying phi).
  // dx: cell length in each direction.
  // bcVals[3]: values to impose as BCs, i.e. bcVals[0]*phi+bcVals[1]*d(phi)/dx=bcVals[2].
  // globalIdxs: global linear index of each basis function/node in current cell.
  // tri: triples object (i,j,val), i.e. contribute val to i,j element of the global matrix.

  double rdx2Sq[2];
  rdx2Sq[0] = 4.0/(dx[0]*dx[0]);
  rdx2Sq[1] = 4.0/(dx[1]*dx[1]);

  gkyl_mat_triples_insert(tri, globalIdxs[0], globalIdxs[0], 1.0);
  gkyl_mat_triples_insert(tri, globalIdxs[0], globalIdxs[1], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[0], globalIdxs[2], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[0], globalIdxs[3], 0.0);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[0], 0.09622504486493762*kSq[2]+0.1666666666666667*epsilon[0]*rdx2Sq[1]-0.3333333333333333*epsilon[0]*rdx2Sq[0]-0.1111111111111111*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[1], 0.1666666666666667*kSq[3]+0.1924500897298752*kSq[2]+0.3333333333333333*epsilon[0]*rdx2Sq[1]-0.1924500897298752*kSq[1]+0.3333333333333333*epsilon[0]*rdx2Sq[0]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[2], (-0.1666666666666667*epsilon[0]*rdx2Sq[1])-0.1666666666666667*epsilon[0]*rdx2Sq[0]-0.05555555555555555*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[3], (-0.3333333333333333*epsilon[0]*rdx2Sq[1])-0.09622504486493762*kSq[1]+0.1666666666666667*epsilon[0]*rdx2Sq[0]-0.1111111111111111*kSq[0]);
  gkyl_mat_triples_insert(tri, globalIdxs[2], globalIdxs[0], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[2], globalIdxs[1], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[2], globalIdxs[2], 1.0);
  gkyl_mat_triples_insert(tri, globalIdxs[2], globalIdxs[3], 0.0);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[0], (-0.1666666666666667*epsilon[0]*rdx2Sq[1])-0.1666666666666667*epsilon[0]*rdx2Sq[0]-0.05555555555555555*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[1], (-0.3333333333333333*epsilon[0]*rdx2Sq[1])-0.09622504486493762*kSq[1]+0.1666666666666667*epsilon[0]*rdx2Sq[0]-0.1111111111111111*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[2], (-0.09622504486493762*kSq[2])+0.1666666666666667*epsilon[0]*rdx2Sq[1]-0.3333333333333333*epsilon[0]*rdx2Sq[0]-0.1111111111111111*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[3], (-0.1666666666666667*kSq[3])-0.1924500897298752*kSq[2]+0.3333333333333333*epsilon[0]*rdx2Sq[1]-0.1924500897298752*kSq[1]+0.3333333333333333*epsilon[0]*rdx2Sq[0]-0.2222222222222222*kSq[0]);

}
void fem_poisson_lhs_stencil_consteps_2x_ser_p2_lox_dirichletx_upy_neumanny(const double *epsilon, const double *kSq, const double *dx, const double *bcVals, const long *globalIdxs, gkyl_mat_triples *tri) 
{ 
  // epsilon: permittivity.
  // kSq: wave number squared (factor multiplying phi).
  // dx: cell length in each direction.
  // bcVals[3]: values to impose as BCs, i.e. bcVals[0]*phi+bcVals[1]*d(phi)/dx=bcVals[2].
  // globalIdxs: global linear index of each basis function/node in current cell.
  // tri: triples object (i,j,val), i.e. contribute val to i,j element of the global matrix.

  double rdx2Sq[2];
  rdx2Sq[0] = 4.0/(dx[0]*dx[0]);
  rdx2Sq[1] = 4.0/(dx[1]*dx[1]);

  gkyl_mat_triples_insert(tri, globalIdxs[0], globalIdxs[0], 1.0);
  gkyl_mat_triples_insert(tri, globalIdxs[0], globalIdxs[1], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[0], globalIdxs[2], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[0], globalIdxs[3], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[0], globalIdxs[4], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[0], globalIdxs[5], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[0], globalIdxs[6], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[0], globalIdxs[7], 0.0);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[0], 0.03442651863295482*kSq[7]+0.0295084445425327*kSq[6]-0.05962847939999439*kSq[5]-0.063887656499994*kSq[4]-0.05333333333333333*kSq[3]+0.06666666666666667*epsilon[0]*rdx2Sq[1]+0.03849001794597505*kSq[1]-0.8888888888888888*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[1], (-0.1967229636168847*kSq[6])-0.07950463919999252*kSq[5]+0.2271561119999787*kSq[4]+0.3079201435678004*kSq[2]+0.5333333333333333*epsilon[0]*rdx2Sq[1]+1.777777777777778*epsilon[0]*rdx2Sq[0]-0.3555555555555556*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[2], (-0.03442651863295482*kSq[7])+0.0295084445425327*kSq[6]-0.05962847939999439*kSq[5]-0.063887656499994*kSq[4]+0.05333333333333333*kSq[3]+0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.03849001794597505*kSq[1]-0.8888888888888888*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[3], (-0.03442651863295482*kSq[7])-0.03442651863295482*kSq[6]+0.09938079899999068*kSq[5]+0.09938079899999068*kSq[4]-0.02666666666666666*kSq[3]+0.0769800358919501*kSq[2]+0.0769800358919501*kSq[1]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[4], 0.03442651863295482*kSq[7]-0.03442651863295482*kSq[6]+0.09938079899999068*kSq[5]+0.09938079899999068*kSq[4]+0.02666666666666666*kSq[3]+0.0769800358919501*kSq[2]-0.0769800358919501*kSq[1]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[5], 0.01721325931647741*kSq[6]-0.03975231959999626*kSq[5]-0.05678902799999467*kSq[4]+0.01333333333333333*kSq[3]-0.03849001794597505*kSq[2]-0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.4444444444444444*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[6], 0.07950463919999252*kSq[5]+0.1135780559999893*kSq[4]-0.5333333333333333*epsilon[0]*rdx2Sq[1]+0.8888888888888888*epsilon[0]*rdx2Sq[0]-0.1777777777777778*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[7], 0.01721325931647741*kSq[6]-0.03975231959999626*kSq[5]-0.05678902799999467*kSq[4]-0.01333333333333333*kSq[3]-0.03849001794597505*kSq[2]-0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.4444444444444444*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[0], (-0.006147592613027645*kSq[6])+0.03336355394999686*kSq[5]+0.02697478829999747*kSq[4]-0.01924500897298752*kSq[2]+0.1888888888888889*epsilon[0]*rdx2Sq[1]+0.3111111111111111*epsilon[0]*rdx2Sq[0]-0.02222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[1], (-0.03442651863295482*kSq[7])+0.0295084445425327*kSq[6]-0.05962847939999439*kSq[5]-0.063887656499994*kSq[4]+0.05333333333333333*kSq[3]+0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.03849001794597505*kSq[1]-0.8888888888888888*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[2], (-0.04549218533640458*kSq[7])+0.04549218533640458*kSq[6]-0.0127775312999988*kSq[5]-0.0127775312999988*kSq[4]+0.04666666666666667*kSq[3]+0.03849001794597505*kSq[2]+0.5777777777777777*epsilon[0]*rdx2Sq[1]-0.03849001794597505*kSq[1]+0.5777777777777777*epsilon[0]*rdx2Sq[0]-0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[3], 0.01721325931647741*kSq[7]-0.05678902799999467*kSq[5]-0.03975231959999626*kSq[4]+0.01333333333333333*kSq[3]-0.4444444444444444*epsilon[0]*rdx2Sq[1]-0.03849001794597505*kSq[1]-0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[4], (-0.0295084445425327*kSq[7])+0.03442651863295482*kSq[6]-0.063887656499994*kSq[5]-0.05962847939999439*kSq[4]+0.05333333333333333*kSq[3]+0.03849001794597505*kSq[2]-0.8888888888888888*epsilon[0]*rdx2Sq[1]+0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[5], 0.0234254740499978*kSq[5]+0.0234254740499978*kSq[4]-0.01333333333333333*kSq[3]+0.2555555555555555*epsilon[0]*rdx2Sq[1]+0.2555555555555555*epsilon[0]*rdx2Sq[0]-0.03333333333333333*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[6], (-0.01721325931647741*kSq[6])-0.03975231959999626*kSq[5]-0.05678902799999467*kSq[4]+0.01333333333333333*kSq[3]+0.03849001794597505*kSq[2]-0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.4444444444444444*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[7], 0.006147592613027645*kSq[7]+0.02697478829999747*kSq[5]+0.03336355394999686*kSq[4]+0.3111111111111111*epsilon[0]*rdx2Sq[1]+0.01924500897298752*kSq[1]+0.1888888888888889*epsilon[0]*rdx2Sq[0]-0.02222222222222222*kSq[0]);
  gkyl_mat_triples_insert(tri, globalIdxs[3], globalIdxs[0], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[3], globalIdxs[1], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[3], globalIdxs[2], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[3], globalIdxs[3], 1.0);
  gkyl_mat_triples_insert(tri, globalIdxs[3], globalIdxs[4], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[3], globalIdxs[5], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[3], globalIdxs[6], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[3], globalIdxs[7], 0.0);
  gkyl_mat_triples_accum(tri, globalIdxs[4], globalIdxs[0], (-0.01721325931647741*kSq[7])-0.05678902799999467*kSq[5]-0.03975231959999626*kSq[4]-0.01333333333333333*kSq[3]-0.4444444444444444*epsilon[0]*rdx2Sq[1]+0.03849001794597505*kSq[1]-0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[4], globalIdxs[1], 0.03442651863295482*kSq[7]-0.03442651863295482*kSq[6]+0.09938079899999068*kSq[5]+0.09938079899999068*kSq[4]+0.02666666666666666*kSq[3]+0.0769800358919501*kSq[2]-0.0769800358919501*kSq[1]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[4], globalIdxs[2], (-0.0295084445425327*kSq[7])+0.03442651863295482*kSq[6]-0.063887656499994*kSq[5]-0.05962847939999439*kSq[4]+0.05333333333333333*kSq[3]+0.03849001794597505*kSq[2]-0.8888888888888888*epsilon[0]*rdx2Sq[1]+0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[4], globalIdxs[3], 0.1135780559999893*kSq[5]+0.07950463919999252*kSq[4]+0.8888888888888888*epsilon[0]*rdx2Sq[1]-0.5333333333333333*epsilon[0]*rdx2Sq[0]-0.1777777777777778*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[4], globalIdxs[4], 0.1967229636168847*kSq[7]+0.2271561119999787*kSq[5]-0.07950463919999252*kSq[4]+1.777777777777778*epsilon[0]*rdx2Sq[1]-0.3079201435678004*kSq[1]+0.5333333333333333*epsilon[0]*rdx2Sq[0]-0.3555555555555556*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[4], globalIdxs[5], (-0.01721325931647741*kSq[7])-0.05678902799999467*kSq[5]-0.03975231959999626*kSq[4]+0.01333333333333333*kSq[3]-0.4444444444444444*epsilon[0]*rdx2Sq[1]+0.03849001794597505*kSq[1]-0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[4], globalIdxs[6], 0.03442651863295482*kSq[7]+0.03442651863295482*kSq[6]+0.09938079899999068*kSq[5]+0.09938079899999068*kSq[4]-0.02666666666666666*kSq[3]-0.0769800358919501*kSq[2]-0.0769800358919501*kSq[1]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[4], globalIdxs[7], (-0.0295084445425327*kSq[7])-0.03442651863295482*kSq[6]-0.063887656499994*kSq[5]-0.05962847939999439*kSq[4]-0.05333333333333333*kSq[3]-0.03849001794597505*kSq[2]-0.8888888888888888*epsilon[0]*rdx2Sq[1]+0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_insert(tri, globalIdxs[5], globalIdxs[0], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[5], globalIdxs[1], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[5], globalIdxs[2], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[5], globalIdxs[3], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[5], globalIdxs[4], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[5], globalIdxs[5], 1.0);
  gkyl_mat_triples_insert(tri, globalIdxs[5], globalIdxs[6], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[5], globalIdxs[7], 0.0);
  gkyl_mat_triples_accum(tri, globalIdxs[6], globalIdxs[0], (-0.01721325931647741*kSq[6])-0.03975231959999626*kSq[5]-0.05678902799999467*kSq[4]-0.01333333333333333*kSq[3]+0.03849001794597505*kSq[2]-0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.4444444444444444*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[6], globalIdxs[1], 0.07950463919999252*kSq[5]+0.1135780559999893*kSq[4]-0.5333333333333333*epsilon[0]*rdx2Sq[1]+0.8888888888888888*epsilon[0]*rdx2Sq[0]-0.1777777777777778*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[6], globalIdxs[2], (-0.01721325931647741*kSq[6])-0.03975231959999626*kSq[5]-0.05678902799999467*kSq[4]+0.01333333333333333*kSq[3]+0.03849001794597505*kSq[2]-0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.4444444444444444*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[6], globalIdxs[3], (-0.03442651863295482*kSq[7])+0.03442651863295482*kSq[6]+0.09938079899999068*kSq[5]+0.09938079899999068*kSq[4]+0.02666666666666666*kSq[3]-0.0769800358919501*kSq[2]+0.0769800358919501*kSq[1]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[6], globalIdxs[4], 0.03442651863295482*kSq[7]+0.03442651863295482*kSq[6]+0.09938079899999068*kSq[5]+0.09938079899999068*kSq[4]-0.02666666666666666*kSq[3]-0.0769800358919501*kSq[2]-0.0769800358919501*kSq[1]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[6], globalIdxs[5], 0.03442651863295482*kSq[7]-0.0295084445425327*kSq[6]-0.05962847939999439*kSq[5]-0.063887656499994*kSq[4]+0.05333333333333333*kSq[3]+0.06666666666666667*epsilon[0]*rdx2Sq[1]+0.03849001794597505*kSq[1]-0.8888888888888888*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[6], globalIdxs[6], 0.1967229636168847*kSq[6]-0.07950463919999252*kSq[5]+0.2271561119999787*kSq[4]-0.3079201435678004*kSq[2]+0.5333333333333333*epsilon[0]*rdx2Sq[1]+1.777777777777778*epsilon[0]*rdx2Sq[0]-0.3555555555555556*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[6], globalIdxs[7], (-0.03442651863295482*kSq[7])-0.0295084445425327*kSq[6]-0.05962847939999439*kSq[5]-0.063887656499994*kSq[4]-0.05333333333333333*kSq[3]+0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.03849001794597505*kSq[1]-0.8888888888888888*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[7], globalIdxs[0], 0.0234254740499978*kSq[5]+0.0234254740499978*kSq[4]+0.01333333333333333*kSq[3]+0.2555555555555555*epsilon[0]*rdx2Sq[1]+0.2555555555555555*epsilon[0]*rdx2Sq[0]-0.03333333333333333*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[7], globalIdxs[1], 0.01721325931647741*kSq[6]-0.03975231959999626*kSq[5]-0.05678902799999467*kSq[4]-0.01333333333333333*kSq[3]-0.03849001794597505*kSq[2]-0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.4444444444444444*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[7], globalIdxs[2], 0.006147592613027645*kSq[7]+0.02697478829999747*kSq[5]+0.03336355394999686*kSq[4]+0.3111111111111111*epsilon[0]*rdx2Sq[1]+0.01924500897298752*kSq[1]+0.1888888888888889*epsilon[0]*rdx2Sq[0]-0.02222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[7], globalIdxs[3], 0.01721325931647741*kSq[7]-0.05678902799999467*kSq[5]-0.03975231959999626*kSq[4]-0.01333333333333333*kSq[3]-0.4444444444444444*epsilon[0]*rdx2Sq[1]-0.03849001794597505*kSq[1]-0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[7], globalIdxs[4], (-0.0295084445425327*kSq[7])-0.03442651863295482*kSq[6]-0.063887656499994*kSq[5]-0.05962847939999439*kSq[4]-0.05333333333333333*kSq[3]-0.03849001794597505*kSq[2]-0.8888888888888888*epsilon[0]*rdx2Sq[1]+0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[7], globalIdxs[5], 0.006147592613027645*kSq[6]+0.03336355394999686*kSq[5]+0.02697478829999747*kSq[4]+0.01924500897298752*kSq[2]+0.1888888888888889*epsilon[0]*rdx2Sq[1]+0.3111111111111111*epsilon[0]*rdx2Sq[0]-0.02222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[7], globalIdxs[6], (-0.03442651863295482*kSq[7])-0.0295084445425327*kSq[6]-0.05962847939999439*kSq[5]-0.063887656499994*kSq[4]-0.05333333333333333*kSq[3]+0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.03849001794597505*kSq[1]-0.8888888888888888*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[7], globalIdxs[7], (-0.04549218533640458*kSq[7])-0.04549218533640458*kSq[6]-0.0127775312999988*kSq[5]-0.0127775312999988*kSq[4]-0.04666666666666667*kSq[3]-0.03849001794597505*kSq[2]+0.5777777777777777*epsilon[0]*rdx2Sq[1]-0.03849001794597505*kSq[1]+0.5777777777777777*epsilon[0]*rdx2Sq[0]-0.06666666666666667*kSq[0]);

}
void fem_poisson_lhs_stencil_consteps_2x_ser_p1_lox_dirichletx_upy_robiny(const double *epsilon, const double *kSq, const double *dx, const double *bcVals, const long *globalIdxs, gkyl_mat_triples *tri) 
{ 
  // epsilon: permittivity.
  // kSq: wave number squared (factor multiplying phi).
  // dx: cell length in each direction.
  // bcVals[3]: values to impose as BCs, i.e. bcVals[0]*phi+bcVals[1]*d(phi)/dx=bcVals[2].
  // globalIdxs: global linear index of each basis function/node in current cell.
  // tri: triples object (i,j,val), i.e. contribute val to i,j element of the global matrix.

  double rdx2Sq[2];
  rdx2Sq[0] = 4.0/(dx[0]*dx[0]);
  rdx2Sq[1] = 4.0/(dx[1]*dx[1]);

  gkyl_mat_triples_insert(tri, globalIdxs[0], globalIdxs[0], 1.0);
  gkyl_mat_triples_insert(tri, globalIdxs[0], globalIdxs[1], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[0], globalIdxs[2], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[0], globalIdxs[3], 0.0);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[0], 0.09622504486493762*kSq[2]+0.1666666666666667*epsilon[0]*rdx2Sq[1]-0.3333333333333333*epsilon[0]*rdx2Sq[0]-0.1111111111111111*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[1], 0.1666666666666667*kSq[3]+0.1924500897298752*kSq[2]+0.3333333333333333*epsilon[0]*rdx2Sq[1]-0.1924500897298752*kSq[1]+0.3333333333333333*epsilon[0]*rdx2Sq[0]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[2], (-0.1666666666666667*epsilon[0]*rdx2Sq[1])-0.1666666666666667*epsilon[0]*rdx2Sq[0]-0.05555555555555555*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[3], (-0.3333333333333333*epsilon[0]*rdx2Sq[1])-0.09622504486493762*kSq[1]+0.1666666666666667*epsilon[0]*rdx2Sq[0]-0.1111111111111111*kSq[0]);
  gkyl_mat_triples_insert(tri, globalIdxs[2], globalIdxs[0], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[2], globalIdxs[1], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[2], globalIdxs[2], 1.0);
  gkyl_mat_triples_insert(tri, globalIdxs[2], globalIdxs[3], 0.0);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[0], (-0.1666666666666667*epsilon[0]*rdx2Sq[1])-0.1666666666666667*epsilon[0]*rdx2Sq[0]-0.05555555555555555*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[1], (-0.3333333333333333*epsilon[0]*rdx2Sq[1])-0.09622504486493762*kSq[1]+0.1666666666666667*epsilon[0]*rdx2Sq[0]-0.1111111111111111*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[2], (0.3333333333333333*epsilon[0]*rdx2Sq[1]*bcVals[9])/bcVals[10]-0.09622504486493762*kSq[2]+0.1666666666666667*epsilon[0]*rdx2Sq[1]-0.3333333333333333*epsilon[0]*rdx2Sq[0]-0.1111111111111111*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[3], (0.6666666666666666*epsilon[0]*rdx2Sq[1]*bcVals[9])/bcVals[10]-0.1666666666666667*kSq[3]-0.1924500897298752*kSq[2]+0.3333333333333333*epsilon[0]*rdx2Sq[1]-0.1924500897298752*kSq[1]+0.3333333333333333*epsilon[0]*rdx2Sq[0]-0.2222222222222222*kSq[0]);

}
void fem_poisson_lhs_stencil_consteps_2x_ser_p2_lox_dirichletx_upy_robiny(const double *epsilon, const double *kSq, const double *dx, const double *bcVals, const long *globalIdxs, gkyl_mat_triples *tri) 
{ 
  // epsilon: permittivity.
  // kSq: wave number squared (factor multiplying phi).
  // dx: cell length in each direction.
  // bcVals[3]: values to impose as BCs, i.e. bcVals[0]*phi+bcVals[1]*d(phi)/dx=bcVals[2].
  // globalIdxs: global linear index of each basis function/node in current cell.
  // tri: triples object (i,j,val), i.e. contribute val to i,j element of the global matrix.

  double rdx2Sq[2];
  rdx2Sq[0] = 4.0/(dx[0]*dx[0]);
  rdx2Sq[1] = 4.0/(dx[1]*dx[1]);

  gkyl_mat_triples_insert(tri, globalIdxs[0], globalIdxs[0], 1.0);
  gkyl_mat_triples_insert(tri, globalIdxs[0], globalIdxs[1], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[0], globalIdxs[2], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[0], globalIdxs[3], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[0], globalIdxs[4], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[0], globalIdxs[5], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[0], globalIdxs[6], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[0], globalIdxs[7], 0.0);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[0], 0.03442651863295482*kSq[7]+0.0295084445425327*kSq[6]-0.05962847939999439*kSq[5]-0.063887656499994*kSq[4]-0.05333333333333333*kSq[3]+0.06666666666666667*epsilon[0]*rdx2Sq[1]+0.03849001794597505*kSq[1]-0.8888888888888888*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[1], (-0.1967229636168847*kSq[6])-0.07950463919999252*kSq[5]+0.2271561119999787*kSq[4]+0.3079201435678004*kSq[2]+0.5333333333333333*epsilon[0]*rdx2Sq[1]+1.777777777777778*epsilon[0]*rdx2Sq[0]-0.3555555555555556*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[2], (-0.03442651863295482*kSq[7])+0.0295084445425327*kSq[6]-0.05962847939999439*kSq[5]-0.063887656499994*kSq[4]+0.05333333333333333*kSq[3]+0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.03849001794597505*kSq[1]-0.8888888888888888*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[3], (-0.03442651863295482*kSq[7])-0.03442651863295482*kSq[6]+0.09938079899999068*kSq[5]+0.09938079899999068*kSq[4]-0.02666666666666666*kSq[3]+0.0769800358919501*kSq[2]+0.0769800358919501*kSq[1]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[4], 0.03442651863295482*kSq[7]-0.03442651863295482*kSq[6]+0.09938079899999068*kSq[5]+0.09938079899999068*kSq[4]+0.02666666666666666*kSq[3]+0.0769800358919501*kSq[2]-0.0769800358919501*kSq[1]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[5], 0.01721325931647741*kSq[6]-0.03975231959999626*kSq[5]-0.05678902799999467*kSq[4]+0.01333333333333333*kSq[3]-0.03849001794597505*kSq[2]-0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.4444444444444444*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[6], 0.07950463919999252*kSq[5]+0.1135780559999893*kSq[4]-0.5333333333333333*epsilon[0]*rdx2Sq[1]+0.8888888888888888*epsilon[0]*rdx2Sq[0]-0.1777777777777778*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[7], 0.01721325931647741*kSq[6]-0.03975231959999626*kSq[5]-0.05678902799999467*kSq[4]-0.01333333333333333*kSq[3]-0.03849001794597505*kSq[2]-0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.4444444444444444*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[0], (-0.006147592613027645*kSq[6])+0.03336355394999686*kSq[5]+0.02697478829999747*kSq[4]-0.01924500897298752*kSq[2]+0.1888888888888889*epsilon[0]*rdx2Sq[1]+0.3111111111111111*epsilon[0]*rdx2Sq[0]-0.02222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[1], (-0.03442651863295482*kSq[7])+0.0295084445425327*kSq[6]-0.05962847939999439*kSq[5]-0.063887656499994*kSq[4]+0.05333333333333333*kSq[3]+0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.03849001794597505*kSq[1]-0.8888888888888888*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[2], (-0.04549218533640458*kSq[7])+0.04549218533640458*kSq[6]-0.0127775312999988*kSq[5]-0.0127775312999988*kSq[4]+0.04666666666666667*kSq[3]+0.03849001794597505*kSq[2]+0.5777777777777777*epsilon[0]*rdx2Sq[1]-0.03849001794597505*kSq[1]+0.5777777777777777*epsilon[0]*rdx2Sq[0]-0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[3], 0.01721325931647741*kSq[7]-0.05678902799999467*kSq[5]-0.03975231959999626*kSq[4]+0.01333333333333333*kSq[3]-0.4444444444444444*epsilon[0]*rdx2Sq[1]-0.03849001794597505*kSq[1]-0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[4], (-0.0295084445425327*kSq[7])+0.03442651863295482*kSq[6]-0.063887656499994*kSq[5]-0.05962847939999439*kSq[4]+0.05333333333333333*kSq[3]+0.03849001794597505*kSq[2]-0.8888888888888888*epsilon[0]*rdx2Sq[1]+0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[5], 0.0234254740499978*kSq[5]+0.0234254740499978*kSq[4]-0.01333333333333333*kSq[3]+0.2555555555555555*epsilon[0]*rdx2Sq[1]+0.2555555555555555*epsilon[0]*rdx2Sq[0]-0.03333333333333333*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[6], (-0.01721325931647741*kSq[6])-0.03975231959999626*kSq[5]-0.05678902799999467*kSq[4]+0.01333333333333333*kSq[3]+0.03849001794597505*kSq[2]-0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.4444444444444444*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[7], 0.006147592613027645*kSq[7]+0.02697478829999747*kSq[5]+0.03336355394999686*kSq[4]+0.3111111111111111*epsilon[0]*rdx2Sq[1]+0.01924500897298752*kSq[1]+0.1888888888888889*epsilon[0]*rdx2Sq[0]-0.02222222222222222*kSq[0]);
  gkyl_mat_triples_insert(tri, globalIdxs[3], globalIdxs[0], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[3], globalIdxs[1], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[3], globalIdxs[2], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[3], globalIdxs[3], 1.0);
  gkyl_mat_triples_insert(tri, globalIdxs[3], globalIdxs[4], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[3], globalIdxs[5], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[3], globalIdxs[6], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[3], globalIdxs[7], 0.0);
  gkyl_mat_triples_accum(tri, globalIdxs[4], globalIdxs[0], (-0.01721325931647741*kSq[7])-0.05678902799999467*kSq[5]-0.03975231959999626*kSq[4]-0.01333333333333333*kSq[3]-0.4444444444444444*epsilon[0]*rdx2Sq[1]+0.03849001794597505*kSq[1]-0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[4], globalIdxs[1], 0.03442651863295482*kSq[7]-0.03442651863295482*kSq[6]+0.09938079899999068*kSq[5]+0.09938079899999068*kSq[4]+0.02666666666666666*kSq[3]+0.0769800358919501*kSq[2]-0.0769800358919501*kSq[1]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[4], globalIdxs[2], (-0.0295084445425327*kSq[7])+0.03442651863295482*kSq[6]-0.063887656499994*kSq[5]-0.05962847939999439*kSq[4]+0.05333333333333333*kSq[3]+0.03849001794597505*kSq[2]-0.8888888888888888*epsilon[0]*rdx2Sq[1]+0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[4], globalIdxs[3], 0.1135780559999893*kSq[5]+0.07950463919999252*kSq[4]+0.8888888888888888*epsilon[0]*rdx2Sq[1]-0.5333333333333333*epsilon[0]*rdx2Sq[0]-0.1777777777777778*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[4], globalIdxs[4], 0.1967229636168847*kSq[7]+0.2271561119999787*kSq[5]-0.07950463919999252*kSq[4]+1.777777777777778*epsilon[0]*rdx2Sq[1]-0.3079201435678004*kSq[1]+0.5333333333333333*epsilon[0]*rdx2Sq[0]-0.3555555555555556*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[4], globalIdxs[5], (-0.01721325931647741*kSq[7])-0.05678902799999467*kSq[5]-0.03975231959999626*kSq[4]+0.01333333333333333*kSq[3]-0.4444444444444444*epsilon[0]*rdx2Sq[1]+0.03849001794597505*kSq[1]-0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[4], globalIdxs[6], 0.03442651863295482*kSq[7]+0.03442651863295482*kSq[6]+0.09938079899999068*kSq[5]+0.09938079899999068*kSq[4]-0.02666666666666666*kSq[3]-0.0769800358919501*kSq[2]-0.0769800358919501*kSq[1]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[4], globalIdxs[7], (-0.0295084445425327*kSq[7])-0.03442651863295482*kSq[6]-0.063887656499994*kSq[5]-0.05962847939999439*kSq[4]-0.05333333333333333*kSq[3]-0.03849001794597505*kSq[2]-0.8888888888888888*epsilon[0]*rdx2Sq[1]+0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_insert(tri, globalIdxs[5], globalIdxs[0], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[5], globalIdxs[1], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[5], globalIdxs[2], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[5], globalIdxs[3], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[5], globalIdxs[4], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[5], globalIdxs[5], 1.0);
  gkyl_mat_triples_insert(tri, globalIdxs[5], globalIdxs[6], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[5], globalIdxs[7], 0.0);
  gkyl_mat_triples_accum(tri, globalIdxs[6], globalIdxs[0], (-0.01721325931647741*kSq[6])-0.03975231959999626*kSq[5]-0.05678902799999467*kSq[4]-0.01333333333333333*kSq[3]+0.03849001794597505*kSq[2]-0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.4444444444444444*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[6], globalIdxs[1], 0.07950463919999252*kSq[5]+0.1135780559999893*kSq[4]-0.5333333333333333*epsilon[0]*rdx2Sq[1]+0.8888888888888888*epsilon[0]*rdx2Sq[0]-0.1777777777777778*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[6], globalIdxs[2], (-0.01721325931647741*kSq[6])-0.03975231959999626*kSq[5]-0.05678902799999467*kSq[4]+0.01333333333333333*kSq[3]+0.03849001794597505*kSq[2]-0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.4444444444444444*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[6], globalIdxs[3], (-0.03442651863295482*kSq[7])+0.03442651863295482*kSq[6]+0.09938079899999068*kSq[5]+0.09938079899999068*kSq[4]+0.02666666666666666*kSq[3]-0.0769800358919501*kSq[2]+0.0769800358919501*kSq[1]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[6], globalIdxs[4], 0.03442651863295482*kSq[7]+0.03442651863295482*kSq[6]+0.09938079899999068*kSq[5]+0.09938079899999068*kSq[4]-0.02666666666666666*kSq[3]-0.0769800358919501*kSq[2]-0.0769800358919501*kSq[1]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[6], globalIdxs[5], (0.1333333333333333*epsilon[0]*rdx2Sq[1]*bcVals[9])/bcVals[10]+0.03442651863295482*kSq[7]-0.0295084445425327*kSq[6]-0.05962847939999439*kSq[5]-0.063887656499994*kSq[4]+0.05333333333333333*kSq[3]+0.06666666666666667*epsilon[0]*rdx2Sq[1]+0.03849001794597505*kSq[1]-0.8888888888888888*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[6], globalIdxs[6], (1.066666666666667*epsilon[0]*rdx2Sq[1]*bcVals[9])/bcVals[10]+0.1967229636168847*kSq[6]-0.07950463919999252*kSq[5]+0.2271561119999787*kSq[4]-0.3079201435678004*kSq[2]+0.5333333333333333*epsilon[0]*rdx2Sq[1]+1.777777777777778*epsilon[0]*rdx2Sq[0]-0.3555555555555556*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[6], globalIdxs[7], (0.1333333333333333*epsilon[0]*rdx2Sq[1]*bcVals[9])/bcVals[10]-0.03442651863295482*kSq[7]-0.0295084445425327*kSq[6]-0.05962847939999439*kSq[5]-0.063887656499994*kSq[4]-0.05333333333333333*kSq[3]+0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.03849001794597505*kSq[1]-0.8888888888888888*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[7], globalIdxs[0], 0.0234254740499978*kSq[5]+0.0234254740499978*kSq[4]+0.01333333333333333*kSq[3]+0.2555555555555555*epsilon[0]*rdx2Sq[1]+0.2555555555555555*epsilon[0]*rdx2Sq[0]-0.03333333333333333*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[7], globalIdxs[1], 0.01721325931647741*kSq[6]-0.03975231959999626*kSq[5]-0.05678902799999467*kSq[4]-0.01333333333333333*kSq[3]-0.03849001794597505*kSq[2]-0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.4444444444444444*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[7], globalIdxs[2], 0.006147592613027645*kSq[7]+0.02697478829999747*kSq[5]+0.03336355394999686*kSq[4]+0.3111111111111111*epsilon[0]*rdx2Sq[1]+0.01924500897298752*kSq[1]+0.1888888888888889*epsilon[0]*rdx2Sq[0]-0.02222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[7], globalIdxs[3], 0.01721325931647741*kSq[7]-0.05678902799999467*kSq[5]-0.03975231959999626*kSq[4]-0.01333333333333333*kSq[3]-0.4444444444444444*epsilon[0]*rdx2Sq[1]-0.03849001794597505*kSq[1]-0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[7], globalIdxs[4], (-0.0295084445425327*kSq[7])-0.03442651863295482*kSq[6]-0.063887656499994*kSq[5]-0.05962847939999439*kSq[4]-0.05333333333333333*kSq[3]-0.03849001794597505*kSq[2]-0.8888888888888888*epsilon[0]*rdx2Sq[1]+0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[7], globalIdxs[5], (-(0.06666666666666667*epsilon[0]*rdx2Sq[1]*bcVals[9])/bcVals[10])+0.006147592613027645*kSq[6]+0.03336355394999686*kSq[5]+0.02697478829999747*kSq[4]+0.01924500897298752*kSq[2]+0.1888888888888889*epsilon[0]*rdx2Sq[1]+0.3111111111111111*epsilon[0]*rdx2Sq[0]-0.02222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[7], globalIdxs[6], (0.1333333333333333*epsilon[0]*rdx2Sq[1]*bcVals[9])/bcVals[10]-0.03442651863295482*kSq[7]-0.0295084445425327*kSq[6]-0.05962847939999439*kSq[5]-0.063887656499994*kSq[4]-0.05333333333333333*kSq[3]+0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.03849001794597505*kSq[1]-0.8888888888888888*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[7], globalIdxs[7], (0.2666666666666667*epsilon[0]*rdx2Sq[1]*bcVals[9])/bcVals[10]-0.04549218533640458*kSq[7]-0.04549218533640458*kSq[6]-0.0127775312999988*kSq[5]-0.0127775312999988*kSq[4]-0.04666666666666667*kSq[3]-0.03849001794597505*kSq[2]+0.5777777777777777*epsilon[0]*rdx2Sq[1]-0.03849001794597505*kSq[1]+0.5777777777777777*epsilon[0]*rdx2Sq[0]-0.06666666666666667*kSq[0]);

}
void fem_poisson_lhs_stencil_consteps_2x_ser_p1_lox_neumannx_upy_periodicy(const double *epsilon, const double *kSq, const double *dx, const double *bcVals, const long *globalIdxs, gkyl_mat_triples *tri) 
{ 
  // epsilon: permittivity.
  // kSq: wave number squared (factor multiplying phi).
  // dx: cell length in each direction.
  // bcVals[3]: values to impose as BCs, i.e. bcVals[0]*phi+bcVals[1]*d(phi)/dx=bcVals[2].
  // globalIdxs: global linear index of each basis function/node in current cell.
  // tri: triples object (i,j,val), i.e. contribute val to i,j element of the global matrix.

  double rdx2Sq[2];
  rdx2Sq[0] = 4.0/(dx[0]*dx[0]);
  rdx2Sq[1] = 4.0/(dx[1]*dx[1]);

  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[0], (-0.1666666666666667*kSq[3])+0.1924500897298752*kSq[2]+0.3333333333333333*epsilon[0]*rdx2Sq[1]+0.1924500897298752*kSq[1]+0.3333333333333333*epsilon[0]*rdx2Sq[0]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[1], 0.09622504486493762*kSq[2]+0.1666666666666667*epsilon[0]*rdx2Sq[1]-0.3333333333333333*epsilon[0]*rdx2Sq[0]-0.1111111111111111*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[2], (-0.3333333333333333*epsilon[0]*rdx2Sq[1])+0.09622504486493762*kSq[1]+0.1666666666666667*epsilon[0]*rdx2Sq[0]-0.1111111111111111*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[3], (-0.1666666666666667*epsilon[0]*rdx2Sq[1])-0.1666666666666667*epsilon[0]*rdx2Sq[0]-0.05555555555555555*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[0], 0.09622504486493762*kSq[2]+0.1666666666666667*epsilon[0]*rdx2Sq[1]-0.3333333333333333*epsilon[0]*rdx2Sq[0]-0.1111111111111111*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[1], 0.1666666666666667*kSq[3]+0.1924500897298752*kSq[2]+0.3333333333333333*epsilon[0]*rdx2Sq[1]-0.1924500897298752*kSq[1]+0.3333333333333333*epsilon[0]*rdx2Sq[0]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[2], (-0.1666666666666667*epsilon[0]*rdx2Sq[1])-0.1666666666666667*epsilon[0]*rdx2Sq[0]-0.05555555555555555*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[3], (-0.3333333333333333*epsilon[0]*rdx2Sq[1])-0.09622504486493762*kSq[1]+0.1666666666666667*epsilon[0]*rdx2Sq[0]-0.1111111111111111*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[0], (-0.3333333333333333*epsilon[0]*rdx2Sq[1])+0.09622504486493762*kSq[1]+0.1666666666666667*epsilon[0]*rdx2Sq[0]-0.1111111111111111*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[1], (-0.1666666666666667*epsilon[0]*rdx2Sq[1])-0.1666666666666667*epsilon[0]*rdx2Sq[0]-0.05555555555555555*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[2], 0.1666666666666667*kSq[3]-0.1924500897298752*kSq[2]+0.3333333333333333*epsilon[0]*rdx2Sq[1]+0.1924500897298752*kSq[1]+0.3333333333333333*epsilon[0]*rdx2Sq[0]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[3], (-0.09622504486493762*kSq[2])+0.1666666666666667*epsilon[0]*rdx2Sq[1]-0.3333333333333333*epsilon[0]*rdx2Sq[0]-0.1111111111111111*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[0], (-0.1666666666666667*epsilon[0]*rdx2Sq[1])-0.1666666666666667*epsilon[0]*rdx2Sq[0]-0.05555555555555555*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[1], (-0.3333333333333333*epsilon[0]*rdx2Sq[1])-0.09622504486493762*kSq[1]+0.1666666666666667*epsilon[0]*rdx2Sq[0]-0.1111111111111111*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[2], (-0.09622504486493762*kSq[2])+0.1666666666666667*epsilon[0]*rdx2Sq[1]-0.3333333333333333*epsilon[0]*rdx2Sq[0]-0.1111111111111111*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[3], (-0.1666666666666667*kSq[3])-0.1924500897298752*kSq[2]+0.3333333333333333*epsilon[0]*rdx2Sq[1]-0.1924500897298752*kSq[1]+0.3333333333333333*epsilon[0]*rdx2Sq[0]-0.2222222222222222*kSq[0]);

}
void fem_poisson_lhs_stencil_consteps_2x_ser_p2_lox_neumannx_upy_periodicy(const double *epsilon, const double *kSq, const double *dx, const double *bcVals, const long *globalIdxs, gkyl_mat_triples *tri) 
{ 
  // epsilon: permittivity.
  // kSq: wave number squared (factor multiplying phi).
  // dx: cell length in each direction.
  // bcVals[3]: values to impose as BCs, i.e. bcVals[0]*phi+bcVals[1]*d(phi)/dx=bcVals[2].
  // globalIdxs: global linear index of each basis function/node in current cell.
  // tri: triples object (i,j,val), i.e. contribute val to i,j element of the global matrix.

  double rdx2Sq[2];
  rdx2Sq[0] = 4.0/(dx[0]*dx[0]);
  rdx2Sq[1] = 4.0/(dx[1]*dx[1]);

  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[0], 0.04549218533640458*kSq[7]+0.04549218533640458*kSq[6]-0.0127775312999988*kSq[5]-0.0127775312999988*kSq[4]-0.04666666666666667*kSq[3]+0.03849001794597505*kSq[2]+0.5777777777777777*epsilon[0]*rdx2Sq[1]+0.03849001794597505*kSq[1]+0.5777777777777777*epsilon[0]*rdx2Sq[0]-0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[1], 0.03442651863295482*kSq[7]+0.0295084445425327*kSq[6]-0.05962847939999439*kSq[5]-0.063887656499994*kSq[4]-0.05333333333333333*kSq[3]+0.06666666666666667*epsilon[0]*rdx2Sq[1]+0.03849001794597505*kSq[1]-0.8888888888888888*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[2], (-0.006147592613027645*kSq[6])+0.03336355394999686*kSq[5]+0.02697478829999747*kSq[4]-0.01924500897298752*kSq[2]+0.1888888888888889*epsilon[0]*rdx2Sq[1]+0.3111111111111111*epsilon[0]*rdx2Sq[0]-0.02222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[3], 0.0295084445425327*kSq[7]+0.03442651863295482*kSq[6]-0.063887656499994*kSq[5]-0.05962847939999439*kSq[4]-0.05333333333333333*kSq[3]+0.03849001794597505*kSq[2]-0.8888888888888888*epsilon[0]*rdx2Sq[1]+0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[4], (-0.01721325931647741*kSq[7])-0.05678902799999467*kSq[5]-0.03975231959999626*kSq[4]-0.01333333333333333*kSq[3]-0.4444444444444444*epsilon[0]*rdx2Sq[1]+0.03849001794597505*kSq[1]-0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[5], (-0.006147592613027645*kSq[7])+0.02697478829999747*kSq[5]+0.03336355394999686*kSq[4]+0.3111111111111111*epsilon[0]*rdx2Sq[1]-0.01924500897298752*kSq[1]+0.1888888888888889*epsilon[0]*rdx2Sq[0]-0.02222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[6], (-0.01721325931647741*kSq[6])-0.03975231959999626*kSq[5]-0.05678902799999467*kSq[4]-0.01333333333333333*kSq[3]+0.03849001794597505*kSq[2]-0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.4444444444444444*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[7], 0.0234254740499978*kSq[5]+0.0234254740499978*kSq[4]+0.01333333333333333*kSq[3]+0.2555555555555555*epsilon[0]*rdx2Sq[1]+0.2555555555555555*epsilon[0]*rdx2Sq[0]-0.03333333333333333*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[0], 0.03442651863295482*kSq[7]+0.0295084445425327*kSq[6]-0.05962847939999439*kSq[5]-0.063887656499994*kSq[4]-0.05333333333333333*kSq[3]+0.06666666666666667*epsilon[0]*rdx2Sq[1]+0.03849001794597505*kSq[1]-0.8888888888888888*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[1], (-0.1967229636168847*kSq[6])-0.07950463919999252*kSq[5]+0.2271561119999787*kSq[4]+0.3079201435678004*kSq[2]+0.5333333333333333*epsilon[0]*rdx2Sq[1]+1.777777777777778*epsilon[0]*rdx2Sq[0]-0.3555555555555556*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[2], (-0.03442651863295482*kSq[7])+0.0295084445425327*kSq[6]-0.05962847939999439*kSq[5]-0.063887656499994*kSq[4]+0.05333333333333333*kSq[3]+0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.03849001794597505*kSq[1]-0.8888888888888888*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[3], (-0.03442651863295482*kSq[7])-0.03442651863295482*kSq[6]+0.09938079899999068*kSq[5]+0.09938079899999068*kSq[4]-0.02666666666666666*kSq[3]+0.0769800358919501*kSq[2]+0.0769800358919501*kSq[1]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[4], 0.03442651863295482*kSq[7]-0.03442651863295482*kSq[6]+0.09938079899999068*kSq[5]+0.09938079899999068*kSq[4]+0.02666666666666666*kSq[3]+0.0769800358919501*kSq[2]-0.0769800358919501*kSq[1]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[5], 0.01721325931647741*kSq[6]-0.03975231959999626*kSq[5]-0.05678902799999467*kSq[4]+0.01333333333333333*kSq[3]-0.03849001794597505*kSq[2]-0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.4444444444444444*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[6], 0.07950463919999252*kSq[5]+0.1135780559999893*kSq[4]-0.5333333333333333*epsilon[0]*rdx2Sq[1]+0.8888888888888888*epsilon[0]*rdx2Sq[0]-0.1777777777777778*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[7], 0.01721325931647741*kSq[6]-0.03975231959999626*kSq[5]-0.05678902799999467*kSq[4]-0.01333333333333333*kSq[3]-0.03849001794597505*kSq[2]-0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.4444444444444444*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[0], (-0.006147592613027645*kSq[6])+0.03336355394999686*kSq[5]+0.02697478829999747*kSq[4]-0.01924500897298752*kSq[2]+0.1888888888888889*epsilon[0]*rdx2Sq[1]+0.3111111111111111*epsilon[0]*rdx2Sq[0]-0.02222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[1], (-0.03442651863295482*kSq[7])+0.0295084445425327*kSq[6]-0.05962847939999439*kSq[5]-0.063887656499994*kSq[4]+0.05333333333333333*kSq[3]+0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.03849001794597505*kSq[1]-0.8888888888888888*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[2], (-0.04549218533640458*kSq[7])+0.04549218533640458*kSq[6]-0.0127775312999988*kSq[5]-0.0127775312999988*kSq[4]+0.04666666666666667*kSq[3]+0.03849001794597505*kSq[2]+0.5777777777777777*epsilon[0]*rdx2Sq[1]-0.03849001794597505*kSq[1]+0.5777777777777777*epsilon[0]*rdx2Sq[0]-0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[3], 0.01721325931647741*kSq[7]-0.05678902799999467*kSq[5]-0.03975231959999626*kSq[4]+0.01333333333333333*kSq[3]-0.4444444444444444*epsilon[0]*rdx2Sq[1]-0.03849001794597505*kSq[1]-0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[4], (-0.0295084445425327*kSq[7])+0.03442651863295482*kSq[6]-0.063887656499994*kSq[5]-0.05962847939999439*kSq[4]+0.05333333333333333*kSq[3]+0.03849001794597505*kSq[2]-0.8888888888888888*epsilon[0]*rdx2Sq[1]+0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[5], 0.0234254740499978*kSq[5]+0.0234254740499978*kSq[4]-0.01333333333333333*kSq[3]+0.2555555555555555*epsilon[0]*rdx2Sq[1]+0.2555555555555555*epsilon[0]*rdx2Sq[0]-0.03333333333333333*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[6], (-0.01721325931647741*kSq[6])-0.03975231959999626*kSq[5]-0.05678902799999467*kSq[4]+0.01333333333333333*kSq[3]+0.03849001794597505*kSq[2]-0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.4444444444444444*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[7], 0.006147592613027645*kSq[7]+0.02697478829999747*kSq[5]+0.03336355394999686*kSq[4]+0.3111111111111111*epsilon[0]*rdx2Sq[1]+0.01924500897298752*kSq[1]+0.1888888888888889*epsilon[0]*rdx2Sq[0]-0.02222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[0], 0.0295084445425327*kSq[7]+0.03442651863295482*kSq[6]-0.063887656499994*kSq[5]-0.05962847939999439*kSq[4]-0.05333333333333333*kSq[3]+0.03849001794597505*kSq[2]-0.8888888888888888*epsilon[0]*rdx2Sq[1]+0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[1], (-0.03442651863295482*kSq[7])-0.03442651863295482*kSq[6]+0.09938079899999068*kSq[5]+0.09938079899999068*kSq[4]-0.02666666666666666*kSq[3]+0.0769800358919501*kSq[2]+0.0769800358919501*kSq[1]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[2], 0.01721325931647741*kSq[7]-0.05678902799999467*kSq[5]-0.03975231959999626*kSq[4]+0.01333333333333333*kSq[3]-0.4444444444444444*epsilon[0]*rdx2Sq[1]-0.03849001794597505*kSq[1]-0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[3], (-0.1967229636168847*kSq[7])+0.2271561119999787*kSq[5]-0.07950463919999252*kSq[4]+1.777777777777778*epsilon[0]*rdx2Sq[1]+0.3079201435678004*kSq[1]+0.5333333333333333*epsilon[0]*rdx2Sq[0]-0.3555555555555556*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[4], 0.1135780559999893*kSq[5]+0.07950463919999252*kSq[4]+0.8888888888888888*epsilon[0]*rdx2Sq[1]-0.5333333333333333*epsilon[0]*rdx2Sq[0]-0.1777777777777778*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[5], 0.0295084445425327*kSq[7]-0.03442651863295482*kSq[6]-0.063887656499994*kSq[5]-0.05962847939999439*kSq[4]+0.05333333333333333*kSq[3]-0.03849001794597505*kSq[2]-0.8888888888888888*epsilon[0]*rdx2Sq[1]+0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[6], (-0.03442651863295482*kSq[7])+0.03442651863295482*kSq[6]+0.09938079899999068*kSq[5]+0.09938079899999068*kSq[4]+0.02666666666666666*kSq[3]-0.0769800358919501*kSq[2]+0.0769800358919501*kSq[1]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[7], 0.01721325931647741*kSq[7]-0.05678902799999467*kSq[5]-0.03975231959999626*kSq[4]-0.01333333333333333*kSq[3]-0.4444444444444444*epsilon[0]*rdx2Sq[1]-0.03849001794597505*kSq[1]-0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[4], globalIdxs[0], (-0.01721325931647741*kSq[7])-0.05678902799999467*kSq[5]-0.03975231959999626*kSq[4]-0.01333333333333333*kSq[3]-0.4444444444444444*epsilon[0]*rdx2Sq[1]+0.03849001794597505*kSq[1]-0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[4], globalIdxs[1], 0.03442651863295482*kSq[7]-0.03442651863295482*kSq[6]+0.09938079899999068*kSq[5]+0.09938079899999068*kSq[4]+0.02666666666666666*kSq[3]+0.0769800358919501*kSq[2]-0.0769800358919501*kSq[1]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[4], globalIdxs[2], (-0.0295084445425327*kSq[7])+0.03442651863295482*kSq[6]-0.063887656499994*kSq[5]-0.05962847939999439*kSq[4]+0.05333333333333333*kSq[3]+0.03849001794597505*kSq[2]-0.8888888888888888*epsilon[0]*rdx2Sq[1]+0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[4], globalIdxs[3], 0.1135780559999893*kSq[5]+0.07950463919999252*kSq[4]+0.8888888888888888*epsilon[0]*rdx2Sq[1]-0.5333333333333333*epsilon[0]*rdx2Sq[0]-0.1777777777777778*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[4], globalIdxs[4], 0.1967229636168847*kSq[7]+0.2271561119999787*kSq[5]-0.07950463919999252*kSq[4]+1.777777777777778*epsilon[0]*rdx2Sq[1]-0.3079201435678004*kSq[1]+0.5333333333333333*epsilon[0]*rdx2Sq[0]-0.3555555555555556*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[4], globalIdxs[5], (-0.01721325931647741*kSq[7])-0.05678902799999467*kSq[5]-0.03975231959999626*kSq[4]+0.01333333333333333*kSq[3]-0.4444444444444444*epsilon[0]*rdx2Sq[1]+0.03849001794597505*kSq[1]-0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[4], globalIdxs[6], 0.03442651863295482*kSq[7]+0.03442651863295482*kSq[6]+0.09938079899999068*kSq[5]+0.09938079899999068*kSq[4]-0.02666666666666666*kSq[3]-0.0769800358919501*kSq[2]-0.0769800358919501*kSq[1]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[4], globalIdxs[7], (-0.0295084445425327*kSq[7])-0.03442651863295482*kSq[6]-0.063887656499994*kSq[5]-0.05962847939999439*kSq[4]-0.05333333333333333*kSq[3]-0.03849001794597505*kSq[2]-0.8888888888888888*epsilon[0]*rdx2Sq[1]+0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[5], globalIdxs[0], (-0.006147592613027645*kSq[7])+0.02697478829999747*kSq[5]+0.03336355394999686*kSq[4]+0.3111111111111111*epsilon[0]*rdx2Sq[1]-0.01924500897298752*kSq[1]+0.1888888888888889*epsilon[0]*rdx2Sq[0]-0.02222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[5], globalIdxs[1], 0.01721325931647741*kSq[6]-0.03975231959999626*kSq[5]-0.05678902799999467*kSq[4]+0.01333333333333333*kSq[3]-0.03849001794597505*kSq[2]-0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.4444444444444444*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[5], globalIdxs[2], 0.0234254740499978*kSq[5]+0.0234254740499978*kSq[4]-0.01333333333333333*kSq[3]+0.2555555555555555*epsilon[0]*rdx2Sq[1]+0.2555555555555555*epsilon[0]*rdx2Sq[0]-0.03333333333333333*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[5], globalIdxs[3], 0.0295084445425327*kSq[7]-0.03442651863295482*kSq[6]-0.063887656499994*kSq[5]-0.05962847939999439*kSq[4]+0.05333333333333333*kSq[3]-0.03849001794597505*kSq[2]-0.8888888888888888*epsilon[0]*rdx2Sq[1]+0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[5], globalIdxs[4], (-0.01721325931647741*kSq[7])-0.05678902799999467*kSq[5]-0.03975231959999626*kSq[4]+0.01333333333333333*kSq[3]-0.4444444444444444*epsilon[0]*rdx2Sq[1]+0.03849001794597505*kSq[1]-0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[5], globalIdxs[5], 0.04549218533640458*kSq[7]-0.04549218533640458*kSq[6]-0.0127775312999988*kSq[5]-0.0127775312999988*kSq[4]+0.04666666666666667*kSq[3]-0.03849001794597505*kSq[2]+0.5777777777777777*epsilon[0]*rdx2Sq[1]+0.03849001794597505*kSq[1]+0.5777777777777777*epsilon[0]*rdx2Sq[0]-0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[5], globalIdxs[6], 0.03442651863295482*kSq[7]-0.0295084445425327*kSq[6]-0.05962847939999439*kSq[5]-0.063887656499994*kSq[4]+0.05333333333333333*kSq[3]+0.06666666666666667*epsilon[0]*rdx2Sq[1]+0.03849001794597505*kSq[1]-0.8888888888888888*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[5], globalIdxs[7], 0.006147592613027645*kSq[6]+0.03336355394999686*kSq[5]+0.02697478829999747*kSq[4]+0.01924500897298752*kSq[2]+0.1888888888888889*epsilon[0]*rdx2Sq[1]+0.3111111111111111*epsilon[0]*rdx2Sq[0]-0.02222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[6], globalIdxs[0], (-0.01721325931647741*kSq[6])-0.03975231959999626*kSq[5]-0.05678902799999467*kSq[4]-0.01333333333333333*kSq[3]+0.03849001794597505*kSq[2]-0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.4444444444444444*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[6], globalIdxs[1], 0.07950463919999252*kSq[5]+0.1135780559999893*kSq[4]-0.5333333333333333*epsilon[0]*rdx2Sq[1]+0.8888888888888888*epsilon[0]*rdx2Sq[0]-0.1777777777777778*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[6], globalIdxs[2], (-0.01721325931647741*kSq[6])-0.03975231959999626*kSq[5]-0.05678902799999467*kSq[4]+0.01333333333333333*kSq[3]+0.03849001794597505*kSq[2]-0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.4444444444444444*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[6], globalIdxs[3], (-0.03442651863295482*kSq[7])+0.03442651863295482*kSq[6]+0.09938079899999068*kSq[5]+0.09938079899999068*kSq[4]+0.02666666666666666*kSq[3]-0.0769800358919501*kSq[2]+0.0769800358919501*kSq[1]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[6], globalIdxs[4], 0.03442651863295482*kSq[7]+0.03442651863295482*kSq[6]+0.09938079899999068*kSq[5]+0.09938079899999068*kSq[4]-0.02666666666666666*kSq[3]-0.0769800358919501*kSq[2]-0.0769800358919501*kSq[1]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[6], globalIdxs[5], 0.03442651863295482*kSq[7]-0.0295084445425327*kSq[6]-0.05962847939999439*kSq[5]-0.063887656499994*kSq[4]+0.05333333333333333*kSq[3]+0.06666666666666667*epsilon[0]*rdx2Sq[1]+0.03849001794597505*kSq[1]-0.8888888888888888*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[6], globalIdxs[6], 0.1967229636168847*kSq[6]-0.07950463919999252*kSq[5]+0.2271561119999787*kSq[4]-0.3079201435678004*kSq[2]+0.5333333333333333*epsilon[0]*rdx2Sq[1]+1.777777777777778*epsilon[0]*rdx2Sq[0]-0.3555555555555556*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[6], globalIdxs[7], (-0.03442651863295482*kSq[7])-0.0295084445425327*kSq[6]-0.05962847939999439*kSq[5]-0.063887656499994*kSq[4]-0.05333333333333333*kSq[3]+0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.03849001794597505*kSq[1]-0.8888888888888888*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[7], globalIdxs[0], 0.0234254740499978*kSq[5]+0.0234254740499978*kSq[4]+0.01333333333333333*kSq[3]+0.2555555555555555*epsilon[0]*rdx2Sq[1]+0.2555555555555555*epsilon[0]*rdx2Sq[0]-0.03333333333333333*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[7], globalIdxs[1], 0.01721325931647741*kSq[6]-0.03975231959999626*kSq[5]-0.05678902799999467*kSq[4]-0.01333333333333333*kSq[3]-0.03849001794597505*kSq[2]-0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.4444444444444444*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[7], globalIdxs[2], 0.006147592613027645*kSq[7]+0.02697478829999747*kSq[5]+0.03336355394999686*kSq[4]+0.3111111111111111*epsilon[0]*rdx2Sq[1]+0.01924500897298752*kSq[1]+0.1888888888888889*epsilon[0]*rdx2Sq[0]-0.02222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[7], globalIdxs[3], 0.01721325931647741*kSq[7]-0.05678902799999467*kSq[5]-0.03975231959999626*kSq[4]-0.01333333333333333*kSq[3]-0.4444444444444444*epsilon[0]*rdx2Sq[1]-0.03849001794597505*kSq[1]-0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[7], globalIdxs[4], (-0.0295084445425327*kSq[7])-0.03442651863295482*kSq[6]-0.063887656499994*kSq[5]-0.05962847939999439*kSq[4]-0.05333333333333333*kSq[3]-0.03849001794597505*kSq[2]-0.8888888888888888*epsilon[0]*rdx2Sq[1]+0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[7], globalIdxs[5], 0.006147592613027645*kSq[6]+0.03336355394999686*kSq[5]+0.02697478829999747*kSq[4]+0.01924500897298752*kSq[2]+0.1888888888888889*epsilon[0]*rdx2Sq[1]+0.3111111111111111*epsilon[0]*rdx2Sq[0]-0.02222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[7], globalIdxs[6], (-0.03442651863295482*kSq[7])-0.0295084445425327*kSq[6]-0.05962847939999439*kSq[5]-0.063887656499994*kSq[4]-0.05333333333333333*kSq[3]+0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.03849001794597505*kSq[1]-0.8888888888888888*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[7], globalIdxs[7], (-0.04549218533640458*kSq[7])-0.04549218533640458*kSq[6]-0.0127775312999988*kSq[5]-0.0127775312999988*kSq[4]-0.04666666666666667*kSq[3]-0.03849001794597505*kSq[2]+0.5777777777777777*epsilon[0]*rdx2Sq[1]-0.03849001794597505*kSq[1]+0.5777777777777777*epsilon[0]*rdx2Sq[0]-0.06666666666666667*kSq[0]);

}
void fem_poisson_lhs_stencil_consteps_2x_ser_p1_lox_neumannx_upy_dirichlety(const double *epsilon, const double *kSq, const double *dx, const double *bcVals, const long *globalIdxs, gkyl_mat_triples *tri) 
{ 
  // epsilon: permittivity.
  // kSq: wave number squared (factor multiplying phi).
  // dx: cell length in each direction.
  // bcVals[3]: values to impose as BCs, i.e. bcVals[0]*phi+bcVals[1]*d(phi)/dx=bcVals[2].
  // globalIdxs: global linear index of each basis function/node in current cell.
  // tri: triples object (i,j,val), i.e. contribute val to i,j element of the global matrix.

  double rdx2Sq[2];
  rdx2Sq[0] = 4.0/(dx[0]*dx[0]);
  rdx2Sq[1] = 4.0/(dx[1]*dx[1]);

  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[0], (-0.1666666666666667*kSq[3])+0.1924500897298752*kSq[2]+0.3333333333333333*epsilon[0]*rdx2Sq[1]+0.1924500897298752*kSq[1]+0.3333333333333333*epsilon[0]*rdx2Sq[0]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[1], 0.09622504486493762*kSq[2]+0.1666666666666667*epsilon[0]*rdx2Sq[1]-0.3333333333333333*epsilon[0]*rdx2Sq[0]-0.1111111111111111*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[2], (-0.3333333333333333*epsilon[0]*rdx2Sq[1])+0.09622504486493762*kSq[1]+0.1666666666666667*epsilon[0]*rdx2Sq[0]-0.1111111111111111*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[3], (-0.1666666666666667*epsilon[0]*rdx2Sq[1])-0.1666666666666667*epsilon[0]*rdx2Sq[0]-0.05555555555555555*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[0], 0.09622504486493762*kSq[2]+0.1666666666666667*epsilon[0]*rdx2Sq[1]-0.3333333333333333*epsilon[0]*rdx2Sq[0]-0.1111111111111111*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[1], 0.1666666666666667*kSq[3]+0.1924500897298752*kSq[2]+0.3333333333333333*epsilon[0]*rdx2Sq[1]-0.1924500897298752*kSq[1]+0.3333333333333333*epsilon[0]*rdx2Sq[0]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[2], (-0.1666666666666667*epsilon[0]*rdx2Sq[1])-0.1666666666666667*epsilon[0]*rdx2Sq[0]-0.05555555555555555*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[3], (-0.3333333333333333*epsilon[0]*rdx2Sq[1])-0.09622504486493762*kSq[1]+0.1666666666666667*epsilon[0]*rdx2Sq[0]-0.1111111111111111*kSq[0]);
  gkyl_mat_triples_insert(tri, globalIdxs[2], globalIdxs[0], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[2], globalIdxs[1], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[2], globalIdxs[2], 1.0);
  gkyl_mat_triples_insert(tri, globalIdxs[2], globalIdxs[3], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[3], globalIdxs[0], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[3], globalIdxs[1], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[3], globalIdxs[2], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[3], globalIdxs[3], 1.0);

}
void fem_poisson_lhs_stencil_consteps_2x_ser_p2_lox_neumannx_upy_dirichlety(const double *epsilon, const double *kSq, const double *dx, const double *bcVals, const long *globalIdxs, gkyl_mat_triples *tri) 
{ 
  // epsilon: permittivity.
  // kSq: wave number squared (factor multiplying phi).
  // dx: cell length in each direction.
  // bcVals[3]: values to impose as BCs, i.e. bcVals[0]*phi+bcVals[1]*d(phi)/dx=bcVals[2].
  // globalIdxs: global linear index of each basis function/node in current cell.
  // tri: triples object (i,j,val), i.e. contribute val to i,j element of the global matrix.

  double rdx2Sq[2];
  rdx2Sq[0] = 4.0/(dx[0]*dx[0]);
  rdx2Sq[1] = 4.0/(dx[1]*dx[1]);

  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[0], 0.04549218533640458*kSq[7]+0.04549218533640458*kSq[6]-0.0127775312999988*kSq[5]-0.0127775312999988*kSq[4]-0.04666666666666667*kSq[3]+0.03849001794597505*kSq[2]+0.5777777777777777*epsilon[0]*rdx2Sq[1]+0.03849001794597505*kSq[1]+0.5777777777777777*epsilon[0]*rdx2Sq[0]-0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[1], 0.03442651863295482*kSq[7]+0.0295084445425327*kSq[6]-0.05962847939999439*kSq[5]-0.063887656499994*kSq[4]-0.05333333333333333*kSq[3]+0.06666666666666667*epsilon[0]*rdx2Sq[1]+0.03849001794597505*kSq[1]-0.8888888888888888*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[2], (-0.006147592613027645*kSq[6])+0.03336355394999686*kSq[5]+0.02697478829999747*kSq[4]-0.01924500897298752*kSq[2]+0.1888888888888889*epsilon[0]*rdx2Sq[1]+0.3111111111111111*epsilon[0]*rdx2Sq[0]-0.02222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[3], 0.0295084445425327*kSq[7]+0.03442651863295482*kSq[6]-0.063887656499994*kSq[5]-0.05962847939999439*kSq[4]-0.05333333333333333*kSq[3]+0.03849001794597505*kSq[2]-0.8888888888888888*epsilon[0]*rdx2Sq[1]+0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[4], (-0.01721325931647741*kSq[7])-0.05678902799999467*kSq[5]-0.03975231959999626*kSq[4]-0.01333333333333333*kSq[3]-0.4444444444444444*epsilon[0]*rdx2Sq[1]+0.03849001794597505*kSq[1]-0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[5], (-0.006147592613027645*kSq[7])+0.02697478829999747*kSq[5]+0.03336355394999686*kSq[4]+0.3111111111111111*epsilon[0]*rdx2Sq[1]-0.01924500897298752*kSq[1]+0.1888888888888889*epsilon[0]*rdx2Sq[0]-0.02222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[6], (-0.01721325931647741*kSq[6])-0.03975231959999626*kSq[5]-0.05678902799999467*kSq[4]-0.01333333333333333*kSq[3]+0.03849001794597505*kSq[2]-0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.4444444444444444*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[7], 0.0234254740499978*kSq[5]+0.0234254740499978*kSq[4]+0.01333333333333333*kSq[3]+0.2555555555555555*epsilon[0]*rdx2Sq[1]+0.2555555555555555*epsilon[0]*rdx2Sq[0]-0.03333333333333333*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[0], 0.03442651863295482*kSq[7]+0.0295084445425327*kSq[6]-0.05962847939999439*kSq[5]-0.063887656499994*kSq[4]-0.05333333333333333*kSq[3]+0.06666666666666667*epsilon[0]*rdx2Sq[1]+0.03849001794597505*kSq[1]-0.8888888888888888*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[1], (-0.1967229636168847*kSq[6])-0.07950463919999252*kSq[5]+0.2271561119999787*kSq[4]+0.3079201435678004*kSq[2]+0.5333333333333333*epsilon[0]*rdx2Sq[1]+1.777777777777778*epsilon[0]*rdx2Sq[0]-0.3555555555555556*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[2], (-0.03442651863295482*kSq[7])+0.0295084445425327*kSq[6]-0.05962847939999439*kSq[5]-0.063887656499994*kSq[4]+0.05333333333333333*kSq[3]+0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.03849001794597505*kSq[1]-0.8888888888888888*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[3], (-0.03442651863295482*kSq[7])-0.03442651863295482*kSq[6]+0.09938079899999068*kSq[5]+0.09938079899999068*kSq[4]-0.02666666666666666*kSq[3]+0.0769800358919501*kSq[2]+0.0769800358919501*kSq[1]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[4], 0.03442651863295482*kSq[7]-0.03442651863295482*kSq[6]+0.09938079899999068*kSq[5]+0.09938079899999068*kSq[4]+0.02666666666666666*kSq[3]+0.0769800358919501*kSq[2]-0.0769800358919501*kSq[1]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[5], 0.01721325931647741*kSq[6]-0.03975231959999626*kSq[5]-0.05678902799999467*kSq[4]+0.01333333333333333*kSq[3]-0.03849001794597505*kSq[2]-0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.4444444444444444*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[6], 0.07950463919999252*kSq[5]+0.1135780559999893*kSq[4]-0.5333333333333333*epsilon[0]*rdx2Sq[1]+0.8888888888888888*epsilon[0]*rdx2Sq[0]-0.1777777777777778*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[7], 0.01721325931647741*kSq[6]-0.03975231959999626*kSq[5]-0.05678902799999467*kSq[4]-0.01333333333333333*kSq[3]-0.03849001794597505*kSq[2]-0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.4444444444444444*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[0], (-0.006147592613027645*kSq[6])+0.03336355394999686*kSq[5]+0.02697478829999747*kSq[4]-0.01924500897298752*kSq[2]+0.1888888888888889*epsilon[0]*rdx2Sq[1]+0.3111111111111111*epsilon[0]*rdx2Sq[0]-0.02222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[1], (-0.03442651863295482*kSq[7])+0.0295084445425327*kSq[6]-0.05962847939999439*kSq[5]-0.063887656499994*kSq[4]+0.05333333333333333*kSq[3]+0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.03849001794597505*kSq[1]-0.8888888888888888*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[2], (-0.04549218533640458*kSq[7])+0.04549218533640458*kSq[6]-0.0127775312999988*kSq[5]-0.0127775312999988*kSq[4]+0.04666666666666667*kSq[3]+0.03849001794597505*kSq[2]+0.5777777777777777*epsilon[0]*rdx2Sq[1]-0.03849001794597505*kSq[1]+0.5777777777777777*epsilon[0]*rdx2Sq[0]-0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[3], 0.01721325931647741*kSq[7]-0.05678902799999467*kSq[5]-0.03975231959999626*kSq[4]+0.01333333333333333*kSq[3]-0.4444444444444444*epsilon[0]*rdx2Sq[1]-0.03849001794597505*kSq[1]-0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[4], (-0.0295084445425327*kSq[7])+0.03442651863295482*kSq[6]-0.063887656499994*kSq[5]-0.05962847939999439*kSq[4]+0.05333333333333333*kSq[3]+0.03849001794597505*kSq[2]-0.8888888888888888*epsilon[0]*rdx2Sq[1]+0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[5], 0.0234254740499978*kSq[5]+0.0234254740499978*kSq[4]-0.01333333333333333*kSq[3]+0.2555555555555555*epsilon[0]*rdx2Sq[1]+0.2555555555555555*epsilon[0]*rdx2Sq[0]-0.03333333333333333*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[6], (-0.01721325931647741*kSq[6])-0.03975231959999626*kSq[5]-0.05678902799999467*kSq[4]+0.01333333333333333*kSq[3]+0.03849001794597505*kSq[2]-0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.4444444444444444*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[7], 0.006147592613027645*kSq[7]+0.02697478829999747*kSq[5]+0.03336355394999686*kSq[4]+0.3111111111111111*epsilon[0]*rdx2Sq[1]+0.01924500897298752*kSq[1]+0.1888888888888889*epsilon[0]*rdx2Sq[0]-0.02222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[0], 0.0295084445425327*kSq[7]+0.03442651863295482*kSq[6]-0.063887656499994*kSq[5]-0.05962847939999439*kSq[4]-0.05333333333333333*kSq[3]+0.03849001794597505*kSq[2]-0.8888888888888888*epsilon[0]*rdx2Sq[1]+0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[1], (-0.03442651863295482*kSq[7])-0.03442651863295482*kSq[6]+0.09938079899999068*kSq[5]+0.09938079899999068*kSq[4]-0.02666666666666666*kSq[3]+0.0769800358919501*kSq[2]+0.0769800358919501*kSq[1]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[2], 0.01721325931647741*kSq[7]-0.05678902799999467*kSq[5]-0.03975231959999626*kSq[4]+0.01333333333333333*kSq[3]-0.4444444444444444*epsilon[0]*rdx2Sq[1]-0.03849001794597505*kSq[1]-0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[3], (-0.1967229636168847*kSq[7])+0.2271561119999787*kSq[5]-0.07950463919999252*kSq[4]+1.777777777777778*epsilon[0]*rdx2Sq[1]+0.3079201435678004*kSq[1]+0.5333333333333333*epsilon[0]*rdx2Sq[0]-0.3555555555555556*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[4], 0.1135780559999893*kSq[5]+0.07950463919999252*kSq[4]+0.8888888888888888*epsilon[0]*rdx2Sq[1]-0.5333333333333333*epsilon[0]*rdx2Sq[0]-0.1777777777777778*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[5], 0.0295084445425327*kSq[7]-0.03442651863295482*kSq[6]-0.063887656499994*kSq[5]-0.05962847939999439*kSq[4]+0.05333333333333333*kSq[3]-0.03849001794597505*kSq[2]-0.8888888888888888*epsilon[0]*rdx2Sq[1]+0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[6], (-0.03442651863295482*kSq[7])+0.03442651863295482*kSq[6]+0.09938079899999068*kSq[5]+0.09938079899999068*kSq[4]+0.02666666666666666*kSq[3]-0.0769800358919501*kSq[2]+0.0769800358919501*kSq[1]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[7], 0.01721325931647741*kSq[7]-0.05678902799999467*kSq[5]-0.03975231959999626*kSq[4]-0.01333333333333333*kSq[3]-0.4444444444444444*epsilon[0]*rdx2Sq[1]-0.03849001794597505*kSq[1]-0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[4], globalIdxs[0], (-0.01721325931647741*kSq[7])-0.05678902799999467*kSq[5]-0.03975231959999626*kSq[4]-0.01333333333333333*kSq[3]-0.4444444444444444*epsilon[0]*rdx2Sq[1]+0.03849001794597505*kSq[1]-0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[4], globalIdxs[1], 0.03442651863295482*kSq[7]-0.03442651863295482*kSq[6]+0.09938079899999068*kSq[5]+0.09938079899999068*kSq[4]+0.02666666666666666*kSq[3]+0.0769800358919501*kSq[2]-0.0769800358919501*kSq[1]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[4], globalIdxs[2], (-0.0295084445425327*kSq[7])+0.03442651863295482*kSq[6]-0.063887656499994*kSq[5]-0.05962847939999439*kSq[4]+0.05333333333333333*kSq[3]+0.03849001794597505*kSq[2]-0.8888888888888888*epsilon[0]*rdx2Sq[1]+0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[4], globalIdxs[3], 0.1135780559999893*kSq[5]+0.07950463919999252*kSq[4]+0.8888888888888888*epsilon[0]*rdx2Sq[1]-0.5333333333333333*epsilon[0]*rdx2Sq[0]-0.1777777777777778*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[4], globalIdxs[4], 0.1967229636168847*kSq[7]+0.2271561119999787*kSq[5]-0.07950463919999252*kSq[4]+1.777777777777778*epsilon[0]*rdx2Sq[1]-0.3079201435678004*kSq[1]+0.5333333333333333*epsilon[0]*rdx2Sq[0]-0.3555555555555556*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[4], globalIdxs[5], (-0.01721325931647741*kSq[7])-0.05678902799999467*kSq[5]-0.03975231959999626*kSq[4]+0.01333333333333333*kSq[3]-0.4444444444444444*epsilon[0]*rdx2Sq[1]+0.03849001794597505*kSq[1]-0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[4], globalIdxs[6], 0.03442651863295482*kSq[7]+0.03442651863295482*kSq[6]+0.09938079899999068*kSq[5]+0.09938079899999068*kSq[4]-0.02666666666666666*kSq[3]-0.0769800358919501*kSq[2]-0.0769800358919501*kSq[1]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[4], globalIdxs[7], (-0.0295084445425327*kSq[7])-0.03442651863295482*kSq[6]-0.063887656499994*kSq[5]-0.05962847939999439*kSq[4]-0.05333333333333333*kSq[3]-0.03849001794597505*kSq[2]-0.8888888888888888*epsilon[0]*rdx2Sq[1]+0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_insert(tri, globalIdxs[5], globalIdxs[0], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[5], globalIdxs[1], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[5], globalIdxs[2], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[5], globalIdxs[3], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[5], globalIdxs[4], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[5], globalIdxs[5], 1.0);
  gkyl_mat_triples_insert(tri, globalIdxs[5], globalIdxs[6], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[5], globalIdxs[7], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[6], globalIdxs[0], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[6], globalIdxs[1], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[6], globalIdxs[2], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[6], globalIdxs[3], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[6], globalIdxs[4], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[6], globalIdxs[5], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[6], globalIdxs[6], 1.0);
  gkyl_mat_triples_insert(tri, globalIdxs[6], globalIdxs[7], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[7], globalIdxs[0], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[7], globalIdxs[1], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[7], globalIdxs[2], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[7], globalIdxs[3], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[7], globalIdxs[4], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[7], globalIdxs[5], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[7], globalIdxs[6], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[7], globalIdxs[7], 1.0);

}
void fem_poisson_lhs_stencil_consteps_2x_ser_p1_lox_neumannx_upy_neumanny(const double *epsilon, const double *kSq, const double *dx, const double *bcVals, const long *globalIdxs, gkyl_mat_triples *tri) 
{ 
  // epsilon: permittivity.
  // kSq: wave number squared (factor multiplying phi).
  // dx: cell length in each direction.
  // bcVals[3]: values to impose as BCs, i.e. bcVals[0]*phi+bcVals[1]*d(phi)/dx=bcVals[2].
  // globalIdxs: global linear index of each basis function/node in current cell.
  // tri: triples object (i,j,val), i.e. contribute val to i,j element of the global matrix.

  double rdx2Sq[2];
  rdx2Sq[0] = 4.0/(dx[0]*dx[0]);
  rdx2Sq[1] = 4.0/(dx[1]*dx[1]);

  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[0], (-0.1666666666666667*kSq[3])+0.1924500897298752*kSq[2]+0.3333333333333333*epsilon[0]*rdx2Sq[1]+0.1924500897298752*kSq[1]+0.3333333333333333*epsilon[0]*rdx2Sq[0]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[1], 0.09622504486493762*kSq[2]+0.1666666666666667*epsilon[0]*rdx2Sq[1]-0.3333333333333333*epsilon[0]*rdx2Sq[0]-0.1111111111111111*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[2], (-0.3333333333333333*epsilon[0]*rdx2Sq[1])+0.09622504486493762*kSq[1]+0.1666666666666667*epsilon[0]*rdx2Sq[0]-0.1111111111111111*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[3], (-0.1666666666666667*epsilon[0]*rdx2Sq[1])-0.1666666666666667*epsilon[0]*rdx2Sq[0]-0.05555555555555555*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[0], 0.09622504486493762*kSq[2]+0.1666666666666667*epsilon[0]*rdx2Sq[1]-0.3333333333333333*epsilon[0]*rdx2Sq[0]-0.1111111111111111*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[1], 0.1666666666666667*kSq[3]+0.1924500897298752*kSq[2]+0.3333333333333333*epsilon[0]*rdx2Sq[1]-0.1924500897298752*kSq[1]+0.3333333333333333*epsilon[0]*rdx2Sq[0]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[2], (-0.1666666666666667*epsilon[0]*rdx2Sq[1])-0.1666666666666667*epsilon[0]*rdx2Sq[0]-0.05555555555555555*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[3], (-0.3333333333333333*epsilon[0]*rdx2Sq[1])-0.09622504486493762*kSq[1]+0.1666666666666667*epsilon[0]*rdx2Sq[0]-0.1111111111111111*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[0], (-0.3333333333333333*epsilon[0]*rdx2Sq[1])+0.09622504486493762*kSq[1]+0.1666666666666667*epsilon[0]*rdx2Sq[0]-0.1111111111111111*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[1], (-0.1666666666666667*epsilon[0]*rdx2Sq[1])-0.1666666666666667*epsilon[0]*rdx2Sq[0]-0.05555555555555555*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[2], 0.1666666666666667*kSq[3]-0.1924500897298752*kSq[2]+0.3333333333333333*epsilon[0]*rdx2Sq[1]+0.1924500897298752*kSq[1]+0.3333333333333333*epsilon[0]*rdx2Sq[0]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[3], (-0.09622504486493762*kSq[2])+0.1666666666666667*epsilon[0]*rdx2Sq[1]-0.3333333333333333*epsilon[0]*rdx2Sq[0]-0.1111111111111111*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[0], (-0.1666666666666667*epsilon[0]*rdx2Sq[1])-0.1666666666666667*epsilon[0]*rdx2Sq[0]-0.05555555555555555*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[1], (-0.3333333333333333*epsilon[0]*rdx2Sq[1])-0.09622504486493762*kSq[1]+0.1666666666666667*epsilon[0]*rdx2Sq[0]-0.1111111111111111*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[2], (-0.09622504486493762*kSq[2])+0.1666666666666667*epsilon[0]*rdx2Sq[1]-0.3333333333333333*epsilon[0]*rdx2Sq[0]-0.1111111111111111*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[3], (-0.1666666666666667*kSq[3])-0.1924500897298752*kSq[2]+0.3333333333333333*epsilon[0]*rdx2Sq[1]-0.1924500897298752*kSq[1]+0.3333333333333333*epsilon[0]*rdx2Sq[0]-0.2222222222222222*kSq[0]);

}
void fem_poisson_lhs_stencil_consteps_2x_ser_p2_lox_neumannx_upy_neumanny(const double *epsilon, const double *kSq, const double *dx, const double *bcVals, const long *globalIdxs, gkyl_mat_triples *tri) 
{ 
  // epsilon: permittivity.
  // kSq: wave number squared (factor multiplying phi).
  // dx: cell length in each direction.
  // bcVals[3]: values to impose as BCs, i.e. bcVals[0]*phi+bcVals[1]*d(phi)/dx=bcVals[2].
  // globalIdxs: global linear index of each basis function/node in current cell.
  // tri: triples object (i,j,val), i.e. contribute val to i,j element of the global matrix.

  double rdx2Sq[2];
  rdx2Sq[0] = 4.0/(dx[0]*dx[0]);
  rdx2Sq[1] = 4.0/(dx[1]*dx[1]);

  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[0], 0.04549218533640458*kSq[7]+0.04549218533640458*kSq[6]-0.0127775312999988*kSq[5]-0.0127775312999988*kSq[4]-0.04666666666666667*kSq[3]+0.03849001794597505*kSq[2]+0.5777777777777777*epsilon[0]*rdx2Sq[1]+0.03849001794597505*kSq[1]+0.5777777777777777*epsilon[0]*rdx2Sq[0]-0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[1], 0.03442651863295482*kSq[7]+0.0295084445425327*kSq[6]-0.05962847939999439*kSq[5]-0.063887656499994*kSq[4]-0.05333333333333333*kSq[3]+0.06666666666666667*epsilon[0]*rdx2Sq[1]+0.03849001794597505*kSq[1]-0.8888888888888888*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[2], (-0.006147592613027645*kSq[6])+0.03336355394999686*kSq[5]+0.02697478829999747*kSq[4]-0.01924500897298752*kSq[2]+0.1888888888888889*epsilon[0]*rdx2Sq[1]+0.3111111111111111*epsilon[0]*rdx2Sq[0]-0.02222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[3], 0.0295084445425327*kSq[7]+0.03442651863295482*kSq[6]-0.063887656499994*kSq[5]-0.05962847939999439*kSq[4]-0.05333333333333333*kSq[3]+0.03849001794597505*kSq[2]-0.8888888888888888*epsilon[0]*rdx2Sq[1]+0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[4], (-0.01721325931647741*kSq[7])-0.05678902799999467*kSq[5]-0.03975231959999626*kSq[4]-0.01333333333333333*kSq[3]-0.4444444444444444*epsilon[0]*rdx2Sq[1]+0.03849001794597505*kSq[1]-0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[5], (-0.006147592613027645*kSq[7])+0.02697478829999747*kSq[5]+0.03336355394999686*kSq[4]+0.3111111111111111*epsilon[0]*rdx2Sq[1]-0.01924500897298752*kSq[1]+0.1888888888888889*epsilon[0]*rdx2Sq[0]-0.02222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[6], (-0.01721325931647741*kSq[6])-0.03975231959999626*kSq[5]-0.05678902799999467*kSq[4]-0.01333333333333333*kSq[3]+0.03849001794597505*kSq[2]-0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.4444444444444444*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[7], 0.0234254740499978*kSq[5]+0.0234254740499978*kSq[4]+0.01333333333333333*kSq[3]+0.2555555555555555*epsilon[0]*rdx2Sq[1]+0.2555555555555555*epsilon[0]*rdx2Sq[0]-0.03333333333333333*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[0], 0.03442651863295482*kSq[7]+0.0295084445425327*kSq[6]-0.05962847939999439*kSq[5]-0.063887656499994*kSq[4]-0.05333333333333333*kSq[3]+0.06666666666666667*epsilon[0]*rdx2Sq[1]+0.03849001794597505*kSq[1]-0.8888888888888888*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[1], (-0.1967229636168847*kSq[6])-0.07950463919999252*kSq[5]+0.2271561119999787*kSq[4]+0.3079201435678004*kSq[2]+0.5333333333333333*epsilon[0]*rdx2Sq[1]+1.777777777777778*epsilon[0]*rdx2Sq[0]-0.3555555555555556*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[2], (-0.03442651863295482*kSq[7])+0.0295084445425327*kSq[6]-0.05962847939999439*kSq[5]-0.063887656499994*kSq[4]+0.05333333333333333*kSq[3]+0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.03849001794597505*kSq[1]-0.8888888888888888*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[3], (-0.03442651863295482*kSq[7])-0.03442651863295482*kSq[6]+0.09938079899999068*kSq[5]+0.09938079899999068*kSq[4]-0.02666666666666666*kSq[3]+0.0769800358919501*kSq[2]+0.0769800358919501*kSq[1]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[4], 0.03442651863295482*kSq[7]-0.03442651863295482*kSq[6]+0.09938079899999068*kSq[5]+0.09938079899999068*kSq[4]+0.02666666666666666*kSq[3]+0.0769800358919501*kSq[2]-0.0769800358919501*kSq[1]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[5], 0.01721325931647741*kSq[6]-0.03975231959999626*kSq[5]-0.05678902799999467*kSq[4]+0.01333333333333333*kSq[3]-0.03849001794597505*kSq[2]-0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.4444444444444444*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[6], 0.07950463919999252*kSq[5]+0.1135780559999893*kSq[4]-0.5333333333333333*epsilon[0]*rdx2Sq[1]+0.8888888888888888*epsilon[0]*rdx2Sq[0]-0.1777777777777778*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[7], 0.01721325931647741*kSq[6]-0.03975231959999626*kSq[5]-0.05678902799999467*kSq[4]-0.01333333333333333*kSq[3]-0.03849001794597505*kSq[2]-0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.4444444444444444*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[0], (-0.006147592613027645*kSq[6])+0.03336355394999686*kSq[5]+0.02697478829999747*kSq[4]-0.01924500897298752*kSq[2]+0.1888888888888889*epsilon[0]*rdx2Sq[1]+0.3111111111111111*epsilon[0]*rdx2Sq[0]-0.02222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[1], (-0.03442651863295482*kSq[7])+0.0295084445425327*kSq[6]-0.05962847939999439*kSq[5]-0.063887656499994*kSq[4]+0.05333333333333333*kSq[3]+0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.03849001794597505*kSq[1]-0.8888888888888888*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[2], (-0.04549218533640458*kSq[7])+0.04549218533640458*kSq[6]-0.0127775312999988*kSq[5]-0.0127775312999988*kSq[4]+0.04666666666666667*kSq[3]+0.03849001794597505*kSq[2]+0.5777777777777777*epsilon[0]*rdx2Sq[1]-0.03849001794597505*kSq[1]+0.5777777777777777*epsilon[0]*rdx2Sq[0]-0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[3], 0.01721325931647741*kSq[7]-0.05678902799999467*kSq[5]-0.03975231959999626*kSq[4]+0.01333333333333333*kSq[3]-0.4444444444444444*epsilon[0]*rdx2Sq[1]-0.03849001794597505*kSq[1]-0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[4], (-0.0295084445425327*kSq[7])+0.03442651863295482*kSq[6]-0.063887656499994*kSq[5]-0.05962847939999439*kSq[4]+0.05333333333333333*kSq[3]+0.03849001794597505*kSq[2]-0.8888888888888888*epsilon[0]*rdx2Sq[1]+0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[5], 0.0234254740499978*kSq[5]+0.0234254740499978*kSq[4]-0.01333333333333333*kSq[3]+0.2555555555555555*epsilon[0]*rdx2Sq[1]+0.2555555555555555*epsilon[0]*rdx2Sq[0]-0.03333333333333333*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[6], (-0.01721325931647741*kSq[6])-0.03975231959999626*kSq[5]-0.05678902799999467*kSq[4]+0.01333333333333333*kSq[3]+0.03849001794597505*kSq[2]-0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.4444444444444444*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[7], 0.006147592613027645*kSq[7]+0.02697478829999747*kSq[5]+0.03336355394999686*kSq[4]+0.3111111111111111*epsilon[0]*rdx2Sq[1]+0.01924500897298752*kSq[1]+0.1888888888888889*epsilon[0]*rdx2Sq[0]-0.02222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[0], 0.0295084445425327*kSq[7]+0.03442651863295482*kSq[6]-0.063887656499994*kSq[5]-0.05962847939999439*kSq[4]-0.05333333333333333*kSq[3]+0.03849001794597505*kSq[2]-0.8888888888888888*epsilon[0]*rdx2Sq[1]+0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[1], (-0.03442651863295482*kSq[7])-0.03442651863295482*kSq[6]+0.09938079899999068*kSq[5]+0.09938079899999068*kSq[4]-0.02666666666666666*kSq[3]+0.0769800358919501*kSq[2]+0.0769800358919501*kSq[1]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[2], 0.01721325931647741*kSq[7]-0.05678902799999467*kSq[5]-0.03975231959999626*kSq[4]+0.01333333333333333*kSq[3]-0.4444444444444444*epsilon[0]*rdx2Sq[1]-0.03849001794597505*kSq[1]-0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[3], (-0.1967229636168847*kSq[7])+0.2271561119999787*kSq[5]-0.07950463919999252*kSq[4]+1.777777777777778*epsilon[0]*rdx2Sq[1]+0.3079201435678004*kSq[1]+0.5333333333333333*epsilon[0]*rdx2Sq[0]-0.3555555555555556*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[4], 0.1135780559999893*kSq[5]+0.07950463919999252*kSq[4]+0.8888888888888888*epsilon[0]*rdx2Sq[1]-0.5333333333333333*epsilon[0]*rdx2Sq[0]-0.1777777777777778*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[5], 0.0295084445425327*kSq[7]-0.03442651863295482*kSq[6]-0.063887656499994*kSq[5]-0.05962847939999439*kSq[4]+0.05333333333333333*kSq[3]-0.03849001794597505*kSq[2]-0.8888888888888888*epsilon[0]*rdx2Sq[1]+0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[6], (-0.03442651863295482*kSq[7])+0.03442651863295482*kSq[6]+0.09938079899999068*kSq[5]+0.09938079899999068*kSq[4]+0.02666666666666666*kSq[3]-0.0769800358919501*kSq[2]+0.0769800358919501*kSq[1]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[7], 0.01721325931647741*kSq[7]-0.05678902799999467*kSq[5]-0.03975231959999626*kSq[4]-0.01333333333333333*kSq[3]-0.4444444444444444*epsilon[0]*rdx2Sq[1]-0.03849001794597505*kSq[1]-0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[4], globalIdxs[0], (-0.01721325931647741*kSq[7])-0.05678902799999467*kSq[5]-0.03975231959999626*kSq[4]-0.01333333333333333*kSq[3]-0.4444444444444444*epsilon[0]*rdx2Sq[1]+0.03849001794597505*kSq[1]-0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[4], globalIdxs[1], 0.03442651863295482*kSq[7]-0.03442651863295482*kSq[6]+0.09938079899999068*kSq[5]+0.09938079899999068*kSq[4]+0.02666666666666666*kSq[3]+0.0769800358919501*kSq[2]-0.0769800358919501*kSq[1]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[4], globalIdxs[2], (-0.0295084445425327*kSq[7])+0.03442651863295482*kSq[6]-0.063887656499994*kSq[5]-0.05962847939999439*kSq[4]+0.05333333333333333*kSq[3]+0.03849001794597505*kSq[2]-0.8888888888888888*epsilon[0]*rdx2Sq[1]+0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[4], globalIdxs[3], 0.1135780559999893*kSq[5]+0.07950463919999252*kSq[4]+0.8888888888888888*epsilon[0]*rdx2Sq[1]-0.5333333333333333*epsilon[0]*rdx2Sq[0]-0.1777777777777778*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[4], globalIdxs[4], 0.1967229636168847*kSq[7]+0.2271561119999787*kSq[5]-0.07950463919999252*kSq[4]+1.777777777777778*epsilon[0]*rdx2Sq[1]-0.3079201435678004*kSq[1]+0.5333333333333333*epsilon[0]*rdx2Sq[0]-0.3555555555555556*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[4], globalIdxs[5], (-0.01721325931647741*kSq[7])-0.05678902799999467*kSq[5]-0.03975231959999626*kSq[4]+0.01333333333333333*kSq[3]-0.4444444444444444*epsilon[0]*rdx2Sq[1]+0.03849001794597505*kSq[1]-0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[4], globalIdxs[6], 0.03442651863295482*kSq[7]+0.03442651863295482*kSq[6]+0.09938079899999068*kSq[5]+0.09938079899999068*kSq[4]-0.02666666666666666*kSq[3]-0.0769800358919501*kSq[2]-0.0769800358919501*kSq[1]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[4], globalIdxs[7], (-0.0295084445425327*kSq[7])-0.03442651863295482*kSq[6]-0.063887656499994*kSq[5]-0.05962847939999439*kSq[4]-0.05333333333333333*kSq[3]-0.03849001794597505*kSq[2]-0.8888888888888888*epsilon[0]*rdx2Sq[1]+0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[5], globalIdxs[0], (-0.006147592613027645*kSq[7])+0.02697478829999747*kSq[5]+0.03336355394999686*kSq[4]+0.3111111111111111*epsilon[0]*rdx2Sq[1]-0.01924500897298752*kSq[1]+0.1888888888888889*epsilon[0]*rdx2Sq[0]-0.02222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[5], globalIdxs[1], 0.01721325931647741*kSq[6]-0.03975231959999626*kSq[5]-0.05678902799999467*kSq[4]+0.01333333333333333*kSq[3]-0.03849001794597505*kSq[2]-0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.4444444444444444*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[5], globalIdxs[2], 0.0234254740499978*kSq[5]+0.0234254740499978*kSq[4]-0.01333333333333333*kSq[3]+0.2555555555555555*epsilon[0]*rdx2Sq[1]+0.2555555555555555*epsilon[0]*rdx2Sq[0]-0.03333333333333333*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[5], globalIdxs[3], 0.0295084445425327*kSq[7]-0.03442651863295482*kSq[6]-0.063887656499994*kSq[5]-0.05962847939999439*kSq[4]+0.05333333333333333*kSq[3]-0.03849001794597505*kSq[2]-0.8888888888888888*epsilon[0]*rdx2Sq[1]+0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[5], globalIdxs[4], (-0.01721325931647741*kSq[7])-0.05678902799999467*kSq[5]-0.03975231959999626*kSq[4]+0.01333333333333333*kSq[3]-0.4444444444444444*epsilon[0]*rdx2Sq[1]+0.03849001794597505*kSq[1]-0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[5], globalIdxs[5], 0.04549218533640458*kSq[7]-0.04549218533640458*kSq[6]-0.0127775312999988*kSq[5]-0.0127775312999988*kSq[4]+0.04666666666666667*kSq[3]-0.03849001794597505*kSq[2]+0.5777777777777777*epsilon[0]*rdx2Sq[1]+0.03849001794597505*kSq[1]+0.5777777777777777*epsilon[0]*rdx2Sq[0]-0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[5], globalIdxs[6], 0.03442651863295482*kSq[7]-0.0295084445425327*kSq[6]-0.05962847939999439*kSq[5]-0.063887656499994*kSq[4]+0.05333333333333333*kSq[3]+0.06666666666666667*epsilon[0]*rdx2Sq[1]+0.03849001794597505*kSq[1]-0.8888888888888888*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[5], globalIdxs[7], 0.006147592613027645*kSq[6]+0.03336355394999686*kSq[5]+0.02697478829999747*kSq[4]+0.01924500897298752*kSq[2]+0.1888888888888889*epsilon[0]*rdx2Sq[1]+0.3111111111111111*epsilon[0]*rdx2Sq[0]-0.02222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[6], globalIdxs[0], (-0.01721325931647741*kSq[6])-0.03975231959999626*kSq[5]-0.05678902799999467*kSq[4]-0.01333333333333333*kSq[3]+0.03849001794597505*kSq[2]-0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.4444444444444444*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[6], globalIdxs[1], 0.07950463919999252*kSq[5]+0.1135780559999893*kSq[4]-0.5333333333333333*epsilon[0]*rdx2Sq[1]+0.8888888888888888*epsilon[0]*rdx2Sq[0]-0.1777777777777778*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[6], globalIdxs[2], (-0.01721325931647741*kSq[6])-0.03975231959999626*kSq[5]-0.05678902799999467*kSq[4]+0.01333333333333333*kSq[3]+0.03849001794597505*kSq[2]-0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.4444444444444444*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[6], globalIdxs[3], (-0.03442651863295482*kSq[7])+0.03442651863295482*kSq[6]+0.09938079899999068*kSq[5]+0.09938079899999068*kSq[4]+0.02666666666666666*kSq[3]-0.0769800358919501*kSq[2]+0.0769800358919501*kSq[1]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[6], globalIdxs[4], 0.03442651863295482*kSq[7]+0.03442651863295482*kSq[6]+0.09938079899999068*kSq[5]+0.09938079899999068*kSq[4]-0.02666666666666666*kSq[3]-0.0769800358919501*kSq[2]-0.0769800358919501*kSq[1]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[6], globalIdxs[5], 0.03442651863295482*kSq[7]-0.0295084445425327*kSq[6]-0.05962847939999439*kSq[5]-0.063887656499994*kSq[4]+0.05333333333333333*kSq[3]+0.06666666666666667*epsilon[0]*rdx2Sq[1]+0.03849001794597505*kSq[1]-0.8888888888888888*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[6], globalIdxs[6], 0.1967229636168847*kSq[6]-0.07950463919999252*kSq[5]+0.2271561119999787*kSq[4]-0.3079201435678004*kSq[2]+0.5333333333333333*epsilon[0]*rdx2Sq[1]+1.777777777777778*epsilon[0]*rdx2Sq[0]-0.3555555555555556*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[6], globalIdxs[7], (-0.03442651863295482*kSq[7])-0.0295084445425327*kSq[6]-0.05962847939999439*kSq[5]-0.063887656499994*kSq[4]-0.05333333333333333*kSq[3]+0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.03849001794597505*kSq[1]-0.8888888888888888*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[7], globalIdxs[0], 0.0234254740499978*kSq[5]+0.0234254740499978*kSq[4]+0.01333333333333333*kSq[3]+0.2555555555555555*epsilon[0]*rdx2Sq[1]+0.2555555555555555*epsilon[0]*rdx2Sq[0]-0.03333333333333333*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[7], globalIdxs[1], 0.01721325931647741*kSq[6]-0.03975231959999626*kSq[5]-0.05678902799999467*kSq[4]-0.01333333333333333*kSq[3]-0.03849001794597505*kSq[2]-0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.4444444444444444*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[7], globalIdxs[2], 0.006147592613027645*kSq[7]+0.02697478829999747*kSq[5]+0.03336355394999686*kSq[4]+0.3111111111111111*epsilon[0]*rdx2Sq[1]+0.01924500897298752*kSq[1]+0.1888888888888889*epsilon[0]*rdx2Sq[0]-0.02222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[7], globalIdxs[3], 0.01721325931647741*kSq[7]-0.05678902799999467*kSq[5]-0.03975231959999626*kSq[4]-0.01333333333333333*kSq[3]-0.4444444444444444*epsilon[0]*rdx2Sq[1]-0.03849001794597505*kSq[1]-0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[7], globalIdxs[4], (-0.0295084445425327*kSq[7])-0.03442651863295482*kSq[6]-0.063887656499994*kSq[5]-0.05962847939999439*kSq[4]-0.05333333333333333*kSq[3]-0.03849001794597505*kSq[2]-0.8888888888888888*epsilon[0]*rdx2Sq[1]+0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[7], globalIdxs[5], 0.006147592613027645*kSq[6]+0.03336355394999686*kSq[5]+0.02697478829999747*kSq[4]+0.01924500897298752*kSq[2]+0.1888888888888889*epsilon[0]*rdx2Sq[1]+0.3111111111111111*epsilon[0]*rdx2Sq[0]-0.02222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[7], globalIdxs[6], (-0.03442651863295482*kSq[7])-0.0295084445425327*kSq[6]-0.05962847939999439*kSq[5]-0.063887656499994*kSq[4]-0.05333333333333333*kSq[3]+0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.03849001794597505*kSq[1]-0.8888888888888888*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[7], globalIdxs[7], (-0.04549218533640458*kSq[7])-0.04549218533640458*kSq[6]-0.0127775312999988*kSq[5]-0.0127775312999988*kSq[4]-0.04666666666666667*kSq[3]-0.03849001794597505*kSq[2]+0.5777777777777777*epsilon[0]*rdx2Sq[1]-0.03849001794597505*kSq[1]+0.5777777777777777*epsilon[0]*rdx2Sq[0]-0.06666666666666667*kSq[0]);

}
void fem_poisson_lhs_stencil_consteps_2x_ser_p1_lox_neumannx_upy_robiny(const double *epsilon, const double *kSq, const double *dx, const double *bcVals, const long *globalIdxs, gkyl_mat_triples *tri) 
{ 
  // epsilon: permittivity.
  // kSq: wave number squared (factor multiplying phi).
  // dx: cell length in each direction.
  // bcVals[3]: values to impose as BCs, i.e. bcVals[0]*phi+bcVals[1]*d(phi)/dx=bcVals[2].
  // globalIdxs: global linear index of each basis function/node in current cell.
  // tri: triples object (i,j,val), i.e. contribute val to i,j element of the global matrix.

  double rdx2Sq[2];
  rdx2Sq[0] = 4.0/(dx[0]*dx[0]);
  rdx2Sq[1] = 4.0/(dx[1]*dx[1]);

  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[0], (-0.1666666666666667*kSq[3])+0.1924500897298752*kSq[2]+0.3333333333333333*epsilon[0]*rdx2Sq[1]+0.1924500897298752*kSq[1]+0.3333333333333333*epsilon[0]*rdx2Sq[0]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[1], 0.09622504486493762*kSq[2]+0.1666666666666667*epsilon[0]*rdx2Sq[1]-0.3333333333333333*epsilon[0]*rdx2Sq[0]-0.1111111111111111*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[2], (-0.3333333333333333*epsilon[0]*rdx2Sq[1])+0.09622504486493762*kSq[1]+0.1666666666666667*epsilon[0]*rdx2Sq[0]-0.1111111111111111*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[3], (-0.1666666666666667*epsilon[0]*rdx2Sq[1])-0.1666666666666667*epsilon[0]*rdx2Sq[0]-0.05555555555555555*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[0], 0.09622504486493762*kSq[2]+0.1666666666666667*epsilon[0]*rdx2Sq[1]-0.3333333333333333*epsilon[0]*rdx2Sq[0]-0.1111111111111111*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[1], 0.1666666666666667*kSq[3]+0.1924500897298752*kSq[2]+0.3333333333333333*epsilon[0]*rdx2Sq[1]-0.1924500897298752*kSq[1]+0.3333333333333333*epsilon[0]*rdx2Sq[0]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[2], (-0.1666666666666667*epsilon[0]*rdx2Sq[1])-0.1666666666666667*epsilon[0]*rdx2Sq[0]-0.05555555555555555*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[3], (-0.3333333333333333*epsilon[0]*rdx2Sq[1])-0.09622504486493762*kSq[1]+0.1666666666666667*epsilon[0]*rdx2Sq[0]-0.1111111111111111*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[0], (-0.3333333333333333*epsilon[0]*rdx2Sq[1])+0.09622504486493762*kSq[1]+0.1666666666666667*epsilon[0]*rdx2Sq[0]-0.1111111111111111*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[1], (-0.1666666666666667*epsilon[0]*rdx2Sq[1])-0.1666666666666667*epsilon[0]*rdx2Sq[0]-0.05555555555555555*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[2], (0.6666666666666666*epsilon[0]*rdx2Sq[1]*bcVals[9])/bcVals[10]+0.1666666666666667*kSq[3]-0.1924500897298752*kSq[2]+0.3333333333333333*epsilon[0]*rdx2Sq[1]+0.1924500897298752*kSq[1]+0.3333333333333333*epsilon[0]*rdx2Sq[0]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[3], (0.3333333333333333*epsilon[0]*rdx2Sq[1]*bcVals[9])/bcVals[10]-0.09622504486493762*kSq[2]+0.1666666666666667*epsilon[0]*rdx2Sq[1]-0.3333333333333333*epsilon[0]*rdx2Sq[0]-0.1111111111111111*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[0], (-0.1666666666666667*epsilon[0]*rdx2Sq[1])-0.1666666666666667*epsilon[0]*rdx2Sq[0]-0.05555555555555555*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[1], (-0.3333333333333333*epsilon[0]*rdx2Sq[1])-0.09622504486493762*kSq[1]+0.1666666666666667*epsilon[0]*rdx2Sq[0]-0.1111111111111111*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[2], (0.3333333333333333*epsilon[0]*rdx2Sq[1]*bcVals[9])/bcVals[10]-0.09622504486493762*kSq[2]+0.1666666666666667*epsilon[0]*rdx2Sq[1]-0.3333333333333333*epsilon[0]*rdx2Sq[0]-0.1111111111111111*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[3], (0.6666666666666666*epsilon[0]*rdx2Sq[1]*bcVals[9])/bcVals[10]-0.1666666666666667*kSq[3]-0.1924500897298752*kSq[2]+0.3333333333333333*epsilon[0]*rdx2Sq[1]-0.1924500897298752*kSq[1]+0.3333333333333333*epsilon[0]*rdx2Sq[0]-0.2222222222222222*kSq[0]);

}
void fem_poisson_lhs_stencil_consteps_2x_ser_p2_lox_neumannx_upy_robiny(const double *epsilon, const double *kSq, const double *dx, const double *bcVals, const long *globalIdxs, gkyl_mat_triples *tri) 
{ 
  // epsilon: permittivity.
  // kSq: wave number squared (factor multiplying phi).
  // dx: cell length in each direction.
  // bcVals[3]: values to impose as BCs, i.e. bcVals[0]*phi+bcVals[1]*d(phi)/dx=bcVals[2].
  // globalIdxs: global linear index of each basis function/node in current cell.
  // tri: triples object (i,j,val), i.e. contribute val to i,j element of the global matrix.

  double rdx2Sq[2];
  rdx2Sq[0] = 4.0/(dx[0]*dx[0]);
  rdx2Sq[1] = 4.0/(dx[1]*dx[1]);

  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[0], 0.04549218533640458*kSq[7]+0.04549218533640458*kSq[6]-0.0127775312999988*kSq[5]-0.0127775312999988*kSq[4]-0.04666666666666667*kSq[3]+0.03849001794597505*kSq[2]+0.5777777777777777*epsilon[0]*rdx2Sq[1]+0.03849001794597505*kSq[1]+0.5777777777777777*epsilon[0]*rdx2Sq[0]-0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[1], 0.03442651863295482*kSq[7]+0.0295084445425327*kSq[6]-0.05962847939999439*kSq[5]-0.063887656499994*kSq[4]-0.05333333333333333*kSq[3]+0.06666666666666667*epsilon[0]*rdx2Sq[1]+0.03849001794597505*kSq[1]-0.8888888888888888*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[2], (-0.006147592613027645*kSq[6])+0.03336355394999686*kSq[5]+0.02697478829999747*kSq[4]-0.01924500897298752*kSq[2]+0.1888888888888889*epsilon[0]*rdx2Sq[1]+0.3111111111111111*epsilon[0]*rdx2Sq[0]-0.02222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[3], 0.0295084445425327*kSq[7]+0.03442651863295482*kSq[6]-0.063887656499994*kSq[5]-0.05962847939999439*kSq[4]-0.05333333333333333*kSq[3]+0.03849001794597505*kSq[2]-0.8888888888888888*epsilon[0]*rdx2Sq[1]+0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[4], (-0.01721325931647741*kSq[7])-0.05678902799999467*kSq[5]-0.03975231959999626*kSq[4]-0.01333333333333333*kSq[3]-0.4444444444444444*epsilon[0]*rdx2Sq[1]+0.03849001794597505*kSq[1]-0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[5], (-0.006147592613027645*kSq[7])+0.02697478829999747*kSq[5]+0.03336355394999686*kSq[4]+0.3111111111111111*epsilon[0]*rdx2Sq[1]-0.01924500897298752*kSq[1]+0.1888888888888889*epsilon[0]*rdx2Sq[0]-0.02222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[6], (-0.01721325931647741*kSq[6])-0.03975231959999626*kSq[5]-0.05678902799999467*kSq[4]-0.01333333333333333*kSq[3]+0.03849001794597505*kSq[2]-0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.4444444444444444*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[7], 0.0234254740499978*kSq[5]+0.0234254740499978*kSq[4]+0.01333333333333333*kSq[3]+0.2555555555555555*epsilon[0]*rdx2Sq[1]+0.2555555555555555*epsilon[0]*rdx2Sq[0]-0.03333333333333333*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[0], 0.03442651863295482*kSq[7]+0.0295084445425327*kSq[6]-0.05962847939999439*kSq[5]-0.063887656499994*kSq[4]-0.05333333333333333*kSq[3]+0.06666666666666667*epsilon[0]*rdx2Sq[1]+0.03849001794597505*kSq[1]-0.8888888888888888*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[1], (-0.1967229636168847*kSq[6])-0.07950463919999252*kSq[5]+0.2271561119999787*kSq[4]+0.3079201435678004*kSq[2]+0.5333333333333333*epsilon[0]*rdx2Sq[1]+1.777777777777778*epsilon[0]*rdx2Sq[0]-0.3555555555555556*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[2], (-0.03442651863295482*kSq[7])+0.0295084445425327*kSq[6]-0.05962847939999439*kSq[5]-0.063887656499994*kSq[4]+0.05333333333333333*kSq[3]+0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.03849001794597505*kSq[1]-0.8888888888888888*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[3], (-0.03442651863295482*kSq[7])-0.03442651863295482*kSq[6]+0.09938079899999068*kSq[5]+0.09938079899999068*kSq[4]-0.02666666666666666*kSq[3]+0.0769800358919501*kSq[2]+0.0769800358919501*kSq[1]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[4], 0.03442651863295482*kSq[7]-0.03442651863295482*kSq[6]+0.09938079899999068*kSq[5]+0.09938079899999068*kSq[4]+0.02666666666666666*kSq[3]+0.0769800358919501*kSq[2]-0.0769800358919501*kSq[1]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[5], 0.01721325931647741*kSq[6]-0.03975231959999626*kSq[5]-0.05678902799999467*kSq[4]+0.01333333333333333*kSq[3]-0.03849001794597505*kSq[2]-0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.4444444444444444*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[6], 0.07950463919999252*kSq[5]+0.1135780559999893*kSq[4]-0.5333333333333333*epsilon[0]*rdx2Sq[1]+0.8888888888888888*epsilon[0]*rdx2Sq[0]-0.1777777777777778*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[7], 0.01721325931647741*kSq[6]-0.03975231959999626*kSq[5]-0.05678902799999467*kSq[4]-0.01333333333333333*kSq[3]-0.03849001794597505*kSq[2]-0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.4444444444444444*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[0], (-0.006147592613027645*kSq[6])+0.03336355394999686*kSq[5]+0.02697478829999747*kSq[4]-0.01924500897298752*kSq[2]+0.1888888888888889*epsilon[0]*rdx2Sq[1]+0.3111111111111111*epsilon[0]*rdx2Sq[0]-0.02222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[1], (-0.03442651863295482*kSq[7])+0.0295084445425327*kSq[6]-0.05962847939999439*kSq[5]-0.063887656499994*kSq[4]+0.05333333333333333*kSq[3]+0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.03849001794597505*kSq[1]-0.8888888888888888*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[2], (-0.04549218533640458*kSq[7])+0.04549218533640458*kSq[6]-0.0127775312999988*kSq[5]-0.0127775312999988*kSq[4]+0.04666666666666667*kSq[3]+0.03849001794597505*kSq[2]+0.5777777777777777*epsilon[0]*rdx2Sq[1]-0.03849001794597505*kSq[1]+0.5777777777777777*epsilon[0]*rdx2Sq[0]-0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[3], 0.01721325931647741*kSq[7]-0.05678902799999467*kSq[5]-0.03975231959999626*kSq[4]+0.01333333333333333*kSq[3]-0.4444444444444444*epsilon[0]*rdx2Sq[1]-0.03849001794597505*kSq[1]-0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[4], (-0.0295084445425327*kSq[7])+0.03442651863295482*kSq[6]-0.063887656499994*kSq[5]-0.05962847939999439*kSq[4]+0.05333333333333333*kSq[3]+0.03849001794597505*kSq[2]-0.8888888888888888*epsilon[0]*rdx2Sq[1]+0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[5], 0.0234254740499978*kSq[5]+0.0234254740499978*kSq[4]-0.01333333333333333*kSq[3]+0.2555555555555555*epsilon[0]*rdx2Sq[1]+0.2555555555555555*epsilon[0]*rdx2Sq[0]-0.03333333333333333*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[6], (-0.01721325931647741*kSq[6])-0.03975231959999626*kSq[5]-0.05678902799999467*kSq[4]+0.01333333333333333*kSq[3]+0.03849001794597505*kSq[2]-0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.4444444444444444*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[7], 0.006147592613027645*kSq[7]+0.02697478829999747*kSq[5]+0.03336355394999686*kSq[4]+0.3111111111111111*epsilon[0]*rdx2Sq[1]+0.01924500897298752*kSq[1]+0.1888888888888889*epsilon[0]*rdx2Sq[0]-0.02222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[0], 0.0295084445425327*kSq[7]+0.03442651863295482*kSq[6]-0.063887656499994*kSq[5]-0.05962847939999439*kSq[4]-0.05333333333333333*kSq[3]+0.03849001794597505*kSq[2]-0.8888888888888888*epsilon[0]*rdx2Sq[1]+0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[1], (-0.03442651863295482*kSq[7])-0.03442651863295482*kSq[6]+0.09938079899999068*kSq[5]+0.09938079899999068*kSq[4]-0.02666666666666666*kSq[3]+0.0769800358919501*kSq[2]+0.0769800358919501*kSq[1]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[2], 0.01721325931647741*kSq[7]-0.05678902799999467*kSq[5]-0.03975231959999626*kSq[4]+0.01333333333333333*kSq[3]-0.4444444444444444*epsilon[0]*rdx2Sq[1]-0.03849001794597505*kSq[1]-0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[3], (-0.1967229636168847*kSq[7])+0.2271561119999787*kSq[5]-0.07950463919999252*kSq[4]+1.777777777777778*epsilon[0]*rdx2Sq[1]+0.3079201435678004*kSq[1]+0.5333333333333333*epsilon[0]*rdx2Sq[0]-0.3555555555555556*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[4], 0.1135780559999893*kSq[5]+0.07950463919999252*kSq[4]+0.8888888888888888*epsilon[0]*rdx2Sq[1]-0.5333333333333333*epsilon[0]*rdx2Sq[0]-0.1777777777777778*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[5], 0.0295084445425327*kSq[7]-0.03442651863295482*kSq[6]-0.063887656499994*kSq[5]-0.05962847939999439*kSq[4]+0.05333333333333333*kSq[3]-0.03849001794597505*kSq[2]-0.8888888888888888*epsilon[0]*rdx2Sq[1]+0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[6], (-0.03442651863295482*kSq[7])+0.03442651863295482*kSq[6]+0.09938079899999068*kSq[5]+0.09938079899999068*kSq[4]+0.02666666666666666*kSq[3]-0.0769800358919501*kSq[2]+0.0769800358919501*kSq[1]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[7], 0.01721325931647741*kSq[7]-0.05678902799999467*kSq[5]-0.03975231959999626*kSq[4]-0.01333333333333333*kSq[3]-0.4444444444444444*epsilon[0]*rdx2Sq[1]-0.03849001794597505*kSq[1]-0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[4], globalIdxs[0], (-0.01721325931647741*kSq[7])-0.05678902799999467*kSq[5]-0.03975231959999626*kSq[4]-0.01333333333333333*kSq[3]-0.4444444444444444*epsilon[0]*rdx2Sq[1]+0.03849001794597505*kSq[1]-0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[4], globalIdxs[1], 0.03442651863295482*kSq[7]-0.03442651863295482*kSq[6]+0.09938079899999068*kSq[5]+0.09938079899999068*kSq[4]+0.02666666666666666*kSq[3]+0.0769800358919501*kSq[2]-0.0769800358919501*kSq[1]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[4], globalIdxs[2], (-0.0295084445425327*kSq[7])+0.03442651863295482*kSq[6]-0.063887656499994*kSq[5]-0.05962847939999439*kSq[4]+0.05333333333333333*kSq[3]+0.03849001794597505*kSq[2]-0.8888888888888888*epsilon[0]*rdx2Sq[1]+0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[4], globalIdxs[3], 0.1135780559999893*kSq[5]+0.07950463919999252*kSq[4]+0.8888888888888888*epsilon[0]*rdx2Sq[1]-0.5333333333333333*epsilon[0]*rdx2Sq[0]-0.1777777777777778*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[4], globalIdxs[4], 0.1967229636168847*kSq[7]+0.2271561119999787*kSq[5]-0.07950463919999252*kSq[4]+1.777777777777778*epsilon[0]*rdx2Sq[1]-0.3079201435678004*kSq[1]+0.5333333333333333*epsilon[0]*rdx2Sq[0]-0.3555555555555556*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[4], globalIdxs[5], (-0.01721325931647741*kSq[7])-0.05678902799999467*kSq[5]-0.03975231959999626*kSq[4]+0.01333333333333333*kSq[3]-0.4444444444444444*epsilon[0]*rdx2Sq[1]+0.03849001794597505*kSq[1]-0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[4], globalIdxs[6], 0.03442651863295482*kSq[7]+0.03442651863295482*kSq[6]+0.09938079899999068*kSq[5]+0.09938079899999068*kSq[4]-0.02666666666666666*kSq[3]-0.0769800358919501*kSq[2]-0.0769800358919501*kSq[1]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[4], globalIdxs[7], (-0.0295084445425327*kSq[7])-0.03442651863295482*kSq[6]-0.063887656499994*kSq[5]-0.05962847939999439*kSq[4]-0.05333333333333333*kSq[3]-0.03849001794597505*kSq[2]-0.8888888888888888*epsilon[0]*rdx2Sq[1]+0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[5], globalIdxs[0], (-0.006147592613027645*kSq[7])+0.02697478829999747*kSq[5]+0.03336355394999686*kSq[4]+0.3111111111111111*epsilon[0]*rdx2Sq[1]-0.01924500897298752*kSq[1]+0.1888888888888889*epsilon[0]*rdx2Sq[0]-0.02222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[5], globalIdxs[1], 0.01721325931647741*kSq[6]-0.03975231959999626*kSq[5]-0.05678902799999467*kSq[4]+0.01333333333333333*kSq[3]-0.03849001794597505*kSq[2]-0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.4444444444444444*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[5], globalIdxs[2], 0.0234254740499978*kSq[5]+0.0234254740499978*kSq[4]-0.01333333333333333*kSq[3]+0.2555555555555555*epsilon[0]*rdx2Sq[1]+0.2555555555555555*epsilon[0]*rdx2Sq[0]-0.03333333333333333*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[5], globalIdxs[3], 0.0295084445425327*kSq[7]-0.03442651863295482*kSq[6]-0.063887656499994*kSq[5]-0.05962847939999439*kSq[4]+0.05333333333333333*kSq[3]-0.03849001794597505*kSq[2]-0.8888888888888888*epsilon[0]*rdx2Sq[1]+0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[5], globalIdxs[4], (-0.01721325931647741*kSq[7])-0.05678902799999467*kSq[5]-0.03975231959999626*kSq[4]+0.01333333333333333*kSq[3]-0.4444444444444444*epsilon[0]*rdx2Sq[1]+0.03849001794597505*kSq[1]-0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[5], globalIdxs[5], (0.2666666666666667*epsilon[0]*rdx2Sq[1]*bcVals[9])/bcVals[10]+0.04549218533640458*kSq[7]-0.04549218533640458*kSq[6]-0.0127775312999988*kSq[5]-0.0127775312999988*kSq[4]+0.04666666666666667*kSq[3]-0.03849001794597505*kSq[2]+0.5777777777777777*epsilon[0]*rdx2Sq[1]+0.03849001794597505*kSq[1]+0.5777777777777777*epsilon[0]*rdx2Sq[0]-0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[5], globalIdxs[6], (0.1333333333333333*epsilon[0]*rdx2Sq[1]*bcVals[9])/bcVals[10]+0.03442651863295482*kSq[7]-0.0295084445425327*kSq[6]-0.05962847939999439*kSq[5]-0.063887656499994*kSq[4]+0.05333333333333333*kSq[3]+0.06666666666666667*epsilon[0]*rdx2Sq[1]+0.03849001794597505*kSq[1]-0.8888888888888888*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[5], globalIdxs[7], (-(0.06666666666666667*epsilon[0]*rdx2Sq[1]*bcVals[9])/bcVals[10])+0.006147592613027645*kSq[6]+0.03336355394999686*kSq[5]+0.02697478829999747*kSq[4]+0.01924500897298752*kSq[2]+0.1888888888888889*epsilon[0]*rdx2Sq[1]+0.3111111111111111*epsilon[0]*rdx2Sq[0]-0.02222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[6], globalIdxs[0], (-0.01721325931647741*kSq[6])-0.03975231959999626*kSq[5]-0.05678902799999467*kSq[4]-0.01333333333333333*kSq[3]+0.03849001794597505*kSq[2]-0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.4444444444444444*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[6], globalIdxs[1], 0.07950463919999252*kSq[5]+0.1135780559999893*kSq[4]-0.5333333333333333*epsilon[0]*rdx2Sq[1]+0.8888888888888888*epsilon[0]*rdx2Sq[0]-0.1777777777777778*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[6], globalIdxs[2], (-0.01721325931647741*kSq[6])-0.03975231959999626*kSq[5]-0.05678902799999467*kSq[4]+0.01333333333333333*kSq[3]+0.03849001794597505*kSq[2]-0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.4444444444444444*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[6], globalIdxs[3], (-0.03442651863295482*kSq[7])+0.03442651863295482*kSq[6]+0.09938079899999068*kSq[5]+0.09938079899999068*kSq[4]+0.02666666666666666*kSq[3]-0.0769800358919501*kSq[2]+0.0769800358919501*kSq[1]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[6], globalIdxs[4], 0.03442651863295482*kSq[7]+0.03442651863295482*kSq[6]+0.09938079899999068*kSq[5]+0.09938079899999068*kSq[4]-0.02666666666666666*kSq[3]-0.0769800358919501*kSq[2]-0.0769800358919501*kSq[1]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[6], globalIdxs[5], (0.1333333333333333*epsilon[0]*rdx2Sq[1]*bcVals[9])/bcVals[10]+0.03442651863295482*kSq[7]-0.0295084445425327*kSq[6]-0.05962847939999439*kSq[5]-0.063887656499994*kSq[4]+0.05333333333333333*kSq[3]+0.06666666666666667*epsilon[0]*rdx2Sq[1]+0.03849001794597505*kSq[1]-0.8888888888888888*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[6], globalIdxs[6], (1.066666666666667*epsilon[0]*rdx2Sq[1]*bcVals[9])/bcVals[10]+0.1967229636168847*kSq[6]-0.07950463919999252*kSq[5]+0.2271561119999787*kSq[4]-0.3079201435678004*kSq[2]+0.5333333333333333*epsilon[0]*rdx2Sq[1]+1.777777777777778*epsilon[0]*rdx2Sq[0]-0.3555555555555556*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[6], globalIdxs[7], (0.1333333333333333*epsilon[0]*rdx2Sq[1]*bcVals[9])/bcVals[10]-0.03442651863295482*kSq[7]-0.0295084445425327*kSq[6]-0.05962847939999439*kSq[5]-0.063887656499994*kSq[4]-0.05333333333333333*kSq[3]+0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.03849001794597505*kSq[1]-0.8888888888888888*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[7], globalIdxs[0], 0.0234254740499978*kSq[5]+0.0234254740499978*kSq[4]+0.01333333333333333*kSq[3]+0.2555555555555555*epsilon[0]*rdx2Sq[1]+0.2555555555555555*epsilon[0]*rdx2Sq[0]-0.03333333333333333*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[7], globalIdxs[1], 0.01721325931647741*kSq[6]-0.03975231959999626*kSq[5]-0.05678902799999467*kSq[4]-0.01333333333333333*kSq[3]-0.03849001794597505*kSq[2]-0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.4444444444444444*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[7], globalIdxs[2], 0.006147592613027645*kSq[7]+0.02697478829999747*kSq[5]+0.03336355394999686*kSq[4]+0.3111111111111111*epsilon[0]*rdx2Sq[1]+0.01924500897298752*kSq[1]+0.1888888888888889*epsilon[0]*rdx2Sq[0]-0.02222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[7], globalIdxs[3], 0.01721325931647741*kSq[7]-0.05678902799999467*kSq[5]-0.03975231959999626*kSq[4]-0.01333333333333333*kSq[3]-0.4444444444444444*epsilon[0]*rdx2Sq[1]-0.03849001794597505*kSq[1]-0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[7], globalIdxs[4], (-0.0295084445425327*kSq[7])-0.03442651863295482*kSq[6]-0.063887656499994*kSq[5]-0.05962847939999439*kSq[4]-0.05333333333333333*kSq[3]-0.03849001794597505*kSq[2]-0.8888888888888888*epsilon[0]*rdx2Sq[1]+0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[7], globalIdxs[5], (-(0.06666666666666667*epsilon[0]*rdx2Sq[1]*bcVals[9])/bcVals[10])+0.006147592613027645*kSq[6]+0.03336355394999686*kSq[5]+0.02697478829999747*kSq[4]+0.01924500897298752*kSq[2]+0.1888888888888889*epsilon[0]*rdx2Sq[1]+0.3111111111111111*epsilon[0]*rdx2Sq[0]-0.02222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[7], globalIdxs[6], (0.1333333333333333*epsilon[0]*rdx2Sq[1]*bcVals[9])/bcVals[10]-0.03442651863295482*kSq[7]-0.0295084445425327*kSq[6]-0.05962847939999439*kSq[5]-0.063887656499994*kSq[4]-0.05333333333333333*kSq[3]+0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.03849001794597505*kSq[1]-0.8888888888888888*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[7], globalIdxs[7], (0.2666666666666667*epsilon[0]*rdx2Sq[1]*bcVals[9])/bcVals[10]-0.04549218533640458*kSq[7]-0.04549218533640458*kSq[6]-0.0127775312999988*kSq[5]-0.0127775312999988*kSq[4]-0.04666666666666667*kSq[3]-0.03849001794597505*kSq[2]+0.5777777777777777*epsilon[0]*rdx2Sq[1]-0.03849001794597505*kSq[1]+0.5777777777777777*epsilon[0]*rdx2Sq[0]-0.06666666666666667*kSq[0]);

}
void fem_poisson_lhs_stencil_consteps_2x_ser_p1_lox_robinx_upy_periodicy(const double *epsilon, const double *kSq, const double *dx, const double *bcVals, const long *globalIdxs, gkyl_mat_triples *tri) 
{ 
  // epsilon: permittivity.
  // kSq: wave number squared (factor multiplying phi).
  // dx: cell length in each direction.
  // bcVals[3]: values to impose as BCs, i.e. bcVals[0]*phi+bcVals[1]*d(phi)/dx=bcVals[2].
  // globalIdxs: global linear index of each basis function/node in current cell.
  // tri: triples object (i,j,val), i.e. contribute val to i,j element of the global matrix.

  double rdx2Sq[2];
  rdx2Sq[0] = 4.0/(dx[0]*dx[0]);
  rdx2Sq[1] = 4.0/(dx[1]*dx[1]);

  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[0], (-0.1666666666666667*kSq[3])+0.1924500897298752*kSq[2]+0.3333333333333333*epsilon[0]*rdx2Sq[1]+0.1924500897298752*kSq[1]-(0.6666666666666666*bcVals[0]*epsilon[0]*rdx2Sq[0])/bcVals[1]+0.3333333333333333*epsilon[0]*rdx2Sq[0]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[1], 0.09622504486493762*kSq[2]+0.1666666666666667*epsilon[0]*rdx2Sq[1]-0.3333333333333333*epsilon[0]*rdx2Sq[0]-0.1111111111111111*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[2], (-0.3333333333333333*epsilon[0]*rdx2Sq[1])+0.09622504486493762*kSq[1]-(0.3333333333333333*bcVals[0]*epsilon[0]*rdx2Sq[0])/bcVals[1]+0.1666666666666667*epsilon[0]*rdx2Sq[0]-0.1111111111111111*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[3], (-0.1666666666666667*epsilon[0]*rdx2Sq[1])-0.1666666666666667*epsilon[0]*rdx2Sq[0]-0.05555555555555555*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[0], 0.09622504486493762*kSq[2]+0.1666666666666667*epsilon[0]*rdx2Sq[1]-0.3333333333333333*epsilon[0]*rdx2Sq[0]-0.1111111111111111*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[1], 0.1666666666666667*kSq[3]+0.1924500897298752*kSq[2]+0.3333333333333333*epsilon[0]*rdx2Sq[1]-0.1924500897298752*kSq[1]+0.3333333333333333*epsilon[0]*rdx2Sq[0]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[2], (-0.1666666666666667*epsilon[0]*rdx2Sq[1])-0.1666666666666667*epsilon[0]*rdx2Sq[0]-0.05555555555555555*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[3], (-0.3333333333333333*epsilon[0]*rdx2Sq[1])-0.09622504486493762*kSq[1]+0.1666666666666667*epsilon[0]*rdx2Sq[0]-0.1111111111111111*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[0], (-0.3333333333333333*epsilon[0]*rdx2Sq[1])+0.09622504486493762*kSq[1]-(0.3333333333333333*bcVals[0]*epsilon[0]*rdx2Sq[0])/bcVals[1]+0.1666666666666667*epsilon[0]*rdx2Sq[0]-0.1111111111111111*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[1], (-0.1666666666666667*epsilon[0]*rdx2Sq[1])-0.1666666666666667*epsilon[0]*rdx2Sq[0]-0.05555555555555555*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[2], 0.1666666666666667*kSq[3]-0.1924500897298752*kSq[2]+0.3333333333333333*epsilon[0]*rdx2Sq[1]+0.1924500897298752*kSq[1]-(0.6666666666666666*bcVals[0]*epsilon[0]*rdx2Sq[0])/bcVals[1]+0.3333333333333333*epsilon[0]*rdx2Sq[0]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[3], (-0.09622504486493762*kSq[2])+0.1666666666666667*epsilon[0]*rdx2Sq[1]-0.3333333333333333*epsilon[0]*rdx2Sq[0]-0.1111111111111111*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[0], (-0.1666666666666667*epsilon[0]*rdx2Sq[1])-0.1666666666666667*epsilon[0]*rdx2Sq[0]-0.05555555555555555*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[1], (-0.3333333333333333*epsilon[0]*rdx2Sq[1])-0.09622504486493762*kSq[1]+0.1666666666666667*epsilon[0]*rdx2Sq[0]-0.1111111111111111*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[2], (-0.09622504486493762*kSq[2])+0.1666666666666667*epsilon[0]*rdx2Sq[1]-0.3333333333333333*epsilon[0]*rdx2Sq[0]-0.1111111111111111*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[3], (-0.1666666666666667*kSq[3])-0.1924500897298752*kSq[2]+0.3333333333333333*epsilon[0]*rdx2Sq[1]-0.1924500897298752*kSq[1]+0.3333333333333333*epsilon[0]*rdx2Sq[0]-0.2222222222222222*kSq[0]);

}
void fem_poisson_lhs_stencil_consteps_2x_ser_p2_lox_robinx_upy_periodicy(const double *epsilon, const double *kSq, const double *dx, const double *bcVals, const long *globalIdxs, gkyl_mat_triples *tri) 
{ 
  // epsilon: permittivity.
  // kSq: wave number squared (factor multiplying phi).
  // dx: cell length in each direction.
  // bcVals[3]: values to impose as BCs, i.e. bcVals[0]*phi+bcVals[1]*d(phi)/dx=bcVals[2].
  // globalIdxs: global linear index of each basis function/node in current cell.
  // tri: triples object (i,j,val), i.e. contribute val to i,j element of the global matrix.

  double rdx2Sq[2];
  rdx2Sq[0] = 4.0/(dx[0]*dx[0]);
  rdx2Sq[1] = 4.0/(dx[1]*dx[1]);

  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[0], 0.04549218533640458*kSq[7]+0.04549218533640458*kSq[6]-0.0127775312999988*kSq[5]-0.0127775312999988*kSq[4]-0.04666666666666667*kSq[3]+0.03849001794597505*kSq[2]+0.5777777777777777*epsilon[0]*rdx2Sq[1]+0.03849001794597505*kSq[1]-(0.2666666666666667*bcVals[0]*epsilon[0]*rdx2Sq[0])/bcVals[1]+0.5777777777777777*epsilon[0]*rdx2Sq[0]-0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[1], 0.03442651863295482*kSq[7]+0.0295084445425327*kSq[6]-0.05962847939999439*kSq[5]-0.063887656499994*kSq[4]-0.05333333333333333*kSq[3]+0.06666666666666667*epsilon[0]*rdx2Sq[1]+0.03849001794597505*kSq[1]-0.8888888888888888*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[2], (-0.006147592613027645*kSq[6])+0.03336355394999686*kSq[5]+0.02697478829999747*kSq[4]-0.01924500897298752*kSq[2]+0.1888888888888889*epsilon[0]*rdx2Sq[1]+0.3111111111111111*epsilon[0]*rdx2Sq[0]-0.02222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[3], 0.0295084445425327*kSq[7]+0.03442651863295482*kSq[6]-0.063887656499994*kSq[5]-0.05962847939999439*kSq[4]-0.05333333333333333*kSq[3]+0.03849001794597505*kSq[2]-0.8888888888888888*epsilon[0]*rdx2Sq[1]-(0.1333333333333333*bcVals[0]*epsilon[0]*rdx2Sq[0])/bcVals[1]+0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[4], (-0.01721325931647741*kSq[7])-0.05678902799999467*kSq[5]-0.03975231959999626*kSq[4]-0.01333333333333333*kSq[3]-0.4444444444444444*epsilon[0]*rdx2Sq[1]+0.03849001794597505*kSq[1]-0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[5], (-0.006147592613027645*kSq[7])+0.02697478829999747*kSq[5]+0.03336355394999686*kSq[4]+0.3111111111111111*epsilon[0]*rdx2Sq[1]-0.01924500897298752*kSq[1]+(0.06666666666666667*bcVals[0]*epsilon[0]*rdx2Sq[0])/bcVals[1]+0.1888888888888889*epsilon[0]*rdx2Sq[0]-0.02222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[6], (-0.01721325931647741*kSq[6])-0.03975231959999626*kSq[5]-0.05678902799999467*kSq[4]-0.01333333333333333*kSq[3]+0.03849001794597505*kSq[2]-0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.4444444444444444*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[7], 0.0234254740499978*kSq[5]+0.0234254740499978*kSq[4]+0.01333333333333333*kSq[3]+0.2555555555555555*epsilon[0]*rdx2Sq[1]+0.2555555555555555*epsilon[0]*rdx2Sq[0]-0.03333333333333333*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[0], 0.03442651863295482*kSq[7]+0.0295084445425327*kSq[6]-0.05962847939999439*kSq[5]-0.063887656499994*kSq[4]-0.05333333333333333*kSq[3]+0.06666666666666667*epsilon[0]*rdx2Sq[1]+0.03849001794597505*kSq[1]-0.8888888888888888*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[1], (-0.1967229636168847*kSq[6])-0.07950463919999252*kSq[5]+0.2271561119999787*kSq[4]+0.3079201435678004*kSq[2]+0.5333333333333333*epsilon[0]*rdx2Sq[1]+1.777777777777778*epsilon[0]*rdx2Sq[0]-0.3555555555555556*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[2], (-0.03442651863295482*kSq[7])+0.0295084445425327*kSq[6]-0.05962847939999439*kSq[5]-0.063887656499994*kSq[4]+0.05333333333333333*kSq[3]+0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.03849001794597505*kSq[1]-0.8888888888888888*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[3], (-0.03442651863295482*kSq[7])-0.03442651863295482*kSq[6]+0.09938079899999068*kSq[5]+0.09938079899999068*kSq[4]-0.02666666666666666*kSq[3]+0.0769800358919501*kSq[2]+0.0769800358919501*kSq[1]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[4], 0.03442651863295482*kSq[7]-0.03442651863295482*kSq[6]+0.09938079899999068*kSq[5]+0.09938079899999068*kSq[4]+0.02666666666666666*kSq[3]+0.0769800358919501*kSq[2]-0.0769800358919501*kSq[1]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[5], 0.01721325931647741*kSq[6]-0.03975231959999626*kSq[5]-0.05678902799999467*kSq[4]+0.01333333333333333*kSq[3]-0.03849001794597505*kSq[2]-0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.4444444444444444*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[6], 0.07950463919999252*kSq[5]+0.1135780559999893*kSq[4]-0.5333333333333333*epsilon[0]*rdx2Sq[1]+0.8888888888888888*epsilon[0]*rdx2Sq[0]-0.1777777777777778*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[7], 0.01721325931647741*kSq[6]-0.03975231959999626*kSq[5]-0.05678902799999467*kSq[4]-0.01333333333333333*kSq[3]-0.03849001794597505*kSq[2]-0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.4444444444444444*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[0], (-0.006147592613027645*kSq[6])+0.03336355394999686*kSq[5]+0.02697478829999747*kSq[4]-0.01924500897298752*kSq[2]+0.1888888888888889*epsilon[0]*rdx2Sq[1]+0.3111111111111111*epsilon[0]*rdx2Sq[0]-0.02222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[1], (-0.03442651863295482*kSq[7])+0.0295084445425327*kSq[6]-0.05962847939999439*kSq[5]-0.063887656499994*kSq[4]+0.05333333333333333*kSq[3]+0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.03849001794597505*kSq[1]-0.8888888888888888*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[2], (-0.04549218533640458*kSq[7])+0.04549218533640458*kSq[6]-0.0127775312999988*kSq[5]-0.0127775312999988*kSq[4]+0.04666666666666667*kSq[3]+0.03849001794597505*kSq[2]+0.5777777777777777*epsilon[0]*rdx2Sq[1]-0.03849001794597505*kSq[1]+0.5777777777777777*epsilon[0]*rdx2Sq[0]-0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[3], 0.01721325931647741*kSq[7]-0.05678902799999467*kSq[5]-0.03975231959999626*kSq[4]+0.01333333333333333*kSq[3]-0.4444444444444444*epsilon[0]*rdx2Sq[1]-0.03849001794597505*kSq[1]-0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[4], (-0.0295084445425327*kSq[7])+0.03442651863295482*kSq[6]-0.063887656499994*kSq[5]-0.05962847939999439*kSq[4]+0.05333333333333333*kSq[3]+0.03849001794597505*kSq[2]-0.8888888888888888*epsilon[0]*rdx2Sq[1]+0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[5], 0.0234254740499978*kSq[5]+0.0234254740499978*kSq[4]-0.01333333333333333*kSq[3]+0.2555555555555555*epsilon[0]*rdx2Sq[1]+0.2555555555555555*epsilon[0]*rdx2Sq[0]-0.03333333333333333*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[6], (-0.01721325931647741*kSq[6])-0.03975231959999626*kSq[5]-0.05678902799999467*kSq[4]+0.01333333333333333*kSq[3]+0.03849001794597505*kSq[2]-0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.4444444444444444*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[7], 0.006147592613027645*kSq[7]+0.02697478829999747*kSq[5]+0.03336355394999686*kSq[4]+0.3111111111111111*epsilon[0]*rdx2Sq[1]+0.01924500897298752*kSq[1]+0.1888888888888889*epsilon[0]*rdx2Sq[0]-0.02222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[0], 0.0295084445425327*kSq[7]+0.03442651863295482*kSq[6]-0.063887656499994*kSq[5]-0.05962847939999439*kSq[4]-0.05333333333333333*kSq[3]+0.03849001794597505*kSq[2]-0.8888888888888888*epsilon[0]*rdx2Sq[1]-(0.1333333333333333*bcVals[0]*epsilon[0]*rdx2Sq[0])/bcVals[1]+0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[1], (-0.03442651863295482*kSq[7])-0.03442651863295482*kSq[6]+0.09938079899999068*kSq[5]+0.09938079899999068*kSq[4]-0.02666666666666666*kSq[3]+0.0769800358919501*kSq[2]+0.0769800358919501*kSq[1]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[2], 0.01721325931647741*kSq[7]-0.05678902799999467*kSq[5]-0.03975231959999626*kSq[4]+0.01333333333333333*kSq[3]-0.4444444444444444*epsilon[0]*rdx2Sq[1]-0.03849001794597505*kSq[1]-0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[3], (-0.1967229636168847*kSq[7])+0.2271561119999787*kSq[5]-0.07950463919999252*kSq[4]+1.777777777777778*epsilon[0]*rdx2Sq[1]+0.3079201435678004*kSq[1]-(1.066666666666667*bcVals[0]*epsilon[0]*rdx2Sq[0])/bcVals[1]+0.5333333333333333*epsilon[0]*rdx2Sq[0]-0.3555555555555556*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[4], 0.1135780559999893*kSq[5]+0.07950463919999252*kSq[4]+0.8888888888888888*epsilon[0]*rdx2Sq[1]-0.5333333333333333*epsilon[0]*rdx2Sq[0]-0.1777777777777778*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[5], 0.0295084445425327*kSq[7]-0.03442651863295482*kSq[6]-0.063887656499994*kSq[5]-0.05962847939999439*kSq[4]+0.05333333333333333*kSq[3]-0.03849001794597505*kSq[2]-0.8888888888888888*epsilon[0]*rdx2Sq[1]-(0.1333333333333333*bcVals[0]*epsilon[0]*rdx2Sq[0])/bcVals[1]+0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[6], (-0.03442651863295482*kSq[7])+0.03442651863295482*kSq[6]+0.09938079899999068*kSq[5]+0.09938079899999068*kSq[4]+0.02666666666666666*kSq[3]-0.0769800358919501*kSq[2]+0.0769800358919501*kSq[1]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[7], 0.01721325931647741*kSq[7]-0.05678902799999467*kSq[5]-0.03975231959999626*kSq[4]-0.01333333333333333*kSq[3]-0.4444444444444444*epsilon[0]*rdx2Sq[1]-0.03849001794597505*kSq[1]-0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[4], globalIdxs[0], (-0.01721325931647741*kSq[7])-0.05678902799999467*kSq[5]-0.03975231959999626*kSq[4]-0.01333333333333333*kSq[3]-0.4444444444444444*epsilon[0]*rdx2Sq[1]+0.03849001794597505*kSq[1]-0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[4], globalIdxs[1], 0.03442651863295482*kSq[7]-0.03442651863295482*kSq[6]+0.09938079899999068*kSq[5]+0.09938079899999068*kSq[4]+0.02666666666666666*kSq[3]+0.0769800358919501*kSq[2]-0.0769800358919501*kSq[1]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[4], globalIdxs[2], (-0.0295084445425327*kSq[7])+0.03442651863295482*kSq[6]-0.063887656499994*kSq[5]-0.05962847939999439*kSq[4]+0.05333333333333333*kSq[3]+0.03849001794597505*kSq[2]-0.8888888888888888*epsilon[0]*rdx2Sq[1]+0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[4], globalIdxs[3], 0.1135780559999893*kSq[5]+0.07950463919999252*kSq[4]+0.8888888888888888*epsilon[0]*rdx2Sq[1]-0.5333333333333333*epsilon[0]*rdx2Sq[0]-0.1777777777777778*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[4], globalIdxs[4], 0.1967229636168847*kSq[7]+0.2271561119999787*kSq[5]-0.07950463919999252*kSq[4]+1.777777777777778*epsilon[0]*rdx2Sq[1]-0.3079201435678004*kSq[1]+0.5333333333333333*epsilon[0]*rdx2Sq[0]-0.3555555555555556*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[4], globalIdxs[5], (-0.01721325931647741*kSq[7])-0.05678902799999467*kSq[5]-0.03975231959999626*kSq[4]+0.01333333333333333*kSq[3]-0.4444444444444444*epsilon[0]*rdx2Sq[1]+0.03849001794597505*kSq[1]-0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[4], globalIdxs[6], 0.03442651863295482*kSq[7]+0.03442651863295482*kSq[6]+0.09938079899999068*kSq[5]+0.09938079899999068*kSq[4]-0.02666666666666666*kSq[3]-0.0769800358919501*kSq[2]-0.0769800358919501*kSq[1]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[4], globalIdxs[7], (-0.0295084445425327*kSq[7])-0.03442651863295482*kSq[6]-0.063887656499994*kSq[5]-0.05962847939999439*kSq[4]-0.05333333333333333*kSq[3]-0.03849001794597505*kSq[2]-0.8888888888888888*epsilon[0]*rdx2Sq[1]+0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[5], globalIdxs[0], (-0.006147592613027645*kSq[7])+0.02697478829999747*kSq[5]+0.03336355394999686*kSq[4]+0.3111111111111111*epsilon[0]*rdx2Sq[1]-0.01924500897298752*kSq[1]+(0.06666666666666667*bcVals[0]*epsilon[0]*rdx2Sq[0])/bcVals[1]+0.1888888888888889*epsilon[0]*rdx2Sq[0]-0.02222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[5], globalIdxs[1], 0.01721325931647741*kSq[6]-0.03975231959999626*kSq[5]-0.05678902799999467*kSq[4]+0.01333333333333333*kSq[3]-0.03849001794597505*kSq[2]-0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.4444444444444444*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[5], globalIdxs[2], 0.0234254740499978*kSq[5]+0.0234254740499978*kSq[4]-0.01333333333333333*kSq[3]+0.2555555555555555*epsilon[0]*rdx2Sq[1]+0.2555555555555555*epsilon[0]*rdx2Sq[0]-0.03333333333333333*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[5], globalIdxs[3], 0.0295084445425327*kSq[7]-0.03442651863295482*kSq[6]-0.063887656499994*kSq[5]-0.05962847939999439*kSq[4]+0.05333333333333333*kSq[3]-0.03849001794597505*kSq[2]-0.8888888888888888*epsilon[0]*rdx2Sq[1]-(0.1333333333333333*bcVals[0]*epsilon[0]*rdx2Sq[0])/bcVals[1]+0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[5], globalIdxs[4], (-0.01721325931647741*kSq[7])-0.05678902799999467*kSq[5]-0.03975231959999626*kSq[4]+0.01333333333333333*kSq[3]-0.4444444444444444*epsilon[0]*rdx2Sq[1]+0.03849001794597505*kSq[1]-0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[5], globalIdxs[5], 0.04549218533640458*kSq[7]-0.04549218533640458*kSq[6]-0.0127775312999988*kSq[5]-0.0127775312999988*kSq[4]+0.04666666666666667*kSq[3]-0.03849001794597505*kSq[2]+0.5777777777777777*epsilon[0]*rdx2Sq[1]+0.03849001794597505*kSq[1]-(0.2666666666666667*bcVals[0]*epsilon[0]*rdx2Sq[0])/bcVals[1]+0.5777777777777777*epsilon[0]*rdx2Sq[0]-0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[5], globalIdxs[6], 0.03442651863295482*kSq[7]-0.0295084445425327*kSq[6]-0.05962847939999439*kSq[5]-0.063887656499994*kSq[4]+0.05333333333333333*kSq[3]+0.06666666666666667*epsilon[0]*rdx2Sq[1]+0.03849001794597505*kSq[1]-0.8888888888888888*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[5], globalIdxs[7], 0.006147592613027645*kSq[6]+0.03336355394999686*kSq[5]+0.02697478829999747*kSq[4]+0.01924500897298752*kSq[2]+0.1888888888888889*epsilon[0]*rdx2Sq[1]+0.3111111111111111*epsilon[0]*rdx2Sq[0]-0.02222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[6], globalIdxs[0], (-0.01721325931647741*kSq[6])-0.03975231959999626*kSq[5]-0.05678902799999467*kSq[4]-0.01333333333333333*kSq[3]+0.03849001794597505*kSq[2]-0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.4444444444444444*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[6], globalIdxs[1], 0.07950463919999252*kSq[5]+0.1135780559999893*kSq[4]-0.5333333333333333*epsilon[0]*rdx2Sq[1]+0.8888888888888888*epsilon[0]*rdx2Sq[0]-0.1777777777777778*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[6], globalIdxs[2], (-0.01721325931647741*kSq[6])-0.03975231959999626*kSq[5]-0.05678902799999467*kSq[4]+0.01333333333333333*kSq[3]+0.03849001794597505*kSq[2]-0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.4444444444444444*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[6], globalIdxs[3], (-0.03442651863295482*kSq[7])+0.03442651863295482*kSq[6]+0.09938079899999068*kSq[5]+0.09938079899999068*kSq[4]+0.02666666666666666*kSq[3]-0.0769800358919501*kSq[2]+0.0769800358919501*kSq[1]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[6], globalIdxs[4], 0.03442651863295482*kSq[7]+0.03442651863295482*kSq[6]+0.09938079899999068*kSq[5]+0.09938079899999068*kSq[4]-0.02666666666666666*kSq[3]-0.0769800358919501*kSq[2]-0.0769800358919501*kSq[1]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[6], globalIdxs[5], 0.03442651863295482*kSq[7]-0.0295084445425327*kSq[6]-0.05962847939999439*kSq[5]-0.063887656499994*kSq[4]+0.05333333333333333*kSq[3]+0.06666666666666667*epsilon[0]*rdx2Sq[1]+0.03849001794597505*kSq[1]-0.8888888888888888*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[6], globalIdxs[6], 0.1967229636168847*kSq[6]-0.07950463919999252*kSq[5]+0.2271561119999787*kSq[4]-0.3079201435678004*kSq[2]+0.5333333333333333*epsilon[0]*rdx2Sq[1]+1.777777777777778*epsilon[0]*rdx2Sq[0]-0.3555555555555556*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[6], globalIdxs[7], (-0.03442651863295482*kSq[7])-0.0295084445425327*kSq[6]-0.05962847939999439*kSq[5]-0.063887656499994*kSq[4]-0.05333333333333333*kSq[3]+0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.03849001794597505*kSq[1]-0.8888888888888888*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[7], globalIdxs[0], 0.0234254740499978*kSq[5]+0.0234254740499978*kSq[4]+0.01333333333333333*kSq[3]+0.2555555555555555*epsilon[0]*rdx2Sq[1]+0.2555555555555555*epsilon[0]*rdx2Sq[0]-0.03333333333333333*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[7], globalIdxs[1], 0.01721325931647741*kSq[6]-0.03975231959999626*kSq[5]-0.05678902799999467*kSq[4]-0.01333333333333333*kSq[3]-0.03849001794597505*kSq[2]-0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.4444444444444444*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[7], globalIdxs[2], 0.006147592613027645*kSq[7]+0.02697478829999747*kSq[5]+0.03336355394999686*kSq[4]+0.3111111111111111*epsilon[0]*rdx2Sq[1]+0.01924500897298752*kSq[1]+0.1888888888888889*epsilon[0]*rdx2Sq[0]-0.02222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[7], globalIdxs[3], 0.01721325931647741*kSq[7]-0.05678902799999467*kSq[5]-0.03975231959999626*kSq[4]-0.01333333333333333*kSq[3]-0.4444444444444444*epsilon[0]*rdx2Sq[1]-0.03849001794597505*kSq[1]-0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[7], globalIdxs[4], (-0.0295084445425327*kSq[7])-0.03442651863295482*kSq[6]-0.063887656499994*kSq[5]-0.05962847939999439*kSq[4]-0.05333333333333333*kSq[3]-0.03849001794597505*kSq[2]-0.8888888888888888*epsilon[0]*rdx2Sq[1]+0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[7], globalIdxs[5], 0.006147592613027645*kSq[6]+0.03336355394999686*kSq[5]+0.02697478829999747*kSq[4]+0.01924500897298752*kSq[2]+0.1888888888888889*epsilon[0]*rdx2Sq[1]+0.3111111111111111*epsilon[0]*rdx2Sq[0]-0.02222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[7], globalIdxs[6], (-0.03442651863295482*kSq[7])-0.0295084445425327*kSq[6]-0.05962847939999439*kSq[5]-0.063887656499994*kSq[4]-0.05333333333333333*kSq[3]+0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.03849001794597505*kSq[1]-0.8888888888888888*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[7], globalIdxs[7], (-0.04549218533640458*kSq[7])-0.04549218533640458*kSq[6]-0.0127775312999988*kSq[5]-0.0127775312999988*kSq[4]-0.04666666666666667*kSq[3]-0.03849001794597505*kSq[2]+0.5777777777777777*epsilon[0]*rdx2Sq[1]-0.03849001794597505*kSq[1]+0.5777777777777777*epsilon[0]*rdx2Sq[0]-0.06666666666666667*kSq[0]);

}
void fem_poisson_lhs_stencil_consteps_2x_ser_p1_lox_robinx_upy_dirichlety(const double *epsilon, const double *kSq, const double *dx, const double *bcVals, const long *globalIdxs, gkyl_mat_triples *tri) 
{ 
  // epsilon: permittivity.
  // kSq: wave number squared (factor multiplying phi).
  // dx: cell length in each direction.
  // bcVals[3]: values to impose as BCs, i.e. bcVals[0]*phi+bcVals[1]*d(phi)/dx=bcVals[2].
  // globalIdxs: global linear index of each basis function/node in current cell.
  // tri: triples object (i,j,val), i.e. contribute val to i,j element of the global matrix.

  double rdx2Sq[2];
  rdx2Sq[0] = 4.0/(dx[0]*dx[0]);
  rdx2Sq[1] = 4.0/(dx[1]*dx[1]);

  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[0], (-0.1666666666666667*kSq[3])+0.1924500897298752*kSq[2]+0.3333333333333333*epsilon[0]*rdx2Sq[1]+0.1924500897298752*kSq[1]-(0.6666666666666666*bcVals[0]*epsilon[0]*rdx2Sq[0])/bcVals[1]+0.3333333333333333*epsilon[0]*rdx2Sq[0]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[1], 0.09622504486493762*kSq[2]+0.1666666666666667*epsilon[0]*rdx2Sq[1]-0.3333333333333333*epsilon[0]*rdx2Sq[0]-0.1111111111111111*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[2], (-0.3333333333333333*epsilon[0]*rdx2Sq[1])+0.09622504486493762*kSq[1]-(0.3333333333333333*bcVals[0]*epsilon[0]*rdx2Sq[0])/bcVals[1]+0.1666666666666667*epsilon[0]*rdx2Sq[0]-0.1111111111111111*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[3], (-0.1666666666666667*epsilon[0]*rdx2Sq[1])-0.1666666666666667*epsilon[0]*rdx2Sq[0]-0.05555555555555555*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[0], 0.09622504486493762*kSq[2]+0.1666666666666667*epsilon[0]*rdx2Sq[1]-0.3333333333333333*epsilon[0]*rdx2Sq[0]-0.1111111111111111*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[1], 0.1666666666666667*kSq[3]+0.1924500897298752*kSq[2]+0.3333333333333333*epsilon[0]*rdx2Sq[1]-0.1924500897298752*kSq[1]+0.3333333333333333*epsilon[0]*rdx2Sq[0]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[2], (-0.1666666666666667*epsilon[0]*rdx2Sq[1])-0.1666666666666667*epsilon[0]*rdx2Sq[0]-0.05555555555555555*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[3], (-0.3333333333333333*epsilon[0]*rdx2Sq[1])-0.09622504486493762*kSq[1]+0.1666666666666667*epsilon[0]*rdx2Sq[0]-0.1111111111111111*kSq[0]);
  gkyl_mat_triples_insert(tri, globalIdxs[2], globalIdxs[0], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[2], globalIdxs[1], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[2], globalIdxs[2], 1.0);
  gkyl_mat_triples_insert(tri, globalIdxs[2], globalIdxs[3], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[3], globalIdxs[0], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[3], globalIdxs[1], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[3], globalIdxs[2], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[3], globalIdxs[3], 1.0);

}
void fem_poisson_lhs_stencil_consteps_2x_ser_p2_lox_robinx_upy_dirichlety(const double *epsilon, const double *kSq, const double *dx, const double *bcVals, const long *globalIdxs, gkyl_mat_triples *tri) 
{ 
  // epsilon: permittivity.
  // kSq: wave number squared (factor multiplying phi).
  // dx: cell length in each direction.
  // bcVals[3]: values to impose as BCs, i.e. bcVals[0]*phi+bcVals[1]*d(phi)/dx=bcVals[2].
  // globalIdxs: global linear index of each basis function/node in current cell.
  // tri: triples object (i,j,val), i.e. contribute val to i,j element of the global matrix.

  double rdx2Sq[2];
  rdx2Sq[0] = 4.0/(dx[0]*dx[0]);
  rdx2Sq[1] = 4.0/(dx[1]*dx[1]);

  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[0], 0.04549218533640458*kSq[7]+0.04549218533640458*kSq[6]-0.0127775312999988*kSq[5]-0.0127775312999988*kSq[4]-0.04666666666666667*kSq[3]+0.03849001794597505*kSq[2]+0.5777777777777777*epsilon[0]*rdx2Sq[1]+0.03849001794597505*kSq[1]-(0.2666666666666667*bcVals[0]*epsilon[0]*rdx2Sq[0])/bcVals[1]+0.5777777777777777*epsilon[0]*rdx2Sq[0]-0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[1], 0.03442651863295482*kSq[7]+0.0295084445425327*kSq[6]-0.05962847939999439*kSq[5]-0.063887656499994*kSq[4]-0.05333333333333333*kSq[3]+0.06666666666666667*epsilon[0]*rdx2Sq[1]+0.03849001794597505*kSq[1]-0.8888888888888888*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[2], (-0.006147592613027645*kSq[6])+0.03336355394999686*kSq[5]+0.02697478829999747*kSq[4]-0.01924500897298752*kSq[2]+0.1888888888888889*epsilon[0]*rdx2Sq[1]+0.3111111111111111*epsilon[0]*rdx2Sq[0]-0.02222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[3], 0.0295084445425327*kSq[7]+0.03442651863295482*kSq[6]-0.063887656499994*kSq[5]-0.05962847939999439*kSq[4]-0.05333333333333333*kSq[3]+0.03849001794597505*kSq[2]-0.8888888888888888*epsilon[0]*rdx2Sq[1]-(0.1333333333333333*bcVals[0]*epsilon[0]*rdx2Sq[0])/bcVals[1]+0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[4], (-0.01721325931647741*kSq[7])-0.05678902799999467*kSq[5]-0.03975231959999626*kSq[4]-0.01333333333333333*kSq[3]-0.4444444444444444*epsilon[0]*rdx2Sq[1]+0.03849001794597505*kSq[1]-0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[5], (-0.006147592613027645*kSq[7])+0.02697478829999747*kSq[5]+0.03336355394999686*kSq[4]+0.3111111111111111*epsilon[0]*rdx2Sq[1]-0.01924500897298752*kSq[1]+(0.06666666666666667*bcVals[0]*epsilon[0]*rdx2Sq[0])/bcVals[1]+0.1888888888888889*epsilon[0]*rdx2Sq[0]-0.02222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[6], (-0.01721325931647741*kSq[6])-0.03975231959999626*kSq[5]-0.05678902799999467*kSq[4]-0.01333333333333333*kSq[3]+0.03849001794597505*kSq[2]-0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.4444444444444444*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[7], 0.0234254740499978*kSq[5]+0.0234254740499978*kSq[4]+0.01333333333333333*kSq[3]+0.2555555555555555*epsilon[0]*rdx2Sq[1]+0.2555555555555555*epsilon[0]*rdx2Sq[0]-0.03333333333333333*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[0], 0.03442651863295482*kSq[7]+0.0295084445425327*kSq[6]-0.05962847939999439*kSq[5]-0.063887656499994*kSq[4]-0.05333333333333333*kSq[3]+0.06666666666666667*epsilon[0]*rdx2Sq[1]+0.03849001794597505*kSq[1]-0.8888888888888888*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[1], (-0.1967229636168847*kSq[6])-0.07950463919999252*kSq[5]+0.2271561119999787*kSq[4]+0.3079201435678004*kSq[2]+0.5333333333333333*epsilon[0]*rdx2Sq[1]+1.777777777777778*epsilon[0]*rdx2Sq[0]-0.3555555555555556*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[2], (-0.03442651863295482*kSq[7])+0.0295084445425327*kSq[6]-0.05962847939999439*kSq[5]-0.063887656499994*kSq[4]+0.05333333333333333*kSq[3]+0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.03849001794597505*kSq[1]-0.8888888888888888*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[3], (-0.03442651863295482*kSq[7])-0.03442651863295482*kSq[6]+0.09938079899999068*kSq[5]+0.09938079899999068*kSq[4]-0.02666666666666666*kSq[3]+0.0769800358919501*kSq[2]+0.0769800358919501*kSq[1]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[4], 0.03442651863295482*kSq[7]-0.03442651863295482*kSq[6]+0.09938079899999068*kSq[5]+0.09938079899999068*kSq[4]+0.02666666666666666*kSq[3]+0.0769800358919501*kSq[2]-0.0769800358919501*kSq[1]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[5], 0.01721325931647741*kSq[6]-0.03975231959999626*kSq[5]-0.05678902799999467*kSq[4]+0.01333333333333333*kSq[3]-0.03849001794597505*kSq[2]-0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.4444444444444444*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[6], 0.07950463919999252*kSq[5]+0.1135780559999893*kSq[4]-0.5333333333333333*epsilon[0]*rdx2Sq[1]+0.8888888888888888*epsilon[0]*rdx2Sq[0]-0.1777777777777778*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[7], 0.01721325931647741*kSq[6]-0.03975231959999626*kSq[5]-0.05678902799999467*kSq[4]-0.01333333333333333*kSq[3]-0.03849001794597505*kSq[2]-0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.4444444444444444*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[0], (-0.006147592613027645*kSq[6])+0.03336355394999686*kSq[5]+0.02697478829999747*kSq[4]-0.01924500897298752*kSq[2]+0.1888888888888889*epsilon[0]*rdx2Sq[1]+0.3111111111111111*epsilon[0]*rdx2Sq[0]-0.02222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[1], (-0.03442651863295482*kSq[7])+0.0295084445425327*kSq[6]-0.05962847939999439*kSq[5]-0.063887656499994*kSq[4]+0.05333333333333333*kSq[3]+0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.03849001794597505*kSq[1]-0.8888888888888888*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[2], (-0.04549218533640458*kSq[7])+0.04549218533640458*kSq[6]-0.0127775312999988*kSq[5]-0.0127775312999988*kSq[4]+0.04666666666666667*kSq[3]+0.03849001794597505*kSq[2]+0.5777777777777777*epsilon[0]*rdx2Sq[1]-0.03849001794597505*kSq[1]+0.5777777777777777*epsilon[0]*rdx2Sq[0]-0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[3], 0.01721325931647741*kSq[7]-0.05678902799999467*kSq[5]-0.03975231959999626*kSq[4]+0.01333333333333333*kSq[3]-0.4444444444444444*epsilon[0]*rdx2Sq[1]-0.03849001794597505*kSq[1]-0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[4], (-0.0295084445425327*kSq[7])+0.03442651863295482*kSq[6]-0.063887656499994*kSq[5]-0.05962847939999439*kSq[4]+0.05333333333333333*kSq[3]+0.03849001794597505*kSq[2]-0.8888888888888888*epsilon[0]*rdx2Sq[1]+0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[5], 0.0234254740499978*kSq[5]+0.0234254740499978*kSq[4]-0.01333333333333333*kSq[3]+0.2555555555555555*epsilon[0]*rdx2Sq[1]+0.2555555555555555*epsilon[0]*rdx2Sq[0]-0.03333333333333333*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[6], (-0.01721325931647741*kSq[6])-0.03975231959999626*kSq[5]-0.05678902799999467*kSq[4]+0.01333333333333333*kSq[3]+0.03849001794597505*kSq[2]-0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.4444444444444444*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[7], 0.006147592613027645*kSq[7]+0.02697478829999747*kSq[5]+0.03336355394999686*kSq[4]+0.3111111111111111*epsilon[0]*rdx2Sq[1]+0.01924500897298752*kSq[1]+0.1888888888888889*epsilon[0]*rdx2Sq[0]-0.02222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[0], 0.0295084445425327*kSq[7]+0.03442651863295482*kSq[6]-0.063887656499994*kSq[5]-0.05962847939999439*kSq[4]-0.05333333333333333*kSq[3]+0.03849001794597505*kSq[2]-0.8888888888888888*epsilon[0]*rdx2Sq[1]-(0.1333333333333333*bcVals[0]*epsilon[0]*rdx2Sq[0])/bcVals[1]+0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[1], (-0.03442651863295482*kSq[7])-0.03442651863295482*kSq[6]+0.09938079899999068*kSq[5]+0.09938079899999068*kSq[4]-0.02666666666666666*kSq[3]+0.0769800358919501*kSq[2]+0.0769800358919501*kSq[1]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[2], 0.01721325931647741*kSq[7]-0.05678902799999467*kSq[5]-0.03975231959999626*kSq[4]+0.01333333333333333*kSq[3]-0.4444444444444444*epsilon[0]*rdx2Sq[1]-0.03849001794597505*kSq[1]-0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[3], (-0.1967229636168847*kSq[7])+0.2271561119999787*kSq[5]-0.07950463919999252*kSq[4]+1.777777777777778*epsilon[0]*rdx2Sq[1]+0.3079201435678004*kSq[1]-(1.066666666666667*bcVals[0]*epsilon[0]*rdx2Sq[0])/bcVals[1]+0.5333333333333333*epsilon[0]*rdx2Sq[0]-0.3555555555555556*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[4], 0.1135780559999893*kSq[5]+0.07950463919999252*kSq[4]+0.8888888888888888*epsilon[0]*rdx2Sq[1]-0.5333333333333333*epsilon[0]*rdx2Sq[0]-0.1777777777777778*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[5], 0.0295084445425327*kSq[7]-0.03442651863295482*kSq[6]-0.063887656499994*kSq[5]-0.05962847939999439*kSq[4]+0.05333333333333333*kSq[3]-0.03849001794597505*kSq[2]-0.8888888888888888*epsilon[0]*rdx2Sq[1]-(0.1333333333333333*bcVals[0]*epsilon[0]*rdx2Sq[0])/bcVals[1]+0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[6], (-0.03442651863295482*kSq[7])+0.03442651863295482*kSq[6]+0.09938079899999068*kSq[5]+0.09938079899999068*kSq[4]+0.02666666666666666*kSq[3]-0.0769800358919501*kSq[2]+0.0769800358919501*kSq[1]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[7], 0.01721325931647741*kSq[7]-0.05678902799999467*kSq[5]-0.03975231959999626*kSq[4]-0.01333333333333333*kSq[3]-0.4444444444444444*epsilon[0]*rdx2Sq[1]-0.03849001794597505*kSq[1]-0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[4], globalIdxs[0], (-0.01721325931647741*kSq[7])-0.05678902799999467*kSq[5]-0.03975231959999626*kSq[4]-0.01333333333333333*kSq[3]-0.4444444444444444*epsilon[0]*rdx2Sq[1]+0.03849001794597505*kSq[1]-0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[4], globalIdxs[1], 0.03442651863295482*kSq[7]-0.03442651863295482*kSq[6]+0.09938079899999068*kSq[5]+0.09938079899999068*kSq[4]+0.02666666666666666*kSq[3]+0.0769800358919501*kSq[2]-0.0769800358919501*kSq[1]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[4], globalIdxs[2], (-0.0295084445425327*kSq[7])+0.03442651863295482*kSq[6]-0.063887656499994*kSq[5]-0.05962847939999439*kSq[4]+0.05333333333333333*kSq[3]+0.03849001794597505*kSq[2]-0.8888888888888888*epsilon[0]*rdx2Sq[1]+0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[4], globalIdxs[3], 0.1135780559999893*kSq[5]+0.07950463919999252*kSq[4]+0.8888888888888888*epsilon[0]*rdx2Sq[1]-0.5333333333333333*epsilon[0]*rdx2Sq[0]-0.1777777777777778*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[4], globalIdxs[4], 0.1967229636168847*kSq[7]+0.2271561119999787*kSq[5]-0.07950463919999252*kSq[4]+1.777777777777778*epsilon[0]*rdx2Sq[1]-0.3079201435678004*kSq[1]+0.5333333333333333*epsilon[0]*rdx2Sq[0]-0.3555555555555556*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[4], globalIdxs[5], (-0.01721325931647741*kSq[7])-0.05678902799999467*kSq[5]-0.03975231959999626*kSq[4]+0.01333333333333333*kSq[3]-0.4444444444444444*epsilon[0]*rdx2Sq[1]+0.03849001794597505*kSq[1]-0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[4], globalIdxs[6], 0.03442651863295482*kSq[7]+0.03442651863295482*kSq[6]+0.09938079899999068*kSq[5]+0.09938079899999068*kSq[4]-0.02666666666666666*kSq[3]-0.0769800358919501*kSq[2]-0.0769800358919501*kSq[1]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[4], globalIdxs[7], (-0.0295084445425327*kSq[7])-0.03442651863295482*kSq[6]-0.063887656499994*kSq[5]-0.05962847939999439*kSq[4]-0.05333333333333333*kSq[3]-0.03849001794597505*kSq[2]-0.8888888888888888*epsilon[0]*rdx2Sq[1]+0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_insert(tri, globalIdxs[5], globalIdxs[0], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[5], globalIdxs[1], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[5], globalIdxs[2], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[5], globalIdxs[3], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[5], globalIdxs[4], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[5], globalIdxs[5], 1.0);
  gkyl_mat_triples_insert(tri, globalIdxs[5], globalIdxs[6], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[5], globalIdxs[7], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[6], globalIdxs[0], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[6], globalIdxs[1], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[6], globalIdxs[2], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[6], globalIdxs[3], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[6], globalIdxs[4], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[6], globalIdxs[5], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[6], globalIdxs[6], 1.0);
  gkyl_mat_triples_insert(tri, globalIdxs[6], globalIdxs[7], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[7], globalIdxs[0], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[7], globalIdxs[1], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[7], globalIdxs[2], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[7], globalIdxs[3], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[7], globalIdxs[4], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[7], globalIdxs[5], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[7], globalIdxs[6], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[7], globalIdxs[7], 1.0);

}
void fem_poisson_lhs_stencil_consteps_2x_ser_p1_lox_robinx_upy_neumanny(const double *epsilon, const double *kSq, const double *dx, const double *bcVals, const long *globalIdxs, gkyl_mat_triples *tri) 
{ 
  // epsilon: permittivity.
  // kSq: wave number squared (factor multiplying phi).
  // dx: cell length in each direction.
  // bcVals[3]: values to impose as BCs, i.e. bcVals[0]*phi+bcVals[1]*d(phi)/dx=bcVals[2].
  // globalIdxs: global linear index of each basis function/node in current cell.
  // tri: triples object (i,j,val), i.e. contribute val to i,j element of the global matrix.

  double rdx2Sq[2];
  rdx2Sq[0] = 4.0/(dx[0]*dx[0]);
  rdx2Sq[1] = 4.0/(dx[1]*dx[1]);

  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[0], (-0.1666666666666667*kSq[3])+0.1924500897298752*kSq[2]+0.3333333333333333*epsilon[0]*rdx2Sq[1]+0.1924500897298752*kSq[1]-(0.6666666666666666*bcVals[0]*epsilon[0]*rdx2Sq[0])/bcVals[1]+0.3333333333333333*epsilon[0]*rdx2Sq[0]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[1], 0.09622504486493762*kSq[2]+0.1666666666666667*epsilon[0]*rdx2Sq[1]-0.3333333333333333*epsilon[0]*rdx2Sq[0]-0.1111111111111111*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[2], (-0.3333333333333333*epsilon[0]*rdx2Sq[1])+0.09622504486493762*kSq[1]-(0.3333333333333333*bcVals[0]*epsilon[0]*rdx2Sq[0])/bcVals[1]+0.1666666666666667*epsilon[0]*rdx2Sq[0]-0.1111111111111111*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[3], (-0.1666666666666667*epsilon[0]*rdx2Sq[1])-0.1666666666666667*epsilon[0]*rdx2Sq[0]-0.05555555555555555*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[0], 0.09622504486493762*kSq[2]+0.1666666666666667*epsilon[0]*rdx2Sq[1]-0.3333333333333333*epsilon[0]*rdx2Sq[0]-0.1111111111111111*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[1], 0.1666666666666667*kSq[3]+0.1924500897298752*kSq[2]+0.3333333333333333*epsilon[0]*rdx2Sq[1]-0.1924500897298752*kSq[1]+0.3333333333333333*epsilon[0]*rdx2Sq[0]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[2], (-0.1666666666666667*epsilon[0]*rdx2Sq[1])-0.1666666666666667*epsilon[0]*rdx2Sq[0]-0.05555555555555555*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[3], (-0.3333333333333333*epsilon[0]*rdx2Sq[1])-0.09622504486493762*kSq[1]+0.1666666666666667*epsilon[0]*rdx2Sq[0]-0.1111111111111111*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[0], (-0.3333333333333333*epsilon[0]*rdx2Sq[1])+0.09622504486493762*kSq[1]-(0.3333333333333333*bcVals[0]*epsilon[0]*rdx2Sq[0])/bcVals[1]+0.1666666666666667*epsilon[0]*rdx2Sq[0]-0.1111111111111111*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[1], (-0.1666666666666667*epsilon[0]*rdx2Sq[1])-0.1666666666666667*epsilon[0]*rdx2Sq[0]-0.05555555555555555*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[2], 0.1666666666666667*kSq[3]-0.1924500897298752*kSq[2]+0.3333333333333333*epsilon[0]*rdx2Sq[1]+0.1924500897298752*kSq[1]-(0.6666666666666666*bcVals[0]*epsilon[0]*rdx2Sq[0])/bcVals[1]+0.3333333333333333*epsilon[0]*rdx2Sq[0]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[3], (-0.09622504486493762*kSq[2])+0.1666666666666667*epsilon[0]*rdx2Sq[1]-0.3333333333333333*epsilon[0]*rdx2Sq[0]-0.1111111111111111*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[0], (-0.1666666666666667*epsilon[0]*rdx2Sq[1])-0.1666666666666667*epsilon[0]*rdx2Sq[0]-0.05555555555555555*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[1], (-0.3333333333333333*epsilon[0]*rdx2Sq[1])-0.09622504486493762*kSq[1]+0.1666666666666667*epsilon[0]*rdx2Sq[0]-0.1111111111111111*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[2], (-0.09622504486493762*kSq[2])+0.1666666666666667*epsilon[0]*rdx2Sq[1]-0.3333333333333333*epsilon[0]*rdx2Sq[0]-0.1111111111111111*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[3], (-0.1666666666666667*kSq[3])-0.1924500897298752*kSq[2]+0.3333333333333333*epsilon[0]*rdx2Sq[1]-0.1924500897298752*kSq[1]+0.3333333333333333*epsilon[0]*rdx2Sq[0]-0.2222222222222222*kSq[0]);

}
void fem_poisson_lhs_stencil_consteps_2x_ser_p2_lox_robinx_upy_neumanny(const double *epsilon, const double *kSq, const double *dx, const double *bcVals, const long *globalIdxs, gkyl_mat_triples *tri) 
{ 
  // epsilon: permittivity.
  // kSq: wave number squared (factor multiplying phi).
  // dx: cell length in each direction.
  // bcVals[3]: values to impose as BCs, i.e. bcVals[0]*phi+bcVals[1]*d(phi)/dx=bcVals[2].
  // globalIdxs: global linear index of each basis function/node in current cell.
  // tri: triples object (i,j,val), i.e. contribute val to i,j element of the global matrix.

  double rdx2Sq[2];
  rdx2Sq[0] = 4.0/(dx[0]*dx[0]);
  rdx2Sq[1] = 4.0/(dx[1]*dx[1]);

  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[0], 0.04549218533640458*kSq[7]+0.04549218533640458*kSq[6]-0.0127775312999988*kSq[5]-0.0127775312999988*kSq[4]-0.04666666666666667*kSq[3]+0.03849001794597505*kSq[2]+0.5777777777777777*epsilon[0]*rdx2Sq[1]+0.03849001794597505*kSq[1]-(0.2666666666666667*bcVals[0]*epsilon[0]*rdx2Sq[0])/bcVals[1]+0.5777777777777777*epsilon[0]*rdx2Sq[0]-0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[1], 0.03442651863295482*kSq[7]+0.0295084445425327*kSq[6]-0.05962847939999439*kSq[5]-0.063887656499994*kSq[4]-0.05333333333333333*kSq[3]+0.06666666666666667*epsilon[0]*rdx2Sq[1]+0.03849001794597505*kSq[1]-0.8888888888888888*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[2], (-0.006147592613027645*kSq[6])+0.03336355394999686*kSq[5]+0.02697478829999747*kSq[4]-0.01924500897298752*kSq[2]+0.1888888888888889*epsilon[0]*rdx2Sq[1]+0.3111111111111111*epsilon[0]*rdx2Sq[0]-0.02222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[3], 0.0295084445425327*kSq[7]+0.03442651863295482*kSq[6]-0.063887656499994*kSq[5]-0.05962847939999439*kSq[4]-0.05333333333333333*kSq[3]+0.03849001794597505*kSq[2]-0.8888888888888888*epsilon[0]*rdx2Sq[1]-(0.1333333333333333*bcVals[0]*epsilon[0]*rdx2Sq[0])/bcVals[1]+0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[4], (-0.01721325931647741*kSq[7])-0.05678902799999467*kSq[5]-0.03975231959999626*kSq[4]-0.01333333333333333*kSq[3]-0.4444444444444444*epsilon[0]*rdx2Sq[1]+0.03849001794597505*kSq[1]-0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[5], (-0.006147592613027645*kSq[7])+0.02697478829999747*kSq[5]+0.03336355394999686*kSq[4]+0.3111111111111111*epsilon[0]*rdx2Sq[1]-0.01924500897298752*kSq[1]+(0.06666666666666667*bcVals[0]*epsilon[0]*rdx2Sq[0])/bcVals[1]+0.1888888888888889*epsilon[0]*rdx2Sq[0]-0.02222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[6], (-0.01721325931647741*kSq[6])-0.03975231959999626*kSq[5]-0.05678902799999467*kSq[4]-0.01333333333333333*kSq[3]+0.03849001794597505*kSq[2]-0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.4444444444444444*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[7], 0.0234254740499978*kSq[5]+0.0234254740499978*kSq[4]+0.01333333333333333*kSq[3]+0.2555555555555555*epsilon[0]*rdx2Sq[1]+0.2555555555555555*epsilon[0]*rdx2Sq[0]-0.03333333333333333*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[0], 0.03442651863295482*kSq[7]+0.0295084445425327*kSq[6]-0.05962847939999439*kSq[5]-0.063887656499994*kSq[4]-0.05333333333333333*kSq[3]+0.06666666666666667*epsilon[0]*rdx2Sq[1]+0.03849001794597505*kSq[1]-0.8888888888888888*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[1], (-0.1967229636168847*kSq[6])-0.07950463919999252*kSq[5]+0.2271561119999787*kSq[4]+0.3079201435678004*kSq[2]+0.5333333333333333*epsilon[0]*rdx2Sq[1]+1.777777777777778*epsilon[0]*rdx2Sq[0]-0.3555555555555556*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[2], (-0.03442651863295482*kSq[7])+0.0295084445425327*kSq[6]-0.05962847939999439*kSq[5]-0.063887656499994*kSq[4]+0.05333333333333333*kSq[3]+0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.03849001794597505*kSq[1]-0.8888888888888888*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[3], (-0.03442651863295482*kSq[7])-0.03442651863295482*kSq[6]+0.09938079899999068*kSq[5]+0.09938079899999068*kSq[4]-0.02666666666666666*kSq[3]+0.0769800358919501*kSq[2]+0.0769800358919501*kSq[1]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[4], 0.03442651863295482*kSq[7]-0.03442651863295482*kSq[6]+0.09938079899999068*kSq[5]+0.09938079899999068*kSq[4]+0.02666666666666666*kSq[3]+0.0769800358919501*kSq[2]-0.0769800358919501*kSq[1]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[5], 0.01721325931647741*kSq[6]-0.03975231959999626*kSq[5]-0.05678902799999467*kSq[4]+0.01333333333333333*kSq[3]-0.03849001794597505*kSq[2]-0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.4444444444444444*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[6], 0.07950463919999252*kSq[5]+0.1135780559999893*kSq[4]-0.5333333333333333*epsilon[0]*rdx2Sq[1]+0.8888888888888888*epsilon[0]*rdx2Sq[0]-0.1777777777777778*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[7], 0.01721325931647741*kSq[6]-0.03975231959999626*kSq[5]-0.05678902799999467*kSq[4]-0.01333333333333333*kSq[3]-0.03849001794597505*kSq[2]-0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.4444444444444444*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[0], (-0.006147592613027645*kSq[6])+0.03336355394999686*kSq[5]+0.02697478829999747*kSq[4]-0.01924500897298752*kSq[2]+0.1888888888888889*epsilon[0]*rdx2Sq[1]+0.3111111111111111*epsilon[0]*rdx2Sq[0]-0.02222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[1], (-0.03442651863295482*kSq[7])+0.0295084445425327*kSq[6]-0.05962847939999439*kSq[5]-0.063887656499994*kSq[4]+0.05333333333333333*kSq[3]+0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.03849001794597505*kSq[1]-0.8888888888888888*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[2], (-0.04549218533640458*kSq[7])+0.04549218533640458*kSq[6]-0.0127775312999988*kSq[5]-0.0127775312999988*kSq[4]+0.04666666666666667*kSq[3]+0.03849001794597505*kSq[2]+0.5777777777777777*epsilon[0]*rdx2Sq[1]-0.03849001794597505*kSq[1]+0.5777777777777777*epsilon[0]*rdx2Sq[0]-0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[3], 0.01721325931647741*kSq[7]-0.05678902799999467*kSq[5]-0.03975231959999626*kSq[4]+0.01333333333333333*kSq[3]-0.4444444444444444*epsilon[0]*rdx2Sq[1]-0.03849001794597505*kSq[1]-0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[4], (-0.0295084445425327*kSq[7])+0.03442651863295482*kSq[6]-0.063887656499994*kSq[5]-0.05962847939999439*kSq[4]+0.05333333333333333*kSq[3]+0.03849001794597505*kSq[2]-0.8888888888888888*epsilon[0]*rdx2Sq[1]+0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[5], 0.0234254740499978*kSq[5]+0.0234254740499978*kSq[4]-0.01333333333333333*kSq[3]+0.2555555555555555*epsilon[0]*rdx2Sq[1]+0.2555555555555555*epsilon[0]*rdx2Sq[0]-0.03333333333333333*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[6], (-0.01721325931647741*kSq[6])-0.03975231959999626*kSq[5]-0.05678902799999467*kSq[4]+0.01333333333333333*kSq[3]+0.03849001794597505*kSq[2]-0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.4444444444444444*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[7], 0.006147592613027645*kSq[7]+0.02697478829999747*kSq[5]+0.03336355394999686*kSq[4]+0.3111111111111111*epsilon[0]*rdx2Sq[1]+0.01924500897298752*kSq[1]+0.1888888888888889*epsilon[0]*rdx2Sq[0]-0.02222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[0], 0.0295084445425327*kSq[7]+0.03442651863295482*kSq[6]-0.063887656499994*kSq[5]-0.05962847939999439*kSq[4]-0.05333333333333333*kSq[3]+0.03849001794597505*kSq[2]-0.8888888888888888*epsilon[0]*rdx2Sq[1]-(0.1333333333333333*bcVals[0]*epsilon[0]*rdx2Sq[0])/bcVals[1]+0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[1], (-0.03442651863295482*kSq[7])-0.03442651863295482*kSq[6]+0.09938079899999068*kSq[5]+0.09938079899999068*kSq[4]-0.02666666666666666*kSq[3]+0.0769800358919501*kSq[2]+0.0769800358919501*kSq[1]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[2], 0.01721325931647741*kSq[7]-0.05678902799999467*kSq[5]-0.03975231959999626*kSq[4]+0.01333333333333333*kSq[3]-0.4444444444444444*epsilon[0]*rdx2Sq[1]-0.03849001794597505*kSq[1]-0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[3], (-0.1967229636168847*kSq[7])+0.2271561119999787*kSq[5]-0.07950463919999252*kSq[4]+1.777777777777778*epsilon[0]*rdx2Sq[1]+0.3079201435678004*kSq[1]-(1.066666666666667*bcVals[0]*epsilon[0]*rdx2Sq[0])/bcVals[1]+0.5333333333333333*epsilon[0]*rdx2Sq[0]-0.3555555555555556*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[4], 0.1135780559999893*kSq[5]+0.07950463919999252*kSq[4]+0.8888888888888888*epsilon[0]*rdx2Sq[1]-0.5333333333333333*epsilon[0]*rdx2Sq[0]-0.1777777777777778*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[5], 0.0295084445425327*kSq[7]-0.03442651863295482*kSq[6]-0.063887656499994*kSq[5]-0.05962847939999439*kSq[4]+0.05333333333333333*kSq[3]-0.03849001794597505*kSq[2]-0.8888888888888888*epsilon[0]*rdx2Sq[1]-(0.1333333333333333*bcVals[0]*epsilon[0]*rdx2Sq[0])/bcVals[1]+0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[6], (-0.03442651863295482*kSq[7])+0.03442651863295482*kSq[6]+0.09938079899999068*kSq[5]+0.09938079899999068*kSq[4]+0.02666666666666666*kSq[3]-0.0769800358919501*kSq[2]+0.0769800358919501*kSq[1]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[7], 0.01721325931647741*kSq[7]-0.05678902799999467*kSq[5]-0.03975231959999626*kSq[4]-0.01333333333333333*kSq[3]-0.4444444444444444*epsilon[0]*rdx2Sq[1]-0.03849001794597505*kSq[1]-0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[4], globalIdxs[0], (-0.01721325931647741*kSq[7])-0.05678902799999467*kSq[5]-0.03975231959999626*kSq[4]-0.01333333333333333*kSq[3]-0.4444444444444444*epsilon[0]*rdx2Sq[1]+0.03849001794597505*kSq[1]-0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[4], globalIdxs[1], 0.03442651863295482*kSq[7]-0.03442651863295482*kSq[6]+0.09938079899999068*kSq[5]+0.09938079899999068*kSq[4]+0.02666666666666666*kSq[3]+0.0769800358919501*kSq[2]-0.0769800358919501*kSq[1]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[4], globalIdxs[2], (-0.0295084445425327*kSq[7])+0.03442651863295482*kSq[6]-0.063887656499994*kSq[5]-0.05962847939999439*kSq[4]+0.05333333333333333*kSq[3]+0.03849001794597505*kSq[2]-0.8888888888888888*epsilon[0]*rdx2Sq[1]+0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[4], globalIdxs[3], 0.1135780559999893*kSq[5]+0.07950463919999252*kSq[4]+0.8888888888888888*epsilon[0]*rdx2Sq[1]-0.5333333333333333*epsilon[0]*rdx2Sq[0]-0.1777777777777778*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[4], globalIdxs[4], 0.1967229636168847*kSq[7]+0.2271561119999787*kSq[5]-0.07950463919999252*kSq[4]+1.777777777777778*epsilon[0]*rdx2Sq[1]-0.3079201435678004*kSq[1]+0.5333333333333333*epsilon[0]*rdx2Sq[0]-0.3555555555555556*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[4], globalIdxs[5], (-0.01721325931647741*kSq[7])-0.05678902799999467*kSq[5]-0.03975231959999626*kSq[4]+0.01333333333333333*kSq[3]-0.4444444444444444*epsilon[0]*rdx2Sq[1]+0.03849001794597505*kSq[1]-0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[4], globalIdxs[6], 0.03442651863295482*kSq[7]+0.03442651863295482*kSq[6]+0.09938079899999068*kSq[5]+0.09938079899999068*kSq[4]-0.02666666666666666*kSq[3]-0.0769800358919501*kSq[2]-0.0769800358919501*kSq[1]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[4], globalIdxs[7], (-0.0295084445425327*kSq[7])-0.03442651863295482*kSq[6]-0.063887656499994*kSq[5]-0.05962847939999439*kSq[4]-0.05333333333333333*kSq[3]-0.03849001794597505*kSq[2]-0.8888888888888888*epsilon[0]*rdx2Sq[1]+0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[5], globalIdxs[0], (-0.006147592613027645*kSq[7])+0.02697478829999747*kSq[5]+0.03336355394999686*kSq[4]+0.3111111111111111*epsilon[0]*rdx2Sq[1]-0.01924500897298752*kSq[1]+(0.06666666666666667*bcVals[0]*epsilon[0]*rdx2Sq[0])/bcVals[1]+0.1888888888888889*epsilon[0]*rdx2Sq[0]-0.02222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[5], globalIdxs[1], 0.01721325931647741*kSq[6]-0.03975231959999626*kSq[5]-0.05678902799999467*kSq[4]+0.01333333333333333*kSq[3]-0.03849001794597505*kSq[2]-0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.4444444444444444*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[5], globalIdxs[2], 0.0234254740499978*kSq[5]+0.0234254740499978*kSq[4]-0.01333333333333333*kSq[3]+0.2555555555555555*epsilon[0]*rdx2Sq[1]+0.2555555555555555*epsilon[0]*rdx2Sq[0]-0.03333333333333333*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[5], globalIdxs[3], 0.0295084445425327*kSq[7]-0.03442651863295482*kSq[6]-0.063887656499994*kSq[5]-0.05962847939999439*kSq[4]+0.05333333333333333*kSq[3]-0.03849001794597505*kSq[2]-0.8888888888888888*epsilon[0]*rdx2Sq[1]-(0.1333333333333333*bcVals[0]*epsilon[0]*rdx2Sq[0])/bcVals[1]+0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[5], globalIdxs[4], (-0.01721325931647741*kSq[7])-0.05678902799999467*kSq[5]-0.03975231959999626*kSq[4]+0.01333333333333333*kSq[3]-0.4444444444444444*epsilon[0]*rdx2Sq[1]+0.03849001794597505*kSq[1]-0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[5], globalIdxs[5], 0.04549218533640458*kSq[7]-0.04549218533640458*kSq[6]-0.0127775312999988*kSq[5]-0.0127775312999988*kSq[4]+0.04666666666666667*kSq[3]-0.03849001794597505*kSq[2]+0.5777777777777777*epsilon[0]*rdx2Sq[1]+0.03849001794597505*kSq[1]-(0.2666666666666667*bcVals[0]*epsilon[0]*rdx2Sq[0])/bcVals[1]+0.5777777777777777*epsilon[0]*rdx2Sq[0]-0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[5], globalIdxs[6], 0.03442651863295482*kSq[7]-0.0295084445425327*kSq[6]-0.05962847939999439*kSq[5]-0.063887656499994*kSq[4]+0.05333333333333333*kSq[3]+0.06666666666666667*epsilon[0]*rdx2Sq[1]+0.03849001794597505*kSq[1]-0.8888888888888888*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[5], globalIdxs[7], 0.006147592613027645*kSq[6]+0.03336355394999686*kSq[5]+0.02697478829999747*kSq[4]+0.01924500897298752*kSq[2]+0.1888888888888889*epsilon[0]*rdx2Sq[1]+0.3111111111111111*epsilon[0]*rdx2Sq[0]-0.02222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[6], globalIdxs[0], (-0.01721325931647741*kSq[6])-0.03975231959999626*kSq[5]-0.05678902799999467*kSq[4]-0.01333333333333333*kSq[3]+0.03849001794597505*kSq[2]-0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.4444444444444444*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[6], globalIdxs[1], 0.07950463919999252*kSq[5]+0.1135780559999893*kSq[4]-0.5333333333333333*epsilon[0]*rdx2Sq[1]+0.8888888888888888*epsilon[0]*rdx2Sq[0]-0.1777777777777778*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[6], globalIdxs[2], (-0.01721325931647741*kSq[6])-0.03975231959999626*kSq[5]-0.05678902799999467*kSq[4]+0.01333333333333333*kSq[3]+0.03849001794597505*kSq[2]-0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.4444444444444444*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[6], globalIdxs[3], (-0.03442651863295482*kSq[7])+0.03442651863295482*kSq[6]+0.09938079899999068*kSq[5]+0.09938079899999068*kSq[4]+0.02666666666666666*kSq[3]-0.0769800358919501*kSq[2]+0.0769800358919501*kSq[1]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[6], globalIdxs[4], 0.03442651863295482*kSq[7]+0.03442651863295482*kSq[6]+0.09938079899999068*kSq[5]+0.09938079899999068*kSq[4]-0.02666666666666666*kSq[3]-0.0769800358919501*kSq[2]-0.0769800358919501*kSq[1]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[6], globalIdxs[5], 0.03442651863295482*kSq[7]-0.0295084445425327*kSq[6]-0.05962847939999439*kSq[5]-0.063887656499994*kSq[4]+0.05333333333333333*kSq[3]+0.06666666666666667*epsilon[0]*rdx2Sq[1]+0.03849001794597505*kSq[1]-0.8888888888888888*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[6], globalIdxs[6], 0.1967229636168847*kSq[6]-0.07950463919999252*kSq[5]+0.2271561119999787*kSq[4]-0.3079201435678004*kSq[2]+0.5333333333333333*epsilon[0]*rdx2Sq[1]+1.777777777777778*epsilon[0]*rdx2Sq[0]-0.3555555555555556*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[6], globalIdxs[7], (-0.03442651863295482*kSq[7])-0.0295084445425327*kSq[6]-0.05962847939999439*kSq[5]-0.063887656499994*kSq[4]-0.05333333333333333*kSq[3]+0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.03849001794597505*kSq[1]-0.8888888888888888*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[7], globalIdxs[0], 0.0234254740499978*kSq[5]+0.0234254740499978*kSq[4]+0.01333333333333333*kSq[3]+0.2555555555555555*epsilon[0]*rdx2Sq[1]+0.2555555555555555*epsilon[0]*rdx2Sq[0]-0.03333333333333333*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[7], globalIdxs[1], 0.01721325931647741*kSq[6]-0.03975231959999626*kSq[5]-0.05678902799999467*kSq[4]-0.01333333333333333*kSq[3]-0.03849001794597505*kSq[2]-0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.4444444444444444*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[7], globalIdxs[2], 0.006147592613027645*kSq[7]+0.02697478829999747*kSq[5]+0.03336355394999686*kSq[4]+0.3111111111111111*epsilon[0]*rdx2Sq[1]+0.01924500897298752*kSq[1]+0.1888888888888889*epsilon[0]*rdx2Sq[0]-0.02222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[7], globalIdxs[3], 0.01721325931647741*kSq[7]-0.05678902799999467*kSq[5]-0.03975231959999626*kSq[4]-0.01333333333333333*kSq[3]-0.4444444444444444*epsilon[0]*rdx2Sq[1]-0.03849001794597505*kSq[1]-0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[7], globalIdxs[4], (-0.0295084445425327*kSq[7])-0.03442651863295482*kSq[6]-0.063887656499994*kSq[5]-0.05962847939999439*kSq[4]-0.05333333333333333*kSq[3]-0.03849001794597505*kSq[2]-0.8888888888888888*epsilon[0]*rdx2Sq[1]+0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[7], globalIdxs[5], 0.006147592613027645*kSq[6]+0.03336355394999686*kSq[5]+0.02697478829999747*kSq[4]+0.01924500897298752*kSq[2]+0.1888888888888889*epsilon[0]*rdx2Sq[1]+0.3111111111111111*epsilon[0]*rdx2Sq[0]-0.02222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[7], globalIdxs[6], (-0.03442651863295482*kSq[7])-0.0295084445425327*kSq[6]-0.05962847939999439*kSq[5]-0.063887656499994*kSq[4]-0.05333333333333333*kSq[3]+0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.03849001794597505*kSq[1]-0.8888888888888888*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[7], globalIdxs[7], (-0.04549218533640458*kSq[7])-0.04549218533640458*kSq[6]-0.0127775312999988*kSq[5]-0.0127775312999988*kSq[4]-0.04666666666666667*kSq[3]-0.03849001794597505*kSq[2]+0.5777777777777777*epsilon[0]*rdx2Sq[1]-0.03849001794597505*kSq[1]+0.5777777777777777*epsilon[0]*rdx2Sq[0]-0.06666666666666667*kSq[0]);

}
void fem_poisson_lhs_stencil_consteps_2x_ser_p1_lox_robinx_upy_robiny(const double *epsilon, const double *kSq, const double *dx, const double *bcVals, const long *globalIdxs, gkyl_mat_triples *tri) 
{ 
  // epsilon: permittivity.
  // kSq: wave number squared (factor multiplying phi).
  // dx: cell length in each direction.
  // bcVals[3]: values to impose as BCs, i.e. bcVals[0]*phi+bcVals[1]*d(phi)/dx=bcVals[2].
  // globalIdxs: global linear index of each basis function/node in current cell.
  // tri: triples object (i,j,val), i.e. contribute val to i,j element of the global matrix.

  double rdx2Sq[2];
  rdx2Sq[0] = 4.0/(dx[0]*dx[0]);
  rdx2Sq[1] = 4.0/(dx[1]*dx[1]);

  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[0], (-0.1666666666666667*kSq[3])+0.1924500897298752*kSq[2]+0.3333333333333333*epsilon[0]*rdx2Sq[1]+0.1924500897298752*kSq[1]-(0.6666666666666666*bcVals[0]*epsilon[0]*rdx2Sq[0])/bcVals[1]+0.3333333333333333*epsilon[0]*rdx2Sq[0]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[1], 0.09622504486493762*kSq[2]+0.1666666666666667*epsilon[0]*rdx2Sq[1]-0.3333333333333333*epsilon[0]*rdx2Sq[0]-0.1111111111111111*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[2], (-0.3333333333333333*epsilon[0]*rdx2Sq[1])+0.09622504486493762*kSq[1]-(0.3333333333333333*bcVals[0]*epsilon[0]*rdx2Sq[0])/bcVals[1]+0.1666666666666667*epsilon[0]*rdx2Sq[0]-0.1111111111111111*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[3], (-0.1666666666666667*epsilon[0]*rdx2Sq[1])-0.1666666666666667*epsilon[0]*rdx2Sq[0]-0.05555555555555555*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[0], 0.09622504486493762*kSq[2]+0.1666666666666667*epsilon[0]*rdx2Sq[1]-0.3333333333333333*epsilon[0]*rdx2Sq[0]-0.1111111111111111*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[1], 0.1666666666666667*kSq[3]+0.1924500897298752*kSq[2]+0.3333333333333333*epsilon[0]*rdx2Sq[1]-0.1924500897298752*kSq[1]+0.3333333333333333*epsilon[0]*rdx2Sq[0]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[2], (-0.1666666666666667*epsilon[0]*rdx2Sq[1])-0.1666666666666667*epsilon[0]*rdx2Sq[0]-0.05555555555555555*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[3], (-0.3333333333333333*epsilon[0]*rdx2Sq[1])-0.09622504486493762*kSq[1]+0.1666666666666667*epsilon[0]*rdx2Sq[0]-0.1111111111111111*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[0], (-0.3333333333333333*epsilon[0]*rdx2Sq[1])+0.09622504486493762*kSq[1]-(0.3333333333333333*bcVals[0]*epsilon[0]*rdx2Sq[0])/bcVals[1]+0.1666666666666667*epsilon[0]*rdx2Sq[0]-0.1111111111111111*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[1], (-0.1666666666666667*epsilon[0]*rdx2Sq[1])-0.1666666666666667*epsilon[0]*rdx2Sq[0]-0.05555555555555555*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[2], (0.6666666666666666*epsilon[0]*rdx2Sq[1]*bcVals[9])/bcVals[10]+0.1666666666666667*kSq[3]-0.1924500897298752*kSq[2]+0.3333333333333333*epsilon[0]*rdx2Sq[1]+0.1924500897298752*kSq[1]-(0.6666666666666666*bcVals[0]*epsilon[0]*rdx2Sq[0])/bcVals[1]+0.3333333333333333*epsilon[0]*rdx2Sq[0]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[3], (0.3333333333333333*epsilon[0]*rdx2Sq[1]*bcVals[9])/bcVals[10]-0.09622504486493762*kSq[2]+0.1666666666666667*epsilon[0]*rdx2Sq[1]-0.3333333333333333*epsilon[0]*rdx2Sq[0]-0.1111111111111111*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[0], (-0.1666666666666667*epsilon[0]*rdx2Sq[1])-0.1666666666666667*epsilon[0]*rdx2Sq[0]-0.05555555555555555*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[1], (-0.3333333333333333*epsilon[0]*rdx2Sq[1])-0.09622504486493762*kSq[1]+0.1666666666666667*epsilon[0]*rdx2Sq[0]-0.1111111111111111*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[2], (0.3333333333333333*epsilon[0]*rdx2Sq[1]*bcVals[9])/bcVals[10]-0.09622504486493762*kSq[2]+0.1666666666666667*epsilon[0]*rdx2Sq[1]-0.3333333333333333*epsilon[0]*rdx2Sq[0]-0.1111111111111111*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[3], (0.6666666666666666*epsilon[0]*rdx2Sq[1]*bcVals[9])/bcVals[10]-0.1666666666666667*kSq[3]-0.1924500897298752*kSq[2]+0.3333333333333333*epsilon[0]*rdx2Sq[1]-0.1924500897298752*kSq[1]+0.3333333333333333*epsilon[0]*rdx2Sq[0]-0.2222222222222222*kSq[0]);

}
void fem_poisson_lhs_stencil_consteps_2x_ser_p2_lox_robinx_upy_robiny(const double *epsilon, const double *kSq, const double *dx, const double *bcVals, const long *globalIdxs, gkyl_mat_triples *tri) 
{ 
  // epsilon: permittivity.
  // kSq: wave number squared (factor multiplying phi).
  // dx: cell length in each direction.
  // bcVals[3]: values to impose as BCs, i.e. bcVals[0]*phi+bcVals[1]*d(phi)/dx=bcVals[2].
  // globalIdxs: global linear index of each basis function/node in current cell.
  // tri: triples object (i,j,val), i.e. contribute val to i,j element of the global matrix.

  double rdx2Sq[2];
  rdx2Sq[0] = 4.0/(dx[0]*dx[0]);
  rdx2Sq[1] = 4.0/(dx[1]*dx[1]);

  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[0], 0.04549218533640458*kSq[7]+0.04549218533640458*kSq[6]-0.0127775312999988*kSq[5]-0.0127775312999988*kSq[4]-0.04666666666666667*kSq[3]+0.03849001794597505*kSq[2]+0.5777777777777777*epsilon[0]*rdx2Sq[1]+0.03849001794597505*kSq[1]-(0.2666666666666667*bcVals[0]*epsilon[0]*rdx2Sq[0])/bcVals[1]+0.5777777777777777*epsilon[0]*rdx2Sq[0]-0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[1], 0.03442651863295482*kSq[7]+0.0295084445425327*kSq[6]-0.05962847939999439*kSq[5]-0.063887656499994*kSq[4]-0.05333333333333333*kSq[3]+0.06666666666666667*epsilon[0]*rdx2Sq[1]+0.03849001794597505*kSq[1]-0.8888888888888888*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[2], (-0.006147592613027645*kSq[6])+0.03336355394999686*kSq[5]+0.02697478829999747*kSq[4]-0.01924500897298752*kSq[2]+0.1888888888888889*epsilon[0]*rdx2Sq[1]+0.3111111111111111*epsilon[0]*rdx2Sq[0]-0.02222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[3], 0.0295084445425327*kSq[7]+0.03442651863295482*kSq[6]-0.063887656499994*kSq[5]-0.05962847939999439*kSq[4]-0.05333333333333333*kSq[3]+0.03849001794597505*kSq[2]-0.8888888888888888*epsilon[0]*rdx2Sq[1]-(0.1333333333333333*bcVals[0]*epsilon[0]*rdx2Sq[0])/bcVals[1]+0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[4], (-0.01721325931647741*kSq[7])-0.05678902799999467*kSq[5]-0.03975231959999626*kSq[4]-0.01333333333333333*kSq[3]-0.4444444444444444*epsilon[0]*rdx2Sq[1]+0.03849001794597505*kSq[1]-0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[5], (-0.006147592613027645*kSq[7])+0.02697478829999747*kSq[5]+0.03336355394999686*kSq[4]+0.3111111111111111*epsilon[0]*rdx2Sq[1]-0.01924500897298752*kSq[1]+(0.06666666666666667*bcVals[0]*epsilon[0]*rdx2Sq[0])/bcVals[1]+0.1888888888888889*epsilon[0]*rdx2Sq[0]-0.02222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[6], (-0.01721325931647741*kSq[6])-0.03975231959999626*kSq[5]-0.05678902799999467*kSq[4]-0.01333333333333333*kSq[3]+0.03849001794597505*kSq[2]-0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.4444444444444444*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[7], 0.0234254740499978*kSq[5]+0.0234254740499978*kSq[4]+0.01333333333333333*kSq[3]+0.2555555555555555*epsilon[0]*rdx2Sq[1]+0.2555555555555555*epsilon[0]*rdx2Sq[0]-0.03333333333333333*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[0], 0.03442651863295482*kSq[7]+0.0295084445425327*kSq[6]-0.05962847939999439*kSq[5]-0.063887656499994*kSq[4]-0.05333333333333333*kSq[3]+0.06666666666666667*epsilon[0]*rdx2Sq[1]+0.03849001794597505*kSq[1]-0.8888888888888888*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[1], (-0.1967229636168847*kSq[6])-0.07950463919999252*kSq[5]+0.2271561119999787*kSq[4]+0.3079201435678004*kSq[2]+0.5333333333333333*epsilon[0]*rdx2Sq[1]+1.777777777777778*epsilon[0]*rdx2Sq[0]-0.3555555555555556*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[2], (-0.03442651863295482*kSq[7])+0.0295084445425327*kSq[6]-0.05962847939999439*kSq[5]-0.063887656499994*kSq[4]+0.05333333333333333*kSq[3]+0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.03849001794597505*kSq[1]-0.8888888888888888*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[3], (-0.03442651863295482*kSq[7])-0.03442651863295482*kSq[6]+0.09938079899999068*kSq[5]+0.09938079899999068*kSq[4]-0.02666666666666666*kSq[3]+0.0769800358919501*kSq[2]+0.0769800358919501*kSq[1]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[4], 0.03442651863295482*kSq[7]-0.03442651863295482*kSq[6]+0.09938079899999068*kSq[5]+0.09938079899999068*kSq[4]+0.02666666666666666*kSq[3]+0.0769800358919501*kSq[2]-0.0769800358919501*kSq[1]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[5], 0.01721325931647741*kSq[6]-0.03975231959999626*kSq[5]-0.05678902799999467*kSq[4]+0.01333333333333333*kSq[3]-0.03849001794597505*kSq[2]-0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.4444444444444444*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[6], 0.07950463919999252*kSq[5]+0.1135780559999893*kSq[4]-0.5333333333333333*epsilon[0]*rdx2Sq[1]+0.8888888888888888*epsilon[0]*rdx2Sq[0]-0.1777777777777778*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[7], 0.01721325931647741*kSq[6]-0.03975231959999626*kSq[5]-0.05678902799999467*kSq[4]-0.01333333333333333*kSq[3]-0.03849001794597505*kSq[2]-0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.4444444444444444*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[0], (-0.006147592613027645*kSq[6])+0.03336355394999686*kSq[5]+0.02697478829999747*kSq[4]-0.01924500897298752*kSq[2]+0.1888888888888889*epsilon[0]*rdx2Sq[1]+0.3111111111111111*epsilon[0]*rdx2Sq[0]-0.02222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[1], (-0.03442651863295482*kSq[7])+0.0295084445425327*kSq[6]-0.05962847939999439*kSq[5]-0.063887656499994*kSq[4]+0.05333333333333333*kSq[3]+0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.03849001794597505*kSq[1]-0.8888888888888888*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[2], (-0.04549218533640458*kSq[7])+0.04549218533640458*kSq[6]-0.0127775312999988*kSq[5]-0.0127775312999988*kSq[4]+0.04666666666666667*kSq[3]+0.03849001794597505*kSq[2]+0.5777777777777777*epsilon[0]*rdx2Sq[1]-0.03849001794597505*kSq[1]+0.5777777777777777*epsilon[0]*rdx2Sq[0]-0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[3], 0.01721325931647741*kSq[7]-0.05678902799999467*kSq[5]-0.03975231959999626*kSq[4]+0.01333333333333333*kSq[3]-0.4444444444444444*epsilon[0]*rdx2Sq[1]-0.03849001794597505*kSq[1]-0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[4], (-0.0295084445425327*kSq[7])+0.03442651863295482*kSq[6]-0.063887656499994*kSq[5]-0.05962847939999439*kSq[4]+0.05333333333333333*kSq[3]+0.03849001794597505*kSq[2]-0.8888888888888888*epsilon[0]*rdx2Sq[1]+0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[5], 0.0234254740499978*kSq[5]+0.0234254740499978*kSq[4]-0.01333333333333333*kSq[3]+0.2555555555555555*epsilon[0]*rdx2Sq[1]+0.2555555555555555*epsilon[0]*rdx2Sq[0]-0.03333333333333333*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[6], (-0.01721325931647741*kSq[6])-0.03975231959999626*kSq[5]-0.05678902799999467*kSq[4]+0.01333333333333333*kSq[3]+0.03849001794597505*kSq[2]-0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.4444444444444444*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[7], 0.006147592613027645*kSq[7]+0.02697478829999747*kSq[5]+0.03336355394999686*kSq[4]+0.3111111111111111*epsilon[0]*rdx2Sq[1]+0.01924500897298752*kSq[1]+0.1888888888888889*epsilon[0]*rdx2Sq[0]-0.02222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[0], 0.0295084445425327*kSq[7]+0.03442651863295482*kSq[6]-0.063887656499994*kSq[5]-0.05962847939999439*kSq[4]-0.05333333333333333*kSq[3]+0.03849001794597505*kSq[2]-0.8888888888888888*epsilon[0]*rdx2Sq[1]-(0.1333333333333333*bcVals[0]*epsilon[0]*rdx2Sq[0])/bcVals[1]+0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[1], (-0.03442651863295482*kSq[7])-0.03442651863295482*kSq[6]+0.09938079899999068*kSq[5]+0.09938079899999068*kSq[4]-0.02666666666666666*kSq[3]+0.0769800358919501*kSq[2]+0.0769800358919501*kSq[1]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[2], 0.01721325931647741*kSq[7]-0.05678902799999467*kSq[5]-0.03975231959999626*kSq[4]+0.01333333333333333*kSq[3]-0.4444444444444444*epsilon[0]*rdx2Sq[1]-0.03849001794597505*kSq[1]-0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[3], (-0.1967229636168847*kSq[7])+0.2271561119999787*kSq[5]-0.07950463919999252*kSq[4]+1.777777777777778*epsilon[0]*rdx2Sq[1]+0.3079201435678004*kSq[1]-(1.066666666666667*bcVals[0]*epsilon[0]*rdx2Sq[0])/bcVals[1]+0.5333333333333333*epsilon[0]*rdx2Sq[0]-0.3555555555555556*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[4], 0.1135780559999893*kSq[5]+0.07950463919999252*kSq[4]+0.8888888888888888*epsilon[0]*rdx2Sq[1]-0.5333333333333333*epsilon[0]*rdx2Sq[0]-0.1777777777777778*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[5], 0.0295084445425327*kSq[7]-0.03442651863295482*kSq[6]-0.063887656499994*kSq[5]-0.05962847939999439*kSq[4]+0.05333333333333333*kSq[3]-0.03849001794597505*kSq[2]-0.8888888888888888*epsilon[0]*rdx2Sq[1]-(0.1333333333333333*bcVals[0]*epsilon[0]*rdx2Sq[0])/bcVals[1]+0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[6], (-0.03442651863295482*kSq[7])+0.03442651863295482*kSq[6]+0.09938079899999068*kSq[5]+0.09938079899999068*kSq[4]+0.02666666666666666*kSq[3]-0.0769800358919501*kSq[2]+0.0769800358919501*kSq[1]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[7], 0.01721325931647741*kSq[7]-0.05678902799999467*kSq[5]-0.03975231959999626*kSq[4]-0.01333333333333333*kSq[3]-0.4444444444444444*epsilon[0]*rdx2Sq[1]-0.03849001794597505*kSq[1]-0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[4], globalIdxs[0], (-0.01721325931647741*kSq[7])-0.05678902799999467*kSq[5]-0.03975231959999626*kSq[4]-0.01333333333333333*kSq[3]-0.4444444444444444*epsilon[0]*rdx2Sq[1]+0.03849001794597505*kSq[1]-0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[4], globalIdxs[1], 0.03442651863295482*kSq[7]-0.03442651863295482*kSq[6]+0.09938079899999068*kSq[5]+0.09938079899999068*kSq[4]+0.02666666666666666*kSq[3]+0.0769800358919501*kSq[2]-0.0769800358919501*kSq[1]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[4], globalIdxs[2], (-0.0295084445425327*kSq[7])+0.03442651863295482*kSq[6]-0.063887656499994*kSq[5]-0.05962847939999439*kSq[4]+0.05333333333333333*kSq[3]+0.03849001794597505*kSq[2]-0.8888888888888888*epsilon[0]*rdx2Sq[1]+0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[4], globalIdxs[3], 0.1135780559999893*kSq[5]+0.07950463919999252*kSq[4]+0.8888888888888888*epsilon[0]*rdx2Sq[1]-0.5333333333333333*epsilon[0]*rdx2Sq[0]-0.1777777777777778*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[4], globalIdxs[4], 0.1967229636168847*kSq[7]+0.2271561119999787*kSq[5]-0.07950463919999252*kSq[4]+1.777777777777778*epsilon[0]*rdx2Sq[1]-0.3079201435678004*kSq[1]+0.5333333333333333*epsilon[0]*rdx2Sq[0]-0.3555555555555556*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[4], globalIdxs[5], (-0.01721325931647741*kSq[7])-0.05678902799999467*kSq[5]-0.03975231959999626*kSq[4]+0.01333333333333333*kSq[3]-0.4444444444444444*epsilon[0]*rdx2Sq[1]+0.03849001794597505*kSq[1]-0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[4], globalIdxs[6], 0.03442651863295482*kSq[7]+0.03442651863295482*kSq[6]+0.09938079899999068*kSq[5]+0.09938079899999068*kSq[4]-0.02666666666666666*kSq[3]-0.0769800358919501*kSq[2]-0.0769800358919501*kSq[1]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[4], globalIdxs[7], (-0.0295084445425327*kSq[7])-0.03442651863295482*kSq[6]-0.063887656499994*kSq[5]-0.05962847939999439*kSq[4]-0.05333333333333333*kSq[3]-0.03849001794597505*kSq[2]-0.8888888888888888*epsilon[0]*rdx2Sq[1]+0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[5], globalIdxs[0], (-0.006147592613027645*kSq[7])+0.02697478829999747*kSq[5]+0.03336355394999686*kSq[4]+0.3111111111111111*epsilon[0]*rdx2Sq[1]-0.01924500897298752*kSq[1]+(0.06666666666666667*bcVals[0]*epsilon[0]*rdx2Sq[0])/bcVals[1]+0.1888888888888889*epsilon[0]*rdx2Sq[0]-0.02222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[5], globalIdxs[1], 0.01721325931647741*kSq[6]-0.03975231959999626*kSq[5]-0.05678902799999467*kSq[4]+0.01333333333333333*kSq[3]-0.03849001794597505*kSq[2]-0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.4444444444444444*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[5], globalIdxs[2], 0.0234254740499978*kSq[5]+0.0234254740499978*kSq[4]-0.01333333333333333*kSq[3]+0.2555555555555555*epsilon[0]*rdx2Sq[1]+0.2555555555555555*epsilon[0]*rdx2Sq[0]-0.03333333333333333*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[5], globalIdxs[3], 0.0295084445425327*kSq[7]-0.03442651863295482*kSq[6]-0.063887656499994*kSq[5]-0.05962847939999439*kSq[4]+0.05333333333333333*kSq[3]-0.03849001794597505*kSq[2]-0.8888888888888888*epsilon[0]*rdx2Sq[1]-(0.1333333333333333*bcVals[0]*epsilon[0]*rdx2Sq[0])/bcVals[1]+0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[5], globalIdxs[4], (-0.01721325931647741*kSq[7])-0.05678902799999467*kSq[5]-0.03975231959999626*kSq[4]+0.01333333333333333*kSq[3]-0.4444444444444444*epsilon[0]*rdx2Sq[1]+0.03849001794597505*kSq[1]-0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[5], globalIdxs[5], (0.2666666666666667*epsilon[0]*rdx2Sq[1]*bcVals[9])/bcVals[10]+0.04549218533640458*kSq[7]-0.04549218533640458*kSq[6]-0.0127775312999988*kSq[5]-0.0127775312999988*kSq[4]+0.04666666666666667*kSq[3]-0.03849001794597505*kSq[2]+0.5777777777777777*epsilon[0]*rdx2Sq[1]+0.03849001794597505*kSq[1]-(0.2666666666666667*bcVals[0]*epsilon[0]*rdx2Sq[0])/bcVals[1]+0.5777777777777777*epsilon[0]*rdx2Sq[0]-0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[5], globalIdxs[6], (0.1333333333333333*epsilon[0]*rdx2Sq[1]*bcVals[9])/bcVals[10]+0.03442651863295482*kSq[7]-0.0295084445425327*kSq[6]-0.05962847939999439*kSq[5]-0.063887656499994*kSq[4]+0.05333333333333333*kSq[3]+0.06666666666666667*epsilon[0]*rdx2Sq[1]+0.03849001794597505*kSq[1]-0.8888888888888888*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[5], globalIdxs[7], (-(0.06666666666666667*epsilon[0]*rdx2Sq[1]*bcVals[9])/bcVals[10])+0.006147592613027645*kSq[6]+0.03336355394999686*kSq[5]+0.02697478829999747*kSq[4]+0.01924500897298752*kSq[2]+0.1888888888888889*epsilon[0]*rdx2Sq[1]+0.3111111111111111*epsilon[0]*rdx2Sq[0]-0.02222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[6], globalIdxs[0], (-0.01721325931647741*kSq[6])-0.03975231959999626*kSq[5]-0.05678902799999467*kSq[4]-0.01333333333333333*kSq[3]+0.03849001794597505*kSq[2]-0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.4444444444444444*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[6], globalIdxs[1], 0.07950463919999252*kSq[5]+0.1135780559999893*kSq[4]-0.5333333333333333*epsilon[0]*rdx2Sq[1]+0.8888888888888888*epsilon[0]*rdx2Sq[0]-0.1777777777777778*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[6], globalIdxs[2], (-0.01721325931647741*kSq[6])-0.03975231959999626*kSq[5]-0.05678902799999467*kSq[4]+0.01333333333333333*kSq[3]+0.03849001794597505*kSq[2]-0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.4444444444444444*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[6], globalIdxs[3], (-0.03442651863295482*kSq[7])+0.03442651863295482*kSq[6]+0.09938079899999068*kSq[5]+0.09938079899999068*kSq[4]+0.02666666666666666*kSq[3]-0.0769800358919501*kSq[2]+0.0769800358919501*kSq[1]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[6], globalIdxs[4], 0.03442651863295482*kSq[7]+0.03442651863295482*kSq[6]+0.09938079899999068*kSq[5]+0.09938079899999068*kSq[4]-0.02666666666666666*kSq[3]-0.0769800358919501*kSq[2]-0.0769800358919501*kSq[1]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[6], globalIdxs[5], (0.1333333333333333*epsilon[0]*rdx2Sq[1]*bcVals[9])/bcVals[10]+0.03442651863295482*kSq[7]-0.0295084445425327*kSq[6]-0.05962847939999439*kSq[5]-0.063887656499994*kSq[4]+0.05333333333333333*kSq[3]+0.06666666666666667*epsilon[0]*rdx2Sq[1]+0.03849001794597505*kSq[1]-0.8888888888888888*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[6], globalIdxs[6], (1.066666666666667*epsilon[0]*rdx2Sq[1]*bcVals[9])/bcVals[10]+0.1967229636168847*kSq[6]-0.07950463919999252*kSq[5]+0.2271561119999787*kSq[4]-0.3079201435678004*kSq[2]+0.5333333333333333*epsilon[0]*rdx2Sq[1]+1.777777777777778*epsilon[0]*rdx2Sq[0]-0.3555555555555556*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[6], globalIdxs[7], (0.1333333333333333*epsilon[0]*rdx2Sq[1]*bcVals[9])/bcVals[10]-0.03442651863295482*kSq[7]-0.0295084445425327*kSq[6]-0.05962847939999439*kSq[5]-0.063887656499994*kSq[4]-0.05333333333333333*kSq[3]+0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.03849001794597505*kSq[1]-0.8888888888888888*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[7], globalIdxs[0], 0.0234254740499978*kSq[5]+0.0234254740499978*kSq[4]+0.01333333333333333*kSq[3]+0.2555555555555555*epsilon[0]*rdx2Sq[1]+0.2555555555555555*epsilon[0]*rdx2Sq[0]-0.03333333333333333*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[7], globalIdxs[1], 0.01721325931647741*kSq[6]-0.03975231959999626*kSq[5]-0.05678902799999467*kSq[4]-0.01333333333333333*kSq[3]-0.03849001794597505*kSq[2]-0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.4444444444444444*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[7], globalIdxs[2], 0.006147592613027645*kSq[7]+0.02697478829999747*kSq[5]+0.03336355394999686*kSq[4]+0.3111111111111111*epsilon[0]*rdx2Sq[1]+0.01924500897298752*kSq[1]+0.1888888888888889*epsilon[0]*rdx2Sq[0]-0.02222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[7], globalIdxs[3], 0.01721325931647741*kSq[7]-0.05678902799999467*kSq[5]-0.03975231959999626*kSq[4]-0.01333333333333333*kSq[3]-0.4444444444444444*epsilon[0]*rdx2Sq[1]-0.03849001794597505*kSq[1]-0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[7], globalIdxs[4], (-0.0295084445425327*kSq[7])-0.03442651863295482*kSq[6]-0.063887656499994*kSq[5]-0.05962847939999439*kSq[4]-0.05333333333333333*kSq[3]-0.03849001794597505*kSq[2]-0.8888888888888888*epsilon[0]*rdx2Sq[1]+0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[7], globalIdxs[5], (-(0.06666666666666667*epsilon[0]*rdx2Sq[1]*bcVals[9])/bcVals[10])+0.006147592613027645*kSq[6]+0.03336355394999686*kSq[5]+0.02697478829999747*kSq[4]+0.01924500897298752*kSq[2]+0.1888888888888889*epsilon[0]*rdx2Sq[1]+0.3111111111111111*epsilon[0]*rdx2Sq[0]-0.02222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[7], globalIdxs[6], (0.1333333333333333*epsilon[0]*rdx2Sq[1]*bcVals[9])/bcVals[10]-0.03442651863295482*kSq[7]-0.0295084445425327*kSq[6]-0.05962847939999439*kSq[5]-0.063887656499994*kSq[4]-0.05333333333333333*kSq[3]+0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.03849001794597505*kSq[1]-0.8888888888888888*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[7], globalIdxs[7], (0.2666666666666667*epsilon[0]*rdx2Sq[1]*bcVals[9])/bcVals[10]-0.04549218533640458*kSq[7]-0.04549218533640458*kSq[6]-0.0127775312999988*kSq[5]-0.0127775312999988*kSq[4]-0.04666666666666667*kSq[3]-0.03849001794597505*kSq[2]+0.5777777777777777*epsilon[0]*rdx2Sq[1]-0.03849001794597505*kSq[1]+0.5777777777777777*epsilon[0]*rdx2Sq[0]-0.06666666666666667*kSq[0]);

}
void fem_poisson_lhs_stencil_consteps_2x_ser_p1_upx_periodicx_loy_periodicy(const double *epsilon, const double *kSq, const double *dx, const double *bcVals, const long *globalIdxs, gkyl_mat_triples *tri) 
{ 
  // epsilon: permittivity.
  // kSq: wave number squared (factor multiplying phi).
  // dx: cell length in each direction.
  // bcVals[3]: values to impose as BCs, i.e. bcVals[0]*phi+bcVals[1]*d(phi)/dx=bcVals[2].
  // globalIdxs: global linear index of each basis function/node in current cell.
  // tri: triples object (i,j,val), i.e. contribute val to i,j element of the global matrix.

  double rdx2Sq[2];
  rdx2Sq[0] = 4.0/(dx[0]*dx[0]);
  rdx2Sq[1] = 4.0/(dx[1]*dx[1]);

  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[0], (-0.1666666666666667*kSq[3])+0.1924500897298752*kSq[2]+0.3333333333333333*epsilon[0]*rdx2Sq[1]+0.1924500897298752*kSq[1]+0.3333333333333333*epsilon[0]*rdx2Sq[0]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[1], 0.09622504486493762*kSq[2]+0.1666666666666667*epsilon[0]*rdx2Sq[1]-0.3333333333333333*epsilon[0]*rdx2Sq[0]-0.1111111111111111*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[2], (-0.3333333333333333*epsilon[0]*rdx2Sq[1])+0.09622504486493762*kSq[1]+0.1666666666666667*epsilon[0]*rdx2Sq[0]-0.1111111111111111*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[3], (-0.1666666666666667*epsilon[0]*rdx2Sq[1])-0.1666666666666667*epsilon[0]*rdx2Sq[0]-0.05555555555555555*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[0], 0.09622504486493762*kSq[2]+0.1666666666666667*epsilon[0]*rdx2Sq[1]-0.3333333333333333*epsilon[0]*rdx2Sq[0]-0.1111111111111111*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[1], 0.1666666666666667*kSq[3]+0.1924500897298752*kSq[2]+0.3333333333333333*epsilon[0]*rdx2Sq[1]-0.1924500897298752*kSq[1]+0.3333333333333333*epsilon[0]*rdx2Sq[0]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[2], (-0.1666666666666667*epsilon[0]*rdx2Sq[1])-0.1666666666666667*epsilon[0]*rdx2Sq[0]-0.05555555555555555*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[3], (-0.3333333333333333*epsilon[0]*rdx2Sq[1])-0.09622504486493762*kSq[1]+0.1666666666666667*epsilon[0]*rdx2Sq[0]-0.1111111111111111*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[0], (-0.3333333333333333*epsilon[0]*rdx2Sq[1])+0.09622504486493762*kSq[1]+0.1666666666666667*epsilon[0]*rdx2Sq[0]-0.1111111111111111*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[1], (-0.1666666666666667*epsilon[0]*rdx2Sq[1])-0.1666666666666667*epsilon[0]*rdx2Sq[0]-0.05555555555555555*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[2], 0.1666666666666667*kSq[3]-0.1924500897298752*kSq[2]+0.3333333333333333*epsilon[0]*rdx2Sq[1]+0.1924500897298752*kSq[1]+0.3333333333333333*epsilon[0]*rdx2Sq[0]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[3], (-0.09622504486493762*kSq[2])+0.1666666666666667*epsilon[0]*rdx2Sq[1]-0.3333333333333333*epsilon[0]*rdx2Sq[0]-0.1111111111111111*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[0], (-0.1666666666666667*epsilon[0]*rdx2Sq[1])-0.1666666666666667*epsilon[0]*rdx2Sq[0]-0.05555555555555555*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[1], (-0.3333333333333333*epsilon[0]*rdx2Sq[1])-0.09622504486493762*kSq[1]+0.1666666666666667*epsilon[0]*rdx2Sq[0]-0.1111111111111111*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[2], (-0.09622504486493762*kSq[2])+0.1666666666666667*epsilon[0]*rdx2Sq[1]-0.3333333333333333*epsilon[0]*rdx2Sq[0]-0.1111111111111111*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[3], (-0.1666666666666667*kSq[3])-0.1924500897298752*kSq[2]+0.3333333333333333*epsilon[0]*rdx2Sq[1]-0.1924500897298752*kSq[1]+0.3333333333333333*epsilon[0]*rdx2Sq[0]-0.2222222222222222*kSq[0]);

}
void fem_poisson_lhs_stencil_consteps_2x_ser_p2_upx_periodicx_loy_periodicy(const double *epsilon, const double *kSq, const double *dx, const double *bcVals, const long *globalIdxs, gkyl_mat_triples *tri) 
{ 
  // epsilon: permittivity.
  // kSq: wave number squared (factor multiplying phi).
  // dx: cell length in each direction.
  // bcVals[3]: values to impose as BCs, i.e. bcVals[0]*phi+bcVals[1]*d(phi)/dx=bcVals[2].
  // globalIdxs: global linear index of each basis function/node in current cell.
  // tri: triples object (i,j,val), i.e. contribute val to i,j element of the global matrix.

  double rdx2Sq[2];
  rdx2Sq[0] = 4.0/(dx[0]*dx[0]);
  rdx2Sq[1] = 4.0/(dx[1]*dx[1]);

  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[0], 0.04549218533640458*kSq[7]+0.04549218533640458*kSq[6]-0.0127775312999988*kSq[5]-0.0127775312999988*kSq[4]-0.04666666666666667*kSq[3]+0.03849001794597505*kSq[2]+0.5777777777777777*epsilon[0]*rdx2Sq[1]+0.03849001794597505*kSq[1]+0.5777777777777777*epsilon[0]*rdx2Sq[0]-0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[1], 0.03442651863295482*kSq[7]+0.0295084445425327*kSq[6]-0.05962847939999439*kSq[5]-0.063887656499994*kSq[4]-0.05333333333333333*kSq[3]+0.06666666666666667*epsilon[0]*rdx2Sq[1]+0.03849001794597505*kSq[1]-0.8888888888888888*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[2], (-0.006147592613027645*kSq[6])+0.03336355394999686*kSq[5]+0.02697478829999747*kSq[4]-0.01924500897298752*kSq[2]+0.1888888888888889*epsilon[0]*rdx2Sq[1]+0.3111111111111111*epsilon[0]*rdx2Sq[0]-0.02222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[3], 0.0295084445425327*kSq[7]+0.03442651863295482*kSq[6]-0.063887656499994*kSq[5]-0.05962847939999439*kSq[4]-0.05333333333333333*kSq[3]+0.03849001794597505*kSq[2]-0.8888888888888888*epsilon[0]*rdx2Sq[1]+0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[4], (-0.01721325931647741*kSq[7])-0.05678902799999467*kSq[5]-0.03975231959999626*kSq[4]-0.01333333333333333*kSq[3]-0.4444444444444444*epsilon[0]*rdx2Sq[1]+0.03849001794597505*kSq[1]-0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[5], (-0.006147592613027645*kSq[7])+0.02697478829999747*kSq[5]+0.03336355394999686*kSq[4]+0.3111111111111111*epsilon[0]*rdx2Sq[1]-0.01924500897298752*kSq[1]+0.1888888888888889*epsilon[0]*rdx2Sq[0]-0.02222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[6], (-0.01721325931647741*kSq[6])-0.03975231959999626*kSq[5]-0.05678902799999467*kSq[4]-0.01333333333333333*kSq[3]+0.03849001794597505*kSq[2]-0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.4444444444444444*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[7], 0.0234254740499978*kSq[5]+0.0234254740499978*kSq[4]+0.01333333333333333*kSq[3]+0.2555555555555555*epsilon[0]*rdx2Sq[1]+0.2555555555555555*epsilon[0]*rdx2Sq[0]-0.03333333333333333*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[0], 0.03442651863295482*kSq[7]+0.0295084445425327*kSq[6]-0.05962847939999439*kSq[5]-0.063887656499994*kSq[4]-0.05333333333333333*kSq[3]+0.06666666666666667*epsilon[0]*rdx2Sq[1]+0.03849001794597505*kSq[1]-0.8888888888888888*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[1], (-0.1967229636168847*kSq[6])-0.07950463919999252*kSq[5]+0.2271561119999787*kSq[4]+0.3079201435678004*kSq[2]+0.5333333333333333*epsilon[0]*rdx2Sq[1]+1.777777777777778*epsilon[0]*rdx2Sq[0]-0.3555555555555556*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[2], (-0.03442651863295482*kSq[7])+0.0295084445425327*kSq[6]-0.05962847939999439*kSq[5]-0.063887656499994*kSq[4]+0.05333333333333333*kSq[3]+0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.03849001794597505*kSq[1]-0.8888888888888888*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[3], (-0.03442651863295482*kSq[7])-0.03442651863295482*kSq[6]+0.09938079899999068*kSq[5]+0.09938079899999068*kSq[4]-0.02666666666666666*kSq[3]+0.0769800358919501*kSq[2]+0.0769800358919501*kSq[1]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[4], 0.03442651863295482*kSq[7]-0.03442651863295482*kSq[6]+0.09938079899999068*kSq[5]+0.09938079899999068*kSq[4]+0.02666666666666666*kSq[3]+0.0769800358919501*kSq[2]-0.0769800358919501*kSq[1]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[5], 0.01721325931647741*kSq[6]-0.03975231959999626*kSq[5]-0.05678902799999467*kSq[4]+0.01333333333333333*kSq[3]-0.03849001794597505*kSq[2]-0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.4444444444444444*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[6], 0.07950463919999252*kSq[5]+0.1135780559999893*kSq[4]-0.5333333333333333*epsilon[0]*rdx2Sq[1]+0.8888888888888888*epsilon[0]*rdx2Sq[0]-0.1777777777777778*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[7], 0.01721325931647741*kSq[6]-0.03975231959999626*kSq[5]-0.05678902799999467*kSq[4]-0.01333333333333333*kSq[3]-0.03849001794597505*kSq[2]-0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.4444444444444444*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[0], (-0.006147592613027645*kSq[6])+0.03336355394999686*kSq[5]+0.02697478829999747*kSq[4]-0.01924500897298752*kSq[2]+0.1888888888888889*epsilon[0]*rdx2Sq[1]+0.3111111111111111*epsilon[0]*rdx2Sq[0]-0.02222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[1], (-0.03442651863295482*kSq[7])+0.0295084445425327*kSq[6]-0.05962847939999439*kSq[5]-0.063887656499994*kSq[4]+0.05333333333333333*kSq[3]+0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.03849001794597505*kSq[1]-0.8888888888888888*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[2], (-0.04549218533640458*kSq[7])+0.04549218533640458*kSq[6]-0.0127775312999988*kSq[5]-0.0127775312999988*kSq[4]+0.04666666666666667*kSq[3]+0.03849001794597505*kSq[2]+0.5777777777777777*epsilon[0]*rdx2Sq[1]-0.03849001794597505*kSq[1]+0.5777777777777777*epsilon[0]*rdx2Sq[0]-0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[3], 0.01721325931647741*kSq[7]-0.05678902799999467*kSq[5]-0.03975231959999626*kSq[4]+0.01333333333333333*kSq[3]-0.4444444444444444*epsilon[0]*rdx2Sq[1]-0.03849001794597505*kSq[1]-0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[4], (-0.0295084445425327*kSq[7])+0.03442651863295482*kSq[6]-0.063887656499994*kSq[5]-0.05962847939999439*kSq[4]+0.05333333333333333*kSq[3]+0.03849001794597505*kSq[2]-0.8888888888888888*epsilon[0]*rdx2Sq[1]+0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[5], 0.0234254740499978*kSq[5]+0.0234254740499978*kSq[4]-0.01333333333333333*kSq[3]+0.2555555555555555*epsilon[0]*rdx2Sq[1]+0.2555555555555555*epsilon[0]*rdx2Sq[0]-0.03333333333333333*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[6], (-0.01721325931647741*kSq[6])-0.03975231959999626*kSq[5]-0.05678902799999467*kSq[4]+0.01333333333333333*kSq[3]+0.03849001794597505*kSq[2]-0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.4444444444444444*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[7], 0.006147592613027645*kSq[7]+0.02697478829999747*kSq[5]+0.03336355394999686*kSq[4]+0.3111111111111111*epsilon[0]*rdx2Sq[1]+0.01924500897298752*kSq[1]+0.1888888888888889*epsilon[0]*rdx2Sq[0]-0.02222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[0], 0.0295084445425327*kSq[7]+0.03442651863295482*kSq[6]-0.063887656499994*kSq[5]-0.05962847939999439*kSq[4]-0.05333333333333333*kSq[3]+0.03849001794597505*kSq[2]-0.8888888888888888*epsilon[0]*rdx2Sq[1]+0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[1], (-0.03442651863295482*kSq[7])-0.03442651863295482*kSq[6]+0.09938079899999068*kSq[5]+0.09938079899999068*kSq[4]-0.02666666666666666*kSq[3]+0.0769800358919501*kSq[2]+0.0769800358919501*kSq[1]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[2], 0.01721325931647741*kSq[7]-0.05678902799999467*kSq[5]-0.03975231959999626*kSq[4]+0.01333333333333333*kSq[3]-0.4444444444444444*epsilon[0]*rdx2Sq[1]-0.03849001794597505*kSq[1]-0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[3], (-0.1967229636168847*kSq[7])+0.2271561119999787*kSq[5]-0.07950463919999252*kSq[4]+1.777777777777778*epsilon[0]*rdx2Sq[1]+0.3079201435678004*kSq[1]+0.5333333333333333*epsilon[0]*rdx2Sq[0]-0.3555555555555556*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[4], 0.1135780559999893*kSq[5]+0.07950463919999252*kSq[4]+0.8888888888888888*epsilon[0]*rdx2Sq[1]-0.5333333333333333*epsilon[0]*rdx2Sq[0]-0.1777777777777778*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[5], 0.0295084445425327*kSq[7]-0.03442651863295482*kSq[6]-0.063887656499994*kSq[5]-0.05962847939999439*kSq[4]+0.05333333333333333*kSq[3]-0.03849001794597505*kSq[2]-0.8888888888888888*epsilon[0]*rdx2Sq[1]+0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[6], (-0.03442651863295482*kSq[7])+0.03442651863295482*kSq[6]+0.09938079899999068*kSq[5]+0.09938079899999068*kSq[4]+0.02666666666666666*kSq[3]-0.0769800358919501*kSq[2]+0.0769800358919501*kSq[1]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[7], 0.01721325931647741*kSq[7]-0.05678902799999467*kSq[5]-0.03975231959999626*kSq[4]-0.01333333333333333*kSq[3]-0.4444444444444444*epsilon[0]*rdx2Sq[1]-0.03849001794597505*kSq[1]-0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[4], globalIdxs[0], (-0.01721325931647741*kSq[7])-0.05678902799999467*kSq[5]-0.03975231959999626*kSq[4]-0.01333333333333333*kSq[3]-0.4444444444444444*epsilon[0]*rdx2Sq[1]+0.03849001794597505*kSq[1]-0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[4], globalIdxs[1], 0.03442651863295482*kSq[7]-0.03442651863295482*kSq[6]+0.09938079899999068*kSq[5]+0.09938079899999068*kSq[4]+0.02666666666666666*kSq[3]+0.0769800358919501*kSq[2]-0.0769800358919501*kSq[1]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[4], globalIdxs[2], (-0.0295084445425327*kSq[7])+0.03442651863295482*kSq[6]-0.063887656499994*kSq[5]-0.05962847939999439*kSq[4]+0.05333333333333333*kSq[3]+0.03849001794597505*kSq[2]-0.8888888888888888*epsilon[0]*rdx2Sq[1]+0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[4], globalIdxs[3], 0.1135780559999893*kSq[5]+0.07950463919999252*kSq[4]+0.8888888888888888*epsilon[0]*rdx2Sq[1]-0.5333333333333333*epsilon[0]*rdx2Sq[0]-0.1777777777777778*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[4], globalIdxs[4], 0.1967229636168847*kSq[7]+0.2271561119999787*kSq[5]-0.07950463919999252*kSq[4]+1.777777777777778*epsilon[0]*rdx2Sq[1]-0.3079201435678004*kSq[1]+0.5333333333333333*epsilon[0]*rdx2Sq[0]-0.3555555555555556*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[4], globalIdxs[5], (-0.01721325931647741*kSq[7])-0.05678902799999467*kSq[5]-0.03975231959999626*kSq[4]+0.01333333333333333*kSq[3]-0.4444444444444444*epsilon[0]*rdx2Sq[1]+0.03849001794597505*kSq[1]-0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[4], globalIdxs[6], 0.03442651863295482*kSq[7]+0.03442651863295482*kSq[6]+0.09938079899999068*kSq[5]+0.09938079899999068*kSq[4]-0.02666666666666666*kSq[3]-0.0769800358919501*kSq[2]-0.0769800358919501*kSq[1]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[4], globalIdxs[7], (-0.0295084445425327*kSq[7])-0.03442651863295482*kSq[6]-0.063887656499994*kSq[5]-0.05962847939999439*kSq[4]-0.05333333333333333*kSq[3]-0.03849001794597505*kSq[2]-0.8888888888888888*epsilon[0]*rdx2Sq[1]+0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[5], globalIdxs[0], (-0.006147592613027645*kSq[7])+0.02697478829999747*kSq[5]+0.03336355394999686*kSq[4]+0.3111111111111111*epsilon[0]*rdx2Sq[1]-0.01924500897298752*kSq[1]+0.1888888888888889*epsilon[0]*rdx2Sq[0]-0.02222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[5], globalIdxs[1], 0.01721325931647741*kSq[6]-0.03975231959999626*kSq[5]-0.05678902799999467*kSq[4]+0.01333333333333333*kSq[3]-0.03849001794597505*kSq[2]-0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.4444444444444444*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[5], globalIdxs[2], 0.0234254740499978*kSq[5]+0.0234254740499978*kSq[4]-0.01333333333333333*kSq[3]+0.2555555555555555*epsilon[0]*rdx2Sq[1]+0.2555555555555555*epsilon[0]*rdx2Sq[0]-0.03333333333333333*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[5], globalIdxs[3], 0.0295084445425327*kSq[7]-0.03442651863295482*kSq[6]-0.063887656499994*kSq[5]-0.05962847939999439*kSq[4]+0.05333333333333333*kSq[3]-0.03849001794597505*kSq[2]-0.8888888888888888*epsilon[0]*rdx2Sq[1]+0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[5], globalIdxs[4], (-0.01721325931647741*kSq[7])-0.05678902799999467*kSq[5]-0.03975231959999626*kSq[4]+0.01333333333333333*kSq[3]-0.4444444444444444*epsilon[0]*rdx2Sq[1]+0.03849001794597505*kSq[1]-0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[5], globalIdxs[5], 0.04549218533640458*kSq[7]-0.04549218533640458*kSq[6]-0.0127775312999988*kSq[5]-0.0127775312999988*kSq[4]+0.04666666666666667*kSq[3]-0.03849001794597505*kSq[2]+0.5777777777777777*epsilon[0]*rdx2Sq[1]+0.03849001794597505*kSq[1]+0.5777777777777777*epsilon[0]*rdx2Sq[0]-0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[5], globalIdxs[6], 0.03442651863295482*kSq[7]-0.0295084445425327*kSq[6]-0.05962847939999439*kSq[5]-0.063887656499994*kSq[4]+0.05333333333333333*kSq[3]+0.06666666666666667*epsilon[0]*rdx2Sq[1]+0.03849001794597505*kSq[1]-0.8888888888888888*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[5], globalIdxs[7], 0.006147592613027645*kSq[6]+0.03336355394999686*kSq[5]+0.02697478829999747*kSq[4]+0.01924500897298752*kSq[2]+0.1888888888888889*epsilon[0]*rdx2Sq[1]+0.3111111111111111*epsilon[0]*rdx2Sq[0]-0.02222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[6], globalIdxs[0], (-0.01721325931647741*kSq[6])-0.03975231959999626*kSq[5]-0.05678902799999467*kSq[4]-0.01333333333333333*kSq[3]+0.03849001794597505*kSq[2]-0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.4444444444444444*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[6], globalIdxs[1], 0.07950463919999252*kSq[5]+0.1135780559999893*kSq[4]-0.5333333333333333*epsilon[0]*rdx2Sq[1]+0.8888888888888888*epsilon[0]*rdx2Sq[0]-0.1777777777777778*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[6], globalIdxs[2], (-0.01721325931647741*kSq[6])-0.03975231959999626*kSq[5]-0.05678902799999467*kSq[4]+0.01333333333333333*kSq[3]+0.03849001794597505*kSq[2]-0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.4444444444444444*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[6], globalIdxs[3], (-0.03442651863295482*kSq[7])+0.03442651863295482*kSq[6]+0.09938079899999068*kSq[5]+0.09938079899999068*kSq[4]+0.02666666666666666*kSq[3]-0.0769800358919501*kSq[2]+0.0769800358919501*kSq[1]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[6], globalIdxs[4], 0.03442651863295482*kSq[7]+0.03442651863295482*kSq[6]+0.09938079899999068*kSq[5]+0.09938079899999068*kSq[4]-0.02666666666666666*kSq[3]-0.0769800358919501*kSq[2]-0.0769800358919501*kSq[1]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[6], globalIdxs[5], 0.03442651863295482*kSq[7]-0.0295084445425327*kSq[6]-0.05962847939999439*kSq[5]-0.063887656499994*kSq[4]+0.05333333333333333*kSq[3]+0.06666666666666667*epsilon[0]*rdx2Sq[1]+0.03849001794597505*kSq[1]-0.8888888888888888*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[6], globalIdxs[6], 0.1967229636168847*kSq[6]-0.07950463919999252*kSq[5]+0.2271561119999787*kSq[4]-0.3079201435678004*kSq[2]+0.5333333333333333*epsilon[0]*rdx2Sq[1]+1.777777777777778*epsilon[0]*rdx2Sq[0]-0.3555555555555556*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[6], globalIdxs[7], (-0.03442651863295482*kSq[7])-0.0295084445425327*kSq[6]-0.05962847939999439*kSq[5]-0.063887656499994*kSq[4]-0.05333333333333333*kSq[3]+0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.03849001794597505*kSq[1]-0.8888888888888888*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[7], globalIdxs[0], 0.0234254740499978*kSq[5]+0.0234254740499978*kSq[4]+0.01333333333333333*kSq[3]+0.2555555555555555*epsilon[0]*rdx2Sq[1]+0.2555555555555555*epsilon[0]*rdx2Sq[0]-0.03333333333333333*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[7], globalIdxs[1], 0.01721325931647741*kSq[6]-0.03975231959999626*kSq[5]-0.05678902799999467*kSq[4]-0.01333333333333333*kSq[3]-0.03849001794597505*kSq[2]-0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.4444444444444444*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[7], globalIdxs[2], 0.006147592613027645*kSq[7]+0.02697478829999747*kSq[5]+0.03336355394999686*kSq[4]+0.3111111111111111*epsilon[0]*rdx2Sq[1]+0.01924500897298752*kSq[1]+0.1888888888888889*epsilon[0]*rdx2Sq[0]-0.02222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[7], globalIdxs[3], 0.01721325931647741*kSq[7]-0.05678902799999467*kSq[5]-0.03975231959999626*kSq[4]-0.01333333333333333*kSq[3]-0.4444444444444444*epsilon[0]*rdx2Sq[1]-0.03849001794597505*kSq[1]-0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[7], globalIdxs[4], (-0.0295084445425327*kSq[7])-0.03442651863295482*kSq[6]-0.063887656499994*kSq[5]-0.05962847939999439*kSq[4]-0.05333333333333333*kSq[3]-0.03849001794597505*kSq[2]-0.8888888888888888*epsilon[0]*rdx2Sq[1]+0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[7], globalIdxs[5], 0.006147592613027645*kSq[6]+0.03336355394999686*kSq[5]+0.02697478829999747*kSq[4]+0.01924500897298752*kSq[2]+0.1888888888888889*epsilon[0]*rdx2Sq[1]+0.3111111111111111*epsilon[0]*rdx2Sq[0]-0.02222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[7], globalIdxs[6], (-0.03442651863295482*kSq[7])-0.0295084445425327*kSq[6]-0.05962847939999439*kSq[5]-0.063887656499994*kSq[4]-0.05333333333333333*kSq[3]+0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.03849001794597505*kSq[1]-0.8888888888888888*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[7], globalIdxs[7], (-0.04549218533640458*kSq[7])-0.04549218533640458*kSq[6]-0.0127775312999988*kSq[5]-0.0127775312999988*kSq[4]-0.04666666666666667*kSq[3]-0.03849001794597505*kSq[2]+0.5777777777777777*epsilon[0]*rdx2Sq[1]-0.03849001794597505*kSq[1]+0.5777777777777777*epsilon[0]*rdx2Sq[0]-0.06666666666666667*kSq[0]);

}
void fem_poisson_lhs_stencil_consteps_2x_ser_p1_upx_periodicx_loy_dirichlety(const double *epsilon, const double *kSq, const double *dx, const double *bcVals, const long *globalIdxs, gkyl_mat_triples *tri) 
{ 
  // epsilon: permittivity.
  // kSq: wave number squared (factor multiplying phi).
  // dx: cell length in each direction.
  // bcVals[3]: values to impose as BCs, i.e. bcVals[0]*phi+bcVals[1]*d(phi)/dx=bcVals[2].
  // globalIdxs: global linear index of each basis function/node in current cell.
  // tri: triples object (i,j,val), i.e. contribute val to i,j element of the global matrix.

  double rdx2Sq[2];
  rdx2Sq[0] = 4.0/(dx[0]*dx[0]);
  rdx2Sq[1] = 4.0/(dx[1]*dx[1]);

  gkyl_mat_triples_insert(tri, globalIdxs[0], globalIdxs[0], 1.0);
  gkyl_mat_triples_insert(tri, globalIdxs[0], globalIdxs[1], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[0], globalIdxs[2], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[0], globalIdxs[3], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[1], globalIdxs[0], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[1], globalIdxs[1], 1.0);
  gkyl_mat_triples_insert(tri, globalIdxs[1], globalIdxs[2], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[1], globalIdxs[3], 0.0);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[0], (-0.3333333333333333*epsilon[0]*rdx2Sq[1])+0.09622504486493762*kSq[1]+0.1666666666666667*epsilon[0]*rdx2Sq[0]-0.1111111111111111*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[1], (-0.1666666666666667*epsilon[0]*rdx2Sq[1])-0.1666666666666667*epsilon[0]*rdx2Sq[0]-0.05555555555555555*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[2], 0.1666666666666667*kSq[3]-0.1924500897298752*kSq[2]+0.3333333333333333*epsilon[0]*rdx2Sq[1]+0.1924500897298752*kSq[1]+0.3333333333333333*epsilon[0]*rdx2Sq[0]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[3], (-0.09622504486493762*kSq[2])+0.1666666666666667*epsilon[0]*rdx2Sq[1]-0.3333333333333333*epsilon[0]*rdx2Sq[0]-0.1111111111111111*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[0], (-0.1666666666666667*epsilon[0]*rdx2Sq[1])-0.1666666666666667*epsilon[0]*rdx2Sq[0]-0.05555555555555555*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[1], (-0.3333333333333333*epsilon[0]*rdx2Sq[1])-0.09622504486493762*kSq[1]+0.1666666666666667*epsilon[0]*rdx2Sq[0]-0.1111111111111111*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[2], (-0.09622504486493762*kSq[2])+0.1666666666666667*epsilon[0]*rdx2Sq[1]-0.3333333333333333*epsilon[0]*rdx2Sq[0]-0.1111111111111111*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[3], (-0.1666666666666667*kSq[3])-0.1924500897298752*kSq[2]+0.3333333333333333*epsilon[0]*rdx2Sq[1]-0.1924500897298752*kSq[1]+0.3333333333333333*epsilon[0]*rdx2Sq[0]-0.2222222222222222*kSq[0]);

}
void fem_poisson_lhs_stencil_consteps_2x_ser_p2_upx_periodicx_loy_dirichlety(const double *epsilon, const double *kSq, const double *dx, const double *bcVals, const long *globalIdxs, gkyl_mat_triples *tri) 
{ 
  // epsilon: permittivity.
  // kSq: wave number squared (factor multiplying phi).
  // dx: cell length in each direction.
  // bcVals[3]: values to impose as BCs, i.e. bcVals[0]*phi+bcVals[1]*d(phi)/dx=bcVals[2].
  // globalIdxs: global linear index of each basis function/node in current cell.
  // tri: triples object (i,j,val), i.e. contribute val to i,j element of the global matrix.

  double rdx2Sq[2];
  rdx2Sq[0] = 4.0/(dx[0]*dx[0]);
  rdx2Sq[1] = 4.0/(dx[1]*dx[1]);

  gkyl_mat_triples_insert(tri, globalIdxs[0], globalIdxs[0], 1.0);
  gkyl_mat_triples_insert(tri, globalIdxs[0], globalIdxs[1], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[0], globalIdxs[2], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[0], globalIdxs[3], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[0], globalIdxs[4], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[0], globalIdxs[5], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[0], globalIdxs[6], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[0], globalIdxs[7], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[1], globalIdxs[0], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[1], globalIdxs[1], 1.0);
  gkyl_mat_triples_insert(tri, globalIdxs[1], globalIdxs[2], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[1], globalIdxs[3], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[1], globalIdxs[4], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[1], globalIdxs[5], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[1], globalIdxs[6], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[1], globalIdxs[7], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[2], globalIdxs[0], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[2], globalIdxs[1], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[2], globalIdxs[2], 1.0);
  gkyl_mat_triples_insert(tri, globalIdxs[2], globalIdxs[3], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[2], globalIdxs[4], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[2], globalIdxs[5], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[2], globalIdxs[6], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[2], globalIdxs[7], 0.0);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[0], 0.0295084445425327*kSq[7]+0.03442651863295482*kSq[6]-0.063887656499994*kSq[5]-0.05962847939999439*kSq[4]-0.05333333333333333*kSq[3]+0.03849001794597505*kSq[2]-0.8888888888888888*epsilon[0]*rdx2Sq[1]+0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[1], (-0.03442651863295482*kSq[7])-0.03442651863295482*kSq[6]+0.09938079899999068*kSq[5]+0.09938079899999068*kSq[4]-0.02666666666666666*kSq[3]+0.0769800358919501*kSq[2]+0.0769800358919501*kSq[1]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[2], 0.01721325931647741*kSq[7]-0.05678902799999467*kSq[5]-0.03975231959999626*kSq[4]+0.01333333333333333*kSq[3]-0.4444444444444444*epsilon[0]*rdx2Sq[1]-0.03849001794597505*kSq[1]-0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[3], (-0.1967229636168847*kSq[7])+0.2271561119999787*kSq[5]-0.07950463919999252*kSq[4]+1.777777777777778*epsilon[0]*rdx2Sq[1]+0.3079201435678004*kSq[1]+0.5333333333333333*epsilon[0]*rdx2Sq[0]-0.3555555555555556*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[4], 0.1135780559999893*kSq[5]+0.07950463919999252*kSq[4]+0.8888888888888888*epsilon[0]*rdx2Sq[1]-0.5333333333333333*epsilon[0]*rdx2Sq[0]-0.1777777777777778*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[5], 0.0295084445425327*kSq[7]-0.03442651863295482*kSq[6]-0.063887656499994*kSq[5]-0.05962847939999439*kSq[4]+0.05333333333333333*kSq[3]-0.03849001794597505*kSq[2]-0.8888888888888888*epsilon[0]*rdx2Sq[1]+0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[6], (-0.03442651863295482*kSq[7])+0.03442651863295482*kSq[6]+0.09938079899999068*kSq[5]+0.09938079899999068*kSq[4]+0.02666666666666666*kSq[3]-0.0769800358919501*kSq[2]+0.0769800358919501*kSq[1]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[7], 0.01721325931647741*kSq[7]-0.05678902799999467*kSq[5]-0.03975231959999626*kSq[4]-0.01333333333333333*kSq[3]-0.4444444444444444*epsilon[0]*rdx2Sq[1]-0.03849001794597505*kSq[1]-0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[4], globalIdxs[0], (-0.01721325931647741*kSq[7])-0.05678902799999467*kSq[5]-0.03975231959999626*kSq[4]-0.01333333333333333*kSq[3]-0.4444444444444444*epsilon[0]*rdx2Sq[1]+0.03849001794597505*kSq[1]-0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[4], globalIdxs[1], 0.03442651863295482*kSq[7]-0.03442651863295482*kSq[6]+0.09938079899999068*kSq[5]+0.09938079899999068*kSq[4]+0.02666666666666666*kSq[3]+0.0769800358919501*kSq[2]-0.0769800358919501*kSq[1]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[4], globalIdxs[2], (-0.0295084445425327*kSq[7])+0.03442651863295482*kSq[6]-0.063887656499994*kSq[5]-0.05962847939999439*kSq[4]+0.05333333333333333*kSq[3]+0.03849001794597505*kSq[2]-0.8888888888888888*epsilon[0]*rdx2Sq[1]+0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[4], globalIdxs[3], 0.1135780559999893*kSq[5]+0.07950463919999252*kSq[4]+0.8888888888888888*epsilon[0]*rdx2Sq[1]-0.5333333333333333*epsilon[0]*rdx2Sq[0]-0.1777777777777778*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[4], globalIdxs[4], 0.1967229636168847*kSq[7]+0.2271561119999787*kSq[5]-0.07950463919999252*kSq[4]+1.777777777777778*epsilon[0]*rdx2Sq[1]-0.3079201435678004*kSq[1]+0.5333333333333333*epsilon[0]*rdx2Sq[0]-0.3555555555555556*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[4], globalIdxs[5], (-0.01721325931647741*kSq[7])-0.05678902799999467*kSq[5]-0.03975231959999626*kSq[4]+0.01333333333333333*kSq[3]-0.4444444444444444*epsilon[0]*rdx2Sq[1]+0.03849001794597505*kSq[1]-0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[4], globalIdxs[6], 0.03442651863295482*kSq[7]+0.03442651863295482*kSq[6]+0.09938079899999068*kSq[5]+0.09938079899999068*kSq[4]-0.02666666666666666*kSq[3]-0.0769800358919501*kSq[2]-0.0769800358919501*kSq[1]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[4], globalIdxs[7], (-0.0295084445425327*kSq[7])-0.03442651863295482*kSq[6]-0.063887656499994*kSq[5]-0.05962847939999439*kSq[4]-0.05333333333333333*kSq[3]-0.03849001794597505*kSq[2]-0.8888888888888888*epsilon[0]*rdx2Sq[1]+0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[5], globalIdxs[0], (-0.006147592613027645*kSq[7])+0.02697478829999747*kSq[5]+0.03336355394999686*kSq[4]+0.3111111111111111*epsilon[0]*rdx2Sq[1]-0.01924500897298752*kSq[1]+0.1888888888888889*epsilon[0]*rdx2Sq[0]-0.02222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[5], globalIdxs[1], 0.01721325931647741*kSq[6]-0.03975231959999626*kSq[5]-0.05678902799999467*kSq[4]+0.01333333333333333*kSq[3]-0.03849001794597505*kSq[2]-0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.4444444444444444*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[5], globalIdxs[2], 0.0234254740499978*kSq[5]+0.0234254740499978*kSq[4]-0.01333333333333333*kSq[3]+0.2555555555555555*epsilon[0]*rdx2Sq[1]+0.2555555555555555*epsilon[0]*rdx2Sq[0]-0.03333333333333333*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[5], globalIdxs[3], 0.0295084445425327*kSq[7]-0.03442651863295482*kSq[6]-0.063887656499994*kSq[5]-0.05962847939999439*kSq[4]+0.05333333333333333*kSq[3]-0.03849001794597505*kSq[2]-0.8888888888888888*epsilon[0]*rdx2Sq[1]+0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[5], globalIdxs[4], (-0.01721325931647741*kSq[7])-0.05678902799999467*kSq[5]-0.03975231959999626*kSq[4]+0.01333333333333333*kSq[3]-0.4444444444444444*epsilon[0]*rdx2Sq[1]+0.03849001794597505*kSq[1]-0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[5], globalIdxs[5], 0.04549218533640458*kSq[7]-0.04549218533640458*kSq[6]-0.0127775312999988*kSq[5]-0.0127775312999988*kSq[4]+0.04666666666666667*kSq[3]-0.03849001794597505*kSq[2]+0.5777777777777777*epsilon[0]*rdx2Sq[1]+0.03849001794597505*kSq[1]+0.5777777777777777*epsilon[0]*rdx2Sq[0]-0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[5], globalIdxs[6], 0.03442651863295482*kSq[7]-0.0295084445425327*kSq[6]-0.05962847939999439*kSq[5]-0.063887656499994*kSq[4]+0.05333333333333333*kSq[3]+0.06666666666666667*epsilon[0]*rdx2Sq[1]+0.03849001794597505*kSq[1]-0.8888888888888888*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[5], globalIdxs[7], 0.006147592613027645*kSq[6]+0.03336355394999686*kSq[5]+0.02697478829999747*kSq[4]+0.01924500897298752*kSq[2]+0.1888888888888889*epsilon[0]*rdx2Sq[1]+0.3111111111111111*epsilon[0]*rdx2Sq[0]-0.02222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[6], globalIdxs[0], (-0.01721325931647741*kSq[6])-0.03975231959999626*kSq[5]-0.05678902799999467*kSq[4]-0.01333333333333333*kSq[3]+0.03849001794597505*kSq[2]-0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.4444444444444444*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[6], globalIdxs[1], 0.07950463919999252*kSq[5]+0.1135780559999893*kSq[4]-0.5333333333333333*epsilon[0]*rdx2Sq[1]+0.8888888888888888*epsilon[0]*rdx2Sq[0]-0.1777777777777778*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[6], globalIdxs[2], (-0.01721325931647741*kSq[6])-0.03975231959999626*kSq[5]-0.05678902799999467*kSq[4]+0.01333333333333333*kSq[3]+0.03849001794597505*kSq[2]-0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.4444444444444444*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[6], globalIdxs[3], (-0.03442651863295482*kSq[7])+0.03442651863295482*kSq[6]+0.09938079899999068*kSq[5]+0.09938079899999068*kSq[4]+0.02666666666666666*kSq[3]-0.0769800358919501*kSq[2]+0.0769800358919501*kSq[1]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[6], globalIdxs[4], 0.03442651863295482*kSq[7]+0.03442651863295482*kSq[6]+0.09938079899999068*kSq[5]+0.09938079899999068*kSq[4]-0.02666666666666666*kSq[3]-0.0769800358919501*kSq[2]-0.0769800358919501*kSq[1]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[6], globalIdxs[5], 0.03442651863295482*kSq[7]-0.0295084445425327*kSq[6]-0.05962847939999439*kSq[5]-0.063887656499994*kSq[4]+0.05333333333333333*kSq[3]+0.06666666666666667*epsilon[0]*rdx2Sq[1]+0.03849001794597505*kSq[1]-0.8888888888888888*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[6], globalIdxs[6], 0.1967229636168847*kSq[6]-0.07950463919999252*kSq[5]+0.2271561119999787*kSq[4]-0.3079201435678004*kSq[2]+0.5333333333333333*epsilon[0]*rdx2Sq[1]+1.777777777777778*epsilon[0]*rdx2Sq[0]-0.3555555555555556*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[6], globalIdxs[7], (-0.03442651863295482*kSq[7])-0.0295084445425327*kSq[6]-0.05962847939999439*kSq[5]-0.063887656499994*kSq[4]-0.05333333333333333*kSq[3]+0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.03849001794597505*kSq[1]-0.8888888888888888*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[7], globalIdxs[0], 0.0234254740499978*kSq[5]+0.0234254740499978*kSq[4]+0.01333333333333333*kSq[3]+0.2555555555555555*epsilon[0]*rdx2Sq[1]+0.2555555555555555*epsilon[0]*rdx2Sq[0]-0.03333333333333333*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[7], globalIdxs[1], 0.01721325931647741*kSq[6]-0.03975231959999626*kSq[5]-0.05678902799999467*kSq[4]-0.01333333333333333*kSq[3]-0.03849001794597505*kSq[2]-0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.4444444444444444*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[7], globalIdxs[2], 0.006147592613027645*kSq[7]+0.02697478829999747*kSq[5]+0.03336355394999686*kSq[4]+0.3111111111111111*epsilon[0]*rdx2Sq[1]+0.01924500897298752*kSq[1]+0.1888888888888889*epsilon[0]*rdx2Sq[0]-0.02222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[7], globalIdxs[3], 0.01721325931647741*kSq[7]-0.05678902799999467*kSq[5]-0.03975231959999626*kSq[4]-0.01333333333333333*kSq[3]-0.4444444444444444*epsilon[0]*rdx2Sq[1]-0.03849001794597505*kSq[1]-0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[7], globalIdxs[4], (-0.0295084445425327*kSq[7])-0.03442651863295482*kSq[6]-0.063887656499994*kSq[5]-0.05962847939999439*kSq[4]-0.05333333333333333*kSq[3]-0.03849001794597505*kSq[2]-0.8888888888888888*epsilon[0]*rdx2Sq[1]+0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[7], globalIdxs[5], 0.006147592613027645*kSq[6]+0.03336355394999686*kSq[5]+0.02697478829999747*kSq[4]+0.01924500897298752*kSq[2]+0.1888888888888889*epsilon[0]*rdx2Sq[1]+0.3111111111111111*epsilon[0]*rdx2Sq[0]-0.02222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[7], globalIdxs[6], (-0.03442651863295482*kSq[7])-0.0295084445425327*kSq[6]-0.05962847939999439*kSq[5]-0.063887656499994*kSq[4]-0.05333333333333333*kSq[3]+0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.03849001794597505*kSq[1]-0.8888888888888888*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[7], globalIdxs[7], (-0.04549218533640458*kSq[7])-0.04549218533640458*kSq[6]-0.0127775312999988*kSq[5]-0.0127775312999988*kSq[4]-0.04666666666666667*kSq[3]-0.03849001794597505*kSq[2]+0.5777777777777777*epsilon[0]*rdx2Sq[1]-0.03849001794597505*kSq[1]+0.5777777777777777*epsilon[0]*rdx2Sq[0]-0.06666666666666667*kSq[0]);

}
void fem_poisson_lhs_stencil_consteps_2x_ser_p1_upx_periodicx_loy_neumanny(const double *epsilon, const double *kSq, const double *dx, const double *bcVals, const long *globalIdxs, gkyl_mat_triples *tri) 
{ 
  // epsilon: permittivity.
  // kSq: wave number squared (factor multiplying phi).
  // dx: cell length in each direction.
  // bcVals[3]: values to impose as BCs, i.e. bcVals[0]*phi+bcVals[1]*d(phi)/dx=bcVals[2].
  // globalIdxs: global linear index of each basis function/node in current cell.
  // tri: triples object (i,j,val), i.e. contribute val to i,j element of the global matrix.

  double rdx2Sq[2];
  rdx2Sq[0] = 4.0/(dx[0]*dx[0]);
  rdx2Sq[1] = 4.0/(dx[1]*dx[1]);

  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[0], (-0.1666666666666667*kSq[3])+0.1924500897298752*kSq[2]+0.3333333333333333*epsilon[0]*rdx2Sq[1]+0.1924500897298752*kSq[1]+0.3333333333333333*epsilon[0]*rdx2Sq[0]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[1], 0.09622504486493762*kSq[2]+0.1666666666666667*epsilon[0]*rdx2Sq[1]-0.3333333333333333*epsilon[0]*rdx2Sq[0]-0.1111111111111111*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[2], (-0.3333333333333333*epsilon[0]*rdx2Sq[1])+0.09622504486493762*kSq[1]+0.1666666666666667*epsilon[0]*rdx2Sq[0]-0.1111111111111111*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[3], (-0.1666666666666667*epsilon[0]*rdx2Sq[1])-0.1666666666666667*epsilon[0]*rdx2Sq[0]-0.05555555555555555*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[0], 0.09622504486493762*kSq[2]+0.1666666666666667*epsilon[0]*rdx2Sq[1]-0.3333333333333333*epsilon[0]*rdx2Sq[0]-0.1111111111111111*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[1], 0.1666666666666667*kSq[3]+0.1924500897298752*kSq[2]+0.3333333333333333*epsilon[0]*rdx2Sq[1]-0.1924500897298752*kSq[1]+0.3333333333333333*epsilon[0]*rdx2Sq[0]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[2], (-0.1666666666666667*epsilon[0]*rdx2Sq[1])-0.1666666666666667*epsilon[0]*rdx2Sq[0]-0.05555555555555555*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[3], (-0.3333333333333333*epsilon[0]*rdx2Sq[1])-0.09622504486493762*kSq[1]+0.1666666666666667*epsilon[0]*rdx2Sq[0]-0.1111111111111111*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[0], (-0.3333333333333333*epsilon[0]*rdx2Sq[1])+0.09622504486493762*kSq[1]+0.1666666666666667*epsilon[0]*rdx2Sq[0]-0.1111111111111111*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[1], (-0.1666666666666667*epsilon[0]*rdx2Sq[1])-0.1666666666666667*epsilon[0]*rdx2Sq[0]-0.05555555555555555*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[2], 0.1666666666666667*kSq[3]-0.1924500897298752*kSq[2]+0.3333333333333333*epsilon[0]*rdx2Sq[1]+0.1924500897298752*kSq[1]+0.3333333333333333*epsilon[0]*rdx2Sq[0]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[3], (-0.09622504486493762*kSq[2])+0.1666666666666667*epsilon[0]*rdx2Sq[1]-0.3333333333333333*epsilon[0]*rdx2Sq[0]-0.1111111111111111*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[0], (-0.1666666666666667*epsilon[0]*rdx2Sq[1])-0.1666666666666667*epsilon[0]*rdx2Sq[0]-0.05555555555555555*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[1], (-0.3333333333333333*epsilon[0]*rdx2Sq[1])-0.09622504486493762*kSq[1]+0.1666666666666667*epsilon[0]*rdx2Sq[0]-0.1111111111111111*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[2], (-0.09622504486493762*kSq[2])+0.1666666666666667*epsilon[0]*rdx2Sq[1]-0.3333333333333333*epsilon[0]*rdx2Sq[0]-0.1111111111111111*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[3], (-0.1666666666666667*kSq[3])-0.1924500897298752*kSq[2]+0.3333333333333333*epsilon[0]*rdx2Sq[1]-0.1924500897298752*kSq[1]+0.3333333333333333*epsilon[0]*rdx2Sq[0]-0.2222222222222222*kSq[0]);

}
void fem_poisson_lhs_stencil_consteps_2x_ser_p2_upx_periodicx_loy_neumanny(const double *epsilon, const double *kSq, const double *dx, const double *bcVals, const long *globalIdxs, gkyl_mat_triples *tri) 
{ 
  // epsilon: permittivity.
  // kSq: wave number squared (factor multiplying phi).
  // dx: cell length in each direction.
  // bcVals[3]: values to impose as BCs, i.e. bcVals[0]*phi+bcVals[1]*d(phi)/dx=bcVals[2].
  // globalIdxs: global linear index of each basis function/node in current cell.
  // tri: triples object (i,j,val), i.e. contribute val to i,j element of the global matrix.

  double rdx2Sq[2];
  rdx2Sq[0] = 4.0/(dx[0]*dx[0]);
  rdx2Sq[1] = 4.0/(dx[1]*dx[1]);

  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[0], 0.04549218533640458*kSq[7]+0.04549218533640458*kSq[6]-0.0127775312999988*kSq[5]-0.0127775312999988*kSq[4]-0.04666666666666667*kSq[3]+0.03849001794597505*kSq[2]+0.5777777777777777*epsilon[0]*rdx2Sq[1]+0.03849001794597505*kSq[1]+0.5777777777777777*epsilon[0]*rdx2Sq[0]-0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[1], 0.03442651863295482*kSq[7]+0.0295084445425327*kSq[6]-0.05962847939999439*kSq[5]-0.063887656499994*kSq[4]-0.05333333333333333*kSq[3]+0.06666666666666667*epsilon[0]*rdx2Sq[1]+0.03849001794597505*kSq[1]-0.8888888888888888*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[2], (-0.006147592613027645*kSq[6])+0.03336355394999686*kSq[5]+0.02697478829999747*kSq[4]-0.01924500897298752*kSq[2]+0.1888888888888889*epsilon[0]*rdx2Sq[1]+0.3111111111111111*epsilon[0]*rdx2Sq[0]-0.02222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[3], 0.0295084445425327*kSq[7]+0.03442651863295482*kSq[6]-0.063887656499994*kSq[5]-0.05962847939999439*kSq[4]-0.05333333333333333*kSq[3]+0.03849001794597505*kSq[2]-0.8888888888888888*epsilon[0]*rdx2Sq[1]+0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[4], (-0.01721325931647741*kSq[7])-0.05678902799999467*kSq[5]-0.03975231959999626*kSq[4]-0.01333333333333333*kSq[3]-0.4444444444444444*epsilon[0]*rdx2Sq[1]+0.03849001794597505*kSq[1]-0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[5], (-0.006147592613027645*kSq[7])+0.02697478829999747*kSq[5]+0.03336355394999686*kSq[4]+0.3111111111111111*epsilon[0]*rdx2Sq[1]-0.01924500897298752*kSq[1]+0.1888888888888889*epsilon[0]*rdx2Sq[0]-0.02222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[6], (-0.01721325931647741*kSq[6])-0.03975231959999626*kSq[5]-0.05678902799999467*kSq[4]-0.01333333333333333*kSq[3]+0.03849001794597505*kSq[2]-0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.4444444444444444*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[7], 0.0234254740499978*kSq[5]+0.0234254740499978*kSq[4]+0.01333333333333333*kSq[3]+0.2555555555555555*epsilon[0]*rdx2Sq[1]+0.2555555555555555*epsilon[0]*rdx2Sq[0]-0.03333333333333333*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[0], 0.03442651863295482*kSq[7]+0.0295084445425327*kSq[6]-0.05962847939999439*kSq[5]-0.063887656499994*kSq[4]-0.05333333333333333*kSq[3]+0.06666666666666667*epsilon[0]*rdx2Sq[1]+0.03849001794597505*kSq[1]-0.8888888888888888*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[1], (-0.1967229636168847*kSq[6])-0.07950463919999252*kSq[5]+0.2271561119999787*kSq[4]+0.3079201435678004*kSq[2]+0.5333333333333333*epsilon[0]*rdx2Sq[1]+1.777777777777778*epsilon[0]*rdx2Sq[0]-0.3555555555555556*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[2], (-0.03442651863295482*kSq[7])+0.0295084445425327*kSq[6]-0.05962847939999439*kSq[5]-0.063887656499994*kSq[4]+0.05333333333333333*kSq[3]+0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.03849001794597505*kSq[1]-0.8888888888888888*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[3], (-0.03442651863295482*kSq[7])-0.03442651863295482*kSq[6]+0.09938079899999068*kSq[5]+0.09938079899999068*kSq[4]-0.02666666666666666*kSq[3]+0.0769800358919501*kSq[2]+0.0769800358919501*kSq[1]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[4], 0.03442651863295482*kSq[7]-0.03442651863295482*kSq[6]+0.09938079899999068*kSq[5]+0.09938079899999068*kSq[4]+0.02666666666666666*kSq[3]+0.0769800358919501*kSq[2]-0.0769800358919501*kSq[1]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[5], 0.01721325931647741*kSq[6]-0.03975231959999626*kSq[5]-0.05678902799999467*kSq[4]+0.01333333333333333*kSq[3]-0.03849001794597505*kSq[2]-0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.4444444444444444*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[6], 0.07950463919999252*kSq[5]+0.1135780559999893*kSq[4]-0.5333333333333333*epsilon[0]*rdx2Sq[1]+0.8888888888888888*epsilon[0]*rdx2Sq[0]-0.1777777777777778*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[7], 0.01721325931647741*kSq[6]-0.03975231959999626*kSq[5]-0.05678902799999467*kSq[4]-0.01333333333333333*kSq[3]-0.03849001794597505*kSq[2]-0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.4444444444444444*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[0], (-0.006147592613027645*kSq[6])+0.03336355394999686*kSq[5]+0.02697478829999747*kSq[4]-0.01924500897298752*kSq[2]+0.1888888888888889*epsilon[0]*rdx2Sq[1]+0.3111111111111111*epsilon[0]*rdx2Sq[0]-0.02222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[1], (-0.03442651863295482*kSq[7])+0.0295084445425327*kSq[6]-0.05962847939999439*kSq[5]-0.063887656499994*kSq[4]+0.05333333333333333*kSq[3]+0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.03849001794597505*kSq[1]-0.8888888888888888*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[2], (-0.04549218533640458*kSq[7])+0.04549218533640458*kSq[6]-0.0127775312999988*kSq[5]-0.0127775312999988*kSq[4]+0.04666666666666667*kSq[3]+0.03849001794597505*kSq[2]+0.5777777777777777*epsilon[0]*rdx2Sq[1]-0.03849001794597505*kSq[1]+0.5777777777777777*epsilon[0]*rdx2Sq[0]-0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[3], 0.01721325931647741*kSq[7]-0.05678902799999467*kSq[5]-0.03975231959999626*kSq[4]+0.01333333333333333*kSq[3]-0.4444444444444444*epsilon[0]*rdx2Sq[1]-0.03849001794597505*kSq[1]-0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[4], (-0.0295084445425327*kSq[7])+0.03442651863295482*kSq[6]-0.063887656499994*kSq[5]-0.05962847939999439*kSq[4]+0.05333333333333333*kSq[3]+0.03849001794597505*kSq[2]-0.8888888888888888*epsilon[0]*rdx2Sq[1]+0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[5], 0.0234254740499978*kSq[5]+0.0234254740499978*kSq[4]-0.01333333333333333*kSq[3]+0.2555555555555555*epsilon[0]*rdx2Sq[1]+0.2555555555555555*epsilon[0]*rdx2Sq[0]-0.03333333333333333*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[6], (-0.01721325931647741*kSq[6])-0.03975231959999626*kSq[5]-0.05678902799999467*kSq[4]+0.01333333333333333*kSq[3]+0.03849001794597505*kSq[2]-0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.4444444444444444*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[7], 0.006147592613027645*kSq[7]+0.02697478829999747*kSq[5]+0.03336355394999686*kSq[4]+0.3111111111111111*epsilon[0]*rdx2Sq[1]+0.01924500897298752*kSq[1]+0.1888888888888889*epsilon[0]*rdx2Sq[0]-0.02222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[0], 0.0295084445425327*kSq[7]+0.03442651863295482*kSq[6]-0.063887656499994*kSq[5]-0.05962847939999439*kSq[4]-0.05333333333333333*kSq[3]+0.03849001794597505*kSq[2]-0.8888888888888888*epsilon[0]*rdx2Sq[1]+0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[1], (-0.03442651863295482*kSq[7])-0.03442651863295482*kSq[6]+0.09938079899999068*kSq[5]+0.09938079899999068*kSq[4]-0.02666666666666666*kSq[3]+0.0769800358919501*kSq[2]+0.0769800358919501*kSq[1]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[2], 0.01721325931647741*kSq[7]-0.05678902799999467*kSq[5]-0.03975231959999626*kSq[4]+0.01333333333333333*kSq[3]-0.4444444444444444*epsilon[0]*rdx2Sq[1]-0.03849001794597505*kSq[1]-0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[3], (-0.1967229636168847*kSq[7])+0.2271561119999787*kSq[5]-0.07950463919999252*kSq[4]+1.777777777777778*epsilon[0]*rdx2Sq[1]+0.3079201435678004*kSq[1]+0.5333333333333333*epsilon[0]*rdx2Sq[0]-0.3555555555555556*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[4], 0.1135780559999893*kSq[5]+0.07950463919999252*kSq[4]+0.8888888888888888*epsilon[0]*rdx2Sq[1]-0.5333333333333333*epsilon[0]*rdx2Sq[0]-0.1777777777777778*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[5], 0.0295084445425327*kSq[7]-0.03442651863295482*kSq[6]-0.063887656499994*kSq[5]-0.05962847939999439*kSq[4]+0.05333333333333333*kSq[3]-0.03849001794597505*kSq[2]-0.8888888888888888*epsilon[0]*rdx2Sq[1]+0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[6], (-0.03442651863295482*kSq[7])+0.03442651863295482*kSq[6]+0.09938079899999068*kSq[5]+0.09938079899999068*kSq[4]+0.02666666666666666*kSq[3]-0.0769800358919501*kSq[2]+0.0769800358919501*kSq[1]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[7], 0.01721325931647741*kSq[7]-0.05678902799999467*kSq[5]-0.03975231959999626*kSq[4]-0.01333333333333333*kSq[3]-0.4444444444444444*epsilon[0]*rdx2Sq[1]-0.03849001794597505*kSq[1]-0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[4], globalIdxs[0], (-0.01721325931647741*kSq[7])-0.05678902799999467*kSq[5]-0.03975231959999626*kSq[4]-0.01333333333333333*kSq[3]-0.4444444444444444*epsilon[0]*rdx2Sq[1]+0.03849001794597505*kSq[1]-0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[4], globalIdxs[1], 0.03442651863295482*kSq[7]-0.03442651863295482*kSq[6]+0.09938079899999068*kSq[5]+0.09938079899999068*kSq[4]+0.02666666666666666*kSq[3]+0.0769800358919501*kSq[2]-0.0769800358919501*kSq[1]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[4], globalIdxs[2], (-0.0295084445425327*kSq[7])+0.03442651863295482*kSq[6]-0.063887656499994*kSq[5]-0.05962847939999439*kSq[4]+0.05333333333333333*kSq[3]+0.03849001794597505*kSq[2]-0.8888888888888888*epsilon[0]*rdx2Sq[1]+0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[4], globalIdxs[3], 0.1135780559999893*kSq[5]+0.07950463919999252*kSq[4]+0.8888888888888888*epsilon[0]*rdx2Sq[1]-0.5333333333333333*epsilon[0]*rdx2Sq[0]-0.1777777777777778*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[4], globalIdxs[4], 0.1967229636168847*kSq[7]+0.2271561119999787*kSq[5]-0.07950463919999252*kSq[4]+1.777777777777778*epsilon[0]*rdx2Sq[1]-0.3079201435678004*kSq[1]+0.5333333333333333*epsilon[0]*rdx2Sq[0]-0.3555555555555556*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[4], globalIdxs[5], (-0.01721325931647741*kSq[7])-0.05678902799999467*kSq[5]-0.03975231959999626*kSq[4]+0.01333333333333333*kSq[3]-0.4444444444444444*epsilon[0]*rdx2Sq[1]+0.03849001794597505*kSq[1]-0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[4], globalIdxs[6], 0.03442651863295482*kSq[7]+0.03442651863295482*kSq[6]+0.09938079899999068*kSq[5]+0.09938079899999068*kSq[4]-0.02666666666666666*kSq[3]-0.0769800358919501*kSq[2]-0.0769800358919501*kSq[1]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[4], globalIdxs[7], (-0.0295084445425327*kSq[7])-0.03442651863295482*kSq[6]-0.063887656499994*kSq[5]-0.05962847939999439*kSq[4]-0.05333333333333333*kSq[3]-0.03849001794597505*kSq[2]-0.8888888888888888*epsilon[0]*rdx2Sq[1]+0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[5], globalIdxs[0], (-0.006147592613027645*kSq[7])+0.02697478829999747*kSq[5]+0.03336355394999686*kSq[4]+0.3111111111111111*epsilon[0]*rdx2Sq[1]-0.01924500897298752*kSq[1]+0.1888888888888889*epsilon[0]*rdx2Sq[0]-0.02222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[5], globalIdxs[1], 0.01721325931647741*kSq[6]-0.03975231959999626*kSq[5]-0.05678902799999467*kSq[4]+0.01333333333333333*kSq[3]-0.03849001794597505*kSq[2]-0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.4444444444444444*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[5], globalIdxs[2], 0.0234254740499978*kSq[5]+0.0234254740499978*kSq[4]-0.01333333333333333*kSq[3]+0.2555555555555555*epsilon[0]*rdx2Sq[1]+0.2555555555555555*epsilon[0]*rdx2Sq[0]-0.03333333333333333*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[5], globalIdxs[3], 0.0295084445425327*kSq[7]-0.03442651863295482*kSq[6]-0.063887656499994*kSq[5]-0.05962847939999439*kSq[4]+0.05333333333333333*kSq[3]-0.03849001794597505*kSq[2]-0.8888888888888888*epsilon[0]*rdx2Sq[1]+0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[5], globalIdxs[4], (-0.01721325931647741*kSq[7])-0.05678902799999467*kSq[5]-0.03975231959999626*kSq[4]+0.01333333333333333*kSq[3]-0.4444444444444444*epsilon[0]*rdx2Sq[1]+0.03849001794597505*kSq[1]-0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[5], globalIdxs[5], 0.04549218533640458*kSq[7]-0.04549218533640458*kSq[6]-0.0127775312999988*kSq[5]-0.0127775312999988*kSq[4]+0.04666666666666667*kSq[3]-0.03849001794597505*kSq[2]+0.5777777777777777*epsilon[0]*rdx2Sq[1]+0.03849001794597505*kSq[1]+0.5777777777777777*epsilon[0]*rdx2Sq[0]-0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[5], globalIdxs[6], 0.03442651863295482*kSq[7]-0.0295084445425327*kSq[6]-0.05962847939999439*kSq[5]-0.063887656499994*kSq[4]+0.05333333333333333*kSq[3]+0.06666666666666667*epsilon[0]*rdx2Sq[1]+0.03849001794597505*kSq[1]-0.8888888888888888*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[5], globalIdxs[7], 0.006147592613027645*kSq[6]+0.03336355394999686*kSq[5]+0.02697478829999747*kSq[4]+0.01924500897298752*kSq[2]+0.1888888888888889*epsilon[0]*rdx2Sq[1]+0.3111111111111111*epsilon[0]*rdx2Sq[0]-0.02222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[6], globalIdxs[0], (-0.01721325931647741*kSq[6])-0.03975231959999626*kSq[5]-0.05678902799999467*kSq[4]-0.01333333333333333*kSq[3]+0.03849001794597505*kSq[2]-0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.4444444444444444*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[6], globalIdxs[1], 0.07950463919999252*kSq[5]+0.1135780559999893*kSq[4]-0.5333333333333333*epsilon[0]*rdx2Sq[1]+0.8888888888888888*epsilon[0]*rdx2Sq[0]-0.1777777777777778*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[6], globalIdxs[2], (-0.01721325931647741*kSq[6])-0.03975231959999626*kSq[5]-0.05678902799999467*kSq[4]+0.01333333333333333*kSq[3]+0.03849001794597505*kSq[2]-0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.4444444444444444*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[6], globalIdxs[3], (-0.03442651863295482*kSq[7])+0.03442651863295482*kSq[6]+0.09938079899999068*kSq[5]+0.09938079899999068*kSq[4]+0.02666666666666666*kSq[3]-0.0769800358919501*kSq[2]+0.0769800358919501*kSq[1]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[6], globalIdxs[4], 0.03442651863295482*kSq[7]+0.03442651863295482*kSq[6]+0.09938079899999068*kSq[5]+0.09938079899999068*kSq[4]-0.02666666666666666*kSq[3]-0.0769800358919501*kSq[2]-0.0769800358919501*kSq[1]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[6], globalIdxs[5], 0.03442651863295482*kSq[7]-0.0295084445425327*kSq[6]-0.05962847939999439*kSq[5]-0.063887656499994*kSq[4]+0.05333333333333333*kSq[3]+0.06666666666666667*epsilon[0]*rdx2Sq[1]+0.03849001794597505*kSq[1]-0.8888888888888888*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[6], globalIdxs[6], 0.1967229636168847*kSq[6]-0.07950463919999252*kSq[5]+0.2271561119999787*kSq[4]-0.3079201435678004*kSq[2]+0.5333333333333333*epsilon[0]*rdx2Sq[1]+1.777777777777778*epsilon[0]*rdx2Sq[0]-0.3555555555555556*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[6], globalIdxs[7], (-0.03442651863295482*kSq[7])-0.0295084445425327*kSq[6]-0.05962847939999439*kSq[5]-0.063887656499994*kSq[4]-0.05333333333333333*kSq[3]+0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.03849001794597505*kSq[1]-0.8888888888888888*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[7], globalIdxs[0], 0.0234254740499978*kSq[5]+0.0234254740499978*kSq[4]+0.01333333333333333*kSq[3]+0.2555555555555555*epsilon[0]*rdx2Sq[1]+0.2555555555555555*epsilon[0]*rdx2Sq[0]-0.03333333333333333*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[7], globalIdxs[1], 0.01721325931647741*kSq[6]-0.03975231959999626*kSq[5]-0.05678902799999467*kSq[4]-0.01333333333333333*kSq[3]-0.03849001794597505*kSq[2]-0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.4444444444444444*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[7], globalIdxs[2], 0.006147592613027645*kSq[7]+0.02697478829999747*kSq[5]+0.03336355394999686*kSq[4]+0.3111111111111111*epsilon[0]*rdx2Sq[1]+0.01924500897298752*kSq[1]+0.1888888888888889*epsilon[0]*rdx2Sq[0]-0.02222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[7], globalIdxs[3], 0.01721325931647741*kSq[7]-0.05678902799999467*kSq[5]-0.03975231959999626*kSq[4]-0.01333333333333333*kSq[3]-0.4444444444444444*epsilon[0]*rdx2Sq[1]-0.03849001794597505*kSq[1]-0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[7], globalIdxs[4], (-0.0295084445425327*kSq[7])-0.03442651863295482*kSq[6]-0.063887656499994*kSq[5]-0.05962847939999439*kSq[4]-0.05333333333333333*kSq[3]-0.03849001794597505*kSq[2]-0.8888888888888888*epsilon[0]*rdx2Sq[1]+0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[7], globalIdxs[5], 0.006147592613027645*kSq[6]+0.03336355394999686*kSq[5]+0.02697478829999747*kSq[4]+0.01924500897298752*kSq[2]+0.1888888888888889*epsilon[0]*rdx2Sq[1]+0.3111111111111111*epsilon[0]*rdx2Sq[0]-0.02222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[7], globalIdxs[6], (-0.03442651863295482*kSq[7])-0.0295084445425327*kSq[6]-0.05962847939999439*kSq[5]-0.063887656499994*kSq[4]-0.05333333333333333*kSq[3]+0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.03849001794597505*kSq[1]-0.8888888888888888*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[7], globalIdxs[7], (-0.04549218533640458*kSq[7])-0.04549218533640458*kSq[6]-0.0127775312999988*kSq[5]-0.0127775312999988*kSq[4]-0.04666666666666667*kSq[3]-0.03849001794597505*kSq[2]+0.5777777777777777*epsilon[0]*rdx2Sq[1]-0.03849001794597505*kSq[1]+0.5777777777777777*epsilon[0]*rdx2Sq[0]-0.06666666666666667*kSq[0]);

}
void fem_poisson_lhs_stencil_consteps_2x_ser_p1_upx_periodicx_loy_robiny(const double *epsilon, const double *kSq, const double *dx, const double *bcVals, const long *globalIdxs, gkyl_mat_triples *tri) 
{ 
  // epsilon: permittivity.
  // kSq: wave number squared (factor multiplying phi).
  // dx: cell length in each direction.
  // bcVals[3]: values to impose as BCs, i.e. bcVals[0]*phi+bcVals[1]*d(phi)/dx=bcVals[2].
  // globalIdxs: global linear index of each basis function/node in current cell.
  // tri: triples object (i,j,val), i.e. contribute val to i,j element of the global matrix.

  double rdx2Sq[2];
  rdx2Sq[0] = 4.0/(dx[0]*dx[0]);
  rdx2Sq[1] = 4.0/(dx[1]*dx[1]);

  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[0], (-(0.6666666666666666*epsilon[0]*rdx2Sq[1]*bcVals[6])/bcVals[7])-0.1666666666666667*kSq[3]+0.1924500897298752*kSq[2]+0.3333333333333333*epsilon[0]*rdx2Sq[1]+0.1924500897298752*kSq[1]+0.3333333333333333*epsilon[0]*rdx2Sq[0]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[1], (-(0.3333333333333333*epsilon[0]*rdx2Sq[1]*bcVals[6])/bcVals[7])+0.09622504486493762*kSq[2]+0.1666666666666667*epsilon[0]*rdx2Sq[1]-0.3333333333333333*epsilon[0]*rdx2Sq[0]-0.1111111111111111*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[2], (-0.3333333333333333*epsilon[0]*rdx2Sq[1])+0.09622504486493762*kSq[1]+0.1666666666666667*epsilon[0]*rdx2Sq[0]-0.1111111111111111*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[3], (-0.1666666666666667*epsilon[0]*rdx2Sq[1])-0.1666666666666667*epsilon[0]*rdx2Sq[0]-0.05555555555555555*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[0], (-(0.3333333333333333*epsilon[0]*rdx2Sq[1]*bcVals[6])/bcVals[7])+0.09622504486493762*kSq[2]+0.1666666666666667*epsilon[0]*rdx2Sq[1]-0.3333333333333333*epsilon[0]*rdx2Sq[0]-0.1111111111111111*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[1], (-(0.6666666666666666*epsilon[0]*rdx2Sq[1]*bcVals[6])/bcVals[7])+0.1666666666666667*kSq[3]+0.1924500897298752*kSq[2]+0.3333333333333333*epsilon[0]*rdx2Sq[1]-0.1924500897298752*kSq[1]+0.3333333333333333*epsilon[0]*rdx2Sq[0]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[2], (-0.1666666666666667*epsilon[0]*rdx2Sq[1])-0.1666666666666667*epsilon[0]*rdx2Sq[0]-0.05555555555555555*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[3], (-0.3333333333333333*epsilon[0]*rdx2Sq[1])-0.09622504486493762*kSq[1]+0.1666666666666667*epsilon[0]*rdx2Sq[0]-0.1111111111111111*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[0], (-0.3333333333333333*epsilon[0]*rdx2Sq[1])+0.09622504486493762*kSq[1]+0.1666666666666667*epsilon[0]*rdx2Sq[0]-0.1111111111111111*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[1], (-0.1666666666666667*epsilon[0]*rdx2Sq[1])-0.1666666666666667*epsilon[0]*rdx2Sq[0]-0.05555555555555555*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[2], 0.1666666666666667*kSq[3]-0.1924500897298752*kSq[2]+0.3333333333333333*epsilon[0]*rdx2Sq[1]+0.1924500897298752*kSq[1]+0.3333333333333333*epsilon[0]*rdx2Sq[0]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[3], (-0.09622504486493762*kSq[2])+0.1666666666666667*epsilon[0]*rdx2Sq[1]-0.3333333333333333*epsilon[0]*rdx2Sq[0]-0.1111111111111111*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[0], (-0.1666666666666667*epsilon[0]*rdx2Sq[1])-0.1666666666666667*epsilon[0]*rdx2Sq[0]-0.05555555555555555*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[1], (-0.3333333333333333*epsilon[0]*rdx2Sq[1])-0.09622504486493762*kSq[1]+0.1666666666666667*epsilon[0]*rdx2Sq[0]-0.1111111111111111*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[2], (-0.09622504486493762*kSq[2])+0.1666666666666667*epsilon[0]*rdx2Sq[1]-0.3333333333333333*epsilon[0]*rdx2Sq[0]-0.1111111111111111*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[3], (-0.1666666666666667*kSq[3])-0.1924500897298752*kSq[2]+0.3333333333333333*epsilon[0]*rdx2Sq[1]-0.1924500897298752*kSq[1]+0.3333333333333333*epsilon[0]*rdx2Sq[0]-0.2222222222222222*kSq[0]);

}
void fem_poisson_lhs_stencil_consteps_2x_ser_p2_upx_periodicx_loy_robiny(const double *epsilon, const double *kSq, const double *dx, const double *bcVals, const long *globalIdxs, gkyl_mat_triples *tri) 
{ 
  // epsilon: permittivity.
  // kSq: wave number squared (factor multiplying phi).
  // dx: cell length in each direction.
  // bcVals[3]: values to impose as BCs, i.e. bcVals[0]*phi+bcVals[1]*d(phi)/dx=bcVals[2].
  // globalIdxs: global linear index of each basis function/node in current cell.
  // tri: triples object (i,j,val), i.e. contribute val to i,j element of the global matrix.

  double rdx2Sq[2];
  rdx2Sq[0] = 4.0/(dx[0]*dx[0]);
  rdx2Sq[1] = 4.0/(dx[1]*dx[1]);

  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[0], 0.04549218533640458*kSq[7]-(0.2666666666666667*epsilon[0]*rdx2Sq[1]*bcVals[6])/bcVals[7]+0.04549218533640458*kSq[6]-0.0127775312999988*kSq[5]-0.0127775312999988*kSq[4]-0.04666666666666667*kSq[3]+0.03849001794597505*kSq[2]+0.5777777777777777*epsilon[0]*rdx2Sq[1]+0.03849001794597505*kSq[1]+0.5777777777777777*epsilon[0]*rdx2Sq[0]-0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[1], 0.03442651863295482*kSq[7]-(0.1333333333333333*epsilon[0]*rdx2Sq[1]*bcVals[6])/bcVals[7]+0.0295084445425327*kSq[6]-0.05962847939999439*kSq[5]-0.063887656499994*kSq[4]-0.05333333333333333*kSq[3]+0.06666666666666667*epsilon[0]*rdx2Sq[1]+0.03849001794597505*kSq[1]-0.8888888888888888*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[2], (0.06666666666666667*epsilon[0]*rdx2Sq[1]*bcVals[6])/bcVals[7]-0.006147592613027645*kSq[6]+0.03336355394999686*kSq[5]+0.02697478829999747*kSq[4]-0.01924500897298752*kSq[2]+0.1888888888888889*epsilon[0]*rdx2Sq[1]+0.3111111111111111*epsilon[0]*rdx2Sq[0]-0.02222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[3], 0.0295084445425327*kSq[7]+0.03442651863295482*kSq[6]-0.063887656499994*kSq[5]-0.05962847939999439*kSq[4]-0.05333333333333333*kSq[3]+0.03849001794597505*kSq[2]-0.8888888888888888*epsilon[0]*rdx2Sq[1]+0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[4], (-0.01721325931647741*kSq[7])-0.05678902799999467*kSq[5]-0.03975231959999626*kSq[4]-0.01333333333333333*kSq[3]-0.4444444444444444*epsilon[0]*rdx2Sq[1]+0.03849001794597505*kSq[1]-0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[5], (-0.006147592613027645*kSq[7])+0.02697478829999747*kSq[5]+0.03336355394999686*kSq[4]+0.3111111111111111*epsilon[0]*rdx2Sq[1]-0.01924500897298752*kSq[1]+0.1888888888888889*epsilon[0]*rdx2Sq[0]-0.02222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[6], (-0.01721325931647741*kSq[6])-0.03975231959999626*kSq[5]-0.05678902799999467*kSq[4]-0.01333333333333333*kSq[3]+0.03849001794597505*kSq[2]-0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.4444444444444444*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[7], 0.0234254740499978*kSq[5]+0.0234254740499978*kSq[4]+0.01333333333333333*kSq[3]+0.2555555555555555*epsilon[0]*rdx2Sq[1]+0.2555555555555555*epsilon[0]*rdx2Sq[0]-0.03333333333333333*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[0], 0.03442651863295482*kSq[7]-(0.1333333333333333*epsilon[0]*rdx2Sq[1]*bcVals[6])/bcVals[7]+0.0295084445425327*kSq[6]-0.05962847939999439*kSq[5]-0.063887656499994*kSq[4]-0.05333333333333333*kSq[3]+0.06666666666666667*epsilon[0]*rdx2Sq[1]+0.03849001794597505*kSq[1]-0.8888888888888888*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[1], (-(1.066666666666667*epsilon[0]*rdx2Sq[1]*bcVals[6])/bcVals[7])-0.1967229636168847*kSq[6]-0.07950463919999252*kSq[5]+0.2271561119999787*kSq[4]+0.3079201435678004*kSq[2]+0.5333333333333333*epsilon[0]*rdx2Sq[1]+1.777777777777778*epsilon[0]*rdx2Sq[0]-0.3555555555555556*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[2], (-0.03442651863295482*kSq[7])-(0.1333333333333333*epsilon[0]*rdx2Sq[1]*bcVals[6])/bcVals[7]+0.0295084445425327*kSq[6]-0.05962847939999439*kSq[5]-0.063887656499994*kSq[4]+0.05333333333333333*kSq[3]+0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.03849001794597505*kSq[1]-0.8888888888888888*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[3], (-0.03442651863295482*kSq[7])-0.03442651863295482*kSq[6]+0.09938079899999068*kSq[5]+0.09938079899999068*kSq[4]-0.02666666666666666*kSq[3]+0.0769800358919501*kSq[2]+0.0769800358919501*kSq[1]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[4], 0.03442651863295482*kSq[7]-0.03442651863295482*kSq[6]+0.09938079899999068*kSq[5]+0.09938079899999068*kSq[4]+0.02666666666666666*kSq[3]+0.0769800358919501*kSq[2]-0.0769800358919501*kSq[1]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[5], 0.01721325931647741*kSq[6]-0.03975231959999626*kSq[5]-0.05678902799999467*kSq[4]+0.01333333333333333*kSq[3]-0.03849001794597505*kSq[2]-0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.4444444444444444*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[6], 0.07950463919999252*kSq[5]+0.1135780559999893*kSq[4]-0.5333333333333333*epsilon[0]*rdx2Sq[1]+0.8888888888888888*epsilon[0]*rdx2Sq[0]-0.1777777777777778*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[7], 0.01721325931647741*kSq[6]-0.03975231959999626*kSq[5]-0.05678902799999467*kSq[4]-0.01333333333333333*kSq[3]-0.03849001794597505*kSq[2]-0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.4444444444444444*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[0], (0.06666666666666667*epsilon[0]*rdx2Sq[1]*bcVals[6])/bcVals[7]-0.006147592613027645*kSq[6]+0.03336355394999686*kSq[5]+0.02697478829999747*kSq[4]-0.01924500897298752*kSq[2]+0.1888888888888889*epsilon[0]*rdx2Sq[1]+0.3111111111111111*epsilon[0]*rdx2Sq[0]-0.02222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[1], (-0.03442651863295482*kSq[7])-(0.1333333333333333*epsilon[0]*rdx2Sq[1]*bcVals[6])/bcVals[7]+0.0295084445425327*kSq[6]-0.05962847939999439*kSq[5]-0.063887656499994*kSq[4]+0.05333333333333333*kSq[3]+0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.03849001794597505*kSq[1]-0.8888888888888888*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[2], (-0.04549218533640458*kSq[7])-(0.2666666666666667*epsilon[0]*rdx2Sq[1]*bcVals[6])/bcVals[7]+0.04549218533640458*kSq[6]-0.0127775312999988*kSq[5]-0.0127775312999988*kSq[4]+0.04666666666666667*kSq[3]+0.03849001794597505*kSq[2]+0.5777777777777777*epsilon[0]*rdx2Sq[1]-0.03849001794597505*kSq[1]+0.5777777777777777*epsilon[0]*rdx2Sq[0]-0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[3], 0.01721325931647741*kSq[7]-0.05678902799999467*kSq[5]-0.03975231959999626*kSq[4]+0.01333333333333333*kSq[3]-0.4444444444444444*epsilon[0]*rdx2Sq[1]-0.03849001794597505*kSq[1]-0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[4], (-0.0295084445425327*kSq[7])+0.03442651863295482*kSq[6]-0.063887656499994*kSq[5]-0.05962847939999439*kSq[4]+0.05333333333333333*kSq[3]+0.03849001794597505*kSq[2]-0.8888888888888888*epsilon[0]*rdx2Sq[1]+0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[5], 0.0234254740499978*kSq[5]+0.0234254740499978*kSq[4]-0.01333333333333333*kSq[3]+0.2555555555555555*epsilon[0]*rdx2Sq[1]+0.2555555555555555*epsilon[0]*rdx2Sq[0]-0.03333333333333333*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[6], (-0.01721325931647741*kSq[6])-0.03975231959999626*kSq[5]-0.05678902799999467*kSq[4]+0.01333333333333333*kSq[3]+0.03849001794597505*kSq[2]-0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.4444444444444444*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[7], 0.006147592613027645*kSq[7]+0.02697478829999747*kSq[5]+0.03336355394999686*kSq[4]+0.3111111111111111*epsilon[0]*rdx2Sq[1]+0.01924500897298752*kSq[1]+0.1888888888888889*epsilon[0]*rdx2Sq[0]-0.02222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[0], 0.0295084445425327*kSq[7]+0.03442651863295482*kSq[6]-0.063887656499994*kSq[5]-0.05962847939999439*kSq[4]-0.05333333333333333*kSq[3]+0.03849001794597505*kSq[2]-0.8888888888888888*epsilon[0]*rdx2Sq[1]+0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[1], (-0.03442651863295482*kSq[7])-0.03442651863295482*kSq[6]+0.09938079899999068*kSq[5]+0.09938079899999068*kSq[4]-0.02666666666666666*kSq[3]+0.0769800358919501*kSq[2]+0.0769800358919501*kSq[1]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[2], 0.01721325931647741*kSq[7]-0.05678902799999467*kSq[5]-0.03975231959999626*kSq[4]+0.01333333333333333*kSq[3]-0.4444444444444444*epsilon[0]*rdx2Sq[1]-0.03849001794597505*kSq[1]-0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[3], (-0.1967229636168847*kSq[7])+0.2271561119999787*kSq[5]-0.07950463919999252*kSq[4]+1.777777777777778*epsilon[0]*rdx2Sq[1]+0.3079201435678004*kSq[1]+0.5333333333333333*epsilon[0]*rdx2Sq[0]-0.3555555555555556*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[4], 0.1135780559999893*kSq[5]+0.07950463919999252*kSq[4]+0.8888888888888888*epsilon[0]*rdx2Sq[1]-0.5333333333333333*epsilon[0]*rdx2Sq[0]-0.1777777777777778*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[5], 0.0295084445425327*kSq[7]-0.03442651863295482*kSq[6]-0.063887656499994*kSq[5]-0.05962847939999439*kSq[4]+0.05333333333333333*kSq[3]-0.03849001794597505*kSq[2]-0.8888888888888888*epsilon[0]*rdx2Sq[1]+0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[6], (-0.03442651863295482*kSq[7])+0.03442651863295482*kSq[6]+0.09938079899999068*kSq[5]+0.09938079899999068*kSq[4]+0.02666666666666666*kSq[3]-0.0769800358919501*kSq[2]+0.0769800358919501*kSq[1]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[7], 0.01721325931647741*kSq[7]-0.05678902799999467*kSq[5]-0.03975231959999626*kSq[4]-0.01333333333333333*kSq[3]-0.4444444444444444*epsilon[0]*rdx2Sq[1]-0.03849001794597505*kSq[1]-0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[4], globalIdxs[0], (-0.01721325931647741*kSq[7])-0.05678902799999467*kSq[5]-0.03975231959999626*kSq[4]-0.01333333333333333*kSq[3]-0.4444444444444444*epsilon[0]*rdx2Sq[1]+0.03849001794597505*kSq[1]-0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[4], globalIdxs[1], 0.03442651863295482*kSq[7]-0.03442651863295482*kSq[6]+0.09938079899999068*kSq[5]+0.09938079899999068*kSq[4]+0.02666666666666666*kSq[3]+0.0769800358919501*kSq[2]-0.0769800358919501*kSq[1]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[4], globalIdxs[2], (-0.0295084445425327*kSq[7])+0.03442651863295482*kSq[6]-0.063887656499994*kSq[5]-0.05962847939999439*kSq[4]+0.05333333333333333*kSq[3]+0.03849001794597505*kSq[2]-0.8888888888888888*epsilon[0]*rdx2Sq[1]+0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[4], globalIdxs[3], 0.1135780559999893*kSq[5]+0.07950463919999252*kSq[4]+0.8888888888888888*epsilon[0]*rdx2Sq[1]-0.5333333333333333*epsilon[0]*rdx2Sq[0]-0.1777777777777778*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[4], globalIdxs[4], 0.1967229636168847*kSq[7]+0.2271561119999787*kSq[5]-0.07950463919999252*kSq[4]+1.777777777777778*epsilon[0]*rdx2Sq[1]-0.3079201435678004*kSq[1]+0.5333333333333333*epsilon[0]*rdx2Sq[0]-0.3555555555555556*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[4], globalIdxs[5], (-0.01721325931647741*kSq[7])-0.05678902799999467*kSq[5]-0.03975231959999626*kSq[4]+0.01333333333333333*kSq[3]-0.4444444444444444*epsilon[0]*rdx2Sq[1]+0.03849001794597505*kSq[1]-0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[4], globalIdxs[6], 0.03442651863295482*kSq[7]+0.03442651863295482*kSq[6]+0.09938079899999068*kSq[5]+0.09938079899999068*kSq[4]-0.02666666666666666*kSq[3]-0.0769800358919501*kSq[2]-0.0769800358919501*kSq[1]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[4], globalIdxs[7], (-0.0295084445425327*kSq[7])-0.03442651863295482*kSq[6]-0.063887656499994*kSq[5]-0.05962847939999439*kSq[4]-0.05333333333333333*kSq[3]-0.03849001794597505*kSq[2]-0.8888888888888888*epsilon[0]*rdx2Sq[1]+0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[5], globalIdxs[0], (-0.006147592613027645*kSq[7])+0.02697478829999747*kSq[5]+0.03336355394999686*kSq[4]+0.3111111111111111*epsilon[0]*rdx2Sq[1]-0.01924500897298752*kSq[1]+0.1888888888888889*epsilon[0]*rdx2Sq[0]-0.02222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[5], globalIdxs[1], 0.01721325931647741*kSq[6]-0.03975231959999626*kSq[5]-0.05678902799999467*kSq[4]+0.01333333333333333*kSq[3]-0.03849001794597505*kSq[2]-0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.4444444444444444*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[5], globalIdxs[2], 0.0234254740499978*kSq[5]+0.0234254740499978*kSq[4]-0.01333333333333333*kSq[3]+0.2555555555555555*epsilon[0]*rdx2Sq[1]+0.2555555555555555*epsilon[0]*rdx2Sq[0]-0.03333333333333333*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[5], globalIdxs[3], 0.0295084445425327*kSq[7]-0.03442651863295482*kSq[6]-0.063887656499994*kSq[5]-0.05962847939999439*kSq[4]+0.05333333333333333*kSq[3]-0.03849001794597505*kSq[2]-0.8888888888888888*epsilon[0]*rdx2Sq[1]+0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[5], globalIdxs[4], (-0.01721325931647741*kSq[7])-0.05678902799999467*kSq[5]-0.03975231959999626*kSq[4]+0.01333333333333333*kSq[3]-0.4444444444444444*epsilon[0]*rdx2Sq[1]+0.03849001794597505*kSq[1]-0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[5], globalIdxs[5], 0.04549218533640458*kSq[7]-0.04549218533640458*kSq[6]-0.0127775312999988*kSq[5]-0.0127775312999988*kSq[4]+0.04666666666666667*kSq[3]-0.03849001794597505*kSq[2]+0.5777777777777777*epsilon[0]*rdx2Sq[1]+0.03849001794597505*kSq[1]+0.5777777777777777*epsilon[0]*rdx2Sq[0]-0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[5], globalIdxs[6], 0.03442651863295482*kSq[7]-0.0295084445425327*kSq[6]-0.05962847939999439*kSq[5]-0.063887656499994*kSq[4]+0.05333333333333333*kSq[3]+0.06666666666666667*epsilon[0]*rdx2Sq[1]+0.03849001794597505*kSq[1]-0.8888888888888888*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[5], globalIdxs[7], 0.006147592613027645*kSq[6]+0.03336355394999686*kSq[5]+0.02697478829999747*kSq[4]+0.01924500897298752*kSq[2]+0.1888888888888889*epsilon[0]*rdx2Sq[1]+0.3111111111111111*epsilon[0]*rdx2Sq[0]-0.02222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[6], globalIdxs[0], (-0.01721325931647741*kSq[6])-0.03975231959999626*kSq[5]-0.05678902799999467*kSq[4]-0.01333333333333333*kSq[3]+0.03849001794597505*kSq[2]-0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.4444444444444444*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[6], globalIdxs[1], 0.07950463919999252*kSq[5]+0.1135780559999893*kSq[4]-0.5333333333333333*epsilon[0]*rdx2Sq[1]+0.8888888888888888*epsilon[0]*rdx2Sq[0]-0.1777777777777778*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[6], globalIdxs[2], (-0.01721325931647741*kSq[6])-0.03975231959999626*kSq[5]-0.05678902799999467*kSq[4]+0.01333333333333333*kSq[3]+0.03849001794597505*kSq[2]-0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.4444444444444444*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[6], globalIdxs[3], (-0.03442651863295482*kSq[7])+0.03442651863295482*kSq[6]+0.09938079899999068*kSq[5]+0.09938079899999068*kSq[4]+0.02666666666666666*kSq[3]-0.0769800358919501*kSq[2]+0.0769800358919501*kSq[1]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[6], globalIdxs[4], 0.03442651863295482*kSq[7]+0.03442651863295482*kSq[6]+0.09938079899999068*kSq[5]+0.09938079899999068*kSq[4]-0.02666666666666666*kSq[3]-0.0769800358919501*kSq[2]-0.0769800358919501*kSq[1]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[6], globalIdxs[5], 0.03442651863295482*kSq[7]-0.0295084445425327*kSq[6]-0.05962847939999439*kSq[5]-0.063887656499994*kSq[4]+0.05333333333333333*kSq[3]+0.06666666666666667*epsilon[0]*rdx2Sq[1]+0.03849001794597505*kSq[1]-0.8888888888888888*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[6], globalIdxs[6], 0.1967229636168847*kSq[6]-0.07950463919999252*kSq[5]+0.2271561119999787*kSq[4]-0.3079201435678004*kSq[2]+0.5333333333333333*epsilon[0]*rdx2Sq[1]+1.777777777777778*epsilon[0]*rdx2Sq[0]-0.3555555555555556*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[6], globalIdxs[7], (-0.03442651863295482*kSq[7])-0.0295084445425327*kSq[6]-0.05962847939999439*kSq[5]-0.063887656499994*kSq[4]-0.05333333333333333*kSq[3]+0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.03849001794597505*kSq[1]-0.8888888888888888*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[7], globalIdxs[0], 0.0234254740499978*kSq[5]+0.0234254740499978*kSq[4]+0.01333333333333333*kSq[3]+0.2555555555555555*epsilon[0]*rdx2Sq[1]+0.2555555555555555*epsilon[0]*rdx2Sq[0]-0.03333333333333333*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[7], globalIdxs[1], 0.01721325931647741*kSq[6]-0.03975231959999626*kSq[5]-0.05678902799999467*kSq[4]-0.01333333333333333*kSq[3]-0.03849001794597505*kSq[2]-0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.4444444444444444*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[7], globalIdxs[2], 0.006147592613027645*kSq[7]+0.02697478829999747*kSq[5]+0.03336355394999686*kSq[4]+0.3111111111111111*epsilon[0]*rdx2Sq[1]+0.01924500897298752*kSq[1]+0.1888888888888889*epsilon[0]*rdx2Sq[0]-0.02222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[7], globalIdxs[3], 0.01721325931647741*kSq[7]-0.05678902799999467*kSq[5]-0.03975231959999626*kSq[4]-0.01333333333333333*kSq[3]-0.4444444444444444*epsilon[0]*rdx2Sq[1]-0.03849001794597505*kSq[1]-0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[7], globalIdxs[4], (-0.0295084445425327*kSq[7])-0.03442651863295482*kSq[6]-0.063887656499994*kSq[5]-0.05962847939999439*kSq[4]-0.05333333333333333*kSq[3]-0.03849001794597505*kSq[2]-0.8888888888888888*epsilon[0]*rdx2Sq[1]+0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[7], globalIdxs[5], 0.006147592613027645*kSq[6]+0.03336355394999686*kSq[5]+0.02697478829999747*kSq[4]+0.01924500897298752*kSq[2]+0.1888888888888889*epsilon[0]*rdx2Sq[1]+0.3111111111111111*epsilon[0]*rdx2Sq[0]-0.02222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[7], globalIdxs[6], (-0.03442651863295482*kSq[7])-0.0295084445425327*kSq[6]-0.05962847939999439*kSq[5]-0.063887656499994*kSq[4]-0.05333333333333333*kSq[3]+0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.03849001794597505*kSq[1]-0.8888888888888888*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[7], globalIdxs[7], (-0.04549218533640458*kSq[7])-0.04549218533640458*kSq[6]-0.0127775312999988*kSq[5]-0.0127775312999988*kSq[4]-0.04666666666666667*kSq[3]-0.03849001794597505*kSq[2]+0.5777777777777777*epsilon[0]*rdx2Sq[1]-0.03849001794597505*kSq[1]+0.5777777777777777*epsilon[0]*rdx2Sq[0]-0.06666666666666667*kSq[0]);

}
void fem_poisson_lhs_stencil_consteps_2x_ser_p1_upx_dirichletx_loy_periodicy(const double *epsilon, const double *kSq, const double *dx, const double *bcVals, const long *globalIdxs, gkyl_mat_triples *tri) 
{ 
  // epsilon: permittivity.
  // kSq: wave number squared (factor multiplying phi).
  // dx: cell length in each direction.
  // bcVals[3]: values to impose as BCs, i.e. bcVals[0]*phi+bcVals[1]*d(phi)/dx=bcVals[2].
  // globalIdxs: global linear index of each basis function/node in current cell.
  // tri: triples object (i,j,val), i.e. contribute val to i,j element of the global matrix.

  double rdx2Sq[2];
  rdx2Sq[0] = 4.0/(dx[0]*dx[0]);
  rdx2Sq[1] = 4.0/(dx[1]*dx[1]);

  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[0], (-0.1666666666666667*kSq[3])+0.1924500897298752*kSq[2]+0.3333333333333333*epsilon[0]*rdx2Sq[1]+0.1924500897298752*kSq[1]+0.3333333333333333*epsilon[0]*rdx2Sq[0]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[1], 0.09622504486493762*kSq[2]+0.1666666666666667*epsilon[0]*rdx2Sq[1]-0.3333333333333333*epsilon[0]*rdx2Sq[0]-0.1111111111111111*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[2], (-0.3333333333333333*epsilon[0]*rdx2Sq[1])+0.09622504486493762*kSq[1]+0.1666666666666667*epsilon[0]*rdx2Sq[0]-0.1111111111111111*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[3], (-0.1666666666666667*epsilon[0]*rdx2Sq[1])-0.1666666666666667*epsilon[0]*rdx2Sq[0]-0.05555555555555555*kSq[0]);
  gkyl_mat_triples_insert(tri, globalIdxs[1], globalIdxs[0], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[1], globalIdxs[1], 1.0);
  gkyl_mat_triples_insert(tri, globalIdxs[1], globalIdxs[2], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[1], globalIdxs[3], 0.0);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[0], (-0.3333333333333333*epsilon[0]*rdx2Sq[1])+0.09622504486493762*kSq[1]+0.1666666666666667*epsilon[0]*rdx2Sq[0]-0.1111111111111111*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[1], (-0.1666666666666667*epsilon[0]*rdx2Sq[1])-0.1666666666666667*epsilon[0]*rdx2Sq[0]-0.05555555555555555*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[2], 0.1666666666666667*kSq[3]-0.1924500897298752*kSq[2]+0.3333333333333333*epsilon[0]*rdx2Sq[1]+0.1924500897298752*kSq[1]+0.3333333333333333*epsilon[0]*rdx2Sq[0]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[3], (-0.09622504486493762*kSq[2])+0.1666666666666667*epsilon[0]*rdx2Sq[1]-0.3333333333333333*epsilon[0]*rdx2Sq[0]-0.1111111111111111*kSq[0]);
  gkyl_mat_triples_insert(tri, globalIdxs[3], globalIdxs[0], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[3], globalIdxs[1], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[3], globalIdxs[2], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[3], globalIdxs[3], 1.0);

}
void fem_poisson_lhs_stencil_consteps_2x_ser_p2_upx_dirichletx_loy_periodicy(const double *epsilon, const double *kSq, const double *dx, const double *bcVals, const long *globalIdxs, gkyl_mat_triples *tri) 
{ 
  // epsilon: permittivity.
  // kSq: wave number squared (factor multiplying phi).
  // dx: cell length in each direction.
  // bcVals[3]: values to impose as BCs, i.e. bcVals[0]*phi+bcVals[1]*d(phi)/dx=bcVals[2].
  // globalIdxs: global linear index of each basis function/node in current cell.
  // tri: triples object (i,j,val), i.e. contribute val to i,j element of the global matrix.

  double rdx2Sq[2];
  rdx2Sq[0] = 4.0/(dx[0]*dx[0]);
  rdx2Sq[1] = 4.0/(dx[1]*dx[1]);

  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[0], 0.04549218533640458*kSq[7]+0.04549218533640458*kSq[6]-0.0127775312999988*kSq[5]-0.0127775312999988*kSq[4]-0.04666666666666667*kSq[3]+0.03849001794597505*kSq[2]+0.5777777777777777*epsilon[0]*rdx2Sq[1]+0.03849001794597505*kSq[1]+0.5777777777777777*epsilon[0]*rdx2Sq[0]-0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[1], 0.03442651863295482*kSq[7]+0.0295084445425327*kSq[6]-0.05962847939999439*kSq[5]-0.063887656499994*kSq[4]-0.05333333333333333*kSq[3]+0.06666666666666667*epsilon[0]*rdx2Sq[1]+0.03849001794597505*kSq[1]-0.8888888888888888*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[2], (-0.006147592613027645*kSq[6])+0.03336355394999686*kSq[5]+0.02697478829999747*kSq[4]-0.01924500897298752*kSq[2]+0.1888888888888889*epsilon[0]*rdx2Sq[1]+0.3111111111111111*epsilon[0]*rdx2Sq[0]-0.02222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[3], 0.0295084445425327*kSq[7]+0.03442651863295482*kSq[6]-0.063887656499994*kSq[5]-0.05962847939999439*kSq[4]-0.05333333333333333*kSq[3]+0.03849001794597505*kSq[2]-0.8888888888888888*epsilon[0]*rdx2Sq[1]+0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[4], (-0.01721325931647741*kSq[7])-0.05678902799999467*kSq[5]-0.03975231959999626*kSq[4]-0.01333333333333333*kSq[3]-0.4444444444444444*epsilon[0]*rdx2Sq[1]+0.03849001794597505*kSq[1]-0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[5], (-0.006147592613027645*kSq[7])+0.02697478829999747*kSq[5]+0.03336355394999686*kSq[4]+0.3111111111111111*epsilon[0]*rdx2Sq[1]-0.01924500897298752*kSq[1]+0.1888888888888889*epsilon[0]*rdx2Sq[0]-0.02222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[6], (-0.01721325931647741*kSq[6])-0.03975231959999626*kSq[5]-0.05678902799999467*kSq[4]-0.01333333333333333*kSq[3]+0.03849001794597505*kSq[2]-0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.4444444444444444*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[7], 0.0234254740499978*kSq[5]+0.0234254740499978*kSq[4]+0.01333333333333333*kSq[3]+0.2555555555555555*epsilon[0]*rdx2Sq[1]+0.2555555555555555*epsilon[0]*rdx2Sq[0]-0.03333333333333333*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[0], 0.03442651863295482*kSq[7]+0.0295084445425327*kSq[6]-0.05962847939999439*kSq[5]-0.063887656499994*kSq[4]-0.05333333333333333*kSq[3]+0.06666666666666667*epsilon[0]*rdx2Sq[1]+0.03849001794597505*kSq[1]-0.8888888888888888*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[1], (-0.1967229636168847*kSq[6])-0.07950463919999252*kSq[5]+0.2271561119999787*kSq[4]+0.3079201435678004*kSq[2]+0.5333333333333333*epsilon[0]*rdx2Sq[1]+1.777777777777778*epsilon[0]*rdx2Sq[0]-0.3555555555555556*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[2], (-0.03442651863295482*kSq[7])+0.0295084445425327*kSq[6]-0.05962847939999439*kSq[5]-0.063887656499994*kSq[4]+0.05333333333333333*kSq[3]+0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.03849001794597505*kSq[1]-0.8888888888888888*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[3], (-0.03442651863295482*kSq[7])-0.03442651863295482*kSq[6]+0.09938079899999068*kSq[5]+0.09938079899999068*kSq[4]-0.02666666666666666*kSq[3]+0.0769800358919501*kSq[2]+0.0769800358919501*kSq[1]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[4], 0.03442651863295482*kSq[7]-0.03442651863295482*kSq[6]+0.09938079899999068*kSq[5]+0.09938079899999068*kSq[4]+0.02666666666666666*kSq[3]+0.0769800358919501*kSq[2]-0.0769800358919501*kSq[1]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[5], 0.01721325931647741*kSq[6]-0.03975231959999626*kSq[5]-0.05678902799999467*kSq[4]+0.01333333333333333*kSq[3]-0.03849001794597505*kSq[2]-0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.4444444444444444*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[6], 0.07950463919999252*kSq[5]+0.1135780559999893*kSq[4]-0.5333333333333333*epsilon[0]*rdx2Sq[1]+0.8888888888888888*epsilon[0]*rdx2Sq[0]-0.1777777777777778*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[7], 0.01721325931647741*kSq[6]-0.03975231959999626*kSq[5]-0.05678902799999467*kSq[4]-0.01333333333333333*kSq[3]-0.03849001794597505*kSq[2]-0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.4444444444444444*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_insert(tri, globalIdxs[2], globalIdxs[0], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[2], globalIdxs[1], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[2], globalIdxs[2], 1.0);
  gkyl_mat_triples_insert(tri, globalIdxs[2], globalIdxs[3], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[2], globalIdxs[4], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[2], globalIdxs[5], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[2], globalIdxs[6], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[2], globalIdxs[7], 0.0);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[0], 0.0295084445425327*kSq[7]+0.03442651863295482*kSq[6]-0.063887656499994*kSq[5]-0.05962847939999439*kSq[4]-0.05333333333333333*kSq[3]+0.03849001794597505*kSq[2]-0.8888888888888888*epsilon[0]*rdx2Sq[1]+0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[1], (-0.03442651863295482*kSq[7])-0.03442651863295482*kSq[6]+0.09938079899999068*kSq[5]+0.09938079899999068*kSq[4]-0.02666666666666666*kSq[3]+0.0769800358919501*kSq[2]+0.0769800358919501*kSq[1]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[2], 0.01721325931647741*kSq[7]-0.05678902799999467*kSq[5]-0.03975231959999626*kSq[4]+0.01333333333333333*kSq[3]-0.4444444444444444*epsilon[0]*rdx2Sq[1]-0.03849001794597505*kSq[1]-0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[3], (-0.1967229636168847*kSq[7])+0.2271561119999787*kSq[5]-0.07950463919999252*kSq[4]+1.777777777777778*epsilon[0]*rdx2Sq[1]+0.3079201435678004*kSq[1]+0.5333333333333333*epsilon[0]*rdx2Sq[0]-0.3555555555555556*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[4], 0.1135780559999893*kSq[5]+0.07950463919999252*kSq[4]+0.8888888888888888*epsilon[0]*rdx2Sq[1]-0.5333333333333333*epsilon[0]*rdx2Sq[0]-0.1777777777777778*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[5], 0.0295084445425327*kSq[7]-0.03442651863295482*kSq[6]-0.063887656499994*kSq[5]-0.05962847939999439*kSq[4]+0.05333333333333333*kSq[3]-0.03849001794597505*kSq[2]-0.8888888888888888*epsilon[0]*rdx2Sq[1]+0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[6], (-0.03442651863295482*kSq[7])+0.03442651863295482*kSq[6]+0.09938079899999068*kSq[5]+0.09938079899999068*kSq[4]+0.02666666666666666*kSq[3]-0.0769800358919501*kSq[2]+0.0769800358919501*kSq[1]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[7], 0.01721325931647741*kSq[7]-0.05678902799999467*kSq[5]-0.03975231959999626*kSq[4]-0.01333333333333333*kSq[3]-0.4444444444444444*epsilon[0]*rdx2Sq[1]-0.03849001794597505*kSq[1]-0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_insert(tri, globalIdxs[4], globalIdxs[0], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[4], globalIdxs[1], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[4], globalIdxs[2], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[4], globalIdxs[3], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[4], globalIdxs[4], 1.0);
  gkyl_mat_triples_insert(tri, globalIdxs[4], globalIdxs[5], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[4], globalIdxs[6], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[4], globalIdxs[7], 0.0);
  gkyl_mat_triples_accum(tri, globalIdxs[5], globalIdxs[0], (-0.006147592613027645*kSq[7])+0.02697478829999747*kSq[5]+0.03336355394999686*kSq[4]+0.3111111111111111*epsilon[0]*rdx2Sq[1]-0.01924500897298752*kSq[1]+0.1888888888888889*epsilon[0]*rdx2Sq[0]-0.02222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[5], globalIdxs[1], 0.01721325931647741*kSq[6]-0.03975231959999626*kSq[5]-0.05678902799999467*kSq[4]+0.01333333333333333*kSq[3]-0.03849001794597505*kSq[2]-0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.4444444444444444*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[5], globalIdxs[2], 0.0234254740499978*kSq[5]+0.0234254740499978*kSq[4]-0.01333333333333333*kSq[3]+0.2555555555555555*epsilon[0]*rdx2Sq[1]+0.2555555555555555*epsilon[0]*rdx2Sq[0]-0.03333333333333333*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[5], globalIdxs[3], 0.0295084445425327*kSq[7]-0.03442651863295482*kSq[6]-0.063887656499994*kSq[5]-0.05962847939999439*kSq[4]+0.05333333333333333*kSq[3]-0.03849001794597505*kSq[2]-0.8888888888888888*epsilon[0]*rdx2Sq[1]+0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[5], globalIdxs[4], (-0.01721325931647741*kSq[7])-0.05678902799999467*kSq[5]-0.03975231959999626*kSq[4]+0.01333333333333333*kSq[3]-0.4444444444444444*epsilon[0]*rdx2Sq[1]+0.03849001794597505*kSq[1]-0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[5], globalIdxs[5], 0.04549218533640458*kSq[7]-0.04549218533640458*kSq[6]-0.0127775312999988*kSq[5]-0.0127775312999988*kSq[4]+0.04666666666666667*kSq[3]-0.03849001794597505*kSq[2]+0.5777777777777777*epsilon[0]*rdx2Sq[1]+0.03849001794597505*kSq[1]+0.5777777777777777*epsilon[0]*rdx2Sq[0]-0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[5], globalIdxs[6], 0.03442651863295482*kSq[7]-0.0295084445425327*kSq[6]-0.05962847939999439*kSq[5]-0.063887656499994*kSq[4]+0.05333333333333333*kSq[3]+0.06666666666666667*epsilon[0]*rdx2Sq[1]+0.03849001794597505*kSq[1]-0.8888888888888888*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[5], globalIdxs[7], 0.006147592613027645*kSq[6]+0.03336355394999686*kSq[5]+0.02697478829999747*kSq[4]+0.01924500897298752*kSq[2]+0.1888888888888889*epsilon[0]*rdx2Sq[1]+0.3111111111111111*epsilon[0]*rdx2Sq[0]-0.02222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[6], globalIdxs[0], (-0.01721325931647741*kSq[6])-0.03975231959999626*kSq[5]-0.05678902799999467*kSq[4]-0.01333333333333333*kSq[3]+0.03849001794597505*kSq[2]-0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.4444444444444444*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[6], globalIdxs[1], 0.07950463919999252*kSq[5]+0.1135780559999893*kSq[4]-0.5333333333333333*epsilon[0]*rdx2Sq[1]+0.8888888888888888*epsilon[0]*rdx2Sq[0]-0.1777777777777778*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[6], globalIdxs[2], (-0.01721325931647741*kSq[6])-0.03975231959999626*kSq[5]-0.05678902799999467*kSq[4]+0.01333333333333333*kSq[3]+0.03849001794597505*kSq[2]-0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.4444444444444444*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[6], globalIdxs[3], (-0.03442651863295482*kSq[7])+0.03442651863295482*kSq[6]+0.09938079899999068*kSq[5]+0.09938079899999068*kSq[4]+0.02666666666666666*kSq[3]-0.0769800358919501*kSq[2]+0.0769800358919501*kSq[1]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[6], globalIdxs[4], 0.03442651863295482*kSq[7]+0.03442651863295482*kSq[6]+0.09938079899999068*kSq[5]+0.09938079899999068*kSq[4]-0.02666666666666666*kSq[3]-0.0769800358919501*kSq[2]-0.0769800358919501*kSq[1]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[6], globalIdxs[5], 0.03442651863295482*kSq[7]-0.0295084445425327*kSq[6]-0.05962847939999439*kSq[5]-0.063887656499994*kSq[4]+0.05333333333333333*kSq[3]+0.06666666666666667*epsilon[0]*rdx2Sq[1]+0.03849001794597505*kSq[1]-0.8888888888888888*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[6], globalIdxs[6], 0.1967229636168847*kSq[6]-0.07950463919999252*kSq[5]+0.2271561119999787*kSq[4]-0.3079201435678004*kSq[2]+0.5333333333333333*epsilon[0]*rdx2Sq[1]+1.777777777777778*epsilon[0]*rdx2Sq[0]-0.3555555555555556*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[6], globalIdxs[7], (-0.03442651863295482*kSq[7])-0.0295084445425327*kSq[6]-0.05962847939999439*kSq[5]-0.063887656499994*kSq[4]-0.05333333333333333*kSq[3]+0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.03849001794597505*kSq[1]-0.8888888888888888*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_insert(tri, globalIdxs[7], globalIdxs[0], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[7], globalIdxs[1], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[7], globalIdxs[2], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[7], globalIdxs[3], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[7], globalIdxs[4], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[7], globalIdxs[5], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[7], globalIdxs[6], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[7], globalIdxs[7], 1.0);

}
void fem_poisson_lhs_stencil_consteps_2x_ser_p1_upx_dirichletx_loy_dirichlety(const double *epsilon, const double *kSq, const double *dx, const double *bcVals, const long *globalIdxs, gkyl_mat_triples *tri) 
{ 
  // epsilon: permittivity.
  // kSq: wave number squared (factor multiplying phi).
  // dx: cell length in each direction.
  // bcVals[3]: values to impose as BCs, i.e. bcVals[0]*phi+bcVals[1]*d(phi)/dx=bcVals[2].
  // globalIdxs: global linear index of each basis function/node in current cell.
  // tri: triples object (i,j,val), i.e. contribute val to i,j element of the global matrix.

  double rdx2Sq[2];
  rdx2Sq[0] = 4.0/(dx[0]*dx[0]);
  rdx2Sq[1] = 4.0/(dx[1]*dx[1]);

  gkyl_mat_triples_insert(tri, globalIdxs[0], globalIdxs[0], 1.0);
  gkyl_mat_triples_insert(tri, globalIdxs[0], globalIdxs[1], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[0], globalIdxs[2], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[0], globalIdxs[3], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[1], globalIdxs[0], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[1], globalIdxs[1], 1.0);
  gkyl_mat_triples_insert(tri, globalIdxs[1], globalIdxs[2], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[1], globalIdxs[3], 0.0);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[0], (-0.3333333333333333*epsilon[0]*rdx2Sq[1])+0.09622504486493762*kSq[1]+0.1666666666666667*epsilon[0]*rdx2Sq[0]-0.1111111111111111*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[1], (-0.1666666666666667*epsilon[0]*rdx2Sq[1])-0.1666666666666667*epsilon[0]*rdx2Sq[0]-0.05555555555555555*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[2], 0.1666666666666667*kSq[3]-0.1924500897298752*kSq[2]+0.3333333333333333*epsilon[0]*rdx2Sq[1]+0.1924500897298752*kSq[1]+0.3333333333333333*epsilon[0]*rdx2Sq[0]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[3], (-0.09622504486493762*kSq[2])+0.1666666666666667*epsilon[0]*rdx2Sq[1]-0.3333333333333333*epsilon[0]*rdx2Sq[0]-0.1111111111111111*kSq[0]);
  gkyl_mat_triples_insert(tri, globalIdxs[3], globalIdxs[0], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[3], globalIdxs[1], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[3], globalIdxs[2], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[3], globalIdxs[3], 1.0);

}
void fem_poisson_lhs_stencil_consteps_2x_ser_p2_upx_dirichletx_loy_dirichlety(const double *epsilon, const double *kSq, const double *dx, const double *bcVals, const long *globalIdxs, gkyl_mat_triples *tri) 
{ 
  // epsilon: permittivity.
  // kSq: wave number squared (factor multiplying phi).
  // dx: cell length in each direction.
  // bcVals[3]: values to impose as BCs, i.e. bcVals[0]*phi+bcVals[1]*d(phi)/dx=bcVals[2].
  // globalIdxs: global linear index of each basis function/node in current cell.
  // tri: triples object (i,j,val), i.e. contribute val to i,j element of the global matrix.

  double rdx2Sq[2];
  rdx2Sq[0] = 4.0/(dx[0]*dx[0]);
  rdx2Sq[1] = 4.0/(dx[1]*dx[1]);

  gkyl_mat_triples_insert(tri, globalIdxs[0], globalIdxs[0], 1.0);
  gkyl_mat_triples_insert(tri, globalIdxs[0], globalIdxs[1], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[0], globalIdxs[2], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[0], globalIdxs[3], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[0], globalIdxs[4], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[0], globalIdxs[5], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[0], globalIdxs[6], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[0], globalIdxs[7], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[1], globalIdxs[0], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[1], globalIdxs[1], 1.0);
  gkyl_mat_triples_insert(tri, globalIdxs[1], globalIdxs[2], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[1], globalIdxs[3], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[1], globalIdxs[4], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[1], globalIdxs[5], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[1], globalIdxs[6], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[1], globalIdxs[7], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[2], globalIdxs[0], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[2], globalIdxs[1], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[2], globalIdxs[2], 1.0);
  gkyl_mat_triples_insert(tri, globalIdxs[2], globalIdxs[3], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[2], globalIdxs[4], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[2], globalIdxs[5], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[2], globalIdxs[6], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[2], globalIdxs[7], 0.0);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[0], 0.0295084445425327*kSq[7]+0.03442651863295482*kSq[6]-0.063887656499994*kSq[5]-0.05962847939999439*kSq[4]-0.05333333333333333*kSq[3]+0.03849001794597505*kSq[2]-0.8888888888888888*epsilon[0]*rdx2Sq[1]+0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[1], (-0.03442651863295482*kSq[7])-0.03442651863295482*kSq[6]+0.09938079899999068*kSq[5]+0.09938079899999068*kSq[4]-0.02666666666666666*kSq[3]+0.0769800358919501*kSq[2]+0.0769800358919501*kSq[1]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[2], 0.01721325931647741*kSq[7]-0.05678902799999467*kSq[5]-0.03975231959999626*kSq[4]+0.01333333333333333*kSq[3]-0.4444444444444444*epsilon[0]*rdx2Sq[1]-0.03849001794597505*kSq[1]-0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[3], (-0.1967229636168847*kSq[7])+0.2271561119999787*kSq[5]-0.07950463919999252*kSq[4]+1.777777777777778*epsilon[0]*rdx2Sq[1]+0.3079201435678004*kSq[1]+0.5333333333333333*epsilon[0]*rdx2Sq[0]-0.3555555555555556*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[4], 0.1135780559999893*kSq[5]+0.07950463919999252*kSq[4]+0.8888888888888888*epsilon[0]*rdx2Sq[1]-0.5333333333333333*epsilon[0]*rdx2Sq[0]-0.1777777777777778*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[5], 0.0295084445425327*kSq[7]-0.03442651863295482*kSq[6]-0.063887656499994*kSq[5]-0.05962847939999439*kSq[4]+0.05333333333333333*kSq[3]-0.03849001794597505*kSq[2]-0.8888888888888888*epsilon[0]*rdx2Sq[1]+0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[6], (-0.03442651863295482*kSq[7])+0.03442651863295482*kSq[6]+0.09938079899999068*kSq[5]+0.09938079899999068*kSq[4]+0.02666666666666666*kSq[3]-0.0769800358919501*kSq[2]+0.0769800358919501*kSq[1]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[7], 0.01721325931647741*kSq[7]-0.05678902799999467*kSq[5]-0.03975231959999626*kSq[4]-0.01333333333333333*kSq[3]-0.4444444444444444*epsilon[0]*rdx2Sq[1]-0.03849001794597505*kSq[1]-0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_insert(tri, globalIdxs[4], globalIdxs[0], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[4], globalIdxs[1], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[4], globalIdxs[2], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[4], globalIdxs[3], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[4], globalIdxs[4], 1.0);
  gkyl_mat_triples_insert(tri, globalIdxs[4], globalIdxs[5], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[4], globalIdxs[6], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[4], globalIdxs[7], 0.0);
  gkyl_mat_triples_accum(tri, globalIdxs[5], globalIdxs[0], (-0.006147592613027645*kSq[7])+0.02697478829999747*kSq[5]+0.03336355394999686*kSq[4]+0.3111111111111111*epsilon[0]*rdx2Sq[1]-0.01924500897298752*kSq[1]+0.1888888888888889*epsilon[0]*rdx2Sq[0]-0.02222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[5], globalIdxs[1], 0.01721325931647741*kSq[6]-0.03975231959999626*kSq[5]-0.05678902799999467*kSq[4]+0.01333333333333333*kSq[3]-0.03849001794597505*kSq[2]-0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.4444444444444444*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[5], globalIdxs[2], 0.0234254740499978*kSq[5]+0.0234254740499978*kSq[4]-0.01333333333333333*kSq[3]+0.2555555555555555*epsilon[0]*rdx2Sq[1]+0.2555555555555555*epsilon[0]*rdx2Sq[0]-0.03333333333333333*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[5], globalIdxs[3], 0.0295084445425327*kSq[7]-0.03442651863295482*kSq[6]-0.063887656499994*kSq[5]-0.05962847939999439*kSq[4]+0.05333333333333333*kSq[3]-0.03849001794597505*kSq[2]-0.8888888888888888*epsilon[0]*rdx2Sq[1]+0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[5], globalIdxs[4], (-0.01721325931647741*kSq[7])-0.05678902799999467*kSq[5]-0.03975231959999626*kSq[4]+0.01333333333333333*kSq[3]-0.4444444444444444*epsilon[0]*rdx2Sq[1]+0.03849001794597505*kSq[1]-0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[5], globalIdxs[5], 0.04549218533640458*kSq[7]-0.04549218533640458*kSq[6]-0.0127775312999988*kSq[5]-0.0127775312999988*kSq[4]+0.04666666666666667*kSq[3]-0.03849001794597505*kSq[2]+0.5777777777777777*epsilon[0]*rdx2Sq[1]+0.03849001794597505*kSq[1]+0.5777777777777777*epsilon[0]*rdx2Sq[0]-0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[5], globalIdxs[6], 0.03442651863295482*kSq[7]-0.0295084445425327*kSq[6]-0.05962847939999439*kSq[5]-0.063887656499994*kSq[4]+0.05333333333333333*kSq[3]+0.06666666666666667*epsilon[0]*rdx2Sq[1]+0.03849001794597505*kSq[1]-0.8888888888888888*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[5], globalIdxs[7], 0.006147592613027645*kSq[6]+0.03336355394999686*kSq[5]+0.02697478829999747*kSq[4]+0.01924500897298752*kSq[2]+0.1888888888888889*epsilon[0]*rdx2Sq[1]+0.3111111111111111*epsilon[0]*rdx2Sq[0]-0.02222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[6], globalIdxs[0], (-0.01721325931647741*kSq[6])-0.03975231959999626*kSq[5]-0.05678902799999467*kSq[4]-0.01333333333333333*kSq[3]+0.03849001794597505*kSq[2]-0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.4444444444444444*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[6], globalIdxs[1], 0.07950463919999252*kSq[5]+0.1135780559999893*kSq[4]-0.5333333333333333*epsilon[0]*rdx2Sq[1]+0.8888888888888888*epsilon[0]*rdx2Sq[0]-0.1777777777777778*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[6], globalIdxs[2], (-0.01721325931647741*kSq[6])-0.03975231959999626*kSq[5]-0.05678902799999467*kSq[4]+0.01333333333333333*kSq[3]+0.03849001794597505*kSq[2]-0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.4444444444444444*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[6], globalIdxs[3], (-0.03442651863295482*kSq[7])+0.03442651863295482*kSq[6]+0.09938079899999068*kSq[5]+0.09938079899999068*kSq[4]+0.02666666666666666*kSq[3]-0.0769800358919501*kSq[2]+0.0769800358919501*kSq[1]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[6], globalIdxs[4], 0.03442651863295482*kSq[7]+0.03442651863295482*kSq[6]+0.09938079899999068*kSq[5]+0.09938079899999068*kSq[4]-0.02666666666666666*kSq[3]-0.0769800358919501*kSq[2]-0.0769800358919501*kSq[1]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[6], globalIdxs[5], 0.03442651863295482*kSq[7]-0.0295084445425327*kSq[6]-0.05962847939999439*kSq[5]-0.063887656499994*kSq[4]+0.05333333333333333*kSq[3]+0.06666666666666667*epsilon[0]*rdx2Sq[1]+0.03849001794597505*kSq[1]-0.8888888888888888*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[6], globalIdxs[6], 0.1967229636168847*kSq[6]-0.07950463919999252*kSq[5]+0.2271561119999787*kSq[4]-0.3079201435678004*kSq[2]+0.5333333333333333*epsilon[0]*rdx2Sq[1]+1.777777777777778*epsilon[0]*rdx2Sq[0]-0.3555555555555556*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[6], globalIdxs[7], (-0.03442651863295482*kSq[7])-0.0295084445425327*kSq[6]-0.05962847939999439*kSq[5]-0.063887656499994*kSq[4]-0.05333333333333333*kSq[3]+0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.03849001794597505*kSq[1]-0.8888888888888888*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_insert(tri, globalIdxs[7], globalIdxs[0], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[7], globalIdxs[1], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[7], globalIdxs[2], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[7], globalIdxs[3], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[7], globalIdxs[4], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[7], globalIdxs[5], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[7], globalIdxs[6], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[7], globalIdxs[7], 1.0);

}
void fem_poisson_lhs_stencil_consteps_2x_ser_p1_upx_dirichletx_loy_neumanny(const double *epsilon, const double *kSq, const double *dx, const double *bcVals, const long *globalIdxs, gkyl_mat_triples *tri) 
{ 
  // epsilon: permittivity.
  // kSq: wave number squared (factor multiplying phi).
  // dx: cell length in each direction.
  // bcVals[3]: values to impose as BCs, i.e. bcVals[0]*phi+bcVals[1]*d(phi)/dx=bcVals[2].
  // globalIdxs: global linear index of each basis function/node in current cell.
  // tri: triples object (i,j,val), i.e. contribute val to i,j element of the global matrix.

  double rdx2Sq[2];
  rdx2Sq[0] = 4.0/(dx[0]*dx[0]);
  rdx2Sq[1] = 4.0/(dx[1]*dx[1]);

  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[0], (-0.1666666666666667*kSq[3])+0.1924500897298752*kSq[2]+0.3333333333333333*epsilon[0]*rdx2Sq[1]+0.1924500897298752*kSq[1]+0.3333333333333333*epsilon[0]*rdx2Sq[0]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[1], 0.09622504486493762*kSq[2]+0.1666666666666667*epsilon[0]*rdx2Sq[1]-0.3333333333333333*epsilon[0]*rdx2Sq[0]-0.1111111111111111*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[2], (-0.3333333333333333*epsilon[0]*rdx2Sq[1])+0.09622504486493762*kSq[1]+0.1666666666666667*epsilon[0]*rdx2Sq[0]-0.1111111111111111*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[3], (-0.1666666666666667*epsilon[0]*rdx2Sq[1])-0.1666666666666667*epsilon[0]*rdx2Sq[0]-0.05555555555555555*kSq[0]);
  gkyl_mat_triples_insert(tri, globalIdxs[1], globalIdxs[0], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[1], globalIdxs[1], 1.0);
  gkyl_mat_triples_insert(tri, globalIdxs[1], globalIdxs[2], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[1], globalIdxs[3], 0.0);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[0], (-0.3333333333333333*epsilon[0]*rdx2Sq[1])+0.09622504486493762*kSq[1]+0.1666666666666667*epsilon[0]*rdx2Sq[0]-0.1111111111111111*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[1], (-0.1666666666666667*epsilon[0]*rdx2Sq[1])-0.1666666666666667*epsilon[0]*rdx2Sq[0]-0.05555555555555555*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[2], 0.1666666666666667*kSq[3]-0.1924500897298752*kSq[2]+0.3333333333333333*epsilon[0]*rdx2Sq[1]+0.1924500897298752*kSq[1]+0.3333333333333333*epsilon[0]*rdx2Sq[0]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[3], (-0.09622504486493762*kSq[2])+0.1666666666666667*epsilon[0]*rdx2Sq[1]-0.3333333333333333*epsilon[0]*rdx2Sq[0]-0.1111111111111111*kSq[0]);
  gkyl_mat_triples_insert(tri, globalIdxs[3], globalIdxs[0], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[3], globalIdxs[1], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[3], globalIdxs[2], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[3], globalIdxs[3], 1.0);

}
void fem_poisson_lhs_stencil_consteps_2x_ser_p2_upx_dirichletx_loy_neumanny(const double *epsilon, const double *kSq, const double *dx, const double *bcVals, const long *globalIdxs, gkyl_mat_triples *tri) 
{ 
  // epsilon: permittivity.
  // kSq: wave number squared (factor multiplying phi).
  // dx: cell length in each direction.
  // bcVals[3]: values to impose as BCs, i.e. bcVals[0]*phi+bcVals[1]*d(phi)/dx=bcVals[2].
  // globalIdxs: global linear index of each basis function/node in current cell.
  // tri: triples object (i,j,val), i.e. contribute val to i,j element of the global matrix.

  double rdx2Sq[2];
  rdx2Sq[0] = 4.0/(dx[0]*dx[0]);
  rdx2Sq[1] = 4.0/(dx[1]*dx[1]);

  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[0], 0.04549218533640458*kSq[7]+0.04549218533640458*kSq[6]-0.0127775312999988*kSq[5]-0.0127775312999988*kSq[4]-0.04666666666666667*kSq[3]+0.03849001794597505*kSq[2]+0.5777777777777777*epsilon[0]*rdx2Sq[1]+0.03849001794597505*kSq[1]+0.5777777777777777*epsilon[0]*rdx2Sq[0]-0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[1], 0.03442651863295482*kSq[7]+0.0295084445425327*kSq[6]-0.05962847939999439*kSq[5]-0.063887656499994*kSq[4]-0.05333333333333333*kSq[3]+0.06666666666666667*epsilon[0]*rdx2Sq[1]+0.03849001794597505*kSq[1]-0.8888888888888888*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[2], (-0.006147592613027645*kSq[6])+0.03336355394999686*kSq[5]+0.02697478829999747*kSq[4]-0.01924500897298752*kSq[2]+0.1888888888888889*epsilon[0]*rdx2Sq[1]+0.3111111111111111*epsilon[0]*rdx2Sq[0]-0.02222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[3], 0.0295084445425327*kSq[7]+0.03442651863295482*kSq[6]-0.063887656499994*kSq[5]-0.05962847939999439*kSq[4]-0.05333333333333333*kSq[3]+0.03849001794597505*kSq[2]-0.8888888888888888*epsilon[0]*rdx2Sq[1]+0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[4], (-0.01721325931647741*kSq[7])-0.05678902799999467*kSq[5]-0.03975231959999626*kSq[4]-0.01333333333333333*kSq[3]-0.4444444444444444*epsilon[0]*rdx2Sq[1]+0.03849001794597505*kSq[1]-0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[5], (-0.006147592613027645*kSq[7])+0.02697478829999747*kSq[5]+0.03336355394999686*kSq[4]+0.3111111111111111*epsilon[0]*rdx2Sq[1]-0.01924500897298752*kSq[1]+0.1888888888888889*epsilon[0]*rdx2Sq[0]-0.02222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[6], (-0.01721325931647741*kSq[6])-0.03975231959999626*kSq[5]-0.05678902799999467*kSq[4]-0.01333333333333333*kSq[3]+0.03849001794597505*kSq[2]-0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.4444444444444444*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[7], 0.0234254740499978*kSq[5]+0.0234254740499978*kSq[4]+0.01333333333333333*kSq[3]+0.2555555555555555*epsilon[0]*rdx2Sq[1]+0.2555555555555555*epsilon[0]*rdx2Sq[0]-0.03333333333333333*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[0], 0.03442651863295482*kSq[7]+0.0295084445425327*kSq[6]-0.05962847939999439*kSq[5]-0.063887656499994*kSq[4]-0.05333333333333333*kSq[3]+0.06666666666666667*epsilon[0]*rdx2Sq[1]+0.03849001794597505*kSq[1]-0.8888888888888888*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[1], (-0.1967229636168847*kSq[6])-0.07950463919999252*kSq[5]+0.2271561119999787*kSq[4]+0.3079201435678004*kSq[2]+0.5333333333333333*epsilon[0]*rdx2Sq[1]+1.777777777777778*epsilon[0]*rdx2Sq[0]-0.3555555555555556*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[2], (-0.03442651863295482*kSq[7])+0.0295084445425327*kSq[6]-0.05962847939999439*kSq[5]-0.063887656499994*kSq[4]+0.05333333333333333*kSq[3]+0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.03849001794597505*kSq[1]-0.8888888888888888*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[3], (-0.03442651863295482*kSq[7])-0.03442651863295482*kSq[6]+0.09938079899999068*kSq[5]+0.09938079899999068*kSq[4]-0.02666666666666666*kSq[3]+0.0769800358919501*kSq[2]+0.0769800358919501*kSq[1]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[4], 0.03442651863295482*kSq[7]-0.03442651863295482*kSq[6]+0.09938079899999068*kSq[5]+0.09938079899999068*kSq[4]+0.02666666666666666*kSq[3]+0.0769800358919501*kSq[2]-0.0769800358919501*kSq[1]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[5], 0.01721325931647741*kSq[6]-0.03975231959999626*kSq[5]-0.05678902799999467*kSq[4]+0.01333333333333333*kSq[3]-0.03849001794597505*kSq[2]-0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.4444444444444444*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[6], 0.07950463919999252*kSq[5]+0.1135780559999893*kSq[4]-0.5333333333333333*epsilon[0]*rdx2Sq[1]+0.8888888888888888*epsilon[0]*rdx2Sq[0]-0.1777777777777778*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[7], 0.01721325931647741*kSq[6]-0.03975231959999626*kSq[5]-0.05678902799999467*kSq[4]-0.01333333333333333*kSq[3]-0.03849001794597505*kSq[2]-0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.4444444444444444*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_insert(tri, globalIdxs[2], globalIdxs[0], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[2], globalIdxs[1], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[2], globalIdxs[2], 1.0);
  gkyl_mat_triples_insert(tri, globalIdxs[2], globalIdxs[3], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[2], globalIdxs[4], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[2], globalIdxs[5], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[2], globalIdxs[6], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[2], globalIdxs[7], 0.0);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[0], 0.0295084445425327*kSq[7]+0.03442651863295482*kSq[6]-0.063887656499994*kSq[5]-0.05962847939999439*kSq[4]-0.05333333333333333*kSq[3]+0.03849001794597505*kSq[2]-0.8888888888888888*epsilon[0]*rdx2Sq[1]+0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[1], (-0.03442651863295482*kSq[7])-0.03442651863295482*kSq[6]+0.09938079899999068*kSq[5]+0.09938079899999068*kSq[4]-0.02666666666666666*kSq[3]+0.0769800358919501*kSq[2]+0.0769800358919501*kSq[1]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[2], 0.01721325931647741*kSq[7]-0.05678902799999467*kSq[5]-0.03975231959999626*kSq[4]+0.01333333333333333*kSq[3]-0.4444444444444444*epsilon[0]*rdx2Sq[1]-0.03849001794597505*kSq[1]-0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[3], (-0.1967229636168847*kSq[7])+0.2271561119999787*kSq[5]-0.07950463919999252*kSq[4]+1.777777777777778*epsilon[0]*rdx2Sq[1]+0.3079201435678004*kSq[1]+0.5333333333333333*epsilon[0]*rdx2Sq[0]-0.3555555555555556*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[4], 0.1135780559999893*kSq[5]+0.07950463919999252*kSq[4]+0.8888888888888888*epsilon[0]*rdx2Sq[1]-0.5333333333333333*epsilon[0]*rdx2Sq[0]-0.1777777777777778*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[5], 0.0295084445425327*kSq[7]-0.03442651863295482*kSq[6]-0.063887656499994*kSq[5]-0.05962847939999439*kSq[4]+0.05333333333333333*kSq[3]-0.03849001794597505*kSq[2]-0.8888888888888888*epsilon[0]*rdx2Sq[1]+0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[6], (-0.03442651863295482*kSq[7])+0.03442651863295482*kSq[6]+0.09938079899999068*kSq[5]+0.09938079899999068*kSq[4]+0.02666666666666666*kSq[3]-0.0769800358919501*kSq[2]+0.0769800358919501*kSq[1]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[7], 0.01721325931647741*kSq[7]-0.05678902799999467*kSq[5]-0.03975231959999626*kSq[4]-0.01333333333333333*kSq[3]-0.4444444444444444*epsilon[0]*rdx2Sq[1]-0.03849001794597505*kSq[1]-0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_insert(tri, globalIdxs[4], globalIdxs[0], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[4], globalIdxs[1], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[4], globalIdxs[2], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[4], globalIdxs[3], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[4], globalIdxs[4], 1.0);
  gkyl_mat_triples_insert(tri, globalIdxs[4], globalIdxs[5], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[4], globalIdxs[6], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[4], globalIdxs[7], 0.0);
  gkyl_mat_triples_accum(tri, globalIdxs[5], globalIdxs[0], (-0.006147592613027645*kSq[7])+0.02697478829999747*kSq[5]+0.03336355394999686*kSq[4]+0.3111111111111111*epsilon[0]*rdx2Sq[1]-0.01924500897298752*kSq[1]+0.1888888888888889*epsilon[0]*rdx2Sq[0]-0.02222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[5], globalIdxs[1], 0.01721325931647741*kSq[6]-0.03975231959999626*kSq[5]-0.05678902799999467*kSq[4]+0.01333333333333333*kSq[3]-0.03849001794597505*kSq[2]-0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.4444444444444444*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[5], globalIdxs[2], 0.0234254740499978*kSq[5]+0.0234254740499978*kSq[4]-0.01333333333333333*kSq[3]+0.2555555555555555*epsilon[0]*rdx2Sq[1]+0.2555555555555555*epsilon[0]*rdx2Sq[0]-0.03333333333333333*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[5], globalIdxs[3], 0.0295084445425327*kSq[7]-0.03442651863295482*kSq[6]-0.063887656499994*kSq[5]-0.05962847939999439*kSq[4]+0.05333333333333333*kSq[3]-0.03849001794597505*kSq[2]-0.8888888888888888*epsilon[0]*rdx2Sq[1]+0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[5], globalIdxs[4], (-0.01721325931647741*kSq[7])-0.05678902799999467*kSq[5]-0.03975231959999626*kSq[4]+0.01333333333333333*kSq[3]-0.4444444444444444*epsilon[0]*rdx2Sq[1]+0.03849001794597505*kSq[1]-0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[5], globalIdxs[5], 0.04549218533640458*kSq[7]-0.04549218533640458*kSq[6]-0.0127775312999988*kSq[5]-0.0127775312999988*kSq[4]+0.04666666666666667*kSq[3]-0.03849001794597505*kSq[2]+0.5777777777777777*epsilon[0]*rdx2Sq[1]+0.03849001794597505*kSq[1]+0.5777777777777777*epsilon[0]*rdx2Sq[0]-0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[5], globalIdxs[6], 0.03442651863295482*kSq[7]-0.0295084445425327*kSq[6]-0.05962847939999439*kSq[5]-0.063887656499994*kSq[4]+0.05333333333333333*kSq[3]+0.06666666666666667*epsilon[0]*rdx2Sq[1]+0.03849001794597505*kSq[1]-0.8888888888888888*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[5], globalIdxs[7], 0.006147592613027645*kSq[6]+0.03336355394999686*kSq[5]+0.02697478829999747*kSq[4]+0.01924500897298752*kSq[2]+0.1888888888888889*epsilon[0]*rdx2Sq[1]+0.3111111111111111*epsilon[0]*rdx2Sq[0]-0.02222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[6], globalIdxs[0], (-0.01721325931647741*kSq[6])-0.03975231959999626*kSq[5]-0.05678902799999467*kSq[4]-0.01333333333333333*kSq[3]+0.03849001794597505*kSq[2]-0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.4444444444444444*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[6], globalIdxs[1], 0.07950463919999252*kSq[5]+0.1135780559999893*kSq[4]-0.5333333333333333*epsilon[0]*rdx2Sq[1]+0.8888888888888888*epsilon[0]*rdx2Sq[0]-0.1777777777777778*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[6], globalIdxs[2], (-0.01721325931647741*kSq[6])-0.03975231959999626*kSq[5]-0.05678902799999467*kSq[4]+0.01333333333333333*kSq[3]+0.03849001794597505*kSq[2]-0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.4444444444444444*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[6], globalIdxs[3], (-0.03442651863295482*kSq[7])+0.03442651863295482*kSq[6]+0.09938079899999068*kSq[5]+0.09938079899999068*kSq[4]+0.02666666666666666*kSq[3]-0.0769800358919501*kSq[2]+0.0769800358919501*kSq[1]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[6], globalIdxs[4], 0.03442651863295482*kSq[7]+0.03442651863295482*kSq[6]+0.09938079899999068*kSq[5]+0.09938079899999068*kSq[4]-0.02666666666666666*kSq[3]-0.0769800358919501*kSq[2]-0.0769800358919501*kSq[1]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[6], globalIdxs[5], 0.03442651863295482*kSq[7]-0.0295084445425327*kSq[6]-0.05962847939999439*kSq[5]-0.063887656499994*kSq[4]+0.05333333333333333*kSq[3]+0.06666666666666667*epsilon[0]*rdx2Sq[1]+0.03849001794597505*kSq[1]-0.8888888888888888*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[6], globalIdxs[6], 0.1967229636168847*kSq[6]-0.07950463919999252*kSq[5]+0.2271561119999787*kSq[4]-0.3079201435678004*kSq[2]+0.5333333333333333*epsilon[0]*rdx2Sq[1]+1.777777777777778*epsilon[0]*rdx2Sq[0]-0.3555555555555556*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[6], globalIdxs[7], (-0.03442651863295482*kSq[7])-0.0295084445425327*kSq[6]-0.05962847939999439*kSq[5]-0.063887656499994*kSq[4]-0.05333333333333333*kSq[3]+0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.03849001794597505*kSq[1]-0.8888888888888888*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_insert(tri, globalIdxs[7], globalIdxs[0], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[7], globalIdxs[1], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[7], globalIdxs[2], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[7], globalIdxs[3], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[7], globalIdxs[4], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[7], globalIdxs[5], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[7], globalIdxs[6], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[7], globalIdxs[7], 1.0);

}
void fem_poisson_lhs_stencil_consteps_2x_ser_p1_upx_dirichletx_loy_robiny(const double *epsilon, const double *kSq, const double *dx, const double *bcVals, const long *globalIdxs, gkyl_mat_triples *tri) 
{ 
  // epsilon: permittivity.
  // kSq: wave number squared (factor multiplying phi).
  // dx: cell length in each direction.
  // bcVals[3]: values to impose as BCs, i.e. bcVals[0]*phi+bcVals[1]*d(phi)/dx=bcVals[2].
  // globalIdxs: global linear index of each basis function/node in current cell.
  // tri: triples object (i,j,val), i.e. contribute val to i,j element of the global matrix.

  double rdx2Sq[2];
  rdx2Sq[0] = 4.0/(dx[0]*dx[0]);
  rdx2Sq[1] = 4.0/(dx[1]*dx[1]);

  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[0], (-(0.6666666666666666*epsilon[0]*rdx2Sq[1]*bcVals[6])/bcVals[7])-0.1666666666666667*kSq[3]+0.1924500897298752*kSq[2]+0.3333333333333333*epsilon[0]*rdx2Sq[1]+0.1924500897298752*kSq[1]+0.3333333333333333*epsilon[0]*rdx2Sq[0]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[1], (-(0.3333333333333333*epsilon[0]*rdx2Sq[1]*bcVals[6])/bcVals[7])+0.09622504486493762*kSq[2]+0.1666666666666667*epsilon[0]*rdx2Sq[1]-0.3333333333333333*epsilon[0]*rdx2Sq[0]-0.1111111111111111*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[2], (-0.3333333333333333*epsilon[0]*rdx2Sq[1])+0.09622504486493762*kSq[1]+0.1666666666666667*epsilon[0]*rdx2Sq[0]-0.1111111111111111*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[3], (-0.1666666666666667*epsilon[0]*rdx2Sq[1])-0.1666666666666667*epsilon[0]*rdx2Sq[0]-0.05555555555555555*kSq[0]);
  gkyl_mat_triples_insert(tri, globalIdxs[1], globalIdxs[0], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[1], globalIdxs[1], 1.0);
  gkyl_mat_triples_insert(tri, globalIdxs[1], globalIdxs[2], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[1], globalIdxs[3], 0.0);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[0], (-0.3333333333333333*epsilon[0]*rdx2Sq[1])+0.09622504486493762*kSq[1]+0.1666666666666667*epsilon[0]*rdx2Sq[0]-0.1111111111111111*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[1], (-0.1666666666666667*epsilon[0]*rdx2Sq[1])-0.1666666666666667*epsilon[0]*rdx2Sq[0]-0.05555555555555555*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[2], 0.1666666666666667*kSq[3]-0.1924500897298752*kSq[2]+0.3333333333333333*epsilon[0]*rdx2Sq[1]+0.1924500897298752*kSq[1]+0.3333333333333333*epsilon[0]*rdx2Sq[0]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[3], (-0.09622504486493762*kSq[2])+0.1666666666666667*epsilon[0]*rdx2Sq[1]-0.3333333333333333*epsilon[0]*rdx2Sq[0]-0.1111111111111111*kSq[0]);
  gkyl_mat_triples_insert(tri, globalIdxs[3], globalIdxs[0], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[3], globalIdxs[1], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[3], globalIdxs[2], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[3], globalIdxs[3], 1.0);

}
void fem_poisson_lhs_stencil_consteps_2x_ser_p2_upx_dirichletx_loy_robiny(const double *epsilon, const double *kSq, const double *dx, const double *bcVals, const long *globalIdxs, gkyl_mat_triples *tri) 
{ 
  // epsilon: permittivity.
  // kSq: wave number squared (factor multiplying phi).
  // dx: cell length in each direction.
  // bcVals[3]: values to impose as BCs, i.e. bcVals[0]*phi+bcVals[1]*d(phi)/dx=bcVals[2].
  // globalIdxs: global linear index of each basis function/node in current cell.
  // tri: triples object (i,j,val), i.e. contribute val to i,j element of the global matrix.

  double rdx2Sq[2];
  rdx2Sq[0] = 4.0/(dx[0]*dx[0]);
  rdx2Sq[1] = 4.0/(dx[1]*dx[1]);

  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[0], 0.04549218533640458*kSq[7]-(0.2666666666666667*epsilon[0]*rdx2Sq[1]*bcVals[6])/bcVals[7]+0.04549218533640458*kSq[6]-0.0127775312999988*kSq[5]-0.0127775312999988*kSq[4]-0.04666666666666667*kSq[3]+0.03849001794597505*kSq[2]+0.5777777777777777*epsilon[0]*rdx2Sq[1]+0.03849001794597505*kSq[1]+0.5777777777777777*epsilon[0]*rdx2Sq[0]-0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[1], 0.03442651863295482*kSq[7]-(0.1333333333333333*epsilon[0]*rdx2Sq[1]*bcVals[6])/bcVals[7]+0.0295084445425327*kSq[6]-0.05962847939999439*kSq[5]-0.063887656499994*kSq[4]-0.05333333333333333*kSq[3]+0.06666666666666667*epsilon[0]*rdx2Sq[1]+0.03849001794597505*kSq[1]-0.8888888888888888*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[2], (0.06666666666666667*epsilon[0]*rdx2Sq[1]*bcVals[6])/bcVals[7]-0.006147592613027645*kSq[6]+0.03336355394999686*kSq[5]+0.02697478829999747*kSq[4]-0.01924500897298752*kSq[2]+0.1888888888888889*epsilon[0]*rdx2Sq[1]+0.3111111111111111*epsilon[0]*rdx2Sq[0]-0.02222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[3], 0.0295084445425327*kSq[7]+0.03442651863295482*kSq[6]-0.063887656499994*kSq[5]-0.05962847939999439*kSq[4]-0.05333333333333333*kSq[3]+0.03849001794597505*kSq[2]-0.8888888888888888*epsilon[0]*rdx2Sq[1]+0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[4], (-0.01721325931647741*kSq[7])-0.05678902799999467*kSq[5]-0.03975231959999626*kSq[4]-0.01333333333333333*kSq[3]-0.4444444444444444*epsilon[0]*rdx2Sq[1]+0.03849001794597505*kSq[1]-0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[5], (-0.006147592613027645*kSq[7])+0.02697478829999747*kSq[5]+0.03336355394999686*kSq[4]+0.3111111111111111*epsilon[0]*rdx2Sq[1]-0.01924500897298752*kSq[1]+0.1888888888888889*epsilon[0]*rdx2Sq[0]-0.02222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[6], (-0.01721325931647741*kSq[6])-0.03975231959999626*kSq[5]-0.05678902799999467*kSq[4]-0.01333333333333333*kSq[3]+0.03849001794597505*kSq[2]-0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.4444444444444444*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[7], 0.0234254740499978*kSq[5]+0.0234254740499978*kSq[4]+0.01333333333333333*kSq[3]+0.2555555555555555*epsilon[0]*rdx2Sq[1]+0.2555555555555555*epsilon[0]*rdx2Sq[0]-0.03333333333333333*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[0], 0.03442651863295482*kSq[7]-(0.1333333333333333*epsilon[0]*rdx2Sq[1]*bcVals[6])/bcVals[7]+0.0295084445425327*kSq[6]-0.05962847939999439*kSq[5]-0.063887656499994*kSq[4]-0.05333333333333333*kSq[3]+0.06666666666666667*epsilon[0]*rdx2Sq[1]+0.03849001794597505*kSq[1]-0.8888888888888888*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[1], (-(1.066666666666667*epsilon[0]*rdx2Sq[1]*bcVals[6])/bcVals[7])-0.1967229636168847*kSq[6]-0.07950463919999252*kSq[5]+0.2271561119999787*kSq[4]+0.3079201435678004*kSq[2]+0.5333333333333333*epsilon[0]*rdx2Sq[1]+1.777777777777778*epsilon[0]*rdx2Sq[0]-0.3555555555555556*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[2], (-0.03442651863295482*kSq[7])-(0.1333333333333333*epsilon[0]*rdx2Sq[1]*bcVals[6])/bcVals[7]+0.0295084445425327*kSq[6]-0.05962847939999439*kSq[5]-0.063887656499994*kSq[4]+0.05333333333333333*kSq[3]+0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.03849001794597505*kSq[1]-0.8888888888888888*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[3], (-0.03442651863295482*kSq[7])-0.03442651863295482*kSq[6]+0.09938079899999068*kSq[5]+0.09938079899999068*kSq[4]-0.02666666666666666*kSq[3]+0.0769800358919501*kSq[2]+0.0769800358919501*kSq[1]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[4], 0.03442651863295482*kSq[7]-0.03442651863295482*kSq[6]+0.09938079899999068*kSq[5]+0.09938079899999068*kSq[4]+0.02666666666666666*kSq[3]+0.0769800358919501*kSq[2]-0.0769800358919501*kSq[1]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[5], 0.01721325931647741*kSq[6]-0.03975231959999626*kSq[5]-0.05678902799999467*kSq[4]+0.01333333333333333*kSq[3]-0.03849001794597505*kSq[2]-0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.4444444444444444*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[6], 0.07950463919999252*kSq[5]+0.1135780559999893*kSq[4]-0.5333333333333333*epsilon[0]*rdx2Sq[1]+0.8888888888888888*epsilon[0]*rdx2Sq[0]-0.1777777777777778*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[7], 0.01721325931647741*kSq[6]-0.03975231959999626*kSq[5]-0.05678902799999467*kSq[4]-0.01333333333333333*kSq[3]-0.03849001794597505*kSq[2]-0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.4444444444444444*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_insert(tri, globalIdxs[2], globalIdxs[0], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[2], globalIdxs[1], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[2], globalIdxs[2], 1.0);
  gkyl_mat_triples_insert(tri, globalIdxs[2], globalIdxs[3], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[2], globalIdxs[4], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[2], globalIdxs[5], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[2], globalIdxs[6], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[2], globalIdxs[7], 0.0);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[0], 0.0295084445425327*kSq[7]+0.03442651863295482*kSq[6]-0.063887656499994*kSq[5]-0.05962847939999439*kSq[4]-0.05333333333333333*kSq[3]+0.03849001794597505*kSq[2]-0.8888888888888888*epsilon[0]*rdx2Sq[1]+0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[1], (-0.03442651863295482*kSq[7])-0.03442651863295482*kSq[6]+0.09938079899999068*kSq[5]+0.09938079899999068*kSq[4]-0.02666666666666666*kSq[3]+0.0769800358919501*kSq[2]+0.0769800358919501*kSq[1]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[2], 0.01721325931647741*kSq[7]-0.05678902799999467*kSq[5]-0.03975231959999626*kSq[4]+0.01333333333333333*kSq[3]-0.4444444444444444*epsilon[0]*rdx2Sq[1]-0.03849001794597505*kSq[1]-0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[3], (-0.1967229636168847*kSq[7])+0.2271561119999787*kSq[5]-0.07950463919999252*kSq[4]+1.777777777777778*epsilon[0]*rdx2Sq[1]+0.3079201435678004*kSq[1]+0.5333333333333333*epsilon[0]*rdx2Sq[0]-0.3555555555555556*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[4], 0.1135780559999893*kSq[5]+0.07950463919999252*kSq[4]+0.8888888888888888*epsilon[0]*rdx2Sq[1]-0.5333333333333333*epsilon[0]*rdx2Sq[0]-0.1777777777777778*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[5], 0.0295084445425327*kSq[7]-0.03442651863295482*kSq[6]-0.063887656499994*kSq[5]-0.05962847939999439*kSq[4]+0.05333333333333333*kSq[3]-0.03849001794597505*kSq[2]-0.8888888888888888*epsilon[0]*rdx2Sq[1]+0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[6], (-0.03442651863295482*kSq[7])+0.03442651863295482*kSq[6]+0.09938079899999068*kSq[5]+0.09938079899999068*kSq[4]+0.02666666666666666*kSq[3]-0.0769800358919501*kSq[2]+0.0769800358919501*kSq[1]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[7], 0.01721325931647741*kSq[7]-0.05678902799999467*kSq[5]-0.03975231959999626*kSq[4]-0.01333333333333333*kSq[3]-0.4444444444444444*epsilon[0]*rdx2Sq[1]-0.03849001794597505*kSq[1]-0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_insert(tri, globalIdxs[4], globalIdxs[0], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[4], globalIdxs[1], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[4], globalIdxs[2], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[4], globalIdxs[3], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[4], globalIdxs[4], 1.0);
  gkyl_mat_triples_insert(tri, globalIdxs[4], globalIdxs[5], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[4], globalIdxs[6], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[4], globalIdxs[7], 0.0);
  gkyl_mat_triples_accum(tri, globalIdxs[5], globalIdxs[0], (-0.006147592613027645*kSq[7])+0.02697478829999747*kSq[5]+0.03336355394999686*kSq[4]+0.3111111111111111*epsilon[0]*rdx2Sq[1]-0.01924500897298752*kSq[1]+0.1888888888888889*epsilon[0]*rdx2Sq[0]-0.02222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[5], globalIdxs[1], 0.01721325931647741*kSq[6]-0.03975231959999626*kSq[5]-0.05678902799999467*kSq[4]+0.01333333333333333*kSq[3]-0.03849001794597505*kSq[2]-0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.4444444444444444*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[5], globalIdxs[2], 0.0234254740499978*kSq[5]+0.0234254740499978*kSq[4]-0.01333333333333333*kSq[3]+0.2555555555555555*epsilon[0]*rdx2Sq[1]+0.2555555555555555*epsilon[0]*rdx2Sq[0]-0.03333333333333333*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[5], globalIdxs[3], 0.0295084445425327*kSq[7]-0.03442651863295482*kSq[6]-0.063887656499994*kSq[5]-0.05962847939999439*kSq[4]+0.05333333333333333*kSq[3]-0.03849001794597505*kSq[2]-0.8888888888888888*epsilon[0]*rdx2Sq[1]+0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[5], globalIdxs[4], (-0.01721325931647741*kSq[7])-0.05678902799999467*kSq[5]-0.03975231959999626*kSq[4]+0.01333333333333333*kSq[3]-0.4444444444444444*epsilon[0]*rdx2Sq[1]+0.03849001794597505*kSq[1]-0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[5], globalIdxs[5], 0.04549218533640458*kSq[7]-0.04549218533640458*kSq[6]-0.0127775312999988*kSq[5]-0.0127775312999988*kSq[4]+0.04666666666666667*kSq[3]-0.03849001794597505*kSq[2]+0.5777777777777777*epsilon[0]*rdx2Sq[1]+0.03849001794597505*kSq[1]+0.5777777777777777*epsilon[0]*rdx2Sq[0]-0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[5], globalIdxs[6], 0.03442651863295482*kSq[7]-0.0295084445425327*kSq[6]-0.05962847939999439*kSq[5]-0.063887656499994*kSq[4]+0.05333333333333333*kSq[3]+0.06666666666666667*epsilon[0]*rdx2Sq[1]+0.03849001794597505*kSq[1]-0.8888888888888888*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[5], globalIdxs[7], 0.006147592613027645*kSq[6]+0.03336355394999686*kSq[5]+0.02697478829999747*kSq[4]+0.01924500897298752*kSq[2]+0.1888888888888889*epsilon[0]*rdx2Sq[1]+0.3111111111111111*epsilon[0]*rdx2Sq[0]-0.02222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[6], globalIdxs[0], (-0.01721325931647741*kSq[6])-0.03975231959999626*kSq[5]-0.05678902799999467*kSq[4]-0.01333333333333333*kSq[3]+0.03849001794597505*kSq[2]-0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.4444444444444444*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[6], globalIdxs[1], 0.07950463919999252*kSq[5]+0.1135780559999893*kSq[4]-0.5333333333333333*epsilon[0]*rdx2Sq[1]+0.8888888888888888*epsilon[0]*rdx2Sq[0]-0.1777777777777778*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[6], globalIdxs[2], (-0.01721325931647741*kSq[6])-0.03975231959999626*kSq[5]-0.05678902799999467*kSq[4]+0.01333333333333333*kSq[3]+0.03849001794597505*kSq[2]-0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.4444444444444444*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[6], globalIdxs[3], (-0.03442651863295482*kSq[7])+0.03442651863295482*kSq[6]+0.09938079899999068*kSq[5]+0.09938079899999068*kSq[4]+0.02666666666666666*kSq[3]-0.0769800358919501*kSq[2]+0.0769800358919501*kSq[1]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[6], globalIdxs[4], 0.03442651863295482*kSq[7]+0.03442651863295482*kSq[6]+0.09938079899999068*kSq[5]+0.09938079899999068*kSq[4]-0.02666666666666666*kSq[3]-0.0769800358919501*kSq[2]-0.0769800358919501*kSq[1]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[6], globalIdxs[5], 0.03442651863295482*kSq[7]-0.0295084445425327*kSq[6]-0.05962847939999439*kSq[5]-0.063887656499994*kSq[4]+0.05333333333333333*kSq[3]+0.06666666666666667*epsilon[0]*rdx2Sq[1]+0.03849001794597505*kSq[1]-0.8888888888888888*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[6], globalIdxs[6], 0.1967229636168847*kSq[6]-0.07950463919999252*kSq[5]+0.2271561119999787*kSq[4]-0.3079201435678004*kSq[2]+0.5333333333333333*epsilon[0]*rdx2Sq[1]+1.777777777777778*epsilon[0]*rdx2Sq[0]-0.3555555555555556*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[6], globalIdxs[7], (-0.03442651863295482*kSq[7])-0.0295084445425327*kSq[6]-0.05962847939999439*kSq[5]-0.063887656499994*kSq[4]-0.05333333333333333*kSq[3]+0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.03849001794597505*kSq[1]-0.8888888888888888*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_insert(tri, globalIdxs[7], globalIdxs[0], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[7], globalIdxs[1], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[7], globalIdxs[2], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[7], globalIdxs[3], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[7], globalIdxs[4], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[7], globalIdxs[5], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[7], globalIdxs[6], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[7], globalIdxs[7], 1.0);

}
void fem_poisson_lhs_stencil_consteps_2x_ser_p1_upx_neumannx_loy_periodicy(const double *epsilon, const double *kSq, const double *dx, const double *bcVals, const long *globalIdxs, gkyl_mat_triples *tri) 
{ 
  // epsilon: permittivity.
  // kSq: wave number squared (factor multiplying phi).
  // dx: cell length in each direction.
  // bcVals[3]: values to impose as BCs, i.e. bcVals[0]*phi+bcVals[1]*d(phi)/dx=bcVals[2].
  // globalIdxs: global linear index of each basis function/node in current cell.
  // tri: triples object (i,j,val), i.e. contribute val to i,j element of the global matrix.

  double rdx2Sq[2];
  rdx2Sq[0] = 4.0/(dx[0]*dx[0]);
  rdx2Sq[1] = 4.0/(dx[1]*dx[1]);

  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[0], (-0.1666666666666667*kSq[3])+0.1924500897298752*kSq[2]+0.3333333333333333*epsilon[0]*rdx2Sq[1]+0.1924500897298752*kSq[1]+0.3333333333333333*epsilon[0]*rdx2Sq[0]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[1], 0.09622504486493762*kSq[2]+0.1666666666666667*epsilon[0]*rdx2Sq[1]-0.3333333333333333*epsilon[0]*rdx2Sq[0]-0.1111111111111111*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[2], (-0.3333333333333333*epsilon[0]*rdx2Sq[1])+0.09622504486493762*kSq[1]+0.1666666666666667*epsilon[0]*rdx2Sq[0]-0.1111111111111111*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[3], (-0.1666666666666667*epsilon[0]*rdx2Sq[1])-0.1666666666666667*epsilon[0]*rdx2Sq[0]-0.05555555555555555*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[0], 0.09622504486493762*kSq[2]+0.1666666666666667*epsilon[0]*rdx2Sq[1]-0.3333333333333333*epsilon[0]*rdx2Sq[0]-0.1111111111111111*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[1], 0.1666666666666667*kSq[3]+0.1924500897298752*kSq[2]+0.3333333333333333*epsilon[0]*rdx2Sq[1]-0.1924500897298752*kSq[1]+0.3333333333333333*epsilon[0]*rdx2Sq[0]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[2], (-0.1666666666666667*epsilon[0]*rdx2Sq[1])-0.1666666666666667*epsilon[0]*rdx2Sq[0]-0.05555555555555555*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[3], (-0.3333333333333333*epsilon[0]*rdx2Sq[1])-0.09622504486493762*kSq[1]+0.1666666666666667*epsilon[0]*rdx2Sq[0]-0.1111111111111111*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[0], (-0.3333333333333333*epsilon[0]*rdx2Sq[1])+0.09622504486493762*kSq[1]+0.1666666666666667*epsilon[0]*rdx2Sq[0]-0.1111111111111111*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[1], (-0.1666666666666667*epsilon[0]*rdx2Sq[1])-0.1666666666666667*epsilon[0]*rdx2Sq[0]-0.05555555555555555*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[2], 0.1666666666666667*kSq[3]-0.1924500897298752*kSq[2]+0.3333333333333333*epsilon[0]*rdx2Sq[1]+0.1924500897298752*kSq[1]+0.3333333333333333*epsilon[0]*rdx2Sq[0]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[3], (-0.09622504486493762*kSq[2])+0.1666666666666667*epsilon[0]*rdx2Sq[1]-0.3333333333333333*epsilon[0]*rdx2Sq[0]-0.1111111111111111*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[0], (-0.1666666666666667*epsilon[0]*rdx2Sq[1])-0.1666666666666667*epsilon[0]*rdx2Sq[0]-0.05555555555555555*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[1], (-0.3333333333333333*epsilon[0]*rdx2Sq[1])-0.09622504486493762*kSq[1]+0.1666666666666667*epsilon[0]*rdx2Sq[0]-0.1111111111111111*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[2], (-0.09622504486493762*kSq[2])+0.1666666666666667*epsilon[0]*rdx2Sq[1]-0.3333333333333333*epsilon[0]*rdx2Sq[0]-0.1111111111111111*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[3], (-0.1666666666666667*kSq[3])-0.1924500897298752*kSq[2]+0.3333333333333333*epsilon[0]*rdx2Sq[1]-0.1924500897298752*kSq[1]+0.3333333333333333*epsilon[0]*rdx2Sq[0]-0.2222222222222222*kSq[0]);

}
void fem_poisson_lhs_stencil_consteps_2x_ser_p2_upx_neumannx_loy_periodicy(const double *epsilon, const double *kSq, const double *dx, const double *bcVals, const long *globalIdxs, gkyl_mat_triples *tri) 
{ 
  // epsilon: permittivity.
  // kSq: wave number squared (factor multiplying phi).
  // dx: cell length in each direction.
  // bcVals[3]: values to impose as BCs, i.e. bcVals[0]*phi+bcVals[1]*d(phi)/dx=bcVals[2].
  // globalIdxs: global linear index of each basis function/node in current cell.
  // tri: triples object (i,j,val), i.e. contribute val to i,j element of the global matrix.

  double rdx2Sq[2];
  rdx2Sq[0] = 4.0/(dx[0]*dx[0]);
  rdx2Sq[1] = 4.0/(dx[1]*dx[1]);

  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[0], 0.04549218533640458*kSq[7]+0.04549218533640458*kSq[6]-0.0127775312999988*kSq[5]-0.0127775312999988*kSq[4]-0.04666666666666667*kSq[3]+0.03849001794597505*kSq[2]+0.5777777777777777*epsilon[0]*rdx2Sq[1]+0.03849001794597505*kSq[1]+0.5777777777777777*epsilon[0]*rdx2Sq[0]-0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[1], 0.03442651863295482*kSq[7]+0.0295084445425327*kSq[6]-0.05962847939999439*kSq[5]-0.063887656499994*kSq[4]-0.05333333333333333*kSq[3]+0.06666666666666667*epsilon[0]*rdx2Sq[1]+0.03849001794597505*kSq[1]-0.8888888888888888*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[2], (-0.006147592613027645*kSq[6])+0.03336355394999686*kSq[5]+0.02697478829999747*kSq[4]-0.01924500897298752*kSq[2]+0.1888888888888889*epsilon[0]*rdx2Sq[1]+0.3111111111111111*epsilon[0]*rdx2Sq[0]-0.02222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[3], 0.0295084445425327*kSq[7]+0.03442651863295482*kSq[6]-0.063887656499994*kSq[5]-0.05962847939999439*kSq[4]-0.05333333333333333*kSq[3]+0.03849001794597505*kSq[2]-0.8888888888888888*epsilon[0]*rdx2Sq[1]+0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[4], (-0.01721325931647741*kSq[7])-0.05678902799999467*kSq[5]-0.03975231959999626*kSq[4]-0.01333333333333333*kSq[3]-0.4444444444444444*epsilon[0]*rdx2Sq[1]+0.03849001794597505*kSq[1]-0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[5], (-0.006147592613027645*kSq[7])+0.02697478829999747*kSq[5]+0.03336355394999686*kSq[4]+0.3111111111111111*epsilon[0]*rdx2Sq[1]-0.01924500897298752*kSq[1]+0.1888888888888889*epsilon[0]*rdx2Sq[0]-0.02222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[6], (-0.01721325931647741*kSq[6])-0.03975231959999626*kSq[5]-0.05678902799999467*kSq[4]-0.01333333333333333*kSq[3]+0.03849001794597505*kSq[2]-0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.4444444444444444*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[7], 0.0234254740499978*kSq[5]+0.0234254740499978*kSq[4]+0.01333333333333333*kSq[3]+0.2555555555555555*epsilon[0]*rdx2Sq[1]+0.2555555555555555*epsilon[0]*rdx2Sq[0]-0.03333333333333333*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[0], 0.03442651863295482*kSq[7]+0.0295084445425327*kSq[6]-0.05962847939999439*kSq[5]-0.063887656499994*kSq[4]-0.05333333333333333*kSq[3]+0.06666666666666667*epsilon[0]*rdx2Sq[1]+0.03849001794597505*kSq[1]-0.8888888888888888*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[1], (-0.1967229636168847*kSq[6])-0.07950463919999252*kSq[5]+0.2271561119999787*kSq[4]+0.3079201435678004*kSq[2]+0.5333333333333333*epsilon[0]*rdx2Sq[1]+1.777777777777778*epsilon[0]*rdx2Sq[0]-0.3555555555555556*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[2], (-0.03442651863295482*kSq[7])+0.0295084445425327*kSq[6]-0.05962847939999439*kSq[5]-0.063887656499994*kSq[4]+0.05333333333333333*kSq[3]+0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.03849001794597505*kSq[1]-0.8888888888888888*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[3], (-0.03442651863295482*kSq[7])-0.03442651863295482*kSq[6]+0.09938079899999068*kSq[5]+0.09938079899999068*kSq[4]-0.02666666666666666*kSq[3]+0.0769800358919501*kSq[2]+0.0769800358919501*kSq[1]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[4], 0.03442651863295482*kSq[7]-0.03442651863295482*kSq[6]+0.09938079899999068*kSq[5]+0.09938079899999068*kSq[4]+0.02666666666666666*kSq[3]+0.0769800358919501*kSq[2]-0.0769800358919501*kSq[1]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[5], 0.01721325931647741*kSq[6]-0.03975231959999626*kSq[5]-0.05678902799999467*kSq[4]+0.01333333333333333*kSq[3]-0.03849001794597505*kSq[2]-0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.4444444444444444*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[6], 0.07950463919999252*kSq[5]+0.1135780559999893*kSq[4]-0.5333333333333333*epsilon[0]*rdx2Sq[1]+0.8888888888888888*epsilon[0]*rdx2Sq[0]-0.1777777777777778*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[7], 0.01721325931647741*kSq[6]-0.03975231959999626*kSq[5]-0.05678902799999467*kSq[4]-0.01333333333333333*kSq[3]-0.03849001794597505*kSq[2]-0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.4444444444444444*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[0], (-0.006147592613027645*kSq[6])+0.03336355394999686*kSq[5]+0.02697478829999747*kSq[4]-0.01924500897298752*kSq[2]+0.1888888888888889*epsilon[0]*rdx2Sq[1]+0.3111111111111111*epsilon[0]*rdx2Sq[0]-0.02222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[1], (-0.03442651863295482*kSq[7])+0.0295084445425327*kSq[6]-0.05962847939999439*kSq[5]-0.063887656499994*kSq[4]+0.05333333333333333*kSq[3]+0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.03849001794597505*kSq[1]-0.8888888888888888*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[2], (-0.04549218533640458*kSq[7])+0.04549218533640458*kSq[6]-0.0127775312999988*kSq[5]-0.0127775312999988*kSq[4]+0.04666666666666667*kSq[3]+0.03849001794597505*kSq[2]+0.5777777777777777*epsilon[0]*rdx2Sq[1]-0.03849001794597505*kSq[1]+0.5777777777777777*epsilon[0]*rdx2Sq[0]-0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[3], 0.01721325931647741*kSq[7]-0.05678902799999467*kSq[5]-0.03975231959999626*kSq[4]+0.01333333333333333*kSq[3]-0.4444444444444444*epsilon[0]*rdx2Sq[1]-0.03849001794597505*kSq[1]-0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[4], (-0.0295084445425327*kSq[7])+0.03442651863295482*kSq[6]-0.063887656499994*kSq[5]-0.05962847939999439*kSq[4]+0.05333333333333333*kSq[3]+0.03849001794597505*kSq[2]-0.8888888888888888*epsilon[0]*rdx2Sq[1]+0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[5], 0.0234254740499978*kSq[5]+0.0234254740499978*kSq[4]-0.01333333333333333*kSq[3]+0.2555555555555555*epsilon[0]*rdx2Sq[1]+0.2555555555555555*epsilon[0]*rdx2Sq[0]-0.03333333333333333*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[6], (-0.01721325931647741*kSq[6])-0.03975231959999626*kSq[5]-0.05678902799999467*kSq[4]+0.01333333333333333*kSq[3]+0.03849001794597505*kSq[2]-0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.4444444444444444*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[7], 0.006147592613027645*kSq[7]+0.02697478829999747*kSq[5]+0.03336355394999686*kSq[4]+0.3111111111111111*epsilon[0]*rdx2Sq[1]+0.01924500897298752*kSq[1]+0.1888888888888889*epsilon[0]*rdx2Sq[0]-0.02222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[0], 0.0295084445425327*kSq[7]+0.03442651863295482*kSq[6]-0.063887656499994*kSq[5]-0.05962847939999439*kSq[4]-0.05333333333333333*kSq[3]+0.03849001794597505*kSq[2]-0.8888888888888888*epsilon[0]*rdx2Sq[1]+0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[1], (-0.03442651863295482*kSq[7])-0.03442651863295482*kSq[6]+0.09938079899999068*kSq[5]+0.09938079899999068*kSq[4]-0.02666666666666666*kSq[3]+0.0769800358919501*kSq[2]+0.0769800358919501*kSq[1]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[2], 0.01721325931647741*kSq[7]-0.05678902799999467*kSq[5]-0.03975231959999626*kSq[4]+0.01333333333333333*kSq[3]-0.4444444444444444*epsilon[0]*rdx2Sq[1]-0.03849001794597505*kSq[1]-0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[3], (-0.1967229636168847*kSq[7])+0.2271561119999787*kSq[5]-0.07950463919999252*kSq[4]+1.777777777777778*epsilon[0]*rdx2Sq[1]+0.3079201435678004*kSq[1]+0.5333333333333333*epsilon[0]*rdx2Sq[0]-0.3555555555555556*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[4], 0.1135780559999893*kSq[5]+0.07950463919999252*kSq[4]+0.8888888888888888*epsilon[0]*rdx2Sq[1]-0.5333333333333333*epsilon[0]*rdx2Sq[0]-0.1777777777777778*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[5], 0.0295084445425327*kSq[7]-0.03442651863295482*kSq[6]-0.063887656499994*kSq[5]-0.05962847939999439*kSq[4]+0.05333333333333333*kSq[3]-0.03849001794597505*kSq[2]-0.8888888888888888*epsilon[0]*rdx2Sq[1]+0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[6], (-0.03442651863295482*kSq[7])+0.03442651863295482*kSq[6]+0.09938079899999068*kSq[5]+0.09938079899999068*kSq[4]+0.02666666666666666*kSq[3]-0.0769800358919501*kSq[2]+0.0769800358919501*kSq[1]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[7], 0.01721325931647741*kSq[7]-0.05678902799999467*kSq[5]-0.03975231959999626*kSq[4]-0.01333333333333333*kSq[3]-0.4444444444444444*epsilon[0]*rdx2Sq[1]-0.03849001794597505*kSq[1]-0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[4], globalIdxs[0], (-0.01721325931647741*kSq[7])-0.05678902799999467*kSq[5]-0.03975231959999626*kSq[4]-0.01333333333333333*kSq[3]-0.4444444444444444*epsilon[0]*rdx2Sq[1]+0.03849001794597505*kSq[1]-0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[4], globalIdxs[1], 0.03442651863295482*kSq[7]-0.03442651863295482*kSq[6]+0.09938079899999068*kSq[5]+0.09938079899999068*kSq[4]+0.02666666666666666*kSq[3]+0.0769800358919501*kSq[2]-0.0769800358919501*kSq[1]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[4], globalIdxs[2], (-0.0295084445425327*kSq[7])+0.03442651863295482*kSq[6]-0.063887656499994*kSq[5]-0.05962847939999439*kSq[4]+0.05333333333333333*kSq[3]+0.03849001794597505*kSq[2]-0.8888888888888888*epsilon[0]*rdx2Sq[1]+0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[4], globalIdxs[3], 0.1135780559999893*kSq[5]+0.07950463919999252*kSq[4]+0.8888888888888888*epsilon[0]*rdx2Sq[1]-0.5333333333333333*epsilon[0]*rdx2Sq[0]-0.1777777777777778*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[4], globalIdxs[4], 0.1967229636168847*kSq[7]+0.2271561119999787*kSq[5]-0.07950463919999252*kSq[4]+1.777777777777778*epsilon[0]*rdx2Sq[1]-0.3079201435678004*kSq[1]+0.5333333333333333*epsilon[0]*rdx2Sq[0]-0.3555555555555556*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[4], globalIdxs[5], (-0.01721325931647741*kSq[7])-0.05678902799999467*kSq[5]-0.03975231959999626*kSq[4]+0.01333333333333333*kSq[3]-0.4444444444444444*epsilon[0]*rdx2Sq[1]+0.03849001794597505*kSq[1]-0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[4], globalIdxs[6], 0.03442651863295482*kSq[7]+0.03442651863295482*kSq[6]+0.09938079899999068*kSq[5]+0.09938079899999068*kSq[4]-0.02666666666666666*kSq[3]-0.0769800358919501*kSq[2]-0.0769800358919501*kSq[1]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[4], globalIdxs[7], (-0.0295084445425327*kSq[7])-0.03442651863295482*kSq[6]-0.063887656499994*kSq[5]-0.05962847939999439*kSq[4]-0.05333333333333333*kSq[3]-0.03849001794597505*kSq[2]-0.8888888888888888*epsilon[0]*rdx2Sq[1]+0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[5], globalIdxs[0], (-0.006147592613027645*kSq[7])+0.02697478829999747*kSq[5]+0.03336355394999686*kSq[4]+0.3111111111111111*epsilon[0]*rdx2Sq[1]-0.01924500897298752*kSq[1]+0.1888888888888889*epsilon[0]*rdx2Sq[0]-0.02222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[5], globalIdxs[1], 0.01721325931647741*kSq[6]-0.03975231959999626*kSq[5]-0.05678902799999467*kSq[4]+0.01333333333333333*kSq[3]-0.03849001794597505*kSq[2]-0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.4444444444444444*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[5], globalIdxs[2], 0.0234254740499978*kSq[5]+0.0234254740499978*kSq[4]-0.01333333333333333*kSq[3]+0.2555555555555555*epsilon[0]*rdx2Sq[1]+0.2555555555555555*epsilon[0]*rdx2Sq[0]-0.03333333333333333*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[5], globalIdxs[3], 0.0295084445425327*kSq[7]-0.03442651863295482*kSq[6]-0.063887656499994*kSq[5]-0.05962847939999439*kSq[4]+0.05333333333333333*kSq[3]-0.03849001794597505*kSq[2]-0.8888888888888888*epsilon[0]*rdx2Sq[1]+0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[5], globalIdxs[4], (-0.01721325931647741*kSq[7])-0.05678902799999467*kSq[5]-0.03975231959999626*kSq[4]+0.01333333333333333*kSq[3]-0.4444444444444444*epsilon[0]*rdx2Sq[1]+0.03849001794597505*kSq[1]-0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[5], globalIdxs[5], 0.04549218533640458*kSq[7]-0.04549218533640458*kSq[6]-0.0127775312999988*kSq[5]-0.0127775312999988*kSq[4]+0.04666666666666667*kSq[3]-0.03849001794597505*kSq[2]+0.5777777777777777*epsilon[0]*rdx2Sq[1]+0.03849001794597505*kSq[1]+0.5777777777777777*epsilon[0]*rdx2Sq[0]-0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[5], globalIdxs[6], 0.03442651863295482*kSq[7]-0.0295084445425327*kSq[6]-0.05962847939999439*kSq[5]-0.063887656499994*kSq[4]+0.05333333333333333*kSq[3]+0.06666666666666667*epsilon[0]*rdx2Sq[1]+0.03849001794597505*kSq[1]-0.8888888888888888*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[5], globalIdxs[7], 0.006147592613027645*kSq[6]+0.03336355394999686*kSq[5]+0.02697478829999747*kSq[4]+0.01924500897298752*kSq[2]+0.1888888888888889*epsilon[0]*rdx2Sq[1]+0.3111111111111111*epsilon[0]*rdx2Sq[0]-0.02222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[6], globalIdxs[0], (-0.01721325931647741*kSq[6])-0.03975231959999626*kSq[5]-0.05678902799999467*kSq[4]-0.01333333333333333*kSq[3]+0.03849001794597505*kSq[2]-0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.4444444444444444*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[6], globalIdxs[1], 0.07950463919999252*kSq[5]+0.1135780559999893*kSq[4]-0.5333333333333333*epsilon[0]*rdx2Sq[1]+0.8888888888888888*epsilon[0]*rdx2Sq[0]-0.1777777777777778*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[6], globalIdxs[2], (-0.01721325931647741*kSq[6])-0.03975231959999626*kSq[5]-0.05678902799999467*kSq[4]+0.01333333333333333*kSq[3]+0.03849001794597505*kSq[2]-0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.4444444444444444*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[6], globalIdxs[3], (-0.03442651863295482*kSq[7])+0.03442651863295482*kSq[6]+0.09938079899999068*kSq[5]+0.09938079899999068*kSq[4]+0.02666666666666666*kSq[3]-0.0769800358919501*kSq[2]+0.0769800358919501*kSq[1]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[6], globalIdxs[4], 0.03442651863295482*kSq[7]+0.03442651863295482*kSq[6]+0.09938079899999068*kSq[5]+0.09938079899999068*kSq[4]-0.02666666666666666*kSq[3]-0.0769800358919501*kSq[2]-0.0769800358919501*kSq[1]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[6], globalIdxs[5], 0.03442651863295482*kSq[7]-0.0295084445425327*kSq[6]-0.05962847939999439*kSq[5]-0.063887656499994*kSq[4]+0.05333333333333333*kSq[3]+0.06666666666666667*epsilon[0]*rdx2Sq[1]+0.03849001794597505*kSq[1]-0.8888888888888888*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[6], globalIdxs[6], 0.1967229636168847*kSq[6]-0.07950463919999252*kSq[5]+0.2271561119999787*kSq[4]-0.3079201435678004*kSq[2]+0.5333333333333333*epsilon[0]*rdx2Sq[1]+1.777777777777778*epsilon[0]*rdx2Sq[0]-0.3555555555555556*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[6], globalIdxs[7], (-0.03442651863295482*kSq[7])-0.0295084445425327*kSq[6]-0.05962847939999439*kSq[5]-0.063887656499994*kSq[4]-0.05333333333333333*kSq[3]+0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.03849001794597505*kSq[1]-0.8888888888888888*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[7], globalIdxs[0], 0.0234254740499978*kSq[5]+0.0234254740499978*kSq[4]+0.01333333333333333*kSq[3]+0.2555555555555555*epsilon[0]*rdx2Sq[1]+0.2555555555555555*epsilon[0]*rdx2Sq[0]-0.03333333333333333*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[7], globalIdxs[1], 0.01721325931647741*kSq[6]-0.03975231959999626*kSq[5]-0.05678902799999467*kSq[4]-0.01333333333333333*kSq[3]-0.03849001794597505*kSq[2]-0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.4444444444444444*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[7], globalIdxs[2], 0.006147592613027645*kSq[7]+0.02697478829999747*kSq[5]+0.03336355394999686*kSq[4]+0.3111111111111111*epsilon[0]*rdx2Sq[1]+0.01924500897298752*kSq[1]+0.1888888888888889*epsilon[0]*rdx2Sq[0]-0.02222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[7], globalIdxs[3], 0.01721325931647741*kSq[7]-0.05678902799999467*kSq[5]-0.03975231959999626*kSq[4]-0.01333333333333333*kSq[3]-0.4444444444444444*epsilon[0]*rdx2Sq[1]-0.03849001794597505*kSq[1]-0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[7], globalIdxs[4], (-0.0295084445425327*kSq[7])-0.03442651863295482*kSq[6]-0.063887656499994*kSq[5]-0.05962847939999439*kSq[4]-0.05333333333333333*kSq[3]-0.03849001794597505*kSq[2]-0.8888888888888888*epsilon[0]*rdx2Sq[1]+0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[7], globalIdxs[5], 0.006147592613027645*kSq[6]+0.03336355394999686*kSq[5]+0.02697478829999747*kSq[4]+0.01924500897298752*kSq[2]+0.1888888888888889*epsilon[0]*rdx2Sq[1]+0.3111111111111111*epsilon[0]*rdx2Sq[0]-0.02222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[7], globalIdxs[6], (-0.03442651863295482*kSq[7])-0.0295084445425327*kSq[6]-0.05962847939999439*kSq[5]-0.063887656499994*kSq[4]-0.05333333333333333*kSq[3]+0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.03849001794597505*kSq[1]-0.8888888888888888*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[7], globalIdxs[7], (-0.04549218533640458*kSq[7])-0.04549218533640458*kSq[6]-0.0127775312999988*kSq[5]-0.0127775312999988*kSq[4]-0.04666666666666667*kSq[3]-0.03849001794597505*kSq[2]+0.5777777777777777*epsilon[0]*rdx2Sq[1]-0.03849001794597505*kSq[1]+0.5777777777777777*epsilon[0]*rdx2Sq[0]-0.06666666666666667*kSq[0]);

}
void fem_poisson_lhs_stencil_consteps_2x_ser_p1_upx_neumannx_loy_dirichlety(const double *epsilon, const double *kSq, const double *dx, const double *bcVals, const long *globalIdxs, gkyl_mat_triples *tri) 
{ 
  // epsilon: permittivity.
  // kSq: wave number squared (factor multiplying phi).
  // dx: cell length in each direction.
  // bcVals[3]: values to impose as BCs, i.e. bcVals[0]*phi+bcVals[1]*d(phi)/dx=bcVals[2].
  // globalIdxs: global linear index of each basis function/node in current cell.
  // tri: triples object (i,j,val), i.e. contribute val to i,j element of the global matrix.

  double rdx2Sq[2];
  rdx2Sq[0] = 4.0/(dx[0]*dx[0]);
  rdx2Sq[1] = 4.0/(dx[1]*dx[1]);

  gkyl_mat_triples_insert(tri, globalIdxs[0], globalIdxs[0], 1.0);
  gkyl_mat_triples_insert(tri, globalIdxs[0], globalIdxs[1], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[0], globalIdxs[2], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[0], globalIdxs[3], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[1], globalIdxs[0], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[1], globalIdxs[1], 1.0);
  gkyl_mat_triples_insert(tri, globalIdxs[1], globalIdxs[2], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[1], globalIdxs[3], 0.0);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[0], (-0.3333333333333333*epsilon[0]*rdx2Sq[1])+0.09622504486493762*kSq[1]+0.1666666666666667*epsilon[0]*rdx2Sq[0]-0.1111111111111111*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[1], (-0.1666666666666667*epsilon[0]*rdx2Sq[1])-0.1666666666666667*epsilon[0]*rdx2Sq[0]-0.05555555555555555*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[2], 0.1666666666666667*kSq[3]-0.1924500897298752*kSq[2]+0.3333333333333333*epsilon[0]*rdx2Sq[1]+0.1924500897298752*kSq[1]+0.3333333333333333*epsilon[0]*rdx2Sq[0]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[3], (-0.09622504486493762*kSq[2])+0.1666666666666667*epsilon[0]*rdx2Sq[1]-0.3333333333333333*epsilon[0]*rdx2Sq[0]-0.1111111111111111*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[0], (-0.1666666666666667*epsilon[0]*rdx2Sq[1])-0.1666666666666667*epsilon[0]*rdx2Sq[0]-0.05555555555555555*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[1], (-0.3333333333333333*epsilon[0]*rdx2Sq[1])-0.09622504486493762*kSq[1]+0.1666666666666667*epsilon[0]*rdx2Sq[0]-0.1111111111111111*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[2], (-0.09622504486493762*kSq[2])+0.1666666666666667*epsilon[0]*rdx2Sq[1]-0.3333333333333333*epsilon[0]*rdx2Sq[0]-0.1111111111111111*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[3], (-0.1666666666666667*kSq[3])-0.1924500897298752*kSq[2]+0.3333333333333333*epsilon[0]*rdx2Sq[1]-0.1924500897298752*kSq[1]+0.3333333333333333*epsilon[0]*rdx2Sq[0]-0.2222222222222222*kSq[0]);

}
void fem_poisson_lhs_stencil_consteps_2x_ser_p2_upx_neumannx_loy_dirichlety(const double *epsilon, const double *kSq, const double *dx, const double *bcVals, const long *globalIdxs, gkyl_mat_triples *tri) 
{ 
  // epsilon: permittivity.
  // kSq: wave number squared (factor multiplying phi).
  // dx: cell length in each direction.
  // bcVals[3]: values to impose as BCs, i.e. bcVals[0]*phi+bcVals[1]*d(phi)/dx=bcVals[2].
  // globalIdxs: global linear index of each basis function/node in current cell.
  // tri: triples object (i,j,val), i.e. contribute val to i,j element of the global matrix.

  double rdx2Sq[2];
  rdx2Sq[0] = 4.0/(dx[0]*dx[0]);
  rdx2Sq[1] = 4.0/(dx[1]*dx[1]);

  gkyl_mat_triples_insert(tri, globalIdxs[0], globalIdxs[0], 1.0);
  gkyl_mat_triples_insert(tri, globalIdxs[0], globalIdxs[1], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[0], globalIdxs[2], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[0], globalIdxs[3], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[0], globalIdxs[4], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[0], globalIdxs[5], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[0], globalIdxs[6], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[0], globalIdxs[7], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[1], globalIdxs[0], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[1], globalIdxs[1], 1.0);
  gkyl_mat_triples_insert(tri, globalIdxs[1], globalIdxs[2], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[1], globalIdxs[3], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[1], globalIdxs[4], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[1], globalIdxs[5], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[1], globalIdxs[6], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[1], globalIdxs[7], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[2], globalIdxs[0], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[2], globalIdxs[1], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[2], globalIdxs[2], 1.0);
  gkyl_mat_triples_insert(tri, globalIdxs[2], globalIdxs[3], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[2], globalIdxs[4], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[2], globalIdxs[5], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[2], globalIdxs[6], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[2], globalIdxs[7], 0.0);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[0], 0.0295084445425327*kSq[7]+0.03442651863295482*kSq[6]-0.063887656499994*kSq[5]-0.05962847939999439*kSq[4]-0.05333333333333333*kSq[3]+0.03849001794597505*kSq[2]-0.8888888888888888*epsilon[0]*rdx2Sq[1]+0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[1], (-0.03442651863295482*kSq[7])-0.03442651863295482*kSq[6]+0.09938079899999068*kSq[5]+0.09938079899999068*kSq[4]-0.02666666666666666*kSq[3]+0.0769800358919501*kSq[2]+0.0769800358919501*kSq[1]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[2], 0.01721325931647741*kSq[7]-0.05678902799999467*kSq[5]-0.03975231959999626*kSq[4]+0.01333333333333333*kSq[3]-0.4444444444444444*epsilon[0]*rdx2Sq[1]-0.03849001794597505*kSq[1]-0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[3], (-0.1967229636168847*kSq[7])+0.2271561119999787*kSq[5]-0.07950463919999252*kSq[4]+1.777777777777778*epsilon[0]*rdx2Sq[1]+0.3079201435678004*kSq[1]+0.5333333333333333*epsilon[0]*rdx2Sq[0]-0.3555555555555556*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[4], 0.1135780559999893*kSq[5]+0.07950463919999252*kSq[4]+0.8888888888888888*epsilon[0]*rdx2Sq[1]-0.5333333333333333*epsilon[0]*rdx2Sq[0]-0.1777777777777778*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[5], 0.0295084445425327*kSq[7]-0.03442651863295482*kSq[6]-0.063887656499994*kSq[5]-0.05962847939999439*kSq[4]+0.05333333333333333*kSq[3]-0.03849001794597505*kSq[2]-0.8888888888888888*epsilon[0]*rdx2Sq[1]+0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[6], (-0.03442651863295482*kSq[7])+0.03442651863295482*kSq[6]+0.09938079899999068*kSq[5]+0.09938079899999068*kSq[4]+0.02666666666666666*kSq[3]-0.0769800358919501*kSq[2]+0.0769800358919501*kSq[1]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[7], 0.01721325931647741*kSq[7]-0.05678902799999467*kSq[5]-0.03975231959999626*kSq[4]-0.01333333333333333*kSq[3]-0.4444444444444444*epsilon[0]*rdx2Sq[1]-0.03849001794597505*kSq[1]-0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[4], globalIdxs[0], (-0.01721325931647741*kSq[7])-0.05678902799999467*kSq[5]-0.03975231959999626*kSq[4]-0.01333333333333333*kSq[3]-0.4444444444444444*epsilon[0]*rdx2Sq[1]+0.03849001794597505*kSq[1]-0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[4], globalIdxs[1], 0.03442651863295482*kSq[7]-0.03442651863295482*kSq[6]+0.09938079899999068*kSq[5]+0.09938079899999068*kSq[4]+0.02666666666666666*kSq[3]+0.0769800358919501*kSq[2]-0.0769800358919501*kSq[1]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[4], globalIdxs[2], (-0.0295084445425327*kSq[7])+0.03442651863295482*kSq[6]-0.063887656499994*kSq[5]-0.05962847939999439*kSq[4]+0.05333333333333333*kSq[3]+0.03849001794597505*kSq[2]-0.8888888888888888*epsilon[0]*rdx2Sq[1]+0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[4], globalIdxs[3], 0.1135780559999893*kSq[5]+0.07950463919999252*kSq[4]+0.8888888888888888*epsilon[0]*rdx2Sq[1]-0.5333333333333333*epsilon[0]*rdx2Sq[0]-0.1777777777777778*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[4], globalIdxs[4], 0.1967229636168847*kSq[7]+0.2271561119999787*kSq[5]-0.07950463919999252*kSq[4]+1.777777777777778*epsilon[0]*rdx2Sq[1]-0.3079201435678004*kSq[1]+0.5333333333333333*epsilon[0]*rdx2Sq[0]-0.3555555555555556*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[4], globalIdxs[5], (-0.01721325931647741*kSq[7])-0.05678902799999467*kSq[5]-0.03975231959999626*kSq[4]+0.01333333333333333*kSq[3]-0.4444444444444444*epsilon[0]*rdx2Sq[1]+0.03849001794597505*kSq[1]-0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[4], globalIdxs[6], 0.03442651863295482*kSq[7]+0.03442651863295482*kSq[6]+0.09938079899999068*kSq[5]+0.09938079899999068*kSq[4]-0.02666666666666666*kSq[3]-0.0769800358919501*kSq[2]-0.0769800358919501*kSq[1]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[4], globalIdxs[7], (-0.0295084445425327*kSq[7])-0.03442651863295482*kSq[6]-0.063887656499994*kSq[5]-0.05962847939999439*kSq[4]-0.05333333333333333*kSq[3]-0.03849001794597505*kSq[2]-0.8888888888888888*epsilon[0]*rdx2Sq[1]+0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[5], globalIdxs[0], (-0.006147592613027645*kSq[7])+0.02697478829999747*kSq[5]+0.03336355394999686*kSq[4]+0.3111111111111111*epsilon[0]*rdx2Sq[1]-0.01924500897298752*kSq[1]+0.1888888888888889*epsilon[0]*rdx2Sq[0]-0.02222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[5], globalIdxs[1], 0.01721325931647741*kSq[6]-0.03975231959999626*kSq[5]-0.05678902799999467*kSq[4]+0.01333333333333333*kSq[3]-0.03849001794597505*kSq[2]-0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.4444444444444444*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[5], globalIdxs[2], 0.0234254740499978*kSq[5]+0.0234254740499978*kSq[4]-0.01333333333333333*kSq[3]+0.2555555555555555*epsilon[0]*rdx2Sq[1]+0.2555555555555555*epsilon[0]*rdx2Sq[0]-0.03333333333333333*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[5], globalIdxs[3], 0.0295084445425327*kSq[7]-0.03442651863295482*kSq[6]-0.063887656499994*kSq[5]-0.05962847939999439*kSq[4]+0.05333333333333333*kSq[3]-0.03849001794597505*kSq[2]-0.8888888888888888*epsilon[0]*rdx2Sq[1]+0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[5], globalIdxs[4], (-0.01721325931647741*kSq[7])-0.05678902799999467*kSq[5]-0.03975231959999626*kSq[4]+0.01333333333333333*kSq[3]-0.4444444444444444*epsilon[0]*rdx2Sq[1]+0.03849001794597505*kSq[1]-0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[5], globalIdxs[5], 0.04549218533640458*kSq[7]-0.04549218533640458*kSq[6]-0.0127775312999988*kSq[5]-0.0127775312999988*kSq[4]+0.04666666666666667*kSq[3]-0.03849001794597505*kSq[2]+0.5777777777777777*epsilon[0]*rdx2Sq[1]+0.03849001794597505*kSq[1]+0.5777777777777777*epsilon[0]*rdx2Sq[0]-0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[5], globalIdxs[6], 0.03442651863295482*kSq[7]-0.0295084445425327*kSq[6]-0.05962847939999439*kSq[5]-0.063887656499994*kSq[4]+0.05333333333333333*kSq[3]+0.06666666666666667*epsilon[0]*rdx2Sq[1]+0.03849001794597505*kSq[1]-0.8888888888888888*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[5], globalIdxs[7], 0.006147592613027645*kSq[6]+0.03336355394999686*kSq[5]+0.02697478829999747*kSq[4]+0.01924500897298752*kSq[2]+0.1888888888888889*epsilon[0]*rdx2Sq[1]+0.3111111111111111*epsilon[0]*rdx2Sq[0]-0.02222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[6], globalIdxs[0], (-0.01721325931647741*kSq[6])-0.03975231959999626*kSq[5]-0.05678902799999467*kSq[4]-0.01333333333333333*kSq[3]+0.03849001794597505*kSq[2]-0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.4444444444444444*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[6], globalIdxs[1], 0.07950463919999252*kSq[5]+0.1135780559999893*kSq[4]-0.5333333333333333*epsilon[0]*rdx2Sq[1]+0.8888888888888888*epsilon[0]*rdx2Sq[0]-0.1777777777777778*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[6], globalIdxs[2], (-0.01721325931647741*kSq[6])-0.03975231959999626*kSq[5]-0.05678902799999467*kSq[4]+0.01333333333333333*kSq[3]+0.03849001794597505*kSq[2]-0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.4444444444444444*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[6], globalIdxs[3], (-0.03442651863295482*kSq[7])+0.03442651863295482*kSq[6]+0.09938079899999068*kSq[5]+0.09938079899999068*kSq[4]+0.02666666666666666*kSq[3]-0.0769800358919501*kSq[2]+0.0769800358919501*kSq[1]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[6], globalIdxs[4], 0.03442651863295482*kSq[7]+0.03442651863295482*kSq[6]+0.09938079899999068*kSq[5]+0.09938079899999068*kSq[4]-0.02666666666666666*kSq[3]-0.0769800358919501*kSq[2]-0.0769800358919501*kSq[1]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[6], globalIdxs[5], 0.03442651863295482*kSq[7]-0.0295084445425327*kSq[6]-0.05962847939999439*kSq[5]-0.063887656499994*kSq[4]+0.05333333333333333*kSq[3]+0.06666666666666667*epsilon[0]*rdx2Sq[1]+0.03849001794597505*kSq[1]-0.8888888888888888*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[6], globalIdxs[6], 0.1967229636168847*kSq[6]-0.07950463919999252*kSq[5]+0.2271561119999787*kSq[4]-0.3079201435678004*kSq[2]+0.5333333333333333*epsilon[0]*rdx2Sq[1]+1.777777777777778*epsilon[0]*rdx2Sq[0]-0.3555555555555556*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[6], globalIdxs[7], (-0.03442651863295482*kSq[7])-0.0295084445425327*kSq[6]-0.05962847939999439*kSq[5]-0.063887656499994*kSq[4]-0.05333333333333333*kSq[3]+0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.03849001794597505*kSq[1]-0.8888888888888888*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[7], globalIdxs[0], 0.0234254740499978*kSq[5]+0.0234254740499978*kSq[4]+0.01333333333333333*kSq[3]+0.2555555555555555*epsilon[0]*rdx2Sq[1]+0.2555555555555555*epsilon[0]*rdx2Sq[0]-0.03333333333333333*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[7], globalIdxs[1], 0.01721325931647741*kSq[6]-0.03975231959999626*kSq[5]-0.05678902799999467*kSq[4]-0.01333333333333333*kSq[3]-0.03849001794597505*kSq[2]-0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.4444444444444444*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[7], globalIdxs[2], 0.006147592613027645*kSq[7]+0.02697478829999747*kSq[5]+0.03336355394999686*kSq[4]+0.3111111111111111*epsilon[0]*rdx2Sq[1]+0.01924500897298752*kSq[1]+0.1888888888888889*epsilon[0]*rdx2Sq[0]-0.02222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[7], globalIdxs[3], 0.01721325931647741*kSq[7]-0.05678902799999467*kSq[5]-0.03975231959999626*kSq[4]-0.01333333333333333*kSq[3]-0.4444444444444444*epsilon[0]*rdx2Sq[1]-0.03849001794597505*kSq[1]-0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[7], globalIdxs[4], (-0.0295084445425327*kSq[7])-0.03442651863295482*kSq[6]-0.063887656499994*kSq[5]-0.05962847939999439*kSq[4]-0.05333333333333333*kSq[3]-0.03849001794597505*kSq[2]-0.8888888888888888*epsilon[0]*rdx2Sq[1]+0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[7], globalIdxs[5], 0.006147592613027645*kSq[6]+0.03336355394999686*kSq[5]+0.02697478829999747*kSq[4]+0.01924500897298752*kSq[2]+0.1888888888888889*epsilon[0]*rdx2Sq[1]+0.3111111111111111*epsilon[0]*rdx2Sq[0]-0.02222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[7], globalIdxs[6], (-0.03442651863295482*kSq[7])-0.0295084445425327*kSq[6]-0.05962847939999439*kSq[5]-0.063887656499994*kSq[4]-0.05333333333333333*kSq[3]+0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.03849001794597505*kSq[1]-0.8888888888888888*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[7], globalIdxs[7], (-0.04549218533640458*kSq[7])-0.04549218533640458*kSq[6]-0.0127775312999988*kSq[5]-0.0127775312999988*kSq[4]-0.04666666666666667*kSq[3]-0.03849001794597505*kSq[2]+0.5777777777777777*epsilon[0]*rdx2Sq[1]-0.03849001794597505*kSq[1]+0.5777777777777777*epsilon[0]*rdx2Sq[0]-0.06666666666666667*kSq[0]);

}
void fem_poisson_lhs_stencil_consteps_2x_ser_p1_upx_neumannx_loy_neumanny(const double *epsilon, const double *kSq, const double *dx, const double *bcVals, const long *globalIdxs, gkyl_mat_triples *tri) 
{ 
  // epsilon: permittivity.
  // kSq: wave number squared (factor multiplying phi).
  // dx: cell length in each direction.
  // bcVals[3]: values to impose as BCs, i.e. bcVals[0]*phi+bcVals[1]*d(phi)/dx=bcVals[2].
  // globalIdxs: global linear index of each basis function/node in current cell.
  // tri: triples object (i,j,val), i.e. contribute val to i,j element of the global matrix.

  double rdx2Sq[2];
  rdx2Sq[0] = 4.0/(dx[0]*dx[0]);
  rdx2Sq[1] = 4.0/(dx[1]*dx[1]);

  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[0], (-0.1666666666666667*kSq[3])+0.1924500897298752*kSq[2]+0.3333333333333333*epsilon[0]*rdx2Sq[1]+0.1924500897298752*kSq[1]+0.3333333333333333*epsilon[0]*rdx2Sq[0]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[1], 0.09622504486493762*kSq[2]+0.1666666666666667*epsilon[0]*rdx2Sq[1]-0.3333333333333333*epsilon[0]*rdx2Sq[0]-0.1111111111111111*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[2], (-0.3333333333333333*epsilon[0]*rdx2Sq[1])+0.09622504486493762*kSq[1]+0.1666666666666667*epsilon[0]*rdx2Sq[0]-0.1111111111111111*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[3], (-0.1666666666666667*epsilon[0]*rdx2Sq[1])-0.1666666666666667*epsilon[0]*rdx2Sq[0]-0.05555555555555555*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[0], 0.09622504486493762*kSq[2]+0.1666666666666667*epsilon[0]*rdx2Sq[1]-0.3333333333333333*epsilon[0]*rdx2Sq[0]-0.1111111111111111*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[1], 0.1666666666666667*kSq[3]+0.1924500897298752*kSq[2]+0.3333333333333333*epsilon[0]*rdx2Sq[1]-0.1924500897298752*kSq[1]+0.3333333333333333*epsilon[0]*rdx2Sq[0]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[2], (-0.1666666666666667*epsilon[0]*rdx2Sq[1])-0.1666666666666667*epsilon[0]*rdx2Sq[0]-0.05555555555555555*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[3], (-0.3333333333333333*epsilon[0]*rdx2Sq[1])-0.09622504486493762*kSq[1]+0.1666666666666667*epsilon[0]*rdx2Sq[0]-0.1111111111111111*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[0], (-0.3333333333333333*epsilon[0]*rdx2Sq[1])+0.09622504486493762*kSq[1]+0.1666666666666667*epsilon[0]*rdx2Sq[0]-0.1111111111111111*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[1], (-0.1666666666666667*epsilon[0]*rdx2Sq[1])-0.1666666666666667*epsilon[0]*rdx2Sq[0]-0.05555555555555555*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[2], 0.1666666666666667*kSq[3]-0.1924500897298752*kSq[2]+0.3333333333333333*epsilon[0]*rdx2Sq[1]+0.1924500897298752*kSq[1]+0.3333333333333333*epsilon[0]*rdx2Sq[0]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[3], (-0.09622504486493762*kSq[2])+0.1666666666666667*epsilon[0]*rdx2Sq[1]-0.3333333333333333*epsilon[0]*rdx2Sq[0]-0.1111111111111111*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[0], (-0.1666666666666667*epsilon[0]*rdx2Sq[1])-0.1666666666666667*epsilon[0]*rdx2Sq[0]-0.05555555555555555*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[1], (-0.3333333333333333*epsilon[0]*rdx2Sq[1])-0.09622504486493762*kSq[1]+0.1666666666666667*epsilon[0]*rdx2Sq[0]-0.1111111111111111*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[2], (-0.09622504486493762*kSq[2])+0.1666666666666667*epsilon[0]*rdx2Sq[1]-0.3333333333333333*epsilon[0]*rdx2Sq[0]-0.1111111111111111*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[3], (-0.1666666666666667*kSq[3])-0.1924500897298752*kSq[2]+0.3333333333333333*epsilon[0]*rdx2Sq[1]-0.1924500897298752*kSq[1]+0.3333333333333333*epsilon[0]*rdx2Sq[0]-0.2222222222222222*kSq[0]);

}
void fem_poisson_lhs_stencil_consteps_2x_ser_p2_upx_neumannx_loy_neumanny(const double *epsilon, const double *kSq, const double *dx, const double *bcVals, const long *globalIdxs, gkyl_mat_triples *tri) 
{ 
  // epsilon: permittivity.
  // kSq: wave number squared (factor multiplying phi).
  // dx: cell length in each direction.
  // bcVals[3]: values to impose as BCs, i.e. bcVals[0]*phi+bcVals[1]*d(phi)/dx=bcVals[2].
  // globalIdxs: global linear index of each basis function/node in current cell.
  // tri: triples object (i,j,val), i.e. contribute val to i,j element of the global matrix.

  double rdx2Sq[2];
  rdx2Sq[0] = 4.0/(dx[0]*dx[0]);
  rdx2Sq[1] = 4.0/(dx[1]*dx[1]);

  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[0], 0.04549218533640458*kSq[7]+0.04549218533640458*kSq[6]-0.0127775312999988*kSq[5]-0.0127775312999988*kSq[4]-0.04666666666666667*kSq[3]+0.03849001794597505*kSq[2]+0.5777777777777777*epsilon[0]*rdx2Sq[1]+0.03849001794597505*kSq[1]+0.5777777777777777*epsilon[0]*rdx2Sq[0]-0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[1], 0.03442651863295482*kSq[7]+0.0295084445425327*kSq[6]-0.05962847939999439*kSq[5]-0.063887656499994*kSq[4]-0.05333333333333333*kSq[3]+0.06666666666666667*epsilon[0]*rdx2Sq[1]+0.03849001794597505*kSq[1]-0.8888888888888888*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[2], (-0.006147592613027645*kSq[6])+0.03336355394999686*kSq[5]+0.02697478829999747*kSq[4]-0.01924500897298752*kSq[2]+0.1888888888888889*epsilon[0]*rdx2Sq[1]+0.3111111111111111*epsilon[0]*rdx2Sq[0]-0.02222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[3], 0.0295084445425327*kSq[7]+0.03442651863295482*kSq[6]-0.063887656499994*kSq[5]-0.05962847939999439*kSq[4]-0.05333333333333333*kSq[3]+0.03849001794597505*kSq[2]-0.8888888888888888*epsilon[0]*rdx2Sq[1]+0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[4], (-0.01721325931647741*kSq[7])-0.05678902799999467*kSq[5]-0.03975231959999626*kSq[4]-0.01333333333333333*kSq[3]-0.4444444444444444*epsilon[0]*rdx2Sq[1]+0.03849001794597505*kSq[1]-0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[5], (-0.006147592613027645*kSq[7])+0.02697478829999747*kSq[5]+0.03336355394999686*kSq[4]+0.3111111111111111*epsilon[0]*rdx2Sq[1]-0.01924500897298752*kSq[1]+0.1888888888888889*epsilon[0]*rdx2Sq[0]-0.02222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[6], (-0.01721325931647741*kSq[6])-0.03975231959999626*kSq[5]-0.05678902799999467*kSq[4]-0.01333333333333333*kSq[3]+0.03849001794597505*kSq[2]-0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.4444444444444444*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[7], 0.0234254740499978*kSq[5]+0.0234254740499978*kSq[4]+0.01333333333333333*kSq[3]+0.2555555555555555*epsilon[0]*rdx2Sq[1]+0.2555555555555555*epsilon[0]*rdx2Sq[0]-0.03333333333333333*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[0], 0.03442651863295482*kSq[7]+0.0295084445425327*kSq[6]-0.05962847939999439*kSq[5]-0.063887656499994*kSq[4]-0.05333333333333333*kSq[3]+0.06666666666666667*epsilon[0]*rdx2Sq[1]+0.03849001794597505*kSq[1]-0.8888888888888888*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[1], (-0.1967229636168847*kSq[6])-0.07950463919999252*kSq[5]+0.2271561119999787*kSq[4]+0.3079201435678004*kSq[2]+0.5333333333333333*epsilon[0]*rdx2Sq[1]+1.777777777777778*epsilon[0]*rdx2Sq[0]-0.3555555555555556*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[2], (-0.03442651863295482*kSq[7])+0.0295084445425327*kSq[6]-0.05962847939999439*kSq[5]-0.063887656499994*kSq[4]+0.05333333333333333*kSq[3]+0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.03849001794597505*kSq[1]-0.8888888888888888*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[3], (-0.03442651863295482*kSq[7])-0.03442651863295482*kSq[6]+0.09938079899999068*kSq[5]+0.09938079899999068*kSq[4]-0.02666666666666666*kSq[3]+0.0769800358919501*kSq[2]+0.0769800358919501*kSq[1]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[4], 0.03442651863295482*kSq[7]-0.03442651863295482*kSq[6]+0.09938079899999068*kSq[5]+0.09938079899999068*kSq[4]+0.02666666666666666*kSq[3]+0.0769800358919501*kSq[2]-0.0769800358919501*kSq[1]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[5], 0.01721325931647741*kSq[6]-0.03975231959999626*kSq[5]-0.05678902799999467*kSq[4]+0.01333333333333333*kSq[3]-0.03849001794597505*kSq[2]-0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.4444444444444444*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[6], 0.07950463919999252*kSq[5]+0.1135780559999893*kSq[4]-0.5333333333333333*epsilon[0]*rdx2Sq[1]+0.8888888888888888*epsilon[0]*rdx2Sq[0]-0.1777777777777778*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[7], 0.01721325931647741*kSq[6]-0.03975231959999626*kSq[5]-0.05678902799999467*kSq[4]-0.01333333333333333*kSq[3]-0.03849001794597505*kSq[2]-0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.4444444444444444*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[0], (-0.006147592613027645*kSq[6])+0.03336355394999686*kSq[5]+0.02697478829999747*kSq[4]-0.01924500897298752*kSq[2]+0.1888888888888889*epsilon[0]*rdx2Sq[1]+0.3111111111111111*epsilon[0]*rdx2Sq[0]-0.02222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[1], (-0.03442651863295482*kSq[7])+0.0295084445425327*kSq[6]-0.05962847939999439*kSq[5]-0.063887656499994*kSq[4]+0.05333333333333333*kSq[3]+0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.03849001794597505*kSq[1]-0.8888888888888888*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[2], (-0.04549218533640458*kSq[7])+0.04549218533640458*kSq[6]-0.0127775312999988*kSq[5]-0.0127775312999988*kSq[4]+0.04666666666666667*kSq[3]+0.03849001794597505*kSq[2]+0.5777777777777777*epsilon[0]*rdx2Sq[1]-0.03849001794597505*kSq[1]+0.5777777777777777*epsilon[0]*rdx2Sq[0]-0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[3], 0.01721325931647741*kSq[7]-0.05678902799999467*kSq[5]-0.03975231959999626*kSq[4]+0.01333333333333333*kSq[3]-0.4444444444444444*epsilon[0]*rdx2Sq[1]-0.03849001794597505*kSq[1]-0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[4], (-0.0295084445425327*kSq[7])+0.03442651863295482*kSq[6]-0.063887656499994*kSq[5]-0.05962847939999439*kSq[4]+0.05333333333333333*kSq[3]+0.03849001794597505*kSq[2]-0.8888888888888888*epsilon[0]*rdx2Sq[1]+0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[5], 0.0234254740499978*kSq[5]+0.0234254740499978*kSq[4]-0.01333333333333333*kSq[3]+0.2555555555555555*epsilon[0]*rdx2Sq[1]+0.2555555555555555*epsilon[0]*rdx2Sq[0]-0.03333333333333333*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[6], (-0.01721325931647741*kSq[6])-0.03975231959999626*kSq[5]-0.05678902799999467*kSq[4]+0.01333333333333333*kSq[3]+0.03849001794597505*kSq[2]-0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.4444444444444444*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[7], 0.006147592613027645*kSq[7]+0.02697478829999747*kSq[5]+0.03336355394999686*kSq[4]+0.3111111111111111*epsilon[0]*rdx2Sq[1]+0.01924500897298752*kSq[1]+0.1888888888888889*epsilon[0]*rdx2Sq[0]-0.02222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[0], 0.0295084445425327*kSq[7]+0.03442651863295482*kSq[6]-0.063887656499994*kSq[5]-0.05962847939999439*kSq[4]-0.05333333333333333*kSq[3]+0.03849001794597505*kSq[2]-0.8888888888888888*epsilon[0]*rdx2Sq[1]+0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[1], (-0.03442651863295482*kSq[7])-0.03442651863295482*kSq[6]+0.09938079899999068*kSq[5]+0.09938079899999068*kSq[4]-0.02666666666666666*kSq[3]+0.0769800358919501*kSq[2]+0.0769800358919501*kSq[1]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[2], 0.01721325931647741*kSq[7]-0.05678902799999467*kSq[5]-0.03975231959999626*kSq[4]+0.01333333333333333*kSq[3]-0.4444444444444444*epsilon[0]*rdx2Sq[1]-0.03849001794597505*kSq[1]-0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[3], (-0.1967229636168847*kSq[7])+0.2271561119999787*kSq[5]-0.07950463919999252*kSq[4]+1.777777777777778*epsilon[0]*rdx2Sq[1]+0.3079201435678004*kSq[1]+0.5333333333333333*epsilon[0]*rdx2Sq[0]-0.3555555555555556*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[4], 0.1135780559999893*kSq[5]+0.07950463919999252*kSq[4]+0.8888888888888888*epsilon[0]*rdx2Sq[1]-0.5333333333333333*epsilon[0]*rdx2Sq[0]-0.1777777777777778*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[5], 0.0295084445425327*kSq[7]-0.03442651863295482*kSq[6]-0.063887656499994*kSq[5]-0.05962847939999439*kSq[4]+0.05333333333333333*kSq[3]-0.03849001794597505*kSq[2]-0.8888888888888888*epsilon[0]*rdx2Sq[1]+0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[6], (-0.03442651863295482*kSq[7])+0.03442651863295482*kSq[6]+0.09938079899999068*kSq[5]+0.09938079899999068*kSq[4]+0.02666666666666666*kSq[3]-0.0769800358919501*kSq[2]+0.0769800358919501*kSq[1]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[7], 0.01721325931647741*kSq[7]-0.05678902799999467*kSq[5]-0.03975231959999626*kSq[4]-0.01333333333333333*kSq[3]-0.4444444444444444*epsilon[0]*rdx2Sq[1]-0.03849001794597505*kSq[1]-0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[4], globalIdxs[0], (-0.01721325931647741*kSq[7])-0.05678902799999467*kSq[5]-0.03975231959999626*kSq[4]-0.01333333333333333*kSq[3]-0.4444444444444444*epsilon[0]*rdx2Sq[1]+0.03849001794597505*kSq[1]-0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[4], globalIdxs[1], 0.03442651863295482*kSq[7]-0.03442651863295482*kSq[6]+0.09938079899999068*kSq[5]+0.09938079899999068*kSq[4]+0.02666666666666666*kSq[3]+0.0769800358919501*kSq[2]-0.0769800358919501*kSq[1]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[4], globalIdxs[2], (-0.0295084445425327*kSq[7])+0.03442651863295482*kSq[6]-0.063887656499994*kSq[5]-0.05962847939999439*kSq[4]+0.05333333333333333*kSq[3]+0.03849001794597505*kSq[2]-0.8888888888888888*epsilon[0]*rdx2Sq[1]+0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[4], globalIdxs[3], 0.1135780559999893*kSq[5]+0.07950463919999252*kSq[4]+0.8888888888888888*epsilon[0]*rdx2Sq[1]-0.5333333333333333*epsilon[0]*rdx2Sq[0]-0.1777777777777778*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[4], globalIdxs[4], 0.1967229636168847*kSq[7]+0.2271561119999787*kSq[5]-0.07950463919999252*kSq[4]+1.777777777777778*epsilon[0]*rdx2Sq[1]-0.3079201435678004*kSq[1]+0.5333333333333333*epsilon[0]*rdx2Sq[0]-0.3555555555555556*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[4], globalIdxs[5], (-0.01721325931647741*kSq[7])-0.05678902799999467*kSq[5]-0.03975231959999626*kSq[4]+0.01333333333333333*kSq[3]-0.4444444444444444*epsilon[0]*rdx2Sq[1]+0.03849001794597505*kSq[1]-0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[4], globalIdxs[6], 0.03442651863295482*kSq[7]+0.03442651863295482*kSq[6]+0.09938079899999068*kSq[5]+0.09938079899999068*kSq[4]-0.02666666666666666*kSq[3]-0.0769800358919501*kSq[2]-0.0769800358919501*kSq[1]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[4], globalIdxs[7], (-0.0295084445425327*kSq[7])-0.03442651863295482*kSq[6]-0.063887656499994*kSq[5]-0.05962847939999439*kSq[4]-0.05333333333333333*kSq[3]-0.03849001794597505*kSq[2]-0.8888888888888888*epsilon[0]*rdx2Sq[1]+0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[5], globalIdxs[0], (-0.006147592613027645*kSq[7])+0.02697478829999747*kSq[5]+0.03336355394999686*kSq[4]+0.3111111111111111*epsilon[0]*rdx2Sq[1]-0.01924500897298752*kSq[1]+0.1888888888888889*epsilon[0]*rdx2Sq[0]-0.02222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[5], globalIdxs[1], 0.01721325931647741*kSq[6]-0.03975231959999626*kSq[5]-0.05678902799999467*kSq[4]+0.01333333333333333*kSq[3]-0.03849001794597505*kSq[2]-0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.4444444444444444*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[5], globalIdxs[2], 0.0234254740499978*kSq[5]+0.0234254740499978*kSq[4]-0.01333333333333333*kSq[3]+0.2555555555555555*epsilon[0]*rdx2Sq[1]+0.2555555555555555*epsilon[0]*rdx2Sq[0]-0.03333333333333333*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[5], globalIdxs[3], 0.0295084445425327*kSq[7]-0.03442651863295482*kSq[6]-0.063887656499994*kSq[5]-0.05962847939999439*kSq[4]+0.05333333333333333*kSq[3]-0.03849001794597505*kSq[2]-0.8888888888888888*epsilon[0]*rdx2Sq[1]+0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[5], globalIdxs[4], (-0.01721325931647741*kSq[7])-0.05678902799999467*kSq[5]-0.03975231959999626*kSq[4]+0.01333333333333333*kSq[3]-0.4444444444444444*epsilon[0]*rdx2Sq[1]+0.03849001794597505*kSq[1]-0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[5], globalIdxs[5], 0.04549218533640458*kSq[7]-0.04549218533640458*kSq[6]-0.0127775312999988*kSq[5]-0.0127775312999988*kSq[4]+0.04666666666666667*kSq[3]-0.03849001794597505*kSq[2]+0.5777777777777777*epsilon[0]*rdx2Sq[1]+0.03849001794597505*kSq[1]+0.5777777777777777*epsilon[0]*rdx2Sq[0]-0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[5], globalIdxs[6], 0.03442651863295482*kSq[7]-0.0295084445425327*kSq[6]-0.05962847939999439*kSq[5]-0.063887656499994*kSq[4]+0.05333333333333333*kSq[3]+0.06666666666666667*epsilon[0]*rdx2Sq[1]+0.03849001794597505*kSq[1]-0.8888888888888888*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[5], globalIdxs[7], 0.006147592613027645*kSq[6]+0.03336355394999686*kSq[5]+0.02697478829999747*kSq[4]+0.01924500897298752*kSq[2]+0.1888888888888889*epsilon[0]*rdx2Sq[1]+0.3111111111111111*epsilon[0]*rdx2Sq[0]-0.02222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[6], globalIdxs[0], (-0.01721325931647741*kSq[6])-0.03975231959999626*kSq[5]-0.05678902799999467*kSq[4]-0.01333333333333333*kSq[3]+0.03849001794597505*kSq[2]-0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.4444444444444444*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[6], globalIdxs[1], 0.07950463919999252*kSq[5]+0.1135780559999893*kSq[4]-0.5333333333333333*epsilon[0]*rdx2Sq[1]+0.8888888888888888*epsilon[0]*rdx2Sq[0]-0.1777777777777778*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[6], globalIdxs[2], (-0.01721325931647741*kSq[6])-0.03975231959999626*kSq[5]-0.05678902799999467*kSq[4]+0.01333333333333333*kSq[3]+0.03849001794597505*kSq[2]-0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.4444444444444444*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[6], globalIdxs[3], (-0.03442651863295482*kSq[7])+0.03442651863295482*kSq[6]+0.09938079899999068*kSq[5]+0.09938079899999068*kSq[4]+0.02666666666666666*kSq[3]-0.0769800358919501*kSq[2]+0.0769800358919501*kSq[1]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[6], globalIdxs[4], 0.03442651863295482*kSq[7]+0.03442651863295482*kSq[6]+0.09938079899999068*kSq[5]+0.09938079899999068*kSq[4]-0.02666666666666666*kSq[3]-0.0769800358919501*kSq[2]-0.0769800358919501*kSq[1]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[6], globalIdxs[5], 0.03442651863295482*kSq[7]-0.0295084445425327*kSq[6]-0.05962847939999439*kSq[5]-0.063887656499994*kSq[4]+0.05333333333333333*kSq[3]+0.06666666666666667*epsilon[0]*rdx2Sq[1]+0.03849001794597505*kSq[1]-0.8888888888888888*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[6], globalIdxs[6], 0.1967229636168847*kSq[6]-0.07950463919999252*kSq[5]+0.2271561119999787*kSq[4]-0.3079201435678004*kSq[2]+0.5333333333333333*epsilon[0]*rdx2Sq[1]+1.777777777777778*epsilon[0]*rdx2Sq[0]-0.3555555555555556*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[6], globalIdxs[7], (-0.03442651863295482*kSq[7])-0.0295084445425327*kSq[6]-0.05962847939999439*kSq[5]-0.063887656499994*kSq[4]-0.05333333333333333*kSq[3]+0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.03849001794597505*kSq[1]-0.8888888888888888*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[7], globalIdxs[0], 0.0234254740499978*kSq[5]+0.0234254740499978*kSq[4]+0.01333333333333333*kSq[3]+0.2555555555555555*epsilon[0]*rdx2Sq[1]+0.2555555555555555*epsilon[0]*rdx2Sq[0]-0.03333333333333333*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[7], globalIdxs[1], 0.01721325931647741*kSq[6]-0.03975231959999626*kSq[5]-0.05678902799999467*kSq[4]-0.01333333333333333*kSq[3]-0.03849001794597505*kSq[2]-0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.4444444444444444*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[7], globalIdxs[2], 0.006147592613027645*kSq[7]+0.02697478829999747*kSq[5]+0.03336355394999686*kSq[4]+0.3111111111111111*epsilon[0]*rdx2Sq[1]+0.01924500897298752*kSq[1]+0.1888888888888889*epsilon[0]*rdx2Sq[0]-0.02222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[7], globalIdxs[3], 0.01721325931647741*kSq[7]-0.05678902799999467*kSq[5]-0.03975231959999626*kSq[4]-0.01333333333333333*kSq[3]-0.4444444444444444*epsilon[0]*rdx2Sq[1]-0.03849001794597505*kSq[1]-0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[7], globalIdxs[4], (-0.0295084445425327*kSq[7])-0.03442651863295482*kSq[6]-0.063887656499994*kSq[5]-0.05962847939999439*kSq[4]-0.05333333333333333*kSq[3]-0.03849001794597505*kSq[2]-0.8888888888888888*epsilon[0]*rdx2Sq[1]+0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[7], globalIdxs[5], 0.006147592613027645*kSq[6]+0.03336355394999686*kSq[5]+0.02697478829999747*kSq[4]+0.01924500897298752*kSq[2]+0.1888888888888889*epsilon[0]*rdx2Sq[1]+0.3111111111111111*epsilon[0]*rdx2Sq[0]-0.02222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[7], globalIdxs[6], (-0.03442651863295482*kSq[7])-0.0295084445425327*kSq[6]-0.05962847939999439*kSq[5]-0.063887656499994*kSq[4]-0.05333333333333333*kSq[3]+0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.03849001794597505*kSq[1]-0.8888888888888888*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[7], globalIdxs[7], (-0.04549218533640458*kSq[7])-0.04549218533640458*kSq[6]-0.0127775312999988*kSq[5]-0.0127775312999988*kSq[4]-0.04666666666666667*kSq[3]-0.03849001794597505*kSq[2]+0.5777777777777777*epsilon[0]*rdx2Sq[1]-0.03849001794597505*kSq[1]+0.5777777777777777*epsilon[0]*rdx2Sq[0]-0.06666666666666667*kSq[0]);

}
void fem_poisson_lhs_stencil_consteps_2x_ser_p1_upx_neumannx_loy_robiny(const double *epsilon, const double *kSq, const double *dx, const double *bcVals, const long *globalIdxs, gkyl_mat_triples *tri) 
{ 
  // epsilon: permittivity.
  // kSq: wave number squared (factor multiplying phi).
  // dx: cell length in each direction.
  // bcVals[3]: values to impose as BCs, i.e. bcVals[0]*phi+bcVals[1]*d(phi)/dx=bcVals[2].
  // globalIdxs: global linear index of each basis function/node in current cell.
  // tri: triples object (i,j,val), i.e. contribute val to i,j element of the global matrix.

  double rdx2Sq[2];
  rdx2Sq[0] = 4.0/(dx[0]*dx[0]);
  rdx2Sq[1] = 4.0/(dx[1]*dx[1]);

  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[0], (-(0.6666666666666666*epsilon[0]*rdx2Sq[1]*bcVals[6])/bcVals[7])-0.1666666666666667*kSq[3]+0.1924500897298752*kSq[2]+0.3333333333333333*epsilon[0]*rdx2Sq[1]+0.1924500897298752*kSq[1]+0.3333333333333333*epsilon[0]*rdx2Sq[0]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[1], (-(0.3333333333333333*epsilon[0]*rdx2Sq[1]*bcVals[6])/bcVals[7])+0.09622504486493762*kSq[2]+0.1666666666666667*epsilon[0]*rdx2Sq[1]-0.3333333333333333*epsilon[0]*rdx2Sq[0]-0.1111111111111111*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[2], (-0.3333333333333333*epsilon[0]*rdx2Sq[1])+0.09622504486493762*kSq[1]+0.1666666666666667*epsilon[0]*rdx2Sq[0]-0.1111111111111111*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[3], (-0.1666666666666667*epsilon[0]*rdx2Sq[1])-0.1666666666666667*epsilon[0]*rdx2Sq[0]-0.05555555555555555*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[0], (-(0.3333333333333333*epsilon[0]*rdx2Sq[1]*bcVals[6])/bcVals[7])+0.09622504486493762*kSq[2]+0.1666666666666667*epsilon[0]*rdx2Sq[1]-0.3333333333333333*epsilon[0]*rdx2Sq[0]-0.1111111111111111*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[1], (-(0.6666666666666666*epsilon[0]*rdx2Sq[1]*bcVals[6])/bcVals[7])+0.1666666666666667*kSq[3]+0.1924500897298752*kSq[2]+0.3333333333333333*epsilon[0]*rdx2Sq[1]-0.1924500897298752*kSq[1]+0.3333333333333333*epsilon[0]*rdx2Sq[0]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[2], (-0.1666666666666667*epsilon[0]*rdx2Sq[1])-0.1666666666666667*epsilon[0]*rdx2Sq[0]-0.05555555555555555*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[3], (-0.3333333333333333*epsilon[0]*rdx2Sq[1])-0.09622504486493762*kSq[1]+0.1666666666666667*epsilon[0]*rdx2Sq[0]-0.1111111111111111*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[0], (-0.3333333333333333*epsilon[0]*rdx2Sq[1])+0.09622504486493762*kSq[1]+0.1666666666666667*epsilon[0]*rdx2Sq[0]-0.1111111111111111*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[1], (-0.1666666666666667*epsilon[0]*rdx2Sq[1])-0.1666666666666667*epsilon[0]*rdx2Sq[0]-0.05555555555555555*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[2], 0.1666666666666667*kSq[3]-0.1924500897298752*kSq[2]+0.3333333333333333*epsilon[0]*rdx2Sq[1]+0.1924500897298752*kSq[1]+0.3333333333333333*epsilon[0]*rdx2Sq[0]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[3], (-0.09622504486493762*kSq[2])+0.1666666666666667*epsilon[0]*rdx2Sq[1]-0.3333333333333333*epsilon[0]*rdx2Sq[0]-0.1111111111111111*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[0], (-0.1666666666666667*epsilon[0]*rdx2Sq[1])-0.1666666666666667*epsilon[0]*rdx2Sq[0]-0.05555555555555555*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[1], (-0.3333333333333333*epsilon[0]*rdx2Sq[1])-0.09622504486493762*kSq[1]+0.1666666666666667*epsilon[0]*rdx2Sq[0]-0.1111111111111111*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[2], (-0.09622504486493762*kSq[2])+0.1666666666666667*epsilon[0]*rdx2Sq[1]-0.3333333333333333*epsilon[0]*rdx2Sq[0]-0.1111111111111111*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[3], (-0.1666666666666667*kSq[3])-0.1924500897298752*kSq[2]+0.3333333333333333*epsilon[0]*rdx2Sq[1]-0.1924500897298752*kSq[1]+0.3333333333333333*epsilon[0]*rdx2Sq[0]-0.2222222222222222*kSq[0]);

}
void fem_poisson_lhs_stencil_consteps_2x_ser_p2_upx_neumannx_loy_robiny(const double *epsilon, const double *kSq, const double *dx, const double *bcVals, const long *globalIdxs, gkyl_mat_triples *tri) 
{ 
  // epsilon: permittivity.
  // kSq: wave number squared (factor multiplying phi).
  // dx: cell length in each direction.
  // bcVals[3]: values to impose as BCs, i.e. bcVals[0]*phi+bcVals[1]*d(phi)/dx=bcVals[2].
  // globalIdxs: global linear index of each basis function/node in current cell.
  // tri: triples object (i,j,val), i.e. contribute val to i,j element of the global matrix.

  double rdx2Sq[2];
  rdx2Sq[0] = 4.0/(dx[0]*dx[0]);
  rdx2Sq[1] = 4.0/(dx[1]*dx[1]);

  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[0], 0.04549218533640458*kSq[7]-(0.2666666666666667*epsilon[0]*rdx2Sq[1]*bcVals[6])/bcVals[7]+0.04549218533640458*kSq[6]-0.0127775312999988*kSq[5]-0.0127775312999988*kSq[4]-0.04666666666666667*kSq[3]+0.03849001794597505*kSq[2]+0.5777777777777777*epsilon[0]*rdx2Sq[1]+0.03849001794597505*kSq[1]+0.5777777777777777*epsilon[0]*rdx2Sq[0]-0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[1], 0.03442651863295482*kSq[7]-(0.1333333333333333*epsilon[0]*rdx2Sq[1]*bcVals[6])/bcVals[7]+0.0295084445425327*kSq[6]-0.05962847939999439*kSq[5]-0.063887656499994*kSq[4]-0.05333333333333333*kSq[3]+0.06666666666666667*epsilon[0]*rdx2Sq[1]+0.03849001794597505*kSq[1]-0.8888888888888888*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[2], (0.06666666666666667*epsilon[0]*rdx2Sq[1]*bcVals[6])/bcVals[7]-0.006147592613027645*kSq[6]+0.03336355394999686*kSq[5]+0.02697478829999747*kSq[4]-0.01924500897298752*kSq[2]+0.1888888888888889*epsilon[0]*rdx2Sq[1]+0.3111111111111111*epsilon[0]*rdx2Sq[0]-0.02222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[3], 0.0295084445425327*kSq[7]+0.03442651863295482*kSq[6]-0.063887656499994*kSq[5]-0.05962847939999439*kSq[4]-0.05333333333333333*kSq[3]+0.03849001794597505*kSq[2]-0.8888888888888888*epsilon[0]*rdx2Sq[1]+0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[4], (-0.01721325931647741*kSq[7])-0.05678902799999467*kSq[5]-0.03975231959999626*kSq[4]-0.01333333333333333*kSq[3]-0.4444444444444444*epsilon[0]*rdx2Sq[1]+0.03849001794597505*kSq[1]-0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[5], (-0.006147592613027645*kSq[7])+0.02697478829999747*kSq[5]+0.03336355394999686*kSq[4]+0.3111111111111111*epsilon[0]*rdx2Sq[1]-0.01924500897298752*kSq[1]+0.1888888888888889*epsilon[0]*rdx2Sq[0]-0.02222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[6], (-0.01721325931647741*kSq[6])-0.03975231959999626*kSq[5]-0.05678902799999467*kSq[4]-0.01333333333333333*kSq[3]+0.03849001794597505*kSq[2]-0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.4444444444444444*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[7], 0.0234254740499978*kSq[5]+0.0234254740499978*kSq[4]+0.01333333333333333*kSq[3]+0.2555555555555555*epsilon[0]*rdx2Sq[1]+0.2555555555555555*epsilon[0]*rdx2Sq[0]-0.03333333333333333*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[0], 0.03442651863295482*kSq[7]-(0.1333333333333333*epsilon[0]*rdx2Sq[1]*bcVals[6])/bcVals[7]+0.0295084445425327*kSq[6]-0.05962847939999439*kSq[5]-0.063887656499994*kSq[4]-0.05333333333333333*kSq[3]+0.06666666666666667*epsilon[0]*rdx2Sq[1]+0.03849001794597505*kSq[1]-0.8888888888888888*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[1], (-(1.066666666666667*epsilon[0]*rdx2Sq[1]*bcVals[6])/bcVals[7])-0.1967229636168847*kSq[6]-0.07950463919999252*kSq[5]+0.2271561119999787*kSq[4]+0.3079201435678004*kSq[2]+0.5333333333333333*epsilon[0]*rdx2Sq[1]+1.777777777777778*epsilon[0]*rdx2Sq[0]-0.3555555555555556*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[2], (-0.03442651863295482*kSq[7])-(0.1333333333333333*epsilon[0]*rdx2Sq[1]*bcVals[6])/bcVals[7]+0.0295084445425327*kSq[6]-0.05962847939999439*kSq[5]-0.063887656499994*kSq[4]+0.05333333333333333*kSq[3]+0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.03849001794597505*kSq[1]-0.8888888888888888*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[3], (-0.03442651863295482*kSq[7])-0.03442651863295482*kSq[6]+0.09938079899999068*kSq[5]+0.09938079899999068*kSq[4]-0.02666666666666666*kSq[3]+0.0769800358919501*kSq[2]+0.0769800358919501*kSq[1]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[4], 0.03442651863295482*kSq[7]-0.03442651863295482*kSq[6]+0.09938079899999068*kSq[5]+0.09938079899999068*kSq[4]+0.02666666666666666*kSq[3]+0.0769800358919501*kSq[2]-0.0769800358919501*kSq[1]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[5], 0.01721325931647741*kSq[6]-0.03975231959999626*kSq[5]-0.05678902799999467*kSq[4]+0.01333333333333333*kSq[3]-0.03849001794597505*kSq[2]-0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.4444444444444444*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[6], 0.07950463919999252*kSq[5]+0.1135780559999893*kSq[4]-0.5333333333333333*epsilon[0]*rdx2Sq[1]+0.8888888888888888*epsilon[0]*rdx2Sq[0]-0.1777777777777778*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[7], 0.01721325931647741*kSq[6]-0.03975231959999626*kSq[5]-0.05678902799999467*kSq[4]-0.01333333333333333*kSq[3]-0.03849001794597505*kSq[2]-0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.4444444444444444*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[0], (0.06666666666666667*epsilon[0]*rdx2Sq[1]*bcVals[6])/bcVals[7]-0.006147592613027645*kSq[6]+0.03336355394999686*kSq[5]+0.02697478829999747*kSq[4]-0.01924500897298752*kSq[2]+0.1888888888888889*epsilon[0]*rdx2Sq[1]+0.3111111111111111*epsilon[0]*rdx2Sq[0]-0.02222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[1], (-0.03442651863295482*kSq[7])-(0.1333333333333333*epsilon[0]*rdx2Sq[1]*bcVals[6])/bcVals[7]+0.0295084445425327*kSq[6]-0.05962847939999439*kSq[5]-0.063887656499994*kSq[4]+0.05333333333333333*kSq[3]+0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.03849001794597505*kSq[1]-0.8888888888888888*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[2], (-0.04549218533640458*kSq[7])-(0.2666666666666667*epsilon[0]*rdx2Sq[1]*bcVals[6])/bcVals[7]+0.04549218533640458*kSq[6]-0.0127775312999988*kSq[5]-0.0127775312999988*kSq[4]+0.04666666666666667*kSq[3]+0.03849001794597505*kSq[2]+0.5777777777777777*epsilon[0]*rdx2Sq[1]-0.03849001794597505*kSq[1]+0.5777777777777777*epsilon[0]*rdx2Sq[0]-0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[3], 0.01721325931647741*kSq[7]-0.05678902799999467*kSq[5]-0.03975231959999626*kSq[4]+0.01333333333333333*kSq[3]-0.4444444444444444*epsilon[0]*rdx2Sq[1]-0.03849001794597505*kSq[1]-0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[4], (-0.0295084445425327*kSq[7])+0.03442651863295482*kSq[6]-0.063887656499994*kSq[5]-0.05962847939999439*kSq[4]+0.05333333333333333*kSq[3]+0.03849001794597505*kSq[2]-0.8888888888888888*epsilon[0]*rdx2Sq[1]+0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[5], 0.0234254740499978*kSq[5]+0.0234254740499978*kSq[4]-0.01333333333333333*kSq[3]+0.2555555555555555*epsilon[0]*rdx2Sq[1]+0.2555555555555555*epsilon[0]*rdx2Sq[0]-0.03333333333333333*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[6], (-0.01721325931647741*kSq[6])-0.03975231959999626*kSq[5]-0.05678902799999467*kSq[4]+0.01333333333333333*kSq[3]+0.03849001794597505*kSq[2]-0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.4444444444444444*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[7], 0.006147592613027645*kSq[7]+0.02697478829999747*kSq[5]+0.03336355394999686*kSq[4]+0.3111111111111111*epsilon[0]*rdx2Sq[1]+0.01924500897298752*kSq[1]+0.1888888888888889*epsilon[0]*rdx2Sq[0]-0.02222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[0], 0.0295084445425327*kSq[7]+0.03442651863295482*kSq[6]-0.063887656499994*kSq[5]-0.05962847939999439*kSq[4]-0.05333333333333333*kSq[3]+0.03849001794597505*kSq[2]-0.8888888888888888*epsilon[0]*rdx2Sq[1]+0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[1], (-0.03442651863295482*kSq[7])-0.03442651863295482*kSq[6]+0.09938079899999068*kSq[5]+0.09938079899999068*kSq[4]-0.02666666666666666*kSq[3]+0.0769800358919501*kSq[2]+0.0769800358919501*kSq[1]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[2], 0.01721325931647741*kSq[7]-0.05678902799999467*kSq[5]-0.03975231959999626*kSq[4]+0.01333333333333333*kSq[3]-0.4444444444444444*epsilon[0]*rdx2Sq[1]-0.03849001794597505*kSq[1]-0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[3], (-0.1967229636168847*kSq[7])+0.2271561119999787*kSq[5]-0.07950463919999252*kSq[4]+1.777777777777778*epsilon[0]*rdx2Sq[1]+0.3079201435678004*kSq[1]+0.5333333333333333*epsilon[0]*rdx2Sq[0]-0.3555555555555556*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[4], 0.1135780559999893*kSq[5]+0.07950463919999252*kSq[4]+0.8888888888888888*epsilon[0]*rdx2Sq[1]-0.5333333333333333*epsilon[0]*rdx2Sq[0]-0.1777777777777778*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[5], 0.0295084445425327*kSq[7]-0.03442651863295482*kSq[6]-0.063887656499994*kSq[5]-0.05962847939999439*kSq[4]+0.05333333333333333*kSq[3]-0.03849001794597505*kSq[2]-0.8888888888888888*epsilon[0]*rdx2Sq[1]+0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[6], (-0.03442651863295482*kSq[7])+0.03442651863295482*kSq[6]+0.09938079899999068*kSq[5]+0.09938079899999068*kSq[4]+0.02666666666666666*kSq[3]-0.0769800358919501*kSq[2]+0.0769800358919501*kSq[1]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[7], 0.01721325931647741*kSq[7]-0.05678902799999467*kSq[5]-0.03975231959999626*kSq[4]-0.01333333333333333*kSq[3]-0.4444444444444444*epsilon[0]*rdx2Sq[1]-0.03849001794597505*kSq[1]-0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[4], globalIdxs[0], (-0.01721325931647741*kSq[7])-0.05678902799999467*kSq[5]-0.03975231959999626*kSq[4]-0.01333333333333333*kSq[3]-0.4444444444444444*epsilon[0]*rdx2Sq[1]+0.03849001794597505*kSq[1]-0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[4], globalIdxs[1], 0.03442651863295482*kSq[7]-0.03442651863295482*kSq[6]+0.09938079899999068*kSq[5]+0.09938079899999068*kSq[4]+0.02666666666666666*kSq[3]+0.0769800358919501*kSq[2]-0.0769800358919501*kSq[1]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[4], globalIdxs[2], (-0.0295084445425327*kSq[7])+0.03442651863295482*kSq[6]-0.063887656499994*kSq[5]-0.05962847939999439*kSq[4]+0.05333333333333333*kSq[3]+0.03849001794597505*kSq[2]-0.8888888888888888*epsilon[0]*rdx2Sq[1]+0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[4], globalIdxs[3], 0.1135780559999893*kSq[5]+0.07950463919999252*kSq[4]+0.8888888888888888*epsilon[0]*rdx2Sq[1]-0.5333333333333333*epsilon[0]*rdx2Sq[0]-0.1777777777777778*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[4], globalIdxs[4], 0.1967229636168847*kSq[7]+0.2271561119999787*kSq[5]-0.07950463919999252*kSq[4]+1.777777777777778*epsilon[0]*rdx2Sq[1]-0.3079201435678004*kSq[1]+0.5333333333333333*epsilon[0]*rdx2Sq[0]-0.3555555555555556*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[4], globalIdxs[5], (-0.01721325931647741*kSq[7])-0.05678902799999467*kSq[5]-0.03975231959999626*kSq[4]+0.01333333333333333*kSq[3]-0.4444444444444444*epsilon[0]*rdx2Sq[1]+0.03849001794597505*kSq[1]-0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[4], globalIdxs[6], 0.03442651863295482*kSq[7]+0.03442651863295482*kSq[6]+0.09938079899999068*kSq[5]+0.09938079899999068*kSq[4]-0.02666666666666666*kSq[3]-0.0769800358919501*kSq[2]-0.0769800358919501*kSq[1]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[4], globalIdxs[7], (-0.0295084445425327*kSq[7])-0.03442651863295482*kSq[6]-0.063887656499994*kSq[5]-0.05962847939999439*kSq[4]-0.05333333333333333*kSq[3]-0.03849001794597505*kSq[2]-0.8888888888888888*epsilon[0]*rdx2Sq[1]+0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[5], globalIdxs[0], (-0.006147592613027645*kSq[7])+0.02697478829999747*kSq[5]+0.03336355394999686*kSq[4]+0.3111111111111111*epsilon[0]*rdx2Sq[1]-0.01924500897298752*kSq[1]+0.1888888888888889*epsilon[0]*rdx2Sq[0]-0.02222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[5], globalIdxs[1], 0.01721325931647741*kSq[6]-0.03975231959999626*kSq[5]-0.05678902799999467*kSq[4]+0.01333333333333333*kSq[3]-0.03849001794597505*kSq[2]-0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.4444444444444444*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[5], globalIdxs[2], 0.0234254740499978*kSq[5]+0.0234254740499978*kSq[4]-0.01333333333333333*kSq[3]+0.2555555555555555*epsilon[0]*rdx2Sq[1]+0.2555555555555555*epsilon[0]*rdx2Sq[0]-0.03333333333333333*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[5], globalIdxs[3], 0.0295084445425327*kSq[7]-0.03442651863295482*kSq[6]-0.063887656499994*kSq[5]-0.05962847939999439*kSq[4]+0.05333333333333333*kSq[3]-0.03849001794597505*kSq[2]-0.8888888888888888*epsilon[0]*rdx2Sq[1]+0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[5], globalIdxs[4], (-0.01721325931647741*kSq[7])-0.05678902799999467*kSq[5]-0.03975231959999626*kSq[4]+0.01333333333333333*kSq[3]-0.4444444444444444*epsilon[0]*rdx2Sq[1]+0.03849001794597505*kSq[1]-0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[5], globalIdxs[5], 0.04549218533640458*kSq[7]-0.04549218533640458*kSq[6]-0.0127775312999988*kSq[5]-0.0127775312999988*kSq[4]+0.04666666666666667*kSq[3]-0.03849001794597505*kSq[2]+0.5777777777777777*epsilon[0]*rdx2Sq[1]+0.03849001794597505*kSq[1]+0.5777777777777777*epsilon[0]*rdx2Sq[0]-0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[5], globalIdxs[6], 0.03442651863295482*kSq[7]-0.0295084445425327*kSq[6]-0.05962847939999439*kSq[5]-0.063887656499994*kSq[4]+0.05333333333333333*kSq[3]+0.06666666666666667*epsilon[0]*rdx2Sq[1]+0.03849001794597505*kSq[1]-0.8888888888888888*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[5], globalIdxs[7], 0.006147592613027645*kSq[6]+0.03336355394999686*kSq[5]+0.02697478829999747*kSq[4]+0.01924500897298752*kSq[2]+0.1888888888888889*epsilon[0]*rdx2Sq[1]+0.3111111111111111*epsilon[0]*rdx2Sq[0]-0.02222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[6], globalIdxs[0], (-0.01721325931647741*kSq[6])-0.03975231959999626*kSq[5]-0.05678902799999467*kSq[4]-0.01333333333333333*kSq[3]+0.03849001794597505*kSq[2]-0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.4444444444444444*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[6], globalIdxs[1], 0.07950463919999252*kSq[5]+0.1135780559999893*kSq[4]-0.5333333333333333*epsilon[0]*rdx2Sq[1]+0.8888888888888888*epsilon[0]*rdx2Sq[0]-0.1777777777777778*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[6], globalIdxs[2], (-0.01721325931647741*kSq[6])-0.03975231959999626*kSq[5]-0.05678902799999467*kSq[4]+0.01333333333333333*kSq[3]+0.03849001794597505*kSq[2]-0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.4444444444444444*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[6], globalIdxs[3], (-0.03442651863295482*kSq[7])+0.03442651863295482*kSq[6]+0.09938079899999068*kSq[5]+0.09938079899999068*kSq[4]+0.02666666666666666*kSq[3]-0.0769800358919501*kSq[2]+0.0769800358919501*kSq[1]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[6], globalIdxs[4], 0.03442651863295482*kSq[7]+0.03442651863295482*kSq[6]+0.09938079899999068*kSq[5]+0.09938079899999068*kSq[4]-0.02666666666666666*kSq[3]-0.0769800358919501*kSq[2]-0.0769800358919501*kSq[1]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[6], globalIdxs[5], 0.03442651863295482*kSq[7]-0.0295084445425327*kSq[6]-0.05962847939999439*kSq[5]-0.063887656499994*kSq[4]+0.05333333333333333*kSq[3]+0.06666666666666667*epsilon[0]*rdx2Sq[1]+0.03849001794597505*kSq[1]-0.8888888888888888*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[6], globalIdxs[6], 0.1967229636168847*kSq[6]-0.07950463919999252*kSq[5]+0.2271561119999787*kSq[4]-0.3079201435678004*kSq[2]+0.5333333333333333*epsilon[0]*rdx2Sq[1]+1.777777777777778*epsilon[0]*rdx2Sq[0]-0.3555555555555556*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[6], globalIdxs[7], (-0.03442651863295482*kSq[7])-0.0295084445425327*kSq[6]-0.05962847939999439*kSq[5]-0.063887656499994*kSq[4]-0.05333333333333333*kSq[3]+0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.03849001794597505*kSq[1]-0.8888888888888888*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[7], globalIdxs[0], 0.0234254740499978*kSq[5]+0.0234254740499978*kSq[4]+0.01333333333333333*kSq[3]+0.2555555555555555*epsilon[0]*rdx2Sq[1]+0.2555555555555555*epsilon[0]*rdx2Sq[0]-0.03333333333333333*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[7], globalIdxs[1], 0.01721325931647741*kSq[6]-0.03975231959999626*kSq[5]-0.05678902799999467*kSq[4]-0.01333333333333333*kSq[3]-0.03849001794597505*kSq[2]-0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.4444444444444444*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[7], globalIdxs[2], 0.006147592613027645*kSq[7]+0.02697478829999747*kSq[5]+0.03336355394999686*kSq[4]+0.3111111111111111*epsilon[0]*rdx2Sq[1]+0.01924500897298752*kSq[1]+0.1888888888888889*epsilon[0]*rdx2Sq[0]-0.02222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[7], globalIdxs[3], 0.01721325931647741*kSq[7]-0.05678902799999467*kSq[5]-0.03975231959999626*kSq[4]-0.01333333333333333*kSq[3]-0.4444444444444444*epsilon[0]*rdx2Sq[1]-0.03849001794597505*kSq[1]-0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[7], globalIdxs[4], (-0.0295084445425327*kSq[7])-0.03442651863295482*kSq[6]-0.063887656499994*kSq[5]-0.05962847939999439*kSq[4]-0.05333333333333333*kSq[3]-0.03849001794597505*kSq[2]-0.8888888888888888*epsilon[0]*rdx2Sq[1]+0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[7], globalIdxs[5], 0.006147592613027645*kSq[6]+0.03336355394999686*kSq[5]+0.02697478829999747*kSq[4]+0.01924500897298752*kSq[2]+0.1888888888888889*epsilon[0]*rdx2Sq[1]+0.3111111111111111*epsilon[0]*rdx2Sq[0]-0.02222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[7], globalIdxs[6], (-0.03442651863295482*kSq[7])-0.0295084445425327*kSq[6]-0.05962847939999439*kSq[5]-0.063887656499994*kSq[4]-0.05333333333333333*kSq[3]+0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.03849001794597505*kSq[1]-0.8888888888888888*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[7], globalIdxs[7], (-0.04549218533640458*kSq[7])-0.04549218533640458*kSq[6]-0.0127775312999988*kSq[5]-0.0127775312999988*kSq[4]-0.04666666666666667*kSq[3]-0.03849001794597505*kSq[2]+0.5777777777777777*epsilon[0]*rdx2Sq[1]-0.03849001794597505*kSq[1]+0.5777777777777777*epsilon[0]*rdx2Sq[0]-0.06666666666666667*kSq[0]);

}
void fem_poisson_lhs_stencil_consteps_2x_ser_p1_upx_robinx_loy_periodicy(const double *epsilon, const double *kSq, const double *dx, const double *bcVals, const long *globalIdxs, gkyl_mat_triples *tri) 
{ 
  // epsilon: permittivity.
  // kSq: wave number squared (factor multiplying phi).
  // dx: cell length in each direction.
  // bcVals[3]: values to impose as BCs, i.e. bcVals[0]*phi+bcVals[1]*d(phi)/dx=bcVals[2].
  // globalIdxs: global linear index of each basis function/node in current cell.
  // tri: triples object (i,j,val), i.e. contribute val to i,j element of the global matrix.

  double rdx2Sq[2];
  rdx2Sq[0] = 4.0/(dx[0]*dx[0]);
  rdx2Sq[1] = 4.0/(dx[1]*dx[1]);

  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[0], (-0.1666666666666667*kSq[3])+0.1924500897298752*kSq[2]+0.3333333333333333*epsilon[0]*rdx2Sq[1]+0.1924500897298752*kSq[1]+0.3333333333333333*epsilon[0]*rdx2Sq[0]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[1], 0.09622504486493762*kSq[2]+0.1666666666666667*epsilon[0]*rdx2Sq[1]-0.3333333333333333*epsilon[0]*rdx2Sq[0]-0.1111111111111111*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[2], (-0.3333333333333333*epsilon[0]*rdx2Sq[1])+0.09622504486493762*kSq[1]+0.1666666666666667*epsilon[0]*rdx2Sq[0]-0.1111111111111111*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[3], (-0.1666666666666667*epsilon[0]*rdx2Sq[1])-0.1666666666666667*epsilon[0]*rdx2Sq[0]-0.05555555555555555*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[0], 0.09622504486493762*kSq[2]+0.1666666666666667*epsilon[0]*rdx2Sq[1]-0.3333333333333333*epsilon[0]*rdx2Sq[0]-0.1111111111111111*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[1], (0.6666666666666666*epsilon[0]*rdx2Sq[0]*bcVals[3])/bcVals[4]+0.1666666666666667*kSq[3]+0.1924500897298752*kSq[2]+0.3333333333333333*epsilon[0]*rdx2Sq[1]-0.1924500897298752*kSq[1]+0.3333333333333333*epsilon[0]*rdx2Sq[0]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[2], (-0.1666666666666667*epsilon[0]*rdx2Sq[1])-0.1666666666666667*epsilon[0]*rdx2Sq[0]-0.05555555555555555*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[3], (0.3333333333333333*epsilon[0]*rdx2Sq[0]*bcVals[3])/bcVals[4]-0.3333333333333333*epsilon[0]*rdx2Sq[1]-0.09622504486493762*kSq[1]+0.1666666666666667*epsilon[0]*rdx2Sq[0]-0.1111111111111111*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[0], (-0.3333333333333333*epsilon[0]*rdx2Sq[1])+0.09622504486493762*kSq[1]+0.1666666666666667*epsilon[0]*rdx2Sq[0]-0.1111111111111111*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[1], (-0.1666666666666667*epsilon[0]*rdx2Sq[1])-0.1666666666666667*epsilon[0]*rdx2Sq[0]-0.05555555555555555*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[2], 0.1666666666666667*kSq[3]-0.1924500897298752*kSq[2]+0.3333333333333333*epsilon[0]*rdx2Sq[1]+0.1924500897298752*kSq[1]+0.3333333333333333*epsilon[0]*rdx2Sq[0]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[3], (-0.09622504486493762*kSq[2])+0.1666666666666667*epsilon[0]*rdx2Sq[1]-0.3333333333333333*epsilon[0]*rdx2Sq[0]-0.1111111111111111*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[0], (-0.1666666666666667*epsilon[0]*rdx2Sq[1])-0.1666666666666667*epsilon[0]*rdx2Sq[0]-0.05555555555555555*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[1], (0.3333333333333333*epsilon[0]*rdx2Sq[0]*bcVals[3])/bcVals[4]-0.3333333333333333*epsilon[0]*rdx2Sq[1]-0.09622504486493762*kSq[1]+0.1666666666666667*epsilon[0]*rdx2Sq[0]-0.1111111111111111*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[2], (-0.09622504486493762*kSq[2])+0.1666666666666667*epsilon[0]*rdx2Sq[1]-0.3333333333333333*epsilon[0]*rdx2Sq[0]-0.1111111111111111*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[3], (0.6666666666666666*epsilon[0]*rdx2Sq[0]*bcVals[3])/bcVals[4]-0.1666666666666667*kSq[3]-0.1924500897298752*kSq[2]+0.3333333333333333*epsilon[0]*rdx2Sq[1]-0.1924500897298752*kSq[1]+0.3333333333333333*epsilon[0]*rdx2Sq[0]-0.2222222222222222*kSq[0]);

}
void fem_poisson_lhs_stencil_consteps_2x_ser_p2_upx_robinx_loy_periodicy(const double *epsilon, const double *kSq, const double *dx, const double *bcVals, const long *globalIdxs, gkyl_mat_triples *tri) 
{ 
  // epsilon: permittivity.
  // kSq: wave number squared (factor multiplying phi).
  // dx: cell length in each direction.
  // bcVals[3]: values to impose as BCs, i.e. bcVals[0]*phi+bcVals[1]*d(phi)/dx=bcVals[2].
  // globalIdxs: global linear index of each basis function/node in current cell.
  // tri: triples object (i,j,val), i.e. contribute val to i,j element of the global matrix.

  double rdx2Sq[2];
  rdx2Sq[0] = 4.0/(dx[0]*dx[0]);
  rdx2Sq[1] = 4.0/(dx[1]*dx[1]);

  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[0], 0.04549218533640458*kSq[7]+0.04549218533640458*kSq[6]-0.0127775312999988*kSq[5]-0.0127775312999988*kSq[4]-0.04666666666666667*kSq[3]+0.03849001794597505*kSq[2]+0.5777777777777777*epsilon[0]*rdx2Sq[1]+0.03849001794597505*kSq[1]+0.5777777777777777*epsilon[0]*rdx2Sq[0]-0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[1], 0.03442651863295482*kSq[7]+0.0295084445425327*kSq[6]-0.05962847939999439*kSq[5]-0.063887656499994*kSq[4]-0.05333333333333333*kSq[3]+0.06666666666666667*epsilon[0]*rdx2Sq[1]+0.03849001794597505*kSq[1]-0.8888888888888888*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[2], (-0.006147592613027645*kSq[6])+0.03336355394999686*kSq[5]+0.02697478829999747*kSq[4]-0.01924500897298752*kSq[2]+0.1888888888888889*epsilon[0]*rdx2Sq[1]+0.3111111111111111*epsilon[0]*rdx2Sq[0]-0.02222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[3], 0.0295084445425327*kSq[7]+0.03442651863295482*kSq[6]-0.063887656499994*kSq[5]-0.05962847939999439*kSq[4]-0.05333333333333333*kSq[3]+0.03849001794597505*kSq[2]-0.8888888888888888*epsilon[0]*rdx2Sq[1]+0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[4], (-0.01721325931647741*kSq[7])-0.05678902799999467*kSq[5]-0.03975231959999626*kSq[4]-0.01333333333333333*kSq[3]-0.4444444444444444*epsilon[0]*rdx2Sq[1]+0.03849001794597505*kSq[1]-0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[5], (-0.006147592613027645*kSq[7])+0.02697478829999747*kSq[5]+0.03336355394999686*kSq[4]+0.3111111111111111*epsilon[0]*rdx2Sq[1]-0.01924500897298752*kSq[1]+0.1888888888888889*epsilon[0]*rdx2Sq[0]-0.02222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[6], (-0.01721325931647741*kSq[6])-0.03975231959999626*kSq[5]-0.05678902799999467*kSq[4]-0.01333333333333333*kSq[3]+0.03849001794597505*kSq[2]-0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.4444444444444444*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[7], 0.0234254740499978*kSq[5]+0.0234254740499978*kSq[4]+0.01333333333333333*kSq[3]+0.2555555555555555*epsilon[0]*rdx2Sq[1]+0.2555555555555555*epsilon[0]*rdx2Sq[0]-0.03333333333333333*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[0], 0.03442651863295482*kSq[7]+0.0295084445425327*kSq[6]-0.05962847939999439*kSq[5]-0.063887656499994*kSq[4]-0.05333333333333333*kSq[3]+0.06666666666666667*epsilon[0]*rdx2Sq[1]+0.03849001794597505*kSq[1]-0.8888888888888888*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[1], (-0.1967229636168847*kSq[6])-0.07950463919999252*kSq[5]+0.2271561119999787*kSq[4]+0.3079201435678004*kSq[2]+0.5333333333333333*epsilon[0]*rdx2Sq[1]+1.777777777777778*epsilon[0]*rdx2Sq[0]-0.3555555555555556*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[2], (-0.03442651863295482*kSq[7])+0.0295084445425327*kSq[6]-0.05962847939999439*kSq[5]-0.063887656499994*kSq[4]+0.05333333333333333*kSq[3]+0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.03849001794597505*kSq[1]-0.8888888888888888*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[3], (-0.03442651863295482*kSq[7])-0.03442651863295482*kSq[6]+0.09938079899999068*kSq[5]+0.09938079899999068*kSq[4]-0.02666666666666666*kSq[3]+0.0769800358919501*kSq[2]+0.0769800358919501*kSq[1]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[4], 0.03442651863295482*kSq[7]-0.03442651863295482*kSq[6]+0.09938079899999068*kSq[5]+0.09938079899999068*kSq[4]+0.02666666666666666*kSq[3]+0.0769800358919501*kSq[2]-0.0769800358919501*kSq[1]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[5], 0.01721325931647741*kSq[6]-0.03975231959999626*kSq[5]-0.05678902799999467*kSq[4]+0.01333333333333333*kSq[3]-0.03849001794597505*kSq[2]-0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.4444444444444444*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[6], 0.07950463919999252*kSq[5]+0.1135780559999893*kSq[4]-0.5333333333333333*epsilon[0]*rdx2Sq[1]+0.8888888888888888*epsilon[0]*rdx2Sq[0]-0.1777777777777778*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[7], 0.01721325931647741*kSq[6]-0.03975231959999626*kSq[5]-0.05678902799999467*kSq[4]-0.01333333333333333*kSq[3]-0.03849001794597505*kSq[2]-0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.4444444444444444*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[0], (-0.006147592613027645*kSq[6])+0.03336355394999686*kSq[5]+0.02697478829999747*kSq[4]-0.01924500897298752*kSq[2]+0.1888888888888889*epsilon[0]*rdx2Sq[1]+0.3111111111111111*epsilon[0]*rdx2Sq[0]-0.02222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[1], (-0.03442651863295482*kSq[7])+0.0295084445425327*kSq[6]-0.05962847939999439*kSq[5]-0.063887656499994*kSq[4]+0.05333333333333333*kSq[3]+0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.03849001794597505*kSq[1]-0.8888888888888888*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[2], (-0.04549218533640458*kSq[7])+0.04549218533640458*kSq[6]-0.0127775312999988*kSq[5]-0.0127775312999988*kSq[4]+(0.2666666666666667*epsilon[0]*rdx2Sq[0]*bcVals[3])/bcVals[4]+0.04666666666666667*kSq[3]+0.03849001794597505*kSq[2]+0.5777777777777777*epsilon[0]*rdx2Sq[1]-0.03849001794597505*kSq[1]+0.5777777777777777*epsilon[0]*rdx2Sq[0]-0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[3], 0.01721325931647741*kSq[7]-0.05678902799999467*kSq[5]-0.03975231959999626*kSq[4]+0.01333333333333333*kSq[3]-0.4444444444444444*epsilon[0]*rdx2Sq[1]-0.03849001794597505*kSq[1]-0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[4], (-0.0295084445425327*kSq[7])+0.03442651863295482*kSq[6]-0.063887656499994*kSq[5]-0.05962847939999439*kSq[4]+(0.1333333333333333*epsilon[0]*rdx2Sq[0]*bcVals[3])/bcVals[4]+0.05333333333333333*kSq[3]+0.03849001794597505*kSq[2]-0.8888888888888888*epsilon[0]*rdx2Sq[1]+0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[5], 0.0234254740499978*kSq[5]+0.0234254740499978*kSq[4]-0.01333333333333333*kSq[3]+0.2555555555555555*epsilon[0]*rdx2Sq[1]+0.2555555555555555*epsilon[0]*rdx2Sq[0]-0.03333333333333333*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[6], (-0.01721325931647741*kSq[6])-0.03975231959999626*kSq[5]-0.05678902799999467*kSq[4]+0.01333333333333333*kSq[3]+0.03849001794597505*kSq[2]-0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.4444444444444444*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[7], 0.006147592613027645*kSq[7]+0.02697478829999747*kSq[5]+0.03336355394999686*kSq[4]-(0.06666666666666667*epsilon[0]*rdx2Sq[0]*bcVals[3])/bcVals[4]+0.3111111111111111*epsilon[0]*rdx2Sq[1]+0.01924500897298752*kSq[1]+0.1888888888888889*epsilon[0]*rdx2Sq[0]-0.02222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[0], 0.0295084445425327*kSq[7]+0.03442651863295482*kSq[6]-0.063887656499994*kSq[5]-0.05962847939999439*kSq[4]-0.05333333333333333*kSq[3]+0.03849001794597505*kSq[2]-0.8888888888888888*epsilon[0]*rdx2Sq[1]+0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[1], (-0.03442651863295482*kSq[7])-0.03442651863295482*kSq[6]+0.09938079899999068*kSq[5]+0.09938079899999068*kSq[4]-0.02666666666666666*kSq[3]+0.0769800358919501*kSq[2]+0.0769800358919501*kSq[1]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[2], 0.01721325931647741*kSq[7]-0.05678902799999467*kSq[5]-0.03975231959999626*kSq[4]+0.01333333333333333*kSq[3]-0.4444444444444444*epsilon[0]*rdx2Sq[1]-0.03849001794597505*kSq[1]-0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[3], (-0.1967229636168847*kSq[7])+0.2271561119999787*kSq[5]-0.07950463919999252*kSq[4]+1.777777777777778*epsilon[0]*rdx2Sq[1]+0.3079201435678004*kSq[1]+0.5333333333333333*epsilon[0]*rdx2Sq[0]-0.3555555555555556*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[4], 0.1135780559999893*kSq[5]+0.07950463919999252*kSq[4]+0.8888888888888888*epsilon[0]*rdx2Sq[1]-0.5333333333333333*epsilon[0]*rdx2Sq[0]-0.1777777777777778*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[5], 0.0295084445425327*kSq[7]-0.03442651863295482*kSq[6]-0.063887656499994*kSq[5]-0.05962847939999439*kSq[4]+0.05333333333333333*kSq[3]-0.03849001794597505*kSq[2]-0.8888888888888888*epsilon[0]*rdx2Sq[1]+0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[6], (-0.03442651863295482*kSq[7])+0.03442651863295482*kSq[6]+0.09938079899999068*kSq[5]+0.09938079899999068*kSq[4]+0.02666666666666666*kSq[3]-0.0769800358919501*kSq[2]+0.0769800358919501*kSq[1]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[7], 0.01721325931647741*kSq[7]-0.05678902799999467*kSq[5]-0.03975231959999626*kSq[4]-0.01333333333333333*kSq[3]-0.4444444444444444*epsilon[0]*rdx2Sq[1]-0.03849001794597505*kSq[1]-0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[4], globalIdxs[0], (-0.01721325931647741*kSq[7])-0.05678902799999467*kSq[5]-0.03975231959999626*kSq[4]-0.01333333333333333*kSq[3]-0.4444444444444444*epsilon[0]*rdx2Sq[1]+0.03849001794597505*kSq[1]-0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[4], globalIdxs[1], 0.03442651863295482*kSq[7]-0.03442651863295482*kSq[6]+0.09938079899999068*kSq[5]+0.09938079899999068*kSq[4]+0.02666666666666666*kSq[3]+0.0769800358919501*kSq[2]-0.0769800358919501*kSq[1]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[4], globalIdxs[2], (-0.0295084445425327*kSq[7])+0.03442651863295482*kSq[6]-0.063887656499994*kSq[5]-0.05962847939999439*kSq[4]+(0.1333333333333333*epsilon[0]*rdx2Sq[0]*bcVals[3])/bcVals[4]+0.05333333333333333*kSq[3]+0.03849001794597505*kSq[2]-0.8888888888888888*epsilon[0]*rdx2Sq[1]+0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[4], globalIdxs[3], 0.1135780559999893*kSq[5]+0.07950463919999252*kSq[4]+0.8888888888888888*epsilon[0]*rdx2Sq[1]-0.5333333333333333*epsilon[0]*rdx2Sq[0]-0.1777777777777778*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[4], globalIdxs[4], 0.1967229636168847*kSq[7]+0.2271561119999787*kSq[5]-0.07950463919999252*kSq[4]+(1.066666666666667*epsilon[0]*rdx2Sq[0]*bcVals[3])/bcVals[4]+1.777777777777778*epsilon[0]*rdx2Sq[1]-0.3079201435678004*kSq[1]+0.5333333333333333*epsilon[0]*rdx2Sq[0]-0.3555555555555556*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[4], globalIdxs[5], (-0.01721325931647741*kSq[7])-0.05678902799999467*kSq[5]-0.03975231959999626*kSq[4]+0.01333333333333333*kSq[3]-0.4444444444444444*epsilon[0]*rdx2Sq[1]+0.03849001794597505*kSq[1]-0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[4], globalIdxs[6], 0.03442651863295482*kSq[7]+0.03442651863295482*kSq[6]+0.09938079899999068*kSq[5]+0.09938079899999068*kSq[4]-0.02666666666666666*kSq[3]-0.0769800358919501*kSq[2]-0.0769800358919501*kSq[1]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[4], globalIdxs[7], (-0.0295084445425327*kSq[7])-0.03442651863295482*kSq[6]-0.063887656499994*kSq[5]-0.05962847939999439*kSq[4]+(0.1333333333333333*epsilon[0]*rdx2Sq[0]*bcVals[3])/bcVals[4]-0.05333333333333333*kSq[3]-0.03849001794597505*kSq[2]-0.8888888888888888*epsilon[0]*rdx2Sq[1]+0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[5], globalIdxs[0], (-0.006147592613027645*kSq[7])+0.02697478829999747*kSq[5]+0.03336355394999686*kSq[4]+0.3111111111111111*epsilon[0]*rdx2Sq[1]-0.01924500897298752*kSq[1]+0.1888888888888889*epsilon[0]*rdx2Sq[0]-0.02222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[5], globalIdxs[1], 0.01721325931647741*kSq[6]-0.03975231959999626*kSq[5]-0.05678902799999467*kSq[4]+0.01333333333333333*kSq[3]-0.03849001794597505*kSq[2]-0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.4444444444444444*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[5], globalIdxs[2], 0.0234254740499978*kSq[5]+0.0234254740499978*kSq[4]-0.01333333333333333*kSq[3]+0.2555555555555555*epsilon[0]*rdx2Sq[1]+0.2555555555555555*epsilon[0]*rdx2Sq[0]-0.03333333333333333*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[5], globalIdxs[3], 0.0295084445425327*kSq[7]-0.03442651863295482*kSq[6]-0.063887656499994*kSq[5]-0.05962847939999439*kSq[4]+0.05333333333333333*kSq[3]-0.03849001794597505*kSq[2]-0.8888888888888888*epsilon[0]*rdx2Sq[1]+0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[5], globalIdxs[4], (-0.01721325931647741*kSq[7])-0.05678902799999467*kSq[5]-0.03975231959999626*kSq[4]+0.01333333333333333*kSq[3]-0.4444444444444444*epsilon[0]*rdx2Sq[1]+0.03849001794597505*kSq[1]-0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[5], globalIdxs[5], 0.04549218533640458*kSq[7]-0.04549218533640458*kSq[6]-0.0127775312999988*kSq[5]-0.0127775312999988*kSq[4]+0.04666666666666667*kSq[3]-0.03849001794597505*kSq[2]+0.5777777777777777*epsilon[0]*rdx2Sq[1]+0.03849001794597505*kSq[1]+0.5777777777777777*epsilon[0]*rdx2Sq[0]-0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[5], globalIdxs[6], 0.03442651863295482*kSq[7]-0.0295084445425327*kSq[6]-0.05962847939999439*kSq[5]-0.063887656499994*kSq[4]+0.05333333333333333*kSq[3]+0.06666666666666667*epsilon[0]*rdx2Sq[1]+0.03849001794597505*kSq[1]-0.8888888888888888*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[5], globalIdxs[7], 0.006147592613027645*kSq[6]+0.03336355394999686*kSq[5]+0.02697478829999747*kSq[4]+0.01924500897298752*kSq[2]+0.1888888888888889*epsilon[0]*rdx2Sq[1]+0.3111111111111111*epsilon[0]*rdx2Sq[0]-0.02222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[6], globalIdxs[0], (-0.01721325931647741*kSq[6])-0.03975231959999626*kSq[5]-0.05678902799999467*kSq[4]-0.01333333333333333*kSq[3]+0.03849001794597505*kSq[2]-0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.4444444444444444*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[6], globalIdxs[1], 0.07950463919999252*kSq[5]+0.1135780559999893*kSq[4]-0.5333333333333333*epsilon[0]*rdx2Sq[1]+0.8888888888888888*epsilon[0]*rdx2Sq[0]-0.1777777777777778*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[6], globalIdxs[2], (-0.01721325931647741*kSq[6])-0.03975231959999626*kSq[5]-0.05678902799999467*kSq[4]+0.01333333333333333*kSq[3]+0.03849001794597505*kSq[2]-0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.4444444444444444*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[6], globalIdxs[3], (-0.03442651863295482*kSq[7])+0.03442651863295482*kSq[6]+0.09938079899999068*kSq[5]+0.09938079899999068*kSq[4]+0.02666666666666666*kSq[3]-0.0769800358919501*kSq[2]+0.0769800358919501*kSq[1]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[6], globalIdxs[4], 0.03442651863295482*kSq[7]+0.03442651863295482*kSq[6]+0.09938079899999068*kSq[5]+0.09938079899999068*kSq[4]-0.02666666666666666*kSq[3]-0.0769800358919501*kSq[2]-0.0769800358919501*kSq[1]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[6], globalIdxs[5], 0.03442651863295482*kSq[7]-0.0295084445425327*kSq[6]-0.05962847939999439*kSq[5]-0.063887656499994*kSq[4]+0.05333333333333333*kSq[3]+0.06666666666666667*epsilon[0]*rdx2Sq[1]+0.03849001794597505*kSq[1]-0.8888888888888888*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[6], globalIdxs[6], 0.1967229636168847*kSq[6]-0.07950463919999252*kSq[5]+0.2271561119999787*kSq[4]-0.3079201435678004*kSq[2]+0.5333333333333333*epsilon[0]*rdx2Sq[1]+1.777777777777778*epsilon[0]*rdx2Sq[0]-0.3555555555555556*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[6], globalIdxs[7], (-0.03442651863295482*kSq[7])-0.0295084445425327*kSq[6]-0.05962847939999439*kSq[5]-0.063887656499994*kSq[4]-0.05333333333333333*kSq[3]+0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.03849001794597505*kSq[1]-0.8888888888888888*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[7], globalIdxs[0], 0.0234254740499978*kSq[5]+0.0234254740499978*kSq[4]+0.01333333333333333*kSq[3]+0.2555555555555555*epsilon[0]*rdx2Sq[1]+0.2555555555555555*epsilon[0]*rdx2Sq[0]-0.03333333333333333*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[7], globalIdxs[1], 0.01721325931647741*kSq[6]-0.03975231959999626*kSq[5]-0.05678902799999467*kSq[4]-0.01333333333333333*kSq[3]-0.03849001794597505*kSq[2]-0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.4444444444444444*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[7], globalIdxs[2], 0.006147592613027645*kSq[7]+0.02697478829999747*kSq[5]+0.03336355394999686*kSq[4]-(0.06666666666666667*epsilon[0]*rdx2Sq[0]*bcVals[3])/bcVals[4]+0.3111111111111111*epsilon[0]*rdx2Sq[1]+0.01924500897298752*kSq[1]+0.1888888888888889*epsilon[0]*rdx2Sq[0]-0.02222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[7], globalIdxs[3], 0.01721325931647741*kSq[7]-0.05678902799999467*kSq[5]-0.03975231959999626*kSq[4]-0.01333333333333333*kSq[3]-0.4444444444444444*epsilon[0]*rdx2Sq[1]-0.03849001794597505*kSq[1]-0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[7], globalIdxs[4], (-0.0295084445425327*kSq[7])-0.03442651863295482*kSq[6]-0.063887656499994*kSq[5]-0.05962847939999439*kSq[4]+(0.1333333333333333*epsilon[0]*rdx2Sq[0]*bcVals[3])/bcVals[4]-0.05333333333333333*kSq[3]-0.03849001794597505*kSq[2]-0.8888888888888888*epsilon[0]*rdx2Sq[1]+0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[7], globalIdxs[5], 0.006147592613027645*kSq[6]+0.03336355394999686*kSq[5]+0.02697478829999747*kSq[4]+0.01924500897298752*kSq[2]+0.1888888888888889*epsilon[0]*rdx2Sq[1]+0.3111111111111111*epsilon[0]*rdx2Sq[0]-0.02222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[7], globalIdxs[6], (-0.03442651863295482*kSq[7])-0.0295084445425327*kSq[6]-0.05962847939999439*kSq[5]-0.063887656499994*kSq[4]-0.05333333333333333*kSq[3]+0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.03849001794597505*kSq[1]-0.8888888888888888*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[7], globalIdxs[7], (-0.04549218533640458*kSq[7])-0.04549218533640458*kSq[6]-0.0127775312999988*kSq[5]-0.0127775312999988*kSq[4]+(0.2666666666666667*epsilon[0]*rdx2Sq[0]*bcVals[3])/bcVals[4]-0.04666666666666667*kSq[3]-0.03849001794597505*kSq[2]+0.5777777777777777*epsilon[0]*rdx2Sq[1]-0.03849001794597505*kSq[1]+0.5777777777777777*epsilon[0]*rdx2Sq[0]-0.06666666666666667*kSq[0]);

}
void fem_poisson_lhs_stencil_consteps_2x_ser_p1_upx_robinx_loy_dirichlety(const double *epsilon, const double *kSq, const double *dx, const double *bcVals, const long *globalIdxs, gkyl_mat_triples *tri) 
{ 
  // epsilon: permittivity.
  // kSq: wave number squared (factor multiplying phi).
  // dx: cell length in each direction.
  // bcVals[3]: values to impose as BCs, i.e. bcVals[0]*phi+bcVals[1]*d(phi)/dx=bcVals[2].
  // globalIdxs: global linear index of each basis function/node in current cell.
  // tri: triples object (i,j,val), i.e. contribute val to i,j element of the global matrix.

  double rdx2Sq[2];
  rdx2Sq[0] = 4.0/(dx[0]*dx[0]);
  rdx2Sq[1] = 4.0/(dx[1]*dx[1]);

  gkyl_mat_triples_insert(tri, globalIdxs[0], globalIdxs[0], 1.0);
  gkyl_mat_triples_insert(tri, globalIdxs[0], globalIdxs[1], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[0], globalIdxs[2], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[0], globalIdxs[3], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[1], globalIdxs[0], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[1], globalIdxs[1], 1.0);
  gkyl_mat_triples_insert(tri, globalIdxs[1], globalIdxs[2], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[1], globalIdxs[3], 0.0);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[0], (-0.3333333333333333*epsilon[0]*rdx2Sq[1])+0.09622504486493762*kSq[1]+0.1666666666666667*epsilon[0]*rdx2Sq[0]-0.1111111111111111*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[1], (-0.1666666666666667*epsilon[0]*rdx2Sq[1])-0.1666666666666667*epsilon[0]*rdx2Sq[0]-0.05555555555555555*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[2], 0.1666666666666667*kSq[3]-0.1924500897298752*kSq[2]+0.3333333333333333*epsilon[0]*rdx2Sq[1]+0.1924500897298752*kSq[1]+0.3333333333333333*epsilon[0]*rdx2Sq[0]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[3], (-0.09622504486493762*kSq[2])+0.1666666666666667*epsilon[0]*rdx2Sq[1]-0.3333333333333333*epsilon[0]*rdx2Sq[0]-0.1111111111111111*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[0], (-0.1666666666666667*epsilon[0]*rdx2Sq[1])-0.1666666666666667*epsilon[0]*rdx2Sq[0]-0.05555555555555555*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[1], (0.3333333333333333*epsilon[0]*rdx2Sq[0]*bcVals[3])/bcVals[4]-0.3333333333333333*epsilon[0]*rdx2Sq[1]-0.09622504486493762*kSq[1]+0.1666666666666667*epsilon[0]*rdx2Sq[0]-0.1111111111111111*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[2], (-0.09622504486493762*kSq[2])+0.1666666666666667*epsilon[0]*rdx2Sq[1]-0.3333333333333333*epsilon[0]*rdx2Sq[0]-0.1111111111111111*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[3], (0.6666666666666666*epsilon[0]*rdx2Sq[0]*bcVals[3])/bcVals[4]-0.1666666666666667*kSq[3]-0.1924500897298752*kSq[2]+0.3333333333333333*epsilon[0]*rdx2Sq[1]-0.1924500897298752*kSq[1]+0.3333333333333333*epsilon[0]*rdx2Sq[0]-0.2222222222222222*kSq[0]);

}
void fem_poisson_lhs_stencil_consteps_2x_ser_p2_upx_robinx_loy_dirichlety(const double *epsilon, const double *kSq, const double *dx, const double *bcVals, const long *globalIdxs, gkyl_mat_triples *tri) 
{ 
  // epsilon: permittivity.
  // kSq: wave number squared (factor multiplying phi).
  // dx: cell length in each direction.
  // bcVals[3]: values to impose as BCs, i.e. bcVals[0]*phi+bcVals[1]*d(phi)/dx=bcVals[2].
  // globalIdxs: global linear index of each basis function/node in current cell.
  // tri: triples object (i,j,val), i.e. contribute val to i,j element of the global matrix.

  double rdx2Sq[2];
  rdx2Sq[0] = 4.0/(dx[0]*dx[0]);
  rdx2Sq[1] = 4.0/(dx[1]*dx[1]);

  gkyl_mat_triples_insert(tri, globalIdxs[0], globalIdxs[0], 1.0);
  gkyl_mat_triples_insert(tri, globalIdxs[0], globalIdxs[1], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[0], globalIdxs[2], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[0], globalIdxs[3], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[0], globalIdxs[4], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[0], globalIdxs[5], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[0], globalIdxs[6], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[0], globalIdxs[7], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[1], globalIdxs[0], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[1], globalIdxs[1], 1.0);
  gkyl_mat_triples_insert(tri, globalIdxs[1], globalIdxs[2], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[1], globalIdxs[3], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[1], globalIdxs[4], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[1], globalIdxs[5], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[1], globalIdxs[6], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[1], globalIdxs[7], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[2], globalIdxs[0], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[2], globalIdxs[1], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[2], globalIdxs[2], 1.0);
  gkyl_mat_triples_insert(tri, globalIdxs[2], globalIdxs[3], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[2], globalIdxs[4], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[2], globalIdxs[5], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[2], globalIdxs[6], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[2], globalIdxs[7], 0.0);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[0], 0.0295084445425327*kSq[7]+0.03442651863295482*kSq[6]-0.063887656499994*kSq[5]-0.05962847939999439*kSq[4]-0.05333333333333333*kSq[3]+0.03849001794597505*kSq[2]-0.8888888888888888*epsilon[0]*rdx2Sq[1]+0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[1], (-0.03442651863295482*kSq[7])-0.03442651863295482*kSq[6]+0.09938079899999068*kSq[5]+0.09938079899999068*kSq[4]-0.02666666666666666*kSq[3]+0.0769800358919501*kSq[2]+0.0769800358919501*kSq[1]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[2], 0.01721325931647741*kSq[7]-0.05678902799999467*kSq[5]-0.03975231959999626*kSq[4]+0.01333333333333333*kSq[3]-0.4444444444444444*epsilon[0]*rdx2Sq[1]-0.03849001794597505*kSq[1]-0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[3], (-0.1967229636168847*kSq[7])+0.2271561119999787*kSq[5]-0.07950463919999252*kSq[4]+1.777777777777778*epsilon[0]*rdx2Sq[1]+0.3079201435678004*kSq[1]+0.5333333333333333*epsilon[0]*rdx2Sq[0]-0.3555555555555556*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[4], 0.1135780559999893*kSq[5]+0.07950463919999252*kSq[4]+0.8888888888888888*epsilon[0]*rdx2Sq[1]-0.5333333333333333*epsilon[0]*rdx2Sq[0]-0.1777777777777778*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[5], 0.0295084445425327*kSq[7]-0.03442651863295482*kSq[6]-0.063887656499994*kSq[5]-0.05962847939999439*kSq[4]+0.05333333333333333*kSq[3]-0.03849001794597505*kSq[2]-0.8888888888888888*epsilon[0]*rdx2Sq[1]+0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[6], (-0.03442651863295482*kSq[7])+0.03442651863295482*kSq[6]+0.09938079899999068*kSq[5]+0.09938079899999068*kSq[4]+0.02666666666666666*kSq[3]-0.0769800358919501*kSq[2]+0.0769800358919501*kSq[1]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[7], 0.01721325931647741*kSq[7]-0.05678902799999467*kSq[5]-0.03975231959999626*kSq[4]-0.01333333333333333*kSq[3]-0.4444444444444444*epsilon[0]*rdx2Sq[1]-0.03849001794597505*kSq[1]-0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[4], globalIdxs[0], (-0.01721325931647741*kSq[7])-0.05678902799999467*kSq[5]-0.03975231959999626*kSq[4]-0.01333333333333333*kSq[3]-0.4444444444444444*epsilon[0]*rdx2Sq[1]+0.03849001794597505*kSq[1]-0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[4], globalIdxs[1], 0.03442651863295482*kSq[7]-0.03442651863295482*kSq[6]+0.09938079899999068*kSq[5]+0.09938079899999068*kSq[4]+0.02666666666666666*kSq[3]+0.0769800358919501*kSq[2]-0.0769800358919501*kSq[1]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[4], globalIdxs[2], (-0.0295084445425327*kSq[7])+0.03442651863295482*kSq[6]-0.063887656499994*kSq[5]-0.05962847939999439*kSq[4]+(0.1333333333333333*epsilon[0]*rdx2Sq[0]*bcVals[3])/bcVals[4]+0.05333333333333333*kSq[3]+0.03849001794597505*kSq[2]-0.8888888888888888*epsilon[0]*rdx2Sq[1]+0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[4], globalIdxs[3], 0.1135780559999893*kSq[5]+0.07950463919999252*kSq[4]+0.8888888888888888*epsilon[0]*rdx2Sq[1]-0.5333333333333333*epsilon[0]*rdx2Sq[0]-0.1777777777777778*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[4], globalIdxs[4], 0.1967229636168847*kSq[7]+0.2271561119999787*kSq[5]-0.07950463919999252*kSq[4]+(1.066666666666667*epsilon[0]*rdx2Sq[0]*bcVals[3])/bcVals[4]+1.777777777777778*epsilon[0]*rdx2Sq[1]-0.3079201435678004*kSq[1]+0.5333333333333333*epsilon[0]*rdx2Sq[0]-0.3555555555555556*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[4], globalIdxs[5], (-0.01721325931647741*kSq[7])-0.05678902799999467*kSq[5]-0.03975231959999626*kSq[4]+0.01333333333333333*kSq[3]-0.4444444444444444*epsilon[0]*rdx2Sq[1]+0.03849001794597505*kSq[1]-0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[4], globalIdxs[6], 0.03442651863295482*kSq[7]+0.03442651863295482*kSq[6]+0.09938079899999068*kSq[5]+0.09938079899999068*kSq[4]-0.02666666666666666*kSq[3]-0.0769800358919501*kSq[2]-0.0769800358919501*kSq[1]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[4], globalIdxs[7], (-0.0295084445425327*kSq[7])-0.03442651863295482*kSq[6]-0.063887656499994*kSq[5]-0.05962847939999439*kSq[4]+(0.1333333333333333*epsilon[0]*rdx2Sq[0]*bcVals[3])/bcVals[4]-0.05333333333333333*kSq[3]-0.03849001794597505*kSq[2]-0.8888888888888888*epsilon[0]*rdx2Sq[1]+0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[5], globalIdxs[0], (-0.006147592613027645*kSq[7])+0.02697478829999747*kSq[5]+0.03336355394999686*kSq[4]+0.3111111111111111*epsilon[0]*rdx2Sq[1]-0.01924500897298752*kSq[1]+0.1888888888888889*epsilon[0]*rdx2Sq[0]-0.02222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[5], globalIdxs[1], 0.01721325931647741*kSq[6]-0.03975231959999626*kSq[5]-0.05678902799999467*kSq[4]+0.01333333333333333*kSq[3]-0.03849001794597505*kSq[2]-0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.4444444444444444*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[5], globalIdxs[2], 0.0234254740499978*kSq[5]+0.0234254740499978*kSq[4]-0.01333333333333333*kSq[3]+0.2555555555555555*epsilon[0]*rdx2Sq[1]+0.2555555555555555*epsilon[0]*rdx2Sq[0]-0.03333333333333333*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[5], globalIdxs[3], 0.0295084445425327*kSq[7]-0.03442651863295482*kSq[6]-0.063887656499994*kSq[5]-0.05962847939999439*kSq[4]+0.05333333333333333*kSq[3]-0.03849001794597505*kSq[2]-0.8888888888888888*epsilon[0]*rdx2Sq[1]+0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[5], globalIdxs[4], (-0.01721325931647741*kSq[7])-0.05678902799999467*kSq[5]-0.03975231959999626*kSq[4]+0.01333333333333333*kSq[3]-0.4444444444444444*epsilon[0]*rdx2Sq[1]+0.03849001794597505*kSq[1]-0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[5], globalIdxs[5], 0.04549218533640458*kSq[7]-0.04549218533640458*kSq[6]-0.0127775312999988*kSq[5]-0.0127775312999988*kSq[4]+0.04666666666666667*kSq[3]-0.03849001794597505*kSq[2]+0.5777777777777777*epsilon[0]*rdx2Sq[1]+0.03849001794597505*kSq[1]+0.5777777777777777*epsilon[0]*rdx2Sq[0]-0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[5], globalIdxs[6], 0.03442651863295482*kSq[7]-0.0295084445425327*kSq[6]-0.05962847939999439*kSq[5]-0.063887656499994*kSq[4]+0.05333333333333333*kSq[3]+0.06666666666666667*epsilon[0]*rdx2Sq[1]+0.03849001794597505*kSq[1]-0.8888888888888888*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[5], globalIdxs[7], 0.006147592613027645*kSq[6]+0.03336355394999686*kSq[5]+0.02697478829999747*kSq[4]+0.01924500897298752*kSq[2]+0.1888888888888889*epsilon[0]*rdx2Sq[1]+0.3111111111111111*epsilon[0]*rdx2Sq[0]-0.02222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[6], globalIdxs[0], (-0.01721325931647741*kSq[6])-0.03975231959999626*kSq[5]-0.05678902799999467*kSq[4]-0.01333333333333333*kSq[3]+0.03849001794597505*kSq[2]-0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.4444444444444444*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[6], globalIdxs[1], 0.07950463919999252*kSq[5]+0.1135780559999893*kSq[4]-0.5333333333333333*epsilon[0]*rdx2Sq[1]+0.8888888888888888*epsilon[0]*rdx2Sq[0]-0.1777777777777778*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[6], globalIdxs[2], (-0.01721325931647741*kSq[6])-0.03975231959999626*kSq[5]-0.05678902799999467*kSq[4]+0.01333333333333333*kSq[3]+0.03849001794597505*kSq[2]-0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.4444444444444444*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[6], globalIdxs[3], (-0.03442651863295482*kSq[7])+0.03442651863295482*kSq[6]+0.09938079899999068*kSq[5]+0.09938079899999068*kSq[4]+0.02666666666666666*kSq[3]-0.0769800358919501*kSq[2]+0.0769800358919501*kSq[1]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[6], globalIdxs[4], 0.03442651863295482*kSq[7]+0.03442651863295482*kSq[6]+0.09938079899999068*kSq[5]+0.09938079899999068*kSq[4]-0.02666666666666666*kSq[3]-0.0769800358919501*kSq[2]-0.0769800358919501*kSq[1]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[6], globalIdxs[5], 0.03442651863295482*kSq[7]-0.0295084445425327*kSq[6]-0.05962847939999439*kSq[5]-0.063887656499994*kSq[4]+0.05333333333333333*kSq[3]+0.06666666666666667*epsilon[0]*rdx2Sq[1]+0.03849001794597505*kSq[1]-0.8888888888888888*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[6], globalIdxs[6], 0.1967229636168847*kSq[6]-0.07950463919999252*kSq[5]+0.2271561119999787*kSq[4]-0.3079201435678004*kSq[2]+0.5333333333333333*epsilon[0]*rdx2Sq[1]+1.777777777777778*epsilon[0]*rdx2Sq[0]-0.3555555555555556*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[6], globalIdxs[7], (-0.03442651863295482*kSq[7])-0.0295084445425327*kSq[6]-0.05962847939999439*kSq[5]-0.063887656499994*kSq[4]-0.05333333333333333*kSq[3]+0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.03849001794597505*kSq[1]-0.8888888888888888*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[7], globalIdxs[0], 0.0234254740499978*kSq[5]+0.0234254740499978*kSq[4]+0.01333333333333333*kSq[3]+0.2555555555555555*epsilon[0]*rdx2Sq[1]+0.2555555555555555*epsilon[0]*rdx2Sq[0]-0.03333333333333333*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[7], globalIdxs[1], 0.01721325931647741*kSq[6]-0.03975231959999626*kSq[5]-0.05678902799999467*kSq[4]-0.01333333333333333*kSq[3]-0.03849001794597505*kSq[2]-0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.4444444444444444*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[7], globalIdxs[2], 0.006147592613027645*kSq[7]+0.02697478829999747*kSq[5]+0.03336355394999686*kSq[4]-(0.06666666666666667*epsilon[0]*rdx2Sq[0]*bcVals[3])/bcVals[4]+0.3111111111111111*epsilon[0]*rdx2Sq[1]+0.01924500897298752*kSq[1]+0.1888888888888889*epsilon[0]*rdx2Sq[0]-0.02222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[7], globalIdxs[3], 0.01721325931647741*kSq[7]-0.05678902799999467*kSq[5]-0.03975231959999626*kSq[4]-0.01333333333333333*kSq[3]-0.4444444444444444*epsilon[0]*rdx2Sq[1]-0.03849001794597505*kSq[1]-0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[7], globalIdxs[4], (-0.0295084445425327*kSq[7])-0.03442651863295482*kSq[6]-0.063887656499994*kSq[5]-0.05962847939999439*kSq[4]+(0.1333333333333333*epsilon[0]*rdx2Sq[0]*bcVals[3])/bcVals[4]-0.05333333333333333*kSq[3]-0.03849001794597505*kSq[2]-0.8888888888888888*epsilon[0]*rdx2Sq[1]+0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[7], globalIdxs[5], 0.006147592613027645*kSq[6]+0.03336355394999686*kSq[5]+0.02697478829999747*kSq[4]+0.01924500897298752*kSq[2]+0.1888888888888889*epsilon[0]*rdx2Sq[1]+0.3111111111111111*epsilon[0]*rdx2Sq[0]-0.02222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[7], globalIdxs[6], (-0.03442651863295482*kSq[7])-0.0295084445425327*kSq[6]-0.05962847939999439*kSq[5]-0.063887656499994*kSq[4]-0.05333333333333333*kSq[3]+0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.03849001794597505*kSq[1]-0.8888888888888888*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[7], globalIdxs[7], (-0.04549218533640458*kSq[7])-0.04549218533640458*kSq[6]-0.0127775312999988*kSq[5]-0.0127775312999988*kSq[4]+(0.2666666666666667*epsilon[0]*rdx2Sq[0]*bcVals[3])/bcVals[4]-0.04666666666666667*kSq[3]-0.03849001794597505*kSq[2]+0.5777777777777777*epsilon[0]*rdx2Sq[1]-0.03849001794597505*kSq[1]+0.5777777777777777*epsilon[0]*rdx2Sq[0]-0.06666666666666667*kSq[0]);

}
void fem_poisson_lhs_stencil_consteps_2x_ser_p1_upx_robinx_loy_neumanny(const double *epsilon, const double *kSq, const double *dx, const double *bcVals, const long *globalIdxs, gkyl_mat_triples *tri) 
{ 
  // epsilon: permittivity.
  // kSq: wave number squared (factor multiplying phi).
  // dx: cell length in each direction.
  // bcVals[3]: values to impose as BCs, i.e. bcVals[0]*phi+bcVals[1]*d(phi)/dx=bcVals[2].
  // globalIdxs: global linear index of each basis function/node in current cell.
  // tri: triples object (i,j,val), i.e. contribute val to i,j element of the global matrix.

  double rdx2Sq[2];
  rdx2Sq[0] = 4.0/(dx[0]*dx[0]);
  rdx2Sq[1] = 4.0/(dx[1]*dx[1]);

  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[0], (-0.1666666666666667*kSq[3])+0.1924500897298752*kSq[2]+0.3333333333333333*epsilon[0]*rdx2Sq[1]+0.1924500897298752*kSq[1]+0.3333333333333333*epsilon[0]*rdx2Sq[0]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[1], 0.09622504486493762*kSq[2]+0.1666666666666667*epsilon[0]*rdx2Sq[1]-0.3333333333333333*epsilon[0]*rdx2Sq[0]-0.1111111111111111*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[2], (-0.3333333333333333*epsilon[0]*rdx2Sq[1])+0.09622504486493762*kSq[1]+0.1666666666666667*epsilon[0]*rdx2Sq[0]-0.1111111111111111*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[3], (-0.1666666666666667*epsilon[0]*rdx2Sq[1])-0.1666666666666667*epsilon[0]*rdx2Sq[0]-0.05555555555555555*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[0], 0.09622504486493762*kSq[2]+0.1666666666666667*epsilon[0]*rdx2Sq[1]-0.3333333333333333*epsilon[0]*rdx2Sq[0]-0.1111111111111111*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[1], (0.6666666666666666*epsilon[0]*rdx2Sq[0]*bcVals[3])/bcVals[4]+0.1666666666666667*kSq[3]+0.1924500897298752*kSq[2]+0.3333333333333333*epsilon[0]*rdx2Sq[1]-0.1924500897298752*kSq[1]+0.3333333333333333*epsilon[0]*rdx2Sq[0]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[2], (-0.1666666666666667*epsilon[0]*rdx2Sq[1])-0.1666666666666667*epsilon[0]*rdx2Sq[0]-0.05555555555555555*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[3], (0.3333333333333333*epsilon[0]*rdx2Sq[0]*bcVals[3])/bcVals[4]-0.3333333333333333*epsilon[0]*rdx2Sq[1]-0.09622504486493762*kSq[1]+0.1666666666666667*epsilon[0]*rdx2Sq[0]-0.1111111111111111*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[0], (-0.3333333333333333*epsilon[0]*rdx2Sq[1])+0.09622504486493762*kSq[1]+0.1666666666666667*epsilon[0]*rdx2Sq[0]-0.1111111111111111*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[1], (-0.1666666666666667*epsilon[0]*rdx2Sq[1])-0.1666666666666667*epsilon[0]*rdx2Sq[0]-0.05555555555555555*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[2], 0.1666666666666667*kSq[3]-0.1924500897298752*kSq[2]+0.3333333333333333*epsilon[0]*rdx2Sq[1]+0.1924500897298752*kSq[1]+0.3333333333333333*epsilon[0]*rdx2Sq[0]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[3], (-0.09622504486493762*kSq[2])+0.1666666666666667*epsilon[0]*rdx2Sq[1]-0.3333333333333333*epsilon[0]*rdx2Sq[0]-0.1111111111111111*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[0], (-0.1666666666666667*epsilon[0]*rdx2Sq[1])-0.1666666666666667*epsilon[0]*rdx2Sq[0]-0.05555555555555555*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[1], (0.3333333333333333*epsilon[0]*rdx2Sq[0]*bcVals[3])/bcVals[4]-0.3333333333333333*epsilon[0]*rdx2Sq[1]-0.09622504486493762*kSq[1]+0.1666666666666667*epsilon[0]*rdx2Sq[0]-0.1111111111111111*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[2], (-0.09622504486493762*kSq[2])+0.1666666666666667*epsilon[0]*rdx2Sq[1]-0.3333333333333333*epsilon[0]*rdx2Sq[0]-0.1111111111111111*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[3], (0.6666666666666666*epsilon[0]*rdx2Sq[0]*bcVals[3])/bcVals[4]-0.1666666666666667*kSq[3]-0.1924500897298752*kSq[2]+0.3333333333333333*epsilon[0]*rdx2Sq[1]-0.1924500897298752*kSq[1]+0.3333333333333333*epsilon[0]*rdx2Sq[0]-0.2222222222222222*kSq[0]);

}
void fem_poisson_lhs_stencil_consteps_2x_ser_p2_upx_robinx_loy_neumanny(const double *epsilon, const double *kSq, const double *dx, const double *bcVals, const long *globalIdxs, gkyl_mat_triples *tri) 
{ 
  // epsilon: permittivity.
  // kSq: wave number squared (factor multiplying phi).
  // dx: cell length in each direction.
  // bcVals[3]: values to impose as BCs, i.e. bcVals[0]*phi+bcVals[1]*d(phi)/dx=bcVals[2].
  // globalIdxs: global linear index of each basis function/node in current cell.
  // tri: triples object (i,j,val), i.e. contribute val to i,j element of the global matrix.

  double rdx2Sq[2];
  rdx2Sq[0] = 4.0/(dx[0]*dx[0]);
  rdx2Sq[1] = 4.0/(dx[1]*dx[1]);

  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[0], 0.04549218533640458*kSq[7]+0.04549218533640458*kSq[6]-0.0127775312999988*kSq[5]-0.0127775312999988*kSq[4]-0.04666666666666667*kSq[3]+0.03849001794597505*kSq[2]+0.5777777777777777*epsilon[0]*rdx2Sq[1]+0.03849001794597505*kSq[1]+0.5777777777777777*epsilon[0]*rdx2Sq[0]-0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[1], 0.03442651863295482*kSq[7]+0.0295084445425327*kSq[6]-0.05962847939999439*kSq[5]-0.063887656499994*kSq[4]-0.05333333333333333*kSq[3]+0.06666666666666667*epsilon[0]*rdx2Sq[1]+0.03849001794597505*kSq[1]-0.8888888888888888*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[2], (-0.006147592613027645*kSq[6])+0.03336355394999686*kSq[5]+0.02697478829999747*kSq[4]-0.01924500897298752*kSq[2]+0.1888888888888889*epsilon[0]*rdx2Sq[1]+0.3111111111111111*epsilon[0]*rdx2Sq[0]-0.02222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[3], 0.0295084445425327*kSq[7]+0.03442651863295482*kSq[6]-0.063887656499994*kSq[5]-0.05962847939999439*kSq[4]-0.05333333333333333*kSq[3]+0.03849001794597505*kSq[2]-0.8888888888888888*epsilon[0]*rdx2Sq[1]+0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[4], (-0.01721325931647741*kSq[7])-0.05678902799999467*kSq[5]-0.03975231959999626*kSq[4]-0.01333333333333333*kSq[3]-0.4444444444444444*epsilon[0]*rdx2Sq[1]+0.03849001794597505*kSq[1]-0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[5], (-0.006147592613027645*kSq[7])+0.02697478829999747*kSq[5]+0.03336355394999686*kSq[4]+0.3111111111111111*epsilon[0]*rdx2Sq[1]-0.01924500897298752*kSq[1]+0.1888888888888889*epsilon[0]*rdx2Sq[0]-0.02222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[6], (-0.01721325931647741*kSq[6])-0.03975231959999626*kSq[5]-0.05678902799999467*kSq[4]-0.01333333333333333*kSq[3]+0.03849001794597505*kSq[2]-0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.4444444444444444*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[7], 0.0234254740499978*kSq[5]+0.0234254740499978*kSq[4]+0.01333333333333333*kSq[3]+0.2555555555555555*epsilon[0]*rdx2Sq[1]+0.2555555555555555*epsilon[0]*rdx2Sq[0]-0.03333333333333333*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[0], 0.03442651863295482*kSq[7]+0.0295084445425327*kSq[6]-0.05962847939999439*kSq[5]-0.063887656499994*kSq[4]-0.05333333333333333*kSq[3]+0.06666666666666667*epsilon[0]*rdx2Sq[1]+0.03849001794597505*kSq[1]-0.8888888888888888*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[1], (-0.1967229636168847*kSq[6])-0.07950463919999252*kSq[5]+0.2271561119999787*kSq[4]+0.3079201435678004*kSq[2]+0.5333333333333333*epsilon[0]*rdx2Sq[1]+1.777777777777778*epsilon[0]*rdx2Sq[0]-0.3555555555555556*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[2], (-0.03442651863295482*kSq[7])+0.0295084445425327*kSq[6]-0.05962847939999439*kSq[5]-0.063887656499994*kSq[4]+0.05333333333333333*kSq[3]+0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.03849001794597505*kSq[1]-0.8888888888888888*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[3], (-0.03442651863295482*kSq[7])-0.03442651863295482*kSq[6]+0.09938079899999068*kSq[5]+0.09938079899999068*kSq[4]-0.02666666666666666*kSq[3]+0.0769800358919501*kSq[2]+0.0769800358919501*kSq[1]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[4], 0.03442651863295482*kSq[7]-0.03442651863295482*kSq[6]+0.09938079899999068*kSq[5]+0.09938079899999068*kSq[4]+0.02666666666666666*kSq[3]+0.0769800358919501*kSq[2]-0.0769800358919501*kSq[1]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[5], 0.01721325931647741*kSq[6]-0.03975231959999626*kSq[5]-0.05678902799999467*kSq[4]+0.01333333333333333*kSq[3]-0.03849001794597505*kSq[2]-0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.4444444444444444*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[6], 0.07950463919999252*kSq[5]+0.1135780559999893*kSq[4]-0.5333333333333333*epsilon[0]*rdx2Sq[1]+0.8888888888888888*epsilon[0]*rdx2Sq[0]-0.1777777777777778*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[7], 0.01721325931647741*kSq[6]-0.03975231959999626*kSq[5]-0.05678902799999467*kSq[4]-0.01333333333333333*kSq[3]-0.03849001794597505*kSq[2]-0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.4444444444444444*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[0], (-0.006147592613027645*kSq[6])+0.03336355394999686*kSq[5]+0.02697478829999747*kSq[4]-0.01924500897298752*kSq[2]+0.1888888888888889*epsilon[0]*rdx2Sq[1]+0.3111111111111111*epsilon[0]*rdx2Sq[0]-0.02222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[1], (-0.03442651863295482*kSq[7])+0.0295084445425327*kSq[6]-0.05962847939999439*kSq[5]-0.063887656499994*kSq[4]+0.05333333333333333*kSq[3]+0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.03849001794597505*kSq[1]-0.8888888888888888*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[2], (-0.04549218533640458*kSq[7])+0.04549218533640458*kSq[6]-0.0127775312999988*kSq[5]-0.0127775312999988*kSq[4]+(0.2666666666666667*epsilon[0]*rdx2Sq[0]*bcVals[3])/bcVals[4]+0.04666666666666667*kSq[3]+0.03849001794597505*kSq[2]+0.5777777777777777*epsilon[0]*rdx2Sq[1]-0.03849001794597505*kSq[1]+0.5777777777777777*epsilon[0]*rdx2Sq[0]-0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[3], 0.01721325931647741*kSq[7]-0.05678902799999467*kSq[5]-0.03975231959999626*kSq[4]+0.01333333333333333*kSq[3]-0.4444444444444444*epsilon[0]*rdx2Sq[1]-0.03849001794597505*kSq[1]-0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[4], (-0.0295084445425327*kSq[7])+0.03442651863295482*kSq[6]-0.063887656499994*kSq[5]-0.05962847939999439*kSq[4]+(0.1333333333333333*epsilon[0]*rdx2Sq[0]*bcVals[3])/bcVals[4]+0.05333333333333333*kSq[3]+0.03849001794597505*kSq[2]-0.8888888888888888*epsilon[0]*rdx2Sq[1]+0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[5], 0.0234254740499978*kSq[5]+0.0234254740499978*kSq[4]-0.01333333333333333*kSq[3]+0.2555555555555555*epsilon[0]*rdx2Sq[1]+0.2555555555555555*epsilon[0]*rdx2Sq[0]-0.03333333333333333*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[6], (-0.01721325931647741*kSq[6])-0.03975231959999626*kSq[5]-0.05678902799999467*kSq[4]+0.01333333333333333*kSq[3]+0.03849001794597505*kSq[2]-0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.4444444444444444*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[7], 0.006147592613027645*kSq[7]+0.02697478829999747*kSq[5]+0.03336355394999686*kSq[4]-(0.06666666666666667*epsilon[0]*rdx2Sq[0]*bcVals[3])/bcVals[4]+0.3111111111111111*epsilon[0]*rdx2Sq[1]+0.01924500897298752*kSq[1]+0.1888888888888889*epsilon[0]*rdx2Sq[0]-0.02222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[0], 0.0295084445425327*kSq[7]+0.03442651863295482*kSq[6]-0.063887656499994*kSq[5]-0.05962847939999439*kSq[4]-0.05333333333333333*kSq[3]+0.03849001794597505*kSq[2]-0.8888888888888888*epsilon[0]*rdx2Sq[1]+0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[1], (-0.03442651863295482*kSq[7])-0.03442651863295482*kSq[6]+0.09938079899999068*kSq[5]+0.09938079899999068*kSq[4]-0.02666666666666666*kSq[3]+0.0769800358919501*kSq[2]+0.0769800358919501*kSq[1]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[2], 0.01721325931647741*kSq[7]-0.05678902799999467*kSq[5]-0.03975231959999626*kSq[4]+0.01333333333333333*kSq[3]-0.4444444444444444*epsilon[0]*rdx2Sq[1]-0.03849001794597505*kSq[1]-0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[3], (-0.1967229636168847*kSq[7])+0.2271561119999787*kSq[5]-0.07950463919999252*kSq[4]+1.777777777777778*epsilon[0]*rdx2Sq[1]+0.3079201435678004*kSq[1]+0.5333333333333333*epsilon[0]*rdx2Sq[0]-0.3555555555555556*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[4], 0.1135780559999893*kSq[5]+0.07950463919999252*kSq[4]+0.8888888888888888*epsilon[0]*rdx2Sq[1]-0.5333333333333333*epsilon[0]*rdx2Sq[0]-0.1777777777777778*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[5], 0.0295084445425327*kSq[7]-0.03442651863295482*kSq[6]-0.063887656499994*kSq[5]-0.05962847939999439*kSq[4]+0.05333333333333333*kSq[3]-0.03849001794597505*kSq[2]-0.8888888888888888*epsilon[0]*rdx2Sq[1]+0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[6], (-0.03442651863295482*kSq[7])+0.03442651863295482*kSq[6]+0.09938079899999068*kSq[5]+0.09938079899999068*kSq[4]+0.02666666666666666*kSq[3]-0.0769800358919501*kSq[2]+0.0769800358919501*kSq[1]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[7], 0.01721325931647741*kSq[7]-0.05678902799999467*kSq[5]-0.03975231959999626*kSq[4]-0.01333333333333333*kSq[3]-0.4444444444444444*epsilon[0]*rdx2Sq[1]-0.03849001794597505*kSq[1]-0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[4], globalIdxs[0], (-0.01721325931647741*kSq[7])-0.05678902799999467*kSq[5]-0.03975231959999626*kSq[4]-0.01333333333333333*kSq[3]-0.4444444444444444*epsilon[0]*rdx2Sq[1]+0.03849001794597505*kSq[1]-0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[4], globalIdxs[1], 0.03442651863295482*kSq[7]-0.03442651863295482*kSq[6]+0.09938079899999068*kSq[5]+0.09938079899999068*kSq[4]+0.02666666666666666*kSq[3]+0.0769800358919501*kSq[2]-0.0769800358919501*kSq[1]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[4], globalIdxs[2], (-0.0295084445425327*kSq[7])+0.03442651863295482*kSq[6]-0.063887656499994*kSq[5]-0.05962847939999439*kSq[4]+(0.1333333333333333*epsilon[0]*rdx2Sq[0]*bcVals[3])/bcVals[4]+0.05333333333333333*kSq[3]+0.03849001794597505*kSq[2]-0.8888888888888888*epsilon[0]*rdx2Sq[1]+0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[4], globalIdxs[3], 0.1135780559999893*kSq[5]+0.07950463919999252*kSq[4]+0.8888888888888888*epsilon[0]*rdx2Sq[1]-0.5333333333333333*epsilon[0]*rdx2Sq[0]-0.1777777777777778*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[4], globalIdxs[4], 0.1967229636168847*kSq[7]+0.2271561119999787*kSq[5]-0.07950463919999252*kSq[4]+(1.066666666666667*epsilon[0]*rdx2Sq[0]*bcVals[3])/bcVals[4]+1.777777777777778*epsilon[0]*rdx2Sq[1]-0.3079201435678004*kSq[1]+0.5333333333333333*epsilon[0]*rdx2Sq[0]-0.3555555555555556*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[4], globalIdxs[5], (-0.01721325931647741*kSq[7])-0.05678902799999467*kSq[5]-0.03975231959999626*kSq[4]+0.01333333333333333*kSq[3]-0.4444444444444444*epsilon[0]*rdx2Sq[1]+0.03849001794597505*kSq[1]-0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[4], globalIdxs[6], 0.03442651863295482*kSq[7]+0.03442651863295482*kSq[6]+0.09938079899999068*kSq[5]+0.09938079899999068*kSq[4]-0.02666666666666666*kSq[3]-0.0769800358919501*kSq[2]-0.0769800358919501*kSq[1]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[4], globalIdxs[7], (-0.0295084445425327*kSq[7])-0.03442651863295482*kSq[6]-0.063887656499994*kSq[5]-0.05962847939999439*kSq[4]+(0.1333333333333333*epsilon[0]*rdx2Sq[0]*bcVals[3])/bcVals[4]-0.05333333333333333*kSq[3]-0.03849001794597505*kSq[2]-0.8888888888888888*epsilon[0]*rdx2Sq[1]+0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[5], globalIdxs[0], (-0.006147592613027645*kSq[7])+0.02697478829999747*kSq[5]+0.03336355394999686*kSq[4]+0.3111111111111111*epsilon[0]*rdx2Sq[1]-0.01924500897298752*kSq[1]+0.1888888888888889*epsilon[0]*rdx2Sq[0]-0.02222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[5], globalIdxs[1], 0.01721325931647741*kSq[6]-0.03975231959999626*kSq[5]-0.05678902799999467*kSq[4]+0.01333333333333333*kSq[3]-0.03849001794597505*kSq[2]-0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.4444444444444444*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[5], globalIdxs[2], 0.0234254740499978*kSq[5]+0.0234254740499978*kSq[4]-0.01333333333333333*kSq[3]+0.2555555555555555*epsilon[0]*rdx2Sq[1]+0.2555555555555555*epsilon[0]*rdx2Sq[0]-0.03333333333333333*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[5], globalIdxs[3], 0.0295084445425327*kSq[7]-0.03442651863295482*kSq[6]-0.063887656499994*kSq[5]-0.05962847939999439*kSq[4]+0.05333333333333333*kSq[3]-0.03849001794597505*kSq[2]-0.8888888888888888*epsilon[0]*rdx2Sq[1]+0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[5], globalIdxs[4], (-0.01721325931647741*kSq[7])-0.05678902799999467*kSq[5]-0.03975231959999626*kSq[4]+0.01333333333333333*kSq[3]-0.4444444444444444*epsilon[0]*rdx2Sq[1]+0.03849001794597505*kSq[1]-0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[5], globalIdxs[5], 0.04549218533640458*kSq[7]-0.04549218533640458*kSq[6]-0.0127775312999988*kSq[5]-0.0127775312999988*kSq[4]+0.04666666666666667*kSq[3]-0.03849001794597505*kSq[2]+0.5777777777777777*epsilon[0]*rdx2Sq[1]+0.03849001794597505*kSq[1]+0.5777777777777777*epsilon[0]*rdx2Sq[0]-0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[5], globalIdxs[6], 0.03442651863295482*kSq[7]-0.0295084445425327*kSq[6]-0.05962847939999439*kSq[5]-0.063887656499994*kSq[4]+0.05333333333333333*kSq[3]+0.06666666666666667*epsilon[0]*rdx2Sq[1]+0.03849001794597505*kSq[1]-0.8888888888888888*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[5], globalIdxs[7], 0.006147592613027645*kSq[6]+0.03336355394999686*kSq[5]+0.02697478829999747*kSq[4]+0.01924500897298752*kSq[2]+0.1888888888888889*epsilon[0]*rdx2Sq[1]+0.3111111111111111*epsilon[0]*rdx2Sq[0]-0.02222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[6], globalIdxs[0], (-0.01721325931647741*kSq[6])-0.03975231959999626*kSq[5]-0.05678902799999467*kSq[4]-0.01333333333333333*kSq[3]+0.03849001794597505*kSq[2]-0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.4444444444444444*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[6], globalIdxs[1], 0.07950463919999252*kSq[5]+0.1135780559999893*kSq[4]-0.5333333333333333*epsilon[0]*rdx2Sq[1]+0.8888888888888888*epsilon[0]*rdx2Sq[0]-0.1777777777777778*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[6], globalIdxs[2], (-0.01721325931647741*kSq[6])-0.03975231959999626*kSq[5]-0.05678902799999467*kSq[4]+0.01333333333333333*kSq[3]+0.03849001794597505*kSq[2]-0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.4444444444444444*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[6], globalIdxs[3], (-0.03442651863295482*kSq[7])+0.03442651863295482*kSq[6]+0.09938079899999068*kSq[5]+0.09938079899999068*kSq[4]+0.02666666666666666*kSq[3]-0.0769800358919501*kSq[2]+0.0769800358919501*kSq[1]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[6], globalIdxs[4], 0.03442651863295482*kSq[7]+0.03442651863295482*kSq[6]+0.09938079899999068*kSq[5]+0.09938079899999068*kSq[4]-0.02666666666666666*kSq[3]-0.0769800358919501*kSq[2]-0.0769800358919501*kSq[1]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[6], globalIdxs[5], 0.03442651863295482*kSq[7]-0.0295084445425327*kSq[6]-0.05962847939999439*kSq[5]-0.063887656499994*kSq[4]+0.05333333333333333*kSq[3]+0.06666666666666667*epsilon[0]*rdx2Sq[1]+0.03849001794597505*kSq[1]-0.8888888888888888*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[6], globalIdxs[6], 0.1967229636168847*kSq[6]-0.07950463919999252*kSq[5]+0.2271561119999787*kSq[4]-0.3079201435678004*kSq[2]+0.5333333333333333*epsilon[0]*rdx2Sq[1]+1.777777777777778*epsilon[0]*rdx2Sq[0]-0.3555555555555556*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[6], globalIdxs[7], (-0.03442651863295482*kSq[7])-0.0295084445425327*kSq[6]-0.05962847939999439*kSq[5]-0.063887656499994*kSq[4]-0.05333333333333333*kSq[3]+0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.03849001794597505*kSq[1]-0.8888888888888888*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[7], globalIdxs[0], 0.0234254740499978*kSq[5]+0.0234254740499978*kSq[4]+0.01333333333333333*kSq[3]+0.2555555555555555*epsilon[0]*rdx2Sq[1]+0.2555555555555555*epsilon[0]*rdx2Sq[0]-0.03333333333333333*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[7], globalIdxs[1], 0.01721325931647741*kSq[6]-0.03975231959999626*kSq[5]-0.05678902799999467*kSq[4]-0.01333333333333333*kSq[3]-0.03849001794597505*kSq[2]-0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.4444444444444444*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[7], globalIdxs[2], 0.006147592613027645*kSq[7]+0.02697478829999747*kSq[5]+0.03336355394999686*kSq[4]-(0.06666666666666667*epsilon[0]*rdx2Sq[0]*bcVals[3])/bcVals[4]+0.3111111111111111*epsilon[0]*rdx2Sq[1]+0.01924500897298752*kSq[1]+0.1888888888888889*epsilon[0]*rdx2Sq[0]-0.02222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[7], globalIdxs[3], 0.01721325931647741*kSq[7]-0.05678902799999467*kSq[5]-0.03975231959999626*kSq[4]-0.01333333333333333*kSq[3]-0.4444444444444444*epsilon[0]*rdx2Sq[1]-0.03849001794597505*kSq[1]-0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[7], globalIdxs[4], (-0.0295084445425327*kSq[7])-0.03442651863295482*kSq[6]-0.063887656499994*kSq[5]-0.05962847939999439*kSq[4]+(0.1333333333333333*epsilon[0]*rdx2Sq[0]*bcVals[3])/bcVals[4]-0.05333333333333333*kSq[3]-0.03849001794597505*kSq[2]-0.8888888888888888*epsilon[0]*rdx2Sq[1]+0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[7], globalIdxs[5], 0.006147592613027645*kSq[6]+0.03336355394999686*kSq[5]+0.02697478829999747*kSq[4]+0.01924500897298752*kSq[2]+0.1888888888888889*epsilon[0]*rdx2Sq[1]+0.3111111111111111*epsilon[0]*rdx2Sq[0]-0.02222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[7], globalIdxs[6], (-0.03442651863295482*kSq[7])-0.0295084445425327*kSq[6]-0.05962847939999439*kSq[5]-0.063887656499994*kSq[4]-0.05333333333333333*kSq[3]+0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.03849001794597505*kSq[1]-0.8888888888888888*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[7], globalIdxs[7], (-0.04549218533640458*kSq[7])-0.04549218533640458*kSq[6]-0.0127775312999988*kSq[5]-0.0127775312999988*kSq[4]+(0.2666666666666667*epsilon[0]*rdx2Sq[0]*bcVals[3])/bcVals[4]-0.04666666666666667*kSq[3]-0.03849001794597505*kSq[2]+0.5777777777777777*epsilon[0]*rdx2Sq[1]-0.03849001794597505*kSq[1]+0.5777777777777777*epsilon[0]*rdx2Sq[0]-0.06666666666666667*kSq[0]);

}
void fem_poisson_lhs_stencil_consteps_2x_ser_p1_upx_robinx_loy_robiny(const double *epsilon, const double *kSq, const double *dx, const double *bcVals, const long *globalIdxs, gkyl_mat_triples *tri) 
{ 
  // epsilon: permittivity.
  // kSq: wave number squared (factor multiplying phi).
  // dx: cell length in each direction.
  // bcVals[3]: values to impose as BCs, i.e. bcVals[0]*phi+bcVals[1]*d(phi)/dx=bcVals[2].
  // globalIdxs: global linear index of each basis function/node in current cell.
  // tri: triples object (i,j,val), i.e. contribute val to i,j element of the global matrix.

  double rdx2Sq[2];
  rdx2Sq[0] = 4.0/(dx[0]*dx[0]);
  rdx2Sq[1] = 4.0/(dx[1]*dx[1]);

  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[0], (-(0.6666666666666666*epsilon[0]*rdx2Sq[1]*bcVals[6])/bcVals[7])-0.1666666666666667*kSq[3]+0.1924500897298752*kSq[2]+0.3333333333333333*epsilon[0]*rdx2Sq[1]+0.1924500897298752*kSq[1]+0.3333333333333333*epsilon[0]*rdx2Sq[0]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[1], (-(0.3333333333333333*epsilon[0]*rdx2Sq[1]*bcVals[6])/bcVals[7])+0.09622504486493762*kSq[2]+0.1666666666666667*epsilon[0]*rdx2Sq[1]-0.3333333333333333*epsilon[0]*rdx2Sq[0]-0.1111111111111111*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[2], (-0.3333333333333333*epsilon[0]*rdx2Sq[1])+0.09622504486493762*kSq[1]+0.1666666666666667*epsilon[0]*rdx2Sq[0]-0.1111111111111111*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[3], (-0.1666666666666667*epsilon[0]*rdx2Sq[1])-0.1666666666666667*epsilon[0]*rdx2Sq[0]-0.05555555555555555*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[0], (-(0.3333333333333333*epsilon[0]*rdx2Sq[1]*bcVals[6])/bcVals[7])+0.09622504486493762*kSq[2]+0.1666666666666667*epsilon[0]*rdx2Sq[1]-0.3333333333333333*epsilon[0]*rdx2Sq[0]-0.1111111111111111*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[1], (-(0.6666666666666666*epsilon[0]*rdx2Sq[1]*bcVals[6])/bcVals[7])+(0.6666666666666666*epsilon[0]*rdx2Sq[0]*bcVals[3])/bcVals[4]+0.1666666666666667*kSq[3]+0.1924500897298752*kSq[2]+0.3333333333333333*epsilon[0]*rdx2Sq[1]-0.1924500897298752*kSq[1]+0.3333333333333333*epsilon[0]*rdx2Sq[0]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[2], (-0.1666666666666667*epsilon[0]*rdx2Sq[1])-0.1666666666666667*epsilon[0]*rdx2Sq[0]-0.05555555555555555*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[3], (0.3333333333333333*epsilon[0]*rdx2Sq[0]*bcVals[3])/bcVals[4]-0.3333333333333333*epsilon[0]*rdx2Sq[1]-0.09622504486493762*kSq[1]+0.1666666666666667*epsilon[0]*rdx2Sq[0]-0.1111111111111111*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[0], (-0.3333333333333333*epsilon[0]*rdx2Sq[1])+0.09622504486493762*kSq[1]+0.1666666666666667*epsilon[0]*rdx2Sq[0]-0.1111111111111111*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[1], (-0.1666666666666667*epsilon[0]*rdx2Sq[1])-0.1666666666666667*epsilon[0]*rdx2Sq[0]-0.05555555555555555*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[2], 0.1666666666666667*kSq[3]-0.1924500897298752*kSq[2]+0.3333333333333333*epsilon[0]*rdx2Sq[1]+0.1924500897298752*kSq[1]+0.3333333333333333*epsilon[0]*rdx2Sq[0]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[3], (-0.09622504486493762*kSq[2])+0.1666666666666667*epsilon[0]*rdx2Sq[1]-0.3333333333333333*epsilon[0]*rdx2Sq[0]-0.1111111111111111*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[0], (-0.1666666666666667*epsilon[0]*rdx2Sq[1])-0.1666666666666667*epsilon[0]*rdx2Sq[0]-0.05555555555555555*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[1], (0.3333333333333333*epsilon[0]*rdx2Sq[0]*bcVals[3])/bcVals[4]-0.3333333333333333*epsilon[0]*rdx2Sq[1]-0.09622504486493762*kSq[1]+0.1666666666666667*epsilon[0]*rdx2Sq[0]-0.1111111111111111*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[2], (-0.09622504486493762*kSq[2])+0.1666666666666667*epsilon[0]*rdx2Sq[1]-0.3333333333333333*epsilon[0]*rdx2Sq[0]-0.1111111111111111*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[3], (0.6666666666666666*epsilon[0]*rdx2Sq[0]*bcVals[3])/bcVals[4]-0.1666666666666667*kSq[3]-0.1924500897298752*kSq[2]+0.3333333333333333*epsilon[0]*rdx2Sq[1]-0.1924500897298752*kSq[1]+0.3333333333333333*epsilon[0]*rdx2Sq[0]-0.2222222222222222*kSq[0]);

}
void fem_poisson_lhs_stencil_consteps_2x_ser_p2_upx_robinx_loy_robiny(const double *epsilon, const double *kSq, const double *dx, const double *bcVals, const long *globalIdxs, gkyl_mat_triples *tri) 
{ 
  // epsilon: permittivity.
  // kSq: wave number squared (factor multiplying phi).
  // dx: cell length in each direction.
  // bcVals[3]: values to impose as BCs, i.e. bcVals[0]*phi+bcVals[1]*d(phi)/dx=bcVals[2].
  // globalIdxs: global linear index of each basis function/node in current cell.
  // tri: triples object (i,j,val), i.e. contribute val to i,j element of the global matrix.

  double rdx2Sq[2];
  rdx2Sq[0] = 4.0/(dx[0]*dx[0]);
  rdx2Sq[1] = 4.0/(dx[1]*dx[1]);

  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[0], 0.04549218533640458*kSq[7]-(0.2666666666666667*epsilon[0]*rdx2Sq[1]*bcVals[6])/bcVals[7]+0.04549218533640458*kSq[6]-0.0127775312999988*kSq[5]-0.0127775312999988*kSq[4]-0.04666666666666667*kSq[3]+0.03849001794597505*kSq[2]+0.5777777777777777*epsilon[0]*rdx2Sq[1]+0.03849001794597505*kSq[1]+0.5777777777777777*epsilon[0]*rdx2Sq[0]-0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[1], 0.03442651863295482*kSq[7]-(0.1333333333333333*epsilon[0]*rdx2Sq[1]*bcVals[6])/bcVals[7]+0.0295084445425327*kSq[6]-0.05962847939999439*kSq[5]-0.063887656499994*kSq[4]-0.05333333333333333*kSq[3]+0.06666666666666667*epsilon[0]*rdx2Sq[1]+0.03849001794597505*kSq[1]-0.8888888888888888*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[2], (0.06666666666666667*epsilon[0]*rdx2Sq[1]*bcVals[6])/bcVals[7]-0.006147592613027645*kSq[6]+0.03336355394999686*kSq[5]+0.02697478829999747*kSq[4]-0.01924500897298752*kSq[2]+0.1888888888888889*epsilon[0]*rdx2Sq[1]+0.3111111111111111*epsilon[0]*rdx2Sq[0]-0.02222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[3], 0.0295084445425327*kSq[7]+0.03442651863295482*kSq[6]-0.063887656499994*kSq[5]-0.05962847939999439*kSq[4]-0.05333333333333333*kSq[3]+0.03849001794597505*kSq[2]-0.8888888888888888*epsilon[0]*rdx2Sq[1]+0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[4], (-0.01721325931647741*kSq[7])-0.05678902799999467*kSq[5]-0.03975231959999626*kSq[4]-0.01333333333333333*kSq[3]-0.4444444444444444*epsilon[0]*rdx2Sq[1]+0.03849001794597505*kSq[1]-0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[5], (-0.006147592613027645*kSq[7])+0.02697478829999747*kSq[5]+0.03336355394999686*kSq[4]+0.3111111111111111*epsilon[0]*rdx2Sq[1]-0.01924500897298752*kSq[1]+0.1888888888888889*epsilon[0]*rdx2Sq[0]-0.02222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[6], (-0.01721325931647741*kSq[6])-0.03975231959999626*kSq[5]-0.05678902799999467*kSq[4]-0.01333333333333333*kSq[3]+0.03849001794597505*kSq[2]-0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.4444444444444444*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[7], 0.0234254740499978*kSq[5]+0.0234254740499978*kSq[4]+0.01333333333333333*kSq[3]+0.2555555555555555*epsilon[0]*rdx2Sq[1]+0.2555555555555555*epsilon[0]*rdx2Sq[0]-0.03333333333333333*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[0], 0.03442651863295482*kSq[7]-(0.1333333333333333*epsilon[0]*rdx2Sq[1]*bcVals[6])/bcVals[7]+0.0295084445425327*kSq[6]-0.05962847939999439*kSq[5]-0.063887656499994*kSq[4]-0.05333333333333333*kSq[3]+0.06666666666666667*epsilon[0]*rdx2Sq[1]+0.03849001794597505*kSq[1]-0.8888888888888888*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[1], (-(1.066666666666667*epsilon[0]*rdx2Sq[1]*bcVals[6])/bcVals[7])-0.1967229636168847*kSq[6]-0.07950463919999252*kSq[5]+0.2271561119999787*kSq[4]+0.3079201435678004*kSq[2]+0.5333333333333333*epsilon[0]*rdx2Sq[1]+1.777777777777778*epsilon[0]*rdx2Sq[0]-0.3555555555555556*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[2], (-0.03442651863295482*kSq[7])-(0.1333333333333333*epsilon[0]*rdx2Sq[1]*bcVals[6])/bcVals[7]+0.0295084445425327*kSq[6]-0.05962847939999439*kSq[5]-0.063887656499994*kSq[4]+0.05333333333333333*kSq[3]+0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.03849001794597505*kSq[1]-0.8888888888888888*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[3], (-0.03442651863295482*kSq[7])-0.03442651863295482*kSq[6]+0.09938079899999068*kSq[5]+0.09938079899999068*kSq[4]-0.02666666666666666*kSq[3]+0.0769800358919501*kSq[2]+0.0769800358919501*kSq[1]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[4], 0.03442651863295482*kSq[7]-0.03442651863295482*kSq[6]+0.09938079899999068*kSq[5]+0.09938079899999068*kSq[4]+0.02666666666666666*kSq[3]+0.0769800358919501*kSq[2]-0.0769800358919501*kSq[1]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[5], 0.01721325931647741*kSq[6]-0.03975231959999626*kSq[5]-0.05678902799999467*kSq[4]+0.01333333333333333*kSq[3]-0.03849001794597505*kSq[2]-0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.4444444444444444*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[6], 0.07950463919999252*kSq[5]+0.1135780559999893*kSq[4]-0.5333333333333333*epsilon[0]*rdx2Sq[1]+0.8888888888888888*epsilon[0]*rdx2Sq[0]-0.1777777777777778*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[7], 0.01721325931647741*kSq[6]-0.03975231959999626*kSq[5]-0.05678902799999467*kSq[4]-0.01333333333333333*kSq[3]-0.03849001794597505*kSq[2]-0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.4444444444444444*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[0], (0.06666666666666667*epsilon[0]*rdx2Sq[1]*bcVals[6])/bcVals[7]-0.006147592613027645*kSq[6]+0.03336355394999686*kSq[5]+0.02697478829999747*kSq[4]-0.01924500897298752*kSq[2]+0.1888888888888889*epsilon[0]*rdx2Sq[1]+0.3111111111111111*epsilon[0]*rdx2Sq[0]-0.02222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[1], (-0.03442651863295482*kSq[7])-(0.1333333333333333*epsilon[0]*rdx2Sq[1]*bcVals[6])/bcVals[7]+0.0295084445425327*kSq[6]-0.05962847939999439*kSq[5]-0.063887656499994*kSq[4]+0.05333333333333333*kSq[3]+0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.03849001794597505*kSq[1]-0.8888888888888888*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[2], (-0.04549218533640458*kSq[7])-(0.2666666666666667*epsilon[0]*rdx2Sq[1]*bcVals[6])/bcVals[7]+0.04549218533640458*kSq[6]-0.0127775312999988*kSq[5]-0.0127775312999988*kSq[4]+(0.2666666666666667*epsilon[0]*rdx2Sq[0]*bcVals[3])/bcVals[4]+0.04666666666666667*kSq[3]+0.03849001794597505*kSq[2]+0.5777777777777777*epsilon[0]*rdx2Sq[1]-0.03849001794597505*kSq[1]+0.5777777777777777*epsilon[0]*rdx2Sq[0]-0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[3], 0.01721325931647741*kSq[7]-0.05678902799999467*kSq[5]-0.03975231959999626*kSq[4]+0.01333333333333333*kSq[3]-0.4444444444444444*epsilon[0]*rdx2Sq[1]-0.03849001794597505*kSq[1]-0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[4], (-0.0295084445425327*kSq[7])+0.03442651863295482*kSq[6]-0.063887656499994*kSq[5]-0.05962847939999439*kSq[4]+(0.1333333333333333*epsilon[0]*rdx2Sq[0]*bcVals[3])/bcVals[4]+0.05333333333333333*kSq[3]+0.03849001794597505*kSq[2]-0.8888888888888888*epsilon[0]*rdx2Sq[1]+0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[5], 0.0234254740499978*kSq[5]+0.0234254740499978*kSq[4]-0.01333333333333333*kSq[3]+0.2555555555555555*epsilon[0]*rdx2Sq[1]+0.2555555555555555*epsilon[0]*rdx2Sq[0]-0.03333333333333333*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[6], (-0.01721325931647741*kSq[6])-0.03975231959999626*kSq[5]-0.05678902799999467*kSq[4]+0.01333333333333333*kSq[3]+0.03849001794597505*kSq[2]-0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.4444444444444444*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[7], 0.006147592613027645*kSq[7]+0.02697478829999747*kSq[5]+0.03336355394999686*kSq[4]-(0.06666666666666667*epsilon[0]*rdx2Sq[0]*bcVals[3])/bcVals[4]+0.3111111111111111*epsilon[0]*rdx2Sq[1]+0.01924500897298752*kSq[1]+0.1888888888888889*epsilon[0]*rdx2Sq[0]-0.02222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[0], 0.0295084445425327*kSq[7]+0.03442651863295482*kSq[6]-0.063887656499994*kSq[5]-0.05962847939999439*kSq[4]-0.05333333333333333*kSq[3]+0.03849001794597505*kSq[2]-0.8888888888888888*epsilon[0]*rdx2Sq[1]+0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[1], (-0.03442651863295482*kSq[7])-0.03442651863295482*kSq[6]+0.09938079899999068*kSq[5]+0.09938079899999068*kSq[4]-0.02666666666666666*kSq[3]+0.0769800358919501*kSq[2]+0.0769800358919501*kSq[1]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[2], 0.01721325931647741*kSq[7]-0.05678902799999467*kSq[5]-0.03975231959999626*kSq[4]+0.01333333333333333*kSq[3]-0.4444444444444444*epsilon[0]*rdx2Sq[1]-0.03849001794597505*kSq[1]-0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[3], (-0.1967229636168847*kSq[7])+0.2271561119999787*kSq[5]-0.07950463919999252*kSq[4]+1.777777777777778*epsilon[0]*rdx2Sq[1]+0.3079201435678004*kSq[1]+0.5333333333333333*epsilon[0]*rdx2Sq[0]-0.3555555555555556*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[4], 0.1135780559999893*kSq[5]+0.07950463919999252*kSq[4]+0.8888888888888888*epsilon[0]*rdx2Sq[1]-0.5333333333333333*epsilon[0]*rdx2Sq[0]-0.1777777777777778*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[5], 0.0295084445425327*kSq[7]-0.03442651863295482*kSq[6]-0.063887656499994*kSq[5]-0.05962847939999439*kSq[4]+0.05333333333333333*kSq[3]-0.03849001794597505*kSq[2]-0.8888888888888888*epsilon[0]*rdx2Sq[1]+0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[6], (-0.03442651863295482*kSq[7])+0.03442651863295482*kSq[6]+0.09938079899999068*kSq[5]+0.09938079899999068*kSq[4]+0.02666666666666666*kSq[3]-0.0769800358919501*kSq[2]+0.0769800358919501*kSq[1]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[7], 0.01721325931647741*kSq[7]-0.05678902799999467*kSq[5]-0.03975231959999626*kSq[4]-0.01333333333333333*kSq[3]-0.4444444444444444*epsilon[0]*rdx2Sq[1]-0.03849001794597505*kSq[1]-0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[4], globalIdxs[0], (-0.01721325931647741*kSq[7])-0.05678902799999467*kSq[5]-0.03975231959999626*kSq[4]-0.01333333333333333*kSq[3]-0.4444444444444444*epsilon[0]*rdx2Sq[1]+0.03849001794597505*kSq[1]-0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[4], globalIdxs[1], 0.03442651863295482*kSq[7]-0.03442651863295482*kSq[6]+0.09938079899999068*kSq[5]+0.09938079899999068*kSq[4]+0.02666666666666666*kSq[3]+0.0769800358919501*kSq[2]-0.0769800358919501*kSq[1]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[4], globalIdxs[2], (-0.0295084445425327*kSq[7])+0.03442651863295482*kSq[6]-0.063887656499994*kSq[5]-0.05962847939999439*kSq[4]+(0.1333333333333333*epsilon[0]*rdx2Sq[0]*bcVals[3])/bcVals[4]+0.05333333333333333*kSq[3]+0.03849001794597505*kSq[2]-0.8888888888888888*epsilon[0]*rdx2Sq[1]+0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[4], globalIdxs[3], 0.1135780559999893*kSq[5]+0.07950463919999252*kSq[4]+0.8888888888888888*epsilon[0]*rdx2Sq[1]-0.5333333333333333*epsilon[0]*rdx2Sq[0]-0.1777777777777778*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[4], globalIdxs[4], 0.1967229636168847*kSq[7]+0.2271561119999787*kSq[5]-0.07950463919999252*kSq[4]+(1.066666666666667*epsilon[0]*rdx2Sq[0]*bcVals[3])/bcVals[4]+1.777777777777778*epsilon[0]*rdx2Sq[1]-0.3079201435678004*kSq[1]+0.5333333333333333*epsilon[0]*rdx2Sq[0]-0.3555555555555556*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[4], globalIdxs[5], (-0.01721325931647741*kSq[7])-0.05678902799999467*kSq[5]-0.03975231959999626*kSq[4]+0.01333333333333333*kSq[3]-0.4444444444444444*epsilon[0]*rdx2Sq[1]+0.03849001794597505*kSq[1]-0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[4], globalIdxs[6], 0.03442651863295482*kSq[7]+0.03442651863295482*kSq[6]+0.09938079899999068*kSq[5]+0.09938079899999068*kSq[4]-0.02666666666666666*kSq[3]-0.0769800358919501*kSq[2]-0.0769800358919501*kSq[1]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[4], globalIdxs[7], (-0.0295084445425327*kSq[7])-0.03442651863295482*kSq[6]-0.063887656499994*kSq[5]-0.05962847939999439*kSq[4]+(0.1333333333333333*epsilon[0]*rdx2Sq[0]*bcVals[3])/bcVals[4]-0.05333333333333333*kSq[3]-0.03849001794597505*kSq[2]-0.8888888888888888*epsilon[0]*rdx2Sq[1]+0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[5], globalIdxs[0], (-0.006147592613027645*kSq[7])+0.02697478829999747*kSq[5]+0.03336355394999686*kSq[4]+0.3111111111111111*epsilon[0]*rdx2Sq[1]-0.01924500897298752*kSq[1]+0.1888888888888889*epsilon[0]*rdx2Sq[0]-0.02222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[5], globalIdxs[1], 0.01721325931647741*kSq[6]-0.03975231959999626*kSq[5]-0.05678902799999467*kSq[4]+0.01333333333333333*kSq[3]-0.03849001794597505*kSq[2]-0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.4444444444444444*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[5], globalIdxs[2], 0.0234254740499978*kSq[5]+0.0234254740499978*kSq[4]-0.01333333333333333*kSq[3]+0.2555555555555555*epsilon[0]*rdx2Sq[1]+0.2555555555555555*epsilon[0]*rdx2Sq[0]-0.03333333333333333*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[5], globalIdxs[3], 0.0295084445425327*kSq[7]-0.03442651863295482*kSq[6]-0.063887656499994*kSq[5]-0.05962847939999439*kSq[4]+0.05333333333333333*kSq[3]-0.03849001794597505*kSq[2]-0.8888888888888888*epsilon[0]*rdx2Sq[1]+0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[5], globalIdxs[4], (-0.01721325931647741*kSq[7])-0.05678902799999467*kSq[5]-0.03975231959999626*kSq[4]+0.01333333333333333*kSq[3]-0.4444444444444444*epsilon[0]*rdx2Sq[1]+0.03849001794597505*kSq[1]-0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[5], globalIdxs[5], 0.04549218533640458*kSq[7]-0.04549218533640458*kSq[6]-0.0127775312999988*kSq[5]-0.0127775312999988*kSq[4]+0.04666666666666667*kSq[3]-0.03849001794597505*kSq[2]+0.5777777777777777*epsilon[0]*rdx2Sq[1]+0.03849001794597505*kSq[1]+0.5777777777777777*epsilon[0]*rdx2Sq[0]-0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[5], globalIdxs[6], 0.03442651863295482*kSq[7]-0.0295084445425327*kSq[6]-0.05962847939999439*kSq[5]-0.063887656499994*kSq[4]+0.05333333333333333*kSq[3]+0.06666666666666667*epsilon[0]*rdx2Sq[1]+0.03849001794597505*kSq[1]-0.8888888888888888*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[5], globalIdxs[7], 0.006147592613027645*kSq[6]+0.03336355394999686*kSq[5]+0.02697478829999747*kSq[4]+0.01924500897298752*kSq[2]+0.1888888888888889*epsilon[0]*rdx2Sq[1]+0.3111111111111111*epsilon[0]*rdx2Sq[0]-0.02222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[6], globalIdxs[0], (-0.01721325931647741*kSq[6])-0.03975231959999626*kSq[5]-0.05678902799999467*kSq[4]-0.01333333333333333*kSq[3]+0.03849001794597505*kSq[2]-0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.4444444444444444*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[6], globalIdxs[1], 0.07950463919999252*kSq[5]+0.1135780559999893*kSq[4]-0.5333333333333333*epsilon[0]*rdx2Sq[1]+0.8888888888888888*epsilon[0]*rdx2Sq[0]-0.1777777777777778*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[6], globalIdxs[2], (-0.01721325931647741*kSq[6])-0.03975231959999626*kSq[5]-0.05678902799999467*kSq[4]+0.01333333333333333*kSq[3]+0.03849001794597505*kSq[2]-0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.4444444444444444*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[6], globalIdxs[3], (-0.03442651863295482*kSq[7])+0.03442651863295482*kSq[6]+0.09938079899999068*kSq[5]+0.09938079899999068*kSq[4]+0.02666666666666666*kSq[3]-0.0769800358919501*kSq[2]+0.0769800358919501*kSq[1]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[6], globalIdxs[4], 0.03442651863295482*kSq[7]+0.03442651863295482*kSq[6]+0.09938079899999068*kSq[5]+0.09938079899999068*kSq[4]-0.02666666666666666*kSq[3]-0.0769800358919501*kSq[2]-0.0769800358919501*kSq[1]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[6], globalIdxs[5], 0.03442651863295482*kSq[7]-0.0295084445425327*kSq[6]-0.05962847939999439*kSq[5]-0.063887656499994*kSq[4]+0.05333333333333333*kSq[3]+0.06666666666666667*epsilon[0]*rdx2Sq[1]+0.03849001794597505*kSq[1]-0.8888888888888888*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[6], globalIdxs[6], 0.1967229636168847*kSq[6]-0.07950463919999252*kSq[5]+0.2271561119999787*kSq[4]-0.3079201435678004*kSq[2]+0.5333333333333333*epsilon[0]*rdx2Sq[1]+1.777777777777778*epsilon[0]*rdx2Sq[0]-0.3555555555555556*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[6], globalIdxs[7], (-0.03442651863295482*kSq[7])-0.0295084445425327*kSq[6]-0.05962847939999439*kSq[5]-0.063887656499994*kSq[4]-0.05333333333333333*kSq[3]+0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.03849001794597505*kSq[1]-0.8888888888888888*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[7], globalIdxs[0], 0.0234254740499978*kSq[5]+0.0234254740499978*kSq[4]+0.01333333333333333*kSq[3]+0.2555555555555555*epsilon[0]*rdx2Sq[1]+0.2555555555555555*epsilon[0]*rdx2Sq[0]-0.03333333333333333*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[7], globalIdxs[1], 0.01721325931647741*kSq[6]-0.03975231959999626*kSq[5]-0.05678902799999467*kSq[4]-0.01333333333333333*kSq[3]-0.03849001794597505*kSq[2]-0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.4444444444444444*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[7], globalIdxs[2], 0.006147592613027645*kSq[7]+0.02697478829999747*kSq[5]+0.03336355394999686*kSq[4]-(0.06666666666666667*epsilon[0]*rdx2Sq[0]*bcVals[3])/bcVals[4]+0.3111111111111111*epsilon[0]*rdx2Sq[1]+0.01924500897298752*kSq[1]+0.1888888888888889*epsilon[0]*rdx2Sq[0]-0.02222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[7], globalIdxs[3], 0.01721325931647741*kSq[7]-0.05678902799999467*kSq[5]-0.03975231959999626*kSq[4]-0.01333333333333333*kSq[3]-0.4444444444444444*epsilon[0]*rdx2Sq[1]-0.03849001794597505*kSq[1]-0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[7], globalIdxs[4], (-0.0295084445425327*kSq[7])-0.03442651863295482*kSq[6]-0.063887656499994*kSq[5]-0.05962847939999439*kSq[4]+(0.1333333333333333*epsilon[0]*rdx2Sq[0]*bcVals[3])/bcVals[4]-0.05333333333333333*kSq[3]-0.03849001794597505*kSq[2]-0.8888888888888888*epsilon[0]*rdx2Sq[1]+0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[7], globalIdxs[5], 0.006147592613027645*kSq[6]+0.03336355394999686*kSq[5]+0.02697478829999747*kSq[4]+0.01924500897298752*kSq[2]+0.1888888888888889*epsilon[0]*rdx2Sq[1]+0.3111111111111111*epsilon[0]*rdx2Sq[0]-0.02222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[7], globalIdxs[6], (-0.03442651863295482*kSq[7])-0.0295084445425327*kSq[6]-0.05962847939999439*kSq[5]-0.063887656499994*kSq[4]-0.05333333333333333*kSq[3]+0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.03849001794597505*kSq[1]-0.8888888888888888*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[7], globalIdxs[7], (-0.04549218533640458*kSq[7])-0.04549218533640458*kSq[6]-0.0127775312999988*kSq[5]-0.0127775312999988*kSq[4]+(0.2666666666666667*epsilon[0]*rdx2Sq[0]*bcVals[3])/bcVals[4]-0.04666666666666667*kSq[3]-0.03849001794597505*kSq[2]+0.5777777777777777*epsilon[0]*rdx2Sq[1]-0.03849001794597505*kSq[1]+0.5777777777777777*epsilon[0]*rdx2Sq[0]-0.06666666666666667*kSq[0]);

}
void fem_poisson_lhs_stencil_consteps_2x_ser_p1_upx_periodicx_upy_periodicy(const double *epsilon, const double *kSq, const double *dx, const double *bcVals, const long *globalIdxs, gkyl_mat_triples *tri) 
{ 
  // epsilon: permittivity.
  // kSq: wave number squared (factor multiplying phi).
  // dx: cell length in each direction.
  // bcVals[3]: values to impose as BCs, i.e. bcVals[0]*phi+bcVals[1]*d(phi)/dx=bcVals[2].
  // globalIdxs: global linear index of each basis function/node in current cell.
  // tri: triples object (i,j,val), i.e. contribute val to i,j element of the global matrix.

  double rdx2Sq[2];
  rdx2Sq[0] = 4.0/(dx[0]*dx[0]);
  rdx2Sq[1] = 4.0/(dx[1]*dx[1]);

  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[0], (-0.1666666666666667*kSq[3])+0.1924500897298752*kSq[2]+0.3333333333333333*epsilon[0]*rdx2Sq[1]+0.1924500897298752*kSq[1]+0.3333333333333333*epsilon[0]*rdx2Sq[0]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[1], 0.09622504486493762*kSq[2]+0.1666666666666667*epsilon[0]*rdx2Sq[1]-0.3333333333333333*epsilon[0]*rdx2Sq[0]-0.1111111111111111*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[2], (-0.3333333333333333*epsilon[0]*rdx2Sq[1])+0.09622504486493762*kSq[1]+0.1666666666666667*epsilon[0]*rdx2Sq[0]-0.1111111111111111*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[3], (-0.1666666666666667*epsilon[0]*rdx2Sq[1])-0.1666666666666667*epsilon[0]*rdx2Sq[0]-0.05555555555555555*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[0], 0.09622504486493762*kSq[2]+0.1666666666666667*epsilon[0]*rdx2Sq[1]-0.3333333333333333*epsilon[0]*rdx2Sq[0]-0.1111111111111111*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[1], 0.1666666666666667*kSq[3]+0.1924500897298752*kSq[2]+0.3333333333333333*epsilon[0]*rdx2Sq[1]-0.1924500897298752*kSq[1]+0.3333333333333333*epsilon[0]*rdx2Sq[0]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[2], (-0.1666666666666667*epsilon[0]*rdx2Sq[1])-0.1666666666666667*epsilon[0]*rdx2Sq[0]-0.05555555555555555*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[3], (-0.3333333333333333*epsilon[0]*rdx2Sq[1])-0.09622504486493762*kSq[1]+0.1666666666666667*epsilon[0]*rdx2Sq[0]-0.1111111111111111*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[0], (-0.3333333333333333*epsilon[0]*rdx2Sq[1])+0.09622504486493762*kSq[1]+0.1666666666666667*epsilon[0]*rdx2Sq[0]-0.1111111111111111*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[1], (-0.1666666666666667*epsilon[0]*rdx2Sq[1])-0.1666666666666667*epsilon[0]*rdx2Sq[0]-0.05555555555555555*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[2], 0.1666666666666667*kSq[3]-0.1924500897298752*kSq[2]+0.3333333333333333*epsilon[0]*rdx2Sq[1]+0.1924500897298752*kSq[1]+0.3333333333333333*epsilon[0]*rdx2Sq[0]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[3], (-0.09622504486493762*kSq[2])+0.1666666666666667*epsilon[0]*rdx2Sq[1]-0.3333333333333333*epsilon[0]*rdx2Sq[0]-0.1111111111111111*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[0], (-0.1666666666666667*epsilon[0]*rdx2Sq[1])-0.1666666666666667*epsilon[0]*rdx2Sq[0]-0.05555555555555555*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[1], (-0.3333333333333333*epsilon[0]*rdx2Sq[1])-0.09622504486493762*kSq[1]+0.1666666666666667*epsilon[0]*rdx2Sq[0]-0.1111111111111111*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[2], (-0.09622504486493762*kSq[2])+0.1666666666666667*epsilon[0]*rdx2Sq[1]-0.3333333333333333*epsilon[0]*rdx2Sq[0]-0.1111111111111111*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[3], (-0.1666666666666667*kSq[3])-0.1924500897298752*kSq[2]+0.3333333333333333*epsilon[0]*rdx2Sq[1]-0.1924500897298752*kSq[1]+0.3333333333333333*epsilon[0]*rdx2Sq[0]-0.2222222222222222*kSq[0]);

}
void fem_poisson_lhs_stencil_consteps_2x_ser_p2_upx_periodicx_upy_periodicy(const double *epsilon, const double *kSq, const double *dx, const double *bcVals, const long *globalIdxs, gkyl_mat_triples *tri) 
{ 
  // epsilon: permittivity.
  // kSq: wave number squared (factor multiplying phi).
  // dx: cell length in each direction.
  // bcVals[3]: values to impose as BCs, i.e. bcVals[0]*phi+bcVals[1]*d(phi)/dx=bcVals[2].
  // globalIdxs: global linear index of each basis function/node in current cell.
  // tri: triples object (i,j,val), i.e. contribute val to i,j element of the global matrix.

  double rdx2Sq[2];
  rdx2Sq[0] = 4.0/(dx[0]*dx[0]);
  rdx2Sq[1] = 4.0/(dx[1]*dx[1]);

  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[0], 0.04549218533640458*kSq[7]+0.04549218533640458*kSq[6]-0.0127775312999988*kSq[5]-0.0127775312999988*kSq[4]-0.04666666666666667*kSq[3]+0.03849001794597505*kSq[2]+0.5777777777777777*epsilon[0]*rdx2Sq[1]+0.03849001794597505*kSq[1]+0.5777777777777777*epsilon[0]*rdx2Sq[0]-0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[1], 0.03442651863295482*kSq[7]+0.0295084445425327*kSq[6]-0.05962847939999439*kSq[5]-0.063887656499994*kSq[4]-0.05333333333333333*kSq[3]+0.06666666666666667*epsilon[0]*rdx2Sq[1]+0.03849001794597505*kSq[1]-0.8888888888888888*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[2], (-0.006147592613027645*kSq[6])+0.03336355394999686*kSq[5]+0.02697478829999747*kSq[4]-0.01924500897298752*kSq[2]+0.1888888888888889*epsilon[0]*rdx2Sq[1]+0.3111111111111111*epsilon[0]*rdx2Sq[0]-0.02222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[3], 0.0295084445425327*kSq[7]+0.03442651863295482*kSq[6]-0.063887656499994*kSq[5]-0.05962847939999439*kSq[4]-0.05333333333333333*kSq[3]+0.03849001794597505*kSq[2]-0.8888888888888888*epsilon[0]*rdx2Sq[1]+0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[4], (-0.01721325931647741*kSq[7])-0.05678902799999467*kSq[5]-0.03975231959999626*kSq[4]-0.01333333333333333*kSq[3]-0.4444444444444444*epsilon[0]*rdx2Sq[1]+0.03849001794597505*kSq[1]-0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[5], (-0.006147592613027645*kSq[7])+0.02697478829999747*kSq[5]+0.03336355394999686*kSq[4]+0.3111111111111111*epsilon[0]*rdx2Sq[1]-0.01924500897298752*kSq[1]+0.1888888888888889*epsilon[0]*rdx2Sq[0]-0.02222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[6], (-0.01721325931647741*kSq[6])-0.03975231959999626*kSq[5]-0.05678902799999467*kSq[4]-0.01333333333333333*kSq[3]+0.03849001794597505*kSq[2]-0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.4444444444444444*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[7], 0.0234254740499978*kSq[5]+0.0234254740499978*kSq[4]+0.01333333333333333*kSq[3]+0.2555555555555555*epsilon[0]*rdx2Sq[1]+0.2555555555555555*epsilon[0]*rdx2Sq[0]-0.03333333333333333*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[0], 0.03442651863295482*kSq[7]+0.0295084445425327*kSq[6]-0.05962847939999439*kSq[5]-0.063887656499994*kSq[4]-0.05333333333333333*kSq[3]+0.06666666666666667*epsilon[0]*rdx2Sq[1]+0.03849001794597505*kSq[1]-0.8888888888888888*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[1], (-0.1967229636168847*kSq[6])-0.07950463919999252*kSq[5]+0.2271561119999787*kSq[4]+0.3079201435678004*kSq[2]+0.5333333333333333*epsilon[0]*rdx2Sq[1]+1.777777777777778*epsilon[0]*rdx2Sq[0]-0.3555555555555556*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[2], (-0.03442651863295482*kSq[7])+0.0295084445425327*kSq[6]-0.05962847939999439*kSq[5]-0.063887656499994*kSq[4]+0.05333333333333333*kSq[3]+0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.03849001794597505*kSq[1]-0.8888888888888888*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[3], (-0.03442651863295482*kSq[7])-0.03442651863295482*kSq[6]+0.09938079899999068*kSq[5]+0.09938079899999068*kSq[4]-0.02666666666666666*kSq[3]+0.0769800358919501*kSq[2]+0.0769800358919501*kSq[1]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[4], 0.03442651863295482*kSq[7]-0.03442651863295482*kSq[6]+0.09938079899999068*kSq[5]+0.09938079899999068*kSq[4]+0.02666666666666666*kSq[3]+0.0769800358919501*kSq[2]-0.0769800358919501*kSq[1]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[5], 0.01721325931647741*kSq[6]-0.03975231959999626*kSq[5]-0.05678902799999467*kSq[4]+0.01333333333333333*kSq[3]-0.03849001794597505*kSq[2]-0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.4444444444444444*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[6], 0.07950463919999252*kSq[5]+0.1135780559999893*kSq[4]-0.5333333333333333*epsilon[0]*rdx2Sq[1]+0.8888888888888888*epsilon[0]*rdx2Sq[0]-0.1777777777777778*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[7], 0.01721325931647741*kSq[6]-0.03975231959999626*kSq[5]-0.05678902799999467*kSq[4]-0.01333333333333333*kSq[3]-0.03849001794597505*kSq[2]-0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.4444444444444444*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[0], (-0.006147592613027645*kSq[6])+0.03336355394999686*kSq[5]+0.02697478829999747*kSq[4]-0.01924500897298752*kSq[2]+0.1888888888888889*epsilon[0]*rdx2Sq[1]+0.3111111111111111*epsilon[0]*rdx2Sq[0]-0.02222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[1], (-0.03442651863295482*kSq[7])+0.0295084445425327*kSq[6]-0.05962847939999439*kSq[5]-0.063887656499994*kSq[4]+0.05333333333333333*kSq[3]+0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.03849001794597505*kSq[1]-0.8888888888888888*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[2], (-0.04549218533640458*kSq[7])+0.04549218533640458*kSq[6]-0.0127775312999988*kSq[5]-0.0127775312999988*kSq[4]+0.04666666666666667*kSq[3]+0.03849001794597505*kSq[2]+0.5777777777777777*epsilon[0]*rdx2Sq[1]-0.03849001794597505*kSq[1]+0.5777777777777777*epsilon[0]*rdx2Sq[0]-0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[3], 0.01721325931647741*kSq[7]-0.05678902799999467*kSq[5]-0.03975231959999626*kSq[4]+0.01333333333333333*kSq[3]-0.4444444444444444*epsilon[0]*rdx2Sq[1]-0.03849001794597505*kSq[1]-0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[4], (-0.0295084445425327*kSq[7])+0.03442651863295482*kSq[6]-0.063887656499994*kSq[5]-0.05962847939999439*kSq[4]+0.05333333333333333*kSq[3]+0.03849001794597505*kSq[2]-0.8888888888888888*epsilon[0]*rdx2Sq[1]+0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[5], 0.0234254740499978*kSq[5]+0.0234254740499978*kSq[4]-0.01333333333333333*kSq[3]+0.2555555555555555*epsilon[0]*rdx2Sq[1]+0.2555555555555555*epsilon[0]*rdx2Sq[0]-0.03333333333333333*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[6], (-0.01721325931647741*kSq[6])-0.03975231959999626*kSq[5]-0.05678902799999467*kSq[4]+0.01333333333333333*kSq[3]+0.03849001794597505*kSq[2]-0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.4444444444444444*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[7], 0.006147592613027645*kSq[7]+0.02697478829999747*kSq[5]+0.03336355394999686*kSq[4]+0.3111111111111111*epsilon[0]*rdx2Sq[1]+0.01924500897298752*kSq[1]+0.1888888888888889*epsilon[0]*rdx2Sq[0]-0.02222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[0], 0.0295084445425327*kSq[7]+0.03442651863295482*kSq[6]-0.063887656499994*kSq[5]-0.05962847939999439*kSq[4]-0.05333333333333333*kSq[3]+0.03849001794597505*kSq[2]-0.8888888888888888*epsilon[0]*rdx2Sq[1]+0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[1], (-0.03442651863295482*kSq[7])-0.03442651863295482*kSq[6]+0.09938079899999068*kSq[5]+0.09938079899999068*kSq[4]-0.02666666666666666*kSq[3]+0.0769800358919501*kSq[2]+0.0769800358919501*kSq[1]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[2], 0.01721325931647741*kSq[7]-0.05678902799999467*kSq[5]-0.03975231959999626*kSq[4]+0.01333333333333333*kSq[3]-0.4444444444444444*epsilon[0]*rdx2Sq[1]-0.03849001794597505*kSq[1]-0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[3], (-0.1967229636168847*kSq[7])+0.2271561119999787*kSq[5]-0.07950463919999252*kSq[4]+1.777777777777778*epsilon[0]*rdx2Sq[1]+0.3079201435678004*kSq[1]+0.5333333333333333*epsilon[0]*rdx2Sq[0]-0.3555555555555556*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[4], 0.1135780559999893*kSq[5]+0.07950463919999252*kSq[4]+0.8888888888888888*epsilon[0]*rdx2Sq[1]-0.5333333333333333*epsilon[0]*rdx2Sq[0]-0.1777777777777778*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[5], 0.0295084445425327*kSq[7]-0.03442651863295482*kSq[6]-0.063887656499994*kSq[5]-0.05962847939999439*kSq[4]+0.05333333333333333*kSq[3]-0.03849001794597505*kSq[2]-0.8888888888888888*epsilon[0]*rdx2Sq[1]+0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[6], (-0.03442651863295482*kSq[7])+0.03442651863295482*kSq[6]+0.09938079899999068*kSq[5]+0.09938079899999068*kSq[4]+0.02666666666666666*kSq[3]-0.0769800358919501*kSq[2]+0.0769800358919501*kSq[1]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[7], 0.01721325931647741*kSq[7]-0.05678902799999467*kSq[5]-0.03975231959999626*kSq[4]-0.01333333333333333*kSq[3]-0.4444444444444444*epsilon[0]*rdx2Sq[1]-0.03849001794597505*kSq[1]-0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[4], globalIdxs[0], (-0.01721325931647741*kSq[7])-0.05678902799999467*kSq[5]-0.03975231959999626*kSq[4]-0.01333333333333333*kSq[3]-0.4444444444444444*epsilon[0]*rdx2Sq[1]+0.03849001794597505*kSq[1]-0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[4], globalIdxs[1], 0.03442651863295482*kSq[7]-0.03442651863295482*kSq[6]+0.09938079899999068*kSq[5]+0.09938079899999068*kSq[4]+0.02666666666666666*kSq[3]+0.0769800358919501*kSq[2]-0.0769800358919501*kSq[1]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[4], globalIdxs[2], (-0.0295084445425327*kSq[7])+0.03442651863295482*kSq[6]-0.063887656499994*kSq[5]-0.05962847939999439*kSq[4]+0.05333333333333333*kSq[3]+0.03849001794597505*kSq[2]-0.8888888888888888*epsilon[0]*rdx2Sq[1]+0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[4], globalIdxs[3], 0.1135780559999893*kSq[5]+0.07950463919999252*kSq[4]+0.8888888888888888*epsilon[0]*rdx2Sq[1]-0.5333333333333333*epsilon[0]*rdx2Sq[0]-0.1777777777777778*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[4], globalIdxs[4], 0.1967229636168847*kSq[7]+0.2271561119999787*kSq[5]-0.07950463919999252*kSq[4]+1.777777777777778*epsilon[0]*rdx2Sq[1]-0.3079201435678004*kSq[1]+0.5333333333333333*epsilon[0]*rdx2Sq[0]-0.3555555555555556*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[4], globalIdxs[5], (-0.01721325931647741*kSq[7])-0.05678902799999467*kSq[5]-0.03975231959999626*kSq[4]+0.01333333333333333*kSq[3]-0.4444444444444444*epsilon[0]*rdx2Sq[1]+0.03849001794597505*kSq[1]-0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[4], globalIdxs[6], 0.03442651863295482*kSq[7]+0.03442651863295482*kSq[6]+0.09938079899999068*kSq[5]+0.09938079899999068*kSq[4]-0.02666666666666666*kSq[3]-0.0769800358919501*kSq[2]-0.0769800358919501*kSq[1]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[4], globalIdxs[7], (-0.0295084445425327*kSq[7])-0.03442651863295482*kSq[6]-0.063887656499994*kSq[5]-0.05962847939999439*kSq[4]-0.05333333333333333*kSq[3]-0.03849001794597505*kSq[2]-0.8888888888888888*epsilon[0]*rdx2Sq[1]+0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[5], globalIdxs[0], (-0.006147592613027645*kSq[7])+0.02697478829999747*kSq[5]+0.03336355394999686*kSq[4]+0.3111111111111111*epsilon[0]*rdx2Sq[1]-0.01924500897298752*kSq[1]+0.1888888888888889*epsilon[0]*rdx2Sq[0]-0.02222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[5], globalIdxs[1], 0.01721325931647741*kSq[6]-0.03975231959999626*kSq[5]-0.05678902799999467*kSq[4]+0.01333333333333333*kSq[3]-0.03849001794597505*kSq[2]-0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.4444444444444444*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[5], globalIdxs[2], 0.0234254740499978*kSq[5]+0.0234254740499978*kSq[4]-0.01333333333333333*kSq[3]+0.2555555555555555*epsilon[0]*rdx2Sq[1]+0.2555555555555555*epsilon[0]*rdx2Sq[0]-0.03333333333333333*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[5], globalIdxs[3], 0.0295084445425327*kSq[7]-0.03442651863295482*kSq[6]-0.063887656499994*kSq[5]-0.05962847939999439*kSq[4]+0.05333333333333333*kSq[3]-0.03849001794597505*kSq[2]-0.8888888888888888*epsilon[0]*rdx2Sq[1]+0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[5], globalIdxs[4], (-0.01721325931647741*kSq[7])-0.05678902799999467*kSq[5]-0.03975231959999626*kSq[4]+0.01333333333333333*kSq[3]-0.4444444444444444*epsilon[0]*rdx2Sq[1]+0.03849001794597505*kSq[1]-0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[5], globalIdxs[5], 0.04549218533640458*kSq[7]-0.04549218533640458*kSq[6]-0.0127775312999988*kSq[5]-0.0127775312999988*kSq[4]+0.04666666666666667*kSq[3]-0.03849001794597505*kSq[2]+0.5777777777777777*epsilon[0]*rdx2Sq[1]+0.03849001794597505*kSq[1]+0.5777777777777777*epsilon[0]*rdx2Sq[0]-0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[5], globalIdxs[6], 0.03442651863295482*kSq[7]-0.0295084445425327*kSq[6]-0.05962847939999439*kSq[5]-0.063887656499994*kSq[4]+0.05333333333333333*kSq[3]+0.06666666666666667*epsilon[0]*rdx2Sq[1]+0.03849001794597505*kSq[1]-0.8888888888888888*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[5], globalIdxs[7], 0.006147592613027645*kSq[6]+0.03336355394999686*kSq[5]+0.02697478829999747*kSq[4]+0.01924500897298752*kSq[2]+0.1888888888888889*epsilon[0]*rdx2Sq[1]+0.3111111111111111*epsilon[0]*rdx2Sq[0]-0.02222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[6], globalIdxs[0], (-0.01721325931647741*kSq[6])-0.03975231959999626*kSq[5]-0.05678902799999467*kSq[4]-0.01333333333333333*kSq[3]+0.03849001794597505*kSq[2]-0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.4444444444444444*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[6], globalIdxs[1], 0.07950463919999252*kSq[5]+0.1135780559999893*kSq[4]-0.5333333333333333*epsilon[0]*rdx2Sq[1]+0.8888888888888888*epsilon[0]*rdx2Sq[0]-0.1777777777777778*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[6], globalIdxs[2], (-0.01721325931647741*kSq[6])-0.03975231959999626*kSq[5]-0.05678902799999467*kSq[4]+0.01333333333333333*kSq[3]+0.03849001794597505*kSq[2]-0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.4444444444444444*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[6], globalIdxs[3], (-0.03442651863295482*kSq[7])+0.03442651863295482*kSq[6]+0.09938079899999068*kSq[5]+0.09938079899999068*kSq[4]+0.02666666666666666*kSq[3]-0.0769800358919501*kSq[2]+0.0769800358919501*kSq[1]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[6], globalIdxs[4], 0.03442651863295482*kSq[7]+0.03442651863295482*kSq[6]+0.09938079899999068*kSq[5]+0.09938079899999068*kSq[4]-0.02666666666666666*kSq[3]-0.0769800358919501*kSq[2]-0.0769800358919501*kSq[1]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[6], globalIdxs[5], 0.03442651863295482*kSq[7]-0.0295084445425327*kSq[6]-0.05962847939999439*kSq[5]-0.063887656499994*kSq[4]+0.05333333333333333*kSq[3]+0.06666666666666667*epsilon[0]*rdx2Sq[1]+0.03849001794597505*kSq[1]-0.8888888888888888*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[6], globalIdxs[6], 0.1967229636168847*kSq[6]-0.07950463919999252*kSq[5]+0.2271561119999787*kSq[4]-0.3079201435678004*kSq[2]+0.5333333333333333*epsilon[0]*rdx2Sq[1]+1.777777777777778*epsilon[0]*rdx2Sq[0]-0.3555555555555556*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[6], globalIdxs[7], (-0.03442651863295482*kSq[7])-0.0295084445425327*kSq[6]-0.05962847939999439*kSq[5]-0.063887656499994*kSq[4]-0.05333333333333333*kSq[3]+0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.03849001794597505*kSq[1]-0.8888888888888888*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[7], globalIdxs[0], 0.0234254740499978*kSq[5]+0.0234254740499978*kSq[4]+0.01333333333333333*kSq[3]+0.2555555555555555*epsilon[0]*rdx2Sq[1]+0.2555555555555555*epsilon[0]*rdx2Sq[0]-0.03333333333333333*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[7], globalIdxs[1], 0.01721325931647741*kSq[6]-0.03975231959999626*kSq[5]-0.05678902799999467*kSq[4]-0.01333333333333333*kSq[3]-0.03849001794597505*kSq[2]-0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.4444444444444444*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[7], globalIdxs[2], 0.006147592613027645*kSq[7]+0.02697478829999747*kSq[5]+0.03336355394999686*kSq[4]+0.3111111111111111*epsilon[0]*rdx2Sq[1]+0.01924500897298752*kSq[1]+0.1888888888888889*epsilon[0]*rdx2Sq[0]-0.02222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[7], globalIdxs[3], 0.01721325931647741*kSq[7]-0.05678902799999467*kSq[5]-0.03975231959999626*kSq[4]-0.01333333333333333*kSq[3]-0.4444444444444444*epsilon[0]*rdx2Sq[1]-0.03849001794597505*kSq[1]-0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[7], globalIdxs[4], (-0.0295084445425327*kSq[7])-0.03442651863295482*kSq[6]-0.063887656499994*kSq[5]-0.05962847939999439*kSq[4]-0.05333333333333333*kSq[3]-0.03849001794597505*kSq[2]-0.8888888888888888*epsilon[0]*rdx2Sq[1]+0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[7], globalIdxs[5], 0.006147592613027645*kSq[6]+0.03336355394999686*kSq[5]+0.02697478829999747*kSq[4]+0.01924500897298752*kSq[2]+0.1888888888888889*epsilon[0]*rdx2Sq[1]+0.3111111111111111*epsilon[0]*rdx2Sq[0]-0.02222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[7], globalIdxs[6], (-0.03442651863295482*kSq[7])-0.0295084445425327*kSq[6]-0.05962847939999439*kSq[5]-0.063887656499994*kSq[4]-0.05333333333333333*kSq[3]+0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.03849001794597505*kSq[1]-0.8888888888888888*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[7], globalIdxs[7], (-0.04549218533640458*kSq[7])-0.04549218533640458*kSq[6]-0.0127775312999988*kSq[5]-0.0127775312999988*kSq[4]-0.04666666666666667*kSq[3]-0.03849001794597505*kSq[2]+0.5777777777777777*epsilon[0]*rdx2Sq[1]-0.03849001794597505*kSq[1]+0.5777777777777777*epsilon[0]*rdx2Sq[0]-0.06666666666666667*kSq[0]);

}
void fem_poisson_lhs_stencil_consteps_2x_ser_p1_upx_periodicx_upy_dirichlety(const double *epsilon, const double *kSq, const double *dx, const double *bcVals, const long *globalIdxs, gkyl_mat_triples *tri) 
{ 
  // epsilon: permittivity.
  // kSq: wave number squared (factor multiplying phi).
  // dx: cell length in each direction.
  // bcVals[3]: values to impose as BCs, i.e. bcVals[0]*phi+bcVals[1]*d(phi)/dx=bcVals[2].
  // globalIdxs: global linear index of each basis function/node in current cell.
  // tri: triples object (i,j,val), i.e. contribute val to i,j element of the global matrix.

  double rdx2Sq[2];
  rdx2Sq[0] = 4.0/(dx[0]*dx[0]);
  rdx2Sq[1] = 4.0/(dx[1]*dx[1]);

  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[0], (-0.1666666666666667*kSq[3])+0.1924500897298752*kSq[2]+0.3333333333333333*epsilon[0]*rdx2Sq[1]+0.1924500897298752*kSq[1]+0.3333333333333333*epsilon[0]*rdx2Sq[0]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[1], 0.09622504486493762*kSq[2]+0.1666666666666667*epsilon[0]*rdx2Sq[1]-0.3333333333333333*epsilon[0]*rdx2Sq[0]-0.1111111111111111*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[2], (-0.3333333333333333*epsilon[0]*rdx2Sq[1])+0.09622504486493762*kSq[1]+0.1666666666666667*epsilon[0]*rdx2Sq[0]-0.1111111111111111*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[3], (-0.1666666666666667*epsilon[0]*rdx2Sq[1])-0.1666666666666667*epsilon[0]*rdx2Sq[0]-0.05555555555555555*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[0], 0.09622504486493762*kSq[2]+0.1666666666666667*epsilon[0]*rdx2Sq[1]-0.3333333333333333*epsilon[0]*rdx2Sq[0]-0.1111111111111111*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[1], 0.1666666666666667*kSq[3]+0.1924500897298752*kSq[2]+0.3333333333333333*epsilon[0]*rdx2Sq[1]-0.1924500897298752*kSq[1]+0.3333333333333333*epsilon[0]*rdx2Sq[0]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[2], (-0.1666666666666667*epsilon[0]*rdx2Sq[1])-0.1666666666666667*epsilon[0]*rdx2Sq[0]-0.05555555555555555*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[3], (-0.3333333333333333*epsilon[0]*rdx2Sq[1])-0.09622504486493762*kSq[1]+0.1666666666666667*epsilon[0]*rdx2Sq[0]-0.1111111111111111*kSq[0]);
  gkyl_mat_triples_insert(tri, globalIdxs[2], globalIdxs[0], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[2], globalIdxs[1], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[2], globalIdxs[2], 1.0);
  gkyl_mat_triples_insert(tri, globalIdxs[2], globalIdxs[3], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[3], globalIdxs[0], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[3], globalIdxs[1], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[3], globalIdxs[2], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[3], globalIdxs[3], 1.0);

}
void fem_poisson_lhs_stencil_consteps_2x_ser_p2_upx_periodicx_upy_dirichlety(const double *epsilon, const double *kSq, const double *dx, const double *bcVals, const long *globalIdxs, gkyl_mat_triples *tri) 
{ 
  // epsilon: permittivity.
  // kSq: wave number squared (factor multiplying phi).
  // dx: cell length in each direction.
  // bcVals[3]: values to impose as BCs, i.e. bcVals[0]*phi+bcVals[1]*d(phi)/dx=bcVals[2].
  // globalIdxs: global linear index of each basis function/node in current cell.
  // tri: triples object (i,j,val), i.e. contribute val to i,j element of the global matrix.

  double rdx2Sq[2];
  rdx2Sq[0] = 4.0/(dx[0]*dx[0]);
  rdx2Sq[1] = 4.0/(dx[1]*dx[1]);

  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[0], 0.04549218533640458*kSq[7]+0.04549218533640458*kSq[6]-0.0127775312999988*kSq[5]-0.0127775312999988*kSq[4]-0.04666666666666667*kSq[3]+0.03849001794597505*kSq[2]+0.5777777777777777*epsilon[0]*rdx2Sq[1]+0.03849001794597505*kSq[1]+0.5777777777777777*epsilon[0]*rdx2Sq[0]-0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[1], 0.03442651863295482*kSq[7]+0.0295084445425327*kSq[6]-0.05962847939999439*kSq[5]-0.063887656499994*kSq[4]-0.05333333333333333*kSq[3]+0.06666666666666667*epsilon[0]*rdx2Sq[1]+0.03849001794597505*kSq[1]-0.8888888888888888*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[2], (-0.006147592613027645*kSq[6])+0.03336355394999686*kSq[5]+0.02697478829999747*kSq[4]-0.01924500897298752*kSq[2]+0.1888888888888889*epsilon[0]*rdx2Sq[1]+0.3111111111111111*epsilon[0]*rdx2Sq[0]-0.02222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[3], 0.0295084445425327*kSq[7]+0.03442651863295482*kSq[6]-0.063887656499994*kSq[5]-0.05962847939999439*kSq[4]-0.05333333333333333*kSq[3]+0.03849001794597505*kSq[2]-0.8888888888888888*epsilon[0]*rdx2Sq[1]+0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[4], (-0.01721325931647741*kSq[7])-0.05678902799999467*kSq[5]-0.03975231959999626*kSq[4]-0.01333333333333333*kSq[3]-0.4444444444444444*epsilon[0]*rdx2Sq[1]+0.03849001794597505*kSq[1]-0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[5], (-0.006147592613027645*kSq[7])+0.02697478829999747*kSq[5]+0.03336355394999686*kSq[4]+0.3111111111111111*epsilon[0]*rdx2Sq[1]-0.01924500897298752*kSq[1]+0.1888888888888889*epsilon[0]*rdx2Sq[0]-0.02222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[6], (-0.01721325931647741*kSq[6])-0.03975231959999626*kSq[5]-0.05678902799999467*kSq[4]-0.01333333333333333*kSq[3]+0.03849001794597505*kSq[2]-0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.4444444444444444*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[7], 0.0234254740499978*kSq[5]+0.0234254740499978*kSq[4]+0.01333333333333333*kSq[3]+0.2555555555555555*epsilon[0]*rdx2Sq[1]+0.2555555555555555*epsilon[0]*rdx2Sq[0]-0.03333333333333333*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[0], 0.03442651863295482*kSq[7]+0.0295084445425327*kSq[6]-0.05962847939999439*kSq[5]-0.063887656499994*kSq[4]-0.05333333333333333*kSq[3]+0.06666666666666667*epsilon[0]*rdx2Sq[1]+0.03849001794597505*kSq[1]-0.8888888888888888*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[1], (-0.1967229636168847*kSq[6])-0.07950463919999252*kSq[5]+0.2271561119999787*kSq[4]+0.3079201435678004*kSq[2]+0.5333333333333333*epsilon[0]*rdx2Sq[1]+1.777777777777778*epsilon[0]*rdx2Sq[0]-0.3555555555555556*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[2], (-0.03442651863295482*kSq[7])+0.0295084445425327*kSq[6]-0.05962847939999439*kSq[5]-0.063887656499994*kSq[4]+0.05333333333333333*kSq[3]+0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.03849001794597505*kSq[1]-0.8888888888888888*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[3], (-0.03442651863295482*kSq[7])-0.03442651863295482*kSq[6]+0.09938079899999068*kSq[5]+0.09938079899999068*kSq[4]-0.02666666666666666*kSq[3]+0.0769800358919501*kSq[2]+0.0769800358919501*kSq[1]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[4], 0.03442651863295482*kSq[7]-0.03442651863295482*kSq[6]+0.09938079899999068*kSq[5]+0.09938079899999068*kSq[4]+0.02666666666666666*kSq[3]+0.0769800358919501*kSq[2]-0.0769800358919501*kSq[1]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[5], 0.01721325931647741*kSq[6]-0.03975231959999626*kSq[5]-0.05678902799999467*kSq[4]+0.01333333333333333*kSq[3]-0.03849001794597505*kSq[2]-0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.4444444444444444*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[6], 0.07950463919999252*kSq[5]+0.1135780559999893*kSq[4]-0.5333333333333333*epsilon[0]*rdx2Sq[1]+0.8888888888888888*epsilon[0]*rdx2Sq[0]-0.1777777777777778*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[7], 0.01721325931647741*kSq[6]-0.03975231959999626*kSq[5]-0.05678902799999467*kSq[4]-0.01333333333333333*kSq[3]-0.03849001794597505*kSq[2]-0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.4444444444444444*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[0], (-0.006147592613027645*kSq[6])+0.03336355394999686*kSq[5]+0.02697478829999747*kSq[4]-0.01924500897298752*kSq[2]+0.1888888888888889*epsilon[0]*rdx2Sq[1]+0.3111111111111111*epsilon[0]*rdx2Sq[0]-0.02222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[1], (-0.03442651863295482*kSq[7])+0.0295084445425327*kSq[6]-0.05962847939999439*kSq[5]-0.063887656499994*kSq[4]+0.05333333333333333*kSq[3]+0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.03849001794597505*kSq[1]-0.8888888888888888*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[2], (-0.04549218533640458*kSq[7])+0.04549218533640458*kSq[6]-0.0127775312999988*kSq[5]-0.0127775312999988*kSq[4]+0.04666666666666667*kSq[3]+0.03849001794597505*kSq[2]+0.5777777777777777*epsilon[0]*rdx2Sq[1]-0.03849001794597505*kSq[1]+0.5777777777777777*epsilon[0]*rdx2Sq[0]-0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[3], 0.01721325931647741*kSq[7]-0.05678902799999467*kSq[5]-0.03975231959999626*kSq[4]+0.01333333333333333*kSq[3]-0.4444444444444444*epsilon[0]*rdx2Sq[1]-0.03849001794597505*kSq[1]-0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[4], (-0.0295084445425327*kSq[7])+0.03442651863295482*kSq[6]-0.063887656499994*kSq[5]-0.05962847939999439*kSq[4]+0.05333333333333333*kSq[3]+0.03849001794597505*kSq[2]-0.8888888888888888*epsilon[0]*rdx2Sq[1]+0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[5], 0.0234254740499978*kSq[5]+0.0234254740499978*kSq[4]-0.01333333333333333*kSq[3]+0.2555555555555555*epsilon[0]*rdx2Sq[1]+0.2555555555555555*epsilon[0]*rdx2Sq[0]-0.03333333333333333*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[6], (-0.01721325931647741*kSq[6])-0.03975231959999626*kSq[5]-0.05678902799999467*kSq[4]+0.01333333333333333*kSq[3]+0.03849001794597505*kSq[2]-0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.4444444444444444*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[7], 0.006147592613027645*kSq[7]+0.02697478829999747*kSq[5]+0.03336355394999686*kSq[4]+0.3111111111111111*epsilon[0]*rdx2Sq[1]+0.01924500897298752*kSq[1]+0.1888888888888889*epsilon[0]*rdx2Sq[0]-0.02222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[0], 0.0295084445425327*kSq[7]+0.03442651863295482*kSq[6]-0.063887656499994*kSq[5]-0.05962847939999439*kSq[4]-0.05333333333333333*kSq[3]+0.03849001794597505*kSq[2]-0.8888888888888888*epsilon[0]*rdx2Sq[1]+0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[1], (-0.03442651863295482*kSq[7])-0.03442651863295482*kSq[6]+0.09938079899999068*kSq[5]+0.09938079899999068*kSq[4]-0.02666666666666666*kSq[3]+0.0769800358919501*kSq[2]+0.0769800358919501*kSq[1]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[2], 0.01721325931647741*kSq[7]-0.05678902799999467*kSq[5]-0.03975231959999626*kSq[4]+0.01333333333333333*kSq[3]-0.4444444444444444*epsilon[0]*rdx2Sq[1]-0.03849001794597505*kSq[1]-0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[3], (-0.1967229636168847*kSq[7])+0.2271561119999787*kSq[5]-0.07950463919999252*kSq[4]+1.777777777777778*epsilon[0]*rdx2Sq[1]+0.3079201435678004*kSq[1]+0.5333333333333333*epsilon[0]*rdx2Sq[0]-0.3555555555555556*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[4], 0.1135780559999893*kSq[5]+0.07950463919999252*kSq[4]+0.8888888888888888*epsilon[0]*rdx2Sq[1]-0.5333333333333333*epsilon[0]*rdx2Sq[0]-0.1777777777777778*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[5], 0.0295084445425327*kSq[7]-0.03442651863295482*kSq[6]-0.063887656499994*kSq[5]-0.05962847939999439*kSq[4]+0.05333333333333333*kSq[3]-0.03849001794597505*kSq[2]-0.8888888888888888*epsilon[0]*rdx2Sq[1]+0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[6], (-0.03442651863295482*kSq[7])+0.03442651863295482*kSq[6]+0.09938079899999068*kSq[5]+0.09938079899999068*kSq[4]+0.02666666666666666*kSq[3]-0.0769800358919501*kSq[2]+0.0769800358919501*kSq[1]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[7], 0.01721325931647741*kSq[7]-0.05678902799999467*kSq[5]-0.03975231959999626*kSq[4]-0.01333333333333333*kSq[3]-0.4444444444444444*epsilon[0]*rdx2Sq[1]-0.03849001794597505*kSq[1]-0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[4], globalIdxs[0], (-0.01721325931647741*kSq[7])-0.05678902799999467*kSq[5]-0.03975231959999626*kSq[4]-0.01333333333333333*kSq[3]-0.4444444444444444*epsilon[0]*rdx2Sq[1]+0.03849001794597505*kSq[1]-0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[4], globalIdxs[1], 0.03442651863295482*kSq[7]-0.03442651863295482*kSq[6]+0.09938079899999068*kSq[5]+0.09938079899999068*kSq[4]+0.02666666666666666*kSq[3]+0.0769800358919501*kSq[2]-0.0769800358919501*kSq[1]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[4], globalIdxs[2], (-0.0295084445425327*kSq[7])+0.03442651863295482*kSq[6]-0.063887656499994*kSq[5]-0.05962847939999439*kSq[4]+0.05333333333333333*kSq[3]+0.03849001794597505*kSq[2]-0.8888888888888888*epsilon[0]*rdx2Sq[1]+0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[4], globalIdxs[3], 0.1135780559999893*kSq[5]+0.07950463919999252*kSq[4]+0.8888888888888888*epsilon[0]*rdx2Sq[1]-0.5333333333333333*epsilon[0]*rdx2Sq[0]-0.1777777777777778*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[4], globalIdxs[4], 0.1967229636168847*kSq[7]+0.2271561119999787*kSq[5]-0.07950463919999252*kSq[4]+1.777777777777778*epsilon[0]*rdx2Sq[1]-0.3079201435678004*kSq[1]+0.5333333333333333*epsilon[0]*rdx2Sq[0]-0.3555555555555556*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[4], globalIdxs[5], (-0.01721325931647741*kSq[7])-0.05678902799999467*kSq[5]-0.03975231959999626*kSq[4]+0.01333333333333333*kSq[3]-0.4444444444444444*epsilon[0]*rdx2Sq[1]+0.03849001794597505*kSq[1]-0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[4], globalIdxs[6], 0.03442651863295482*kSq[7]+0.03442651863295482*kSq[6]+0.09938079899999068*kSq[5]+0.09938079899999068*kSq[4]-0.02666666666666666*kSq[3]-0.0769800358919501*kSq[2]-0.0769800358919501*kSq[1]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[4], globalIdxs[7], (-0.0295084445425327*kSq[7])-0.03442651863295482*kSq[6]-0.063887656499994*kSq[5]-0.05962847939999439*kSq[4]-0.05333333333333333*kSq[3]-0.03849001794597505*kSq[2]-0.8888888888888888*epsilon[0]*rdx2Sq[1]+0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_insert(tri, globalIdxs[5], globalIdxs[0], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[5], globalIdxs[1], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[5], globalIdxs[2], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[5], globalIdxs[3], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[5], globalIdxs[4], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[5], globalIdxs[5], 1.0);
  gkyl_mat_triples_insert(tri, globalIdxs[5], globalIdxs[6], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[5], globalIdxs[7], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[6], globalIdxs[0], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[6], globalIdxs[1], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[6], globalIdxs[2], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[6], globalIdxs[3], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[6], globalIdxs[4], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[6], globalIdxs[5], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[6], globalIdxs[6], 1.0);
  gkyl_mat_triples_insert(tri, globalIdxs[6], globalIdxs[7], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[7], globalIdxs[0], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[7], globalIdxs[1], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[7], globalIdxs[2], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[7], globalIdxs[3], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[7], globalIdxs[4], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[7], globalIdxs[5], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[7], globalIdxs[6], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[7], globalIdxs[7], 1.0);

}
void fem_poisson_lhs_stencil_consteps_2x_ser_p1_upx_periodicx_upy_neumanny(const double *epsilon, const double *kSq, const double *dx, const double *bcVals, const long *globalIdxs, gkyl_mat_triples *tri) 
{ 
  // epsilon: permittivity.
  // kSq: wave number squared (factor multiplying phi).
  // dx: cell length in each direction.
  // bcVals[3]: values to impose as BCs, i.e. bcVals[0]*phi+bcVals[1]*d(phi)/dx=bcVals[2].
  // globalIdxs: global linear index of each basis function/node in current cell.
  // tri: triples object (i,j,val), i.e. contribute val to i,j element of the global matrix.

  double rdx2Sq[2];
  rdx2Sq[0] = 4.0/(dx[0]*dx[0]);
  rdx2Sq[1] = 4.0/(dx[1]*dx[1]);

  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[0], (-0.1666666666666667*kSq[3])+0.1924500897298752*kSq[2]+0.3333333333333333*epsilon[0]*rdx2Sq[1]+0.1924500897298752*kSq[1]+0.3333333333333333*epsilon[0]*rdx2Sq[0]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[1], 0.09622504486493762*kSq[2]+0.1666666666666667*epsilon[0]*rdx2Sq[1]-0.3333333333333333*epsilon[0]*rdx2Sq[0]-0.1111111111111111*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[2], (-0.3333333333333333*epsilon[0]*rdx2Sq[1])+0.09622504486493762*kSq[1]+0.1666666666666667*epsilon[0]*rdx2Sq[0]-0.1111111111111111*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[3], (-0.1666666666666667*epsilon[0]*rdx2Sq[1])-0.1666666666666667*epsilon[0]*rdx2Sq[0]-0.05555555555555555*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[0], 0.09622504486493762*kSq[2]+0.1666666666666667*epsilon[0]*rdx2Sq[1]-0.3333333333333333*epsilon[0]*rdx2Sq[0]-0.1111111111111111*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[1], 0.1666666666666667*kSq[3]+0.1924500897298752*kSq[2]+0.3333333333333333*epsilon[0]*rdx2Sq[1]-0.1924500897298752*kSq[1]+0.3333333333333333*epsilon[0]*rdx2Sq[0]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[2], (-0.1666666666666667*epsilon[0]*rdx2Sq[1])-0.1666666666666667*epsilon[0]*rdx2Sq[0]-0.05555555555555555*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[3], (-0.3333333333333333*epsilon[0]*rdx2Sq[1])-0.09622504486493762*kSq[1]+0.1666666666666667*epsilon[0]*rdx2Sq[0]-0.1111111111111111*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[0], (-0.3333333333333333*epsilon[0]*rdx2Sq[1])+0.09622504486493762*kSq[1]+0.1666666666666667*epsilon[0]*rdx2Sq[0]-0.1111111111111111*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[1], (-0.1666666666666667*epsilon[0]*rdx2Sq[1])-0.1666666666666667*epsilon[0]*rdx2Sq[0]-0.05555555555555555*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[2], 0.1666666666666667*kSq[3]-0.1924500897298752*kSq[2]+0.3333333333333333*epsilon[0]*rdx2Sq[1]+0.1924500897298752*kSq[1]+0.3333333333333333*epsilon[0]*rdx2Sq[0]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[3], (-0.09622504486493762*kSq[2])+0.1666666666666667*epsilon[0]*rdx2Sq[1]-0.3333333333333333*epsilon[0]*rdx2Sq[0]-0.1111111111111111*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[0], (-0.1666666666666667*epsilon[0]*rdx2Sq[1])-0.1666666666666667*epsilon[0]*rdx2Sq[0]-0.05555555555555555*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[1], (-0.3333333333333333*epsilon[0]*rdx2Sq[1])-0.09622504486493762*kSq[1]+0.1666666666666667*epsilon[0]*rdx2Sq[0]-0.1111111111111111*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[2], (-0.09622504486493762*kSq[2])+0.1666666666666667*epsilon[0]*rdx2Sq[1]-0.3333333333333333*epsilon[0]*rdx2Sq[0]-0.1111111111111111*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[3], (-0.1666666666666667*kSq[3])-0.1924500897298752*kSq[2]+0.3333333333333333*epsilon[0]*rdx2Sq[1]-0.1924500897298752*kSq[1]+0.3333333333333333*epsilon[0]*rdx2Sq[0]-0.2222222222222222*kSq[0]);

}
void fem_poisson_lhs_stencil_consteps_2x_ser_p2_upx_periodicx_upy_neumanny(const double *epsilon, const double *kSq, const double *dx, const double *bcVals, const long *globalIdxs, gkyl_mat_triples *tri) 
{ 
  // epsilon: permittivity.
  // kSq: wave number squared (factor multiplying phi).
  // dx: cell length in each direction.
  // bcVals[3]: values to impose as BCs, i.e. bcVals[0]*phi+bcVals[1]*d(phi)/dx=bcVals[2].
  // globalIdxs: global linear index of each basis function/node in current cell.
  // tri: triples object (i,j,val), i.e. contribute val to i,j element of the global matrix.

  double rdx2Sq[2];
  rdx2Sq[0] = 4.0/(dx[0]*dx[0]);
  rdx2Sq[1] = 4.0/(dx[1]*dx[1]);

  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[0], 0.04549218533640458*kSq[7]+0.04549218533640458*kSq[6]-0.0127775312999988*kSq[5]-0.0127775312999988*kSq[4]-0.04666666666666667*kSq[3]+0.03849001794597505*kSq[2]+0.5777777777777777*epsilon[0]*rdx2Sq[1]+0.03849001794597505*kSq[1]+0.5777777777777777*epsilon[0]*rdx2Sq[0]-0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[1], 0.03442651863295482*kSq[7]+0.0295084445425327*kSq[6]-0.05962847939999439*kSq[5]-0.063887656499994*kSq[4]-0.05333333333333333*kSq[3]+0.06666666666666667*epsilon[0]*rdx2Sq[1]+0.03849001794597505*kSq[1]-0.8888888888888888*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[2], (-0.006147592613027645*kSq[6])+0.03336355394999686*kSq[5]+0.02697478829999747*kSq[4]-0.01924500897298752*kSq[2]+0.1888888888888889*epsilon[0]*rdx2Sq[1]+0.3111111111111111*epsilon[0]*rdx2Sq[0]-0.02222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[3], 0.0295084445425327*kSq[7]+0.03442651863295482*kSq[6]-0.063887656499994*kSq[5]-0.05962847939999439*kSq[4]-0.05333333333333333*kSq[3]+0.03849001794597505*kSq[2]-0.8888888888888888*epsilon[0]*rdx2Sq[1]+0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[4], (-0.01721325931647741*kSq[7])-0.05678902799999467*kSq[5]-0.03975231959999626*kSq[4]-0.01333333333333333*kSq[3]-0.4444444444444444*epsilon[0]*rdx2Sq[1]+0.03849001794597505*kSq[1]-0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[5], (-0.006147592613027645*kSq[7])+0.02697478829999747*kSq[5]+0.03336355394999686*kSq[4]+0.3111111111111111*epsilon[0]*rdx2Sq[1]-0.01924500897298752*kSq[1]+0.1888888888888889*epsilon[0]*rdx2Sq[0]-0.02222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[6], (-0.01721325931647741*kSq[6])-0.03975231959999626*kSq[5]-0.05678902799999467*kSq[4]-0.01333333333333333*kSq[3]+0.03849001794597505*kSq[2]-0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.4444444444444444*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[7], 0.0234254740499978*kSq[5]+0.0234254740499978*kSq[4]+0.01333333333333333*kSq[3]+0.2555555555555555*epsilon[0]*rdx2Sq[1]+0.2555555555555555*epsilon[0]*rdx2Sq[0]-0.03333333333333333*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[0], 0.03442651863295482*kSq[7]+0.0295084445425327*kSq[6]-0.05962847939999439*kSq[5]-0.063887656499994*kSq[4]-0.05333333333333333*kSq[3]+0.06666666666666667*epsilon[0]*rdx2Sq[1]+0.03849001794597505*kSq[1]-0.8888888888888888*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[1], (-0.1967229636168847*kSq[6])-0.07950463919999252*kSq[5]+0.2271561119999787*kSq[4]+0.3079201435678004*kSq[2]+0.5333333333333333*epsilon[0]*rdx2Sq[1]+1.777777777777778*epsilon[0]*rdx2Sq[0]-0.3555555555555556*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[2], (-0.03442651863295482*kSq[7])+0.0295084445425327*kSq[6]-0.05962847939999439*kSq[5]-0.063887656499994*kSq[4]+0.05333333333333333*kSq[3]+0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.03849001794597505*kSq[1]-0.8888888888888888*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[3], (-0.03442651863295482*kSq[7])-0.03442651863295482*kSq[6]+0.09938079899999068*kSq[5]+0.09938079899999068*kSq[4]-0.02666666666666666*kSq[3]+0.0769800358919501*kSq[2]+0.0769800358919501*kSq[1]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[4], 0.03442651863295482*kSq[7]-0.03442651863295482*kSq[6]+0.09938079899999068*kSq[5]+0.09938079899999068*kSq[4]+0.02666666666666666*kSq[3]+0.0769800358919501*kSq[2]-0.0769800358919501*kSq[1]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[5], 0.01721325931647741*kSq[6]-0.03975231959999626*kSq[5]-0.05678902799999467*kSq[4]+0.01333333333333333*kSq[3]-0.03849001794597505*kSq[2]-0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.4444444444444444*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[6], 0.07950463919999252*kSq[5]+0.1135780559999893*kSq[4]-0.5333333333333333*epsilon[0]*rdx2Sq[1]+0.8888888888888888*epsilon[0]*rdx2Sq[0]-0.1777777777777778*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[7], 0.01721325931647741*kSq[6]-0.03975231959999626*kSq[5]-0.05678902799999467*kSq[4]-0.01333333333333333*kSq[3]-0.03849001794597505*kSq[2]-0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.4444444444444444*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[0], (-0.006147592613027645*kSq[6])+0.03336355394999686*kSq[5]+0.02697478829999747*kSq[4]-0.01924500897298752*kSq[2]+0.1888888888888889*epsilon[0]*rdx2Sq[1]+0.3111111111111111*epsilon[0]*rdx2Sq[0]-0.02222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[1], (-0.03442651863295482*kSq[7])+0.0295084445425327*kSq[6]-0.05962847939999439*kSq[5]-0.063887656499994*kSq[4]+0.05333333333333333*kSq[3]+0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.03849001794597505*kSq[1]-0.8888888888888888*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[2], (-0.04549218533640458*kSq[7])+0.04549218533640458*kSq[6]-0.0127775312999988*kSq[5]-0.0127775312999988*kSq[4]+0.04666666666666667*kSq[3]+0.03849001794597505*kSq[2]+0.5777777777777777*epsilon[0]*rdx2Sq[1]-0.03849001794597505*kSq[1]+0.5777777777777777*epsilon[0]*rdx2Sq[0]-0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[3], 0.01721325931647741*kSq[7]-0.05678902799999467*kSq[5]-0.03975231959999626*kSq[4]+0.01333333333333333*kSq[3]-0.4444444444444444*epsilon[0]*rdx2Sq[1]-0.03849001794597505*kSq[1]-0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[4], (-0.0295084445425327*kSq[7])+0.03442651863295482*kSq[6]-0.063887656499994*kSq[5]-0.05962847939999439*kSq[4]+0.05333333333333333*kSq[3]+0.03849001794597505*kSq[2]-0.8888888888888888*epsilon[0]*rdx2Sq[1]+0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[5], 0.0234254740499978*kSq[5]+0.0234254740499978*kSq[4]-0.01333333333333333*kSq[3]+0.2555555555555555*epsilon[0]*rdx2Sq[1]+0.2555555555555555*epsilon[0]*rdx2Sq[0]-0.03333333333333333*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[6], (-0.01721325931647741*kSq[6])-0.03975231959999626*kSq[5]-0.05678902799999467*kSq[4]+0.01333333333333333*kSq[3]+0.03849001794597505*kSq[2]-0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.4444444444444444*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[7], 0.006147592613027645*kSq[7]+0.02697478829999747*kSq[5]+0.03336355394999686*kSq[4]+0.3111111111111111*epsilon[0]*rdx2Sq[1]+0.01924500897298752*kSq[1]+0.1888888888888889*epsilon[0]*rdx2Sq[0]-0.02222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[0], 0.0295084445425327*kSq[7]+0.03442651863295482*kSq[6]-0.063887656499994*kSq[5]-0.05962847939999439*kSq[4]-0.05333333333333333*kSq[3]+0.03849001794597505*kSq[2]-0.8888888888888888*epsilon[0]*rdx2Sq[1]+0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[1], (-0.03442651863295482*kSq[7])-0.03442651863295482*kSq[6]+0.09938079899999068*kSq[5]+0.09938079899999068*kSq[4]-0.02666666666666666*kSq[3]+0.0769800358919501*kSq[2]+0.0769800358919501*kSq[1]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[2], 0.01721325931647741*kSq[7]-0.05678902799999467*kSq[5]-0.03975231959999626*kSq[4]+0.01333333333333333*kSq[3]-0.4444444444444444*epsilon[0]*rdx2Sq[1]-0.03849001794597505*kSq[1]-0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[3], (-0.1967229636168847*kSq[7])+0.2271561119999787*kSq[5]-0.07950463919999252*kSq[4]+1.777777777777778*epsilon[0]*rdx2Sq[1]+0.3079201435678004*kSq[1]+0.5333333333333333*epsilon[0]*rdx2Sq[0]-0.3555555555555556*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[4], 0.1135780559999893*kSq[5]+0.07950463919999252*kSq[4]+0.8888888888888888*epsilon[0]*rdx2Sq[1]-0.5333333333333333*epsilon[0]*rdx2Sq[0]-0.1777777777777778*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[5], 0.0295084445425327*kSq[7]-0.03442651863295482*kSq[6]-0.063887656499994*kSq[5]-0.05962847939999439*kSq[4]+0.05333333333333333*kSq[3]-0.03849001794597505*kSq[2]-0.8888888888888888*epsilon[0]*rdx2Sq[1]+0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[6], (-0.03442651863295482*kSq[7])+0.03442651863295482*kSq[6]+0.09938079899999068*kSq[5]+0.09938079899999068*kSq[4]+0.02666666666666666*kSq[3]-0.0769800358919501*kSq[2]+0.0769800358919501*kSq[1]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[7], 0.01721325931647741*kSq[7]-0.05678902799999467*kSq[5]-0.03975231959999626*kSq[4]-0.01333333333333333*kSq[3]-0.4444444444444444*epsilon[0]*rdx2Sq[1]-0.03849001794597505*kSq[1]-0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[4], globalIdxs[0], (-0.01721325931647741*kSq[7])-0.05678902799999467*kSq[5]-0.03975231959999626*kSq[4]-0.01333333333333333*kSq[3]-0.4444444444444444*epsilon[0]*rdx2Sq[1]+0.03849001794597505*kSq[1]-0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[4], globalIdxs[1], 0.03442651863295482*kSq[7]-0.03442651863295482*kSq[6]+0.09938079899999068*kSq[5]+0.09938079899999068*kSq[4]+0.02666666666666666*kSq[3]+0.0769800358919501*kSq[2]-0.0769800358919501*kSq[1]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[4], globalIdxs[2], (-0.0295084445425327*kSq[7])+0.03442651863295482*kSq[6]-0.063887656499994*kSq[5]-0.05962847939999439*kSq[4]+0.05333333333333333*kSq[3]+0.03849001794597505*kSq[2]-0.8888888888888888*epsilon[0]*rdx2Sq[1]+0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[4], globalIdxs[3], 0.1135780559999893*kSq[5]+0.07950463919999252*kSq[4]+0.8888888888888888*epsilon[0]*rdx2Sq[1]-0.5333333333333333*epsilon[0]*rdx2Sq[0]-0.1777777777777778*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[4], globalIdxs[4], 0.1967229636168847*kSq[7]+0.2271561119999787*kSq[5]-0.07950463919999252*kSq[4]+1.777777777777778*epsilon[0]*rdx2Sq[1]-0.3079201435678004*kSq[1]+0.5333333333333333*epsilon[0]*rdx2Sq[0]-0.3555555555555556*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[4], globalIdxs[5], (-0.01721325931647741*kSq[7])-0.05678902799999467*kSq[5]-0.03975231959999626*kSq[4]+0.01333333333333333*kSq[3]-0.4444444444444444*epsilon[0]*rdx2Sq[1]+0.03849001794597505*kSq[1]-0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[4], globalIdxs[6], 0.03442651863295482*kSq[7]+0.03442651863295482*kSq[6]+0.09938079899999068*kSq[5]+0.09938079899999068*kSq[4]-0.02666666666666666*kSq[3]-0.0769800358919501*kSq[2]-0.0769800358919501*kSq[1]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[4], globalIdxs[7], (-0.0295084445425327*kSq[7])-0.03442651863295482*kSq[6]-0.063887656499994*kSq[5]-0.05962847939999439*kSq[4]-0.05333333333333333*kSq[3]-0.03849001794597505*kSq[2]-0.8888888888888888*epsilon[0]*rdx2Sq[1]+0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[5], globalIdxs[0], (-0.006147592613027645*kSq[7])+0.02697478829999747*kSq[5]+0.03336355394999686*kSq[4]+0.3111111111111111*epsilon[0]*rdx2Sq[1]-0.01924500897298752*kSq[1]+0.1888888888888889*epsilon[0]*rdx2Sq[0]-0.02222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[5], globalIdxs[1], 0.01721325931647741*kSq[6]-0.03975231959999626*kSq[5]-0.05678902799999467*kSq[4]+0.01333333333333333*kSq[3]-0.03849001794597505*kSq[2]-0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.4444444444444444*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[5], globalIdxs[2], 0.0234254740499978*kSq[5]+0.0234254740499978*kSq[4]-0.01333333333333333*kSq[3]+0.2555555555555555*epsilon[0]*rdx2Sq[1]+0.2555555555555555*epsilon[0]*rdx2Sq[0]-0.03333333333333333*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[5], globalIdxs[3], 0.0295084445425327*kSq[7]-0.03442651863295482*kSq[6]-0.063887656499994*kSq[5]-0.05962847939999439*kSq[4]+0.05333333333333333*kSq[3]-0.03849001794597505*kSq[2]-0.8888888888888888*epsilon[0]*rdx2Sq[1]+0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[5], globalIdxs[4], (-0.01721325931647741*kSq[7])-0.05678902799999467*kSq[5]-0.03975231959999626*kSq[4]+0.01333333333333333*kSq[3]-0.4444444444444444*epsilon[0]*rdx2Sq[1]+0.03849001794597505*kSq[1]-0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[5], globalIdxs[5], 0.04549218533640458*kSq[7]-0.04549218533640458*kSq[6]-0.0127775312999988*kSq[5]-0.0127775312999988*kSq[4]+0.04666666666666667*kSq[3]-0.03849001794597505*kSq[2]+0.5777777777777777*epsilon[0]*rdx2Sq[1]+0.03849001794597505*kSq[1]+0.5777777777777777*epsilon[0]*rdx2Sq[0]-0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[5], globalIdxs[6], 0.03442651863295482*kSq[7]-0.0295084445425327*kSq[6]-0.05962847939999439*kSq[5]-0.063887656499994*kSq[4]+0.05333333333333333*kSq[3]+0.06666666666666667*epsilon[0]*rdx2Sq[1]+0.03849001794597505*kSq[1]-0.8888888888888888*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[5], globalIdxs[7], 0.006147592613027645*kSq[6]+0.03336355394999686*kSq[5]+0.02697478829999747*kSq[4]+0.01924500897298752*kSq[2]+0.1888888888888889*epsilon[0]*rdx2Sq[1]+0.3111111111111111*epsilon[0]*rdx2Sq[0]-0.02222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[6], globalIdxs[0], (-0.01721325931647741*kSq[6])-0.03975231959999626*kSq[5]-0.05678902799999467*kSq[4]-0.01333333333333333*kSq[3]+0.03849001794597505*kSq[2]-0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.4444444444444444*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[6], globalIdxs[1], 0.07950463919999252*kSq[5]+0.1135780559999893*kSq[4]-0.5333333333333333*epsilon[0]*rdx2Sq[1]+0.8888888888888888*epsilon[0]*rdx2Sq[0]-0.1777777777777778*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[6], globalIdxs[2], (-0.01721325931647741*kSq[6])-0.03975231959999626*kSq[5]-0.05678902799999467*kSq[4]+0.01333333333333333*kSq[3]+0.03849001794597505*kSq[2]-0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.4444444444444444*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[6], globalIdxs[3], (-0.03442651863295482*kSq[7])+0.03442651863295482*kSq[6]+0.09938079899999068*kSq[5]+0.09938079899999068*kSq[4]+0.02666666666666666*kSq[3]-0.0769800358919501*kSq[2]+0.0769800358919501*kSq[1]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[6], globalIdxs[4], 0.03442651863295482*kSq[7]+0.03442651863295482*kSq[6]+0.09938079899999068*kSq[5]+0.09938079899999068*kSq[4]-0.02666666666666666*kSq[3]-0.0769800358919501*kSq[2]-0.0769800358919501*kSq[1]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[6], globalIdxs[5], 0.03442651863295482*kSq[7]-0.0295084445425327*kSq[6]-0.05962847939999439*kSq[5]-0.063887656499994*kSq[4]+0.05333333333333333*kSq[3]+0.06666666666666667*epsilon[0]*rdx2Sq[1]+0.03849001794597505*kSq[1]-0.8888888888888888*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[6], globalIdxs[6], 0.1967229636168847*kSq[6]-0.07950463919999252*kSq[5]+0.2271561119999787*kSq[4]-0.3079201435678004*kSq[2]+0.5333333333333333*epsilon[0]*rdx2Sq[1]+1.777777777777778*epsilon[0]*rdx2Sq[0]-0.3555555555555556*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[6], globalIdxs[7], (-0.03442651863295482*kSq[7])-0.0295084445425327*kSq[6]-0.05962847939999439*kSq[5]-0.063887656499994*kSq[4]-0.05333333333333333*kSq[3]+0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.03849001794597505*kSq[1]-0.8888888888888888*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[7], globalIdxs[0], 0.0234254740499978*kSq[5]+0.0234254740499978*kSq[4]+0.01333333333333333*kSq[3]+0.2555555555555555*epsilon[0]*rdx2Sq[1]+0.2555555555555555*epsilon[0]*rdx2Sq[0]-0.03333333333333333*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[7], globalIdxs[1], 0.01721325931647741*kSq[6]-0.03975231959999626*kSq[5]-0.05678902799999467*kSq[4]-0.01333333333333333*kSq[3]-0.03849001794597505*kSq[2]-0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.4444444444444444*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[7], globalIdxs[2], 0.006147592613027645*kSq[7]+0.02697478829999747*kSq[5]+0.03336355394999686*kSq[4]+0.3111111111111111*epsilon[0]*rdx2Sq[1]+0.01924500897298752*kSq[1]+0.1888888888888889*epsilon[0]*rdx2Sq[0]-0.02222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[7], globalIdxs[3], 0.01721325931647741*kSq[7]-0.05678902799999467*kSq[5]-0.03975231959999626*kSq[4]-0.01333333333333333*kSq[3]-0.4444444444444444*epsilon[0]*rdx2Sq[1]-0.03849001794597505*kSq[1]-0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[7], globalIdxs[4], (-0.0295084445425327*kSq[7])-0.03442651863295482*kSq[6]-0.063887656499994*kSq[5]-0.05962847939999439*kSq[4]-0.05333333333333333*kSq[3]-0.03849001794597505*kSq[2]-0.8888888888888888*epsilon[0]*rdx2Sq[1]+0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[7], globalIdxs[5], 0.006147592613027645*kSq[6]+0.03336355394999686*kSq[5]+0.02697478829999747*kSq[4]+0.01924500897298752*kSq[2]+0.1888888888888889*epsilon[0]*rdx2Sq[1]+0.3111111111111111*epsilon[0]*rdx2Sq[0]-0.02222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[7], globalIdxs[6], (-0.03442651863295482*kSq[7])-0.0295084445425327*kSq[6]-0.05962847939999439*kSq[5]-0.063887656499994*kSq[4]-0.05333333333333333*kSq[3]+0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.03849001794597505*kSq[1]-0.8888888888888888*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[7], globalIdxs[7], (-0.04549218533640458*kSq[7])-0.04549218533640458*kSq[6]-0.0127775312999988*kSq[5]-0.0127775312999988*kSq[4]-0.04666666666666667*kSq[3]-0.03849001794597505*kSq[2]+0.5777777777777777*epsilon[0]*rdx2Sq[1]-0.03849001794597505*kSq[1]+0.5777777777777777*epsilon[0]*rdx2Sq[0]-0.06666666666666667*kSq[0]);

}
void fem_poisson_lhs_stencil_consteps_2x_ser_p1_upx_periodicx_upy_robiny(const double *epsilon, const double *kSq, const double *dx, const double *bcVals, const long *globalIdxs, gkyl_mat_triples *tri) 
{ 
  // epsilon: permittivity.
  // kSq: wave number squared (factor multiplying phi).
  // dx: cell length in each direction.
  // bcVals[3]: values to impose as BCs, i.e. bcVals[0]*phi+bcVals[1]*d(phi)/dx=bcVals[2].
  // globalIdxs: global linear index of each basis function/node in current cell.
  // tri: triples object (i,j,val), i.e. contribute val to i,j element of the global matrix.

  double rdx2Sq[2];
  rdx2Sq[0] = 4.0/(dx[0]*dx[0]);
  rdx2Sq[1] = 4.0/(dx[1]*dx[1]);

  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[0], (-0.1666666666666667*kSq[3])+0.1924500897298752*kSq[2]+0.3333333333333333*epsilon[0]*rdx2Sq[1]+0.1924500897298752*kSq[1]+0.3333333333333333*epsilon[0]*rdx2Sq[0]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[1], 0.09622504486493762*kSq[2]+0.1666666666666667*epsilon[0]*rdx2Sq[1]-0.3333333333333333*epsilon[0]*rdx2Sq[0]-0.1111111111111111*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[2], (-0.3333333333333333*epsilon[0]*rdx2Sq[1])+0.09622504486493762*kSq[1]+0.1666666666666667*epsilon[0]*rdx2Sq[0]-0.1111111111111111*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[3], (-0.1666666666666667*epsilon[0]*rdx2Sq[1])-0.1666666666666667*epsilon[0]*rdx2Sq[0]-0.05555555555555555*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[0], 0.09622504486493762*kSq[2]+0.1666666666666667*epsilon[0]*rdx2Sq[1]-0.3333333333333333*epsilon[0]*rdx2Sq[0]-0.1111111111111111*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[1], 0.1666666666666667*kSq[3]+0.1924500897298752*kSq[2]+0.3333333333333333*epsilon[0]*rdx2Sq[1]-0.1924500897298752*kSq[1]+0.3333333333333333*epsilon[0]*rdx2Sq[0]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[2], (-0.1666666666666667*epsilon[0]*rdx2Sq[1])-0.1666666666666667*epsilon[0]*rdx2Sq[0]-0.05555555555555555*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[3], (-0.3333333333333333*epsilon[0]*rdx2Sq[1])-0.09622504486493762*kSq[1]+0.1666666666666667*epsilon[0]*rdx2Sq[0]-0.1111111111111111*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[0], (-0.3333333333333333*epsilon[0]*rdx2Sq[1])+0.09622504486493762*kSq[1]+0.1666666666666667*epsilon[0]*rdx2Sq[0]-0.1111111111111111*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[1], (-0.1666666666666667*epsilon[0]*rdx2Sq[1])-0.1666666666666667*epsilon[0]*rdx2Sq[0]-0.05555555555555555*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[2], (0.6666666666666666*epsilon[0]*rdx2Sq[1]*bcVals[9])/bcVals[10]+0.1666666666666667*kSq[3]-0.1924500897298752*kSq[2]+0.3333333333333333*epsilon[0]*rdx2Sq[1]+0.1924500897298752*kSq[1]+0.3333333333333333*epsilon[0]*rdx2Sq[0]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[3], (0.3333333333333333*epsilon[0]*rdx2Sq[1]*bcVals[9])/bcVals[10]-0.09622504486493762*kSq[2]+0.1666666666666667*epsilon[0]*rdx2Sq[1]-0.3333333333333333*epsilon[0]*rdx2Sq[0]-0.1111111111111111*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[0], (-0.1666666666666667*epsilon[0]*rdx2Sq[1])-0.1666666666666667*epsilon[0]*rdx2Sq[0]-0.05555555555555555*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[1], (-0.3333333333333333*epsilon[0]*rdx2Sq[1])-0.09622504486493762*kSq[1]+0.1666666666666667*epsilon[0]*rdx2Sq[0]-0.1111111111111111*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[2], (0.3333333333333333*epsilon[0]*rdx2Sq[1]*bcVals[9])/bcVals[10]-0.09622504486493762*kSq[2]+0.1666666666666667*epsilon[0]*rdx2Sq[1]-0.3333333333333333*epsilon[0]*rdx2Sq[0]-0.1111111111111111*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[3], (0.6666666666666666*epsilon[0]*rdx2Sq[1]*bcVals[9])/bcVals[10]-0.1666666666666667*kSq[3]-0.1924500897298752*kSq[2]+0.3333333333333333*epsilon[0]*rdx2Sq[1]-0.1924500897298752*kSq[1]+0.3333333333333333*epsilon[0]*rdx2Sq[0]-0.2222222222222222*kSq[0]);

}
void fem_poisson_lhs_stencil_consteps_2x_ser_p2_upx_periodicx_upy_robiny(const double *epsilon, const double *kSq, const double *dx, const double *bcVals, const long *globalIdxs, gkyl_mat_triples *tri) 
{ 
  // epsilon: permittivity.
  // kSq: wave number squared (factor multiplying phi).
  // dx: cell length in each direction.
  // bcVals[3]: values to impose as BCs, i.e. bcVals[0]*phi+bcVals[1]*d(phi)/dx=bcVals[2].
  // globalIdxs: global linear index of each basis function/node in current cell.
  // tri: triples object (i,j,val), i.e. contribute val to i,j element of the global matrix.

  double rdx2Sq[2];
  rdx2Sq[0] = 4.0/(dx[0]*dx[0]);
  rdx2Sq[1] = 4.0/(dx[1]*dx[1]);

  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[0], 0.04549218533640458*kSq[7]+0.04549218533640458*kSq[6]-0.0127775312999988*kSq[5]-0.0127775312999988*kSq[4]-0.04666666666666667*kSq[3]+0.03849001794597505*kSq[2]+0.5777777777777777*epsilon[0]*rdx2Sq[1]+0.03849001794597505*kSq[1]+0.5777777777777777*epsilon[0]*rdx2Sq[0]-0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[1], 0.03442651863295482*kSq[7]+0.0295084445425327*kSq[6]-0.05962847939999439*kSq[5]-0.063887656499994*kSq[4]-0.05333333333333333*kSq[3]+0.06666666666666667*epsilon[0]*rdx2Sq[1]+0.03849001794597505*kSq[1]-0.8888888888888888*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[2], (-0.006147592613027645*kSq[6])+0.03336355394999686*kSq[5]+0.02697478829999747*kSq[4]-0.01924500897298752*kSq[2]+0.1888888888888889*epsilon[0]*rdx2Sq[1]+0.3111111111111111*epsilon[0]*rdx2Sq[0]-0.02222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[3], 0.0295084445425327*kSq[7]+0.03442651863295482*kSq[6]-0.063887656499994*kSq[5]-0.05962847939999439*kSq[4]-0.05333333333333333*kSq[3]+0.03849001794597505*kSq[2]-0.8888888888888888*epsilon[0]*rdx2Sq[1]+0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[4], (-0.01721325931647741*kSq[7])-0.05678902799999467*kSq[5]-0.03975231959999626*kSq[4]-0.01333333333333333*kSq[3]-0.4444444444444444*epsilon[0]*rdx2Sq[1]+0.03849001794597505*kSq[1]-0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[5], (-0.006147592613027645*kSq[7])+0.02697478829999747*kSq[5]+0.03336355394999686*kSq[4]+0.3111111111111111*epsilon[0]*rdx2Sq[1]-0.01924500897298752*kSq[1]+0.1888888888888889*epsilon[0]*rdx2Sq[0]-0.02222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[6], (-0.01721325931647741*kSq[6])-0.03975231959999626*kSq[5]-0.05678902799999467*kSq[4]-0.01333333333333333*kSq[3]+0.03849001794597505*kSq[2]-0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.4444444444444444*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[7], 0.0234254740499978*kSq[5]+0.0234254740499978*kSq[4]+0.01333333333333333*kSq[3]+0.2555555555555555*epsilon[0]*rdx2Sq[1]+0.2555555555555555*epsilon[0]*rdx2Sq[0]-0.03333333333333333*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[0], 0.03442651863295482*kSq[7]+0.0295084445425327*kSq[6]-0.05962847939999439*kSq[5]-0.063887656499994*kSq[4]-0.05333333333333333*kSq[3]+0.06666666666666667*epsilon[0]*rdx2Sq[1]+0.03849001794597505*kSq[1]-0.8888888888888888*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[1], (-0.1967229636168847*kSq[6])-0.07950463919999252*kSq[5]+0.2271561119999787*kSq[4]+0.3079201435678004*kSq[2]+0.5333333333333333*epsilon[0]*rdx2Sq[1]+1.777777777777778*epsilon[0]*rdx2Sq[0]-0.3555555555555556*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[2], (-0.03442651863295482*kSq[7])+0.0295084445425327*kSq[6]-0.05962847939999439*kSq[5]-0.063887656499994*kSq[4]+0.05333333333333333*kSq[3]+0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.03849001794597505*kSq[1]-0.8888888888888888*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[3], (-0.03442651863295482*kSq[7])-0.03442651863295482*kSq[6]+0.09938079899999068*kSq[5]+0.09938079899999068*kSq[4]-0.02666666666666666*kSq[3]+0.0769800358919501*kSq[2]+0.0769800358919501*kSq[1]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[4], 0.03442651863295482*kSq[7]-0.03442651863295482*kSq[6]+0.09938079899999068*kSq[5]+0.09938079899999068*kSq[4]+0.02666666666666666*kSq[3]+0.0769800358919501*kSq[2]-0.0769800358919501*kSq[1]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[5], 0.01721325931647741*kSq[6]-0.03975231959999626*kSq[5]-0.05678902799999467*kSq[4]+0.01333333333333333*kSq[3]-0.03849001794597505*kSq[2]-0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.4444444444444444*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[6], 0.07950463919999252*kSq[5]+0.1135780559999893*kSq[4]-0.5333333333333333*epsilon[0]*rdx2Sq[1]+0.8888888888888888*epsilon[0]*rdx2Sq[0]-0.1777777777777778*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[7], 0.01721325931647741*kSq[6]-0.03975231959999626*kSq[5]-0.05678902799999467*kSq[4]-0.01333333333333333*kSq[3]-0.03849001794597505*kSq[2]-0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.4444444444444444*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[0], (-0.006147592613027645*kSq[6])+0.03336355394999686*kSq[5]+0.02697478829999747*kSq[4]-0.01924500897298752*kSq[2]+0.1888888888888889*epsilon[0]*rdx2Sq[1]+0.3111111111111111*epsilon[0]*rdx2Sq[0]-0.02222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[1], (-0.03442651863295482*kSq[7])+0.0295084445425327*kSq[6]-0.05962847939999439*kSq[5]-0.063887656499994*kSq[4]+0.05333333333333333*kSq[3]+0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.03849001794597505*kSq[1]-0.8888888888888888*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[2], (-0.04549218533640458*kSq[7])+0.04549218533640458*kSq[6]-0.0127775312999988*kSq[5]-0.0127775312999988*kSq[4]+0.04666666666666667*kSq[3]+0.03849001794597505*kSq[2]+0.5777777777777777*epsilon[0]*rdx2Sq[1]-0.03849001794597505*kSq[1]+0.5777777777777777*epsilon[0]*rdx2Sq[0]-0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[3], 0.01721325931647741*kSq[7]-0.05678902799999467*kSq[5]-0.03975231959999626*kSq[4]+0.01333333333333333*kSq[3]-0.4444444444444444*epsilon[0]*rdx2Sq[1]-0.03849001794597505*kSq[1]-0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[4], (-0.0295084445425327*kSq[7])+0.03442651863295482*kSq[6]-0.063887656499994*kSq[5]-0.05962847939999439*kSq[4]+0.05333333333333333*kSq[3]+0.03849001794597505*kSq[2]-0.8888888888888888*epsilon[0]*rdx2Sq[1]+0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[5], 0.0234254740499978*kSq[5]+0.0234254740499978*kSq[4]-0.01333333333333333*kSq[3]+0.2555555555555555*epsilon[0]*rdx2Sq[1]+0.2555555555555555*epsilon[0]*rdx2Sq[0]-0.03333333333333333*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[6], (-0.01721325931647741*kSq[6])-0.03975231959999626*kSq[5]-0.05678902799999467*kSq[4]+0.01333333333333333*kSq[3]+0.03849001794597505*kSq[2]-0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.4444444444444444*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[7], 0.006147592613027645*kSq[7]+0.02697478829999747*kSq[5]+0.03336355394999686*kSq[4]+0.3111111111111111*epsilon[0]*rdx2Sq[1]+0.01924500897298752*kSq[1]+0.1888888888888889*epsilon[0]*rdx2Sq[0]-0.02222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[0], 0.0295084445425327*kSq[7]+0.03442651863295482*kSq[6]-0.063887656499994*kSq[5]-0.05962847939999439*kSq[4]-0.05333333333333333*kSq[3]+0.03849001794597505*kSq[2]-0.8888888888888888*epsilon[0]*rdx2Sq[1]+0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[1], (-0.03442651863295482*kSq[7])-0.03442651863295482*kSq[6]+0.09938079899999068*kSq[5]+0.09938079899999068*kSq[4]-0.02666666666666666*kSq[3]+0.0769800358919501*kSq[2]+0.0769800358919501*kSq[1]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[2], 0.01721325931647741*kSq[7]-0.05678902799999467*kSq[5]-0.03975231959999626*kSq[4]+0.01333333333333333*kSq[3]-0.4444444444444444*epsilon[0]*rdx2Sq[1]-0.03849001794597505*kSq[1]-0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[3], (-0.1967229636168847*kSq[7])+0.2271561119999787*kSq[5]-0.07950463919999252*kSq[4]+1.777777777777778*epsilon[0]*rdx2Sq[1]+0.3079201435678004*kSq[1]+0.5333333333333333*epsilon[0]*rdx2Sq[0]-0.3555555555555556*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[4], 0.1135780559999893*kSq[5]+0.07950463919999252*kSq[4]+0.8888888888888888*epsilon[0]*rdx2Sq[1]-0.5333333333333333*epsilon[0]*rdx2Sq[0]-0.1777777777777778*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[5], 0.0295084445425327*kSq[7]-0.03442651863295482*kSq[6]-0.063887656499994*kSq[5]-0.05962847939999439*kSq[4]+0.05333333333333333*kSq[3]-0.03849001794597505*kSq[2]-0.8888888888888888*epsilon[0]*rdx2Sq[1]+0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[6], (-0.03442651863295482*kSq[7])+0.03442651863295482*kSq[6]+0.09938079899999068*kSq[5]+0.09938079899999068*kSq[4]+0.02666666666666666*kSq[3]-0.0769800358919501*kSq[2]+0.0769800358919501*kSq[1]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[7], 0.01721325931647741*kSq[7]-0.05678902799999467*kSq[5]-0.03975231959999626*kSq[4]-0.01333333333333333*kSq[3]-0.4444444444444444*epsilon[0]*rdx2Sq[1]-0.03849001794597505*kSq[1]-0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[4], globalIdxs[0], (-0.01721325931647741*kSq[7])-0.05678902799999467*kSq[5]-0.03975231959999626*kSq[4]-0.01333333333333333*kSq[3]-0.4444444444444444*epsilon[0]*rdx2Sq[1]+0.03849001794597505*kSq[1]-0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[4], globalIdxs[1], 0.03442651863295482*kSq[7]-0.03442651863295482*kSq[6]+0.09938079899999068*kSq[5]+0.09938079899999068*kSq[4]+0.02666666666666666*kSq[3]+0.0769800358919501*kSq[2]-0.0769800358919501*kSq[1]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[4], globalIdxs[2], (-0.0295084445425327*kSq[7])+0.03442651863295482*kSq[6]-0.063887656499994*kSq[5]-0.05962847939999439*kSq[4]+0.05333333333333333*kSq[3]+0.03849001794597505*kSq[2]-0.8888888888888888*epsilon[0]*rdx2Sq[1]+0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[4], globalIdxs[3], 0.1135780559999893*kSq[5]+0.07950463919999252*kSq[4]+0.8888888888888888*epsilon[0]*rdx2Sq[1]-0.5333333333333333*epsilon[0]*rdx2Sq[0]-0.1777777777777778*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[4], globalIdxs[4], 0.1967229636168847*kSq[7]+0.2271561119999787*kSq[5]-0.07950463919999252*kSq[4]+1.777777777777778*epsilon[0]*rdx2Sq[1]-0.3079201435678004*kSq[1]+0.5333333333333333*epsilon[0]*rdx2Sq[0]-0.3555555555555556*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[4], globalIdxs[5], (-0.01721325931647741*kSq[7])-0.05678902799999467*kSq[5]-0.03975231959999626*kSq[4]+0.01333333333333333*kSq[3]-0.4444444444444444*epsilon[0]*rdx2Sq[1]+0.03849001794597505*kSq[1]-0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[4], globalIdxs[6], 0.03442651863295482*kSq[7]+0.03442651863295482*kSq[6]+0.09938079899999068*kSq[5]+0.09938079899999068*kSq[4]-0.02666666666666666*kSq[3]-0.0769800358919501*kSq[2]-0.0769800358919501*kSq[1]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[4], globalIdxs[7], (-0.0295084445425327*kSq[7])-0.03442651863295482*kSq[6]-0.063887656499994*kSq[5]-0.05962847939999439*kSq[4]-0.05333333333333333*kSq[3]-0.03849001794597505*kSq[2]-0.8888888888888888*epsilon[0]*rdx2Sq[1]+0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[5], globalIdxs[0], (-0.006147592613027645*kSq[7])+0.02697478829999747*kSq[5]+0.03336355394999686*kSq[4]+0.3111111111111111*epsilon[0]*rdx2Sq[1]-0.01924500897298752*kSq[1]+0.1888888888888889*epsilon[0]*rdx2Sq[0]-0.02222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[5], globalIdxs[1], 0.01721325931647741*kSq[6]-0.03975231959999626*kSq[5]-0.05678902799999467*kSq[4]+0.01333333333333333*kSq[3]-0.03849001794597505*kSq[2]-0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.4444444444444444*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[5], globalIdxs[2], 0.0234254740499978*kSq[5]+0.0234254740499978*kSq[4]-0.01333333333333333*kSq[3]+0.2555555555555555*epsilon[0]*rdx2Sq[1]+0.2555555555555555*epsilon[0]*rdx2Sq[0]-0.03333333333333333*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[5], globalIdxs[3], 0.0295084445425327*kSq[7]-0.03442651863295482*kSq[6]-0.063887656499994*kSq[5]-0.05962847939999439*kSq[4]+0.05333333333333333*kSq[3]-0.03849001794597505*kSq[2]-0.8888888888888888*epsilon[0]*rdx2Sq[1]+0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[5], globalIdxs[4], (-0.01721325931647741*kSq[7])-0.05678902799999467*kSq[5]-0.03975231959999626*kSq[4]+0.01333333333333333*kSq[3]-0.4444444444444444*epsilon[0]*rdx2Sq[1]+0.03849001794597505*kSq[1]-0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[5], globalIdxs[5], (0.2666666666666667*epsilon[0]*rdx2Sq[1]*bcVals[9])/bcVals[10]+0.04549218533640458*kSq[7]-0.04549218533640458*kSq[6]-0.0127775312999988*kSq[5]-0.0127775312999988*kSq[4]+0.04666666666666667*kSq[3]-0.03849001794597505*kSq[2]+0.5777777777777777*epsilon[0]*rdx2Sq[1]+0.03849001794597505*kSq[1]+0.5777777777777777*epsilon[0]*rdx2Sq[0]-0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[5], globalIdxs[6], (0.1333333333333333*epsilon[0]*rdx2Sq[1]*bcVals[9])/bcVals[10]+0.03442651863295482*kSq[7]-0.0295084445425327*kSq[6]-0.05962847939999439*kSq[5]-0.063887656499994*kSq[4]+0.05333333333333333*kSq[3]+0.06666666666666667*epsilon[0]*rdx2Sq[1]+0.03849001794597505*kSq[1]-0.8888888888888888*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[5], globalIdxs[7], (-(0.06666666666666667*epsilon[0]*rdx2Sq[1]*bcVals[9])/bcVals[10])+0.006147592613027645*kSq[6]+0.03336355394999686*kSq[5]+0.02697478829999747*kSq[4]+0.01924500897298752*kSq[2]+0.1888888888888889*epsilon[0]*rdx2Sq[1]+0.3111111111111111*epsilon[0]*rdx2Sq[0]-0.02222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[6], globalIdxs[0], (-0.01721325931647741*kSq[6])-0.03975231959999626*kSq[5]-0.05678902799999467*kSq[4]-0.01333333333333333*kSq[3]+0.03849001794597505*kSq[2]-0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.4444444444444444*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[6], globalIdxs[1], 0.07950463919999252*kSq[5]+0.1135780559999893*kSq[4]-0.5333333333333333*epsilon[0]*rdx2Sq[1]+0.8888888888888888*epsilon[0]*rdx2Sq[0]-0.1777777777777778*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[6], globalIdxs[2], (-0.01721325931647741*kSq[6])-0.03975231959999626*kSq[5]-0.05678902799999467*kSq[4]+0.01333333333333333*kSq[3]+0.03849001794597505*kSq[2]-0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.4444444444444444*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[6], globalIdxs[3], (-0.03442651863295482*kSq[7])+0.03442651863295482*kSq[6]+0.09938079899999068*kSq[5]+0.09938079899999068*kSq[4]+0.02666666666666666*kSq[3]-0.0769800358919501*kSq[2]+0.0769800358919501*kSq[1]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[6], globalIdxs[4], 0.03442651863295482*kSq[7]+0.03442651863295482*kSq[6]+0.09938079899999068*kSq[5]+0.09938079899999068*kSq[4]-0.02666666666666666*kSq[3]-0.0769800358919501*kSq[2]-0.0769800358919501*kSq[1]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[6], globalIdxs[5], (0.1333333333333333*epsilon[0]*rdx2Sq[1]*bcVals[9])/bcVals[10]+0.03442651863295482*kSq[7]-0.0295084445425327*kSq[6]-0.05962847939999439*kSq[5]-0.063887656499994*kSq[4]+0.05333333333333333*kSq[3]+0.06666666666666667*epsilon[0]*rdx2Sq[1]+0.03849001794597505*kSq[1]-0.8888888888888888*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[6], globalIdxs[6], (1.066666666666667*epsilon[0]*rdx2Sq[1]*bcVals[9])/bcVals[10]+0.1967229636168847*kSq[6]-0.07950463919999252*kSq[5]+0.2271561119999787*kSq[4]-0.3079201435678004*kSq[2]+0.5333333333333333*epsilon[0]*rdx2Sq[1]+1.777777777777778*epsilon[0]*rdx2Sq[0]-0.3555555555555556*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[6], globalIdxs[7], (0.1333333333333333*epsilon[0]*rdx2Sq[1]*bcVals[9])/bcVals[10]-0.03442651863295482*kSq[7]-0.0295084445425327*kSq[6]-0.05962847939999439*kSq[5]-0.063887656499994*kSq[4]-0.05333333333333333*kSq[3]+0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.03849001794597505*kSq[1]-0.8888888888888888*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[7], globalIdxs[0], 0.0234254740499978*kSq[5]+0.0234254740499978*kSq[4]+0.01333333333333333*kSq[3]+0.2555555555555555*epsilon[0]*rdx2Sq[1]+0.2555555555555555*epsilon[0]*rdx2Sq[0]-0.03333333333333333*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[7], globalIdxs[1], 0.01721325931647741*kSq[6]-0.03975231959999626*kSq[5]-0.05678902799999467*kSq[4]-0.01333333333333333*kSq[3]-0.03849001794597505*kSq[2]-0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.4444444444444444*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[7], globalIdxs[2], 0.006147592613027645*kSq[7]+0.02697478829999747*kSq[5]+0.03336355394999686*kSq[4]+0.3111111111111111*epsilon[0]*rdx2Sq[1]+0.01924500897298752*kSq[1]+0.1888888888888889*epsilon[0]*rdx2Sq[0]-0.02222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[7], globalIdxs[3], 0.01721325931647741*kSq[7]-0.05678902799999467*kSq[5]-0.03975231959999626*kSq[4]-0.01333333333333333*kSq[3]-0.4444444444444444*epsilon[0]*rdx2Sq[1]-0.03849001794597505*kSq[1]-0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[7], globalIdxs[4], (-0.0295084445425327*kSq[7])-0.03442651863295482*kSq[6]-0.063887656499994*kSq[5]-0.05962847939999439*kSq[4]-0.05333333333333333*kSq[3]-0.03849001794597505*kSq[2]-0.8888888888888888*epsilon[0]*rdx2Sq[1]+0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[7], globalIdxs[5], (-(0.06666666666666667*epsilon[0]*rdx2Sq[1]*bcVals[9])/bcVals[10])+0.006147592613027645*kSq[6]+0.03336355394999686*kSq[5]+0.02697478829999747*kSq[4]+0.01924500897298752*kSq[2]+0.1888888888888889*epsilon[0]*rdx2Sq[1]+0.3111111111111111*epsilon[0]*rdx2Sq[0]-0.02222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[7], globalIdxs[6], (0.1333333333333333*epsilon[0]*rdx2Sq[1]*bcVals[9])/bcVals[10]-0.03442651863295482*kSq[7]-0.0295084445425327*kSq[6]-0.05962847939999439*kSq[5]-0.063887656499994*kSq[4]-0.05333333333333333*kSq[3]+0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.03849001794597505*kSq[1]-0.8888888888888888*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[7], globalIdxs[7], (0.2666666666666667*epsilon[0]*rdx2Sq[1]*bcVals[9])/bcVals[10]-0.04549218533640458*kSq[7]-0.04549218533640458*kSq[6]-0.0127775312999988*kSq[5]-0.0127775312999988*kSq[4]-0.04666666666666667*kSq[3]-0.03849001794597505*kSq[2]+0.5777777777777777*epsilon[0]*rdx2Sq[1]-0.03849001794597505*kSq[1]+0.5777777777777777*epsilon[0]*rdx2Sq[0]-0.06666666666666667*kSq[0]);

}
void fem_poisson_lhs_stencil_consteps_2x_ser_p1_upx_dirichletx_upy_periodicy(const double *epsilon, const double *kSq, const double *dx, const double *bcVals, const long *globalIdxs, gkyl_mat_triples *tri) 
{ 
  // epsilon: permittivity.
  // kSq: wave number squared (factor multiplying phi).
  // dx: cell length in each direction.
  // bcVals[3]: values to impose as BCs, i.e. bcVals[0]*phi+bcVals[1]*d(phi)/dx=bcVals[2].
  // globalIdxs: global linear index of each basis function/node in current cell.
  // tri: triples object (i,j,val), i.e. contribute val to i,j element of the global matrix.

  double rdx2Sq[2];
  rdx2Sq[0] = 4.0/(dx[0]*dx[0]);
  rdx2Sq[1] = 4.0/(dx[1]*dx[1]);

  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[0], (-0.1666666666666667*kSq[3])+0.1924500897298752*kSq[2]+0.3333333333333333*epsilon[0]*rdx2Sq[1]+0.1924500897298752*kSq[1]+0.3333333333333333*epsilon[0]*rdx2Sq[0]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[1], 0.09622504486493762*kSq[2]+0.1666666666666667*epsilon[0]*rdx2Sq[1]-0.3333333333333333*epsilon[0]*rdx2Sq[0]-0.1111111111111111*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[2], (-0.3333333333333333*epsilon[0]*rdx2Sq[1])+0.09622504486493762*kSq[1]+0.1666666666666667*epsilon[0]*rdx2Sq[0]-0.1111111111111111*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[3], (-0.1666666666666667*epsilon[0]*rdx2Sq[1])-0.1666666666666667*epsilon[0]*rdx2Sq[0]-0.05555555555555555*kSq[0]);
  gkyl_mat_triples_insert(tri, globalIdxs[1], globalIdxs[0], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[1], globalIdxs[1], 1.0);
  gkyl_mat_triples_insert(tri, globalIdxs[1], globalIdxs[2], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[1], globalIdxs[3], 0.0);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[0], (-0.3333333333333333*epsilon[0]*rdx2Sq[1])+0.09622504486493762*kSq[1]+0.1666666666666667*epsilon[0]*rdx2Sq[0]-0.1111111111111111*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[1], (-0.1666666666666667*epsilon[0]*rdx2Sq[1])-0.1666666666666667*epsilon[0]*rdx2Sq[0]-0.05555555555555555*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[2], 0.1666666666666667*kSq[3]-0.1924500897298752*kSq[2]+0.3333333333333333*epsilon[0]*rdx2Sq[1]+0.1924500897298752*kSq[1]+0.3333333333333333*epsilon[0]*rdx2Sq[0]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[3], (-0.09622504486493762*kSq[2])+0.1666666666666667*epsilon[0]*rdx2Sq[1]-0.3333333333333333*epsilon[0]*rdx2Sq[0]-0.1111111111111111*kSq[0]);
  gkyl_mat_triples_insert(tri, globalIdxs[3], globalIdxs[0], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[3], globalIdxs[1], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[3], globalIdxs[2], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[3], globalIdxs[3], 1.0);

}
void fem_poisson_lhs_stencil_consteps_2x_ser_p2_upx_dirichletx_upy_periodicy(const double *epsilon, const double *kSq, const double *dx, const double *bcVals, const long *globalIdxs, gkyl_mat_triples *tri) 
{ 
  // epsilon: permittivity.
  // kSq: wave number squared (factor multiplying phi).
  // dx: cell length in each direction.
  // bcVals[3]: values to impose as BCs, i.e. bcVals[0]*phi+bcVals[1]*d(phi)/dx=bcVals[2].
  // globalIdxs: global linear index of each basis function/node in current cell.
  // tri: triples object (i,j,val), i.e. contribute val to i,j element of the global matrix.

  double rdx2Sq[2];
  rdx2Sq[0] = 4.0/(dx[0]*dx[0]);
  rdx2Sq[1] = 4.0/(dx[1]*dx[1]);

  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[0], 0.04549218533640458*kSq[7]+0.04549218533640458*kSq[6]-0.0127775312999988*kSq[5]-0.0127775312999988*kSq[4]-0.04666666666666667*kSq[3]+0.03849001794597505*kSq[2]+0.5777777777777777*epsilon[0]*rdx2Sq[1]+0.03849001794597505*kSq[1]+0.5777777777777777*epsilon[0]*rdx2Sq[0]-0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[1], 0.03442651863295482*kSq[7]+0.0295084445425327*kSq[6]-0.05962847939999439*kSq[5]-0.063887656499994*kSq[4]-0.05333333333333333*kSq[3]+0.06666666666666667*epsilon[0]*rdx2Sq[1]+0.03849001794597505*kSq[1]-0.8888888888888888*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[2], (-0.006147592613027645*kSq[6])+0.03336355394999686*kSq[5]+0.02697478829999747*kSq[4]-0.01924500897298752*kSq[2]+0.1888888888888889*epsilon[0]*rdx2Sq[1]+0.3111111111111111*epsilon[0]*rdx2Sq[0]-0.02222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[3], 0.0295084445425327*kSq[7]+0.03442651863295482*kSq[6]-0.063887656499994*kSq[5]-0.05962847939999439*kSq[4]-0.05333333333333333*kSq[3]+0.03849001794597505*kSq[2]-0.8888888888888888*epsilon[0]*rdx2Sq[1]+0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[4], (-0.01721325931647741*kSq[7])-0.05678902799999467*kSq[5]-0.03975231959999626*kSq[4]-0.01333333333333333*kSq[3]-0.4444444444444444*epsilon[0]*rdx2Sq[1]+0.03849001794597505*kSq[1]-0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[5], (-0.006147592613027645*kSq[7])+0.02697478829999747*kSq[5]+0.03336355394999686*kSq[4]+0.3111111111111111*epsilon[0]*rdx2Sq[1]-0.01924500897298752*kSq[1]+0.1888888888888889*epsilon[0]*rdx2Sq[0]-0.02222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[6], (-0.01721325931647741*kSq[6])-0.03975231959999626*kSq[5]-0.05678902799999467*kSq[4]-0.01333333333333333*kSq[3]+0.03849001794597505*kSq[2]-0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.4444444444444444*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[7], 0.0234254740499978*kSq[5]+0.0234254740499978*kSq[4]+0.01333333333333333*kSq[3]+0.2555555555555555*epsilon[0]*rdx2Sq[1]+0.2555555555555555*epsilon[0]*rdx2Sq[0]-0.03333333333333333*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[0], 0.03442651863295482*kSq[7]+0.0295084445425327*kSq[6]-0.05962847939999439*kSq[5]-0.063887656499994*kSq[4]-0.05333333333333333*kSq[3]+0.06666666666666667*epsilon[0]*rdx2Sq[1]+0.03849001794597505*kSq[1]-0.8888888888888888*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[1], (-0.1967229636168847*kSq[6])-0.07950463919999252*kSq[5]+0.2271561119999787*kSq[4]+0.3079201435678004*kSq[2]+0.5333333333333333*epsilon[0]*rdx2Sq[1]+1.777777777777778*epsilon[0]*rdx2Sq[0]-0.3555555555555556*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[2], (-0.03442651863295482*kSq[7])+0.0295084445425327*kSq[6]-0.05962847939999439*kSq[5]-0.063887656499994*kSq[4]+0.05333333333333333*kSq[3]+0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.03849001794597505*kSq[1]-0.8888888888888888*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[3], (-0.03442651863295482*kSq[7])-0.03442651863295482*kSq[6]+0.09938079899999068*kSq[5]+0.09938079899999068*kSq[4]-0.02666666666666666*kSq[3]+0.0769800358919501*kSq[2]+0.0769800358919501*kSq[1]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[4], 0.03442651863295482*kSq[7]-0.03442651863295482*kSq[6]+0.09938079899999068*kSq[5]+0.09938079899999068*kSq[4]+0.02666666666666666*kSq[3]+0.0769800358919501*kSq[2]-0.0769800358919501*kSq[1]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[5], 0.01721325931647741*kSq[6]-0.03975231959999626*kSq[5]-0.05678902799999467*kSq[4]+0.01333333333333333*kSq[3]-0.03849001794597505*kSq[2]-0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.4444444444444444*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[6], 0.07950463919999252*kSq[5]+0.1135780559999893*kSq[4]-0.5333333333333333*epsilon[0]*rdx2Sq[1]+0.8888888888888888*epsilon[0]*rdx2Sq[0]-0.1777777777777778*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[7], 0.01721325931647741*kSq[6]-0.03975231959999626*kSq[5]-0.05678902799999467*kSq[4]-0.01333333333333333*kSq[3]-0.03849001794597505*kSq[2]-0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.4444444444444444*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_insert(tri, globalIdxs[2], globalIdxs[0], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[2], globalIdxs[1], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[2], globalIdxs[2], 1.0);
  gkyl_mat_triples_insert(tri, globalIdxs[2], globalIdxs[3], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[2], globalIdxs[4], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[2], globalIdxs[5], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[2], globalIdxs[6], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[2], globalIdxs[7], 0.0);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[0], 0.0295084445425327*kSq[7]+0.03442651863295482*kSq[6]-0.063887656499994*kSq[5]-0.05962847939999439*kSq[4]-0.05333333333333333*kSq[3]+0.03849001794597505*kSq[2]-0.8888888888888888*epsilon[0]*rdx2Sq[1]+0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[1], (-0.03442651863295482*kSq[7])-0.03442651863295482*kSq[6]+0.09938079899999068*kSq[5]+0.09938079899999068*kSq[4]-0.02666666666666666*kSq[3]+0.0769800358919501*kSq[2]+0.0769800358919501*kSq[1]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[2], 0.01721325931647741*kSq[7]-0.05678902799999467*kSq[5]-0.03975231959999626*kSq[4]+0.01333333333333333*kSq[3]-0.4444444444444444*epsilon[0]*rdx2Sq[1]-0.03849001794597505*kSq[1]-0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[3], (-0.1967229636168847*kSq[7])+0.2271561119999787*kSq[5]-0.07950463919999252*kSq[4]+1.777777777777778*epsilon[0]*rdx2Sq[1]+0.3079201435678004*kSq[1]+0.5333333333333333*epsilon[0]*rdx2Sq[0]-0.3555555555555556*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[4], 0.1135780559999893*kSq[5]+0.07950463919999252*kSq[4]+0.8888888888888888*epsilon[0]*rdx2Sq[1]-0.5333333333333333*epsilon[0]*rdx2Sq[0]-0.1777777777777778*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[5], 0.0295084445425327*kSq[7]-0.03442651863295482*kSq[6]-0.063887656499994*kSq[5]-0.05962847939999439*kSq[4]+0.05333333333333333*kSq[3]-0.03849001794597505*kSq[2]-0.8888888888888888*epsilon[0]*rdx2Sq[1]+0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[6], (-0.03442651863295482*kSq[7])+0.03442651863295482*kSq[6]+0.09938079899999068*kSq[5]+0.09938079899999068*kSq[4]+0.02666666666666666*kSq[3]-0.0769800358919501*kSq[2]+0.0769800358919501*kSq[1]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[7], 0.01721325931647741*kSq[7]-0.05678902799999467*kSq[5]-0.03975231959999626*kSq[4]-0.01333333333333333*kSq[3]-0.4444444444444444*epsilon[0]*rdx2Sq[1]-0.03849001794597505*kSq[1]-0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_insert(tri, globalIdxs[4], globalIdxs[0], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[4], globalIdxs[1], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[4], globalIdxs[2], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[4], globalIdxs[3], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[4], globalIdxs[4], 1.0);
  gkyl_mat_triples_insert(tri, globalIdxs[4], globalIdxs[5], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[4], globalIdxs[6], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[4], globalIdxs[7], 0.0);
  gkyl_mat_triples_accum(tri, globalIdxs[5], globalIdxs[0], (-0.006147592613027645*kSq[7])+0.02697478829999747*kSq[5]+0.03336355394999686*kSq[4]+0.3111111111111111*epsilon[0]*rdx2Sq[1]-0.01924500897298752*kSq[1]+0.1888888888888889*epsilon[0]*rdx2Sq[0]-0.02222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[5], globalIdxs[1], 0.01721325931647741*kSq[6]-0.03975231959999626*kSq[5]-0.05678902799999467*kSq[4]+0.01333333333333333*kSq[3]-0.03849001794597505*kSq[2]-0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.4444444444444444*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[5], globalIdxs[2], 0.0234254740499978*kSq[5]+0.0234254740499978*kSq[4]-0.01333333333333333*kSq[3]+0.2555555555555555*epsilon[0]*rdx2Sq[1]+0.2555555555555555*epsilon[0]*rdx2Sq[0]-0.03333333333333333*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[5], globalIdxs[3], 0.0295084445425327*kSq[7]-0.03442651863295482*kSq[6]-0.063887656499994*kSq[5]-0.05962847939999439*kSq[4]+0.05333333333333333*kSq[3]-0.03849001794597505*kSq[2]-0.8888888888888888*epsilon[0]*rdx2Sq[1]+0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[5], globalIdxs[4], (-0.01721325931647741*kSq[7])-0.05678902799999467*kSq[5]-0.03975231959999626*kSq[4]+0.01333333333333333*kSq[3]-0.4444444444444444*epsilon[0]*rdx2Sq[1]+0.03849001794597505*kSq[1]-0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[5], globalIdxs[5], 0.04549218533640458*kSq[7]-0.04549218533640458*kSq[6]-0.0127775312999988*kSq[5]-0.0127775312999988*kSq[4]+0.04666666666666667*kSq[3]-0.03849001794597505*kSq[2]+0.5777777777777777*epsilon[0]*rdx2Sq[1]+0.03849001794597505*kSq[1]+0.5777777777777777*epsilon[0]*rdx2Sq[0]-0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[5], globalIdxs[6], 0.03442651863295482*kSq[7]-0.0295084445425327*kSq[6]-0.05962847939999439*kSq[5]-0.063887656499994*kSq[4]+0.05333333333333333*kSq[3]+0.06666666666666667*epsilon[0]*rdx2Sq[1]+0.03849001794597505*kSq[1]-0.8888888888888888*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[5], globalIdxs[7], 0.006147592613027645*kSq[6]+0.03336355394999686*kSq[5]+0.02697478829999747*kSq[4]+0.01924500897298752*kSq[2]+0.1888888888888889*epsilon[0]*rdx2Sq[1]+0.3111111111111111*epsilon[0]*rdx2Sq[0]-0.02222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[6], globalIdxs[0], (-0.01721325931647741*kSq[6])-0.03975231959999626*kSq[5]-0.05678902799999467*kSq[4]-0.01333333333333333*kSq[3]+0.03849001794597505*kSq[2]-0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.4444444444444444*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[6], globalIdxs[1], 0.07950463919999252*kSq[5]+0.1135780559999893*kSq[4]-0.5333333333333333*epsilon[0]*rdx2Sq[1]+0.8888888888888888*epsilon[0]*rdx2Sq[0]-0.1777777777777778*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[6], globalIdxs[2], (-0.01721325931647741*kSq[6])-0.03975231959999626*kSq[5]-0.05678902799999467*kSq[4]+0.01333333333333333*kSq[3]+0.03849001794597505*kSq[2]-0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.4444444444444444*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[6], globalIdxs[3], (-0.03442651863295482*kSq[7])+0.03442651863295482*kSq[6]+0.09938079899999068*kSq[5]+0.09938079899999068*kSq[4]+0.02666666666666666*kSq[3]-0.0769800358919501*kSq[2]+0.0769800358919501*kSq[1]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[6], globalIdxs[4], 0.03442651863295482*kSq[7]+0.03442651863295482*kSq[6]+0.09938079899999068*kSq[5]+0.09938079899999068*kSq[4]-0.02666666666666666*kSq[3]-0.0769800358919501*kSq[2]-0.0769800358919501*kSq[1]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[6], globalIdxs[5], 0.03442651863295482*kSq[7]-0.0295084445425327*kSq[6]-0.05962847939999439*kSq[5]-0.063887656499994*kSq[4]+0.05333333333333333*kSq[3]+0.06666666666666667*epsilon[0]*rdx2Sq[1]+0.03849001794597505*kSq[1]-0.8888888888888888*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[6], globalIdxs[6], 0.1967229636168847*kSq[6]-0.07950463919999252*kSq[5]+0.2271561119999787*kSq[4]-0.3079201435678004*kSq[2]+0.5333333333333333*epsilon[0]*rdx2Sq[1]+1.777777777777778*epsilon[0]*rdx2Sq[0]-0.3555555555555556*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[6], globalIdxs[7], (-0.03442651863295482*kSq[7])-0.0295084445425327*kSq[6]-0.05962847939999439*kSq[5]-0.063887656499994*kSq[4]-0.05333333333333333*kSq[3]+0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.03849001794597505*kSq[1]-0.8888888888888888*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_insert(tri, globalIdxs[7], globalIdxs[0], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[7], globalIdxs[1], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[7], globalIdxs[2], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[7], globalIdxs[3], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[7], globalIdxs[4], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[7], globalIdxs[5], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[7], globalIdxs[6], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[7], globalIdxs[7], 1.0);

}
void fem_poisson_lhs_stencil_consteps_2x_ser_p1_upx_dirichletx_upy_dirichlety(const double *epsilon, const double *kSq, const double *dx, const double *bcVals, const long *globalIdxs, gkyl_mat_triples *tri) 
{ 
  // epsilon: permittivity.
  // kSq: wave number squared (factor multiplying phi).
  // dx: cell length in each direction.
  // bcVals[3]: values to impose as BCs, i.e. bcVals[0]*phi+bcVals[1]*d(phi)/dx=bcVals[2].
  // globalIdxs: global linear index of each basis function/node in current cell.
  // tri: triples object (i,j,val), i.e. contribute val to i,j element of the global matrix.

  double rdx2Sq[2];
  rdx2Sq[0] = 4.0/(dx[0]*dx[0]);
  rdx2Sq[1] = 4.0/(dx[1]*dx[1]);

  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[0], (-0.1666666666666667*kSq[3])+0.1924500897298752*kSq[2]+0.3333333333333333*epsilon[0]*rdx2Sq[1]+0.1924500897298752*kSq[1]+0.3333333333333333*epsilon[0]*rdx2Sq[0]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[1], 0.09622504486493762*kSq[2]+0.1666666666666667*epsilon[0]*rdx2Sq[1]-0.3333333333333333*epsilon[0]*rdx2Sq[0]-0.1111111111111111*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[2], (-0.3333333333333333*epsilon[0]*rdx2Sq[1])+0.09622504486493762*kSq[1]+0.1666666666666667*epsilon[0]*rdx2Sq[0]-0.1111111111111111*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[3], (-0.1666666666666667*epsilon[0]*rdx2Sq[1])-0.1666666666666667*epsilon[0]*rdx2Sq[0]-0.05555555555555555*kSq[0]);
  gkyl_mat_triples_insert(tri, globalIdxs[1], globalIdxs[0], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[1], globalIdxs[1], 1.0);
  gkyl_mat_triples_insert(tri, globalIdxs[1], globalIdxs[2], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[1], globalIdxs[3], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[2], globalIdxs[0], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[2], globalIdxs[1], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[2], globalIdxs[2], 1.0);
  gkyl_mat_triples_insert(tri, globalIdxs[2], globalIdxs[3], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[3], globalIdxs[0], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[3], globalIdxs[1], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[3], globalIdxs[2], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[3], globalIdxs[3], 1.0);

}
void fem_poisson_lhs_stencil_consteps_2x_ser_p2_upx_dirichletx_upy_dirichlety(const double *epsilon, const double *kSq, const double *dx, const double *bcVals, const long *globalIdxs, gkyl_mat_triples *tri) 
{ 
  // epsilon: permittivity.
  // kSq: wave number squared (factor multiplying phi).
  // dx: cell length in each direction.
  // bcVals[3]: values to impose as BCs, i.e. bcVals[0]*phi+bcVals[1]*d(phi)/dx=bcVals[2].
  // globalIdxs: global linear index of each basis function/node in current cell.
  // tri: triples object (i,j,val), i.e. contribute val to i,j element of the global matrix.

  double rdx2Sq[2];
  rdx2Sq[0] = 4.0/(dx[0]*dx[0]);
  rdx2Sq[1] = 4.0/(dx[1]*dx[1]);

  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[0], 0.04549218533640458*kSq[7]+0.04549218533640458*kSq[6]-0.0127775312999988*kSq[5]-0.0127775312999988*kSq[4]-0.04666666666666667*kSq[3]+0.03849001794597505*kSq[2]+0.5777777777777777*epsilon[0]*rdx2Sq[1]+0.03849001794597505*kSq[1]+0.5777777777777777*epsilon[0]*rdx2Sq[0]-0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[1], 0.03442651863295482*kSq[7]+0.0295084445425327*kSq[6]-0.05962847939999439*kSq[5]-0.063887656499994*kSq[4]-0.05333333333333333*kSq[3]+0.06666666666666667*epsilon[0]*rdx2Sq[1]+0.03849001794597505*kSq[1]-0.8888888888888888*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[2], (-0.006147592613027645*kSq[6])+0.03336355394999686*kSq[5]+0.02697478829999747*kSq[4]-0.01924500897298752*kSq[2]+0.1888888888888889*epsilon[0]*rdx2Sq[1]+0.3111111111111111*epsilon[0]*rdx2Sq[0]-0.02222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[3], 0.0295084445425327*kSq[7]+0.03442651863295482*kSq[6]-0.063887656499994*kSq[5]-0.05962847939999439*kSq[4]-0.05333333333333333*kSq[3]+0.03849001794597505*kSq[2]-0.8888888888888888*epsilon[0]*rdx2Sq[1]+0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[4], (-0.01721325931647741*kSq[7])-0.05678902799999467*kSq[5]-0.03975231959999626*kSq[4]-0.01333333333333333*kSq[3]-0.4444444444444444*epsilon[0]*rdx2Sq[1]+0.03849001794597505*kSq[1]-0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[5], (-0.006147592613027645*kSq[7])+0.02697478829999747*kSq[5]+0.03336355394999686*kSq[4]+0.3111111111111111*epsilon[0]*rdx2Sq[1]-0.01924500897298752*kSq[1]+0.1888888888888889*epsilon[0]*rdx2Sq[0]-0.02222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[6], (-0.01721325931647741*kSq[6])-0.03975231959999626*kSq[5]-0.05678902799999467*kSq[4]-0.01333333333333333*kSq[3]+0.03849001794597505*kSq[2]-0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.4444444444444444*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[7], 0.0234254740499978*kSq[5]+0.0234254740499978*kSq[4]+0.01333333333333333*kSq[3]+0.2555555555555555*epsilon[0]*rdx2Sq[1]+0.2555555555555555*epsilon[0]*rdx2Sq[0]-0.03333333333333333*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[0], 0.03442651863295482*kSq[7]+0.0295084445425327*kSq[6]-0.05962847939999439*kSq[5]-0.063887656499994*kSq[4]-0.05333333333333333*kSq[3]+0.06666666666666667*epsilon[0]*rdx2Sq[1]+0.03849001794597505*kSq[1]-0.8888888888888888*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[1], (-0.1967229636168847*kSq[6])-0.07950463919999252*kSq[5]+0.2271561119999787*kSq[4]+0.3079201435678004*kSq[2]+0.5333333333333333*epsilon[0]*rdx2Sq[1]+1.777777777777778*epsilon[0]*rdx2Sq[0]-0.3555555555555556*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[2], (-0.03442651863295482*kSq[7])+0.0295084445425327*kSq[6]-0.05962847939999439*kSq[5]-0.063887656499994*kSq[4]+0.05333333333333333*kSq[3]+0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.03849001794597505*kSq[1]-0.8888888888888888*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[3], (-0.03442651863295482*kSq[7])-0.03442651863295482*kSq[6]+0.09938079899999068*kSq[5]+0.09938079899999068*kSq[4]-0.02666666666666666*kSq[3]+0.0769800358919501*kSq[2]+0.0769800358919501*kSq[1]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[4], 0.03442651863295482*kSq[7]-0.03442651863295482*kSq[6]+0.09938079899999068*kSq[5]+0.09938079899999068*kSq[4]+0.02666666666666666*kSq[3]+0.0769800358919501*kSq[2]-0.0769800358919501*kSq[1]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[5], 0.01721325931647741*kSq[6]-0.03975231959999626*kSq[5]-0.05678902799999467*kSq[4]+0.01333333333333333*kSq[3]-0.03849001794597505*kSq[2]-0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.4444444444444444*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[6], 0.07950463919999252*kSq[5]+0.1135780559999893*kSq[4]-0.5333333333333333*epsilon[0]*rdx2Sq[1]+0.8888888888888888*epsilon[0]*rdx2Sq[0]-0.1777777777777778*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[7], 0.01721325931647741*kSq[6]-0.03975231959999626*kSq[5]-0.05678902799999467*kSq[4]-0.01333333333333333*kSq[3]-0.03849001794597505*kSq[2]-0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.4444444444444444*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_insert(tri, globalIdxs[2], globalIdxs[0], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[2], globalIdxs[1], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[2], globalIdxs[2], 1.0);
  gkyl_mat_triples_insert(tri, globalIdxs[2], globalIdxs[3], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[2], globalIdxs[4], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[2], globalIdxs[5], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[2], globalIdxs[6], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[2], globalIdxs[7], 0.0);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[0], 0.0295084445425327*kSq[7]+0.03442651863295482*kSq[6]-0.063887656499994*kSq[5]-0.05962847939999439*kSq[4]-0.05333333333333333*kSq[3]+0.03849001794597505*kSq[2]-0.8888888888888888*epsilon[0]*rdx2Sq[1]+0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[1], (-0.03442651863295482*kSq[7])-0.03442651863295482*kSq[6]+0.09938079899999068*kSq[5]+0.09938079899999068*kSq[4]-0.02666666666666666*kSq[3]+0.0769800358919501*kSq[2]+0.0769800358919501*kSq[1]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[2], 0.01721325931647741*kSq[7]-0.05678902799999467*kSq[5]-0.03975231959999626*kSq[4]+0.01333333333333333*kSq[3]-0.4444444444444444*epsilon[0]*rdx2Sq[1]-0.03849001794597505*kSq[1]-0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[3], (-0.1967229636168847*kSq[7])+0.2271561119999787*kSq[5]-0.07950463919999252*kSq[4]+1.777777777777778*epsilon[0]*rdx2Sq[1]+0.3079201435678004*kSq[1]+0.5333333333333333*epsilon[0]*rdx2Sq[0]-0.3555555555555556*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[4], 0.1135780559999893*kSq[5]+0.07950463919999252*kSq[4]+0.8888888888888888*epsilon[0]*rdx2Sq[1]-0.5333333333333333*epsilon[0]*rdx2Sq[0]-0.1777777777777778*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[5], 0.0295084445425327*kSq[7]-0.03442651863295482*kSq[6]-0.063887656499994*kSq[5]-0.05962847939999439*kSq[4]+0.05333333333333333*kSq[3]-0.03849001794597505*kSq[2]-0.8888888888888888*epsilon[0]*rdx2Sq[1]+0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[6], (-0.03442651863295482*kSq[7])+0.03442651863295482*kSq[6]+0.09938079899999068*kSq[5]+0.09938079899999068*kSq[4]+0.02666666666666666*kSq[3]-0.0769800358919501*kSq[2]+0.0769800358919501*kSq[1]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[7], 0.01721325931647741*kSq[7]-0.05678902799999467*kSq[5]-0.03975231959999626*kSq[4]-0.01333333333333333*kSq[3]-0.4444444444444444*epsilon[0]*rdx2Sq[1]-0.03849001794597505*kSq[1]-0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_insert(tri, globalIdxs[4], globalIdxs[0], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[4], globalIdxs[1], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[4], globalIdxs[2], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[4], globalIdxs[3], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[4], globalIdxs[4], 1.0);
  gkyl_mat_triples_insert(tri, globalIdxs[4], globalIdxs[5], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[4], globalIdxs[6], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[4], globalIdxs[7], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[5], globalIdxs[0], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[5], globalIdxs[1], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[5], globalIdxs[2], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[5], globalIdxs[3], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[5], globalIdxs[4], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[5], globalIdxs[5], 1.0);
  gkyl_mat_triples_insert(tri, globalIdxs[5], globalIdxs[6], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[5], globalIdxs[7], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[6], globalIdxs[0], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[6], globalIdxs[1], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[6], globalIdxs[2], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[6], globalIdxs[3], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[6], globalIdxs[4], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[6], globalIdxs[5], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[6], globalIdxs[6], 1.0);
  gkyl_mat_triples_insert(tri, globalIdxs[6], globalIdxs[7], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[7], globalIdxs[0], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[7], globalIdxs[1], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[7], globalIdxs[2], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[7], globalIdxs[3], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[7], globalIdxs[4], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[7], globalIdxs[5], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[7], globalIdxs[6], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[7], globalIdxs[7], 1.0);

}
void fem_poisson_lhs_stencil_consteps_2x_ser_p1_upx_dirichletx_upy_neumanny(const double *epsilon, const double *kSq, const double *dx, const double *bcVals, const long *globalIdxs, gkyl_mat_triples *tri) 
{ 
  // epsilon: permittivity.
  // kSq: wave number squared (factor multiplying phi).
  // dx: cell length in each direction.
  // bcVals[3]: values to impose as BCs, i.e. bcVals[0]*phi+bcVals[1]*d(phi)/dx=bcVals[2].
  // globalIdxs: global linear index of each basis function/node in current cell.
  // tri: triples object (i,j,val), i.e. contribute val to i,j element of the global matrix.

  double rdx2Sq[2];
  rdx2Sq[0] = 4.0/(dx[0]*dx[0]);
  rdx2Sq[1] = 4.0/(dx[1]*dx[1]);

  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[0], (-0.1666666666666667*kSq[3])+0.1924500897298752*kSq[2]+0.3333333333333333*epsilon[0]*rdx2Sq[1]+0.1924500897298752*kSq[1]+0.3333333333333333*epsilon[0]*rdx2Sq[0]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[1], 0.09622504486493762*kSq[2]+0.1666666666666667*epsilon[0]*rdx2Sq[1]-0.3333333333333333*epsilon[0]*rdx2Sq[0]-0.1111111111111111*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[2], (-0.3333333333333333*epsilon[0]*rdx2Sq[1])+0.09622504486493762*kSq[1]+0.1666666666666667*epsilon[0]*rdx2Sq[0]-0.1111111111111111*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[3], (-0.1666666666666667*epsilon[0]*rdx2Sq[1])-0.1666666666666667*epsilon[0]*rdx2Sq[0]-0.05555555555555555*kSq[0]);
  gkyl_mat_triples_insert(tri, globalIdxs[1], globalIdxs[0], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[1], globalIdxs[1], 1.0);
  gkyl_mat_triples_insert(tri, globalIdxs[1], globalIdxs[2], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[1], globalIdxs[3], 0.0);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[0], (-0.3333333333333333*epsilon[0]*rdx2Sq[1])+0.09622504486493762*kSq[1]+0.1666666666666667*epsilon[0]*rdx2Sq[0]-0.1111111111111111*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[1], (-0.1666666666666667*epsilon[0]*rdx2Sq[1])-0.1666666666666667*epsilon[0]*rdx2Sq[0]-0.05555555555555555*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[2], 0.1666666666666667*kSq[3]-0.1924500897298752*kSq[2]+0.3333333333333333*epsilon[0]*rdx2Sq[1]+0.1924500897298752*kSq[1]+0.3333333333333333*epsilon[0]*rdx2Sq[0]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[3], (-0.09622504486493762*kSq[2])+0.1666666666666667*epsilon[0]*rdx2Sq[1]-0.3333333333333333*epsilon[0]*rdx2Sq[0]-0.1111111111111111*kSq[0]);
  gkyl_mat_triples_insert(tri, globalIdxs[3], globalIdxs[0], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[3], globalIdxs[1], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[3], globalIdxs[2], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[3], globalIdxs[3], 1.0);

}
void fem_poisson_lhs_stencil_consteps_2x_ser_p2_upx_dirichletx_upy_neumanny(const double *epsilon, const double *kSq, const double *dx, const double *bcVals, const long *globalIdxs, gkyl_mat_triples *tri) 
{ 
  // epsilon: permittivity.
  // kSq: wave number squared (factor multiplying phi).
  // dx: cell length in each direction.
  // bcVals[3]: values to impose as BCs, i.e. bcVals[0]*phi+bcVals[1]*d(phi)/dx=bcVals[2].
  // globalIdxs: global linear index of each basis function/node in current cell.
  // tri: triples object (i,j,val), i.e. contribute val to i,j element of the global matrix.

  double rdx2Sq[2];
  rdx2Sq[0] = 4.0/(dx[0]*dx[0]);
  rdx2Sq[1] = 4.0/(dx[1]*dx[1]);

  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[0], 0.04549218533640458*kSq[7]+0.04549218533640458*kSq[6]-0.0127775312999988*kSq[5]-0.0127775312999988*kSq[4]-0.04666666666666667*kSq[3]+0.03849001794597505*kSq[2]+0.5777777777777777*epsilon[0]*rdx2Sq[1]+0.03849001794597505*kSq[1]+0.5777777777777777*epsilon[0]*rdx2Sq[0]-0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[1], 0.03442651863295482*kSq[7]+0.0295084445425327*kSq[6]-0.05962847939999439*kSq[5]-0.063887656499994*kSq[4]-0.05333333333333333*kSq[3]+0.06666666666666667*epsilon[0]*rdx2Sq[1]+0.03849001794597505*kSq[1]-0.8888888888888888*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[2], (-0.006147592613027645*kSq[6])+0.03336355394999686*kSq[5]+0.02697478829999747*kSq[4]-0.01924500897298752*kSq[2]+0.1888888888888889*epsilon[0]*rdx2Sq[1]+0.3111111111111111*epsilon[0]*rdx2Sq[0]-0.02222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[3], 0.0295084445425327*kSq[7]+0.03442651863295482*kSq[6]-0.063887656499994*kSq[5]-0.05962847939999439*kSq[4]-0.05333333333333333*kSq[3]+0.03849001794597505*kSq[2]-0.8888888888888888*epsilon[0]*rdx2Sq[1]+0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[4], (-0.01721325931647741*kSq[7])-0.05678902799999467*kSq[5]-0.03975231959999626*kSq[4]-0.01333333333333333*kSq[3]-0.4444444444444444*epsilon[0]*rdx2Sq[1]+0.03849001794597505*kSq[1]-0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[5], (-0.006147592613027645*kSq[7])+0.02697478829999747*kSq[5]+0.03336355394999686*kSq[4]+0.3111111111111111*epsilon[0]*rdx2Sq[1]-0.01924500897298752*kSq[1]+0.1888888888888889*epsilon[0]*rdx2Sq[0]-0.02222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[6], (-0.01721325931647741*kSq[6])-0.03975231959999626*kSq[5]-0.05678902799999467*kSq[4]-0.01333333333333333*kSq[3]+0.03849001794597505*kSq[2]-0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.4444444444444444*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[7], 0.0234254740499978*kSq[5]+0.0234254740499978*kSq[4]+0.01333333333333333*kSq[3]+0.2555555555555555*epsilon[0]*rdx2Sq[1]+0.2555555555555555*epsilon[0]*rdx2Sq[0]-0.03333333333333333*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[0], 0.03442651863295482*kSq[7]+0.0295084445425327*kSq[6]-0.05962847939999439*kSq[5]-0.063887656499994*kSq[4]-0.05333333333333333*kSq[3]+0.06666666666666667*epsilon[0]*rdx2Sq[1]+0.03849001794597505*kSq[1]-0.8888888888888888*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[1], (-0.1967229636168847*kSq[6])-0.07950463919999252*kSq[5]+0.2271561119999787*kSq[4]+0.3079201435678004*kSq[2]+0.5333333333333333*epsilon[0]*rdx2Sq[1]+1.777777777777778*epsilon[0]*rdx2Sq[0]-0.3555555555555556*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[2], (-0.03442651863295482*kSq[7])+0.0295084445425327*kSq[6]-0.05962847939999439*kSq[5]-0.063887656499994*kSq[4]+0.05333333333333333*kSq[3]+0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.03849001794597505*kSq[1]-0.8888888888888888*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[3], (-0.03442651863295482*kSq[7])-0.03442651863295482*kSq[6]+0.09938079899999068*kSq[5]+0.09938079899999068*kSq[4]-0.02666666666666666*kSq[3]+0.0769800358919501*kSq[2]+0.0769800358919501*kSq[1]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[4], 0.03442651863295482*kSq[7]-0.03442651863295482*kSq[6]+0.09938079899999068*kSq[5]+0.09938079899999068*kSq[4]+0.02666666666666666*kSq[3]+0.0769800358919501*kSq[2]-0.0769800358919501*kSq[1]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[5], 0.01721325931647741*kSq[6]-0.03975231959999626*kSq[5]-0.05678902799999467*kSq[4]+0.01333333333333333*kSq[3]-0.03849001794597505*kSq[2]-0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.4444444444444444*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[6], 0.07950463919999252*kSq[5]+0.1135780559999893*kSq[4]-0.5333333333333333*epsilon[0]*rdx2Sq[1]+0.8888888888888888*epsilon[0]*rdx2Sq[0]-0.1777777777777778*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[7], 0.01721325931647741*kSq[6]-0.03975231959999626*kSq[5]-0.05678902799999467*kSq[4]-0.01333333333333333*kSq[3]-0.03849001794597505*kSq[2]-0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.4444444444444444*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_insert(tri, globalIdxs[2], globalIdxs[0], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[2], globalIdxs[1], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[2], globalIdxs[2], 1.0);
  gkyl_mat_triples_insert(tri, globalIdxs[2], globalIdxs[3], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[2], globalIdxs[4], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[2], globalIdxs[5], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[2], globalIdxs[6], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[2], globalIdxs[7], 0.0);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[0], 0.0295084445425327*kSq[7]+0.03442651863295482*kSq[6]-0.063887656499994*kSq[5]-0.05962847939999439*kSq[4]-0.05333333333333333*kSq[3]+0.03849001794597505*kSq[2]-0.8888888888888888*epsilon[0]*rdx2Sq[1]+0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[1], (-0.03442651863295482*kSq[7])-0.03442651863295482*kSq[6]+0.09938079899999068*kSq[5]+0.09938079899999068*kSq[4]-0.02666666666666666*kSq[3]+0.0769800358919501*kSq[2]+0.0769800358919501*kSq[1]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[2], 0.01721325931647741*kSq[7]-0.05678902799999467*kSq[5]-0.03975231959999626*kSq[4]+0.01333333333333333*kSq[3]-0.4444444444444444*epsilon[0]*rdx2Sq[1]-0.03849001794597505*kSq[1]-0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[3], (-0.1967229636168847*kSq[7])+0.2271561119999787*kSq[5]-0.07950463919999252*kSq[4]+1.777777777777778*epsilon[0]*rdx2Sq[1]+0.3079201435678004*kSq[1]+0.5333333333333333*epsilon[0]*rdx2Sq[0]-0.3555555555555556*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[4], 0.1135780559999893*kSq[5]+0.07950463919999252*kSq[4]+0.8888888888888888*epsilon[0]*rdx2Sq[1]-0.5333333333333333*epsilon[0]*rdx2Sq[0]-0.1777777777777778*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[5], 0.0295084445425327*kSq[7]-0.03442651863295482*kSq[6]-0.063887656499994*kSq[5]-0.05962847939999439*kSq[4]+0.05333333333333333*kSq[3]-0.03849001794597505*kSq[2]-0.8888888888888888*epsilon[0]*rdx2Sq[1]+0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[6], (-0.03442651863295482*kSq[7])+0.03442651863295482*kSq[6]+0.09938079899999068*kSq[5]+0.09938079899999068*kSq[4]+0.02666666666666666*kSq[3]-0.0769800358919501*kSq[2]+0.0769800358919501*kSq[1]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[7], 0.01721325931647741*kSq[7]-0.05678902799999467*kSq[5]-0.03975231959999626*kSq[4]-0.01333333333333333*kSq[3]-0.4444444444444444*epsilon[0]*rdx2Sq[1]-0.03849001794597505*kSq[1]-0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_insert(tri, globalIdxs[4], globalIdxs[0], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[4], globalIdxs[1], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[4], globalIdxs[2], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[4], globalIdxs[3], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[4], globalIdxs[4], 1.0);
  gkyl_mat_triples_insert(tri, globalIdxs[4], globalIdxs[5], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[4], globalIdxs[6], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[4], globalIdxs[7], 0.0);
  gkyl_mat_triples_accum(tri, globalIdxs[5], globalIdxs[0], (-0.006147592613027645*kSq[7])+0.02697478829999747*kSq[5]+0.03336355394999686*kSq[4]+0.3111111111111111*epsilon[0]*rdx2Sq[1]-0.01924500897298752*kSq[1]+0.1888888888888889*epsilon[0]*rdx2Sq[0]-0.02222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[5], globalIdxs[1], 0.01721325931647741*kSq[6]-0.03975231959999626*kSq[5]-0.05678902799999467*kSq[4]+0.01333333333333333*kSq[3]-0.03849001794597505*kSq[2]-0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.4444444444444444*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[5], globalIdxs[2], 0.0234254740499978*kSq[5]+0.0234254740499978*kSq[4]-0.01333333333333333*kSq[3]+0.2555555555555555*epsilon[0]*rdx2Sq[1]+0.2555555555555555*epsilon[0]*rdx2Sq[0]-0.03333333333333333*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[5], globalIdxs[3], 0.0295084445425327*kSq[7]-0.03442651863295482*kSq[6]-0.063887656499994*kSq[5]-0.05962847939999439*kSq[4]+0.05333333333333333*kSq[3]-0.03849001794597505*kSq[2]-0.8888888888888888*epsilon[0]*rdx2Sq[1]+0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[5], globalIdxs[4], (-0.01721325931647741*kSq[7])-0.05678902799999467*kSq[5]-0.03975231959999626*kSq[4]+0.01333333333333333*kSq[3]-0.4444444444444444*epsilon[0]*rdx2Sq[1]+0.03849001794597505*kSq[1]-0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[5], globalIdxs[5], 0.04549218533640458*kSq[7]-0.04549218533640458*kSq[6]-0.0127775312999988*kSq[5]-0.0127775312999988*kSq[4]+0.04666666666666667*kSq[3]-0.03849001794597505*kSq[2]+0.5777777777777777*epsilon[0]*rdx2Sq[1]+0.03849001794597505*kSq[1]+0.5777777777777777*epsilon[0]*rdx2Sq[0]-0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[5], globalIdxs[6], 0.03442651863295482*kSq[7]-0.0295084445425327*kSq[6]-0.05962847939999439*kSq[5]-0.063887656499994*kSq[4]+0.05333333333333333*kSq[3]+0.06666666666666667*epsilon[0]*rdx2Sq[1]+0.03849001794597505*kSq[1]-0.8888888888888888*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[5], globalIdxs[7], 0.006147592613027645*kSq[6]+0.03336355394999686*kSq[5]+0.02697478829999747*kSq[4]+0.01924500897298752*kSq[2]+0.1888888888888889*epsilon[0]*rdx2Sq[1]+0.3111111111111111*epsilon[0]*rdx2Sq[0]-0.02222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[6], globalIdxs[0], (-0.01721325931647741*kSq[6])-0.03975231959999626*kSq[5]-0.05678902799999467*kSq[4]-0.01333333333333333*kSq[3]+0.03849001794597505*kSq[2]-0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.4444444444444444*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[6], globalIdxs[1], 0.07950463919999252*kSq[5]+0.1135780559999893*kSq[4]-0.5333333333333333*epsilon[0]*rdx2Sq[1]+0.8888888888888888*epsilon[0]*rdx2Sq[0]-0.1777777777777778*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[6], globalIdxs[2], (-0.01721325931647741*kSq[6])-0.03975231959999626*kSq[5]-0.05678902799999467*kSq[4]+0.01333333333333333*kSq[3]+0.03849001794597505*kSq[2]-0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.4444444444444444*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[6], globalIdxs[3], (-0.03442651863295482*kSq[7])+0.03442651863295482*kSq[6]+0.09938079899999068*kSq[5]+0.09938079899999068*kSq[4]+0.02666666666666666*kSq[3]-0.0769800358919501*kSq[2]+0.0769800358919501*kSq[1]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[6], globalIdxs[4], 0.03442651863295482*kSq[7]+0.03442651863295482*kSq[6]+0.09938079899999068*kSq[5]+0.09938079899999068*kSq[4]-0.02666666666666666*kSq[3]-0.0769800358919501*kSq[2]-0.0769800358919501*kSq[1]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[6], globalIdxs[5], 0.03442651863295482*kSq[7]-0.0295084445425327*kSq[6]-0.05962847939999439*kSq[5]-0.063887656499994*kSq[4]+0.05333333333333333*kSq[3]+0.06666666666666667*epsilon[0]*rdx2Sq[1]+0.03849001794597505*kSq[1]-0.8888888888888888*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[6], globalIdxs[6], 0.1967229636168847*kSq[6]-0.07950463919999252*kSq[5]+0.2271561119999787*kSq[4]-0.3079201435678004*kSq[2]+0.5333333333333333*epsilon[0]*rdx2Sq[1]+1.777777777777778*epsilon[0]*rdx2Sq[0]-0.3555555555555556*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[6], globalIdxs[7], (-0.03442651863295482*kSq[7])-0.0295084445425327*kSq[6]-0.05962847939999439*kSq[5]-0.063887656499994*kSq[4]-0.05333333333333333*kSq[3]+0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.03849001794597505*kSq[1]-0.8888888888888888*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_insert(tri, globalIdxs[7], globalIdxs[0], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[7], globalIdxs[1], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[7], globalIdxs[2], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[7], globalIdxs[3], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[7], globalIdxs[4], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[7], globalIdxs[5], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[7], globalIdxs[6], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[7], globalIdxs[7], 1.0);

}
void fem_poisson_lhs_stencil_consteps_2x_ser_p1_upx_dirichletx_upy_robiny(const double *epsilon, const double *kSq, const double *dx, const double *bcVals, const long *globalIdxs, gkyl_mat_triples *tri) 
{ 
  // epsilon: permittivity.
  // kSq: wave number squared (factor multiplying phi).
  // dx: cell length in each direction.
  // bcVals[3]: values to impose as BCs, i.e. bcVals[0]*phi+bcVals[1]*d(phi)/dx=bcVals[2].
  // globalIdxs: global linear index of each basis function/node in current cell.
  // tri: triples object (i,j,val), i.e. contribute val to i,j element of the global matrix.

  double rdx2Sq[2];
  rdx2Sq[0] = 4.0/(dx[0]*dx[0]);
  rdx2Sq[1] = 4.0/(dx[1]*dx[1]);

  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[0], (-0.1666666666666667*kSq[3])+0.1924500897298752*kSq[2]+0.3333333333333333*epsilon[0]*rdx2Sq[1]+0.1924500897298752*kSq[1]+0.3333333333333333*epsilon[0]*rdx2Sq[0]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[1], 0.09622504486493762*kSq[2]+0.1666666666666667*epsilon[0]*rdx2Sq[1]-0.3333333333333333*epsilon[0]*rdx2Sq[0]-0.1111111111111111*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[2], (-0.3333333333333333*epsilon[0]*rdx2Sq[1])+0.09622504486493762*kSq[1]+0.1666666666666667*epsilon[0]*rdx2Sq[0]-0.1111111111111111*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[3], (-0.1666666666666667*epsilon[0]*rdx2Sq[1])-0.1666666666666667*epsilon[0]*rdx2Sq[0]-0.05555555555555555*kSq[0]);
  gkyl_mat_triples_insert(tri, globalIdxs[1], globalIdxs[0], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[1], globalIdxs[1], 1.0);
  gkyl_mat_triples_insert(tri, globalIdxs[1], globalIdxs[2], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[1], globalIdxs[3], 0.0);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[0], (-0.3333333333333333*epsilon[0]*rdx2Sq[1])+0.09622504486493762*kSq[1]+0.1666666666666667*epsilon[0]*rdx2Sq[0]-0.1111111111111111*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[1], (-0.1666666666666667*epsilon[0]*rdx2Sq[1])-0.1666666666666667*epsilon[0]*rdx2Sq[0]-0.05555555555555555*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[2], (0.6666666666666666*epsilon[0]*rdx2Sq[1]*bcVals[9])/bcVals[10]+0.1666666666666667*kSq[3]-0.1924500897298752*kSq[2]+0.3333333333333333*epsilon[0]*rdx2Sq[1]+0.1924500897298752*kSq[1]+0.3333333333333333*epsilon[0]*rdx2Sq[0]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[3], (0.3333333333333333*epsilon[0]*rdx2Sq[1]*bcVals[9])/bcVals[10]-0.09622504486493762*kSq[2]+0.1666666666666667*epsilon[0]*rdx2Sq[1]-0.3333333333333333*epsilon[0]*rdx2Sq[0]-0.1111111111111111*kSq[0]);
  gkyl_mat_triples_insert(tri, globalIdxs[3], globalIdxs[0], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[3], globalIdxs[1], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[3], globalIdxs[2], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[3], globalIdxs[3], 1.0);

}
void fem_poisson_lhs_stencil_consteps_2x_ser_p2_upx_dirichletx_upy_robiny(const double *epsilon, const double *kSq, const double *dx, const double *bcVals, const long *globalIdxs, gkyl_mat_triples *tri) 
{ 
  // epsilon: permittivity.
  // kSq: wave number squared (factor multiplying phi).
  // dx: cell length in each direction.
  // bcVals[3]: values to impose as BCs, i.e. bcVals[0]*phi+bcVals[1]*d(phi)/dx=bcVals[2].
  // globalIdxs: global linear index of each basis function/node in current cell.
  // tri: triples object (i,j,val), i.e. contribute val to i,j element of the global matrix.

  double rdx2Sq[2];
  rdx2Sq[0] = 4.0/(dx[0]*dx[0]);
  rdx2Sq[1] = 4.0/(dx[1]*dx[1]);

  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[0], 0.04549218533640458*kSq[7]+0.04549218533640458*kSq[6]-0.0127775312999988*kSq[5]-0.0127775312999988*kSq[4]-0.04666666666666667*kSq[3]+0.03849001794597505*kSq[2]+0.5777777777777777*epsilon[0]*rdx2Sq[1]+0.03849001794597505*kSq[1]+0.5777777777777777*epsilon[0]*rdx2Sq[0]-0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[1], 0.03442651863295482*kSq[7]+0.0295084445425327*kSq[6]-0.05962847939999439*kSq[5]-0.063887656499994*kSq[4]-0.05333333333333333*kSq[3]+0.06666666666666667*epsilon[0]*rdx2Sq[1]+0.03849001794597505*kSq[1]-0.8888888888888888*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[2], (-0.006147592613027645*kSq[6])+0.03336355394999686*kSq[5]+0.02697478829999747*kSq[4]-0.01924500897298752*kSq[2]+0.1888888888888889*epsilon[0]*rdx2Sq[1]+0.3111111111111111*epsilon[0]*rdx2Sq[0]-0.02222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[3], 0.0295084445425327*kSq[7]+0.03442651863295482*kSq[6]-0.063887656499994*kSq[5]-0.05962847939999439*kSq[4]-0.05333333333333333*kSq[3]+0.03849001794597505*kSq[2]-0.8888888888888888*epsilon[0]*rdx2Sq[1]+0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[4], (-0.01721325931647741*kSq[7])-0.05678902799999467*kSq[5]-0.03975231959999626*kSq[4]-0.01333333333333333*kSq[3]-0.4444444444444444*epsilon[0]*rdx2Sq[1]+0.03849001794597505*kSq[1]-0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[5], (-0.006147592613027645*kSq[7])+0.02697478829999747*kSq[5]+0.03336355394999686*kSq[4]+0.3111111111111111*epsilon[0]*rdx2Sq[1]-0.01924500897298752*kSq[1]+0.1888888888888889*epsilon[0]*rdx2Sq[0]-0.02222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[6], (-0.01721325931647741*kSq[6])-0.03975231959999626*kSq[5]-0.05678902799999467*kSq[4]-0.01333333333333333*kSq[3]+0.03849001794597505*kSq[2]-0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.4444444444444444*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[7], 0.0234254740499978*kSq[5]+0.0234254740499978*kSq[4]+0.01333333333333333*kSq[3]+0.2555555555555555*epsilon[0]*rdx2Sq[1]+0.2555555555555555*epsilon[0]*rdx2Sq[0]-0.03333333333333333*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[0], 0.03442651863295482*kSq[7]+0.0295084445425327*kSq[6]-0.05962847939999439*kSq[5]-0.063887656499994*kSq[4]-0.05333333333333333*kSq[3]+0.06666666666666667*epsilon[0]*rdx2Sq[1]+0.03849001794597505*kSq[1]-0.8888888888888888*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[1], (-0.1967229636168847*kSq[6])-0.07950463919999252*kSq[5]+0.2271561119999787*kSq[4]+0.3079201435678004*kSq[2]+0.5333333333333333*epsilon[0]*rdx2Sq[1]+1.777777777777778*epsilon[0]*rdx2Sq[0]-0.3555555555555556*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[2], (-0.03442651863295482*kSq[7])+0.0295084445425327*kSq[6]-0.05962847939999439*kSq[5]-0.063887656499994*kSq[4]+0.05333333333333333*kSq[3]+0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.03849001794597505*kSq[1]-0.8888888888888888*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[3], (-0.03442651863295482*kSq[7])-0.03442651863295482*kSq[6]+0.09938079899999068*kSq[5]+0.09938079899999068*kSq[4]-0.02666666666666666*kSq[3]+0.0769800358919501*kSq[2]+0.0769800358919501*kSq[1]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[4], 0.03442651863295482*kSq[7]-0.03442651863295482*kSq[6]+0.09938079899999068*kSq[5]+0.09938079899999068*kSq[4]+0.02666666666666666*kSq[3]+0.0769800358919501*kSq[2]-0.0769800358919501*kSq[1]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[5], 0.01721325931647741*kSq[6]-0.03975231959999626*kSq[5]-0.05678902799999467*kSq[4]+0.01333333333333333*kSq[3]-0.03849001794597505*kSq[2]-0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.4444444444444444*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[6], 0.07950463919999252*kSq[5]+0.1135780559999893*kSq[4]-0.5333333333333333*epsilon[0]*rdx2Sq[1]+0.8888888888888888*epsilon[0]*rdx2Sq[0]-0.1777777777777778*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[7], 0.01721325931647741*kSq[6]-0.03975231959999626*kSq[5]-0.05678902799999467*kSq[4]-0.01333333333333333*kSq[3]-0.03849001794597505*kSq[2]-0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.4444444444444444*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_insert(tri, globalIdxs[2], globalIdxs[0], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[2], globalIdxs[1], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[2], globalIdxs[2], 1.0);
  gkyl_mat_triples_insert(tri, globalIdxs[2], globalIdxs[3], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[2], globalIdxs[4], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[2], globalIdxs[5], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[2], globalIdxs[6], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[2], globalIdxs[7], 0.0);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[0], 0.0295084445425327*kSq[7]+0.03442651863295482*kSq[6]-0.063887656499994*kSq[5]-0.05962847939999439*kSq[4]-0.05333333333333333*kSq[3]+0.03849001794597505*kSq[2]-0.8888888888888888*epsilon[0]*rdx2Sq[1]+0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[1], (-0.03442651863295482*kSq[7])-0.03442651863295482*kSq[6]+0.09938079899999068*kSq[5]+0.09938079899999068*kSq[4]-0.02666666666666666*kSq[3]+0.0769800358919501*kSq[2]+0.0769800358919501*kSq[1]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[2], 0.01721325931647741*kSq[7]-0.05678902799999467*kSq[5]-0.03975231959999626*kSq[4]+0.01333333333333333*kSq[3]-0.4444444444444444*epsilon[0]*rdx2Sq[1]-0.03849001794597505*kSq[1]-0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[3], (-0.1967229636168847*kSq[7])+0.2271561119999787*kSq[5]-0.07950463919999252*kSq[4]+1.777777777777778*epsilon[0]*rdx2Sq[1]+0.3079201435678004*kSq[1]+0.5333333333333333*epsilon[0]*rdx2Sq[0]-0.3555555555555556*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[4], 0.1135780559999893*kSq[5]+0.07950463919999252*kSq[4]+0.8888888888888888*epsilon[0]*rdx2Sq[1]-0.5333333333333333*epsilon[0]*rdx2Sq[0]-0.1777777777777778*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[5], 0.0295084445425327*kSq[7]-0.03442651863295482*kSq[6]-0.063887656499994*kSq[5]-0.05962847939999439*kSq[4]+0.05333333333333333*kSq[3]-0.03849001794597505*kSq[2]-0.8888888888888888*epsilon[0]*rdx2Sq[1]+0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[6], (-0.03442651863295482*kSq[7])+0.03442651863295482*kSq[6]+0.09938079899999068*kSq[5]+0.09938079899999068*kSq[4]+0.02666666666666666*kSq[3]-0.0769800358919501*kSq[2]+0.0769800358919501*kSq[1]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[7], 0.01721325931647741*kSq[7]-0.05678902799999467*kSq[5]-0.03975231959999626*kSq[4]-0.01333333333333333*kSq[3]-0.4444444444444444*epsilon[0]*rdx2Sq[1]-0.03849001794597505*kSq[1]-0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_insert(tri, globalIdxs[4], globalIdxs[0], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[4], globalIdxs[1], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[4], globalIdxs[2], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[4], globalIdxs[3], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[4], globalIdxs[4], 1.0);
  gkyl_mat_triples_insert(tri, globalIdxs[4], globalIdxs[5], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[4], globalIdxs[6], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[4], globalIdxs[7], 0.0);
  gkyl_mat_triples_accum(tri, globalIdxs[5], globalIdxs[0], (-0.006147592613027645*kSq[7])+0.02697478829999747*kSq[5]+0.03336355394999686*kSq[4]+0.3111111111111111*epsilon[0]*rdx2Sq[1]-0.01924500897298752*kSq[1]+0.1888888888888889*epsilon[0]*rdx2Sq[0]-0.02222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[5], globalIdxs[1], 0.01721325931647741*kSq[6]-0.03975231959999626*kSq[5]-0.05678902799999467*kSq[4]+0.01333333333333333*kSq[3]-0.03849001794597505*kSq[2]-0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.4444444444444444*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[5], globalIdxs[2], 0.0234254740499978*kSq[5]+0.0234254740499978*kSq[4]-0.01333333333333333*kSq[3]+0.2555555555555555*epsilon[0]*rdx2Sq[1]+0.2555555555555555*epsilon[0]*rdx2Sq[0]-0.03333333333333333*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[5], globalIdxs[3], 0.0295084445425327*kSq[7]-0.03442651863295482*kSq[6]-0.063887656499994*kSq[5]-0.05962847939999439*kSq[4]+0.05333333333333333*kSq[3]-0.03849001794597505*kSq[2]-0.8888888888888888*epsilon[0]*rdx2Sq[1]+0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[5], globalIdxs[4], (-0.01721325931647741*kSq[7])-0.05678902799999467*kSq[5]-0.03975231959999626*kSq[4]+0.01333333333333333*kSq[3]-0.4444444444444444*epsilon[0]*rdx2Sq[1]+0.03849001794597505*kSq[1]-0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[5], globalIdxs[5], (0.2666666666666667*epsilon[0]*rdx2Sq[1]*bcVals[9])/bcVals[10]+0.04549218533640458*kSq[7]-0.04549218533640458*kSq[6]-0.0127775312999988*kSq[5]-0.0127775312999988*kSq[4]+0.04666666666666667*kSq[3]-0.03849001794597505*kSq[2]+0.5777777777777777*epsilon[0]*rdx2Sq[1]+0.03849001794597505*kSq[1]+0.5777777777777777*epsilon[0]*rdx2Sq[0]-0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[5], globalIdxs[6], (0.1333333333333333*epsilon[0]*rdx2Sq[1]*bcVals[9])/bcVals[10]+0.03442651863295482*kSq[7]-0.0295084445425327*kSq[6]-0.05962847939999439*kSq[5]-0.063887656499994*kSq[4]+0.05333333333333333*kSq[3]+0.06666666666666667*epsilon[0]*rdx2Sq[1]+0.03849001794597505*kSq[1]-0.8888888888888888*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[5], globalIdxs[7], (-(0.06666666666666667*epsilon[0]*rdx2Sq[1]*bcVals[9])/bcVals[10])+0.006147592613027645*kSq[6]+0.03336355394999686*kSq[5]+0.02697478829999747*kSq[4]+0.01924500897298752*kSq[2]+0.1888888888888889*epsilon[0]*rdx2Sq[1]+0.3111111111111111*epsilon[0]*rdx2Sq[0]-0.02222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[6], globalIdxs[0], (-0.01721325931647741*kSq[6])-0.03975231959999626*kSq[5]-0.05678902799999467*kSq[4]-0.01333333333333333*kSq[3]+0.03849001794597505*kSq[2]-0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.4444444444444444*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[6], globalIdxs[1], 0.07950463919999252*kSq[5]+0.1135780559999893*kSq[4]-0.5333333333333333*epsilon[0]*rdx2Sq[1]+0.8888888888888888*epsilon[0]*rdx2Sq[0]-0.1777777777777778*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[6], globalIdxs[2], (-0.01721325931647741*kSq[6])-0.03975231959999626*kSq[5]-0.05678902799999467*kSq[4]+0.01333333333333333*kSq[3]+0.03849001794597505*kSq[2]-0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.4444444444444444*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[6], globalIdxs[3], (-0.03442651863295482*kSq[7])+0.03442651863295482*kSq[6]+0.09938079899999068*kSq[5]+0.09938079899999068*kSq[4]+0.02666666666666666*kSq[3]-0.0769800358919501*kSq[2]+0.0769800358919501*kSq[1]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[6], globalIdxs[4], 0.03442651863295482*kSq[7]+0.03442651863295482*kSq[6]+0.09938079899999068*kSq[5]+0.09938079899999068*kSq[4]-0.02666666666666666*kSq[3]-0.0769800358919501*kSq[2]-0.0769800358919501*kSq[1]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[6], globalIdxs[5], (0.1333333333333333*epsilon[0]*rdx2Sq[1]*bcVals[9])/bcVals[10]+0.03442651863295482*kSq[7]-0.0295084445425327*kSq[6]-0.05962847939999439*kSq[5]-0.063887656499994*kSq[4]+0.05333333333333333*kSq[3]+0.06666666666666667*epsilon[0]*rdx2Sq[1]+0.03849001794597505*kSq[1]-0.8888888888888888*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[6], globalIdxs[6], (1.066666666666667*epsilon[0]*rdx2Sq[1]*bcVals[9])/bcVals[10]+0.1967229636168847*kSq[6]-0.07950463919999252*kSq[5]+0.2271561119999787*kSq[4]-0.3079201435678004*kSq[2]+0.5333333333333333*epsilon[0]*rdx2Sq[1]+1.777777777777778*epsilon[0]*rdx2Sq[0]-0.3555555555555556*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[6], globalIdxs[7], (0.1333333333333333*epsilon[0]*rdx2Sq[1]*bcVals[9])/bcVals[10]-0.03442651863295482*kSq[7]-0.0295084445425327*kSq[6]-0.05962847939999439*kSq[5]-0.063887656499994*kSq[4]-0.05333333333333333*kSq[3]+0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.03849001794597505*kSq[1]-0.8888888888888888*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_insert(tri, globalIdxs[7], globalIdxs[0], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[7], globalIdxs[1], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[7], globalIdxs[2], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[7], globalIdxs[3], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[7], globalIdxs[4], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[7], globalIdxs[5], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[7], globalIdxs[6], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[7], globalIdxs[7], 1.0);

}
void fem_poisson_lhs_stencil_consteps_2x_ser_p1_upx_neumannx_upy_periodicy(const double *epsilon, const double *kSq, const double *dx, const double *bcVals, const long *globalIdxs, gkyl_mat_triples *tri) 
{ 
  // epsilon: permittivity.
  // kSq: wave number squared (factor multiplying phi).
  // dx: cell length in each direction.
  // bcVals[3]: values to impose as BCs, i.e. bcVals[0]*phi+bcVals[1]*d(phi)/dx=bcVals[2].
  // globalIdxs: global linear index of each basis function/node in current cell.
  // tri: triples object (i,j,val), i.e. contribute val to i,j element of the global matrix.

  double rdx2Sq[2];
  rdx2Sq[0] = 4.0/(dx[0]*dx[0]);
  rdx2Sq[1] = 4.0/(dx[1]*dx[1]);

  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[0], (-0.1666666666666667*kSq[3])+0.1924500897298752*kSq[2]+0.3333333333333333*epsilon[0]*rdx2Sq[1]+0.1924500897298752*kSq[1]+0.3333333333333333*epsilon[0]*rdx2Sq[0]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[1], 0.09622504486493762*kSq[2]+0.1666666666666667*epsilon[0]*rdx2Sq[1]-0.3333333333333333*epsilon[0]*rdx2Sq[0]-0.1111111111111111*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[2], (-0.3333333333333333*epsilon[0]*rdx2Sq[1])+0.09622504486493762*kSq[1]+0.1666666666666667*epsilon[0]*rdx2Sq[0]-0.1111111111111111*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[3], (-0.1666666666666667*epsilon[0]*rdx2Sq[1])-0.1666666666666667*epsilon[0]*rdx2Sq[0]-0.05555555555555555*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[0], 0.09622504486493762*kSq[2]+0.1666666666666667*epsilon[0]*rdx2Sq[1]-0.3333333333333333*epsilon[0]*rdx2Sq[0]-0.1111111111111111*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[1], 0.1666666666666667*kSq[3]+0.1924500897298752*kSq[2]+0.3333333333333333*epsilon[0]*rdx2Sq[1]-0.1924500897298752*kSq[1]+0.3333333333333333*epsilon[0]*rdx2Sq[0]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[2], (-0.1666666666666667*epsilon[0]*rdx2Sq[1])-0.1666666666666667*epsilon[0]*rdx2Sq[0]-0.05555555555555555*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[3], (-0.3333333333333333*epsilon[0]*rdx2Sq[1])-0.09622504486493762*kSq[1]+0.1666666666666667*epsilon[0]*rdx2Sq[0]-0.1111111111111111*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[0], (-0.3333333333333333*epsilon[0]*rdx2Sq[1])+0.09622504486493762*kSq[1]+0.1666666666666667*epsilon[0]*rdx2Sq[0]-0.1111111111111111*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[1], (-0.1666666666666667*epsilon[0]*rdx2Sq[1])-0.1666666666666667*epsilon[0]*rdx2Sq[0]-0.05555555555555555*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[2], 0.1666666666666667*kSq[3]-0.1924500897298752*kSq[2]+0.3333333333333333*epsilon[0]*rdx2Sq[1]+0.1924500897298752*kSq[1]+0.3333333333333333*epsilon[0]*rdx2Sq[0]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[3], (-0.09622504486493762*kSq[2])+0.1666666666666667*epsilon[0]*rdx2Sq[1]-0.3333333333333333*epsilon[0]*rdx2Sq[0]-0.1111111111111111*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[0], (-0.1666666666666667*epsilon[0]*rdx2Sq[1])-0.1666666666666667*epsilon[0]*rdx2Sq[0]-0.05555555555555555*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[1], (-0.3333333333333333*epsilon[0]*rdx2Sq[1])-0.09622504486493762*kSq[1]+0.1666666666666667*epsilon[0]*rdx2Sq[0]-0.1111111111111111*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[2], (-0.09622504486493762*kSq[2])+0.1666666666666667*epsilon[0]*rdx2Sq[1]-0.3333333333333333*epsilon[0]*rdx2Sq[0]-0.1111111111111111*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[3], (-0.1666666666666667*kSq[3])-0.1924500897298752*kSq[2]+0.3333333333333333*epsilon[0]*rdx2Sq[1]-0.1924500897298752*kSq[1]+0.3333333333333333*epsilon[0]*rdx2Sq[0]-0.2222222222222222*kSq[0]);

}
void fem_poisson_lhs_stencil_consteps_2x_ser_p2_upx_neumannx_upy_periodicy(const double *epsilon, const double *kSq, const double *dx, const double *bcVals, const long *globalIdxs, gkyl_mat_triples *tri) 
{ 
  // epsilon: permittivity.
  // kSq: wave number squared (factor multiplying phi).
  // dx: cell length in each direction.
  // bcVals[3]: values to impose as BCs, i.e. bcVals[0]*phi+bcVals[1]*d(phi)/dx=bcVals[2].
  // globalIdxs: global linear index of each basis function/node in current cell.
  // tri: triples object (i,j,val), i.e. contribute val to i,j element of the global matrix.

  double rdx2Sq[2];
  rdx2Sq[0] = 4.0/(dx[0]*dx[0]);
  rdx2Sq[1] = 4.0/(dx[1]*dx[1]);

  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[0], 0.04549218533640458*kSq[7]+0.04549218533640458*kSq[6]-0.0127775312999988*kSq[5]-0.0127775312999988*kSq[4]-0.04666666666666667*kSq[3]+0.03849001794597505*kSq[2]+0.5777777777777777*epsilon[0]*rdx2Sq[1]+0.03849001794597505*kSq[1]+0.5777777777777777*epsilon[0]*rdx2Sq[0]-0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[1], 0.03442651863295482*kSq[7]+0.0295084445425327*kSq[6]-0.05962847939999439*kSq[5]-0.063887656499994*kSq[4]-0.05333333333333333*kSq[3]+0.06666666666666667*epsilon[0]*rdx2Sq[1]+0.03849001794597505*kSq[1]-0.8888888888888888*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[2], (-0.006147592613027645*kSq[6])+0.03336355394999686*kSq[5]+0.02697478829999747*kSq[4]-0.01924500897298752*kSq[2]+0.1888888888888889*epsilon[0]*rdx2Sq[1]+0.3111111111111111*epsilon[0]*rdx2Sq[0]-0.02222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[3], 0.0295084445425327*kSq[7]+0.03442651863295482*kSq[6]-0.063887656499994*kSq[5]-0.05962847939999439*kSq[4]-0.05333333333333333*kSq[3]+0.03849001794597505*kSq[2]-0.8888888888888888*epsilon[0]*rdx2Sq[1]+0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[4], (-0.01721325931647741*kSq[7])-0.05678902799999467*kSq[5]-0.03975231959999626*kSq[4]-0.01333333333333333*kSq[3]-0.4444444444444444*epsilon[0]*rdx2Sq[1]+0.03849001794597505*kSq[1]-0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[5], (-0.006147592613027645*kSq[7])+0.02697478829999747*kSq[5]+0.03336355394999686*kSq[4]+0.3111111111111111*epsilon[0]*rdx2Sq[1]-0.01924500897298752*kSq[1]+0.1888888888888889*epsilon[0]*rdx2Sq[0]-0.02222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[6], (-0.01721325931647741*kSq[6])-0.03975231959999626*kSq[5]-0.05678902799999467*kSq[4]-0.01333333333333333*kSq[3]+0.03849001794597505*kSq[2]-0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.4444444444444444*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[7], 0.0234254740499978*kSq[5]+0.0234254740499978*kSq[4]+0.01333333333333333*kSq[3]+0.2555555555555555*epsilon[0]*rdx2Sq[1]+0.2555555555555555*epsilon[0]*rdx2Sq[0]-0.03333333333333333*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[0], 0.03442651863295482*kSq[7]+0.0295084445425327*kSq[6]-0.05962847939999439*kSq[5]-0.063887656499994*kSq[4]-0.05333333333333333*kSq[3]+0.06666666666666667*epsilon[0]*rdx2Sq[1]+0.03849001794597505*kSq[1]-0.8888888888888888*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[1], (-0.1967229636168847*kSq[6])-0.07950463919999252*kSq[5]+0.2271561119999787*kSq[4]+0.3079201435678004*kSq[2]+0.5333333333333333*epsilon[0]*rdx2Sq[1]+1.777777777777778*epsilon[0]*rdx2Sq[0]-0.3555555555555556*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[2], (-0.03442651863295482*kSq[7])+0.0295084445425327*kSq[6]-0.05962847939999439*kSq[5]-0.063887656499994*kSq[4]+0.05333333333333333*kSq[3]+0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.03849001794597505*kSq[1]-0.8888888888888888*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[3], (-0.03442651863295482*kSq[7])-0.03442651863295482*kSq[6]+0.09938079899999068*kSq[5]+0.09938079899999068*kSq[4]-0.02666666666666666*kSq[3]+0.0769800358919501*kSq[2]+0.0769800358919501*kSq[1]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[4], 0.03442651863295482*kSq[7]-0.03442651863295482*kSq[6]+0.09938079899999068*kSq[5]+0.09938079899999068*kSq[4]+0.02666666666666666*kSq[3]+0.0769800358919501*kSq[2]-0.0769800358919501*kSq[1]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[5], 0.01721325931647741*kSq[6]-0.03975231959999626*kSq[5]-0.05678902799999467*kSq[4]+0.01333333333333333*kSq[3]-0.03849001794597505*kSq[2]-0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.4444444444444444*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[6], 0.07950463919999252*kSq[5]+0.1135780559999893*kSq[4]-0.5333333333333333*epsilon[0]*rdx2Sq[1]+0.8888888888888888*epsilon[0]*rdx2Sq[0]-0.1777777777777778*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[7], 0.01721325931647741*kSq[6]-0.03975231959999626*kSq[5]-0.05678902799999467*kSq[4]-0.01333333333333333*kSq[3]-0.03849001794597505*kSq[2]-0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.4444444444444444*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[0], (-0.006147592613027645*kSq[6])+0.03336355394999686*kSq[5]+0.02697478829999747*kSq[4]-0.01924500897298752*kSq[2]+0.1888888888888889*epsilon[0]*rdx2Sq[1]+0.3111111111111111*epsilon[0]*rdx2Sq[0]-0.02222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[1], (-0.03442651863295482*kSq[7])+0.0295084445425327*kSq[6]-0.05962847939999439*kSq[5]-0.063887656499994*kSq[4]+0.05333333333333333*kSq[3]+0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.03849001794597505*kSq[1]-0.8888888888888888*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[2], (-0.04549218533640458*kSq[7])+0.04549218533640458*kSq[6]-0.0127775312999988*kSq[5]-0.0127775312999988*kSq[4]+0.04666666666666667*kSq[3]+0.03849001794597505*kSq[2]+0.5777777777777777*epsilon[0]*rdx2Sq[1]-0.03849001794597505*kSq[1]+0.5777777777777777*epsilon[0]*rdx2Sq[0]-0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[3], 0.01721325931647741*kSq[7]-0.05678902799999467*kSq[5]-0.03975231959999626*kSq[4]+0.01333333333333333*kSq[3]-0.4444444444444444*epsilon[0]*rdx2Sq[1]-0.03849001794597505*kSq[1]-0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[4], (-0.0295084445425327*kSq[7])+0.03442651863295482*kSq[6]-0.063887656499994*kSq[5]-0.05962847939999439*kSq[4]+0.05333333333333333*kSq[3]+0.03849001794597505*kSq[2]-0.8888888888888888*epsilon[0]*rdx2Sq[1]+0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[5], 0.0234254740499978*kSq[5]+0.0234254740499978*kSq[4]-0.01333333333333333*kSq[3]+0.2555555555555555*epsilon[0]*rdx2Sq[1]+0.2555555555555555*epsilon[0]*rdx2Sq[0]-0.03333333333333333*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[6], (-0.01721325931647741*kSq[6])-0.03975231959999626*kSq[5]-0.05678902799999467*kSq[4]+0.01333333333333333*kSq[3]+0.03849001794597505*kSq[2]-0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.4444444444444444*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[7], 0.006147592613027645*kSq[7]+0.02697478829999747*kSq[5]+0.03336355394999686*kSq[4]+0.3111111111111111*epsilon[0]*rdx2Sq[1]+0.01924500897298752*kSq[1]+0.1888888888888889*epsilon[0]*rdx2Sq[0]-0.02222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[0], 0.0295084445425327*kSq[7]+0.03442651863295482*kSq[6]-0.063887656499994*kSq[5]-0.05962847939999439*kSq[4]-0.05333333333333333*kSq[3]+0.03849001794597505*kSq[2]-0.8888888888888888*epsilon[0]*rdx2Sq[1]+0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[1], (-0.03442651863295482*kSq[7])-0.03442651863295482*kSq[6]+0.09938079899999068*kSq[5]+0.09938079899999068*kSq[4]-0.02666666666666666*kSq[3]+0.0769800358919501*kSq[2]+0.0769800358919501*kSq[1]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[2], 0.01721325931647741*kSq[7]-0.05678902799999467*kSq[5]-0.03975231959999626*kSq[4]+0.01333333333333333*kSq[3]-0.4444444444444444*epsilon[0]*rdx2Sq[1]-0.03849001794597505*kSq[1]-0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[3], (-0.1967229636168847*kSq[7])+0.2271561119999787*kSq[5]-0.07950463919999252*kSq[4]+1.777777777777778*epsilon[0]*rdx2Sq[1]+0.3079201435678004*kSq[1]+0.5333333333333333*epsilon[0]*rdx2Sq[0]-0.3555555555555556*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[4], 0.1135780559999893*kSq[5]+0.07950463919999252*kSq[4]+0.8888888888888888*epsilon[0]*rdx2Sq[1]-0.5333333333333333*epsilon[0]*rdx2Sq[0]-0.1777777777777778*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[5], 0.0295084445425327*kSq[7]-0.03442651863295482*kSq[6]-0.063887656499994*kSq[5]-0.05962847939999439*kSq[4]+0.05333333333333333*kSq[3]-0.03849001794597505*kSq[2]-0.8888888888888888*epsilon[0]*rdx2Sq[1]+0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[6], (-0.03442651863295482*kSq[7])+0.03442651863295482*kSq[6]+0.09938079899999068*kSq[5]+0.09938079899999068*kSq[4]+0.02666666666666666*kSq[3]-0.0769800358919501*kSq[2]+0.0769800358919501*kSq[1]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[7], 0.01721325931647741*kSq[7]-0.05678902799999467*kSq[5]-0.03975231959999626*kSq[4]-0.01333333333333333*kSq[3]-0.4444444444444444*epsilon[0]*rdx2Sq[1]-0.03849001794597505*kSq[1]-0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[4], globalIdxs[0], (-0.01721325931647741*kSq[7])-0.05678902799999467*kSq[5]-0.03975231959999626*kSq[4]-0.01333333333333333*kSq[3]-0.4444444444444444*epsilon[0]*rdx2Sq[1]+0.03849001794597505*kSq[1]-0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[4], globalIdxs[1], 0.03442651863295482*kSq[7]-0.03442651863295482*kSq[6]+0.09938079899999068*kSq[5]+0.09938079899999068*kSq[4]+0.02666666666666666*kSq[3]+0.0769800358919501*kSq[2]-0.0769800358919501*kSq[1]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[4], globalIdxs[2], (-0.0295084445425327*kSq[7])+0.03442651863295482*kSq[6]-0.063887656499994*kSq[5]-0.05962847939999439*kSq[4]+0.05333333333333333*kSq[3]+0.03849001794597505*kSq[2]-0.8888888888888888*epsilon[0]*rdx2Sq[1]+0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[4], globalIdxs[3], 0.1135780559999893*kSq[5]+0.07950463919999252*kSq[4]+0.8888888888888888*epsilon[0]*rdx2Sq[1]-0.5333333333333333*epsilon[0]*rdx2Sq[0]-0.1777777777777778*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[4], globalIdxs[4], 0.1967229636168847*kSq[7]+0.2271561119999787*kSq[5]-0.07950463919999252*kSq[4]+1.777777777777778*epsilon[0]*rdx2Sq[1]-0.3079201435678004*kSq[1]+0.5333333333333333*epsilon[0]*rdx2Sq[0]-0.3555555555555556*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[4], globalIdxs[5], (-0.01721325931647741*kSq[7])-0.05678902799999467*kSq[5]-0.03975231959999626*kSq[4]+0.01333333333333333*kSq[3]-0.4444444444444444*epsilon[0]*rdx2Sq[1]+0.03849001794597505*kSq[1]-0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[4], globalIdxs[6], 0.03442651863295482*kSq[7]+0.03442651863295482*kSq[6]+0.09938079899999068*kSq[5]+0.09938079899999068*kSq[4]-0.02666666666666666*kSq[3]-0.0769800358919501*kSq[2]-0.0769800358919501*kSq[1]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[4], globalIdxs[7], (-0.0295084445425327*kSq[7])-0.03442651863295482*kSq[6]-0.063887656499994*kSq[5]-0.05962847939999439*kSq[4]-0.05333333333333333*kSq[3]-0.03849001794597505*kSq[2]-0.8888888888888888*epsilon[0]*rdx2Sq[1]+0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[5], globalIdxs[0], (-0.006147592613027645*kSq[7])+0.02697478829999747*kSq[5]+0.03336355394999686*kSq[4]+0.3111111111111111*epsilon[0]*rdx2Sq[1]-0.01924500897298752*kSq[1]+0.1888888888888889*epsilon[0]*rdx2Sq[0]-0.02222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[5], globalIdxs[1], 0.01721325931647741*kSq[6]-0.03975231959999626*kSq[5]-0.05678902799999467*kSq[4]+0.01333333333333333*kSq[3]-0.03849001794597505*kSq[2]-0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.4444444444444444*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[5], globalIdxs[2], 0.0234254740499978*kSq[5]+0.0234254740499978*kSq[4]-0.01333333333333333*kSq[3]+0.2555555555555555*epsilon[0]*rdx2Sq[1]+0.2555555555555555*epsilon[0]*rdx2Sq[0]-0.03333333333333333*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[5], globalIdxs[3], 0.0295084445425327*kSq[7]-0.03442651863295482*kSq[6]-0.063887656499994*kSq[5]-0.05962847939999439*kSq[4]+0.05333333333333333*kSq[3]-0.03849001794597505*kSq[2]-0.8888888888888888*epsilon[0]*rdx2Sq[1]+0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[5], globalIdxs[4], (-0.01721325931647741*kSq[7])-0.05678902799999467*kSq[5]-0.03975231959999626*kSq[4]+0.01333333333333333*kSq[3]-0.4444444444444444*epsilon[0]*rdx2Sq[1]+0.03849001794597505*kSq[1]-0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[5], globalIdxs[5], 0.04549218533640458*kSq[7]-0.04549218533640458*kSq[6]-0.0127775312999988*kSq[5]-0.0127775312999988*kSq[4]+0.04666666666666667*kSq[3]-0.03849001794597505*kSq[2]+0.5777777777777777*epsilon[0]*rdx2Sq[1]+0.03849001794597505*kSq[1]+0.5777777777777777*epsilon[0]*rdx2Sq[0]-0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[5], globalIdxs[6], 0.03442651863295482*kSq[7]-0.0295084445425327*kSq[6]-0.05962847939999439*kSq[5]-0.063887656499994*kSq[4]+0.05333333333333333*kSq[3]+0.06666666666666667*epsilon[0]*rdx2Sq[1]+0.03849001794597505*kSq[1]-0.8888888888888888*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[5], globalIdxs[7], 0.006147592613027645*kSq[6]+0.03336355394999686*kSq[5]+0.02697478829999747*kSq[4]+0.01924500897298752*kSq[2]+0.1888888888888889*epsilon[0]*rdx2Sq[1]+0.3111111111111111*epsilon[0]*rdx2Sq[0]-0.02222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[6], globalIdxs[0], (-0.01721325931647741*kSq[6])-0.03975231959999626*kSq[5]-0.05678902799999467*kSq[4]-0.01333333333333333*kSq[3]+0.03849001794597505*kSq[2]-0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.4444444444444444*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[6], globalIdxs[1], 0.07950463919999252*kSq[5]+0.1135780559999893*kSq[4]-0.5333333333333333*epsilon[0]*rdx2Sq[1]+0.8888888888888888*epsilon[0]*rdx2Sq[0]-0.1777777777777778*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[6], globalIdxs[2], (-0.01721325931647741*kSq[6])-0.03975231959999626*kSq[5]-0.05678902799999467*kSq[4]+0.01333333333333333*kSq[3]+0.03849001794597505*kSq[2]-0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.4444444444444444*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[6], globalIdxs[3], (-0.03442651863295482*kSq[7])+0.03442651863295482*kSq[6]+0.09938079899999068*kSq[5]+0.09938079899999068*kSq[4]+0.02666666666666666*kSq[3]-0.0769800358919501*kSq[2]+0.0769800358919501*kSq[1]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[6], globalIdxs[4], 0.03442651863295482*kSq[7]+0.03442651863295482*kSq[6]+0.09938079899999068*kSq[5]+0.09938079899999068*kSq[4]-0.02666666666666666*kSq[3]-0.0769800358919501*kSq[2]-0.0769800358919501*kSq[1]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[6], globalIdxs[5], 0.03442651863295482*kSq[7]-0.0295084445425327*kSq[6]-0.05962847939999439*kSq[5]-0.063887656499994*kSq[4]+0.05333333333333333*kSq[3]+0.06666666666666667*epsilon[0]*rdx2Sq[1]+0.03849001794597505*kSq[1]-0.8888888888888888*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[6], globalIdxs[6], 0.1967229636168847*kSq[6]-0.07950463919999252*kSq[5]+0.2271561119999787*kSq[4]-0.3079201435678004*kSq[2]+0.5333333333333333*epsilon[0]*rdx2Sq[1]+1.777777777777778*epsilon[0]*rdx2Sq[0]-0.3555555555555556*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[6], globalIdxs[7], (-0.03442651863295482*kSq[7])-0.0295084445425327*kSq[6]-0.05962847939999439*kSq[5]-0.063887656499994*kSq[4]-0.05333333333333333*kSq[3]+0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.03849001794597505*kSq[1]-0.8888888888888888*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[7], globalIdxs[0], 0.0234254740499978*kSq[5]+0.0234254740499978*kSq[4]+0.01333333333333333*kSq[3]+0.2555555555555555*epsilon[0]*rdx2Sq[1]+0.2555555555555555*epsilon[0]*rdx2Sq[0]-0.03333333333333333*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[7], globalIdxs[1], 0.01721325931647741*kSq[6]-0.03975231959999626*kSq[5]-0.05678902799999467*kSq[4]-0.01333333333333333*kSq[3]-0.03849001794597505*kSq[2]-0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.4444444444444444*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[7], globalIdxs[2], 0.006147592613027645*kSq[7]+0.02697478829999747*kSq[5]+0.03336355394999686*kSq[4]+0.3111111111111111*epsilon[0]*rdx2Sq[1]+0.01924500897298752*kSq[1]+0.1888888888888889*epsilon[0]*rdx2Sq[0]-0.02222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[7], globalIdxs[3], 0.01721325931647741*kSq[7]-0.05678902799999467*kSq[5]-0.03975231959999626*kSq[4]-0.01333333333333333*kSq[3]-0.4444444444444444*epsilon[0]*rdx2Sq[1]-0.03849001794597505*kSq[1]-0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[7], globalIdxs[4], (-0.0295084445425327*kSq[7])-0.03442651863295482*kSq[6]-0.063887656499994*kSq[5]-0.05962847939999439*kSq[4]-0.05333333333333333*kSq[3]-0.03849001794597505*kSq[2]-0.8888888888888888*epsilon[0]*rdx2Sq[1]+0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[7], globalIdxs[5], 0.006147592613027645*kSq[6]+0.03336355394999686*kSq[5]+0.02697478829999747*kSq[4]+0.01924500897298752*kSq[2]+0.1888888888888889*epsilon[0]*rdx2Sq[1]+0.3111111111111111*epsilon[0]*rdx2Sq[0]-0.02222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[7], globalIdxs[6], (-0.03442651863295482*kSq[7])-0.0295084445425327*kSq[6]-0.05962847939999439*kSq[5]-0.063887656499994*kSq[4]-0.05333333333333333*kSq[3]+0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.03849001794597505*kSq[1]-0.8888888888888888*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[7], globalIdxs[7], (-0.04549218533640458*kSq[7])-0.04549218533640458*kSq[6]-0.0127775312999988*kSq[5]-0.0127775312999988*kSq[4]-0.04666666666666667*kSq[3]-0.03849001794597505*kSq[2]+0.5777777777777777*epsilon[0]*rdx2Sq[1]-0.03849001794597505*kSq[1]+0.5777777777777777*epsilon[0]*rdx2Sq[0]-0.06666666666666667*kSq[0]);

}
void fem_poisson_lhs_stencil_consteps_2x_ser_p1_upx_neumannx_upy_dirichlety(const double *epsilon, const double *kSq, const double *dx, const double *bcVals, const long *globalIdxs, gkyl_mat_triples *tri) 
{ 
  // epsilon: permittivity.
  // kSq: wave number squared (factor multiplying phi).
  // dx: cell length in each direction.
  // bcVals[3]: values to impose as BCs, i.e. bcVals[0]*phi+bcVals[1]*d(phi)/dx=bcVals[2].
  // globalIdxs: global linear index of each basis function/node in current cell.
  // tri: triples object (i,j,val), i.e. contribute val to i,j element of the global matrix.

  double rdx2Sq[2];
  rdx2Sq[0] = 4.0/(dx[0]*dx[0]);
  rdx2Sq[1] = 4.0/(dx[1]*dx[1]);

  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[0], (-0.1666666666666667*kSq[3])+0.1924500897298752*kSq[2]+0.3333333333333333*epsilon[0]*rdx2Sq[1]+0.1924500897298752*kSq[1]+0.3333333333333333*epsilon[0]*rdx2Sq[0]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[1], 0.09622504486493762*kSq[2]+0.1666666666666667*epsilon[0]*rdx2Sq[1]-0.3333333333333333*epsilon[0]*rdx2Sq[0]-0.1111111111111111*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[2], (-0.3333333333333333*epsilon[0]*rdx2Sq[1])+0.09622504486493762*kSq[1]+0.1666666666666667*epsilon[0]*rdx2Sq[0]-0.1111111111111111*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[3], (-0.1666666666666667*epsilon[0]*rdx2Sq[1])-0.1666666666666667*epsilon[0]*rdx2Sq[0]-0.05555555555555555*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[0], 0.09622504486493762*kSq[2]+0.1666666666666667*epsilon[0]*rdx2Sq[1]-0.3333333333333333*epsilon[0]*rdx2Sq[0]-0.1111111111111111*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[1], 0.1666666666666667*kSq[3]+0.1924500897298752*kSq[2]+0.3333333333333333*epsilon[0]*rdx2Sq[1]-0.1924500897298752*kSq[1]+0.3333333333333333*epsilon[0]*rdx2Sq[0]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[2], (-0.1666666666666667*epsilon[0]*rdx2Sq[1])-0.1666666666666667*epsilon[0]*rdx2Sq[0]-0.05555555555555555*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[3], (-0.3333333333333333*epsilon[0]*rdx2Sq[1])-0.09622504486493762*kSq[1]+0.1666666666666667*epsilon[0]*rdx2Sq[0]-0.1111111111111111*kSq[0]);
  gkyl_mat_triples_insert(tri, globalIdxs[2], globalIdxs[0], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[2], globalIdxs[1], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[2], globalIdxs[2], 1.0);
  gkyl_mat_triples_insert(tri, globalIdxs[2], globalIdxs[3], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[3], globalIdxs[0], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[3], globalIdxs[1], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[3], globalIdxs[2], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[3], globalIdxs[3], 1.0);

}
void fem_poisson_lhs_stencil_consteps_2x_ser_p2_upx_neumannx_upy_dirichlety(const double *epsilon, const double *kSq, const double *dx, const double *bcVals, const long *globalIdxs, gkyl_mat_triples *tri) 
{ 
  // epsilon: permittivity.
  // kSq: wave number squared (factor multiplying phi).
  // dx: cell length in each direction.
  // bcVals[3]: values to impose as BCs, i.e. bcVals[0]*phi+bcVals[1]*d(phi)/dx=bcVals[2].
  // globalIdxs: global linear index of each basis function/node in current cell.
  // tri: triples object (i,j,val), i.e. contribute val to i,j element of the global matrix.

  double rdx2Sq[2];
  rdx2Sq[0] = 4.0/(dx[0]*dx[0]);
  rdx2Sq[1] = 4.0/(dx[1]*dx[1]);

  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[0], 0.04549218533640458*kSq[7]+0.04549218533640458*kSq[6]-0.0127775312999988*kSq[5]-0.0127775312999988*kSq[4]-0.04666666666666667*kSq[3]+0.03849001794597505*kSq[2]+0.5777777777777777*epsilon[0]*rdx2Sq[1]+0.03849001794597505*kSq[1]+0.5777777777777777*epsilon[0]*rdx2Sq[0]-0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[1], 0.03442651863295482*kSq[7]+0.0295084445425327*kSq[6]-0.05962847939999439*kSq[5]-0.063887656499994*kSq[4]-0.05333333333333333*kSq[3]+0.06666666666666667*epsilon[0]*rdx2Sq[1]+0.03849001794597505*kSq[1]-0.8888888888888888*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[2], (-0.006147592613027645*kSq[6])+0.03336355394999686*kSq[5]+0.02697478829999747*kSq[4]-0.01924500897298752*kSq[2]+0.1888888888888889*epsilon[0]*rdx2Sq[1]+0.3111111111111111*epsilon[0]*rdx2Sq[0]-0.02222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[3], 0.0295084445425327*kSq[7]+0.03442651863295482*kSq[6]-0.063887656499994*kSq[5]-0.05962847939999439*kSq[4]-0.05333333333333333*kSq[3]+0.03849001794597505*kSq[2]-0.8888888888888888*epsilon[0]*rdx2Sq[1]+0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[4], (-0.01721325931647741*kSq[7])-0.05678902799999467*kSq[5]-0.03975231959999626*kSq[4]-0.01333333333333333*kSq[3]-0.4444444444444444*epsilon[0]*rdx2Sq[1]+0.03849001794597505*kSq[1]-0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[5], (-0.006147592613027645*kSq[7])+0.02697478829999747*kSq[5]+0.03336355394999686*kSq[4]+0.3111111111111111*epsilon[0]*rdx2Sq[1]-0.01924500897298752*kSq[1]+0.1888888888888889*epsilon[0]*rdx2Sq[0]-0.02222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[6], (-0.01721325931647741*kSq[6])-0.03975231959999626*kSq[5]-0.05678902799999467*kSq[4]-0.01333333333333333*kSq[3]+0.03849001794597505*kSq[2]-0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.4444444444444444*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[7], 0.0234254740499978*kSq[5]+0.0234254740499978*kSq[4]+0.01333333333333333*kSq[3]+0.2555555555555555*epsilon[0]*rdx2Sq[1]+0.2555555555555555*epsilon[0]*rdx2Sq[0]-0.03333333333333333*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[0], 0.03442651863295482*kSq[7]+0.0295084445425327*kSq[6]-0.05962847939999439*kSq[5]-0.063887656499994*kSq[4]-0.05333333333333333*kSq[3]+0.06666666666666667*epsilon[0]*rdx2Sq[1]+0.03849001794597505*kSq[1]-0.8888888888888888*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[1], (-0.1967229636168847*kSq[6])-0.07950463919999252*kSq[5]+0.2271561119999787*kSq[4]+0.3079201435678004*kSq[2]+0.5333333333333333*epsilon[0]*rdx2Sq[1]+1.777777777777778*epsilon[0]*rdx2Sq[0]-0.3555555555555556*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[2], (-0.03442651863295482*kSq[7])+0.0295084445425327*kSq[6]-0.05962847939999439*kSq[5]-0.063887656499994*kSq[4]+0.05333333333333333*kSq[3]+0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.03849001794597505*kSq[1]-0.8888888888888888*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[3], (-0.03442651863295482*kSq[7])-0.03442651863295482*kSq[6]+0.09938079899999068*kSq[5]+0.09938079899999068*kSq[4]-0.02666666666666666*kSq[3]+0.0769800358919501*kSq[2]+0.0769800358919501*kSq[1]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[4], 0.03442651863295482*kSq[7]-0.03442651863295482*kSq[6]+0.09938079899999068*kSq[5]+0.09938079899999068*kSq[4]+0.02666666666666666*kSq[3]+0.0769800358919501*kSq[2]-0.0769800358919501*kSq[1]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[5], 0.01721325931647741*kSq[6]-0.03975231959999626*kSq[5]-0.05678902799999467*kSq[4]+0.01333333333333333*kSq[3]-0.03849001794597505*kSq[2]-0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.4444444444444444*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[6], 0.07950463919999252*kSq[5]+0.1135780559999893*kSq[4]-0.5333333333333333*epsilon[0]*rdx2Sq[1]+0.8888888888888888*epsilon[0]*rdx2Sq[0]-0.1777777777777778*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[7], 0.01721325931647741*kSq[6]-0.03975231959999626*kSq[5]-0.05678902799999467*kSq[4]-0.01333333333333333*kSq[3]-0.03849001794597505*kSq[2]-0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.4444444444444444*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[0], (-0.006147592613027645*kSq[6])+0.03336355394999686*kSq[5]+0.02697478829999747*kSq[4]-0.01924500897298752*kSq[2]+0.1888888888888889*epsilon[0]*rdx2Sq[1]+0.3111111111111111*epsilon[0]*rdx2Sq[0]-0.02222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[1], (-0.03442651863295482*kSq[7])+0.0295084445425327*kSq[6]-0.05962847939999439*kSq[5]-0.063887656499994*kSq[4]+0.05333333333333333*kSq[3]+0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.03849001794597505*kSq[1]-0.8888888888888888*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[2], (-0.04549218533640458*kSq[7])+0.04549218533640458*kSq[6]-0.0127775312999988*kSq[5]-0.0127775312999988*kSq[4]+0.04666666666666667*kSq[3]+0.03849001794597505*kSq[2]+0.5777777777777777*epsilon[0]*rdx2Sq[1]-0.03849001794597505*kSq[1]+0.5777777777777777*epsilon[0]*rdx2Sq[0]-0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[3], 0.01721325931647741*kSq[7]-0.05678902799999467*kSq[5]-0.03975231959999626*kSq[4]+0.01333333333333333*kSq[3]-0.4444444444444444*epsilon[0]*rdx2Sq[1]-0.03849001794597505*kSq[1]-0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[4], (-0.0295084445425327*kSq[7])+0.03442651863295482*kSq[6]-0.063887656499994*kSq[5]-0.05962847939999439*kSq[4]+0.05333333333333333*kSq[3]+0.03849001794597505*kSq[2]-0.8888888888888888*epsilon[0]*rdx2Sq[1]+0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[5], 0.0234254740499978*kSq[5]+0.0234254740499978*kSq[4]-0.01333333333333333*kSq[3]+0.2555555555555555*epsilon[0]*rdx2Sq[1]+0.2555555555555555*epsilon[0]*rdx2Sq[0]-0.03333333333333333*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[6], (-0.01721325931647741*kSq[6])-0.03975231959999626*kSq[5]-0.05678902799999467*kSq[4]+0.01333333333333333*kSq[3]+0.03849001794597505*kSq[2]-0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.4444444444444444*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[7], 0.006147592613027645*kSq[7]+0.02697478829999747*kSq[5]+0.03336355394999686*kSq[4]+0.3111111111111111*epsilon[0]*rdx2Sq[1]+0.01924500897298752*kSq[1]+0.1888888888888889*epsilon[0]*rdx2Sq[0]-0.02222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[0], 0.0295084445425327*kSq[7]+0.03442651863295482*kSq[6]-0.063887656499994*kSq[5]-0.05962847939999439*kSq[4]-0.05333333333333333*kSq[3]+0.03849001794597505*kSq[2]-0.8888888888888888*epsilon[0]*rdx2Sq[1]+0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[1], (-0.03442651863295482*kSq[7])-0.03442651863295482*kSq[6]+0.09938079899999068*kSq[5]+0.09938079899999068*kSq[4]-0.02666666666666666*kSq[3]+0.0769800358919501*kSq[2]+0.0769800358919501*kSq[1]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[2], 0.01721325931647741*kSq[7]-0.05678902799999467*kSq[5]-0.03975231959999626*kSq[4]+0.01333333333333333*kSq[3]-0.4444444444444444*epsilon[0]*rdx2Sq[1]-0.03849001794597505*kSq[1]-0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[3], (-0.1967229636168847*kSq[7])+0.2271561119999787*kSq[5]-0.07950463919999252*kSq[4]+1.777777777777778*epsilon[0]*rdx2Sq[1]+0.3079201435678004*kSq[1]+0.5333333333333333*epsilon[0]*rdx2Sq[0]-0.3555555555555556*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[4], 0.1135780559999893*kSq[5]+0.07950463919999252*kSq[4]+0.8888888888888888*epsilon[0]*rdx2Sq[1]-0.5333333333333333*epsilon[0]*rdx2Sq[0]-0.1777777777777778*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[5], 0.0295084445425327*kSq[7]-0.03442651863295482*kSq[6]-0.063887656499994*kSq[5]-0.05962847939999439*kSq[4]+0.05333333333333333*kSq[3]-0.03849001794597505*kSq[2]-0.8888888888888888*epsilon[0]*rdx2Sq[1]+0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[6], (-0.03442651863295482*kSq[7])+0.03442651863295482*kSq[6]+0.09938079899999068*kSq[5]+0.09938079899999068*kSq[4]+0.02666666666666666*kSq[3]-0.0769800358919501*kSq[2]+0.0769800358919501*kSq[1]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[7], 0.01721325931647741*kSq[7]-0.05678902799999467*kSq[5]-0.03975231959999626*kSq[4]-0.01333333333333333*kSq[3]-0.4444444444444444*epsilon[0]*rdx2Sq[1]-0.03849001794597505*kSq[1]-0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[4], globalIdxs[0], (-0.01721325931647741*kSq[7])-0.05678902799999467*kSq[5]-0.03975231959999626*kSq[4]-0.01333333333333333*kSq[3]-0.4444444444444444*epsilon[0]*rdx2Sq[1]+0.03849001794597505*kSq[1]-0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[4], globalIdxs[1], 0.03442651863295482*kSq[7]-0.03442651863295482*kSq[6]+0.09938079899999068*kSq[5]+0.09938079899999068*kSq[4]+0.02666666666666666*kSq[3]+0.0769800358919501*kSq[2]-0.0769800358919501*kSq[1]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[4], globalIdxs[2], (-0.0295084445425327*kSq[7])+0.03442651863295482*kSq[6]-0.063887656499994*kSq[5]-0.05962847939999439*kSq[4]+0.05333333333333333*kSq[3]+0.03849001794597505*kSq[2]-0.8888888888888888*epsilon[0]*rdx2Sq[1]+0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[4], globalIdxs[3], 0.1135780559999893*kSq[5]+0.07950463919999252*kSq[4]+0.8888888888888888*epsilon[0]*rdx2Sq[1]-0.5333333333333333*epsilon[0]*rdx2Sq[0]-0.1777777777777778*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[4], globalIdxs[4], 0.1967229636168847*kSq[7]+0.2271561119999787*kSq[5]-0.07950463919999252*kSq[4]+1.777777777777778*epsilon[0]*rdx2Sq[1]-0.3079201435678004*kSq[1]+0.5333333333333333*epsilon[0]*rdx2Sq[0]-0.3555555555555556*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[4], globalIdxs[5], (-0.01721325931647741*kSq[7])-0.05678902799999467*kSq[5]-0.03975231959999626*kSq[4]+0.01333333333333333*kSq[3]-0.4444444444444444*epsilon[0]*rdx2Sq[1]+0.03849001794597505*kSq[1]-0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[4], globalIdxs[6], 0.03442651863295482*kSq[7]+0.03442651863295482*kSq[6]+0.09938079899999068*kSq[5]+0.09938079899999068*kSq[4]-0.02666666666666666*kSq[3]-0.0769800358919501*kSq[2]-0.0769800358919501*kSq[1]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[4], globalIdxs[7], (-0.0295084445425327*kSq[7])-0.03442651863295482*kSq[6]-0.063887656499994*kSq[5]-0.05962847939999439*kSq[4]-0.05333333333333333*kSq[3]-0.03849001794597505*kSq[2]-0.8888888888888888*epsilon[0]*rdx2Sq[1]+0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_insert(tri, globalIdxs[5], globalIdxs[0], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[5], globalIdxs[1], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[5], globalIdxs[2], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[5], globalIdxs[3], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[5], globalIdxs[4], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[5], globalIdxs[5], 1.0);
  gkyl_mat_triples_insert(tri, globalIdxs[5], globalIdxs[6], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[5], globalIdxs[7], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[6], globalIdxs[0], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[6], globalIdxs[1], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[6], globalIdxs[2], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[6], globalIdxs[3], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[6], globalIdxs[4], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[6], globalIdxs[5], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[6], globalIdxs[6], 1.0);
  gkyl_mat_triples_insert(tri, globalIdxs[6], globalIdxs[7], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[7], globalIdxs[0], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[7], globalIdxs[1], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[7], globalIdxs[2], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[7], globalIdxs[3], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[7], globalIdxs[4], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[7], globalIdxs[5], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[7], globalIdxs[6], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[7], globalIdxs[7], 1.0);

}
void fem_poisson_lhs_stencil_consteps_2x_ser_p1_upx_neumannx_upy_neumanny(const double *epsilon, const double *kSq, const double *dx, const double *bcVals, const long *globalIdxs, gkyl_mat_triples *tri) 
{ 
  // epsilon: permittivity.
  // kSq: wave number squared (factor multiplying phi).
  // dx: cell length in each direction.
  // bcVals[3]: values to impose as BCs, i.e. bcVals[0]*phi+bcVals[1]*d(phi)/dx=bcVals[2].
  // globalIdxs: global linear index of each basis function/node in current cell.
  // tri: triples object (i,j,val), i.e. contribute val to i,j element of the global matrix.

  double rdx2Sq[2];
  rdx2Sq[0] = 4.0/(dx[0]*dx[0]);
  rdx2Sq[1] = 4.0/(dx[1]*dx[1]);

  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[0], (-0.1666666666666667*kSq[3])+0.1924500897298752*kSq[2]+0.3333333333333333*epsilon[0]*rdx2Sq[1]+0.1924500897298752*kSq[1]+0.3333333333333333*epsilon[0]*rdx2Sq[0]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[1], 0.09622504486493762*kSq[2]+0.1666666666666667*epsilon[0]*rdx2Sq[1]-0.3333333333333333*epsilon[0]*rdx2Sq[0]-0.1111111111111111*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[2], (-0.3333333333333333*epsilon[0]*rdx2Sq[1])+0.09622504486493762*kSq[1]+0.1666666666666667*epsilon[0]*rdx2Sq[0]-0.1111111111111111*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[3], (-0.1666666666666667*epsilon[0]*rdx2Sq[1])-0.1666666666666667*epsilon[0]*rdx2Sq[0]-0.05555555555555555*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[0], 0.09622504486493762*kSq[2]+0.1666666666666667*epsilon[0]*rdx2Sq[1]-0.3333333333333333*epsilon[0]*rdx2Sq[0]-0.1111111111111111*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[1], 0.1666666666666667*kSq[3]+0.1924500897298752*kSq[2]+0.3333333333333333*epsilon[0]*rdx2Sq[1]-0.1924500897298752*kSq[1]+0.3333333333333333*epsilon[0]*rdx2Sq[0]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[2], (-0.1666666666666667*epsilon[0]*rdx2Sq[1])-0.1666666666666667*epsilon[0]*rdx2Sq[0]-0.05555555555555555*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[3], (-0.3333333333333333*epsilon[0]*rdx2Sq[1])-0.09622504486493762*kSq[1]+0.1666666666666667*epsilon[0]*rdx2Sq[0]-0.1111111111111111*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[0], (-0.3333333333333333*epsilon[0]*rdx2Sq[1])+0.09622504486493762*kSq[1]+0.1666666666666667*epsilon[0]*rdx2Sq[0]-0.1111111111111111*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[1], (-0.1666666666666667*epsilon[0]*rdx2Sq[1])-0.1666666666666667*epsilon[0]*rdx2Sq[0]-0.05555555555555555*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[2], 0.1666666666666667*kSq[3]-0.1924500897298752*kSq[2]+0.3333333333333333*epsilon[0]*rdx2Sq[1]+0.1924500897298752*kSq[1]+0.3333333333333333*epsilon[0]*rdx2Sq[0]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[3], (-0.09622504486493762*kSq[2])+0.1666666666666667*epsilon[0]*rdx2Sq[1]-0.3333333333333333*epsilon[0]*rdx2Sq[0]-0.1111111111111111*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[0], (-0.1666666666666667*epsilon[0]*rdx2Sq[1])-0.1666666666666667*epsilon[0]*rdx2Sq[0]-0.05555555555555555*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[1], (-0.3333333333333333*epsilon[0]*rdx2Sq[1])-0.09622504486493762*kSq[1]+0.1666666666666667*epsilon[0]*rdx2Sq[0]-0.1111111111111111*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[2], (-0.09622504486493762*kSq[2])+0.1666666666666667*epsilon[0]*rdx2Sq[1]-0.3333333333333333*epsilon[0]*rdx2Sq[0]-0.1111111111111111*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[3], (-0.1666666666666667*kSq[3])-0.1924500897298752*kSq[2]+0.3333333333333333*epsilon[0]*rdx2Sq[1]-0.1924500897298752*kSq[1]+0.3333333333333333*epsilon[0]*rdx2Sq[0]-0.2222222222222222*kSq[0]);

}
void fem_poisson_lhs_stencil_consteps_2x_ser_p2_upx_neumannx_upy_neumanny(const double *epsilon, const double *kSq, const double *dx, const double *bcVals, const long *globalIdxs, gkyl_mat_triples *tri) 
{ 
  // epsilon: permittivity.
  // kSq: wave number squared (factor multiplying phi).
  // dx: cell length in each direction.
  // bcVals[3]: values to impose as BCs, i.e. bcVals[0]*phi+bcVals[1]*d(phi)/dx=bcVals[2].
  // globalIdxs: global linear index of each basis function/node in current cell.
  // tri: triples object (i,j,val), i.e. contribute val to i,j element of the global matrix.

  double rdx2Sq[2];
  rdx2Sq[0] = 4.0/(dx[0]*dx[0]);
  rdx2Sq[1] = 4.0/(dx[1]*dx[1]);

  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[0], 0.04549218533640458*kSq[7]+0.04549218533640458*kSq[6]-0.0127775312999988*kSq[5]-0.0127775312999988*kSq[4]-0.04666666666666667*kSq[3]+0.03849001794597505*kSq[2]+0.5777777777777777*epsilon[0]*rdx2Sq[1]+0.03849001794597505*kSq[1]+0.5777777777777777*epsilon[0]*rdx2Sq[0]-0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[1], 0.03442651863295482*kSq[7]+0.0295084445425327*kSq[6]-0.05962847939999439*kSq[5]-0.063887656499994*kSq[4]-0.05333333333333333*kSq[3]+0.06666666666666667*epsilon[0]*rdx2Sq[1]+0.03849001794597505*kSq[1]-0.8888888888888888*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[2], (-0.006147592613027645*kSq[6])+0.03336355394999686*kSq[5]+0.02697478829999747*kSq[4]-0.01924500897298752*kSq[2]+0.1888888888888889*epsilon[0]*rdx2Sq[1]+0.3111111111111111*epsilon[0]*rdx2Sq[0]-0.02222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[3], 0.0295084445425327*kSq[7]+0.03442651863295482*kSq[6]-0.063887656499994*kSq[5]-0.05962847939999439*kSq[4]-0.05333333333333333*kSq[3]+0.03849001794597505*kSq[2]-0.8888888888888888*epsilon[0]*rdx2Sq[1]+0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[4], (-0.01721325931647741*kSq[7])-0.05678902799999467*kSq[5]-0.03975231959999626*kSq[4]-0.01333333333333333*kSq[3]-0.4444444444444444*epsilon[0]*rdx2Sq[1]+0.03849001794597505*kSq[1]-0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[5], (-0.006147592613027645*kSq[7])+0.02697478829999747*kSq[5]+0.03336355394999686*kSq[4]+0.3111111111111111*epsilon[0]*rdx2Sq[1]-0.01924500897298752*kSq[1]+0.1888888888888889*epsilon[0]*rdx2Sq[0]-0.02222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[6], (-0.01721325931647741*kSq[6])-0.03975231959999626*kSq[5]-0.05678902799999467*kSq[4]-0.01333333333333333*kSq[3]+0.03849001794597505*kSq[2]-0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.4444444444444444*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[7], 0.0234254740499978*kSq[5]+0.0234254740499978*kSq[4]+0.01333333333333333*kSq[3]+0.2555555555555555*epsilon[0]*rdx2Sq[1]+0.2555555555555555*epsilon[0]*rdx2Sq[0]-0.03333333333333333*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[0], 0.03442651863295482*kSq[7]+0.0295084445425327*kSq[6]-0.05962847939999439*kSq[5]-0.063887656499994*kSq[4]-0.05333333333333333*kSq[3]+0.06666666666666667*epsilon[0]*rdx2Sq[1]+0.03849001794597505*kSq[1]-0.8888888888888888*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[1], (-0.1967229636168847*kSq[6])-0.07950463919999252*kSq[5]+0.2271561119999787*kSq[4]+0.3079201435678004*kSq[2]+0.5333333333333333*epsilon[0]*rdx2Sq[1]+1.777777777777778*epsilon[0]*rdx2Sq[0]-0.3555555555555556*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[2], (-0.03442651863295482*kSq[7])+0.0295084445425327*kSq[6]-0.05962847939999439*kSq[5]-0.063887656499994*kSq[4]+0.05333333333333333*kSq[3]+0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.03849001794597505*kSq[1]-0.8888888888888888*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[3], (-0.03442651863295482*kSq[7])-0.03442651863295482*kSq[6]+0.09938079899999068*kSq[5]+0.09938079899999068*kSq[4]-0.02666666666666666*kSq[3]+0.0769800358919501*kSq[2]+0.0769800358919501*kSq[1]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[4], 0.03442651863295482*kSq[7]-0.03442651863295482*kSq[6]+0.09938079899999068*kSq[5]+0.09938079899999068*kSq[4]+0.02666666666666666*kSq[3]+0.0769800358919501*kSq[2]-0.0769800358919501*kSq[1]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[5], 0.01721325931647741*kSq[6]-0.03975231959999626*kSq[5]-0.05678902799999467*kSq[4]+0.01333333333333333*kSq[3]-0.03849001794597505*kSq[2]-0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.4444444444444444*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[6], 0.07950463919999252*kSq[5]+0.1135780559999893*kSq[4]-0.5333333333333333*epsilon[0]*rdx2Sq[1]+0.8888888888888888*epsilon[0]*rdx2Sq[0]-0.1777777777777778*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[7], 0.01721325931647741*kSq[6]-0.03975231959999626*kSq[5]-0.05678902799999467*kSq[4]-0.01333333333333333*kSq[3]-0.03849001794597505*kSq[2]-0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.4444444444444444*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[0], (-0.006147592613027645*kSq[6])+0.03336355394999686*kSq[5]+0.02697478829999747*kSq[4]-0.01924500897298752*kSq[2]+0.1888888888888889*epsilon[0]*rdx2Sq[1]+0.3111111111111111*epsilon[0]*rdx2Sq[0]-0.02222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[1], (-0.03442651863295482*kSq[7])+0.0295084445425327*kSq[6]-0.05962847939999439*kSq[5]-0.063887656499994*kSq[4]+0.05333333333333333*kSq[3]+0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.03849001794597505*kSq[1]-0.8888888888888888*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[2], (-0.04549218533640458*kSq[7])+0.04549218533640458*kSq[6]-0.0127775312999988*kSq[5]-0.0127775312999988*kSq[4]+0.04666666666666667*kSq[3]+0.03849001794597505*kSq[2]+0.5777777777777777*epsilon[0]*rdx2Sq[1]-0.03849001794597505*kSq[1]+0.5777777777777777*epsilon[0]*rdx2Sq[0]-0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[3], 0.01721325931647741*kSq[7]-0.05678902799999467*kSq[5]-0.03975231959999626*kSq[4]+0.01333333333333333*kSq[3]-0.4444444444444444*epsilon[0]*rdx2Sq[1]-0.03849001794597505*kSq[1]-0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[4], (-0.0295084445425327*kSq[7])+0.03442651863295482*kSq[6]-0.063887656499994*kSq[5]-0.05962847939999439*kSq[4]+0.05333333333333333*kSq[3]+0.03849001794597505*kSq[2]-0.8888888888888888*epsilon[0]*rdx2Sq[1]+0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[5], 0.0234254740499978*kSq[5]+0.0234254740499978*kSq[4]-0.01333333333333333*kSq[3]+0.2555555555555555*epsilon[0]*rdx2Sq[1]+0.2555555555555555*epsilon[0]*rdx2Sq[0]-0.03333333333333333*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[6], (-0.01721325931647741*kSq[6])-0.03975231959999626*kSq[5]-0.05678902799999467*kSq[4]+0.01333333333333333*kSq[3]+0.03849001794597505*kSq[2]-0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.4444444444444444*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[7], 0.006147592613027645*kSq[7]+0.02697478829999747*kSq[5]+0.03336355394999686*kSq[4]+0.3111111111111111*epsilon[0]*rdx2Sq[1]+0.01924500897298752*kSq[1]+0.1888888888888889*epsilon[0]*rdx2Sq[0]-0.02222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[0], 0.0295084445425327*kSq[7]+0.03442651863295482*kSq[6]-0.063887656499994*kSq[5]-0.05962847939999439*kSq[4]-0.05333333333333333*kSq[3]+0.03849001794597505*kSq[2]-0.8888888888888888*epsilon[0]*rdx2Sq[1]+0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[1], (-0.03442651863295482*kSq[7])-0.03442651863295482*kSq[6]+0.09938079899999068*kSq[5]+0.09938079899999068*kSq[4]-0.02666666666666666*kSq[3]+0.0769800358919501*kSq[2]+0.0769800358919501*kSq[1]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[2], 0.01721325931647741*kSq[7]-0.05678902799999467*kSq[5]-0.03975231959999626*kSq[4]+0.01333333333333333*kSq[3]-0.4444444444444444*epsilon[0]*rdx2Sq[1]-0.03849001794597505*kSq[1]-0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[3], (-0.1967229636168847*kSq[7])+0.2271561119999787*kSq[5]-0.07950463919999252*kSq[4]+1.777777777777778*epsilon[0]*rdx2Sq[1]+0.3079201435678004*kSq[1]+0.5333333333333333*epsilon[0]*rdx2Sq[0]-0.3555555555555556*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[4], 0.1135780559999893*kSq[5]+0.07950463919999252*kSq[4]+0.8888888888888888*epsilon[0]*rdx2Sq[1]-0.5333333333333333*epsilon[0]*rdx2Sq[0]-0.1777777777777778*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[5], 0.0295084445425327*kSq[7]-0.03442651863295482*kSq[6]-0.063887656499994*kSq[5]-0.05962847939999439*kSq[4]+0.05333333333333333*kSq[3]-0.03849001794597505*kSq[2]-0.8888888888888888*epsilon[0]*rdx2Sq[1]+0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[6], (-0.03442651863295482*kSq[7])+0.03442651863295482*kSq[6]+0.09938079899999068*kSq[5]+0.09938079899999068*kSq[4]+0.02666666666666666*kSq[3]-0.0769800358919501*kSq[2]+0.0769800358919501*kSq[1]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[7], 0.01721325931647741*kSq[7]-0.05678902799999467*kSq[5]-0.03975231959999626*kSq[4]-0.01333333333333333*kSq[3]-0.4444444444444444*epsilon[0]*rdx2Sq[1]-0.03849001794597505*kSq[1]-0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[4], globalIdxs[0], (-0.01721325931647741*kSq[7])-0.05678902799999467*kSq[5]-0.03975231959999626*kSq[4]-0.01333333333333333*kSq[3]-0.4444444444444444*epsilon[0]*rdx2Sq[1]+0.03849001794597505*kSq[1]-0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[4], globalIdxs[1], 0.03442651863295482*kSq[7]-0.03442651863295482*kSq[6]+0.09938079899999068*kSq[5]+0.09938079899999068*kSq[4]+0.02666666666666666*kSq[3]+0.0769800358919501*kSq[2]-0.0769800358919501*kSq[1]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[4], globalIdxs[2], (-0.0295084445425327*kSq[7])+0.03442651863295482*kSq[6]-0.063887656499994*kSq[5]-0.05962847939999439*kSq[4]+0.05333333333333333*kSq[3]+0.03849001794597505*kSq[2]-0.8888888888888888*epsilon[0]*rdx2Sq[1]+0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[4], globalIdxs[3], 0.1135780559999893*kSq[5]+0.07950463919999252*kSq[4]+0.8888888888888888*epsilon[0]*rdx2Sq[1]-0.5333333333333333*epsilon[0]*rdx2Sq[0]-0.1777777777777778*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[4], globalIdxs[4], 0.1967229636168847*kSq[7]+0.2271561119999787*kSq[5]-0.07950463919999252*kSq[4]+1.777777777777778*epsilon[0]*rdx2Sq[1]-0.3079201435678004*kSq[1]+0.5333333333333333*epsilon[0]*rdx2Sq[0]-0.3555555555555556*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[4], globalIdxs[5], (-0.01721325931647741*kSq[7])-0.05678902799999467*kSq[5]-0.03975231959999626*kSq[4]+0.01333333333333333*kSq[3]-0.4444444444444444*epsilon[0]*rdx2Sq[1]+0.03849001794597505*kSq[1]-0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[4], globalIdxs[6], 0.03442651863295482*kSq[7]+0.03442651863295482*kSq[6]+0.09938079899999068*kSq[5]+0.09938079899999068*kSq[4]-0.02666666666666666*kSq[3]-0.0769800358919501*kSq[2]-0.0769800358919501*kSq[1]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[4], globalIdxs[7], (-0.0295084445425327*kSq[7])-0.03442651863295482*kSq[6]-0.063887656499994*kSq[5]-0.05962847939999439*kSq[4]-0.05333333333333333*kSq[3]-0.03849001794597505*kSq[2]-0.8888888888888888*epsilon[0]*rdx2Sq[1]+0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[5], globalIdxs[0], (-0.006147592613027645*kSq[7])+0.02697478829999747*kSq[5]+0.03336355394999686*kSq[4]+0.3111111111111111*epsilon[0]*rdx2Sq[1]-0.01924500897298752*kSq[1]+0.1888888888888889*epsilon[0]*rdx2Sq[0]-0.02222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[5], globalIdxs[1], 0.01721325931647741*kSq[6]-0.03975231959999626*kSq[5]-0.05678902799999467*kSq[4]+0.01333333333333333*kSq[3]-0.03849001794597505*kSq[2]-0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.4444444444444444*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[5], globalIdxs[2], 0.0234254740499978*kSq[5]+0.0234254740499978*kSq[4]-0.01333333333333333*kSq[3]+0.2555555555555555*epsilon[0]*rdx2Sq[1]+0.2555555555555555*epsilon[0]*rdx2Sq[0]-0.03333333333333333*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[5], globalIdxs[3], 0.0295084445425327*kSq[7]-0.03442651863295482*kSq[6]-0.063887656499994*kSq[5]-0.05962847939999439*kSq[4]+0.05333333333333333*kSq[3]-0.03849001794597505*kSq[2]-0.8888888888888888*epsilon[0]*rdx2Sq[1]+0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[5], globalIdxs[4], (-0.01721325931647741*kSq[7])-0.05678902799999467*kSq[5]-0.03975231959999626*kSq[4]+0.01333333333333333*kSq[3]-0.4444444444444444*epsilon[0]*rdx2Sq[1]+0.03849001794597505*kSq[1]-0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[5], globalIdxs[5], 0.04549218533640458*kSq[7]-0.04549218533640458*kSq[6]-0.0127775312999988*kSq[5]-0.0127775312999988*kSq[4]+0.04666666666666667*kSq[3]-0.03849001794597505*kSq[2]+0.5777777777777777*epsilon[0]*rdx2Sq[1]+0.03849001794597505*kSq[1]+0.5777777777777777*epsilon[0]*rdx2Sq[0]-0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[5], globalIdxs[6], 0.03442651863295482*kSq[7]-0.0295084445425327*kSq[6]-0.05962847939999439*kSq[5]-0.063887656499994*kSq[4]+0.05333333333333333*kSq[3]+0.06666666666666667*epsilon[0]*rdx2Sq[1]+0.03849001794597505*kSq[1]-0.8888888888888888*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[5], globalIdxs[7], 0.006147592613027645*kSq[6]+0.03336355394999686*kSq[5]+0.02697478829999747*kSq[4]+0.01924500897298752*kSq[2]+0.1888888888888889*epsilon[0]*rdx2Sq[1]+0.3111111111111111*epsilon[0]*rdx2Sq[0]-0.02222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[6], globalIdxs[0], (-0.01721325931647741*kSq[6])-0.03975231959999626*kSq[5]-0.05678902799999467*kSq[4]-0.01333333333333333*kSq[3]+0.03849001794597505*kSq[2]-0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.4444444444444444*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[6], globalIdxs[1], 0.07950463919999252*kSq[5]+0.1135780559999893*kSq[4]-0.5333333333333333*epsilon[0]*rdx2Sq[1]+0.8888888888888888*epsilon[0]*rdx2Sq[0]-0.1777777777777778*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[6], globalIdxs[2], (-0.01721325931647741*kSq[6])-0.03975231959999626*kSq[5]-0.05678902799999467*kSq[4]+0.01333333333333333*kSq[3]+0.03849001794597505*kSq[2]-0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.4444444444444444*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[6], globalIdxs[3], (-0.03442651863295482*kSq[7])+0.03442651863295482*kSq[6]+0.09938079899999068*kSq[5]+0.09938079899999068*kSq[4]+0.02666666666666666*kSq[3]-0.0769800358919501*kSq[2]+0.0769800358919501*kSq[1]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[6], globalIdxs[4], 0.03442651863295482*kSq[7]+0.03442651863295482*kSq[6]+0.09938079899999068*kSq[5]+0.09938079899999068*kSq[4]-0.02666666666666666*kSq[3]-0.0769800358919501*kSq[2]-0.0769800358919501*kSq[1]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[6], globalIdxs[5], 0.03442651863295482*kSq[7]-0.0295084445425327*kSq[6]-0.05962847939999439*kSq[5]-0.063887656499994*kSq[4]+0.05333333333333333*kSq[3]+0.06666666666666667*epsilon[0]*rdx2Sq[1]+0.03849001794597505*kSq[1]-0.8888888888888888*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[6], globalIdxs[6], 0.1967229636168847*kSq[6]-0.07950463919999252*kSq[5]+0.2271561119999787*kSq[4]-0.3079201435678004*kSq[2]+0.5333333333333333*epsilon[0]*rdx2Sq[1]+1.777777777777778*epsilon[0]*rdx2Sq[0]-0.3555555555555556*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[6], globalIdxs[7], (-0.03442651863295482*kSq[7])-0.0295084445425327*kSq[6]-0.05962847939999439*kSq[5]-0.063887656499994*kSq[4]-0.05333333333333333*kSq[3]+0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.03849001794597505*kSq[1]-0.8888888888888888*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[7], globalIdxs[0], 0.0234254740499978*kSq[5]+0.0234254740499978*kSq[4]+0.01333333333333333*kSq[3]+0.2555555555555555*epsilon[0]*rdx2Sq[1]+0.2555555555555555*epsilon[0]*rdx2Sq[0]-0.03333333333333333*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[7], globalIdxs[1], 0.01721325931647741*kSq[6]-0.03975231959999626*kSq[5]-0.05678902799999467*kSq[4]-0.01333333333333333*kSq[3]-0.03849001794597505*kSq[2]-0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.4444444444444444*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[7], globalIdxs[2], 0.006147592613027645*kSq[7]+0.02697478829999747*kSq[5]+0.03336355394999686*kSq[4]+0.3111111111111111*epsilon[0]*rdx2Sq[1]+0.01924500897298752*kSq[1]+0.1888888888888889*epsilon[0]*rdx2Sq[0]-0.02222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[7], globalIdxs[3], 0.01721325931647741*kSq[7]-0.05678902799999467*kSq[5]-0.03975231959999626*kSq[4]-0.01333333333333333*kSq[3]-0.4444444444444444*epsilon[0]*rdx2Sq[1]-0.03849001794597505*kSq[1]-0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[7], globalIdxs[4], (-0.0295084445425327*kSq[7])-0.03442651863295482*kSq[6]-0.063887656499994*kSq[5]-0.05962847939999439*kSq[4]-0.05333333333333333*kSq[3]-0.03849001794597505*kSq[2]-0.8888888888888888*epsilon[0]*rdx2Sq[1]+0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[7], globalIdxs[5], 0.006147592613027645*kSq[6]+0.03336355394999686*kSq[5]+0.02697478829999747*kSq[4]+0.01924500897298752*kSq[2]+0.1888888888888889*epsilon[0]*rdx2Sq[1]+0.3111111111111111*epsilon[0]*rdx2Sq[0]-0.02222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[7], globalIdxs[6], (-0.03442651863295482*kSq[7])-0.0295084445425327*kSq[6]-0.05962847939999439*kSq[5]-0.063887656499994*kSq[4]-0.05333333333333333*kSq[3]+0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.03849001794597505*kSq[1]-0.8888888888888888*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[7], globalIdxs[7], (-0.04549218533640458*kSq[7])-0.04549218533640458*kSq[6]-0.0127775312999988*kSq[5]-0.0127775312999988*kSq[4]-0.04666666666666667*kSq[3]-0.03849001794597505*kSq[2]+0.5777777777777777*epsilon[0]*rdx2Sq[1]-0.03849001794597505*kSq[1]+0.5777777777777777*epsilon[0]*rdx2Sq[0]-0.06666666666666667*kSq[0]);

}
void fem_poisson_lhs_stencil_consteps_2x_ser_p1_upx_neumannx_upy_robiny(const double *epsilon, const double *kSq, const double *dx, const double *bcVals, const long *globalIdxs, gkyl_mat_triples *tri) 
{ 
  // epsilon: permittivity.
  // kSq: wave number squared (factor multiplying phi).
  // dx: cell length in each direction.
  // bcVals[3]: values to impose as BCs, i.e. bcVals[0]*phi+bcVals[1]*d(phi)/dx=bcVals[2].
  // globalIdxs: global linear index of each basis function/node in current cell.
  // tri: triples object (i,j,val), i.e. contribute val to i,j element of the global matrix.

  double rdx2Sq[2];
  rdx2Sq[0] = 4.0/(dx[0]*dx[0]);
  rdx2Sq[1] = 4.0/(dx[1]*dx[1]);

  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[0], (-0.1666666666666667*kSq[3])+0.1924500897298752*kSq[2]+0.3333333333333333*epsilon[0]*rdx2Sq[1]+0.1924500897298752*kSq[1]+0.3333333333333333*epsilon[0]*rdx2Sq[0]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[1], 0.09622504486493762*kSq[2]+0.1666666666666667*epsilon[0]*rdx2Sq[1]-0.3333333333333333*epsilon[0]*rdx2Sq[0]-0.1111111111111111*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[2], (-0.3333333333333333*epsilon[0]*rdx2Sq[1])+0.09622504486493762*kSq[1]+0.1666666666666667*epsilon[0]*rdx2Sq[0]-0.1111111111111111*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[3], (-0.1666666666666667*epsilon[0]*rdx2Sq[1])-0.1666666666666667*epsilon[0]*rdx2Sq[0]-0.05555555555555555*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[0], 0.09622504486493762*kSq[2]+0.1666666666666667*epsilon[0]*rdx2Sq[1]-0.3333333333333333*epsilon[0]*rdx2Sq[0]-0.1111111111111111*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[1], 0.1666666666666667*kSq[3]+0.1924500897298752*kSq[2]+0.3333333333333333*epsilon[0]*rdx2Sq[1]-0.1924500897298752*kSq[1]+0.3333333333333333*epsilon[0]*rdx2Sq[0]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[2], (-0.1666666666666667*epsilon[0]*rdx2Sq[1])-0.1666666666666667*epsilon[0]*rdx2Sq[0]-0.05555555555555555*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[3], (-0.3333333333333333*epsilon[0]*rdx2Sq[1])-0.09622504486493762*kSq[1]+0.1666666666666667*epsilon[0]*rdx2Sq[0]-0.1111111111111111*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[0], (-0.3333333333333333*epsilon[0]*rdx2Sq[1])+0.09622504486493762*kSq[1]+0.1666666666666667*epsilon[0]*rdx2Sq[0]-0.1111111111111111*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[1], (-0.1666666666666667*epsilon[0]*rdx2Sq[1])-0.1666666666666667*epsilon[0]*rdx2Sq[0]-0.05555555555555555*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[2], (0.6666666666666666*epsilon[0]*rdx2Sq[1]*bcVals[9])/bcVals[10]+0.1666666666666667*kSq[3]-0.1924500897298752*kSq[2]+0.3333333333333333*epsilon[0]*rdx2Sq[1]+0.1924500897298752*kSq[1]+0.3333333333333333*epsilon[0]*rdx2Sq[0]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[3], (0.3333333333333333*epsilon[0]*rdx2Sq[1]*bcVals[9])/bcVals[10]-0.09622504486493762*kSq[2]+0.1666666666666667*epsilon[0]*rdx2Sq[1]-0.3333333333333333*epsilon[0]*rdx2Sq[0]-0.1111111111111111*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[0], (-0.1666666666666667*epsilon[0]*rdx2Sq[1])-0.1666666666666667*epsilon[0]*rdx2Sq[0]-0.05555555555555555*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[1], (-0.3333333333333333*epsilon[0]*rdx2Sq[1])-0.09622504486493762*kSq[1]+0.1666666666666667*epsilon[0]*rdx2Sq[0]-0.1111111111111111*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[2], (0.3333333333333333*epsilon[0]*rdx2Sq[1]*bcVals[9])/bcVals[10]-0.09622504486493762*kSq[2]+0.1666666666666667*epsilon[0]*rdx2Sq[1]-0.3333333333333333*epsilon[0]*rdx2Sq[0]-0.1111111111111111*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[3], (0.6666666666666666*epsilon[0]*rdx2Sq[1]*bcVals[9])/bcVals[10]-0.1666666666666667*kSq[3]-0.1924500897298752*kSq[2]+0.3333333333333333*epsilon[0]*rdx2Sq[1]-0.1924500897298752*kSq[1]+0.3333333333333333*epsilon[0]*rdx2Sq[0]-0.2222222222222222*kSq[0]);

}
void fem_poisson_lhs_stencil_consteps_2x_ser_p2_upx_neumannx_upy_robiny(const double *epsilon, const double *kSq, const double *dx, const double *bcVals, const long *globalIdxs, gkyl_mat_triples *tri) 
{ 
  // epsilon: permittivity.
  // kSq: wave number squared (factor multiplying phi).
  // dx: cell length in each direction.
  // bcVals[3]: values to impose as BCs, i.e. bcVals[0]*phi+bcVals[1]*d(phi)/dx=bcVals[2].
  // globalIdxs: global linear index of each basis function/node in current cell.
  // tri: triples object (i,j,val), i.e. contribute val to i,j element of the global matrix.

  double rdx2Sq[2];
  rdx2Sq[0] = 4.0/(dx[0]*dx[0]);
  rdx2Sq[1] = 4.0/(dx[1]*dx[1]);

  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[0], 0.04549218533640458*kSq[7]+0.04549218533640458*kSq[6]-0.0127775312999988*kSq[5]-0.0127775312999988*kSq[4]-0.04666666666666667*kSq[3]+0.03849001794597505*kSq[2]+0.5777777777777777*epsilon[0]*rdx2Sq[1]+0.03849001794597505*kSq[1]+0.5777777777777777*epsilon[0]*rdx2Sq[0]-0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[1], 0.03442651863295482*kSq[7]+0.0295084445425327*kSq[6]-0.05962847939999439*kSq[5]-0.063887656499994*kSq[4]-0.05333333333333333*kSq[3]+0.06666666666666667*epsilon[0]*rdx2Sq[1]+0.03849001794597505*kSq[1]-0.8888888888888888*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[2], (-0.006147592613027645*kSq[6])+0.03336355394999686*kSq[5]+0.02697478829999747*kSq[4]-0.01924500897298752*kSq[2]+0.1888888888888889*epsilon[0]*rdx2Sq[1]+0.3111111111111111*epsilon[0]*rdx2Sq[0]-0.02222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[3], 0.0295084445425327*kSq[7]+0.03442651863295482*kSq[6]-0.063887656499994*kSq[5]-0.05962847939999439*kSq[4]-0.05333333333333333*kSq[3]+0.03849001794597505*kSq[2]-0.8888888888888888*epsilon[0]*rdx2Sq[1]+0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[4], (-0.01721325931647741*kSq[7])-0.05678902799999467*kSq[5]-0.03975231959999626*kSq[4]-0.01333333333333333*kSq[3]-0.4444444444444444*epsilon[0]*rdx2Sq[1]+0.03849001794597505*kSq[1]-0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[5], (-0.006147592613027645*kSq[7])+0.02697478829999747*kSq[5]+0.03336355394999686*kSq[4]+0.3111111111111111*epsilon[0]*rdx2Sq[1]-0.01924500897298752*kSq[1]+0.1888888888888889*epsilon[0]*rdx2Sq[0]-0.02222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[6], (-0.01721325931647741*kSq[6])-0.03975231959999626*kSq[5]-0.05678902799999467*kSq[4]-0.01333333333333333*kSq[3]+0.03849001794597505*kSq[2]-0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.4444444444444444*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[7], 0.0234254740499978*kSq[5]+0.0234254740499978*kSq[4]+0.01333333333333333*kSq[3]+0.2555555555555555*epsilon[0]*rdx2Sq[1]+0.2555555555555555*epsilon[0]*rdx2Sq[0]-0.03333333333333333*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[0], 0.03442651863295482*kSq[7]+0.0295084445425327*kSq[6]-0.05962847939999439*kSq[5]-0.063887656499994*kSq[4]-0.05333333333333333*kSq[3]+0.06666666666666667*epsilon[0]*rdx2Sq[1]+0.03849001794597505*kSq[1]-0.8888888888888888*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[1], (-0.1967229636168847*kSq[6])-0.07950463919999252*kSq[5]+0.2271561119999787*kSq[4]+0.3079201435678004*kSq[2]+0.5333333333333333*epsilon[0]*rdx2Sq[1]+1.777777777777778*epsilon[0]*rdx2Sq[0]-0.3555555555555556*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[2], (-0.03442651863295482*kSq[7])+0.0295084445425327*kSq[6]-0.05962847939999439*kSq[5]-0.063887656499994*kSq[4]+0.05333333333333333*kSq[3]+0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.03849001794597505*kSq[1]-0.8888888888888888*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[3], (-0.03442651863295482*kSq[7])-0.03442651863295482*kSq[6]+0.09938079899999068*kSq[5]+0.09938079899999068*kSq[4]-0.02666666666666666*kSq[3]+0.0769800358919501*kSq[2]+0.0769800358919501*kSq[1]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[4], 0.03442651863295482*kSq[7]-0.03442651863295482*kSq[6]+0.09938079899999068*kSq[5]+0.09938079899999068*kSq[4]+0.02666666666666666*kSq[3]+0.0769800358919501*kSq[2]-0.0769800358919501*kSq[1]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[5], 0.01721325931647741*kSq[6]-0.03975231959999626*kSq[5]-0.05678902799999467*kSq[4]+0.01333333333333333*kSq[3]-0.03849001794597505*kSq[2]-0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.4444444444444444*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[6], 0.07950463919999252*kSq[5]+0.1135780559999893*kSq[4]-0.5333333333333333*epsilon[0]*rdx2Sq[1]+0.8888888888888888*epsilon[0]*rdx2Sq[0]-0.1777777777777778*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[7], 0.01721325931647741*kSq[6]-0.03975231959999626*kSq[5]-0.05678902799999467*kSq[4]-0.01333333333333333*kSq[3]-0.03849001794597505*kSq[2]-0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.4444444444444444*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[0], (-0.006147592613027645*kSq[6])+0.03336355394999686*kSq[5]+0.02697478829999747*kSq[4]-0.01924500897298752*kSq[2]+0.1888888888888889*epsilon[0]*rdx2Sq[1]+0.3111111111111111*epsilon[0]*rdx2Sq[0]-0.02222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[1], (-0.03442651863295482*kSq[7])+0.0295084445425327*kSq[6]-0.05962847939999439*kSq[5]-0.063887656499994*kSq[4]+0.05333333333333333*kSq[3]+0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.03849001794597505*kSq[1]-0.8888888888888888*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[2], (-0.04549218533640458*kSq[7])+0.04549218533640458*kSq[6]-0.0127775312999988*kSq[5]-0.0127775312999988*kSq[4]+0.04666666666666667*kSq[3]+0.03849001794597505*kSq[2]+0.5777777777777777*epsilon[0]*rdx2Sq[1]-0.03849001794597505*kSq[1]+0.5777777777777777*epsilon[0]*rdx2Sq[0]-0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[3], 0.01721325931647741*kSq[7]-0.05678902799999467*kSq[5]-0.03975231959999626*kSq[4]+0.01333333333333333*kSq[3]-0.4444444444444444*epsilon[0]*rdx2Sq[1]-0.03849001794597505*kSq[1]-0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[4], (-0.0295084445425327*kSq[7])+0.03442651863295482*kSq[6]-0.063887656499994*kSq[5]-0.05962847939999439*kSq[4]+0.05333333333333333*kSq[3]+0.03849001794597505*kSq[2]-0.8888888888888888*epsilon[0]*rdx2Sq[1]+0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[5], 0.0234254740499978*kSq[5]+0.0234254740499978*kSq[4]-0.01333333333333333*kSq[3]+0.2555555555555555*epsilon[0]*rdx2Sq[1]+0.2555555555555555*epsilon[0]*rdx2Sq[0]-0.03333333333333333*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[6], (-0.01721325931647741*kSq[6])-0.03975231959999626*kSq[5]-0.05678902799999467*kSq[4]+0.01333333333333333*kSq[3]+0.03849001794597505*kSq[2]-0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.4444444444444444*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[7], 0.006147592613027645*kSq[7]+0.02697478829999747*kSq[5]+0.03336355394999686*kSq[4]+0.3111111111111111*epsilon[0]*rdx2Sq[1]+0.01924500897298752*kSq[1]+0.1888888888888889*epsilon[0]*rdx2Sq[0]-0.02222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[0], 0.0295084445425327*kSq[7]+0.03442651863295482*kSq[6]-0.063887656499994*kSq[5]-0.05962847939999439*kSq[4]-0.05333333333333333*kSq[3]+0.03849001794597505*kSq[2]-0.8888888888888888*epsilon[0]*rdx2Sq[1]+0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[1], (-0.03442651863295482*kSq[7])-0.03442651863295482*kSq[6]+0.09938079899999068*kSq[5]+0.09938079899999068*kSq[4]-0.02666666666666666*kSq[3]+0.0769800358919501*kSq[2]+0.0769800358919501*kSq[1]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[2], 0.01721325931647741*kSq[7]-0.05678902799999467*kSq[5]-0.03975231959999626*kSq[4]+0.01333333333333333*kSq[3]-0.4444444444444444*epsilon[0]*rdx2Sq[1]-0.03849001794597505*kSq[1]-0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[3], (-0.1967229636168847*kSq[7])+0.2271561119999787*kSq[5]-0.07950463919999252*kSq[4]+1.777777777777778*epsilon[0]*rdx2Sq[1]+0.3079201435678004*kSq[1]+0.5333333333333333*epsilon[0]*rdx2Sq[0]-0.3555555555555556*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[4], 0.1135780559999893*kSq[5]+0.07950463919999252*kSq[4]+0.8888888888888888*epsilon[0]*rdx2Sq[1]-0.5333333333333333*epsilon[0]*rdx2Sq[0]-0.1777777777777778*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[5], 0.0295084445425327*kSq[7]-0.03442651863295482*kSq[6]-0.063887656499994*kSq[5]-0.05962847939999439*kSq[4]+0.05333333333333333*kSq[3]-0.03849001794597505*kSq[2]-0.8888888888888888*epsilon[0]*rdx2Sq[1]+0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[6], (-0.03442651863295482*kSq[7])+0.03442651863295482*kSq[6]+0.09938079899999068*kSq[5]+0.09938079899999068*kSq[4]+0.02666666666666666*kSq[3]-0.0769800358919501*kSq[2]+0.0769800358919501*kSq[1]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[7], 0.01721325931647741*kSq[7]-0.05678902799999467*kSq[5]-0.03975231959999626*kSq[4]-0.01333333333333333*kSq[3]-0.4444444444444444*epsilon[0]*rdx2Sq[1]-0.03849001794597505*kSq[1]-0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[4], globalIdxs[0], (-0.01721325931647741*kSq[7])-0.05678902799999467*kSq[5]-0.03975231959999626*kSq[4]-0.01333333333333333*kSq[3]-0.4444444444444444*epsilon[0]*rdx2Sq[1]+0.03849001794597505*kSq[1]-0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[4], globalIdxs[1], 0.03442651863295482*kSq[7]-0.03442651863295482*kSq[6]+0.09938079899999068*kSq[5]+0.09938079899999068*kSq[4]+0.02666666666666666*kSq[3]+0.0769800358919501*kSq[2]-0.0769800358919501*kSq[1]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[4], globalIdxs[2], (-0.0295084445425327*kSq[7])+0.03442651863295482*kSq[6]-0.063887656499994*kSq[5]-0.05962847939999439*kSq[4]+0.05333333333333333*kSq[3]+0.03849001794597505*kSq[2]-0.8888888888888888*epsilon[0]*rdx2Sq[1]+0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[4], globalIdxs[3], 0.1135780559999893*kSq[5]+0.07950463919999252*kSq[4]+0.8888888888888888*epsilon[0]*rdx2Sq[1]-0.5333333333333333*epsilon[0]*rdx2Sq[0]-0.1777777777777778*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[4], globalIdxs[4], 0.1967229636168847*kSq[7]+0.2271561119999787*kSq[5]-0.07950463919999252*kSq[4]+1.777777777777778*epsilon[0]*rdx2Sq[1]-0.3079201435678004*kSq[1]+0.5333333333333333*epsilon[0]*rdx2Sq[0]-0.3555555555555556*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[4], globalIdxs[5], (-0.01721325931647741*kSq[7])-0.05678902799999467*kSq[5]-0.03975231959999626*kSq[4]+0.01333333333333333*kSq[3]-0.4444444444444444*epsilon[0]*rdx2Sq[1]+0.03849001794597505*kSq[1]-0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[4], globalIdxs[6], 0.03442651863295482*kSq[7]+0.03442651863295482*kSq[6]+0.09938079899999068*kSq[5]+0.09938079899999068*kSq[4]-0.02666666666666666*kSq[3]-0.0769800358919501*kSq[2]-0.0769800358919501*kSq[1]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[4], globalIdxs[7], (-0.0295084445425327*kSq[7])-0.03442651863295482*kSq[6]-0.063887656499994*kSq[5]-0.05962847939999439*kSq[4]-0.05333333333333333*kSq[3]-0.03849001794597505*kSq[2]-0.8888888888888888*epsilon[0]*rdx2Sq[1]+0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[5], globalIdxs[0], (-0.006147592613027645*kSq[7])+0.02697478829999747*kSq[5]+0.03336355394999686*kSq[4]+0.3111111111111111*epsilon[0]*rdx2Sq[1]-0.01924500897298752*kSq[1]+0.1888888888888889*epsilon[0]*rdx2Sq[0]-0.02222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[5], globalIdxs[1], 0.01721325931647741*kSq[6]-0.03975231959999626*kSq[5]-0.05678902799999467*kSq[4]+0.01333333333333333*kSq[3]-0.03849001794597505*kSq[2]-0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.4444444444444444*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[5], globalIdxs[2], 0.0234254740499978*kSq[5]+0.0234254740499978*kSq[4]-0.01333333333333333*kSq[3]+0.2555555555555555*epsilon[0]*rdx2Sq[1]+0.2555555555555555*epsilon[0]*rdx2Sq[0]-0.03333333333333333*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[5], globalIdxs[3], 0.0295084445425327*kSq[7]-0.03442651863295482*kSq[6]-0.063887656499994*kSq[5]-0.05962847939999439*kSq[4]+0.05333333333333333*kSq[3]-0.03849001794597505*kSq[2]-0.8888888888888888*epsilon[0]*rdx2Sq[1]+0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[5], globalIdxs[4], (-0.01721325931647741*kSq[7])-0.05678902799999467*kSq[5]-0.03975231959999626*kSq[4]+0.01333333333333333*kSq[3]-0.4444444444444444*epsilon[0]*rdx2Sq[1]+0.03849001794597505*kSq[1]-0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[5], globalIdxs[5], (0.2666666666666667*epsilon[0]*rdx2Sq[1]*bcVals[9])/bcVals[10]+0.04549218533640458*kSq[7]-0.04549218533640458*kSq[6]-0.0127775312999988*kSq[5]-0.0127775312999988*kSq[4]+0.04666666666666667*kSq[3]-0.03849001794597505*kSq[2]+0.5777777777777777*epsilon[0]*rdx2Sq[1]+0.03849001794597505*kSq[1]+0.5777777777777777*epsilon[0]*rdx2Sq[0]-0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[5], globalIdxs[6], (0.1333333333333333*epsilon[0]*rdx2Sq[1]*bcVals[9])/bcVals[10]+0.03442651863295482*kSq[7]-0.0295084445425327*kSq[6]-0.05962847939999439*kSq[5]-0.063887656499994*kSq[4]+0.05333333333333333*kSq[3]+0.06666666666666667*epsilon[0]*rdx2Sq[1]+0.03849001794597505*kSq[1]-0.8888888888888888*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[5], globalIdxs[7], (-(0.06666666666666667*epsilon[0]*rdx2Sq[1]*bcVals[9])/bcVals[10])+0.006147592613027645*kSq[6]+0.03336355394999686*kSq[5]+0.02697478829999747*kSq[4]+0.01924500897298752*kSq[2]+0.1888888888888889*epsilon[0]*rdx2Sq[1]+0.3111111111111111*epsilon[0]*rdx2Sq[0]-0.02222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[6], globalIdxs[0], (-0.01721325931647741*kSq[6])-0.03975231959999626*kSq[5]-0.05678902799999467*kSq[4]-0.01333333333333333*kSq[3]+0.03849001794597505*kSq[2]-0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.4444444444444444*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[6], globalIdxs[1], 0.07950463919999252*kSq[5]+0.1135780559999893*kSq[4]-0.5333333333333333*epsilon[0]*rdx2Sq[1]+0.8888888888888888*epsilon[0]*rdx2Sq[0]-0.1777777777777778*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[6], globalIdxs[2], (-0.01721325931647741*kSq[6])-0.03975231959999626*kSq[5]-0.05678902799999467*kSq[4]+0.01333333333333333*kSq[3]+0.03849001794597505*kSq[2]-0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.4444444444444444*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[6], globalIdxs[3], (-0.03442651863295482*kSq[7])+0.03442651863295482*kSq[6]+0.09938079899999068*kSq[5]+0.09938079899999068*kSq[4]+0.02666666666666666*kSq[3]-0.0769800358919501*kSq[2]+0.0769800358919501*kSq[1]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[6], globalIdxs[4], 0.03442651863295482*kSq[7]+0.03442651863295482*kSq[6]+0.09938079899999068*kSq[5]+0.09938079899999068*kSq[4]-0.02666666666666666*kSq[3]-0.0769800358919501*kSq[2]-0.0769800358919501*kSq[1]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[6], globalIdxs[5], (0.1333333333333333*epsilon[0]*rdx2Sq[1]*bcVals[9])/bcVals[10]+0.03442651863295482*kSq[7]-0.0295084445425327*kSq[6]-0.05962847939999439*kSq[5]-0.063887656499994*kSq[4]+0.05333333333333333*kSq[3]+0.06666666666666667*epsilon[0]*rdx2Sq[1]+0.03849001794597505*kSq[1]-0.8888888888888888*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[6], globalIdxs[6], (1.066666666666667*epsilon[0]*rdx2Sq[1]*bcVals[9])/bcVals[10]+0.1967229636168847*kSq[6]-0.07950463919999252*kSq[5]+0.2271561119999787*kSq[4]-0.3079201435678004*kSq[2]+0.5333333333333333*epsilon[0]*rdx2Sq[1]+1.777777777777778*epsilon[0]*rdx2Sq[0]-0.3555555555555556*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[6], globalIdxs[7], (0.1333333333333333*epsilon[0]*rdx2Sq[1]*bcVals[9])/bcVals[10]-0.03442651863295482*kSq[7]-0.0295084445425327*kSq[6]-0.05962847939999439*kSq[5]-0.063887656499994*kSq[4]-0.05333333333333333*kSq[3]+0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.03849001794597505*kSq[1]-0.8888888888888888*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[7], globalIdxs[0], 0.0234254740499978*kSq[5]+0.0234254740499978*kSq[4]+0.01333333333333333*kSq[3]+0.2555555555555555*epsilon[0]*rdx2Sq[1]+0.2555555555555555*epsilon[0]*rdx2Sq[0]-0.03333333333333333*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[7], globalIdxs[1], 0.01721325931647741*kSq[6]-0.03975231959999626*kSq[5]-0.05678902799999467*kSq[4]-0.01333333333333333*kSq[3]-0.03849001794597505*kSq[2]-0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.4444444444444444*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[7], globalIdxs[2], 0.006147592613027645*kSq[7]+0.02697478829999747*kSq[5]+0.03336355394999686*kSq[4]+0.3111111111111111*epsilon[0]*rdx2Sq[1]+0.01924500897298752*kSq[1]+0.1888888888888889*epsilon[0]*rdx2Sq[0]-0.02222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[7], globalIdxs[3], 0.01721325931647741*kSq[7]-0.05678902799999467*kSq[5]-0.03975231959999626*kSq[4]-0.01333333333333333*kSq[3]-0.4444444444444444*epsilon[0]*rdx2Sq[1]-0.03849001794597505*kSq[1]-0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[7], globalIdxs[4], (-0.0295084445425327*kSq[7])-0.03442651863295482*kSq[6]-0.063887656499994*kSq[5]-0.05962847939999439*kSq[4]-0.05333333333333333*kSq[3]-0.03849001794597505*kSq[2]-0.8888888888888888*epsilon[0]*rdx2Sq[1]+0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[7], globalIdxs[5], (-(0.06666666666666667*epsilon[0]*rdx2Sq[1]*bcVals[9])/bcVals[10])+0.006147592613027645*kSq[6]+0.03336355394999686*kSq[5]+0.02697478829999747*kSq[4]+0.01924500897298752*kSq[2]+0.1888888888888889*epsilon[0]*rdx2Sq[1]+0.3111111111111111*epsilon[0]*rdx2Sq[0]-0.02222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[7], globalIdxs[6], (0.1333333333333333*epsilon[0]*rdx2Sq[1]*bcVals[9])/bcVals[10]-0.03442651863295482*kSq[7]-0.0295084445425327*kSq[6]-0.05962847939999439*kSq[5]-0.063887656499994*kSq[4]-0.05333333333333333*kSq[3]+0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.03849001794597505*kSq[1]-0.8888888888888888*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[7], globalIdxs[7], (0.2666666666666667*epsilon[0]*rdx2Sq[1]*bcVals[9])/bcVals[10]-0.04549218533640458*kSq[7]-0.04549218533640458*kSq[6]-0.0127775312999988*kSq[5]-0.0127775312999988*kSq[4]-0.04666666666666667*kSq[3]-0.03849001794597505*kSq[2]+0.5777777777777777*epsilon[0]*rdx2Sq[1]-0.03849001794597505*kSq[1]+0.5777777777777777*epsilon[0]*rdx2Sq[0]-0.06666666666666667*kSq[0]);

}
void fem_poisson_lhs_stencil_consteps_2x_ser_p1_upx_robinx_upy_periodicy(const double *epsilon, const double *kSq, const double *dx, const double *bcVals, const long *globalIdxs, gkyl_mat_triples *tri) 
{ 
  // epsilon: permittivity.
  // kSq: wave number squared (factor multiplying phi).
  // dx: cell length in each direction.
  // bcVals[3]: values to impose as BCs, i.e. bcVals[0]*phi+bcVals[1]*d(phi)/dx=bcVals[2].
  // globalIdxs: global linear index of each basis function/node in current cell.
  // tri: triples object (i,j,val), i.e. contribute val to i,j element of the global matrix.

  double rdx2Sq[2];
  rdx2Sq[0] = 4.0/(dx[0]*dx[0]);
  rdx2Sq[1] = 4.0/(dx[1]*dx[1]);

  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[0], (-0.1666666666666667*kSq[3])+0.1924500897298752*kSq[2]+0.3333333333333333*epsilon[0]*rdx2Sq[1]+0.1924500897298752*kSq[1]+0.3333333333333333*epsilon[0]*rdx2Sq[0]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[1], 0.09622504486493762*kSq[2]+0.1666666666666667*epsilon[0]*rdx2Sq[1]-0.3333333333333333*epsilon[0]*rdx2Sq[0]-0.1111111111111111*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[2], (-0.3333333333333333*epsilon[0]*rdx2Sq[1])+0.09622504486493762*kSq[1]+0.1666666666666667*epsilon[0]*rdx2Sq[0]-0.1111111111111111*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[3], (-0.1666666666666667*epsilon[0]*rdx2Sq[1])-0.1666666666666667*epsilon[0]*rdx2Sq[0]-0.05555555555555555*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[0], 0.09622504486493762*kSq[2]+0.1666666666666667*epsilon[0]*rdx2Sq[1]-0.3333333333333333*epsilon[0]*rdx2Sq[0]-0.1111111111111111*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[1], (0.6666666666666666*epsilon[0]*rdx2Sq[0]*bcVals[3])/bcVals[4]+0.1666666666666667*kSq[3]+0.1924500897298752*kSq[2]+0.3333333333333333*epsilon[0]*rdx2Sq[1]-0.1924500897298752*kSq[1]+0.3333333333333333*epsilon[0]*rdx2Sq[0]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[2], (-0.1666666666666667*epsilon[0]*rdx2Sq[1])-0.1666666666666667*epsilon[0]*rdx2Sq[0]-0.05555555555555555*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[3], (0.3333333333333333*epsilon[0]*rdx2Sq[0]*bcVals[3])/bcVals[4]-0.3333333333333333*epsilon[0]*rdx2Sq[1]-0.09622504486493762*kSq[1]+0.1666666666666667*epsilon[0]*rdx2Sq[0]-0.1111111111111111*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[0], (-0.3333333333333333*epsilon[0]*rdx2Sq[1])+0.09622504486493762*kSq[1]+0.1666666666666667*epsilon[0]*rdx2Sq[0]-0.1111111111111111*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[1], (-0.1666666666666667*epsilon[0]*rdx2Sq[1])-0.1666666666666667*epsilon[0]*rdx2Sq[0]-0.05555555555555555*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[2], 0.1666666666666667*kSq[3]-0.1924500897298752*kSq[2]+0.3333333333333333*epsilon[0]*rdx2Sq[1]+0.1924500897298752*kSq[1]+0.3333333333333333*epsilon[0]*rdx2Sq[0]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[3], (-0.09622504486493762*kSq[2])+0.1666666666666667*epsilon[0]*rdx2Sq[1]-0.3333333333333333*epsilon[0]*rdx2Sq[0]-0.1111111111111111*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[0], (-0.1666666666666667*epsilon[0]*rdx2Sq[1])-0.1666666666666667*epsilon[0]*rdx2Sq[0]-0.05555555555555555*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[1], (0.3333333333333333*epsilon[0]*rdx2Sq[0]*bcVals[3])/bcVals[4]-0.3333333333333333*epsilon[0]*rdx2Sq[1]-0.09622504486493762*kSq[1]+0.1666666666666667*epsilon[0]*rdx2Sq[0]-0.1111111111111111*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[2], (-0.09622504486493762*kSq[2])+0.1666666666666667*epsilon[0]*rdx2Sq[1]-0.3333333333333333*epsilon[0]*rdx2Sq[0]-0.1111111111111111*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[3], (0.6666666666666666*epsilon[0]*rdx2Sq[0]*bcVals[3])/bcVals[4]-0.1666666666666667*kSq[3]-0.1924500897298752*kSq[2]+0.3333333333333333*epsilon[0]*rdx2Sq[1]-0.1924500897298752*kSq[1]+0.3333333333333333*epsilon[0]*rdx2Sq[0]-0.2222222222222222*kSq[0]);

}
void fem_poisson_lhs_stencil_consteps_2x_ser_p2_upx_robinx_upy_periodicy(const double *epsilon, const double *kSq, const double *dx, const double *bcVals, const long *globalIdxs, gkyl_mat_triples *tri) 
{ 
  // epsilon: permittivity.
  // kSq: wave number squared (factor multiplying phi).
  // dx: cell length in each direction.
  // bcVals[3]: values to impose as BCs, i.e. bcVals[0]*phi+bcVals[1]*d(phi)/dx=bcVals[2].
  // globalIdxs: global linear index of each basis function/node in current cell.
  // tri: triples object (i,j,val), i.e. contribute val to i,j element of the global matrix.

  double rdx2Sq[2];
  rdx2Sq[0] = 4.0/(dx[0]*dx[0]);
  rdx2Sq[1] = 4.0/(dx[1]*dx[1]);

  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[0], 0.04549218533640458*kSq[7]+0.04549218533640458*kSq[6]-0.0127775312999988*kSq[5]-0.0127775312999988*kSq[4]-0.04666666666666667*kSq[3]+0.03849001794597505*kSq[2]+0.5777777777777777*epsilon[0]*rdx2Sq[1]+0.03849001794597505*kSq[1]+0.5777777777777777*epsilon[0]*rdx2Sq[0]-0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[1], 0.03442651863295482*kSq[7]+0.0295084445425327*kSq[6]-0.05962847939999439*kSq[5]-0.063887656499994*kSq[4]-0.05333333333333333*kSq[3]+0.06666666666666667*epsilon[0]*rdx2Sq[1]+0.03849001794597505*kSq[1]-0.8888888888888888*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[2], (-0.006147592613027645*kSq[6])+0.03336355394999686*kSq[5]+0.02697478829999747*kSq[4]-0.01924500897298752*kSq[2]+0.1888888888888889*epsilon[0]*rdx2Sq[1]+0.3111111111111111*epsilon[0]*rdx2Sq[0]-0.02222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[3], 0.0295084445425327*kSq[7]+0.03442651863295482*kSq[6]-0.063887656499994*kSq[5]-0.05962847939999439*kSq[4]-0.05333333333333333*kSq[3]+0.03849001794597505*kSq[2]-0.8888888888888888*epsilon[0]*rdx2Sq[1]+0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[4], (-0.01721325931647741*kSq[7])-0.05678902799999467*kSq[5]-0.03975231959999626*kSq[4]-0.01333333333333333*kSq[3]-0.4444444444444444*epsilon[0]*rdx2Sq[1]+0.03849001794597505*kSq[1]-0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[5], (-0.006147592613027645*kSq[7])+0.02697478829999747*kSq[5]+0.03336355394999686*kSq[4]+0.3111111111111111*epsilon[0]*rdx2Sq[1]-0.01924500897298752*kSq[1]+0.1888888888888889*epsilon[0]*rdx2Sq[0]-0.02222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[6], (-0.01721325931647741*kSq[6])-0.03975231959999626*kSq[5]-0.05678902799999467*kSq[4]-0.01333333333333333*kSq[3]+0.03849001794597505*kSq[2]-0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.4444444444444444*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[7], 0.0234254740499978*kSq[5]+0.0234254740499978*kSq[4]+0.01333333333333333*kSq[3]+0.2555555555555555*epsilon[0]*rdx2Sq[1]+0.2555555555555555*epsilon[0]*rdx2Sq[0]-0.03333333333333333*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[0], 0.03442651863295482*kSq[7]+0.0295084445425327*kSq[6]-0.05962847939999439*kSq[5]-0.063887656499994*kSq[4]-0.05333333333333333*kSq[3]+0.06666666666666667*epsilon[0]*rdx2Sq[1]+0.03849001794597505*kSq[1]-0.8888888888888888*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[1], (-0.1967229636168847*kSq[6])-0.07950463919999252*kSq[5]+0.2271561119999787*kSq[4]+0.3079201435678004*kSq[2]+0.5333333333333333*epsilon[0]*rdx2Sq[1]+1.777777777777778*epsilon[0]*rdx2Sq[0]-0.3555555555555556*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[2], (-0.03442651863295482*kSq[7])+0.0295084445425327*kSq[6]-0.05962847939999439*kSq[5]-0.063887656499994*kSq[4]+0.05333333333333333*kSq[3]+0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.03849001794597505*kSq[1]-0.8888888888888888*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[3], (-0.03442651863295482*kSq[7])-0.03442651863295482*kSq[6]+0.09938079899999068*kSq[5]+0.09938079899999068*kSq[4]-0.02666666666666666*kSq[3]+0.0769800358919501*kSq[2]+0.0769800358919501*kSq[1]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[4], 0.03442651863295482*kSq[7]-0.03442651863295482*kSq[6]+0.09938079899999068*kSq[5]+0.09938079899999068*kSq[4]+0.02666666666666666*kSq[3]+0.0769800358919501*kSq[2]-0.0769800358919501*kSq[1]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[5], 0.01721325931647741*kSq[6]-0.03975231959999626*kSq[5]-0.05678902799999467*kSq[4]+0.01333333333333333*kSq[3]-0.03849001794597505*kSq[2]-0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.4444444444444444*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[6], 0.07950463919999252*kSq[5]+0.1135780559999893*kSq[4]-0.5333333333333333*epsilon[0]*rdx2Sq[1]+0.8888888888888888*epsilon[0]*rdx2Sq[0]-0.1777777777777778*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[7], 0.01721325931647741*kSq[6]-0.03975231959999626*kSq[5]-0.05678902799999467*kSq[4]-0.01333333333333333*kSq[3]-0.03849001794597505*kSq[2]-0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.4444444444444444*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[0], (-0.006147592613027645*kSq[6])+0.03336355394999686*kSq[5]+0.02697478829999747*kSq[4]-0.01924500897298752*kSq[2]+0.1888888888888889*epsilon[0]*rdx2Sq[1]+0.3111111111111111*epsilon[0]*rdx2Sq[0]-0.02222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[1], (-0.03442651863295482*kSq[7])+0.0295084445425327*kSq[6]-0.05962847939999439*kSq[5]-0.063887656499994*kSq[4]+0.05333333333333333*kSq[3]+0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.03849001794597505*kSq[1]-0.8888888888888888*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[2], (-0.04549218533640458*kSq[7])+0.04549218533640458*kSq[6]-0.0127775312999988*kSq[5]-0.0127775312999988*kSq[4]+(0.2666666666666667*epsilon[0]*rdx2Sq[0]*bcVals[3])/bcVals[4]+0.04666666666666667*kSq[3]+0.03849001794597505*kSq[2]+0.5777777777777777*epsilon[0]*rdx2Sq[1]-0.03849001794597505*kSq[1]+0.5777777777777777*epsilon[0]*rdx2Sq[0]-0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[3], 0.01721325931647741*kSq[7]-0.05678902799999467*kSq[5]-0.03975231959999626*kSq[4]+0.01333333333333333*kSq[3]-0.4444444444444444*epsilon[0]*rdx2Sq[1]-0.03849001794597505*kSq[1]-0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[4], (-0.0295084445425327*kSq[7])+0.03442651863295482*kSq[6]-0.063887656499994*kSq[5]-0.05962847939999439*kSq[4]+(0.1333333333333333*epsilon[0]*rdx2Sq[0]*bcVals[3])/bcVals[4]+0.05333333333333333*kSq[3]+0.03849001794597505*kSq[2]-0.8888888888888888*epsilon[0]*rdx2Sq[1]+0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[5], 0.0234254740499978*kSq[5]+0.0234254740499978*kSq[4]-0.01333333333333333*kSq[3]+0.2555555555555555*epsilon[0]*rdx2Sq[1]+0.2555555555555555*epsilon[0]*rdx2Sq[0]-0.03333333333333333*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[6], (-0.01721325931647741*kSq[6])-0.03975231959999626*kSq[5]-0.05678902799999467*kSq[4]+0.01333333333333333*kSq[3]+0.03849001794597505*kSq[2]-0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.4444444444444444*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[7], 0.006147592613027645*kSq[7]+0.02697478829999747*kSq[5]+0.03336355394999686*kSq[4]-(0.06666666666666667*epsilon[0]*rdx2Sq[0]*bcVals[3])/bcVals[4]+0.3111111111111111*epsilon[0]*rdx2Sq[1]+0.01924500897298752*kSq[1]+0.1888888888888889*epsilon[0]*rdx2Sq[0]-0.02222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[0], 0.0295084445425327*kSq[7]+0.03442651863295482*kSq[6]-0.063887656499994*kSq[5]-0.05962847939999439*kSq[4]-0.05333333333333333*kSq[3]+0.03849001794597505*kSq[2]-0.8888888888888888*epsilon[0]*rdx2Sq[1]+0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[1], (-0.03442651863295482*kSq[7])-0.03442651863295482*kSq[6]+0.09938079899999068*kSq[5]+0.09938079899999068*kSq[4]-0.02666666666666666*kSq[3]+0.0769800358919501*kSq[2]+0.0769800358919501*kSq[1]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[2], 0.01721325931647741*kSq[7]-0.05678902799999467*kSq[5]-0.03975231959999626*kSq[4]+0.01333333333333333*kSq[3]-0.4444444444444444*epsilon[0]*rdx2Sq[1]-0.03849001794597505*kSq[1]-0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[3], (-0.1967229636168847*kSq[7])+0.2271561119999787*kSq[5]-0.07950463919999252*kSq[4]+1.777777777777778*epsilon[0]*rdx2Sq[1]+0.3079201435678004*kSq[1]+0.5333333333333333*epsilon[0]*rdx2Sq[0]-0.3555555555555556*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[4], 0.1135780559999893*kSq[5]+0.07950463919999252*kSq[4]+0.8888888888888888*epsilon[0]*rdx2Sq[1]-0.5333333333333333*epsilon[0]*rdx2Sq[0]-0.1777777777777778*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[5], 0.0295084445425327*kSq[7]-0.03442651863295482*kSq[6]-0.063887656499994*kSq[5]-0.05962847939999439*kSq[4]+0.05333333333333333*kSq[3]-0.03849001794597505*kSq[2]-0.8888888888888888*epsilon[0]*rdx2Sq[1]+0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[6], (-0.03442651863295482*kSq[7])+0.03442651863295482*kSq[6]+0.09938079899999068*kSq[5]+0.09938079899999068*kSq[4]+0.02666666666666666*kSq[3]-0.0769800358919501*kSq[2]+0.0769800358919501*kSq[1]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[7], 0.01721325931647741*kSq[7]-0.05678902799999467*kSq[5]-0.03975231959999626*kSq[4]-0.01333333333333333*kSq[3]-0.4444444444444444*epsilon[0]*rdx2Sq[1]-0.03849001794597505*kSq[1]-0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[4], globalIdxs[0], (-0.01721325931647741*kSq[7])-0.05678902799999467*kSq[5]-0.03975231959999626*kSq[4]-0.01333333333333333*kSq[3]-0.4444444444444444*epsilon[0]*rdx2Sq[1]+0.03849001794597505*kSq[1]-0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[4], globalIdxs[1], 0.03442651863295482*kSq[7]-0.03442651863295482*kSq[6]+0.09938079899999068*kSq[5]+0.09938079899999068*kSq[4]+0.02666666666666666*kSq[3]+0.0769800358919501*kSq[2]-0.0769800358919501*kSq[1]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[4], globalIdxs[2], (-0.0295084445425327*kSq[7])+0.03442651863295482*kSq[6]-0.063887656499994*kSq[5]-0.05962847939999439*kSq[4]+(0.1333333333333333*epsilon[0]*rdx2Sq[0]*bcVals[3])/bcVals[4]+0.05333333333333333*kSq[3]+0.03849001794597505*kSq[2]-0.8888888888888888*epsilon[0]*rdx2Sq[1]+0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[4], globalIdxs[3], 0.1135780559999893*kSq[5]+0.07950463919999252*kSq[4]+0.8888888888888888*epsilon[0]*rdx2Sq[1]-0.5333333333333333*epsilon[0]*rdx2Sq[0]-0.1777777777777778*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[4], globalIdxs[4], 0.1967229636168847*kSq[7]+0.2271561119999787*kSq[5]-0.07950463919999252*kSq[4]+(1.066666666666667*epsilon[0]*rdx2Sq[0]*bcVals[3])/bcVals[4]+1.777777777777778*epsilon[0]*rdx2Sq[1]-0.3079201435678004*kSq[1]+0.5333333333333333*epsilon[0]*rdx2Sq[0]-0.3555555555555556*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[4], globalIdxs[5], (-0.01721325931647741*kSq[7])-0.05678902799999467*kSq[5]-0.03975231959999626*kSq[4]+0.01333333333333333*kSq[3]-0.4444444444444444*epsilon[0]*rdx2Sq[1]+0.03849001794597505*kSq[1]-0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[4], globalIdxs[6], 0.03442651863295482*kSq[7]+0.03442651863295482*kSq[6]+0.09938079899999068*kSq[5]+0.09938079899999068*kSq[4]-0.02666666666666666*kSq[3]-0.0769800358919501*kSq[2]-0.0769800358919501*kSq[1]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[4], globalIdxs[7], (-0.0295084445425327*kSq[7])-0.03442651863295482*kSq[6]-0.063887656499994*kSq[5]-0.05962847939999439*kSq[4]+(0.1333333333333333*epsilon[0]*rdx2Sq[0]*bcVals[3])/bcVals[4]-0.05333333333333333*kSq[3]-0.03849001794597505*kSq[2]-0.8888888888888888*epsilon[0]*rdx2Sq[1]+0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[5], globalIdxs[0], (-0.006147592613027645*kSq[7])+0.02697478829999747*kSq[5]+0.03336355394999686*kSq[4]+0.3111111111111111*epsilon[0]*rdx2Sq[1]-0.01924500897298752*kSq[1]+0.1888888888888889*epsilon[0]*rdx2Sq[0]-0.02222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[5], globalIdxs[1], 0.01721325931647741*kSq[6]-0.03975231959999626*kSq[5]-0.05678902799999467*kSq[4]+0.01333333333333333*kSq[3]-0.03849001794597505*kSq[2]-0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.4444444444444444*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[5], globalIdxs[2], 0.0234254740499978*kSq[5]+0.0234254740499978*kSq[4]-0.01333333333333333*kSq[3]+0.2555555555555555*epsilon[0]*rdx2Sq[1]+0.2555555555555555*epsilon[0]*rdx2Sq[0]-0.03333333333333333*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[5], globalIdxs[3], 0.0295084445425327*kSq[7]-0.03442651863295482*kSq[6]-0.063887656499994*kSq[5]-0.05962847939999439*kSq[4]+0.05333333333333333*kSq[3]-0.03849001794597505*kSq[2]-0.8888888888888888*epsilon[0]*rdx2Sq[1]+0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[5], globalIdxs[4], (-0.01721325931647741*kSq[7])-0.05678902799999467*kSq[5]-0.03975231959999626*kSq[4]+0.01333333333333333*kSq[3]-0.4444444444444444*epsilon[0]*rdx2Sq[1]+0.03849001794597505*kSq[1]-0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[5], globalIdxs[5], 0.04549218533640458*kSq[7]-0.04549218533640458*kSq[6]-0.0127775312999988*kSq[5]-0.0127775312999988*kSq[4]+0.04666666666666667*kSq[3]-0.03849001794597505*kSq[2]+0.5777777777777777*epsilon[0]*rdx2Sq[1]+0.03849001794597505*kSq[1]+0.5777777777777777*epsilon[0]*rdx2Sq[0]-0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[5], globalIdxs[6], 0.03442651863295482*kSq[7]-0.0295084445425327*kSq[6]-0.05962847939999439*kSq[5]-0.063887656499994*kSq[4]+0.05333333333333333*kSq[3]+0.06666666666666667*epsilon[0]*rdx2Sq[1]+0.03849001794597505*kSq[1]-0.8888888888888888*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[5], globalIdxs[7], 0.006147592613027645*kSq[6]+0.03336355394999686*kSq[5]+0.02697478829999747*kSq[4]+0.01924500897298752*kSq[2]+0.1888888888888889*epsilon[0]*rdx2Sq[1]+0.3111111111111111*epsilon[0]*rdx2Sq[0]-0.02222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[6], globalIdxs[0], (-0.01721325931647741*kSq[6])-0.03975231959999626*kSq[5]-0.05678902799999467*kSq[4]-0.01333333333333333*kSq[3]+0.03849001794597505*kSq[2]-0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.4444444444444444*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[6], globalIdxs[1], 0.07950463919999252*kSq[5]+0.1135780559999893*kSq[4]-0.5333333333333333*epsilon[0]*rdx2Sq[1]+0.8888888888888888*epsilon[0]*rdx2Sq[0]-0.1777777777777778*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[6], globalIdxs[2], (-0.01721325931647741*kSq[6])-0.03975231959999626*kSq[5]-0.05678902799999467*kSq[4]+0.01333333333333333*kSq[3]+0.03849001794597505*kSq[2]-0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.4444444444444444*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[6], globalIdxs[3], (-0.03442651863295482*kSq[7])+0.03442651863295482*kSq[6]+0.09938079899999068*kSq[5]+0.09938079899999068*kSq[4]+0.02666666666666666*kSq[3]-0.0769800358919501*kSq[2]+0.0769800358919501*kSq[1]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[6], globalIdxs[4], 0.03442651863295482*kSq[7]+0.03442651863295482*kSq[6]+0.09938079899999068*kSq[5]+0.09938079899999068*kSq[4]-0.02666666666666666*kSq[3]-0.0769800358919501*kSq[2]-0.0769800358919501*kSq[1]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[6], globalIdxs[5], 0.03442651863295482*kSq[7]-0.0295084445425327*kSq[6]-0.05962847939999439*kSq[5]-0.063887656499994*kSq[4]+0.05333333333333333*kSq[3]+0.06666666666666667*epsilon[0]*rdx2Sq[1]+0.03849001794597505*kSq[1]-0.8888888888888888*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[6], globalIdxs[6], 0.1967229636168847*kSq[6]-0.07950463919999252*kSq[5]+0.2271561119999787*kSq[4]-0.3079201435678004*kSq[2]+0.5333333333333333*epsilon[0]*rdx2Sq[1]+1.777777777777778*epsilon[0]*rdx2Sq[0]-0.3555555555555556*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[6], globalIdxs[7], (-0.03442651863295482*kSq[7])-0.0295084445425327*kSq[6]-0.05962847939999439*kSq[5]-0.063887656499994*kSq[4]-0.05333333333333333*kSq[3]+0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.03849001794597505*kSq[1]-0.8888888888888888*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[7], globalIdxs[0], 0.0234254740499978*kSq[5]+0.0234254740499978*kSq[4]+0.01333333333333333*kSq[3]+0.2555555555555555*epsilon[0]*rdx2Sq[1]+0.2555555555555555*epsilon[0]*rdx2Sq[0]-0.03333333333333333*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[7], globalIdxs[1], 0.01721325931647741*kSq[6]-0.03975231959999626*kSq[5]-0.05678902799999467*kSq[4]-0.01333333333333333*kSq[3]-0.03849001794597505*kSq[2]-0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.4444444444444444*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[7], globalIdxs[2], 0.006147592613027645*kSq[7]+0.02697478829999747*kSq[5]+0.03336355394999686*kSq[4]-(0.06666666666666667*epsilon[0]*rdx2Sq[0]*bcVals[3])/bcVals[4]+0.3111111111111111*epsilon[0]*rdx2Sq[1]+0.01924500897298752*kSq[1]+0.1888888888888889*epsilon[0]*rdx2Sq[0]-0.02222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[7], globalIdxs[3], 0.01721325931647741*kSq[7]-0.05678902799999467*kSq[5]-0.03975231959999626*kSq[4]-0.01333333333333333*kSq[3]-0.4444444444444444*epsilon[0]*rdx2Sq[1]-0.03849001794597505*kSq[1]-0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[7], globalIdxs[4], (-0.0295084445425327*kSq[7])-0.03442651863295482*kSq[6]-0.063887656499994*kSq[5]-0.05962847939999439*kSq[4]+(0.1333333333333333*epsilon[0]*rdx2Sq[0]*bcVals[3])/bcVals[4]-0.05333333333333333*kSq[3]-0.03849001794597505*kSq[2]-0.8888888888888888*epsilon[0]*rdx2Sq[1]+0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[7], globalIdxs[5], 0.006147592613027645*kSq[6]+0.03336355394999686*kSq[5]+0.02697478829999747*kSq[4]+0.01924500897298752*kSq[2]+0.1888888888888889*epsilon[0]*rdx2Sq[1]+0.3111111111111111*epsilon[0]*rdx2Sq[0]-0.02222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[7], globalIdxs[6], (-0.03442651863295482*kSq[7])-0.0295084445425327*kSq[6]-0.05962847939999439*kSq[5]-0.063887656499994*kSq[4]-0.05333333333333333*kSq[3]+0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.03849001794597505*kSq[1]-0.8888888888888888*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[7], globalIdxs[7], (-0.04549218533640458*kSq[7])-0.04549218533640458*kSq[6]-0.0127775312999988*kSq[5]-0.0127775312999988*kSq[4]+(0.2666666666666667*epsilon[0]*rdx2Sq[0]*bcVals[3])/bcVals[4]-0.04666666666666667*kSq[3]-0.03849001794597505*kSq[2]+0.5777777777777777*epsilon[0]*rdx2Sq[1]-0.03849001794597505*kSq[1]+0.5777777777777777*epsilon[0]*rdx2Sq[0]-0.06666666666666667*kSq[0]);

}
void fem_poisson_lhs_stencil_consteps_2x_ser_p1_upx_robinx_upy_dirichlety(const double *epsilon, const double *kSq, const double *dx, const double *bcVals, const long *globalIdxs, gkyl_mat_triples *tri) 
{ 
  // epsilon: permittivity.
  // kSq: wave number squared (factor multiplying phi).
  // dx: cell length in each direction.
  // bcVals[3]: values to impose as BCs, i.e. bcVals[0]*phi+bcVals[1]*d(phi)/dx=bcVals[2].
  // globalIdxs: global linear index of each basis function/node in current cell.
  // tri: triples object (i,j,val), i.e. contribute val to i,j element of the global matrix.

  double rdx2Sq[2];
  rdx2Sq[0] = 4.0/(dx[0]*dx[0]);
  rdx2Sq[1] = 4.0/(dx[1]*dx[1]);

  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[0], (-0.1666666666666667*kSq[3])+0.1924500897298752*kSq[2]+0.3333333333333333*epsilon[0]*rdx2Sq[1]+0.1924500897298752*kSq[1]+0.3333333333333333*epsilon[0]*rdx2Sq[0]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[1], 0.09622504486493762*kSq[2]+0.1666666666666667*epsilon[0]*rdx2Sq[1]-0.3333333333333333*epsilon[0]*rdx2Sq[0]-0.1111111111111111*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[2], (-0.3333333333333333*epsilon[0]*rdx2Sq[1])+0.09622504486493762*kSq[1]+0.1666666666666667*epsilon[0]*rdx2Sq[0]-0.1111111111111111*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[3], (-0.1666666666666667*epsilon[0]*rdx2Sq[1])-0.1666666666666667*epsilon[0]*rdx2Sq[0]-0.05555555555555555*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[0], 0.09622504486493762*kSq[2]+0.1666666666666667*epsilon[0]*rdx2Sq[1]-0.3333333333333333*epsilon[0]*rdx2Sq[0]-0.1111111111111111*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[1], (0.6666666666666666*epsilon[0]*rdx2Sq[0]*bcVals[3])/bcVals[4]+0.1666666666666667*kSq[3]+0.1924500897298752*kSq[2]+0.3333333333333333*epsilon[0]*rdx2Sq[1]-0.1924500897298752*kSq[1]+0.3333333333333333*epsilon[0]*rdx2Sq[0]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[2], (-0.1666666666666667*epsilon[0]*rdx2Sq[1])-0.1666666666666667*epsilon[0]*rdx2Sq[0]-0.05555555555555555*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[3], (0.3333333333333333*epsilon[0]*rdx2Sq[0]*bcVals[3])/bcVals[4]-0.3333333333333333*epsilon[0]*rdx2Sq[1]-0.09622504486493762*kSq[1]+0.1666666666666667*epsilon[0]*rdx2Sq[0]-0.1111111111111111*kSq[0]);
  gkyl_mat_triples_insert(tri, globalIdxs[2], globalIdxs[0], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[2], globalIdxs[1], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[2], globalIdxs[2], 1.0);
  gkyl_mat_triples_insert(tri, globalIdxs[2], globalIdxs[3], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[3], globalIdxs[0], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[3], globalIdxs[1], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[3], globalIdxs[2], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[3], globalIdxs[3], 1.0);

}
void fem_poisson_lhs_stencil_consteps_2x_ser_p2_upx_robinx_upy_dirichlety(const double *epsilon, const double *kSq, const double *dx, const double *bcVals, const long *globalIdxs, gkyl_mat_triples *tri) 
{ 
  // epsilon: permittivity.
  // kSq: wave number squared (factor multiplying phi).
  // dx: cell length in each direction.
  // bcVals[3]: values to impose as BCs, i.e. bcVals[0]*phi+bcVals[1]*d(phi)/dx=bcVals[2].
  // globalIdxs: global linear index of each basis function/node in current cell.
  // tri: triples object (i,j,val), i.e. contribute val to i,j element of the global matrix.

  double rdx2Sq[2];
  rdx2Sq[0] = 4.0/(dx[0]*dx[0]);
  rdx2Sq[1] = 4.0/(dx[1]*dx[1]);

  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[0], 0.04549218533640458*kSq[7]+0.04549218533640458*kSq[6]-0.0127775312999988*kSq[5]-0.0127775312999988*kSq[4]-0.04666666666666667*kSq[3]+0.03849001794597505*kSq[2]+0.5777777777777777*epsilon[0]*rdx2Sq[1]+0.03849001794597505*kSq[1]+0.5777777777777777*epsilon[0]*rdx2Sq[0]-0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[1], 0.03442651863295482*kSq[7]+0.0295084445425327*kSq[6]-0.05962847939999439*kSq[5]-0.063887656499994*kSq[4]-0.05333333333333333*kSq[3]+0.06666666666666667*epsilon[0]*rdx2Sq[1]+0.03849001794597505*kSq[1]-0.8888888888888888*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[2], (-0.006147592613027645*kSq[6])+0.03336355394999686*kSq[5]+0.02697478829999747*kSq[4]-0.01924500897298752*kSq[2]+0.1888888888888889*epsilon[0]*rdx2Sq[1]+0.3111111111111111*epsilon[0]*rdx2Sq[0]-0.02222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[3], 0.0295084445425327*kSq[7]+0.03442651863295482*kSq[6]-0.063887656499994*kSq[5]-0.05962847939999439*kSq[4]-0.05333333333333333*kSq[3]+0.03849001794597505*kSq[2]-0.8888888888888888*epsilon[0]*rdx2Sq[1]+0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[4], (-0.01721325931647741*kSq[7])-0.05678902799999467*kSq[5]-0.03975231959999626*kSq[4]-0.01333333333333333*kSq[3]-0.4444444444444444*epsilon[0]*rdx2Sq[1]+0.03849001794597505*kSq[1]-0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[5], (-0.006147592613027645*kSq[7])+0.02697478829999747*kSq[5]+0.03336355394999686*kSq[4]+0.3111111111111111*epsilon[0]*rdx2Sq[1]-0.01924500897298752*kSq[1]+0.1888888888888889*epsilon[0]*rdx2Sq[0]-0.02222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[6], (-0.01721325931647741*kSq[6])-0.03975231959999626*kSq[5]-0.05678902799999467*kSq[4]-0.01333333333333333*kSq[3]+0.03849001794597505*kSq[2]-0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.4444444444444444*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[7], 0.0234254740499978*kSq[5]+0.0234254740499978*kSq[4]+0.01333333333333333*kSq[3]+0.2555555555555555*epsilon[0]*rdx2Sq[1]+0.2555555555555555*epsilon[0]*rdx2Sq[0]-0.03333333333333333*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[0], 0.03442651863295482*kSq[7]+0.0295084445425327*kSq[6]-0.05962847939999439*kSq[5]-0.063887656499994*kSq[4]-0.05333333333333333*kSq[3]+0.06666666666666667*epsilon[0]*rdx2Sq[1]+0.03849001794597505*kSq[1]-0.8888888888888888*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[1], (-0.1967229636168847*kSq[6])-0.07950463919999252*kSq[5]+0.2271561119999787*kSq[4]+0.3079201435678004*kSq[2]+0.5333333333333333*epsilon[0]*rdx2Sq[1]+1.777777777777778*epsilon[0]*rdx2Sq[0]-0.3555555555555556*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[2], (-0.03442651863295482*kSq[7])+0.0295084445425327*kSq[6]-0.05962847939999439*kSq[5]-0.063887656499994*kSq[4]+0.05333333333333333*kSq[3]+0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.03849001794597505*kSq[1]-0.8888888888888888*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[3], (-0.03442651863295482*kSq[7])-0.03442651863295482*kSq[6]+0.09938079899999068*kSq[5]+0.09938079899999068*kSq[4]-0.02666666666666666*kSq[3]+0.0769800358919501*kSq[2]+0.0769800358919501*kSq[1]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[4], 0.03442651863295482*kSq[7]-0.03442651863295482*kSq[6]+0.09938079899999068*kSq[5]+0.09938079899999068*kSq[4]+0.02666666666666666*kSq[3]+0.0769800358919501*kSq[2]-0.0769800358919501*kSq[1]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[5], 0.01721325931647741*kSq[6]-0.03975231959999626*kSq[5]-0.05678902799999467*kSq[4]+0.01333333333333333*kSq[3]-0.03849001794597505*kSq[2]-0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.4444444444444444*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[6], 0.07950463919999252*kSq[5]+0.1135780559999893*kSq[4]-0.5333333333333333*epsilon[0]*rdx2Sq[1]+0.8888888888888888*epsilon[0]*rdx2Sq[0]-0.1777777777777778*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[7], 0.01721325931647741*kSq[6]-0.03975231959999626*kSq[5]-0.05678902799999467*kSq[4]-0.01333333333333333*kSq[3]-0.03849001794597505*kSq[2]-0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.4444444444444444*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[0], (-0.006147592613027645*kSq[6])+0.03336355394999686*kSq[5]+0.02697478829999747*kSq[4]-0.01924500897298752*kSq[2]+0.1888888888888889*epsilon[0]*rdx2Sq[1]+0.3111111111111111*epsilon[0]*rdx2Sq[0]-0.02222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[1], (-0.03442651863295482*kSq[7])+0.0295084445425327*kSq[6]-0.05962847939999439*kSq[5]-0.063887656499994*kSq[4]+0.05333333333333333*kSq[3]+0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.03849001794597505*kSq[1]-0.8888888888888888*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[2], (-0.04549218533640458*kSq[7])+0.04549218533640458*kSq[6]-0.0127775312999988*kSq[5]-0.0127775312999988*kSq[4]+(0.2666666666666667*epsilon[0]*rdx2Sq[0]*bcVals[3])/bcVals[4]+0.04666666666666667*kSq[3]+0.03849001794597505*kSq[2]+0.5777777777777777*epsilon[0]*rdx2Sq[1]-0.03849001794597505*kSq[1]+0.5777777777777777*epsilon[0]*rdx2Sq[0]-0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[3], 0.01721325931647741*kSq[7]-0.05678902799999467*kSq[5]-0.03975231959999626*kSq[4]+0.01333333333333333*kSq[3]-0.4444444444444444*epsilon[0]*rdx2Sq[1]-0.03849001794597505*kSq[1]-0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[4], (-0.0295084445425327*kSq[7])+0.03442651863295482*kSq[6]-0.063887656499994*kSq[5]-0.05962847939999439*kSq[4]+(0.1333333333333333*epsilon[0]*rdx2Sq[0]*bcVals[3])/bcVals[4]+0.05333333333333333*kSq[3]+0.03849001794597505*kSq[2]-0.8888888888888888*epsilon[0]*rdx2Sq[1]+0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[5], 0.0234254740499978*kSq[5]+0.0234254740499978*kSq[4]-0.01333333333333333*kSq[3]+0.2555555555555555*epsilon[0]*rdx2Sq[1]+0.2555555555555555*epsilon[0]*rdx2Sq[0]-0.03333333333333333*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[6], (-0.01721325931647741*kSq[6])-0.03975231959999626*kSq[5]-0.05678902799999467*kSq[4]+0.01333333333333333*kSq[3]+0.03849001794597505*kSq[2]-0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.4444444444444444*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[7], 0.006147592613027645*kSq[7]+0.02697478829999747*kSq[5]+0.03336355394999686*kSq[4]-(0.06666666666666667*epsilon[0]*rdx2Sq[0]*bcVals[3])/bcVals[4]+0.3111111111111111*epsilon[0]*rdx2Sq[1]+0.01924500897298752*kSq[1]+0.1888888888888889*epsilon[0]*rdx2Sq[0]-0.02222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[0], 0.0295084445425327*kSq[7]+0.03442651863295482*kSq[6]-0.063887656499994*kSq[5]-0.05962847939999439*kSq[4]-0.05333333333333333*kSq[3]+0.03849001794597505*kSq[2]-0.8888888888888888*epsilon[0]*rdx2Sq[1]+0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[1], (-0.03442651863295482*kSq[7])-0.03442651863295482*kSq[6]+0.09938079899999068*kSq[5]+0.09938079899999068*kSq[4]-0.02666666666666666*kSq[3]+0.0769800358919501*kSq[2]+0.0769800358919501*kSq[1]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[2], 0.01721325931647741*kSq[7]-0.05678902799999467*kSq[5]-0.03975231959999626*kSq[4]+0.01333333333333333*kSq[3]-0.4444444444444444*epsilon[0]*rdx2Sq[1]-0.03849001794597505*kSq[1]-0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[3], (-0.1967229636168847*kSq[7])+0.2271561119999787*kSq[5]-0.07950463919999252*kSq[4]+1.777777777777778*epsilon[0]*rdx2Sq[1]+0.3079201435678004*kSq[1]+0.5333333333333333*epsilon[0]*rdx2Sq[0]-0.3555555555555556*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[4], 0.1135780559999893*kSq[5]+0.07950463919999252*kSq[4]+0.8888888888888888*epsilon[0]*rdx2Sq[1]-0.5333333333333333*epsilon[0]*rdx2Sq[0]-0.1777777777777778*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[5], 0.0295084445425327*kSq[7]-0.03442651863295482*kSq[6]-0.063887656499994*kSq[5]-0.05962847939999439*kSq[4]+0.05333333333333333*kSq[3]-0.03849001794597505*kSq[2]-0.8888888888888888*epsilon[0]*rdx2Sq[1]+0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[6], (-0.03442651863295482*kSq[7])+0.03442651863295482*kSq[6]+0.09938079899999068*kSq[5]+0.09938079899999068*kSq[4]+0.02666666666666666*kSq[3]-0.0769800358919501*kSq[2]+0.0769800358919501*kSq[1]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[7], 0.01721325931647741*kSq[7]-0.05678902799999467*kSq[5]-0.03975231959999626*kSq[4]-0.01333333333333333*kSq[3]-0.4444444444444444*epsilon[0]*rdx2Sq[1]-0.03849001794597505*kSq[1]-0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[4], globalIdxs[0], (-0.01721325931647741*kSq[7])-0.05678902799999467*kSq[5]-0.03975231959999626*kSq[4]-0.01333333333333333*kSq[3]-0.4444444444444444*epsilon[0]*rdx2Sq[1]+0.03849001794597505*kSq[1]-0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[4], globalIdxs[1], 0.03442651863295482*kSq[7]-0.03442651863295482*kSq[6]+0.09938079899999068*kSq[5]+0.09938079899999068*kSq[4]+0.02666666666666666*kSq[3]+0.0769800358919501*kSq[2]-0.0769800358919501*kSq[1]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[4], globalIdxs[2], (-0.0295084445425327*kSq[7])+0.03442651863295482*kSq[6]-0.063887656499994*kSq[5]-0.05962847939999439*kSq[4]+(0.1333333333333333*epsilon[0]*rdx2Sq[0]*bcVals[3])/bcVals[4]+0.05333333333333333*kSq[3]+0.03849001794597505*kSq[2]-0.8888888888888888*epsilon[0]*rdx2Sq[1]+0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[4], globalIdxs[3], 0.1135780559999893*kSq[5]+0.07950463919999252*kSq[4]+0.8888888888888888*epsilon[0]*rdx2Sq[1]-0.5333333333333333*epsilon[0]*rdx2Sq[0]-0.1777777777777778*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[4], globalIdxs[4], 0.1967229636168847*kSq[7]+0.2271561119999787*kSq[5]-0.07950463919999252*kSq[4]+(1.066666666666667*epsilon[0]*rdx2Sq[0]*bcVals[3])/bcVals[4]+1.777777777777778*epsilon[0]*rdx2Sq[1]-0.3079201435678004*kSq[1]+0.5333333333333333*epsilon[0]*rdx2Sq[0]-0.3555555555555556*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[4], globalIdxs[5], (-0.01721325931647741*kSq[7])-0.05678902799999467*kSq[5]-0.03975231959999626*kSq[4]+0.01333333333333333*kSq[3]-0.4444444444444444*epsilon[0]*rdx2Sq[1]+0.03849001794597505*kSq[1]-0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[4], globalIdxs[6], 0.03442651863295482*kSq[7]+0.03442651863295482*kSq[6]+0.09938079899999068*kSq[5]+0.09938079899999068*kSq[4]-0.02666666666666666*kSq[3]-0.0769800358919501*kSq[2]-0.0769800358919501*kSq[1]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[4], globalIdxs[7], (-0.0295084445425327*kSq[7])-0.03442651863295482*kSq[6]-0.063887656499994*kSq[5]-0.05962847939999439*kSq[4]+(0.1333333333333333*epsilon[0]*rdx2Sq[0]*bcVals[3])/bcVals[4]-0.05333333333333333*kSq[3]-0.03849001794597505*kSq[2]-0.8888888888888888*epsilon[0]*rdx2Sq[1]+0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_insert(tri, globalIdxs[5], globalIdxs[0], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[5], globalIdxs[1], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[5], globalIdxs[2], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[5], globalIdxs[3], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[5], globalIdxs[4], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[5], globalIdxs[5], 1.0);
  gkyl_mat_triples_insert(tri, globalIdxs[5], globalIdxs[6], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[5], globalIdxs[7], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[6], globalIdxs[0], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[6], globalIdxs[1], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[6], globalIdxs[2], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[6], globalIdxs[3], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[6], globalIdxs[4], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[6], globalIdxs[5], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[6], globalIdxs[6], 1.0);
  gkyl_mat_triples_insert(tri, globalIdxs[6], globalIdxs[7], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[7], globalIdxs[0], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[7], globalIdxs[1], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[7], globalIdxs[2], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[7], globalIdxs[3], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[7], globalIdxs[4], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[7], globalIdxs[5], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[7], globalIdxs[6], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[7], globalIdxs[7], 1.0);

}
void fem_poisson_lhs_stencil_consteps_2x_ser_p1_upx_robinx_upy_neumanny(const double *epsilon, const double *kSq, const double *dx, const double *bcVals, const long *globalIdxs, gkyl_mat_triples *tri) 
{ 
  // epsilon: permittivity.
  // kSq: wave number squared (factor multiplying phi).
  // dx: cell length in each direction.
  // bcVals[3]: values to impose as BCs, i.e. bcVals[0]*phi+bcVals[1]*d(phi)/dx=bcVals[2].
  // globalIdxs: global linear index of each basis function/node in current cell.
  // tri: triples object (i,j,val), i.e. contribute val to i,j element of the global matrix.

  double rdx2Sq[2];
  rdx2Sq[0] = 4.0/(dx[0]*dx[0]);
  rdx2Sq[1] = 4.0/(dx[1]*dx[1]);

  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[0], (-0.1666666666666667*kSq[3])+0.1924500897298752*kSq[2]+0.3333333333333333*epsilon[0]*rdx2Sq[1]+0.1924500897298752*kSq[1]+0.3333333333333333*epsilon[0]*rdx2Sq[0]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[1], 0.09622504486493762*kSq[2]+0.1666666666666667*epsilon[0]*rdx2Sq[1]-0.3333333333333333*epsilon[0]*rdx2Sq[0]-0.1111111111111111*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[2], (-0.3333333333333333*epsilon[0]*rdx2Sq[1])+0.09622504486493762*kSq[1]+0.1666666666666667*epsilon[0]*rdx2Sq[0]-0.1111111111111111*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[3], (-0.1666666666666667*epsilon[0]*rdx2Sq[1])-0.1666666666666667*epsilon[0]*rdx2Sq[0]-0.05555555555555555*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[0], 0.09622504486493762*kSq[2]+0.1666666666666667*epsilon[0]*rdx2Sq[1]-0.3333333333333333*epsilon[0]*rdx2Sq[0]-0.1111111111111111*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[1], (0.6666666666666666*epsilon[0]*rdx2Sq[0]*bcVals[3])/bcVals[4]+0.1666666666666667*kSq[3]+0.1924500897298752*kSq[2]+0.3333333333333333*epsilon[0]*rdx2Sq[1]-0.1924500897298752*kSq[1]+0.3333333333333333*epsilon[0]*rdx2Sq[0]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[2], (-0.1666666666666667*epsilon[0]*rdx2Sq[1])-0.1666666666666667*epsilon[0]*rdx2Sq[0]-0.05555555555555555*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[3], (0.3333333333333333*epsilon[0]*rdx2Sq[0]*bcVals[3])/bcVals[4]-0.3333333333333333*epsilon[0]*rdx2Sq[1]-0.09622504486493762*kSq[1]+0.1666666666666667*epsilon[0]*rdx2Sq[0]-0.1111111111111111*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[0], (-0.3333333333333333*epsilon[0]*rdx2Sq[1])+0.09622504486493762*kSq[1]+0.1666666666666667*epsilon[0]*rdx2Sq[0]-0.1111111111111111*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[1], (-0.1666666666666667*epsilon[0]*rdx2Sq[1])-0.1666666666666667*epsilon[0]*rdx2Sq[0]-0.05555555555555555*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[2], 0.1666666666666667*kSq[3]-0.1924500897298752*kSq[2]+0.3333333333333333*epsilon[0]*rdx2Sq[1]+0.1924500897298752*kSq[1]+0.3333333333333333*epsilon[0]*rdx2Sq[0]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[3], (-0.09622504486493762*kSq[2])+0.1666666666666667*epsilon[0]*rdx2Sq[1]-0.3333333333333333*epsilon[0]*rdx2Sq[0]-0.1111111111111111*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[0], (-0.1666666666666667*epsilon[0]*rdx2Sq[1])-0.1666666666666667*epsilon[0]*rdx2Sq[0]-0.05555555555555555*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[1], (0.3333333333333333*epsilon[0]*rdx2Sq[0]*bcVals[3])/bcVals[4]-0.3333333333333333*epsilon[0]*rdx2Sq[1]-0.09622504486493762*kSq[1]+0.1666666666666667*epsilon[0]*rdx2Sq[0]-0.1111111111111111*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[2], (-0.09622504486493762*kSq[2])+0.1666666666666667*epsilon[0]*rdx2Sq[1]-0.3333333333333333*epsilon[0]*rdx2Sq[0]-0.1111111111111111*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[3], (0.6666666666666666*epsilon[0]*rdx2Sq[0]*bcVals[3])/bcVals[4]-0.1666666666666667*kSq[3]-0.1924500897298752*kSq[2]+0.3333333333333333*epsilon[0]*rdx2Sq[1]-0.1924500897298752*kSq[1]+0.3333333333333333*epsilon[0]*rdx2Sq[0]-0.2222222222222222*kSq[0]);

}
void fem_poisson_lhs_stencil_consteps_2x_ser_p2_upx_robinx_upy_neumanny(const double *epsilon, const double *kSq, const double *dx, const double *bcVals, const long *globalIdxs, gkyl_mat_triples *tri) 
{ 
  // epsilon: permittivity.
  // kSq: wave number squared (factor multiplying phi).
  // dx: cell length in each direction.
  // bcVals[3]: values to impose as BCs, i.e. bcVals[0]*phi+bcVals[1]*d(phi)/dx=bcVals[2].
  // globalIdxs: global linear index of each basis function/node in current cell.
  // tri: triples object (i,j,val), i.e. contribute val to i,j element of the global matrix.

  double rdx2Sq[2];
  rdx2Sq[0] = 4.0/(dx[0]*dx[0]);
  rdx2Sq[1] = 4.0/(dx[1]*dx[1]);

  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[0], 0.04549218533640458*kSq[7]+0.04549218533640458*kSq[6]-0.0127775312999988*kSq[5]-0.0127775312999988*kSq[4]-0.04666666666666667*kSq[3]+0.03849001794597505*kSq[2]+0.5777777777777777*epsilon[0]*rdx2Sq[1]+0.03849001794597505*kSq[1]+0.5777777777777777*epsilon[0]*rdx2Sq[0]-0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[1], 0.03442651863295482*kSq[7]+0.0295084445425327*kSq[6]-0.05962847939999439*kSq[5]-0.063887656499994*kSq[4]-0.05333333333333333*kSq[3]+0.06666666666666667*epsilon[0]*rdx2Sq[1]+0.03849001794597505*kSq[1]-0.8888888888888888*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[2], (-0.006147592613027645*kSq[6])+0.03336355394999686*kSq[5]+0.02697478829999747*kSq[4]-0.01924500897298752*kSq[2]+0.1888888888888889*epsilon[0]*rdx2Sq[1]+0.3111111111111111*epsilon[0]*rdx2Sq[0]-0.02222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[3], 0.0295084445425327*kSq[7]+0.03442651863295482*kSq[6]-0.063887656499994*kSq[5]-0.05962847939999439*kSq[4]-0.05333333333333333*kSq[3]+0.03849001794597505*kSq[2]-0.8888888888888888*epsilon[0]*rdx2Sq[1]+0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[4], (-0.01721325931647741*kSq[7])-0.05678902799999467*kSq[5]-0.03975231959999626*kSq[4]-0.01333333333333333*kSq[3]-0.4444444444444444*epsilon[0]*rdx2Sq[1]+0.03849001794597505*kSq[1]-0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[5], (-0.006147592613027645*kSq[7])+0.02697478829999747*kSq[5]+0.03336355394999686*kSq[4]+0.3111111111111111*epsilon[0]*rdx2Sq[1]-0.01924500897298752*kSq[1]+0.1888888888888889*epsilon[0]*rdx2Sq[0]-0.02222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[6], (-0.01721325931647741*kSq[6])-0.03975231959999626*kSq[5]-0.05678902799999467*kSq[4]-0.01333333333333333*kSq[3]+0.03849001794597505*kSq[2]-0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.4444444444444444*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[7], 0.0234254740499978*kSq[5]+0.0234254740499978*kSq[4]+0.01333333333333333*kSq[3]+0.2555555555555555*epsilon[0]*rdx2Sq[1]+0.2555555555555555*epsilon[0]*rdx2Sq[0]-0.03333333333333333*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[0], 0.03442651863295482*kSq[7]+0.0295084445425327*kSq[6]-0.05962847939999439*kSq[5]-0.063887656499994*kSq[4]-0.05333333333333333*kSq[3]+0.06666666666666667*epsilon[0]*rdx2Sq[1]+0.03849001794597505*kSq[1]-0.8888888888888888*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[1], (-0.1967229636168847*kSq[6])-0.07950463919999252*kSq[5]+0.2271561119999787*kSq[4]+0.3079201435678004*kSq[2]+0.5333333333333333*epsilon[0]*rdx2Sq[1]+1.777777777777778*epsilon[0]*rdx2Sq[0]-0.3555555555555556*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[2], (-0.03442651863295482*kSq[7])+0.0295084445425327*kSq[6]-0.05962847939999439*kSq[5]-0.063887656499994*kSq[4]+0.05333333333333333*kSq[3]+0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.03849001794597505*kSq[1]-0.8888888888888888*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[3], (-0.03442651863295482*kSq[7])-0.03442651863295482*kSq[6]+0.09938079899999068*kSq[5]+0.09938079899999068*kSq[4]-0.02666666666666666*kSq[3]+0.0769800358919501*kSq[2]+0.0769800358919501*kSq[1]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[4], 0.03442651863295482*kSq[7]-0.03442651863295482*kSq[6]+0.09938079899999068*kSq[5]+0.09938079899999068*kSq[4]+0.02666666666666666*kSq[3]+0.0769800358919501*kSq[2]-0.0769800358919501*kSq[1]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[5], 0.01721325931647741*kSq[6]-0.03975231959999626*kSq[5]-0.05678902799999467*kSq[4]+0.01333333333333333*kSq[3]-0.03849001794597505*kSq[2]-0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.4444444444444444*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[6], 0.07950463919999252*kSq[5]+0.1135780559999893*kSq[4]-0.5333333333333333*epsilon[0]*rdx2Sq[1]+0.8888888888888888*epsilon[0]*rdx2Sq[0]-0.1777777777777778*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[7], 0.01721325931647741*kSq[6]-0.03975231959999626*kSq[5]-0.05678902799999467*kSq[4]-0.01333333333333333*kSq[3]-0.03849001794597505*kSq[2]-0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.4444444444444444*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[0], (-0.006147592613027645*kSq[6])+0.03336355394999686*kSq[5]+0.02697478829999747*kSq[4]-0.01924500897298752*kSq[2]+0.1888888888888889*epsilon[0]*rdx2Sq[1]+0.3111111111111111*epsilon[0]*rdx2Sq[0]-0.02222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[1], (-0.03442651863295482*kSq[7])+0.0295084445425327*kSq[6]-0.05962847939999439*kSq[5]-0.063887656499994*kSq[4]+0.05333333333333333*kSq[3]+0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.03849001794597505*kSq[1]-0.8888888888888888*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[2], (-0.04549218533640458*kSq[7])+0.04549218533640458*kSq[6]-0.0127775312999988*kSq[5]-0.0127775312999988*kSq[4]+(0.2666666666666667*epsilon[0]*rdx2Sq[0]*bcVals[3])/bcVals[4]+0.04666666666666667*kSq[3]+0.03849001794597505*kSq[2]+0.5777777777777777*epsilon[0]*rdx2Sq[1]-0.03849001794597505*kSq[1]+0.5777777777777777*epsilon[0]*rdx2Sq[0]-0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[3], 0.01721325931647741*kSq[7]-0.05678902799999467*kSq[5]-0.03975231959999626*kSq[4]+0.01333333333333333*kSq[3]-0.4444444444444444*epsilon[0]*rdx2Sq[1]-0.03849001794597505*kSq[1]-0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[4], (-0.0295084445425327*kSq[7])+0.03442651863295482*kSq[6]-0.063887656499994*kSq[5]-0.05962847939999439*kSq[4]+(0.1333333333333333*epsilon[0]*rdx2Sq[0]*bcVals[3])/bcVals[4]+0.05333333333333333*kSq[3]+0.03849001794597505*kSq[2]-0.8888888888888888*epsilon[0]*rdx2Sq[1]+0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[5], 0.0234254740499978*kSq[5]+0.0234254740499978*kSq[4]-0.01333333333333333*kSq[3]+0.2555555555555555*epsilon[0]*rdx2Sq[1]+0.2555555555555555*epsilon[0]*rdx2Sq[0]-0.03333333333333333*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[6], (-0.01721325931647741*kSq[6])-0.03975231959999626*kSq[5]-0.05678902799999467*kSq[4]+0.01333333333333333*kSq[3]+0.03849001794597505*kSq[2]-0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.4444444444444444*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[7], 0.006147592613027645*kSq[7]+0.02697478829999747*kSq[5]+0.03336355394999686*kSq[4]-(0.06666666666666667*epsilon[0]*rdx2Sq[0]*bcVals[3])/bcVals[4]+0.3111111111111111*epsilon[0]*rdx2Sq[1]+0.01924500897298752*kSq[1]+0.1888888888888889*epsilon[0]*rdx2Sq[0]-0.02222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[0], 0.0295084445425327*kSq[7]+0.03442651863295482*kSq[6]-0.063887656499994*kSq[5]-0.05962847939999439*kSq[4]-0.05333333333333333*kSq[3]+0.03849001794597505*kSq[2]-0.8888888888888888*epsilon[0]*rdx2Sq[1]+0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[1], (-0.03442651863295482*kSq[7])-0.03442651863295482*kSq[6]+0.09938079899999068*kSq[5]+0.09938079899999068*kSq[4]-0.02666666666666666*kSq[3]+0.0769800358919501*kSq[2]+0.0769800358919501*kSq[1]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[2], 0.01721325931647741*kSq[7]-0.05678902799999467*kSq[5]-0.03975231959999626*kSq[4]+0.01333333333333333*kSq[3]-0.4444444444444444*epsilon[0]*rdx2Sq[1]-0.03849001794597505*kSq[1]-0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[3], (-0.1967229636168847*kSq[7])+0.2271561119999787*kSq[5]-0.07950463919999252*kSq[4]+1.777777777777778*epsilon[0]*rdx2Sq[1]+0.3079201435678004*kSq[1]+0.5333333333333333*epsilon[0]*rdx2Sq[0]-0.3555555555555556*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[4], 0.1135780559999893*kSq[5]+0.07950463919999252*kSq[4]+0.8888888888888888*epsilon[0]*rdx2Sq[1]-0.5333333333333333*epsilon[0]*rdx2Sq[0]-0.1777777777777778*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[5], 0.0295084445425327*kSq[7]-0.03442651863295482*kSq[6]-0.063887656499994*kSq[5]-0.05962847939999439*kSq[4]+0.05333333333333333*kSq[3]-0.03849001794597505*kSq[2]-0.8888888888888888*epsilon[0]*rdx2Sq[1]+0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[6], (-0.03442651863295482*kSq[7])+0.03442651863295482*kSq[6]+0.09938079899999068*kSq[5]+0.09938079899999068*kSq[4]+0.02666666666666666*kSq[3]-0.0769800358919501*kSq[2]+0.0769800358919501*kSq[1]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[7], 0.01721325931647741*kSq[7]-0.05678902799999467*kSq[5]-0.03975231959999626*kSq[4]-0.01333333333333333*kSq[3]-0.4444444444444444*epsilon[0]*rdx2Sq[1]-0.03849001794597505*kSq[1]-0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[4], globalIdxs[0], (-0.01721325931647741*kSq[7])-0.05678902799999467*kSq[5]-0.03975231959999626*kSq[4]-0.01333333333333333*kSq[3]-0.4444444444444444*epsilon[0]*rdx2Sq[1]+0.03849001794597505*kSq[1]-0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[4], globalIdxs[1], 0.03442651863295482*kSq[7]-0.03442651863295482*kSq[6]+0.09938079899999068*kSq[5]+0.09938079899999068*kSq[4]+0.02666666666666666*kSq[3]+0.0769800358919501*kSq[2]-0.0769800358919501*kSq[1]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[4], globalIdxs[2], (-0.0295084445425327*kSq[7])+0.03442651863295482*kSq[6]-0.063887656499994*kSq[5]-0.05962847939999439*kSq[4]+(0.1333333333333333*epsilon[0]*rdx2Sq[0]*bcVals[3])/bcVals[4]+0.05333333333333333*kSq[3]+0.03849001794597505*kSq[2]-0.8888888888888888*epsilon[0]*rdx2Sq[1]+0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[4], globalIdxs[3], 0.1135780559999893*kSq[5]+0.07950463919999252*kSq[4]+0.8888888888888888*epsilon[0]*rdx2Sq[1]-0.5333333333333333*epsilon[0]*rdx2Sq[0]-0.1777777777777778*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[4], globalIdxs[4], 0.1967229636168847*kSq[7]+0.2271561119999787*kSq[5]-0.07950463919999252*kSq[4]+(1.066666666666667*epsilon[0]*rdx2Sq[0]*bcVals[3])/bcVals[4]+1.777777777777778*epsilon[0]*rdx2Sq[1]-0.3079201435678004*kSq[1]+0.5333333333333333*epsilon[0]*rdx2Sq[0]-0.3555555555555556*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[4], globalIdxs[5], (-0.01721325931647741*kSq[7])-0.05678902799999467*kSq[5]-0.03975231959999626*kSq[4]+0.01333333333333333*kSq[3]-0.4444444444444444*epsilon[0]*rdx2Sq[1]+0.03849001794597505*kSq[1]-0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[4], globalIdxs[6], 0.03442651863295482*kSq[7]+0.03442651863295482*kSq[6]+0.09938079899999068*kSq[5]+0.09938079899999068*kSq[4]-0.02666666666666666*kSq[3]-0.0769800358919501*kSq[2]-0.0769800358919501*kSq[1]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[4], globalIdxs[7], (-0.0295084445425327*kSq[7])-0.03442651863295482*kSq[6]-0.063887656499994*kSq[5]-0.05962847939999439*kSq[4]+(0.1333333333333333*epsilon[0]*rdx2Sq[0]*bcVals[3])/bcVals[4]-0.05333333333333333*kSq[3]-0.03849001794597505*kSq[2]-0.8888888888888888*epsilon[0]*rdx2Sq[1]+0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[5], globalIdxs[0], (-0.006147592613027645*kSq[7])+0.02697478829999747*kSq[5]+0.03336355394999686*kSq[4]+0.3111111111111111*epsilon[0]*rdx2Sq[1]-0.01924500897298752*kSq[1]+0.1888888888888889*epsilon[0]*rdx2Sq[0]-0.02222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[5], globalIdxs[1], 0.01721325931647741*kSq[6]-0.03975231959999626*kSq[5]-0.05678902799999467*kSq[4]+0.01333333333333333*kSq[3]-0.03849001794597505*kSq[2]-0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.4444444444444444*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[5], globalIdxs[2], 0.0234254740499978*kSq[5]+0.0234254740499978*kSq[4]-0.01333333333333333*kSq[3]+0.2555555555555555*epsilon[0]*rdx2Sq[1]+0.2555555555555555*epsilon[0]*rdx2Sq[0]-0.03333333333333333*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[5], globalIdxs[3], 0.0295084445425327*kSq[7]-0.03442651863295482*kSq[6]-0.063887656499994*kSq[5]-0.05962847939999439*kSq[4]+0.05333333333333333*kSq[3]-0.03849001794597505*kSq[2]-0.8888888888888888*epsilon[0]*rdx2Sq[1]+0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[5], globalIdxs[4], (-0.01721325931647741*kSq[7])-0.05678902799999467*kSq[5]-0.03975231959999626*kSq[4]+0.01333333333333333*kSq[3]-0.4444444444444444*epsilon[0]*rdx2Sq[1]+0.03849001794597505*kSq[1]-0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[5], globalIdxs[5], 0.04549218533640458*kSq[7]-0.04549218533640458*kSq[6]-0.0127775312999988*kSq[5]-0.0127775312999988*kSq[4]+0.04666666666666667*kSq[3]-0.03849001794597505*kSq[2]+0.5777777777777777*epsilon[0]*rdx2Sq[1]+0.03849001794597505*kSq[1]+0.5777777777777777*epsilon[0]*rdx2Sq[0]-0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[5], globalIdxs[6], 0.03442651863295482*kSq[7]-0.0295084445425327*kSq[6]-0.05962847939999439*kSq[5]-0.063887656499994*kSq[4]+0.05333333333333333*kSq[3]+0.06666666666666667*epsilon[0]*rdx2Sq[1]+0.03849001794597505*kSq[1]-0.8888888888888888*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[5], globalIdxs[7], 0.006147592613027645*kSq[6]+0.03336355394999686*kSq[5]+0.02697478829999747*kSq[4]+0.01924500897298752*kSq[2]+0.1888888888888889*epsilon[0]*rdx2Sq[1]+0.3111111111111111*epsilon[0]*rdx2Sq[0]-0.02222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[6], globalIdxs[0], (-0.01721325931647741*kSq[6])-0.03975231959999626*kSq[5]-0.05678902799999467*kSq[4]-0.01333333333333333*kSq[3]+0.03849001794597505*kSq[2]-0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.4444444444444444*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[6], globalIdxs[1], 0.07950463919999252*kSq[5]+0.1135780559999893*kSq[4]-0.5333333333333333*epsilon[0]*rdx2Sq[1]+0.8888888888888888*epsilon[0]*rdx2Sq[0]-0.1777777777777778*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[6], globalIdxs[2], (-0.01721325931647741*kSq[6])-0.03975231959999626*kSq[5]-0.05678902799999467*kSq[4]+0.01333333333333333*kSq[3]+0.03849001794597505*kSq[2]-0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.4444444444444444*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[6], globalIdxs[3], (-0.03442651863295482*kSq[7])+0.03442651863295482*kSq[6]+0.09938079899999068*kSq[5]+0.09938079899999068*kSq[4]+0.02666666666666666*kSq[3]-0.0769800358919501*kSq[2]+0.0769800358919501*kSq[1]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[6], globalIdxs[4], 0.03442651863295482*kSq[7]+0.03442651863295482*kSq[6]+0.09938079899999068*kSq[5]+0.09938079899999068*kSq[4]-0.02666666666666666*kSq[3]-0.0769800358919501*kSq[2]-0.0769800358919501*kSq[1]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[6], globalIdxs[5], 0.03442651863295482*kSq[7]-0.0295084445425327*kSq[6]-0.05962847939999439*kSq[5]-0.063887656499994*kSq[4]+0.05333333333333333*kSq[3]+0.06666666666666667*epsilon[0]*rdx2Sq[1]+0.03849001794597505*kSq[1]-0.8888888888888888*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[6], globalIdxs[6], 0.1967229636168847*kSq[6]-0.07950463919999252*kSq[5]+0.2271561119999787*kSq[4]-0.3079201435678004*kSq[2]+0.5333333333333333*epsilon[0]*rdx2Sq[1]+1.777777777777778*epsilon[0]*rdx2Sq[0]-0.3555555555555556*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[6], globalIdxs[7], (-0.03442651863295482*kSq[7])-0.0295084445425327*kSq[6]-0.05962847939999439*kSq[5]-0.063887656499994*kSq[4]-0.05333333333333333*kSq[3]+0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.03849001794597505*kSq[1]-0.8888888888888888*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[7], globalIdxs[0], 0.0234254740499978*kSq[5]+0.0234254740499978*kSq[4]+0.01333333333333333*kSq[3]+0.2555555555555555*epsilon[0]*rdx2Sq[1]+0.2555555555555555*epsilon[0]*rdx2Sq[0]-0.03333333333333333*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[7], globalIdxs[1], 0.01721325931647741*kSq[6]-0.03975231959999626*kSq[5]-0.05678902799999467*kSq[4]-0.01333333333333333*kSq[3]-0.03849001794597505*kSq[2]-0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.4444444444444444*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[7], globalIdxs[2], 0.006147592613027645*kSq[7]+0.02697478829999747*kSq[5]+0.03336355394999686*kSq[4]-(0.06666666666666667*epsilon[0]*rdx2Sq[0]*bcVals[3])/bcVals[4]+0.3111111111111111*epsilon[0]*rdx2Sq[1]+0.01924500897298752*kSq[1]+0.1888888888888889*epsilon[0]*rdx2Sq[0]-0.02222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[7], globalIdxs[3], 0.01721325931647741*kSq[7]-0.05678902799999467*kSq[5]-0.03975231959999626*kSq[4]-0.01333333333333333*kSq[3]-0.4444444444444444*epsilon[0]*rdx2Sq[1]-0.03849001794597505*kSq[1]-0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[7], globalIdxs[4], (-0.0295084445425327*kSq[7])-0.03442651863295482*kSq[6]-0.063887656499994*kSq[5]-0.05962847939999439*kSq[4]+(0.1333333333333333*epsilon[0]*rdx2Sq[0]*bcVals[3])/bcVals[4]-0.05333333333333333*kSq[3]-0.03849001794597505*kSq[2]-0.8888888888888888*epsilon[0]*rdx2Sq[1]+0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[7], globalIdxs[5], 0.006147592613027645*kSq[6]+0.03336355394999686*kSq[5]+0.02697478829999747*kSq[4]+0.01924500897298752*kSq[2]+0.1888888888888889*epsilon[0]*rdx2Sq[1]+0.3111111111111111*epsilon[0]*rdx2Sq[0]-0.02222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[7], globalIdxs[6], (-0.03442651863295482*kSq[7])-0.0295084445425327*kSq[6]-0.05962847939999439*kSq[5]-0.063887656499994*kSq[4]-0.05333333333333333*kSq[3]+0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.03849001794597505*kSq[1]-0.8888888888888888*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[7], globalIdxs[7], (-0.04549218533640458*kSq[7])-0.04549218533640458*kSq[6]-0.0127775312999988*kSq[5]-0.0127775312999988*kSq[4]+(0.2666666666666667*epsilon[0]*rdx2Sq[0]*bcVals[3])/bcVals[4]-0.04666666666666667*kSq[3]-0.03849001794597505*kSq[2]+0.5777777777777777*epsilon[0]*rdx2Sq[1]-0.03849001794597505*kSq[1]+0.5777777777777777*epsilon[0]*rdx2Sq[0]-0.06666666666666667*kSq[0]);

}
void fem_poisson_lhs_stencil_consteps_2x_ser_p1_upx_robinx_upy_robiny(const double *epsilon, const double *kSq, const double *dx, const double *bcVals, const long *globalIdxs, gkyl_mat_triples *tri) 
{ 
  // epsilon: permittivity.
  // kSq: wave number squared (factor multiplying phi).
  // dx: cell length in each direction.
  // bcVals[3]: values to impose as BCs, i.e. bcVals[0]*phi+bcVals[1]*d(phi)/dx=bcVals[2].
  // globalIdxs: global linear index of each basis function/node in current cell.
  // tri: triples object (i,j,val), i.e. contribute val to i,j element of the global matrix.

  double rdx2Sq[2];
  rdx2Sq[0] = 4.0/(dx[0]*dx[0]);
  rdx2Sq[1] = 4.0/(dx[1]*dx[1]);

  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[0], (-0.1666666666666667*kSq[3])+0.1924500897298752*kSq[2]+0.3333333333333333*epsilon[0]*rdx2Sq[1]+0.1924500897298752*kSq[1]+0.3333333333333333*epsilon[0]*rdx2Sq[0]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[1], 0.09622504486493762*kSq[2]+0.1666666666666667*epsilon[0]*rdx2Sq[1]-0.3333333333333333*epsilon[0]*rdx2Sq[0]-0.1111111111111111*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[2], (-0.3333333333333333*epsilon[0]*rdx2Sq[1])+0.09622504486493762*kSq[1]+0.1666666666666667*epsilon[0]*rdx2Sq[0]-0.1111111111111111*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[3], (-0.1666666666666667*epsilon[0]*rdx2Sq[1])-0.1666666666666667*epsilon[0]*rdx2Sq[0]-0.05555555555555555*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[0], 0.09622504486493762*kSq[2]+0.1666666666666667*epsilon[0]*rdx2Sq[1]-0.3333333333333333*epsilon[0]*rdx2Sq[0]-0.1111111111111111*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[1], (0.6666666666666666*epsilon[0]*rdx2Sq[0]*bcVals[3])/bcVals[4]+0.1666666666666667*kSq[3]+0.1924500897298752*kSq[2]+0.3333333333333333*epsilon[0]*rdx2Sq[1]-0.1924500897298752*kSq[1]+0.3333333333333333*epsilon[0]*rdx2Sq[0]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[2], (-0.1666666666666667*epsilon[0]*rdx2Sq[1])-0.1666666666666667*epsilon[0]*rdx2Sq[0]-0.05555555555555555*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[3], (0.3333333333333333*epsilon[0]*rdx2Sq[0]*bcVals[3])/bcVals[4]-0.3333333333333333*epsilon[0]*rdx2Sq[1]-0.09622504486493762*kSq[1]+0.1666666666666667*epsilon[0]*rdx2Sq[0]-0.1111111111111111*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[0], (-0.3333333333333333*epsilon[0]*rdx2Sq[1])+0.09622504486493762*kSq[1]+0.1666666666666667*epsilon[0]*rdx2Sq[0]-0.1111111111111111*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[1], (-0.1666666666666667*epsilon[0]*rdx2Sq[1])-0.1666666666666667*epsilon[0]*rdx2Sq[0]-0.05555555555555555*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[2], (0.6666666666666666*epsilon[0]*rdx2Sq[1]*bcVals[9])/bcVals[10]+0.1666666666666667*kSq[3]-0.1924500897298752*kSq[2]+0.3333333333333333*epsilon[0]*rdx2Sq[1]+0.1924500897298752*kSq[1]+0.3333333333333333*epsilon[0]*rdx2Sq[0]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[3], (0.3333333333333333*epsilon[0]*rdx2Sq[1]*bcVals[9])/bcVals[10]-0.09622504486493762*kSq[2]+0.1666666666666667*epsilon[0]*rdx2Sq[1]-0.3333333333333333*epsilon[0]*rdx2Sq[0]-0.1111111111111111*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[0], (-0.1666666666666667*epsilon[0]*rdx2Sq[1])-0.1666666666666667*epsilon[0]*rdx2Sq[0]-0.05555555555555555*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[1], (0.3333333333333333*epsilon[0]*rdx2Sq[0]*bcVals[3])/bcVals[4]-0.3333333333333333*epsilon[0]*rdx2Sq[1]-0.09622504486493762*kSq[1]+0.1666666666666667*epsilon[0]*rdx2Sq[0]-0.1111111111111111*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[2], (0.3333333333333333*epsilon[0]*rdx2Sq[1]*bcVals[9])/bcVals[10]-0.09622504486493762*kSq[2]+0.1666666666666667*epsilon[0]*rdx2Sq[1]-0.3333333333333333*epsilon[0]*rdx2Sq[0]-0.1111111111111111*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[3], (0.6666666666666666*epsilon[0]*rdx2Sq[1]*bcVals[9])/bcVals[10]+(0.6666666666666666*epsilon[0]*rdx2Sq[0]*bcVals[3])/bcVals[4]-0.1666666666666667*kSq[3]-0.1924500897298752*kSq[2]+0.3333333333333333*epsilon[0]*rdx2Sq[1]-0.1924500897298752*kSq[1]+0.3333333333333333*epsilon[0]*rdx2Sq[0]-0.2222222222222222*kSq[0]);

}
void fem_poisson_lhs_stencil_consteps_2x_ser_p2_upx_robinx_upy_robiny(const double *epsilon, const double *kSq, const double *dx, const double *bcVals, const long *globalIdxs, gkyl_mat_triples *tri) 
{ 
  // epsilon: permittivity.
  // kSq: wave number squared (factor multiplying phi).
  // dx: cell length in each direction.
  // bcVals[3]: values to impose as BCs, i.e. bcVals[0]*phi+bcVals[1]*d(phi)/dx=bcVals[2].
  // globalIdxs: global linear index of each basis function/node in current cell.
  // tri: triples object (i,j,val), i.e. contribute val to i,j element of the global matrix.

  double rdx2Sq[2];
  rdx2Sq[0] = 4.0/(dx[0]*dx[0]);
  rdx2Sq[1] = 4.0/(dx[1]*dx[1]);

  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[0], 0.04549218533640458*kSq[7]+0.04549218533640458*kSq[6]-0.0127775312999988*kSq[5]-0.0127775312999988*kSq[4]-0.04666666666666667*kSq[3]+0.03849001794597505*kSq[2]+0.5777777777777777*epsilon[0]*rdx2Sq[1]+0.03849001794597505*kSq[1]+0.5777777777777777*epsilon[0]*rdx2Sq[0]-0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[1], 0.03442651863295482*kSq[7]+0.0295084445425327*kSq[6]-0.05962847939999439*kSq[5]-0.063887656499994*kSq[4]-0.05333333333333333*kSq[3]+0.06666666666666667*epsilon[0]*rdx2Sq[1]+0.03849001794597505*kSq[1]-0.8888888888888888*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[2], (-0.006147592613027645*kSq[6])+0.03336355394999686*kSq[5]+0.02697478829999747*kSq[4]-0.01924500897298752*kSq[2]+0.1888888888888889*epsilon[0]*rdx2Sq[1]+0.3111111111111111*epsilon[0]*rdx2Sq[0]-0.02222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[3], 0.0295084445425327*kSq[7]+0.03442651863295482*kSq[6]-0.063887656499994*kSq[5]-0.05962847939999439*kSq[4]-0.05333333333333333*kSq[3]+0.03849001794597505*kSq[2]-0.8888888888888888*epsilon[0]*rdx2Sq[1]+0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[4], (-0.01721325931647741*kSq[7])-0.05678902799999467*kSq[5]-0.03975231959999626*kSq[4]-0.01333333333333333*kSq[3]-0.4444444444444444*epsilon[0]*rdx2Sq[1]+0.03849001794597505*kSq[1]-0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[5], (-0.006147592613027645*kSq[7])+0.02697478829999747*kSq[5]+0.03336355394999686*kSq[4]+0.3111111111111111*epsilon[0]*rdx2Sq[1]-0.01924500897298752*kSq[1]+0.1888888888888889*epsilon[0]*rdx2Sq[0]-0.02222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[6], (-0.01721325931647741*kSq[6])-0.03975231959999626*kSq[5]-0.05678902799999467*kSq[4]-0.01333333333333333*kSq[3]+0.03849001794597505*kSq[2]-0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.4444444444444444*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[7], 0.0234254740499978*kSq[5]+0.0234254740499978*kSq[4]+0.01333333333333333*kSq[3]+0.2555555555555555*epsilon[0]*rdx2Sq[1]+0.2555555555555555*epsilon[0]*rdx2Sq[0]-0.03333333333333333*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[0], 0.03442651863295482*kSq[7]+0.0295084445425327*kSq[6]-0.05962847939999439*kSq[5]-0.063887656499994*kSq[4]-0.05333333333333333*kSq[3]+0.06666666666666667*epsilon[0]*rdx2Sq[1]+0.03849001794597505*kSq[1]-0.8888888888888888*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[1], (-0.1967229636168847*kSq[6])-0.07950463919999252*kSq[5]+0.2271561119999787*kSq[4]+0.3079201435678004*kSq[2]+0.5333333333333333*epsilon[0]*rdx2Sq[1]+1.777777777777778*epsilon[0]*rdx2Sq[0]-0.3555555555555556*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[2], (-0.03442651863295482*kSq[7])+0.0295084445425327*kSq[6]-0.05962847939999439*kSq[5]-0.063887656499994*kSq[4]+0.05333333333333333*kSq[3]+0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.03849001794597505*kSq[1]-0.8888888888888888*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[3], (-0.03442651863295482*kSq[7])-0.03442651863295482*kSq[6]+0.09938079899999068*kSq[5]+0.09938079899999068*kSq[4]-0.02666666666666666*kSq[3]+0.0769800358919501*kSq[2]+0.0769800358919501*kSq[1]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[4], 0.03442651863295482*kSq[7]-0.03442651863295482*kSq[6]+0.09938079899999068*kSq[5]+0.09938079899999068*kSq[4]+0.02666666666666666*kSq[3]+0.0769800358919501*kSq[2]-0.0769800358919501*kSq[1]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[5], 0.01721325931647741*kSq[6]-0.03975231959999626*kSq[5]-0.05678902799999467*kSq[4]+0.01333333333333333*kSq[3]-0.03849001794597505*kSq[2]-0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.4444444444444444*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[6], 0.07950463919999252*kSq[5]+0.1135780559999893*kSq[4]-0.5333333333333333*epsilon[0]*rdx2Sq[1]+0.8888888888888888*epsilon[0]*rdx2Sq[0]-0.1777777777777778*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[7], 0.01721325931647741*kSq[6]-0.03975231959999626*kSq[5]-0.05678902799999467*kSq[4]-0.01333333333333333*kSq[3]-0.03849001794597505*kSq[2]-0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.4444444444444444*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[0], (-0.006147592613027645*kSq[6])+0.03336355394999686*kSq[5]+0.02697478829999747*kSq[4]-0.01924500897298752*kSq[2]+0.1888888888888889*epsilon[0]*rdx2Sq[1]+0.3111111111111111*epsilon[0]*rdx2Sq[0]-0.02222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[1], (-0.03442651863295482*kSq[7])+0.0295084445425327*kSq[6]-0.05962847939999439*kSq[5]-0.063887656499994*kSq[4]+0.05333333333333333*kSq[3]+0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.03849001794597505*kSq[1]-0.8888888888888888*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[2], (-0.04549218533640458*kSq[7])+0.04549218533640458*kSq[6]-0.0127775312999988*kSq[5]-0.0127775312999988*kSq[4]+(0.2666666666666667*epsilon[0]*rdx2Sq[0]*bcVals[3])/bcVals[4]+0.04666666666666667*kSq[3]+0.03849001794597505*kSq[2]+0.5777777777777777*epsilon[0]*rdx2Sq[1]-0.03849001794597505*kSq[1]+0.5777777777777777*epsilon[0]*rdx2Sq[0]-0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[3], 0.01721325931647741*kSq[7]-0.05678902799999467*kSq[5]-0.03975231959999626*kSq[4]+0.01333333333333333*kSq[3]-0.4444444444444444*epsilon[0]*rdx2Sq[1]-0.03849001794597505*kSq[1]-0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[4], (-0.0295084445425327*kSq[7])+0.03442651863295482*kSq[6]-0.063887656499994*kSq[5]-0.05962847939999439*kSq[4]+(0.1333333333333333*epsilon[0]*rdx2Sq[0]*bcVals[3])/bcVals[4]+0.05333333333333333*kSq[3]+0.03849001794597505*kSq[2]-0.8888888888888888*epsilon[0]*rdx2Sq[1]+0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[5], 0.0234254740499978*kSq[5]+0.0234254740499978*kSq[4]-0.01333333333333333*kSq[3]+0.2555555555555555*epsilon[0]*rdx2Sq[1]+0.2555555555555555*epsilon[0]*rdx2Sq[0]-0.03333333333333333*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[6], (-0.01721325931647741*kSq[6])-0.03975231959999626*kSq[5]-0.05678902799999467*kSq[4]+0.01333333333333333*kSq[3]+0.03849001794597505*kSq[2]-0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.4444444444444444*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[7], 0.006147592613027645*kSq[7]+0.02697478829999747*kSq[5]+0.03336355394999686*kSq[4]-(0.06666666666666667*epsilon[0]*rdx2Sq[0]*bcVals[3])/bcVals[4]+0.3111111111111111*epsilon[0]*rdx2Sq[1]+0.01924500897298752*kSq[1]+0.1888888888888889*epsilon[0]*rdx2Sq[0]-0.02222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[0], 0.0295084445425327*kSq[7]+0.03442651863295482*kSq[6]-0.063887656499994*kSq[5]-0.05962847939999439*kSq[4]-0.05333333333333333*kSq[3]+0.03849001794597505*kSq[2]-0.8888888888888888*epsilon[0]*rdx2Sq[1]+0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[1], (-0.03442651863295482*kSq[7])-0.03442651863295482*kSq[6]+0.09938079899999068*kSq[5]+0.09938079899999068*kSq[4]-0.02666666666666666*kSq[3]+0.0769800358919501*kSq[2]+0.0769800358919501*kSq[1]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[2], 0.01721325931647741*kSq[7]-0.05678902799999467*kSq[5]-0.03975231959999626*kSq[4]+0.01333333333333333*kSq[3]-0.4444444444444444*epsilon[0]*rdx2Sq[1]-0.03849001794597505*kSq[1]-0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[3], (-0.1967229636168847*kSq[7])+0.2271561119999787*kSq[5]-0.07950463919999252*kSq[4]+1.777777777777778*epsilon[0]*rdx2Sq[1]+0.3079201435678004*kSq[1]+0.5333333333333333*epsilon[0]*rdx2Sq[0]-0.3555555555555556*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[4], 0.1135780559999893*kSq[5]+0.07950463919999252*kSq[4]+0.8888888888888888*epsilon[0]*rdx2Sq[1]-0.5333333333333333*epsilon[0]*rdx2Sq[0]-0.1777777777777778*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[5], 0.0295084445425327*kSq[7]-0.03442651863295482*kSq[6]-0.063887656499994*kSq[5]-0.05962847939999439*kSq[4]+0.05333333333333333*kSq[3]-0.03849001794597505*kSq[2]-0.8888888888888888*epsilon[0]*rdx2Sq[1]+0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[6], (-0.03442651863295482*kSq[7])+0.03442651863295482*kSq[6]+0.09938079899999068*kSq[5]+0.09938079899999068*kSq[4]+0.02666666666666666*kSq[3]-0.0769800358919501*kSq[2]+0.0769800358919501*kSq[1]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[7], 0.01721325931647741*kSq[7]-0.05678902799999467*kSq[5]-0.03975231959999626*kSq[4]-0.01333333333333333*kSq[3]-0.4444444444444444*epsilon[0]*rdx2Sq[1]-0.03849001794597505*kSq[1]-0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[4], globalIdxs[0], (-0.01721325931647741*kSq[7])-0.05678902799999467*kSq[5]-0.03975231959999626*kSq[4]-0.01333333333333333*kSq[3]-0.4444444444444444*epsilon[0]*rdx2Sq[1]+0.03849001794597505*kSq[1]-0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[4], globalIdxs[1], 0.03442651863295482*kSq[7]-0.03442651863295482*kSq[6]+0.09938079899999068*kSq[5]+0.09938079899999068*kSq[4]+0.02666666666666666*kSq[3]+0.0769800358919501*kSq[2]-0.0769800358919501*kSq[1]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[4], globalIdxs[2], (-0.0295084445425327*kSq[7])+0.03442651863295482*kSq[6]-0.063887656499994*kSq[5]-0.05962847939999439*kSq[4]+(0.1333333333333333*epsilon[0]*rdx2Sq[0]*bcVals[3])/bcVals[4]+0.05333333333333333*kSq[3]+0.03849001794597505*kSq[2]-0.8888888888888888*epsilon[0]*rdx2Sq[1]+0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[4], globalIdxs[3], 0.1135780559999893*kSq[5]+0.07950463919999252*kSq[4]+0.8888888888888888*epsilon[0]*rdx2Sq[1]-0.5333333333333333*epsilon[0]*rdx2Sq[0]-0.1777777777777778*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[4], globalIdxs[4], 0.1967229636168847*kSq[7]+0.2271561119999787*kSq[5]-0.07950463919999252*kSq[4]+(1.066666666666667*epsilon[0]*rdx2Sq[0]*bcVals[3])/bcVals[4]+1.777777777777778*epsilon[0]*rdx2Sq[1]-0.3079201435678004*kSq[1]+0.5333333333333333*epsilon[0]*rdx2Sq[0]-0.3555555555555556*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[4], globalIdxs[5], (-0.01721325931647741*kSq[7])-0.05678902799999467*kSq[5]-0.03975231959999626*kSq[4]+0.01333333333333333*kSq[3]-0.4444444444444444*epsilon[0]*rdx2Sq[1]+0.03849001794597505*kSq[1]-0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[4], globalIdxs[6], 0.03442651863295482*kSq[7]+0.03442651863295482*kSq[6]+0.09938079899999068*kSq[5]+0.09938079899999068*kSq[4]-0.02666666666666666*kSq[3]-0.0769800358919501*kSq[2]-0.0769800358919501*kSq[1]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[4], globalIdxs[7], (-0.0295084445425327*kSq[7])-0.03442651863295482*kSq[6]-0.063887656499994*kSq[5]-0.05962847939999439*kSq[4]+(0.1333333333333333*epsilon[0]*rdx2Sq[0]*bcVals[3])/bcVals[4]-0.05333333333333333*kSq[3]-0.03849001794597505*kSq[2]-0.8888888888888888*epsilon[0]*rdx2Sq[1]+0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[5], globalIdxs[0], (-0.006147592613027645*kSq[7])+0.02697478829999747*kSq[5]+0.03336355394999686*kSq[4]+0.3111111111111111*epsilon[0]*rdx2Sq[1]-0.01924500897298752*kSq[1]+0.1888888888888889*epsilon[0]*rdx2Sq[0]-0.02222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[5], globalIdxs[1], 0.01721325931647741*kSq[6]-0.03975231959999626*kSq[5]-0.05678902799999467*kSq[4]+0.01333333333333333*kSq[3]-0.03849001794597505*kSq[2]-0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.4444444444444444*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[5], globalIdxs[2], 0.0234254740499978*kSq[5]+0.0234254740499978*kSq[4]-0.01333333333333333*kSq[3]+0.2555555555555555*epsilon[0]*rdx2Sq[1]+0.2555555555555555*epsilon[0]*rdx2Sq[0]-0.03333333333333333*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[5], globalIdxs[3], 0.0295084445425327*kSq[7]-0.03442651863295482*kSq[6]-0.063887656499994*kSq[5]-0.05962847939999439*kSq[4]+0.05333333333333333*kSq[3]-0.03849001794597505*kSq[2]-0.8888888888888888*epsilon[0]*rdx2Sq[1]+0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[5], globalIdxs[4], (-0.01721325931647741*kSq[7])-0.05678902799999467*kSq[5]-0.03975231959999626*kSq[4]+0.01333333333333333*kSq[3]-0.4444444444444444*epsilon[0]*rdx2Sq[1]+0.03849001794597505*kSq[1]-0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[5], globalIdxs[5], (0.2666666666666667*epsilon[0]*rdx2Sq[1]*bcVals[9])/bcVals[10]+0.04549218533640458*kSq[7]-0.04549218533640458*kSq[6]-0.0127775312999988*kSq[5]-0.0127775312999988*kSq[4]+0.04666666666666667*kSq[3]-0.03849001794597505*kSq[2]+0.5777777777777777*epsilon[0]*rdx2Sq[1]+0.03849001794597505*kSq[1]+0.5777777777777777*epsilon[0]*rdx2Sq[0]-0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[5], globalIdxs[6], (0.1333333333333333*epsilon[0]*rdx2Sq[1]*bcVals[9])/bcVals[10]+0.03442651863295482*kSq[7]-0.0295084445425327*kSq[6]-0.05962847939999439*kSq[5]-0.063887656499994*kSq[4]+0.05333333333333333*kSq[3]+0.06666666666666667*epsilon[0]*rdx2Sq[1]+0.03849001794597505*kSq[1]-0.8888888888888888*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[5], globalIdxs[7], (-(0.06666666666666667*epsilon[0]*rdx2Sq[1]*bcVals[9])/bcVals[10])+0.006147592613027645*kSq[6]+0.03336355394999686*kSq[5]+0.02697478829999747*kSq[4]+0.01924500897298752*kSq[2]+0.1888888888888889*epsilon[0]*rdx2Sq[1]+0.3111111111111111*epsilon[0]*rdx2Sq[0]-0.02222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[6], globalIdxs[0], (-0.01721325931647741*kSq[6])-0.03975231959999626*kSq[5]-0.05678902799999467*kSq[4]-0.01333333333333333*kSq[3]+0.03849001794597505*kSq[2]-0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.4444444444444444*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[6], globalIdxs[1], 0.07950463919999252*kSq[5]+0.1135780559999893*kSq[4]-0.5333333333333333*epsilon[0]*rdx2Sq[1]+0.8888888888888888*epsilon[0]*rdx2Sq[0]-0.1777777777777778*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[6], globalIdxs[2], (-0.01721325931647741*kSq[6])-0.03975231959999626*kSq[5]-0.05678902799999467*kSq[4]+0.01333333333333333*kSq[3]+0.03849001794597505*kSq[2]-0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.4444444444444444*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[6], globalIdxs[3], (-0.03442651863295482*kSq[7])+0.03442651863295482*kSq[6]+0.09938079899999068*kSq[5]+0.09938079899999068*kSq[4]+0.02666666666666666*kSq[3]-0.0769800358919501*kSq[2]+0.0769800358919501*kSq[1]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[6], globalIdxs[4], 0.03442651863295482*kSq[7]+0.03442651863295482*kSq[6]+0.09938079899999068*kSq[5]+0.09938079899999068*kSq[4]-0.02666666666666666*kSq[3]-0.0769800358919501*kSq[2]-0.0769800358919501*kSq[1]-0.2222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[6], globalIdxs[5], (0.1333333333333333*epsilon[0]*rdx2Sq[1]*bcVals[9])/bcVals[10]+0.03442651863295482*kSq[7]-0.0295084445425327*kSq[6]-0.05962847939999439*kSq[5]-0.063887656499994*kSq[4]+0.05333333333333333*kSq[3]+0.06666666666666667*epsilon[0]*rdx2Sq[1]+0.03849001794597505*kSq[1]-0.8888888888888888*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[6], globalIdxs[6], (1.066666666666667*epsilon[0]*rdx2Sq[1]*bcVals[9])/bcVals[10]+0.1967229636168847*kSq[6]-0.07950463919999252*kSq[5]+0.2271561119999787*kSq[4]-0.3079201435678004*kSq[2]+0.5333333333333333*epsilon[0]*rdx2Sq[1]+1.777777777777778*epsilon[0]*rdx2Sq[0]-0.3555555555555556*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[6], globalIdxs[7], (0.1333333333333333*epsilon[0]*rdx2Sq[1]*bcVals[9])/bcVals[10]-0.03442651863295482*kSq[7]-0.0295084445425327*kSq[6]-0.05962847939999439*kSq[5]-0.063887656499994*kSq[4]-0.05333333333333333*kSq[3]+0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.03849001794597505*kSq[1]-0.8888888888888888*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[7], globalIdxs[0], 0.0234254740499978*kSq[5]+0.0234254740499978*kSq[4]+0.01333333333333333*kSq[3]+0.2555555555555555*epsilon[0]*rdx2Sq[1]+0.2555555555555555*epsilon[0]*rdx2Sq[0]-0.03333333333333333*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[7], globalIdxs[1], 0.01721325931647741*kSq[6]-0.03975231959999626*kSq[5]-0.05678902799999467*kSq[4]-0.01333333333333333*kSq[3]-0.03849001794597505*kSq[2]-0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.4444444444444444*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[7], globalIdxs[2], 0.006147592613027645*kSq[7]+0.02697478829999747*kSq[5]+0.03336355394999686*kSq[4]-(0.06666666666666667*epsilon[0]*rdx2Sq[0]*bcVals[3])/bcVals[4]+0.3111111111111111*epsilon[0]*rdx2Sq[1]+0.01924500897298752*kSq[1]+0.1888888888888889*epsilon[0]*rdx2Sq[0]-0.02222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[7], globalIdxs[3], 0.01721325931647741*kSq[7]-0.05678902799999467*kSq[5]-0.03975231959999626*kSq[4]-0.01333333333333333*kSq[3]-0.4444444444444444*epsilon[0]*rdx2Sq[1]-0.03849001794597505*kSq[1]-0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.08888888888888889*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[7], globalIdxs[4], (-0.0295084445425327*kSq[7])-0.03442651863295482*kSq[6]-0.063887656499994*kSq[5]-0.05962847939999439*kSq[4]+(0.1333333333333333*epsilon[0]*rdx2Sq[0]*bcVals[3])/bcVals[4]-0.05333333333333333*kSq[3]-0.03849001794597505*kSq[2]-0.8888888888888888*epsilon[0]*rdx2Sq[1]+0.06666666666666667*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[7], globalIdxs[5], (-(0.06666666666666667*epsilon[0]*rdx2Sq[1]*bcVals[9])/bcVals[10])+0.006147592613027645*kSq[6]+0.03336355394999686*kSq[5]+0.02697478829999747*kSq[4]+0.01924500897298752*kSq[2]+0.1888888888888889*epsilon[0]*rdx2Sq[1]+0.3111111111111111*epsilon[0]*rdx2Sq[0]-0.02222222222222222*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[7], globalIdxs[6], (0.1333333333333333*epsilon[0]*rdx2Sq[1]*bcVals[9])/bcVals[10]-0.03442651863295482*kSq[7]-0.0295084445425327*kSq[6]-0.05962847939999439*kSq[5]-0.063887656499994*kSq[4]-0.05333333333333333*kSq[3]+0.06666666666666667*epsilon[0]*rdx2Sq[1]-0.03849001794597505*kSq[1]-0.8888888888888888*epsilon[0]*rdx2Sq[0]+0.06666666666666667*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[7], globalIdxs[7], (0.2666666666666667*epsilon[0]*rdx2Sq[1]*bcVals[9])/bcVals[10]-0.04549218533640458*kSq[7]-0.04549218533640458*kSq[6]-0.0127775312999988*kSq[5]-0.0127775312999988*kSq[4]+(0.2666666666666667*epsilon[0]*rdx2Sq[0]*bcVals[3])/bcVals[4]-0.04666666666666667*kSq[3]-0.03849001794597505*kSq[2]+0.5777777777777777*epsilon[0]*rdx2Sq[1]-0.03849001794597505*kSq[1]+0.5777777777777777*epsilon[0]*rdx2Sq[0]-0.06666666666666667*kSq[0]);

}
