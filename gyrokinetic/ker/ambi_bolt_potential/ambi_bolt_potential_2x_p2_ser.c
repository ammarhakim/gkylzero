#include <gkyl_ambi_bolt_potential_kernels.h>

GKYL_CU_DH void ambi_bolt_potential_sheath_calc_lower_2x_ser_p2(double sheathDirDx, double q_e, double m_e, double T_e, const double *cmag, const double *jacobtotInv, const double *GammaJac_i, const double *m0Ion, const double *m0JacIon, double *out) 
{ 
  // sheathDirDx: cell length in direction of the sheath.
  // q_e:         electron change.
  // m_e:         electron mass.
  // T_e:         electron temperature.
  // cmag:        Clebsch function in definition of magnetic field.
  // jacobtotInv: reciprocal of the phase-space and conf-space Jacobians (1/(J*B)).
  // GammaJac_i:  ion particle flux (times the Jacobian) through sheath entrance.
  // m0Ion:       ion density.
  // m0JacIon:    ion density (times the geometry Jacobian).
  // out:         ion density and electrostatic potential at the sheath entrance.

  // Particle number density evaluate at the sheath entrance
  out[0] = 2.23606797749979*m0Ion[5]-1.7320508075688772*m0Ion[2]+m0Ion[0]; 
  out[1] = 0.3333333333333333*(6.7082039324993685*m0Ion[7]-5.196152422706631*m0Ion[3]+3.0*m0Ion[1]); 
  out[4] = -(0.2*(8.660254037844387*m0Ion[6]-5.0*m0Ion[4])); 

  double GammaJacIonB[3];
  GammaJacIonB[0] = 0.7905694150420947*GammaJac_i[5]*sheathDirDx+0.6123724356957944*GammaJac_i[2]*sheathDirDx+0.3535533905932737*GammaJac_i[0]*sheathDirDx; 
  GammaJacIonB[1] = 0.7905694150420948*GammaJac_i[7]*sheathDirDx+0.6123724356957944*GammaJac_i[3]*sheathDirDx+0.3535533905932737*GammaJac_i[1]*sheathDirDx; 
  GammaJacIonB[2] = 0.6123724356957944*GammaJac_i[6]*sheathDirDx+0.3535533905932737*GammaJac_i[4]*sheathDirDx; 

  double x3HalfMomJacElcB[3];
  x3HalfMomJacElcB[0] = 0.1410473958869391*cmag[1]*jacobtotInv[4]*m0JacIon[7]*sqrt(T_e/m_e)+0.1410473958869391*jacobtotInv[1]*cmag[4]*m0JacIon[7]*sqrt(T_e/m_e)+0.15769578262626005*cmag[0]*jacobtotInv[1]*m0JacIon[7]*sqrt(T_e/m_e)+0.15769578262626005*jacobtotInv[0]*cmag[1]*m0JacIon[7]*sqrt(T_e/m_e)-0.07803917361371993*cmag[4]*jacobtotInv[4]*m0JacIon[6]*sqrt(T_e/m_e)-0.12215062797572998*cmag[0]*jacobtotInv[4]*m0JacIon[6]*sqrt(T_e/m_e)-0.12215062797572998*jacobtotInv[0]*cmag[4]*m0JacIon[6]*sqrt(T_e/m_e)-0.1092548430592079*cmag[1]*jacobtotInv[1]*m0JacIon[6]*sqrt(T_e/m_e)+0.15769578262626*cmag[4]*jacobtotInv[4]*m0JacIon[5]*sqrt(T_e/m_e)+0.15769578262626*cmag[1]*jacobtotInv[1]*m0JacIon[5]*sqrt(T_e/m_e)+0.15769578262626*cmag[0]*jacobtotInv[0]*m0JacIon[5]*sqrt(T_e/m_e)+0.04505593789321714*cmag[4]*jacobtotInv[4]*m0JacIon[4]*sqrt(T_e/m_e)+0.07052369794346953*cmag[0]*jacobtotInv[4]*m0JacIon[4]*sqrt(T_e/m_e)+0.07052369794346953*jacobtotInv[0]*cmag[4]*m0JacIon[4]*sqrt(T_e/m_e)+0.063078313050504*cmag[1]*jacobtotInv[1]*m0JacIon[4]*sqrt(T_e/m_e)-0.12215062797572997*m0JacIon[2]*cmag[4]*jacobtotInv[4]*sqrt(T_e/m_e)+0.07052369794346953*m0JacIon[0]*cmag[4]*jacobtotInv[4]*sqrt(T_e/m_e)-0.10925484305920789*cmag[1]*m0JacIon[3]*jacobtotInv[4]*sqrt(T_e/m_e)+0.063078313050504*cmag[1]*m0JacIon[1]*jacobtotInv[4]*sqrt(T_e/m_e)-0.10925484305920789*jacobtotInv[1]*m0JacIon[3]*cmag[4]*sqrt(T_e/m_e)+0.063078313050504*jacobtotInv[1]*m0JacIon[1]*cmag[4]*sqrt(T_e/m_e)-0.12215062797572997*cmag[0]*jacobtotInv[1]*m0JacIon[3]*sqrt(T_e/m_e)-0.12215062797572997*jacobtotInv[0]*cmag[1]*m0JacIon[3]*sqrt(T_e/m_e)-0.12215062797572997*cmag[1]*jacobtotInv[1]*m0JacIon[2]*sqrt(T_e/m_e)-0.12215062797572997*cmag[0]*jacobtotInv[0]*m0JacIon[2]*sqrt(T_e/m_e)+0.07052369794346953*cmag[0]*jacobtotInv[1]*m0JacIon[1]*sqrt(T_e/m_e)+0.07052369794346953*jacobtotInv[0]*cmag[1]*m0JacIon[1]*sqrt(T_e/m_e)+0.07052369794346953*m0JacIon[0]*cmag[1]*jacobtotInv[1]*sqrt(T_e/m_e)+0.07052369794346953*cmag[0]*jacobtotInv[0]*m0JacIon[0]*sqrt(T_e/m_e); 
  x3HalfMomJacElcB[1] = 0.24780765841269434*cmag[4]*jacobtotInv[4]*m0JacIon[7]*sqrt(T_e/m_e)+0.1410473958869391*cmag[0]*jacobtotInv[4]*m0JacIon[7]*sqrt(T_e/m_e)+0.1410473958869391*jacobtotInv[0]*cmag[4]*m0JacIon[7]*sqrt(T_e/m_e)+0.28385240872726797*cmag[1]*jacobtotInv[1]*m0JacIon[7]*sqrt(T_e/m_e)+0.15769578262626005*cmag[0]*jacobtotInv[0]*m0JacIon[7]*sqrt(T_e/m_e)-0.19195098681900427*cmag[1]*jacobtotInv[4]*m0JacIon[6]*sqrt(T_e/m_e)-0.19195098681900427*jacobtotInv[1]*cmag[4]*m0JacIon[6]*sqrt(T_e/m_e)-0.1092548430592079*cmag[0]*jacobtotInv[1]*m0JacIon[6]*sqrt(T_e/m_e)-0.1092548430592079*jacobtotInv[0]*cmag[1]*m0JacIon[6]*sqrt(T_e/m_e)+0.14104739588693907*cmag[1]*jacobtotInv[4]*m0JacIon[5]*sqrt(T_e/m_e)+0.14104739588693907*jacobtotInv[1]*cmag[4]*m0JacIon[5]*sqrt(T_e/m_e)+0.15769578262626*cmag[0]*jacobtotInv[1]*m0JacIon[5]*sqrt(T_e/m_e)+0.15769578262626*jacobtotInv[0]*cmag[1]*m0JacIon[5]*sqrt(T_e/m_e)+0.11082295391116641*cmag[1]*jacobtotInv[4]*m0JacIon[4]*sqrt(T_e/m_e)+0.11082295391116641*jacobtotInv[1]*cmag[4]*m0JacIon[4]*sqrt(T_e/m_e)+0.063078313050504*cmag[0]*jacobtotInv[1]*m0JacIon[4]*sqrt(T_e/m_e)+0.063078313050504*jacobtotInv[0]*cmag[1]*m0JacIon[4]*sqrt(T_e/m_e)-0.19195098681900424*m0JacIon[3]*cmag[4]*jacobtotInv[4]*sqrt(T_e/m_e)+0.11082295391116641*m0JacIon[1]*cmag[4]*jacobtotInv[4]*sqrt(T_e/m_e)-0.10925484305920789*cmag[0]*m0JacIon[3]*jacobtotInv[4]*sqrt(T_e/m_e)-0.10925484305920789*cmag[1]*m0JacIon[2]*jacobtotInv[4]*sqrt(T_e/m_e)+0.063078313050504*cmag[0]*m0JacIon[1]*jacobtotInv[4]*sqrt(T_e/m_e)+0.063078313050504*m0JacIon[0]*cmag[1]*jacobtotInv[4]*sqrt(T_e/m_e)-0.10925484305920789*jacobtotInv[0]*m0JacIon[3]*cmag[4]*sqrt(T_e/m_e)-0.10925484305920789*jacobtotInv[1]*m0JacIon[2]*cmag[4]*sqrt(T_e/m_e)+0.063078313050504*jacobtotInv[0]*m0JacIon[1]*cmag[4]*sqrt(T_e/m_e)+0.063078313050504*m0JacIon[0]*jacobtotInv[1]*cmag[4]*sqrt(T_e/m_e)-0.2198711303563139*cmag[1]*jacobtotInv[1]*m0JacIon[3]*sqrt(T_e/m_e)-0.12215062797572997*cmag[0]*jacobtotInv[0]*m0JacIon[3]*sqrt(T_e/m_e)-0.12215062797572997*cmag[0]*jacobtotInv[1]*m0JacIon[2]*sqrt(T_e/m_e)-0.12215062797572997*jacobtotInv[0]*cmag[1]*m0JacIon[2]*sqrt(T_e/m_e)+0.12694265629824517*cmag[1]*jacobtotInv[1]*m0JacIon[1]*sqrt(T_e/m_e)+0.07052369794346953*cmag[0]*jacobtotInv[0]*m0JacIon[1]*sqrt(T_e/m_e)+0.07052369794346953*cmag[0]*m0JacIon[0]*jacobtotInv[1]*sqrt(T_e/m_e)+0.07052369794346953*jacobtotInv[0]*m0JacIon[0]*cmag[1]*sqrt(T_e/m_e); 
  x3HalfMomJacElcB[2] = 0.24780765841269434*cmag[1]*jacobtotInv[4]*m0JacIon[7]*sqrt(T_e/m_e)+0.24780765841269434*jacobtotInv[1]*cmag[4]*m0JacIon[7]*sqrt(T_e/m_e)+0.1410473958869391*cmag[0]*jacobtotInv[1]*m0JacIon[7]*sqrt(T_e/m_e)+0.1410473958869391*jacobtotInv[0]*cmag[1]*m0JacIon[7]*sqrt(T_e/m_e)-0.26175134566227853*cmag[4]*jacobtotInv[4]*m0JacIon[6]*sqrt(T_e/m_e)-0.07803917361371993*cmag[0]*jacobtotInv[4]*m0JacIon[6]*sqrt(T_e/m_e)-0.07803917361371993*jacobtotInv[0]*cmag[4]*m0JacIon[6]*sqrt(T_e/m_e)-0.19195098681900427*cmag[1]*jacobtotInv[1]*m0JacIon[6]*sqrt(T_e/m_e)-0.12215062797572998*cmag[0]*jacobtotInv[0]*m0JacIon[6]*sqrt(T_e/m_e)+0.1007481399192422*cmag[4]*jacobtotInv[4]*m0JacIon[5]*sqrt(T_e/m_e)+0.15769578262626*cmag[0]*jacobtotInv[4]*m0JacIon[5]*sqrt(T_e/m_e)+0.15769578262626*jacobtotInv[0]*cmag[4]*m0JacIon[5]*sqrt(T_e/m_e)+0.14104739588693907*cmag[1]*jacobtotInv[1]*m0JacIon[5]*sqrt(T_e/m_e)+0.1511222098788633*cmag[4]*jacobtotInv[4]*m0JacIon[4]*sqrt(T_e/m_e)+0.04505593789321714*cmag[0]*jacobtotInv[4]*m0JacIon[4]*sqrt(T_e/m_e)+0.04505593789321714*jacobtotInv[0]*cmag[4]*m0JacIon[4]*sqrt(T_e/m_e)+0.11082295391116641*cmag[1]*jacobtotInv[1]*m0JacIon[4]*sqrt(T_e/m_e)+0.07052369794346953*cmag[0]*jacobtotInv[0]*m0JacIon[4]*sqrt(T_e/m_e)-0.07803917361371993*m0JacIon[2]*cmag[4]*jacobtotInv[4]*sqrt(T_e/m_e)+0.04505593789321714*m0JacIon[0]*cmag[4]*jacobtotInv[4]*sqrt(T_e/m_e)-0.19195098681900424*cmag[1]*m0JacIon[3]*jacobtotInv[4]*sqrt(T_e/m_e)-0.12215062797572997*cmag[0]*m0JacIon[2]*jacobtotInv[4]*sqrt(T_e/m_e)+0.11082295391116641*cmag[1]*m0JacIon[1]*jacobtotInv[4]*sqrt(T_e/m_e)+0.07052369794346953*cmag[0]*m0JacIon[0]*jacobtotInv[4]*sqrt(T_e/m_e)-0.19195098681900424*jacobtotInv[1]*m0JacIon[3]*cmag[4]*sqrt(T_e/m_e)-0.12215062797572997*jacobtotInv[0]*m0JacIon[2]*cmag[4]*sqrt(T_e/m_e)+0.11082295391116641*jacobtotInv[1]*m0JacIon[1]*cmag[4]*sqrt(T_e/m_e)+0.07052369794346953*jacobtotInv[0]*m0JacIon[0]*cmag[4]*sqrt(T_e/m_e)-0.10925484305920789*cmag[0]*jacobtotInv[1]*m0JacIon[3]*sqrt(T_e/m_e)-0.10925484305920789*jacobtotInv[0]*cmag[1]*m0JacIon[3]*sqrt(T_e/m_e)-0.10925484305920789*cmag[1]*jacobtotInv[1]*m0JacIon[2]*sqrt(T_e/m_e)+0.063078313050504*cmag[0]*jacobtotInv[1]*m0JacIon[1]*sqrt(T_e/m_e)+0.063078313050504*jacobtotInv[0]*cmag[1]*m0JacIon[1]*sqrt(T_e/m_e)+0.063078313050504*m0JacIon[0]*cmag[1]*jacobtotInv[1]*sqrt(T_e/m_e); 

  double m0JacIonB[3];
  m0JacIonB[0] = 1.5811388300841895*m0JacIon[5]-1.224744871391589*m0JacIon[2]+0.7071067811865475*m0JacIon[0]; 
  m0JacIonB[1] = 1.5811388300841898*m0JacIon[7]-1.224744871391589*m0JacIon[3]+0.7071067811865475*m0JacIon[1]; 
  m0JacIonB[2] = 0.7071067811865475*m0JacIon[4]-1.224744871391589*m0JacIon[6]; 

  double phiS_qp[3];
  if ((isfinite(0.6324555320336759*GammaJacIonB[2]-0.9486832980505137*GammaJacIonB[1]+0.7071067811865475*GammaJacIonB[0])) && (0.6324555320336759*GammaJacIonB[2]-0.9486832980505137*GammaJacIonB[1]+0.7071067811865475*GammaJacIonB[0]>0.) && (0.6324555320336759*m0JacIonB[2]-0.9486832980505137*m0JacIonB[1]+0.7071067811865475*m0JacIonB[0]>0.)) {
    phiS_qp[0] = (log(-((3.0*GammaJacIonB[1])/(2.0*x3HalfMomJacElcB[2]-3.0*x3HalfMomJacElcB[1]+2.23606797749979*x3HalfMomJacElcB[0]))+(1.4142135623730951*GammaJacIonB[2])/(1.4142135623730951*x3HalfMomJacElcB[2]-2.1213203435596424*x3HalfMomJacElcB[1]+1.5811388300841895*x3HalfMomJacElcB[0])+GammaJacIonB[0]/(0.8944271909999159*x3HalfMomJacElcB[2]-1.3416407864998738*x3HalfMomJacElcB[1]+x3HalfMomJacElcB[0]))*T_e)/q_e;
  } else {
    phiS_qp[0] = 0.0;
  }
  if ((isfinite(0.7071067811865475*GammaJacIonB[0]-0.7905694150420947*GammaJacIonB[2])) && (0.7071067811865475*GammaJacIonB[0]-0.7905694150420947*GammaJacIonB[2]>0.) && (0.7071067811865475*m0JacIonB[0]-0.7905694150420947*m0JacIonB[2]>0.)) {
    phiS_qp[1] = (log(GammaJacIonB[0]/(x3HalfMomJacElcB[0]-1.118033988749895*x3HalfMomJacElcB[2])-(2.23606797749979*GammaJacIonB[2])/(2.0*x3HalfMomJacElcB[0]-2.23606797749979*x3HalfMomJacElcB[2]))*T_e)/q_e;
  } else {
    phiS_qp[1] = 0.0;
  }
  if ((isfinite(0.6324555320336759*GammaJacIonB[2]+0.9486832980505137*GammaJacIonB[1]+0.7071067811865475*GammaJacIonB[0])) && (0.6324555320336759*GammaJacIonB[2]+0.9486832980505137*GammaJacIonB[1]+0.7071067811865475*GammaJacIonB[0]>0.) && (0.6324555320336759*m0JacIonB[2]+0.9486832980505137*m0JacIonB[1]+0.7071067811865475*m0JacIonB[0]>0.)) {
    phiS_qp[2] = (log((3.0*GammaJacIonB[1])/(2.0*x3HalfMomJacElcB[2]+3.0*x3HalfMomJacElcB[1]+2.23606797749979*x3HalfMomJacElcB[0])+(1.4142135623730951*GammaJacIonB[2])/(1.4142135623730951*x3HalfMomJacElcB[2]+2.1213203435596424*x3HalfMomJacElcB[1]+1.5811388300841895*x3HalfMomJacElcB[0])+GammaJacIonB[0]/(0.8944271909999159*x3HalfMomJacElcB[2]+1.3416407864998738*x3HalfMomJacElcB[1]+x3HalfMomJacElcB[0]))*T_e)/q_e;
  } else {
    phiS_qp[2] = 0.0;
  }

  // Sheath potential
  out[8] = 0.1111111111111111*(5.0*phiS_qp[2]+8.0*phiS_qp[1]+5.0*phiS_qp[0]); 
  out[9] = 0.3333333333333333*(2.23606797749979*phiS_qp[2]-2.23606797749979*phiS_qp[0]); 
  out[12] = 0.1111111111111111*(4.47213595499958*phiS_qp[2]-8.94427190999916*phiS_qp[1]+4.47213595499958*phiS_qp[0]); 

}

GKYL_CU_DH void ambi_bolt_potential_sheath_calc_upper_2x_ser_p2(double sheathDirDx, double q_e, double m_e, double T_e, const double *cmag, const double *jacobtotInv, const double *GammaJac_i, const double *m0Ion, const double *m0JacIon, double *out) 
{ 
  // sheathDirDx: cell length in direction of the sheath.
  // q_e:         electron change.
  // m_e:         electron mass.
  // T_e:         electron temperature.
  // cmag:        Clebsch function in definition of magnetic field.
  // jacobtotInv: reciprocal of the phase-space and conf-space Jacobians (1/(J*B)).
  // GammaJac_i:  ion particle flux (times the Jacobian) through sheath entrance.
  // m0Ion:       ion density.
  // m0JacIon:    ion density (times the geometry Jacobian).
  // out:         ion density and electrostatic potential at the sheath entrance.

  // Particle number density evaluate at the sheath entrance
  out[0] = 2.23606797749979*m0Ion[5]+1.7320508075688772*m0Ion[2]+m0Ion[0]; 
  out[1] = 0.3333333333333333*(6.7082039324993685*m0Ion[7]+5.196152422706631*m0Ion[3]+3.0*m0Ion[1]); 
  out[4] = 0.2*(8.660254037844387*m0Ion[6]+5.0*m0Ion[4]); 

  double GammaJacIonB[3];
  GammaJacIonB[0] = 0.7905694150420947*GammaJac_i[5]*sheathDirDx-0.6123724356957944*GammaJac_i[2]*sheathDirDx+0.3535533905932737*GammaJac_i[0]*sheathDirDx; 
  GammaJacIonB[1] = 0.7905694150420948*GammaJac_i[7]*sheathDirDx-0.6123724356957944*GammaJac_i[3]*sheathDirDx+0.3535533905932737*GammaJac_i[1]*sheathDirDx; 
  GammaJacIonB[2] = 0.3535533905932737*GammaJac_i[4]*sheathDirDx-0.6123724356957944*GammaJac_i[6]*sheathDirDx; 

  double x3HalfMomJacElcB[3];
  x3HalfMomJacElcB[0] = 0.1410473958869391*cmag[1]*jacobtotInv[4]*m0JacIon[7]*sqrt(T_e/m_e)+0.1410473958869391*jacobtotInv[1]*cmag[4]*m0JacIon[7]*sqrt(T_e/m_e)+0.15769578262626005*cmag[0]*jacobtotInv[1]*m0JacIon[7]*sqrt(T_e/m_e)+0.15769578262626005*jacobtotInv[0]*cmag[1]*m0JacIon[7]*sqrt(T_e/m_e)+0.07803917361371993*cmag[4]*jacobtotInv[4]*m0JacIon[6]*sqrt(T_e/m_e)+0.12215062797572998*cmag[0]*jacobtotInv[4]*m0JacIon[6]*sqrt(T_e/m_e)+0.12215062797572998*jacobtotInv[0]*cmag[4]*m0JacIon[6]*sqrt(T_e/m_e)+0.1092548430592079*cmag[1]*jacobtotInv[1]*m0JacIon[6]*sqrt(T_e/m_e)+0.15769578262626*cmag[4]*jacobtotInv[4]*m0JacIon[5]*sqrt(T_e/m_e)+0.15769578262626*cmag[1]*jacobtotInv[1]*m0JacIon[5]*sqrt(T_e/m_e)+0.15769578262626*cmag[0]*jacobtotInv[0]*m0JacIon[5]*sqrt(T_e/m_e)+0.04505593789321714*cmag[4]*jacobtotInv[4]*m0JacIon[4]*sqrt(T_e/m_e)+0.07052369794346953*cmag[0]*jacobtotInv[4]*m0JacIon[4]*sqrt(T_e/m_e)+0.07052369794346953*jacobtotInv[0]*cmag[4]*m0JacIon[4]*sqrt(T_e/m_e)+0.063078313050504*cmag[1]*jacobtotInv[1]*m0JacIon[4]*sqrt(T_e/m_e)+0.12215062797572997*m0JacIon[2]*cmag[4]*jacobtotInv[4]*sqrt(T_e/m_e)+0.07052369794346953*m0JacIon[0]*cmag[4]*jacobtotInv[4]*sqrt(T_e/m_e)+0.10925484305920789*cmag[1]*m0JacIon[3]*jacobtotInv[4]*sqrt(T_e/m_e)+0.063078313050504*cmag[1]*m0JacIon[1]*jacobtotInv[4]*sqrt(T_e/m_e)+0.10925484305920789*jacobtotInv[1]*m0JacIon[3]*cmag[4]*sqrt(T_e/m_e)+0.063078313050504*jacobtotInv[1]*m0JacIon[1]*cmag[4]*sqrt(T_e/m_e)+0.12215062797572997*cmag[0]*jacobtotInv[1]*m0JacIon[3]*sqrt(T_e/m_e)+0.12215062797572997*jacobtotInv[0]*cmag[1]*m0JacIon[3]*sqrt(T_e/m_e)+0.12215062797572997*cmag[1]*jacobtotInv[1]*m0JacIon[2]*sqrt(T_e/m_e)+0.12215062797572997*cmag[0]*jacobtotInv[0]*m0JacIon[2]*sqrt(T_e/m_e)+0.07052369794346953*cmag[0]*jacobtotInv[1]*m0JacIon[1]*sqrt(T_e/m_e)+0.07052369794346953*jacobtotInv[0]*cmag[1]*m0JacIon[1]*sqrt(T_e/m_e)+0.07052369794346953*m0JacIon[0]*cmag[1]*jacobtotInv[1]*sqrt(T_e/m_e)+0.07052369794346953*cmag[0]*jacobtotInv[0]*m0JacIon[0]*sqrt(T_e/m_e); 
  x3HalfMomJacElcB[1] = 0.24780765841269434*cmag[4]*jacobtotInv[4]*m0JacIon[7]*sqrt(T_e/m_e)+0.1410473958869391*cmag[0]*jacobtotInv[4]*m0JacIon[7]*sqrt(T_e/m_e)+0.1410473958869391*jacobtotInv[0]*cmag[4]*m0JacIon[7]*sqrt(T_e/m_e)+0.28385240872726797*cmag[1]*jacobtotInv[1]*m0JacIon[7]*sqrt(T_e/m_e)+0.15769578262626005*cmag[0]*jacobtotInv[0]*m0JacIon[7]*sqrt(T_e/m_e)+0.19195098681900427*cmag[1]*jacobtotInv[4]*m0JacIon[6]*sqrt(T_e/m_e)+0.19195098681900427*jacobtotInv[1]*cmag[4]*m0JacIon[6]*sqrt(T_e/m_e)+0.1092548430592079*cmag[0]*jacobtotInv[1]*m0JacIon[6]*sqrt(T_e/m_e)+0.1092548430592079*jacobtotInv[0]*cmag[1]*m0JacIon[6]*sqrt(T_e/m_e)+0.14104739588693907*cmag[1]*jacobtotInv[4]*m0JacIon[5]*sqrt(T_e/m_e)+0.14104739588693907*jacobtotInv[1]*cmag[4]*m0JacIon[5]*sqrt(T_e/m_e)+0.15769578262626*cmag[0]*jacobtotInv[1]*m0JacIon[5]*sqrt(T_e/m_e)+0.15769578262626*jacobtotInv[0]*cmag[1]*m0JacIon[5]*sqrt(T_e/m_e)+0.11082295391116641*cmag[1]*jacobtotInv[4]*m0JacIon[4]*sqrt(T_e/m_e)+0.11082295391116641*jacobtotInv[1]*cmag[4]*m0JacIon[4]*sqrt(T_e/m_e)+0.063078313050504*cmag[0]*jacobtotInv[1]*m0JacIon[4]*sqrt(T_e/m_e)+0.063078313050504*jacobtotInv[0]*cmag[1]*m0JacIon[4]*sqrt(T_e/m_e)+0.19195098681900424*m0JacIon[3]*cmag[4]*jacobtotInv[4]*sqrt(T_e/m_e)+0.11082295391116641*m0JacIon[1]*cmag[4]*jacobtotInv[4]*sqrt(T_e/m_e)+0.10925484305920789*cmag[0]*m0JacIon[3]*jacobtotInv[4]*sqrt(T_e/m_e)+0.10925484305920789*cmag[1]*m0JacIon[2]*jacobtotInv[4]*sqrt(T_e/m_e)+0.063078313050504*cmag[0]*m0JacIon[1]*jacobtotInv[4]*sqrt(T_e/m_e)+0.063078313050504*m0JacIon[0]*cmag[1]*jacobtotInv[4]*sqrt(T_e/m_e)+0.10925484305920789*jacobtotInv[0]*m0JacIon[3]*cmag[4]*sqrt(T_e/m_e)+0.10925484305920789*jacobtotInv[1]*m0JacIon[2]*cmag[4]*sqrt(T_e/m_e)+0.063078313050504*jacobtotInv[0]*m0JacIon[1]*cmag[4]*sqrt(T_e/m_e)+0.063078313050504*m0JacIon[0]*jacobtotInv[1]*cmag[4]*sqrt(T_e/m_e)+0.2198711303563139*cmag[1]*jacobtotInv[1]*m0JacIon[3]*sqrt(T_e/m_e)+0.12215062797572997*cmag[0]*jacobtotInv[0]*m0JacIon[3]*sqrt(T_e/m_e)+0.12215062797572997*cmag[0]*jacobtotInv[1]*m0JacIon[2]*sqrt(T_e/m_e)+0.12215062797572997*jacobtotInv[0]*cmag[1]*m0JacIon[2]*sqrt(T_e/m_e)+0.12694265629824517*cmag[1]*jacobtotInv[1]*m0JacIon[1]*sqrt(T_e/m_e)+0.07052369794346953*cmag[0]*jacobtotInv[0]*m0JacIon[1]*sqrt(T_e/m_e)+0.07052369794346953*cmag[0]*m0JacIon[0]*jacobtotInv[1]*sqrt(T_e/m_e)+0.07052369794346953*jacobtotInv[0]*m0JacIon[0]*cmag[1]*sqrt(T_e/m_e); 
  x3HalfMomJacElcB[2] = 0.24780765841269434*cmag[1]*jacobtotInv[4]*m0JacIon[7]*sqrt(T_e/m_e)+0.24780765841269434*jacobtotInv[1]*cmag[4]*m0JacIon[7]*sqrt(T_e/m_e)+0.1410473958869391*cmag[0]*jacobtotInv[1]*m0JacIon[7]*sqrt(T_e/m_e)+0.1410473958869391*jacobtotInv[0]*cmag[1]*m0JacIon[7]*sqrt(T_e/m_e)+0.26175134566227853*cmag[4]*jacobtotInv[4]*m0JacIon[6]*sqrt(T_e/m_e)+0.07803917361371993*cmag[0]*jacobtotInv[4]*m0JacIon[6]*sqrt(T_e/m_e)+0.07803917361371993*jacobtotInv[0]*cmag[4]*m0JacIon[6]*sqrt(T_e/m_e)+0.19195098681900427*cmag[1]*jacobtotInv[1]*m0JacIon[6]*sqrt(T_e/m_e)+0.12215062797572998*cmag[0]*jacobtotInv[0]*m0JacIon[6]*sqrt(T_e/m_e)+0.1007481399192422*cmag[4]*jacobtotInv[4]*m0JacIon[5]*sqrt(T_e/m_e)+0.15769578262626*cmag[0]*jacobtotInv[4]*m0JacIon[5]*sqrt(T_e/m_e)+0.15769578262626*jacobtotInv[0]*cmag[4]*m0JacIon[5]*sqrt(T_e/m_e)+0.14104739588693907*cmag[1]*jacobtotInv[1]*m0JacIon[5]*sqrt(T_e/m_e)+0.1511222098788633*cmag[4]*jacobtotInv[4]*m0JacIon[4]*sqrt(T_e/m_e)+0.04505593789321714*cmag[0]*jacobtotInv[4]*m0JacIon[4]*sqrt(T_e/m_e)+0.04505593789321714*jacobtotInv[0]*cmag[4]*m0JacIon[4]*sqrt(T_e/m_e)+0.11082295391116641*cmag[1]*jacobtotInv[1]*m0JacIon[4]*sqrt(T_e/m_e)+0.07052369794346953*cmag[0]*jacobtotInv[0]*m0JacIon[4]*sqrt(T_e/m_e)+0.07803917361371993*m0JacIon[2]*cmag[4]*jacobtotInv[4]*sqrt(T_e/m_e)+0.04505593789321714*m0JacIon[0]*cmag[4]*jacobtotInv[4]*sqrt(T_e/m_e)+0.19195098681900424*cmag[1]*m0JacIon[3]*jacobtotInv[4]*sqrt(T_e/m_e)+0.12215062797572997*cmag[0]*m0JacIon[2]*jacobtotInv[4]*sqrt(T_e/m_e)+0.11082295391116641*cmag[1]*m0JacIon[1]*jacobtotInv[4]*sqrt(T_e/m_e)+0.07052369794346953*cmag[0]*m0JacIon[0]*jacobtotInv[4]*sqrt(T_e/m_e)+0.19195098681900424*jacobtotInv[1]*m0JacIon[3]*cmag[4]*sqrt(T_e/m_e)+0.12215062797572997*jacobtotInv[0]*m0JacIon[2]*cmag[4]*sqrt(T_e/m_e)+0.11082295391116641*jacobtotInv[1]*m0JacIon[1]*cmag[4]*sqrt(T_e/m_e)+0.07052369794346953*jacobtotInv[0]*m0JacIon[0]*cmag[4]*sqrt(T_e/m_e)+0.10925484305920789*cmag[0]*jacobtotInv[1]*m0JacIon[3]*sqrt(T_e/m_e)+0.10925484305920789*jacobtotInv[0]*cmag[1]*m0JacIon[3]*sqrt(T_e/m_e)+0.10925484305920789*cmag[1]*jacobtotInv[1]*m0JacIon[2]*sqrt(T_e/m_e)+0.063078313050504*cmag[0]*jacobtotInv[1]*m0JacIon[1]*sqrt(T_e/m_e)+0.063078313050504*jacobtotInv[0]*cmag[1]*m0JacIon[1]*sqrt(T_e/m_e)+0.063078313050504*m0JacIon[0]*cmag[1]*jacobtotInv[1]*sqrt(T_e/m_e); 

  double m0JacIonB[3];
  m0JacIonB[0] = 1.5811388300841895*m0JacIon[5]+1.224744871391589*m0JacIon[2]+0.7071067811865475*m0JacIon[0]; 
  m0JacIonB[1] = 1.5811388300841898*m0JacIon[7]+1.224744871391589*m0JacIon[3]+0.7071067811865475*m0JacIon[1]; 
  m0JacIonB[2] = 1.224744871391589*m0JacIon[6]+0.7071067811865475*m0JacIon[4]; 

  double phiS_qp[3];
  if ((isfinite(0.6324555320336759*GammaJacIonB[2]-0.9486832980505137*GammaJacIonB[1]+0.7071067811865475*GammaJacIonB[0])) && (0.6324555320336759*GammaJacIonB[2]-0.9486832980505137*GammaJacIonB[1]+0.7071067811865475*GammaJacIonB[0]>0.) && (0.6324555320336759*m0JacIonB[2]-0.9486832980505137*m0JacIonB[1]+0.7071067811865475*m0JacIonB[0]>0.)) {
    phiS_qp[0] = (log(-((3.0*GammaJacIonB[1])/(2.0*x3HalfMomJacElcB[2]-3.0*x3HalfMomJacElcB[1]+2.23606797749979*x3HalfMomJacElcB[0]))+(1.4142135623730951*GammaJacIonB[2])/(1.4142135623730951*x3HalfMomJacElcB[2]-2.1213203435596424*x3HalfMomJacElcB[1]+1.5811388300841895*x3HalfMomJacElcB[0])+GammaJacIonB[0]/(0.8944271909999159*x3HalfMomJacElcB[2]-1.3416407864998738*x3HalfMomJacElcB[1]+x3HalfMomJacElcB[0]))*T_e)/q_e;
  } else {
    phiS_qp[0] = 0.0;
  }
  if ((isfinite(0.7071067811865475*GammaJacIonB[0]-0.7905694150420947*GammaJacIonB[2])) && (0.7071067811865475*GammaJacIonB[0]-0.7905694150420947*GammaJacIonB[2]>0.) && (0.7071067811865475*m0JacIonB[0]-0.7905694150420947*m0JacIonB[2]>0.)) {
    phiS_qp[1] = (log(GammaJacIonB[0]/(x3HalfMomJacElcB[0]-1.118033988749895*x3HalfMomJacElcB[2])-(2.23606797749979*GammaJacIonB[2])/(2.0*x3HalfMomJacElcB[0]-2.23606797749979*x3HalfMomJacElcB[2]))*T_e)/q_e;
  } else {
    phiS_qp[1] = 0.0;
  }
  if ((isfinite(0.6324555320336759*GammaJacIonB[2]+0.9486832980505137*GammaJacIonB[1]+0.7071067811865475*GammaJacIonB[0])) && (0.6324555320336759*GammaJacIonB[2]+0.9486832980505137*GammaJacIonB[1]+0.7071067811865475*GammaJacIonB[0]>0.) && (0.6324555320336759*m0JacIonB[2]+0.9486832980505137*m0JacIonB[1]+0.7071067811865475*m0JacIonB[0]>0.)) {
    phiS_qp[2] = (log((3.0*GammaJacIonB[1])/(2.0*x3HalfMomJacElcB[2]+3.0*x3HalfMomJacElcB[1]+2.23606797749979*x3HalfMomJacElcB[0])+(1.4142135623730951*GammaJacIonB[2])/(1.4142135623730951*x3HalfMomJacElcB[2]+2.1213203435596424*x3HalfMomJacElcB[1]+1.5811388300841895*x3HalfMomJacElcB[0])+GammaJacIonB[0]/(0.8944271909999159*x3HalfMomJacElcB[2]+1.3416407864998738*x3HalfMomJacElcB[1]+x3HalfMomJacElcB[0]))*T_e)/q_e;
  } else {
    phiS_qp[2] = 0.0;
  }

  // Sheath potential
  out[8] = 0.1111111111111111*(5.0*phiS_qp[2]+8.0*phiS_qp[1]+5.0*phiS_qp[0]); 
  out[9] = 0.3333333333333333*(2.23606797749979*phiS_qp[2]-2.23606797749979*phiS_qp[0]); 
  out[12] = 0.1111111111111111*(4.47213595499958*phiS_qp[2]-8.94427190999916*phiS_qp[1]+4.47213595499958*phiS_qp[0]); 

}

GKYL_CU_DH void ambi_bolt_potential_phi_calc_2x_ser_p2(double q_e, double T_e, const double *m0Ion, const double *sheathvals, double *phi) 
{ 
  // q_e: electron change.
  // T_e: electron temperature.
  // m0Ion: ion density.
  // sheathvals: ion density and electrostatic potential at the sheath entrance.
  // phi: electrostatic potential in domain volume.

  double phi_qp[9];
  phi_qp[0] = -((1.0*log(m0Ion[0]/(-(1.1999999999999988*sheathvals[7])-1.1999999999999997*sheathvals[6]+0.8944271909999159*sheathvals[5]+0.8944271909999159*sheathvals[4]+1.8*sheathvals[3]-1.3416407864998738*sheathvals[2]-1.3416407864998738*sheathvals[1]+sheathvals[0])+m0Ion[5]/(-(1.341640786499873*sheathvals[7])-1.3416407864998734*sheathvals[6]+sheathvals[5]+sheathvals[4]+2.0124611797498106*sheathvals[3]-1.5*sheathvals[2]-1.5*sheathvals[1]+1.118033988749895*sheathvals[0])+m0Ion[4]/(-(1.341640786499873*sheathvals[7])-1.3416407864998734*sheathvals[6]+sheathvals[5]+sheathvals[4]+2.0124611797498106*sheathvals[3]-1.5*sheathvals[2]-1.5*sheathvals[1]+1.118033988749895*sheathvals[0])-(3.0*m0Ion[2])/(-(2.683281572999746*sheathvals[7])-2.683281572999747*sheathvals[6]+2.0*sheathvals[5]+2.0*sheathvals[4]+4.024922359499621*sheathvals[3]-3.0*sheathvals[2]-3.0*sheathvals[1]+2.23606797749979*sheathvals[0])-(3.0*m0Ion[1])/(-(2.683281572999746*sheathvals[7])-2.683281572999747*sheathvals[6]+2.0*sheathvals[5]+2.0*sheathvals[4]+4.024922359499621*sheathvals[3]-3.0*sheathvals[2]-3.0*sheathvals[1]+2.23606797749979*sheathvals[0])-(5.196152422706631*m0Ion[6])/(-(5.196152422706629*sheathvals[7])-5.196152422706631*sheathvals[6]+3.872983346207417*sheathvals[5]+3.872983346207417*sheathvals[4]+7.794228634059948*sheathvals[3]-5.809475019311126*sheathvals[2]-5.809475019311126*sheathvals[1]+4.330127018922194*sheathvals[0])+(6.7082039324993685*m0Ion[7])/(-(5.366563145999492*sheathvals[7])-5.366563145999494*sheathvals[6]+4.0*sheathvals[5]+4.0*sheathvals[4]+8.049844718999243*sheathvals[3]-6.0*sheathvals[2]-6.0*sheathvals[1]+4.47213595499958*sheathvals[0])+(9.0*m0Ion[3])/(-(5.999999999999996*sheathvals[7])-5.999999999999999*sheathvals[6]+4.47213595499958*sheathvals[5]+4.47213595499958*sheathvals[4]+9.0*sheathvals[3]-6.708203932499369*sheathvals[2]-6.708203932499369*sheathvals[1]+5.0*sheathvals[0])-(60.37383539249431*m0Ion[7])/(-(26.832815729997463*sheathvals[7])-26.83281572999747*sheathvals[6]+20.0*sheathvals[5]+20.0*sheathvals[4]+40.24922359499622*sheathvals[3]-30.0*sheathvals[2]-30.0*sheathvals[1]+22.3606797749979*sheathvals[0]))*T_e)/q_e)-0.5999999999999994*sheathvals[15]-0.5999999999999999*sheathvals[14]+0.4472135954999579*sheathvals[13]+0.4472135954999579*sheathvals[12]+0.9*sheathvals[11]-0.6708203932499369*sheathvals[10]-0.6708203932499369*sheathvals[9]+0.5*sheathvals[8]; 
  phi_qp[1] = -((1.0*log((6.7082039324993685*m0Ion[7])/(6.7082039324993685*sheathvals[7]-5.0*sheathvals[5]+4.0*sheathvals[4]-6.0*sheathvals[1]+4.47213595499958*sheathvals[0])-(3.0*m0Ion[1])/(3.3541019662496843*sheathvals[7]-2.5*sheathvals[5]+2.0*sheathvals[4]-3.0*sheathvals[1]+2.23606797749979*sheathvals[0])-(2.23606797749979*m0Ion[5])/(3.0*sheathvals[7]-2.23606797749979*sheathvals[5]+1.7888543819998317*sheathvals[4]-2.6832815729997477*sheathvals[1]+2.0*sheathvals[0])+m0Ion[4]/(1.6770509831248421*sheathvals[7]-1.25*sheathvals[5]+sheathvals[4]-1.5*sheathvals[1]+1.118033988749895*sheathvals[0])+m0Ion[0]/(1.5*sheathvals[7]-1.118033988749895*sheathvals[5]+0.8944271909999159*sheathvals[4]-1.3416407864998738*sheathvals[1]+sheathvals[0]))*T_e)/q_e)+0.75*sheathvals[15]-0.5590169943749475*sheathvals[13]+0.4472135954999579*sheathvals[12]-0.6708203932499369*sheathvals[9]+0.5*sheathvals[8]; 
  phi_qp[2] = -((1.0*log(m0Ion[0]/(-(1.1999999999999988*sheathvals[7])+1.1999999999999997*sheathvals[6]+0.8944271909999159*sheathvals[5]+0.8944271909999159*sheathvals[4]-1.8*sheathvals[3]+1.3416407864998738*sheathvals[2]-1.3416407864998738*sheathvals[1]+sheathvals[0])+m0Ion[5]/(-(1.341640786499873*sheathvals[7])+1.3416407864998734*sheathvals[6]+sheathvals[5]+sheathvals[4]-2.0124611797498106*sheathvals[3]+1.5*sheathvals[2]-1.5*sheathvals[1]+1.118033988749895*sheathvals[0])+m0Ion[4]/(-(1.341640786499873*sheathvals[7])+1.3416407864998734*sheathvals[6]+sheathvals[5]+sheathvals[4]-2.0124611797498106*sheathvals[3]+1.5*sheathvals[2]-1.5*sheathvals[1]+1.118033988749895*sheathvals[0])+(3.0*m0Ion[2])/(-(2.683281572999746*sheathvals[7])+2.683281572999747*sheathvals[6]+2.0*sheathvals[5]+2.0*sheathvals[4]-4.024922359499621*sheathvals[3]+3.0*sheathvals[2]-3.0*sheathvals[1]+2.23606797749979*sheathvals[0])-(3.0*m0Ion[1])/(-(2.683281572999746*sheathvals[7])+2.683281572999747*sheathvals[6]+2.0*sheathvals[5]+2.0*sheathvals[4]-4.024922359499621*sheathvals[3]+3.0*sheathvals[2]-3.0*sheathvals[1]+2.23606797749979*sheathvals[0])+(5.196152422706631*m0Ion[6])/(-(5.196152422706629*sheathvals[7])+5.196152422706631*sheathvals[6]+3.872983346207417*sheathvals[5]+3.872983346207417*sheathvals[4]-7.794228634059948*sheathvals[3]+5.809475019311126*sheathvals[2]-5.809475019311126*sheathvals[1]+4.330127018922194*sheathvals[0])+(6.7082039324993685*m0Ion[7])/(-(5.366563145999492*sheathvals[7])+5.366563145999494*sheathvals[6]+4.0*sheathvals[5]+4.0*sheathvals[4]-8.049844718999243*sheathvals[3]+6.0*sheathvals[2]-6.0*sheathvals[1]+4.47213595499958*sheathvals[0])-(9.0*m0Ion[3])/(-(5.999999999999996*sheathvals[7])+5.999999999999999*sheathvals[6]+4.47213595499958*sheathvals[5]+4.47213595499958*sheathvals[4]-9.0*sheathvals[3]+6.708203932499369*sheathvals[2]-6.708203932499369*sheathvals[1]+5.0*sheathvals[0])-(60.37383539249431*m0Ion[7])/(-(26.832815729997463*sheathvals[7])+26.83281572999747*sheathvals[6]+20.0*sheathvals[5]+20.0*sheathvals[4]-40.24922359499622*sheathvals[3]+30.0*sheathvals[2]-30.0*sheathvals[1]+22.3606797749979*sheathvals[0]))*T_e)/q_e)-0.5999999999999994*sheathvals[15]+0.5999999999999999*sheathvals[14]+0.4472135954999579*sheathvals[13]+0.4472135954999579*sheathvals[12]-0.9*sheathvals[11]+0.6708203932499369*sheathvals[10]-0.6708203932499369*sheathvals[9]+0.5*sheathvals[8]; 
  phi_qp[3] = -((1.0*log((6.7082039324993685*m0Ion[6])/(6.7082039324993685*sheathvals[6]+4.0*sheathvals[5]-5.0*sheathvals[4]-6.0*sheathvals[2]+4.47213595499958*sheathvals[0])-(3.0*m0Ion[2])/(3.3541019662496843*sheathvals[6]+2.0*sheathvals[5]-2.5*sheathvals[4]-3.0*sheathvals[2]+2.23606797749979*sheathvals[0])-(2.23606797749979*m0Ion[4])/(3.0*sheathvals[6]+1.7888543819998317*sheathvals[5]-2.23606797749979*sheathvals[4]-2.6832815729997477*sheathvals[2]+2.0*sheathvals[0])+m0Ion[5]/(1.6770509831248421*sheathvals[6]+sheathvals[5]-1.25*sheathvals[4]-1.5*sheathvals[2]+1.118033988749895*sheathvals[0])+m0Ion[0]/(1.5*sheathvals[6]+0.8944271909999159*sheathvals[5]-1.118033988749895*sheathvals[4]-1.3416407864998738*sheathvals[2]+sheathvals[0]))*T_e)/q_e)+0.75*sheathvals[14]+0.4472135954999579*sheathvals[13]-0.5590169943749475*sheathvals[12]-0.6708203932499369*sheathvals[10]+0.5*sheathvals[8]; 
  phi_qp[4] = -((1.0*log(m0Ion[0]/(-(1.118033988749895*sheathvals[5])-1.118033988749895*sheathvals[4]+sheathvals[0])-(2.23606797749979*m0Ion[5])/(-(2.23606797749979*sheathvals[5])-2.23606797749979*sheathvals[4]+2.0*sheathvals[0])-(2.23606797749979*m0Ion[4])/(-(2.23606797749979*sheathvals[5])-2.23606797749979*sheathvals[4]+2.0*sheathvals[0]))*T_e)/q_e)-0.5590169943749475*sheathvals[13]-0.5590169943749475*sheathvals[12]+0.5*sheathvals[8]; 
  phi_qp[5] = -((1.0*log(m0Ion[0]/(-(1.5*sheathvals[6])+0.8944271909999159*sheathvals[5]-1.118033988749895*sheathvals[4]+1.3416407864998738*sheathvals[2]+sheathvals[0])+m0Ion[5]/(-(1.6770509831248421*sheathvals[6])+sheathvals[5]-1.25*sheathvals[4]+1.5*sheathvals[2]+1.118033988749895*sheathvals[0])-(2.23606797749979*m0Ion[4])/(-(3.0*sheathvals[6])+1.7888543819998317*sheathvals[5]-2.23606797749979*sheathvals[4]+2.6832815729997477*sheathvals[2]+2.0*sheathvals[0])+(3.0*m0Ion[2])/(-(3.3541019662496843*sheathvals[6])+2.0*sheathvals[5]-2.5*sheathvals[4]+3.0*sheathvals[2]+2.23606797749979*sheathvals[0])-(6.7082039324993685*m0Ion[6])/(-(6.7082039324993685*sheathvals[6])+4.0*sheathvals[5]-5.0*sheathvals[4]+6.0*sheathvals[2]+4.47213595499958*sheathvals[0]))*T_e)/q_e)-0.75*sheathvals[14]+0.4472135954999579*sheathvals[13]-0.5590169943749475*sheathvals[12]+0.6708203932499369*sheathvals[10]+0.5*sheathvals[8]; 
  phi_qp[6] = -((1.0*log((60.37383539249431*m0Ion[7])/(26.832815729997463*sheathvals[7]-26.83281572999747*sheathvals[6]+20.0*sheathvals[5]+20.0*sheathvals[4]-40.24922359499622*sheathvals[3]-30.0*sheathvals[2]+30.0*sheathvals[1]+22.3606797749979*sheathvals[0])-(9.0*m0Ion[3])/(5.999999999999996*sheathvals[7]-5.999999999999999*sheathvals[6]+4.47213595499958*sheathvals[5]+4.47213595499958*sheathvals[4]-9.0*sheathvals[3]-6.708203932499369*sheathvals[2]+6.708203932499369*sheathvals[1]+5.0*sheathvals[0])-(6.7082039324993685*m0Ion[7])/(5.366563145999492*sheathvals[7]-5.366563145999494*sheathvals[6]+4.0*sheathvals[5]+4.0*sheathvals[4]-8.049844718999243*sheathvals[3]-6.0*sheathvals[2]+6.0*sheathvals[1]+4.47213595499958*sheathvals[0])-(5.196152422706631*m0Ion[6])/(5.196152422706629*sheathvals[7]-5.196152422706631*sheathvals[6]+3.872983346207417*sheathvals[5]+3.872983346207417*sheathvals[4]-7.794228634059948*sheathvals[3]-5.809475019311126*sheathvals[2]+5.809475019311126*sheathvals[1]+4.330127018922194*sheathvals[0])-(3.0*m0Ion[2])/(2.683281572999746*sheathvals[7]-2.683281572999747*sheathvals[6]+2.0*sheathvals[5]+2.0*sheathvals[4]-4.024922359499621*sheathvals[3]-3.0*sheathvals[2]+3.0*sheathvals[1]+2.23606797749979*sheathvals[0])+(3.0*m0Ion[1])/(2.683281572999746*sheathvals[7]-2.683281572999747*sheathvals[6]+2.0*sheathvals[5]+2.0*sheathvals[4]-4.024922359499621*sheathvals[3]-3.0*sheathvals[2]+3.0*sheathvals[1]+2.23606797749979*sheathvals[0])+m0Ion[5]/(1.341640786499873*sheathvals[7]-1.3416407864998734*sheathvals[6]+sheathvals[5]+sheathvals[4]-2.0124611797498106*sheathvals[3]-1.5*sheathvals[2]+1.5*sheathvals[1]+1.118033988749895*sheathvals[0])+m0Ion[4]/(1.341640786499873*sheathvals[7]-1.3416407864998734*sheathvals[6]+sheathvals[5]+sheathvals[4]-2.0124611797498106*sheathvals[3]-1.5*sheathvals[2]+1.5*sheathvals[1]+1.118033988749895*sheathvals[0])+m0Ion[0]/(1.1999999999999988*sheathvals[7]-1.1999999999999997*sheathvals[6]+0.8944271909999159*sheathvals[5]+0.8944271909999159*sheathvals[4]-1.8*sheathvals[3]-1.3416407864998738*sheathvals[2]+1.3416407864998738*sheathvals[1]+sheathvals[0]))*T_e)/q_e)+0.5999999999999994*sheathvals[15]-0.5999999999999999*sheathvals[14]+0.4472135954999579*sheathvals[13]+0.4472135954999579*sheathvals[12]-0.9*sheathvals[11]-0.6708203932499369*sheathvals[10]+0.6708203932499369*sheathvals[9]+0.5*sheathvals[8]; 
  phi_qp[7] = -((1.0*log(m0Ion[0]/(-(1.5*sheathvals[7])-1.118033988749895*sheathvals[5]+0.8944271909999159*sheathvals[4]+1.3416407864998738*sheathvals[1]+sheathvals[0])+m0Ion[4]/(-(1.6770509831248421*sheathvals[7])-1.25*sheathvals[5]+sheathvals[4]+1.5*sheathvals[1]+1.118033988749895*sheathvals[0])-(2.23606797749979*m0Ion[5])/(-(3.0*sheathvals[7])-2.23606797749979*sheathvals[5]+1.7888543819998317*sheathvals[4]+2.6832815729997477*sheathvals[1]+2.0*sheathvals[0])+(3.0*m0Ion[1])/(-(3.3541019662496843*sheathvals[7])-2.5*sheathvals[5]+2.0*sheathvals[4]+3.0*sheathvals[1]+2.23606797749979*sheathvals[0])-(6.7082039324993685*m0Ion[7])/(-(6.7082039324993685*sheathvals[7])-5.0*sheathvals[5]+4.0*sheathvals[4]+6.0*sheathvals[1]+4.47213595499958*sheathvals[0]))*T_e)/q_e)-0.75*sheathvals[15]-0.5590169943749475*sheathvals[13]+0.4472135954999579*sheathvals[12]+0.6708203932499369*sheathvals[9]+0.5*sheathvals[8]; 
  phi_qp[8] = -((1.0*log((60.37383539249431*m0Ion[7])/(26.832815729997463*sheathvals[7]+26.83281572999747*sheathvals[6]+20.0*sheathvals[5]+20.0*sheathvals[4]+40.24922359499622*sheathvals[3]+30.0*sheathvals[2]+30.0*sheathvals[1]+22.3606797749979*sheathvals[0])+(9.0*m0Ion[3])/(5.999999999999996*sheathvals[7]+5.999999999999999*sheathvals[6]+4.47213595499958*sheathvals[5]+4.47213595499958*sheathvals[4]+9.0*sheathvals[3]+6.708203932499369*sheathvals[2]+6.708203932499369*sheathvals[1]+5.0*sheathvals[0])-(6.7082039324993685*m0Ion[7])/(5.366563145999492*sheathvals[7]+5.366563145999494*sheathvals[6]+4.0*sheathvals[5]+4.0*sheathvals[4]+8.049844718999243*sheathvals[3]+6.0*sheathvals[2]+6.0*sheathvals[1]+4.47213595499958*sheathvals[0])+(5.196152422706631*m0Ion[6])/(5.196152422706629*sheathvals[7]+5.196152422706631*sheathvals[6]+3.872983346207417*sheathvals[5]+3.872983346207417*sheathvals[4]+7.794228634059948*sheathvals[3]+5.809475019311126*sheathvals[2]+5.809475019311126*sheathvals[1]+4.330127018922194*sheathvals[0])+(3.0*m0Ion[2])/(2.683281572999746*sheathvals[7]+2.683281572999747*sheathvals[6]+2.0*sheathvals[5]+2.0*sheathvals[4]+4.024922359499621*sheathvals[3]+3.0*sheathvals[2]+3.0*sheathvals[1]+2.23606797749979*sheathvals[0])+(3.0*m0Ion[1])/(2.683281572999746*sheathvals[7]+2.683281572999747*sheathvals[6]+2.0*sheathvals[5]+2.0*sheathvals[4]+4.024922359499621*sheathvals[3]+3.0*sheathvals[2]+3.0*sheathvals[1]+2.23606797749979*sheathvals[0])+m0Ion[5]/(1.341640786499873*sheathvals[7]+1.3416407864998734*sheathvals[6]+sheathvals[5]+sheathvals[4]+2.0124611797498106*sheathvals[3]+1.5*sheathvals[2]+1.5*sheathvals[1]+1.118033988749895*sheathvals[0])+m0Ion[4]/(1.341640786499873*sheathvals[7]+1.3416407864998734*sheathvals[6]+sheathvals[5]+sheathvals[4]+2.0124611797498106*sheathvals[3]+1.5*sheathvals[2]+1.5*sheathvals[1]+1.118033988749895*sheathvals[0])+m0Ion[0]/(1.1999999999999988*sheathvals[7]+1.1999999999999997*sheathvals[6]+0.8944271909999159*sheathvals[5]+0.8944271909999159*sheathvals[4]+1.8*sheathvals[3]+1.3416407864998738*sheathvals[2]+1.3416407864998738*sheathvals[1]+sheathvals[0]))*T_e)/q_e)+0.5999999999999994*sheathvals[15]+0.5999999999999999*sheathvals[14]+0.4472135954999579*sheathvals[13]+0.4472135954999579*sheathvals[12]+0.9*sheathvals[11]+0.6708203932499369*sheathvals[10]+0.6708203932499369*sheathvals[9]+0.5*sheathvals[8]; 

  phi[0] = 0.154320987654321*phi_qp[8]+0.24691358024691357*phi_qp[7]+0.154320987654321*phi_qp[6]+0.24691358024691357*phi_qp[5]+0.3950617283950617*phi_qp[4]+0.24691358024691357*phi_qp[3]+0.154320987654321*phi_qp[2]+0.24691358024691357*phi_qp[1]+0.154320987654321*phi_qp[0]; 
  phi[1] = 0.20704333124998056*phi_qp[8]+0.33126932999996883*phi_qp[7]+0.20704333124998056*phi_qp[6]-0.20704333124998056*phi_qp[2]-0.33126932999996883*phi_qp[1]-0.20704333124998056*phi_qp[0]; 
  phi[2] = 0.20704333124998056*phi_qp[8]-0.20704333124998056*phi_qp[6]+0.33126932999996883*phi_qp[5]-0.33126932999996883*phi_qp[3]+0.20704333124998056*phi_qp[2]-0.20704333124998056*phi_qp[0]; 
  phi[3] = 0.27777777777777785*phi_qp[8]-0.27777777777777785*(phi_qp[6]+phi_qp[2])+0.27777777777777785*phi_qp[0]; 
  phi[4] = 0.13802888749998704*phi_qp[8]+0.22084621999997922*phi_qp[7]+0.13802888749998704*phi_qp[6]-0.276057774999974*phi_qp[5]-0.44169243999995844*phi_qp[4]-0.276057774999974*phi_qp[3]+0.13802888749998704*phi_qp[2]+0.22084621999997922*phi_qp[1]+0.13802888749998704*phi_qp[0]; 
  phi[5] = 0.13802888749998704*phi_qp[8]-0.276057774999974*phi_qp[7]+0.13802888749998704*phi_qp[6]+0.22084621999997922*phi_qp[5]-0.44169243999995844*phi_qp[4]+0.22084621999997922*phi_qp[3]+0.13802888749998704*phi_qp[2]-0.276057774999974*phi_qp[1]+0.13802888749998704*phi_qp[0]; 
  phi[6] = 0.18518518518518517*phi_qp[8]-0.18518518518518517*phi_qp[6]-0.37037037037037035*phi_qp[5]+0.37037037037037035*phi_qp[3]+0.18518518518518517*phi_qp[2]-0.18518518518518517*phi_qp[0]; 
  phi[7] = 0.18518518518518506*phi_qp[8]-0.37037037037037035*phi_qp[7]+0.18518518518518506*phi_qp[6]-0.18518518518518506*phi_qp[2]+0.37037037037037035*phi_qp[1]-0.18518518518518506*phi_qp[0]; 
}

