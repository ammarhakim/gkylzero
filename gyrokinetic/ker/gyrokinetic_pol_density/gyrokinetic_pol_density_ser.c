#include <gkyl_gyrokinetic_pol_density_kernels.h>

void gkyl_gyrokinetic_pol_density_1x_ser_p1(const double *dx, const double *epsilon, const double *phi, double *out) 
{ 
  // dx: cell lengths.
  // epsilon: polarization weight, sum_s jacobgeo*(n_s*m_s/B^2)*g^{ij}.
  // phi: electrostatic potential.
  // out: polarization density.

  const double *epsxx = &epsilon[0];

  double rdx00 = 1.0;

  out[0] = 0.7071067811865475*epsxx[1]*phi[1]*rdx00+0.7071067811865475*epsxx[0]*phi[0]*rdx00; 
  out[1] = 0.6324555320336759*epsxx[1]*phi[2]*rdx00+0.7071067811865475*epsxx[0]*phi[1]*rdx00+0.7071067811865475*phi[0]*epsxx[1]*rdx00; 

}

void gkyl_gyrokinetic_pol_density_2x_ser_p1(const double *dx, const double *epsilon, const double *phi, double *out) 
{ 
  // dx: cell lengths.
  // epsilon: polarization weight, sum_s jacobgeo*(n_s*m_s/B^2)*g^{ij}.
  // phi: electrostatic potential.
  // out: polarization density.

  const double *epsxx = &epsilon[0];

  double rdx00 = 4.0/(dx[0]*dx[0]);

  out[0] = (-3.354101966249684*epsxx[2]*phi[6]*rdx00)-3.354101966249685*epsxx[0]*phi[4]*rdx00-1.5*epsxx[3]*phi[3]*rdx00-1.5*epsxx[1]*phi[1]*rdx00; 
  out[1] = (-6.708203932499369*epsxx[3]*phi[6]*rdx00)-6.708203932499369*epsxx[1]*phi[4]*rdx00; 
  out[2] = (-3.0*epsxx[2]*phi[8]*rdx00)-1.341640786499874*epsxx[3]*phi[7]*rdx00-3.354101966249684*epsxx[0]*phi[6]*rdx00-3.354101966249685*epsxx[2]*phi[4]*rdx00-1.5*epsxx[1]*phi[3]*rdx00-1.5*phi[1]*epsxx[3]*rdx00; 
  out[3] = (-6.0*epsxx[3]*phi[8]*rdx00)-6.708203932499369*epsxx[1]*phi[6]*rdx00-6.708203932499369*epsxx[3]*phi[4]*rdx00; 

}

void gkyl_gyrokinetic_pol_density_3x_ser_p1(const double *dx, const double *epsilon, const double *phi, double *out) 
{ 
  // dx: cell lengths.
  // epsilon: polarization weight, sum_s jacobgeo*(n_s*m_s/B^2)*g^{ij}.
  // phi: electrostatic potential.
  // out: polarization density.

  const double *epsxx = &epsilon[0];
  const double *epsxy = &epsilon[8];
  const double *epsyy = &epsilon[16];

  double rdx00 = 4.0/(dx[0]*dx[0]);
  double rdx01 = 4.0/(dx[0]*dx[1]);
  double rdx11 = 4.0/(dx[1]*dx[1]);

  out[0] = (-2.371708245126284*epsyy[5]*phi[18]*rdx11)-2.371708245126284*epsyy[3]*phi[14]*rdx11-2.371708245126284*epsyy[1]*phi[12]*rdx11-1.060660171779821*epsyy[7]*phi[10]*rdx11-2.371708245126284*epsyy[0]*phi[8]*rdx11-1.060660171779821*epsyy[6]*phi[6]*rdx11-1.060660171779821*epsyy[4]*phi[4]*rdx11-1.060660171779821*epsyy[2]*phi[2]*rdx11-10.60660171779821*epsxy[7]*phi[23]*rdx01-10.60660171779821*epsxy[4]*phi[20]*rdx01-4.743416490252569*epsxy[6]*phi[18]*rdx01-4.743416490252569*epsxy[5]*phi[17]*rdx01-2.371708245126284*epsxy[7]*phi[14]*rdx01-2.371708245126284*epsxy[7]*phi[13]*rdx01-4.743416490252569*epsxy[2]*phi[12]*rdx01-4.743416490252569*epsxy[1]*phi[11]*rdx01-2.121320343559642*epsxy[3]*phi[10]*rdx01-2.371708245126284*epsxy[4]*phi[8]*rdx01-2.371708245126284*epsxy[4]*phi[7]*rdx01-1.060660171779821*epsxy[5]*phi[6]*rdx01-1.060660171779821*phi[5]*epsxy[6]*rdx01-2.121320343559642*epsxy[0]*phi[4]*rdx01-1.060660171779821*epsxy[1]*phi[2]*rdx01-1.060660171779821*phi[1]*epsxy[2]*rdx01-2.371708245126284*epsxx[6]*phi[17]*rdx00-2.371708245126284*epsxx[3]*phi[13]*rdx00-2.371708245126284*epsxx[2]*phi[11]*rdx00-1.060660171779821*epsxx[7]*phi[10]*rdx00-2.371708245126284*epsxx[0]*phi[7]*rdx00-1.060660171779821*epsxx[5]*phi[5]*rdx00-1.060660171779821*epsxx[4]*phi[4]*rdx00-1.060660171779821*epsxx[1]*phi[1]*rdx00; 
  out[1] = (-2.121320343559642*epsyy[5]*phi[23]*rdx11)-2.121320343559642*epsyy[1]*phi[20]*rdx11-2.371708245126284*epsyy[3]*phi[18]*rdx11-0.9486832980505137*epsyy[7]*phi[17]*rdx11-2.371708245126284*epsyy[5]*phi[14]*rdx11-2.371708245126284*epsyy[0]*phi[12]*rdx11-0.9486832980505138*epsyy[4]*phi[11]*rdx11-1.060660171779821*epsyy[6]*phi[10]*rdx11-2.371708245126284*epsyy[1]*phi[8]*rdx11-1.060660171779821*phi[6]*epsyy[7]*rdx11-1.060660171779821*epsyy[2]*phi[4]*rdx11-1.060660171779821*phi[2]*epsyy[4]*rdx11-10.60660171779821*epsxy[6]*phi[23]*rdx01-10.60660171779821*epsxy[2]*phi[20]*rdx01-7.115124735378853*epsxy[7]*phi[18]*rdx01-4.743416490252569*epsxy[3]*phi[17]*rdx01-2.371708245126284*epsxy[6]*phi[13]*rdx01-7.115124735378853*epsxy[4]*phi[12]*rdx01-4.743416490252569*epsxy[0]*phi[11]*rdx01-3.181980515339463*epsxy[5]*phi[10]*rdx01-2.371708245126284*epsxy[2]*phi[7]*rdx01-1.060660171779821*phi[5]*epsxy[7]*rdx01-3.181980515339463*epsxy[1]*phi[4]*rdx01-1.060660171779821*phi[1]*epsxy[4]*rdx01-4.743416490252569*epsxx[7]*phi[17]*rdx00-4.743416490252569*epsxx[5]*phi[13]*rdx00-4.743416490252569*epsxx[4]*phi[11]*rdx00-4.743416490252569*epsxx[1]*phi[7]*rdx00; 
  out[2] = (-4.743416490252569*epsyy[7]*phi[18]*rdx11)-4.743416490252569*epsyy[6]*phi[14]*rdx11-4.743416490252569*epsyy[4]*phi[12]*rdx11-4.743416490252569*epsyy[2]*phi[8]*rdx11-10.60660171779821*epsxy[5]*phi[23]*rdx01-10.60660171779821*epsxy[1]*phi[20]*rdx01-4.743416490252569*epsxy[3]*phi[18]*rdx01-7.115124735378853*epsxy[7]*phi[17]*rdx01-2.371708245126284*epsxy[5]*phi[14]*rdx01-4.743416490252569*epsxy[0]*phi[12]*rdx01-7.115124735378853*epsxy[4]*phi[11]*rdx01-3.181980515339463*epsxy[6]*phi[10]*rdx01-2.371708245126284*epsxy[1]*phi[8]*rdx01-1.060660171779821*phi[6]*epsxy[7]*rdx01-3.181980515339463*epsxy[2]*phi[4]*rdx01-1.060660171779821*phi[2]*epsxy[4]*rdx01-2.121320343559642*epsxx[6]*phi[23]*rdx00-2.121320343559642*epsxx[2]*phi[20]*rdx00-0.9486832980505137*epsxx[7]*phi[18]*rdx00-2.371708245126284*epsxx[3]*phi[17]*rdx00-2.371708245126284*epsxx[6]*phi[13]*rdx00-0.9486832980505138*epsxx[4]*phi[12]*rdx00-2.371708245126284*epsxx[0]*phi[11]*rdx00-1.060660171779821*epsxx[5]*phi[10]*rdx00-2.371708245126284*epsxx[2]*phi[7]*rdx00-1.060660171779821*phi[5]*epsxx[7]*rdx00-1.060660171779821*epsxx[1]*phi[4]*rdx00-1.060660171779821*phi[1]*epsxx[4]*rdx00; 
  out[3] = (-2.121320343559642*epsyy[5]*phi[25]*rdx11)-2.121320343559642*epsyy[3]*phi[22]*rdx11-0.9486832980505137*epsyy[7]*phi[19]*rdx11-2.371708245126284*epsyy[1]*phi[18]*rdx11-0.9486832980505138*epsyy[6]*phi[16]*rdx11-2.371708245126284*epsyy[0]*phi[14]*rdx11-2.371708245126284*epsyy[5]*phi[12]*rdx11-1.060660171779821*epsyy[4]*phi[10]*rdx11-2.371708245126284*epsyy[3]*phi[8]*rdx11-1.060660171779821*phi[4]*epsyy[7]*rdx11-1.060660171779821*epsyy[2]*phi[6]*rdx11-1.060660171779821*phi[2]*epsyy[6]*rdx11-9.48683298050514*epsxy[7]*phi[26]*rdx01-4.242640687119286*epsxy[6]*phi[25]*rdx01-4.242640687119286*epsxy[5]*phi[24]*rdx01-10.60660171779821*epsxy[4]*phi[23]*rdx01-2.121320343559642*epsxy[7]*phi[22]*rdx01-2.121320343559642*epsxy[7]*phi[21]*rdx01-10.60660171779821*epsxy[7]*phi[20]*rdx01-1.897366596101028*epsxy[3]*phi[19]*rdx01-4.743416490252569*epsxy[2]*phi[18]*rdx01-4.743416490252569*epsxy[1]*phi[17]*rdx01-0.9486832980505138*epsxy[5]*phi[16]*rdx01-0.9486832980505138*epsxy[6]*phi[15]*rdx01-2.371708245126284*epsxy[4]*phi[14]*rdx01-2.371708245126284*epsxy[4]*phi[13]*rdx01-4.743416490252569*epsxy[6]*phi[12]*rdx01-4.743416490252569*epsxy[5]*phi[11]*rdx01-2.121320343559642*epsxy[0]*phi[10]*rdx01-2.371708245126284*epsxy[7]*phi[8]*rdx01-2.371708245126284*epsxy[7]*phi[7]*rdx01-1.060660171779821*epsxy[1]*phi[6]*rdx01-1.060660171779821*phi[1]*epsxy[6]*rdx01-1.060660171779821*epsxy[2]*phi[5]*rdx01-1.060660171779821*phi[2]*epsxy[5]*rdx01-2.121320343559642*epsxy[3]*phi[4]*rdx01-2.121320343559642*epsxx[6]*phi[24]*rdx00-2.121320343559642*epsxx[3]*phi[21]*rdx00-0.9486832980505137*epsxx[7]*phi[19]*rdx00-2.371708245126284*epsxx[2]*phi[17]*rdx00-0.9486832980505138*epsxx[5]*phi[15]*rdx00-2.371708245126284*epsxx[0]*phi[13]*rdx00-2.371708245126284*epsxx[6]*phi[11]*rdx00-1.060660171779821*epsxx[4]*phi[10]*rdx00-2.371708245126284*epsxx[3]*phi[7]*rdx00-1.060660171779821*phi[4]*epsxx[7]*rdx00-1.060660171779821*epsxx[1]*phi[5]*rdx00-1.060660171779821*phi[1]*epsxx[5]*rdx00; 
  out[4] = (-4.242640687119286*epsyy[7]*phi[23]*rdx11)-4.242640687119286*epsyy[4]*phi[20]*rdx11-4.743416490252569*epsyy[6]*phi[18]*rdx11-4.743416490252569*epsyy[7]*phi[14]*rdx11-4.743416490252569*epsyy[2]*phi[12]*rdx11-4.743416490252569*epsyy[4]*phi[8]*rdx11-10.60660171779821*epsxy[3]*phi[23]*rdx01-10.60660171779821*epsxy[0]*phi[20]*rdx01-7.115124735378853*epsxy[5]*phi[18]*rdx01-7.115124735378853*epsxy[6]*phi[17]*rdx01-7.115124735378853*epsxy[1]*phi[12]*rdx01-7.115124735378853*epsxy[2]*phi[11]*rdx01-4.242640687119286*epsxy[7]*phi[10]*rdx01-4.242640687119286*epsxy[4]*phi[4]*rdx01-4.242640687119286*epsxx[7]*phi[23]*rdx00-4.242640687119286*epsxx[4]*phi[20]*rdx00-4.743416490252569*epsxx[5]*phi[17]*rdx00-4.743416490252569*epsxx[7]*phi[13]*rdx00-4.743416490252569*epsxx[1]*phi[11]*rdx00-4.743416490252569*epsxx[4]*phi[7]*rdx00; 
  out[5] = (-1.897366596101028*epsyy[5]*phi[26]*rdx11)-2.121320343559642*epsyy[3]*phi[25]*rdx11-0.848528137423857*epsyy[7]*phi[24]*rdx11-2.121320343559642*epsyy[1]*phi[23]*rdx11-2.121320343559642*epsyy[5]*phi[22]*rdx11-2.121320343559642*epsyy[5]*phi[20]*rdx11-0.9486832980505137*epsyy[6]*phi[19]*rdx11-2.371708245126284*epsyy[0]*phi[18]*rdx11-0.9486832980505137*epsyy[4]*phi[17]*rdx11-0.9486832980505138*epsyy[7]*phi[16]*rdx11-2.371708245126284*epsyy[1]*phi[14]*rdx11-2.371708245126284*epsyy[3]*phi[12]*rdx11-0.9486832980505138*epsyy[7]*phi[11]*rdx11-1.060660171779821*epsyy[2]*phi[10]*rdx11-2.371708245126284*epsyy[5]*phi[8]*rdx11-1.060660171779821*phi[2]*epsyy[7]*rdx11-1.060660171779821*epsyy[4]*phi[6]*rdx11-1.060660171779821*phi[4]*epsyy[6]*rdx11-9.48683298050514*epsxy[6]*phi[26]*rdx01-6.363961030678928*epsxy[7]*phi[25]*rdx01-4.242640687119286*epsxy[3]*phi[24]*rdx01-10.60660171779821*epsxy[2]*phi[23]*rdx01-2.121320343559642*epsxy[6]*phi[21]*rdx01-10.60660171779821*epsxy[6]*phi[20]*rdx01-2.846049894151542*epsxy[5]*phi[19]*rdx01-7.115124735378853*epsxy[4]*phi[18]*rdx01-4.743416490252569*epsxy[0]*phi[17]*rdx01-0.9486832980505138*epsxy[7]*phi[15]*rdx01-2.371708245126284*epsxy[2]*phi[13]*rdx01-7.115124735378853*epsxy[7]*phi[12]*rdx01-4.743416490252569*epsxy[3]*phi[11]*rdx01-3.181980515339463*epsxy[1]*phi[10]*rdx01-2.371708245126284*epsxy[6]*phi[7]*rdx01-1.060660171779821*phi[1]*epsxy[7]*rdx01-1.060660171779821*epsxy[4]*phi[5]*rdx01-3.181980515339463*phi[4]*epsxy[5]*rdx01-4.242640687119286*epsxx[7]*phi[24]*rdx00-4.242640687119286*epsxx[5]*phi[21]*rdx00-4.743416490252569*epsxx[4]*phi[17]*rdx00-4.743416490252569*epsxx[1]*phi[13]*rdx00-4.743416490252569*epsxx[7]*phi[11]*rdx00-4.743416490252569*epsxx[5]*phi[7]*rdx00; 
  out[6] = (-4.242640687119286*epsyy[7]*phi[25]*rdx11)-4.242640687119286*epsyy[6]*phi[22]*rdx11-4.743416490252569*epsyy[4]*phi[18]*rdx11-4.743416490252569*epsyy[2]*phi[14]*rdx11-4.743416490252569*epsyy[7]*phi[12]*rdx11-4.743416490252569*epsyy[6]*phi[8]*rdx11-9.48683298050514*epsxy[5]*phi[26]*rdx01-4.242640687119286*epsxy[3]*phi[25]*rdx01-6.363961030678928*epsxy[7]*phi[24]*rdx01-10.60660171779821*epsxy[1]*phi[23]*rdx01-2.121320343559642*epsxy[5]*phi[22]*rdx01-10.60660171779821*epsxy[5]*phi[20]*rdx01-2.846049894151542*epsxy[6]*phi[19]*rdx01-4.743416490252569*epsxy[0]*phi[18]*rdx01-7.115124735378853*epsxy[4]*phi[17]*rdx01-0.9486832980505138*epsxy[7]*phi[16]*rdx01-2.371708245126284*epsxy[1]*phi[14]*rdx01-4.743416490252569*epsxy[3]*phi[12]*rdx01-7.115124735378853*epsxy[7]*phi[11]*rdx01-3.181980515339463*epsxy[2]*phi[10]*rdx01-2.371708245126284*epsxy[5]*phi[8]*rdx01-1.060660171779821*phi[2]*epsxy[7]*rdx01-1.060660171779821*epsxy[4]*phi[6]*rdx01-3.181980515339463*phi[4]*epsxy[6]*rdx01-1.897366596101028*epsxx[6]*phi[26]*rdx00-0.848528137423857*epsxx[7]*phi[25]*rdx00-2.121320343559642*epsxx[3]*phi[24]*rdx00-2.121320343559642*epsxx[2]*phi[23]*rdx00-2.121320343559642*epsxx[6]*phi[21]*rdx00-2.121320343559642*epsxx[6]*phi[20]*rdx00-0.9486832980505137*epsxx[5]*phi[19]*rdx00-0.9486832980505137*epsxx[4]*phi[18]*rdx00-2.371708245126284*epsxx[0]*phi[17]*rdx00-0.9486832980505138*epsxx[7]*phi[15]*rdx00-2.371708245126284*epsxx[2]*phi[13]*rdx00-0.9486832980505138*epsxx[7]*phi[12]*rdx00-2.371708245126284*epsxx[3]*phi[11]*rdx00-1.060660171779821*epsxx[1]*phi[10]*rdx00-2.371708245126284*epsxx[6]*phi[7]*rdx00-1.060660171779821*phi[1]*epsxx[7]*rdx00-1.060660171779821*epsxx[4]*phi[5]*rdx00-1.060660171779821*phi[4]*epsxx[5]*rdx00; 
  out[7] = (-3.794733192202056*epsyy[7]*phi[26]*rdx11)-4.242640687119286*epsyy[6]*phi[25]*rdx11-4.242640687119286*epsyy[4]*phi[23]*rdx11-4.242640687119286*epsyy[7]*phi[22]*rdx11-4.242640687119286*epsyy[7]*phi[20]*rdx11-4.743416490252569*epsyy[2]*phi[18]*rdx11-4.743416490252569*epsyy[4]*phi[14]*rdx11-4.743416490252569*epsyy[6]*phi[12]*rdx11-4.743416490252569*epsyy[7]*phi[8]*rdx11-9.48683298050514*epsxy[3]*phi[26]*rdx01-6.363961030678928*epsxy[5]*phi[25]*rdx01-6.363961030678928*epsxy[6]*phi[24]*rdx01-10.60660171779821*epsxy[0]*phi[23]*rdx01-10.60660171779821*epsxy[3]*phi[20]*rdx01-3.794733192202056*epsxy[7]*phi[19]*rdx01-7.115124735378853*epsxy[1]*phi[18]*rdx01-7.115124735378853*epsxy[2]*phi[17]*rdx01-7.115124735378853*epsxy[5]*phi[12]*rdx01-7.115124735378853*epsxy[6]*phi[11]*rdx01-4.242640687119286*epsxy[4]*phi[10]*rdx01-4.242640687119286*phi[4]*epsxy[7]*rdx01-3.794733192202056*epsxx[7]*phi[26]*rdx00-4.242640687119286*epsxx[5]*phi[24]*rdx00-4.242640687119286*epsxx[4]*phi[23]*rdx00-4.242640687119286*epsxx[7]*phi[21]*rdx00-4.242640687119286*epsxx[7]*phi[20]*rdx00-4.743416490252569*epsxx[1]*phi[17]*rdx00-4.743416490252569*epsxx[4]*phi[13]*rdx00-4.743416490252569*epsxx[5]*phi[11]*rdx00-4.743416490252569*epsxx[7]*phi[7]*rdx00; 

}

