#include <gkyl_mom_gyrokinetic_kernels.h> 
GKYL_CU_DH void gyrokinetic_M0_3x2v_ser_p1(const double *dxv, const double *vmap, double m_, const double *bmag, const double *f, double* GKYL_RESTRICT out) 
{ 
  const double volFact = 1.5707963267948966*dxv[3]*dxv[4]/m_; 
  out[0] += 2.0*f[0]*volFact; 
  out[1] += 2.0*f[1]*volFact; 
  out[2] += 2.0*f[2]*volFact; 
  out[3] += 2.0*f[3]*volFact; 
  out[4] += 2.0*f[6]*volFact; 
  out[5] += 2.0*f[7]*volFact; 
  out[6] += 2.0*f[8]*volFact; 
  out[7] += 2.0*f[16]*volFact; 
} 

GKYL_CU_DH void gyrokinetic_M1_3x2v_ser_p1(const double *dxv, const double *vmap, double m_, const double *bmag, const double *f, double* GKYL_RESTRICT out) 
{ 
  const double volFact = 1.5707963267948966*dxv[3]*dxv[4]/m_; 
  out[0] += (1.4142135623730951*vmap[1]*f[4]+1.4142135623730951*f[0]*vmap[0])*volFact; 
  out[1] += (1.4142135623730951*vmap[1]*f[9]+1.4142135623730951*vmap[0]*f[1])*volFact; 
  out[2] += (1.4142135623730951*vmap[1]*f[10]+1.4142135623730951*vmap[0]*f[2])*volFact; 
  out[3] += (1.4142135623730951*vmap[1]*f[11]+1.4142135623730951*vmap[0]*f[3])*volFact; 
  out[4] += (1.4142135623730951*vmap[1]*f[17]+1.4142135623730951*vmap[0]*f[6])*volFact; 
  out[5] += (1.4142135623730951*vmap[1]*f[18]+1.4142135623730951*vmap[0]*f[7])*volFact; 
  out[6] += (1.4142135623730951*vmap[1]*f[19]+1.4142135623730951*vmap[0]*f[8])*volFact; 
  out[7] += (1.4142135623730951*vmap[1]*f[26]+1.4142135623730951*vmap[0]*f[16])*volFact; 
} 

GKYL_CU_DH void gyrokinetic_M2_3x2v_ser_p1(const double *dxv, const double *vmap, double m_, const double *bmag, const double *f, double* GKYL_RESTRICT out) 
{ 
  const double volFact = 1.5707963267948966*dxv[3]*dxv[4]/m_; 
  const double vmap0R2 = pow(vmap[0],2);
  const double vmap1R2 = pow(vmap[1],2);

  out[0] += (0.8944271909999159*vmap1R2*f[32]+2.0*vmap[0]*vmap[1]*f[4]+f[0]*vmap1R2+f[0]*vmap0R2)*volFact; 
  out[1] += (0.8944271909999161*vmap1R2*f[33]+2.0*vmap[0]*vmap[1]*f[9]+f[1]*vmap1R2+vmap0R2*f[1])*volFact; 
  out[2] += (0.8944271909999161*vmap1R2*f[34]+2.0*vmap[0]*vmap[1]*f[10]+vmap1R2*f[2]+vmap0R2*f[2])*volFact; 
  out[3] += (0.8944271909999161*vmap1R2*f[35]+2.0*vmap[0]*vmap[1]*f[11]+vmap1R2*f[3]+vmap0R2*f[3])*volFact; 
  out[4] += (0.8944271909999159*vmap1R2*f[37]+2.0*vmap[0]*vmap[1]*f[17]+vmap1R2*f[6]+vmap0R2*f[6])*volFact; 
  out[5] += (0.8944271909999159*vmap1R2*f[38]+2.0*vmap[0]*vmap[1]*f[18]+vmap1R2*f[7]+vmap0R2*f[7])*volFact; 
  out[6] += (0.8944271909999159*vmap1R2*f[39]+2.0*vmap[0]*vmap[1]*f[19]+vmap1R2*f[8]+vmap0R2*f[8])*volFact; 
  out[7] += (0.8944271909999161*vmap1R2*f[43]+2.0*vmap[0]*vmap[1]*f[26]+vmap1R2*f[16]+vmap0R2*f[16])*volFact; 
  double tmp[8]; 
  tmp[0] = 1.4142135623730951*vmap[3]*f[5]+1.4142135623730951*f[0]*vmap[2]; 
  tmp[1] = 1.4142135623730951*vmap[3]*f[12]+1.4142135623730951*f[1]*vmap[2]; 
  tmp[2] = 1.4142135623730951*vmap[3]*f[13]+1.4142135623730951*f[2]*vmap[2]; 
  tmp[3] = 1.4142135623730951*vmap[3]*f[14]+1.4142135623730951*vmap[2]*f[3]; 
  tmp[4] = 1.4142135623730951*vmap[3]*f[20]+1.4142135623730951*vmap[2]*f[6]; 
  tmp[5] = 1.4142135623730951*vmap[3]*f[21]+1.4142135623730951*vmap[2]*f[7]; 
  tmp[6] = 1.4142135623730951*vmap[3]*f[22]+1.4142135623730951*vmap[2]*f[8]; 
  tmp[7] = 1.4142135623730951*vmap[3]*f[27]+1.4142135623730951*vmap[2]*f[16]; 
  out[0] += (2.0*(0.3535533905932737*bmag[7]*tmp[7]+0.3535533905932737*bmag[6]*tmp[6]+0.3535533905932737*bmag[5]*tmp[5]+0.3535533905932737*bmag[4]*tmp[4]+0.3535533905932737*bmag[3]*tmp[3]+0.3535533905932737*bmag[2]*tmp[2]+0.3535533905932737*bmag[1]*tmp[1]+0.3535533905932737*bmag[0]*tmp[0])*volFact)/m_; 
  out[1] += (2.0*(0.3535533905932737*bmag[6]*tmp[7]+0.3535533905932737*tmp[6]*bmag[7]+0.3535533905932737*bmag[3]*tmp[5]+0.3535533905932737*tmp[3]*bmag[5]+0.3535533905932737*bmag[2]*tmp[4]+0.3535533905932737*tmp[2]*bmag[4]+0.3535533905932737*bmag[0]*tmp[1]+0.3535533905932737*tmp[0]*bmag[1])*volFact)/m_; 
  out[2] += (2.0*(0.3535533905932737*bmag[5]*tmp[7]+0.3535533905932737*tmp[5]*bmag[7]+0.3535533905932737*bmag[3]*tmp[6]+0.3535533905932737*tmp[3]*bmag[6]+0.3535533905932737*bmag[1]*tmp[4]+0.3535533905932737*tmp[1]*bmag[4]+0.3535533905932737*bmag[0]*tmp[2]+0.3535533905932737*tmp[0]*bmag[2])*volFact)/m_; 
  out[3] += (2.0*(0.3535533905932737*bmag[4]*tmp[7]+0.3535533905932737*tmp[4]*bmag[7]+0.3535533905932737*bmag[2]*tmp[6]+0.3535533905932737*tmp[2]*bmag[6]+0.3535533905932737*bmag[1]*tmp[5]+0.3535533905932737*tmp[1]*bmag[5]+0.3535533905932737*bmag[0]*tmp[3]+0.3535533905932737*tmp[0]*bmag[3])*volFact)/m_; 
  out[4] += (2.0*(0.3535533905932737*bmag[3]*tmp[7]+0.3535533905932737*tmp[3]*bmag[7]+0.3535533905932737*bmag[5]*tmp[6]+0.3535533905932737*tmp[5]*bmag[6]+0.3535533905932737*bmag[0]*tmp[4]+0.3535533905932737*tmp[0]*bmag[4]+0.3535533905932737*bmag[1]*tmp[2]+0.3535533905932737*tmp[1]*bmag[2])*volFact)/m_; 
  out[5] += (2.0*(0.3535533905932737*bmag[2]*tmp[7]+0.3535533905932737*tmp[2]*bmag[7]+0.3535533905932737*bmag[4]*tmp[6]+0.3535533905932737*tmp[4]*bmag[6]+0.3535533905932737*bmag[0]*tmp[5]+0.3535533905932737*tmp[0]*bmag[5]+0.3535533905932737*bmag[1]*tmp[3]+0.3535533905932737*tmp[1]*bmag[3])*volFact)/m_; 
  out[6] += (2.0*(0.3535533905932737*bmag[1]*tmp[7]+0.3535533905932737*tmp[1]*bmag[7]+0.3535533905932737*bmag[0]*tmp[6]+0.3535533905932737*tmp[0]*bmag[6]+0.3535533905932737*bmag[4]*tmp[5]+0.3535533905932737*tmp[4]*bmag[5]+0.3535533905932737*bmag[2]*tmp[3]+0.3535533905932737*tmp[2]*bmag[3])*volFact)/m_; 
  out[7] += (2.0*(0.3535533905932737*bmag[0]*tmp[7]+0.3535533905932737*tmp[0]*bmag[7]+0.3535533905932737*bmag[1]*tmp[6]+0.3535533905932737*tmp[1]*bmag[6]+0.3535533905932737*bmag[2]*tmp[5]+0.3535533905932737*tmp[2]*bmag[5]+0.3535533905932737*bmag[3]*tmp[4]+0.3535533905932737*tmp[3]*bmag[4])*volFact)/m_; 
} 

GKYL_CU_DH void gyrokinetic_M2_par_3x2v_ser_p1(const double *dxv, const double *vmap, double m_, const double *bmag, const double *f, double* GKYL_RESTRICT out) 
{ 
  const double volFact = 1.5707963267948966*dxv[3]*dxv[4]/m_; 
  const double vmap0R2 = pow(vmap[0],2);
  const double vmap1R2 = pow(vmap[1],2);

  out[0] += (0.8944271909999159*vmap1R2*f[32]+2.0*vmap[0]*vmap[1]*f[4]+f[0]*vmap1R2+f[0]*vmap0R2)*volFact; 
  out[1] += (0.8944271909999161*vmap1R2*f[33]+2.0*vmap[0]*vmap[1]*f[9]+f[1]*vmap1R2+vmap0R2*f[1])*volFact; 
  out[2] += (0.8944271909999161*vmap1R2*f[34]+2.0*vmap[0]*vmap[1]*f[10]+vmap1R2*f[2]+vmap0R2*f[2])*volFact; 
  out[3] += (0.8944271909999161*vmap1R2*f[35]+2.0*vmap[0]*vmap[1]*f[11]+vmap1R2*f[3]+vmap0R2*f[3])*volFact; 
  out[4] += (0.8944271909999159*vmap1R2*f[37]+2.0*vmap[0]*vmap[1]*f[17]+vmap1R2*f[6]+vmap0R2*f[6])*volFact; 
  out[5] += (0.8944271909999159*vmap1R2*f[38]+2.0*vmap[0]*vmap[1]*f[18]+vmap1R2*f[7]+vmap0R2*f[7])*volFact; 
  out[6] += (0.8944271909999159*vmap1R2*f[39]+2.0*vmap[0]*vmap[1]*f[19]+vmap1R2*f[8]+vmap0R2*f[8])*volFact; 
  out[7] += (0.8944271909999161*vmap1R2*f[43]+2.0*vmap[0]*vmap[1]*f[26]+vmap1R2*f[16]+vmap0R2*f[16])*volFact; 
} 

GKYL_CU_DH void gyrokinetic_M2_perp_3x2v_ser_p1(const double *dxv, const double *vmap, double m_, const double *bmag, const double *f, double* GKYL_RESTRICT out) 
{ 
  const double volFact = 1.5707963267948966*dxv[3]*dxv[4]/m_; 
  double tmp[8]; 
  tmp[0] = 1.4142135623730951*vmap[3]*f[5]+1.4142135623730951*f[0]*vmap[2]; 
  tmp[1] = 1.4142135623730951*vmap[3]*f[12]+1.4142135623730951*f[1]*vmap[2]; 
  tmp[2] = 1.4142135623730951*vmap[3]*f[13]+1.4142135623730951*f[2]*vmap[2]; 
  tmp[3] = 1.4142135623730951*vmap[3]*f[14]+1.4142135623730951*vmap[2]*f[3]; 
  tmp[4] = 1.4142135623730951*vmap[3]*f[20]+1.4142135623730951*vmap[2]*f[6]; 
  tmp[5] = 1.4142135623730951*vmap[3]*f[21]+1.4142135623730951*vmap[2]*f[7]; 
  tmp[6] = 1.4142135623730951*vmap[3]*f[22]+1.4142135623730951*vmap[2]*f[8]; 
  tmp[7] = 1.4142135623730951*vmap[3]*f[27]+1.4142135623730951*vmap[2]*f[16]; 
  out[0] += (2.0*(0.3535533905932737*bmag[7]*tmp[7]+0.3535533905932737*bmag[6]*tmp[6]+0.3535533905932737*bmag[5]*tmp[5]+0.3535533905932737*bmag[4]*tmp[4]+0.3535533905932737*bmag[3]*tmp[3]+0.3535533905932737*bmag[2]*tmp[2]+0.3535533905932737*bmag[1]*tmp[1]+0.3535533905932737*bmag[0]*tmp[0])*volFact)/m_; 
  out[1] += (2.0*(0.3535533905932737*bmag[6]*tmp[7]+0.3535533905932737*tmp[6]*bmag[7]+0.3535533905932737*bmag[3]*tmp[5]+0.3535533905932737*tmp[3]*bmag[5]+0.3535533905932737*bmag[2]*tmp[4]+0.3535533905932737*tmp[2]*bmag[4]+0.3535533905932737*bmag[0]*tmp[1]+0.3535533905932737*tmp[0]*bmag[1])*volFact)/m_; 
  out[2] += (2.0*(0.3535533905932737*bmag[5]*tmp[7]+0.3535533905932737*tmp[5]*bmag[7]+0.3535533905932737*bmag[3]*tmp[6]+0.3535533905932737*tmp[3]*bmag[6]+0.3535533905932737*bmag[1]*tmp[4]+0.3535533905932737*tmp[1]*bmag[4]+0.3535533905932737*bmag[0]*tmp[2]+0.3535533905932737*tmp[0]*bmag[2])*volFact)/m_; 
  out[3] += (2.0*(0.3535533905932737*bmag[4]*tmp[7]+0.3535533905932737*tmp[4]*bmag[7]+0.3535533905932737*bmag[2]*tmp[6]+0.3535533905932737*tmp[2]*bmag[6]+0.3535533905932737*bmag[1]*tmp[5]+0.3535533905932737*tmp[1]*bmag[5]+0.3535533905932737*bmag[0]*tmp[3]+0.3535533905932737*tmp[0]*bmag[3])*volFact)/m_; 
  out[4] += (2.0*(0.3535533905932737*bmag[3]*tmp[7]+0.3535533905932737*tmp[3]*bmag[7]+0.3535533905932737*bmag[5]*tmp[6]+0.3535533905932737*tmp[5]*bmag[6]+0.3535533905932737*bmag[0]*tmp[4]+0.3535533905932737*tmp[0]*bmag[4]+0.3535533905932737*bmag[1]*tmp[2]+0.3535533905932737*tmp[1]*bmag[2])*volFact)/m_; 
  out[5] += (2.0*(0.3535533905932737*bmag[2]*tmp[7]+0.3535533905932737*tmp[2]*bmag[7]+0.3535533905932737*bmag[4]*tmp[6]+0.3535533905932737*tmp[4]*bmag[6]+0.3535533905932737*bmag[0]*tmp[5]+0.3535533905932737*tmp[0]*bmag[5]+0.3535533905932737*bmag[1]*tmp[3]+0.3535533905932737*tmp[1]*bmag[3])*volFact)/m_; 
  out[6] += (2.0*(0.3535533905932737*bmag[1]*tmp[7]+0.3535533905932737*tmp[1]*bmag[7]+0.3535533905932737*bmag[0]*tmp[6]+0.3535533905932737*tmp[0]*bmag[6]+0.3535533905932737*bmag[4]*tmp[5]+0.3535533905932737*tmp[4]*bmag[5]+0.3535533905932737*bmag[2]*tmp[3]+0.3535533905932737*tmp[2]*bmag[3])*volFact)/m_; 
  out[7] += (2.0*(0.3535533905932737*bmag[0]*tmp[7]+0.3535533905932737*tmp[0]*bmag[7]+0.3535533905932737*bmag[1]*tmp[6]+0.3535533905932737*tmp[1]*bmag[6]+0.3535533905932737*bmag[2]*tmp[5]+0.3535533905932737*tmp[2]*bmag[5]+0.3535533905932737*bmag[3]*tmp[4]+0.3535533905932737*tmp[3]*bmag[4])*volFact)/m_; 
} 

GKYL_CU_DH void gyrokinetic_M3_par_3x2v_ser_p1(const double *dxv, const double *vmap, double m_, const double *bmag, const double *f, double* GKYL_RESTRICT out) 
{ 
  const double volFact = 1.5707963267948966*dxv[3]*dxv[4]/m_; 
  const double vmap0R2 = pow(vmap[0],2);
  const double vmap0R3 = pow(vmap[0],3);
  const double vmap1R2 = pow(vmap[1],2);
  const double vmap1R3 = pow(vmap[1],3);

  out[0] += (1.8973665961010278*vmap[0]*vmap1R2*f[32]+1.2727922061357855*vmap1R3*f[4]+2.1213203435596424*vmap0R2*vmap[1]*f[4]+2.1213203435596424*f[0]*vmap[0]*vmap1R2+0.7071067811865475*f[0]*vmap0R3)*volFact; 
  out[1] += (1.897366596101028*vmap[0]*vmap1R2*f[33]+1.2727922061357855*vmap1R3*f[9]+2.1213203435596424*vmap0R2*vmap[1]*f[9]+2.1213203435596424*vmap[0]*f[1]*vmap1R2+0.7071067811865475*vmap0R3*f[1])*volFact; 
  out[2] += (1.897366596101028*vmap[0]*vmap1R2*f[34]+1.2727922061357855*vmap1R3*f[10]+2.1213203435596424*vmap0R2*vmap[1]*f[10]+2.1213203435596424*vmap[0]*vmap1R2*f[2]+0.7071067811865475*vmap0R3*f[2])*volFact; 
  out[3] += (1.897366596101028*vmap[0]*vmap1R2*f[35]+1.2727922061357855*vmap1R3*f[11]+2.1213203435596424*vmap0R2*vmap[1]*f[11]+2.1213203435596424*vmap[0]*vmap1R2*f[3]+0.7071067811865475*vmap0R3*f[3])*volFact; 
  out[4] += (1.8973665961010278*vmap[0]*vmap1R2*f[37]+1.2727922061357855*vmap1R3*f[17]+2.1213203435596424*vmap0R2*vmap[1]*f[17]+2.1213203435596424*vmap[0]*vmap1R2*f[6]+0.7071067811865475*vmap0R3*f[6])*volFact; 
  out[5] += (1.8973665961010278*vmap[0]*vmap1R2*f[38]+1.2727922061357855*vmap1R3*f[18]+2.1213203435596424*vmap0R2*vmap[1]*f[18]+2.1213203435596424*vmap[0]*vmap1R2*f[7]+0.7071067811865475*vmap0R3*f[7])*volFact; 
  out[6] += (1.8973665961010278*vmap[0]*vmap1R2*f[39]+1.2727922061357855*vmap1R3*f[19]+2.1213203435596424*vmap0R2*vmap[1]*f[19]+2.1213203435596424*vmap[0]*vmap1R2*f[8]+0.7071067811865475*vmap0R3*f[8])*volFact; 
  out[7] += (1.897366596101028*vmap[0]*vmap1R2*f[43]+1.2727922061357855*vmap1R3*f[26]+2.1213203435596424*vmap0R2*vmap[1]*f[26]+2.1213203435596424*vmap[0]*vmap1R2*f[16]+0.7071067811865475*vmap0R3*f[16])*volFact; 
} 

GKYL_CU_DH void gyrokinetic_M3_perp_3x2v_ser_p1(const double *dxv, const double *vmap, double m_, const double *bmag, const double *f, double* GKYL_RESTRICT out) 
{ 
  const double volFact = 1.5707963267948966*dxv[3]*dxv[4]/m_; 

  out[0] += ((0.7071067811865475*vmap[1]*vmap[3]*bmag[7]*f[31]+0.7071067811865475*vmap[1]*vmap[3]*bmag[6]*f[30]+0.7071067811865475*vmap[1]*vmap[3]*bmag[5]*f[29]+0.7071067811865475*vmap[1]*vmap[3]*bmag[4]*f[28]+0.7071067811865475*vmap[0]*vmap[3]*bmag[7]*f[27]+0.7071067811865475*vmap[1]*vmap[2]*bmag[7]*f[26]+0.7071067811865475*vmap[1]*bmag[3]*vmap[3]*f[25]+0.7071067811865475*vmap[1]*bmag[2]*vmap[3]*f[24]+0.7071067811865475*bmag[1]*vmap[1]*vmap[3]*f[23]+0.7071067811865475*vmap[0]*vmap[3]*bmag[6]*f[22]+0.7071067811865475*vmap[0]*vmap[3]*bmag[5]*f[21]+0.7071067811865475*vmap[0]*vmap[3]*bmag[4]*f[20]+0.7071067811865475*vmap[1]*vmap[2]*bmag[6]*f[19]+0.7071067811865475*vmap[1]*vmap[2]*bmag[5]*f[18]+0.7071067811865475*vmap[1]*vmap[2]*bmag[4]*f[17]+0.7071067811865475*vmap[0]*vmap[2]*bmag[7]*f[16]+0.7071067811865475*bmag[0]*vmap[1]*vmap[3]*f[15]+0.7071067811865475*vmap[0]*bmag[3]*vmap[3]*f[14]+0.7071067811865475*vmap[0]*bmag[2]*vmap[3]*f[13]+0.7071067811865475*vmap[0]*bmag[1]*vmap[3]*f[12]+0.7071067811865475*vmap[1]*vmap[2]*bmag[3]*f[11]+0.7071067811865475*vmap[1]*bmag[2]*vmap[2]*f[10]+0.7071067811865475*bmag[1]*vmap[1]*vmap[2]*f[9]+0.7071067811865475*vmap[0]*vmap[2]*bmag[6]*f[8]+0.7071067811865475*vmap[0]*vmap[2]*bmag[5]*f[7]+0.7071067811865475*vmap[0]*vmap[2]*bmag[4]*f[6]+0.7071067811865475*bmag[0]*vmap[0]*vmap[3]*f[5]+0.7071067811865475*bmag[0]*vmap[1]*vmap[2]*f[4]+0.7071067811865475*vmap[0]*vmap[2]*bmag[3]*f[3]+0.7071067811865475*vmap[0]*bmag[2]*f[2]*vmap[2]+0.7071067811865475*vmap[0]*bmag[1]*f[1]*vmap[2]+0.7071067811865475*bmag[0]*f[0]*vmap[0]*vmap[2])*volFact)/m_; 
  out[1] += ((0.7071067811865475*vmap[1]*vmap[3]*bmag[6]*f[31]+0.7071067811865475*vmap[1]*vmap[3]*bmag[7]*f[30]+0.7071067811865475*vmap[1]*bmag[3]*vmap[3]*f[29]+0.7071067811865475*vmap[1]*bmag[2]*vmap[3]*f[28]+0.7071067811865475*vmap[0]*vmap[3]*bmag[6]*f[27]+0.7071067811865475*vmap[1]*vmap[2]*bmag[6]*f[26]+0.7071067811865475*vmap[1]*vmap[3]*bmag[5]*f[25]+0.7071067811865475*vmap[1]*vmap[3]*bmag[4]*f[24]+0.7071067811865475*bmag[0]*vmap[1]*vmap[3]*f[23]+0.7071067811865475*vmap[0]*vmap[3]*bmag[7]*f[22]+0.7071067811865475*vmap[0]*bmag[3]*vmap[3]*f[21]+0.7071067811865475*vmap[0]*bmag[2]*vmap[3]*f[20]+0.7071067811865475*vmap[1]*vmap[2]*bmag[7]*f[19]+0.7071067811865475*vmap[1]*vmap[2]*bmag[3]*f[18]+0.7071067811865475*vmap[1]*bmag[2]*vmap[2]*f[17]+0.7071067811865475*vmap[0]*vmap[2]*bmag[6]*f[16]+0.7071067811865475*bmag[1]*vmap[1]*vmap[3]*f[15]+0.7071067811865475*vmap[0]*vmap[3]*bmag[5]*f[14]+0.7071067811865475*vmap[0]*vmap[3]*bmag[4]*f[13]+0.7071067811865475*bmag[0]*vmap[0]*vmap[3]*f[12]+0.7071067811865475*vmap[1]*vmap[2]*bmag[5]*f[11]+0.7071067811865475*vmap[1]*vmap[2]*bmag[4]*f[10]+0.7071067811865475*bmag[0]*vmap[1]*vmap[2]*f[9]+0.7071067811865475*vmap[0]*vmap[2]*bmag[7]*f[8]+0.7071067811865475*vmap[0]*vmap[2]*bmag[3]*f[7]+0.7071067811865475*vmap[0]*bmag[2]*vmap[2]*f[6]+0.7071067811865475*vmap[0]*bmag[1]*vmap[3]*f[5]+0.7071067811865475*vmap[0]*vmap[2]*f[3]*bmag[5]+0.7071067811865475*bmag[1]*vmap[1]*vmap[2]*f[4]+0.7071067811865475*vmap[0]*f[2]*vmap[2]*bmag[4]+0.7071067811865475*bmag[0]*vmap[0]*f[1]*vmap[2]+0.7071067811865475*f[0]*vmap[0]*bmag[1]*vmap[2])*volFact)/m_; 
  out[2] += ((0.7071067811865475*vmap[1]*vmap[3]*bmag[5]*f[31]+0.7071067811865475*vmap[1]*bmag[3]*vmap[3]*f[30]+0.7071067811865475*vmap[1]*vmap[3]*bmag[7]*f[29]+0.7071067811865475*bmag[1]*vmap[1]*vmap[3]*f[28]+0.7071067811865475*vmap[0]*vmap[3]*bmag[5]*f[27]+0.7071067811865475*vmap[1]*vmap[2]*bmag[5]*f[26]+0.7071067811865475*vmap[1]*vmap[3]*bmag[6]*f[25]+0.7071067811865475*bmag[0]*vmap[1]*vmap[3]*f[24]+0.7071067811865475*vmap[1]*vmap[3]*bmag[4]*f[23]+0.7071067811865475*vmap[0]*bmag[3]*vmap[3]*f[22]+0.7071067811865475*vmap[0]*vmap[3]*bmag[7]*f[21]+0.7071067811865475*vmap[0]*bmag[1]*vmap[3]*f[20]+0.7071067811865475*vmap[1]*vmap[2]*bmag[3]*f[19]+0.7071067811865475*vmap[1]*vmap[2]*bmag[7]*f[18]+0.7071067811865475*bmag[1]*vmap[1]*vmap[2]*f[17]+0.7071067811865475*vmap[0]*vmap[2]*bmag[5]*f[16]+0.7071067811865475*vmap[1]*bmag[2]*vmap[3]*f[15]+0.7071067811865475*vmap[0]*vmap[3]*bmag[6]*f[14]+0.7071067811865475*bmag[0]*vmap[0]*vmap[3]*f[13]+0.7071067811865475*vmap[0]*vmap[3]*bmag[4]*f[12]+0.7071067811865475*vmap[1]*vmap[2]*bmag[6]*f[11]+0.7071067811865475*bmag[0]*vmap[1]*vmap[2]*f[10]+0.7071067811865475*vmap[1]*vmap[2]*bmag[4]*f[9]+0.7071067811865475*vmap[0]*vmap[2]*bmag[3]*f[8]+0.7071067811865475*vmap[0]*vmap[2]*bmag[7]*f[7]+0.7071067811865475*vmap[0]*bmag[1]*vmap[2]*f[6]+0.7071067811865475*vmap[0]*vmap[2]*f[3]*bmag[6]+0.7071067811865475*vmap[0]*bmag[2]*vmap[3]*f[5]+0.7071067811865475*vmap[1]*bmag[2]*vmap[2]*f[4]+0.7071067811865475*vmap[0]*f[1]*vmap[2]*bmag[4]+0.7071067811865475*bmag[0]*vmap[0]*f[2]*vmap[2]+0.7071067811865475*f[0]*vmap[0]*bmag[2]*vmap[2])*volFact)/m_; 
  out[3] += ((0.7071067811865475*vmap[1]*vmap[3]*bmag[4]*f[31]+0.7071067811865475*vmap[1]*bmag[2]*vmap[3]*f[30]+0.7071067811865475*bmag[1]*vmap[1]*vmap[3]*f[29]+0.7071067811865475*vmap[1]*vmap[3]*bmag[7]*f[28]+0.7071067811865475*vmap[0]*vmap[3]*bmag[4]*f[27]+0.7071067811865475*vmap[1]*vmap[2]*bmag[4]*f[26]+0.7071067811865475*bmag[0]*vmap[1]*vmap[3]*f[25]+0.7071067811865475*vmap[1]*vmap[3]*bmag[6]*f[24]+0.7071067811865475*vmap[1]*vmap[3]*bmag[5]*f[23]+0.7071067811865475*vmap[0]*bmag[2]*vmap[3]*f[22]+0.7071067811865475*vmap[0]*bmag[1]*vmap[3]*f[21]+0.7071067811865475*vmap[0]*vmap[3]*bmag[7]*f[20]+0.7071067811865475*vmap[1]*bmag[2]*vmap[2]*f[19]+0.7071067811865475*bmag[1]*vmap[1]*vmap[2]*f[18]+0.7071067811865475*vmap[1]*vmap[2]*bmag[7]*f[17]+0.7071067811865475*vmap[0]*vmap[2]*bmag[4]*f[16]+0.7071067811865475*vmap[1]*bmag[3]*vmap[3]*f[15]+0.7071067811865475*bmag[0]*vmap[0]*vmap[3]*f[14]+0.7071067811865475*vmap[0]*vmap[3]*bmag[6]*f[13]+0.7071067811865475*vmap[0]*vmap[3]*bmag[5]*f[12]+0.7071067811865475*bmag[0]*vmap[1]*vmap[2]*f[11]+0.7071067811865475*vmap[1]*vmap[2]*bmag[6]*f[10]+0.7071067811865475*vmap[1]*vmap[2]*bmag[5]*f[9]+0.7071067811865475*vmap[0]*bmag[2]*vmap[2]*f[8]+0.7071067811865475*vmap[0]*bmag[1]*vmap[2]*f[7]+0.7071067811865475*vmap[0]*vmap[2]*f[6]*bmag[7]+0.7071067811865475*vmap[0]*f[2]*vmap[2]*bmag[6]+0.7071067811865475*vmap[0]*bmag[3]*vmap[3]*f[5]+0.7071067811865475*vmap[0]*f[1]*vmap[2]*bmag[5]+0.7071067811865475*vmap[1]*vmap[2]*bmag[3]*f[4]+0.7071067811865475*bmag[0]*vmap[0]*vmap[2]*f[3]+0.7071067811865475*f[0]*vmap[0]*vmap[2]*bmag[3])*volFact)/m_; 
  out[4] += ((0.7071067811865475*vmap[1]*bmag[3]*vmap[3]*f[31]+0.7071067811865475*vmap[1]*vmap[3]*bmag[5]*f[30]+0.7071067811865475*vmap[1]*vmap[3]*bmag[6]*f[29]+0.7071067811865475*bmag[0]*vmap[1]*vmap[3]*f[28]+0.7071067811865475*vmap[0]*bmag[3]*vmap[3]*f[27]+0.7071067811865475*vmap[1]*vmap[2]*bmag[3]*f[26]+0.7071067811865475*vmap[1]*vmap[3]*bmag[7]*f[25]+0.7071067811865475*bmag[1]*vmap[1]*vmap[3]*f[24]+0.7071067811865475*vmap[1]*bmag[2]*vmap[3]*f[23]+0.7071067811865475*vmap[0]*vmap[3]*bmag[5]*f[22]+0.7071067811865475*vmap[0]*vmap[3]*bmag[6]*f[21]+0.7071067811865475*bmag[0]*vmap[0]*vmap[3]*f[20]+0.7071067811865475*vmap[1]*vmap[2]*bmag[5]*f[19]+0.7071067811865475*vmap[1]*vmap[2]*bmag[6]*f[18]+0.7071067811865475*bmag[0]*vmap[1]*vmap[2]*f[17]+0.7071067811865475*vmap[0]*vmap[2]*bmag[3]*f[16]+0.7071067811865475*vmap[1]*vmap[3]*bmag[4]*f[15]+0.7071067811865475*vmap[0]*vmap[3]*bmag[7]*f[14]+0.7071067811865475*vmap[0]*bmag[1]*vmap[3]*f[13]+0.7071067811865475*vmap[0]*bmag[2]*vmap[3]*f[12]+0.7071067811865475*vmap[1]*vmap[2]*bmag[7]*f[11]+0.7071067811865475*bmag[1]*vmap[1]*vmap[2]*f[10]+0.7071067811865475*vmap[1]*bmag[2]*vmap[2]*f[9]+0.7071067811865475*vmap[0]*vmap[2]*bmag[5]*f[8]+0.7071067811865475*vmap[0]*vmap[2]*bmag[6]*f[7]+0.7071067811865475*vmap[0]*vmap[2]*f[3]*bmag[7]+0.7071067811865475*bmag[0]*vmap[0]*vmap[2]*f[6]+0.7071067811865475*vmap[0]*vmap[3]*bmag[4]*f[5]+0.7071067811865475*vmap[1]*vmap[2]*bmag[4]*f[4]+0.7071067811865475*f[0]*vmap[0]*vmap[2]*bmag[4]+0.7071067811865475*vmap[0]*bmag[1]*f[2]*vmap[2]+0.7071067811865475*vmap[0]*f[1]*bmag[2]*vmap[2])*volFact)/m_; 
  out[5] += ((0.7071067811865475*vmap[1]*bmag[2]*vmap[3]*f[31]+0.7071067811865475*vmap[1]*vmap[3]*bmag[4]*f[30]+0.7071067811865475*bmag[0]*vmap[1]*vmap[3]*f[29]+0.7071067811865475*vmap[1]*vmap[3]*bmag[6]*f[28]+0.7071067811865475*vmap[0]*bmag[2]*vmap[3]*f[27]+0.7071067811865475*vmap[1]*bmag[2]*vmap[2]*f[26]+0.7071067811865475*bmag[1]*vmap[1]*vmap[3]*f[25]+0.7071067811865475*vmap[1]*vmap[3]*bmag[7]*f[24]+0.7071067811865475*vmap[1]*bmag[3]*vmap[3]*f[23]+0.7071067811865475*vmap[0]*vmap[3]*bmag[4]*f[22]+0.7071067811865475*bmag[0]*vmap[0]*vmap[3]*f[21]+0.7071067811865475*vmap[0]*vmap[3]*bmag[6]*f[20]+0.7071067811865475*vmap[1]*vmap[2]*bmag[4]*f[19]+0.7071067811865475*bmag[0]*vmap[1]*vmap[2]*f[18]+0.7071067811865475*vmap[1]*vmap[2]*bmag[6]*f[17]+0.7071067811865475*vmap[0]*bmag[2]*vmap[2]*f[16]+0.7071067811865475*vmap[1]*vmap[3]*bmag[5]*f[15]+0.7071067811865475*vmap[0]*bmag[1]*vmap[3]*f[14]+0.7071067811865475*vmap[0]*vmap[3]*bmag[7]*f[13]+0.7071067811865475*vmap[0]*bmag[3]*vmap[3]*f[12]+0.7071067811865475*bmag[1]*vmap[1]*vmap[2]*f[11]+0.7071067811865475*vmap[1]*vmap[2]*bmag[7]*f[10]+0.7071067811865475*vmap[1]*vmap[2]*bmag[3]*f[9]+0.7071067811865475*vmap[0]*vmap[2]*bmag[4]*f[8]+0.7071067811865475*bmag[0]*vmap[0]*vmap[2]*f[7]+0.7071067811865475*vmap[0]*f[2]*vmap[2]*bmag[7]+0.7071067811865475*vmap[0]*vmap[2]*bmag[6]*f[6]+0.7071067811865475*vmap[0]*vmap[3]*bmag[5]*f[5]+0.7071067811865475*vmap[1]*vmap[2]*f[4]*bmag[5]+0.7071067811865475*f[0]*vmap[0]*vmap[2]*bmag[5]+0.7071067811865475*vmap[0]*bmag[1]*vmap[2]*f[3]+0.7071067811865475*vmap[0]*f[1]*vmap[2]*bmag[3])*volFact)/m_; 
  out[6] += ((0.7071067811865475*bmag[1]*vmap[1]*vmap[3]*f[31]+0.7071067811865475*bmag[0]*vmap[1]*vmap[3]*f[30]+0.7071067811865475*vmap[1]*vmap[3]*bmag[4]*f[29]+0.7071067811865475*vmap[1]*vmap[3]*bmag[5]*f[28]+0.7071067811865475*vmap[0]*bmag[1]*vmap[3]*f[27]+0.7071067811865475*bmag[1]*vmap[1]*vmap[2]*f[26]+0.7071067811865475*vmap[1]*bmag[2]*vmap[3]*f[25]+0.7071067811865475*vmap[1]*bmag[3]*vmap[3]*f[24]+0.7071067811865475*vmap[1]*vmap[3]*bmag[7]*f[23]+0.7071067811865475*bmag[0]*vmap[0]*vmap[3]*f[22]+0.7071067811865475*vmap[0]*vmap[3]*bmag[4]*f[21]+0.7071067811865475*vmap[0]*vmap[3]*bmag[5]*f[20]+0.7071067811865475*bmag[0]*vmap[1]*vmap[2]*f[19]+0.7071067811865475*vmap[1]*vmap[2]*bmag[4]*f[18]+0.7071067811865475*vmap[1]*vmap[2]*bmag[5]*f[17]+0.7071067811865475*vmap[0]*bmag[1]*vmap[2]*f[16]+0.7071067811865475*vmap[1]*vmap[3]*bmag[6]*f[15]+0.7071067811865475*vmap[0]*bmag[2]*vmap[3]*f[14]+0.7071067811865475*vmap[0]*bmag[3]*vmap[3]*f[13]+0.7071067811865475*vmap[0]*vmap[3]*bmag[7]*f[12]+0.7071067811865475*vmap[1]*bmag[2]*vmap[2]*f[11]+0.7071067811865475*vmap[1]*vmap[2]*bmag[3]*f[10]+0.7071067811865475*vmap[1]*vmap[2]*bmag[7]*f[9]+0.7071067811865475*bmag[0]*vmap[0]*vmap[2]*f[8]+0.7071067811865475*vmap[0]*vmap[2]*bmag[4]*f[7]+0.7071067811865475*vmap[0]*f[1]*vmap[2]*bmag[7]+0.7071067811865475*vmap[0]*vmap[2]*bmag[5]*f[6]+0.7071067811865475*vmap[0]*vmap[3]*f[5]*bmag[6]+0.7071067811865475*vmap[1]*vmap[2]*f[4]*bmag[6]+0.7071067811865475*f[0]*vmap[0]*vmap[2]*bmag[6]+0.7071067811865475*vmap[0]*bmag[2]*vmap[2]*f[3]+0.7071067811865475*vmap[0]*f[2]*vmap[2]*bmag[3])*volFact)/m_; 
  out[7] += ((0.7071067811865475*bmag[0]*vmap[1]*vmap[3]*f[31]+0.7071067811865475*bmag[1]*vmap[1]*vmap[3]*f[30]+0.7071067811865475*vmap[1]*bmag[2]*vmap[3]*f[29]+0.7071067811865475*vmap[1]*bmag[3]*vmap[3]*f[28]+0.7071067811865475*bmag[0]*vmap[0]*vmap[3]*f[27]+0.7071067811865475*bmag[0]*vmap[1]*vmap[2]*f[26]+0.7071067811865475*vmap[1]*vmap[3]*bmag[4]*f[25]+0.7071067811865475*vmap[1]*vmap[3]*bmag[5]*f[24]+0.7071067811865475*vmap[1]*vmap[3]*bmag[6]*f[23]+0.7071067811865475*vmap[0]*bmag[1]*vmap[3]*f[22]+0.7071067811865475*vmap[0]*bmag[2]*vmap[3]*f[21]+0.7071067811865475*vmap[0]*bmag[3]*vmap[3]*f[20]+0.7071067811865475*bmag[1]*vmap[1]*vmap[2]*f[19]+0.7071067811865475*vmap[1]*bmag[2]*vmap[2]*f[18]+0.7071067811865475*vmap[1]*vmap[2]*bmag[3]*f[17]+0.7071067811865475*bmag[0]*vmap[0]*vmap[2]*f[16]+0.7071067811865475*vmap[1]*vmap[3]*bmag[7]*f[15]+0.7071067811865475*vmap[0]*vmap[3]*bmag[4]*f[14]+0.7071067811865475*vmap[0]*vmap[3]*bmag[5]*f[13]+0.7071067811865475*vmap[0]*vmap[3]*bmag[6]*f[12]+0.7071067811865475*vmap[1]*vmap[2]*bmag[4]*f[11]+0.7071067811865475*vmap[1]*vmap[2]*bmag[5]*f[10]+0.7071067811865475*vmap[1]*vmap[2]*bmag[6]*f[9]+0.7071067811865475*vmap[0]*bmag[1]*vmap[2]*f[8]+0.7071067811865475*vmap[0]*bmag[2]*vmap[2]*f[7]+0.7071067811865475*vmap[0]*vmap[3]*f[5]*bmag[7]+0.7071067811865475*vmap[1]*vmap[2]*f[4]*bmag[7]+0.7071067811865475*f[0]*vmap[0]*vmap[2]*bmag[7]+0.7071067811865475*vmap[0]*vmap[2]*bmag[3]*f[6]+0.7071067811865475*vmap[0]*f[1]*vmap[2]*bmag[6]+0.7071067811865475*vmap[0]*f[2]*vmap[2]*bmag[5]+0.7071067811865475*vmap[0]*vmap[2]*f[3]*bmag[4])*volFact)/m_; 
} 

GKYL_CU_DH void gyrokinetic_three_moments_3x2v_ser_p1(const double *dxv, const double *vmap, double m_, const double *bmag, const double *f, double* GKYL_RESTRICT out) 
{ 
  const double volFact = 1.5707963267948966*dxv[3]*dxv[4]/m_; 
  double tmp[8]; 
  tmp[0] = 1.4142135623730951*vmap[3]*f[5]+1.4142135623730951*f[0]*vmap[2]; 
  tmp[1] = 1.4142135623730951*vmap[3]*f[12]+1.4142135623730951*f[1]*vmap[2]; 
  tmp[2] = 1.4142135623730951*vmap[3]*f[13]+1.4142135623730951*f[2]*vmap[2]; 
  tmp[3] = 1.4142135623730951*vmap[3]*f[14]+1.4142135623730951*vmap[2]*f[3]; 
  tmp[4] = 1.4142135623730951*vmap[3]*f[20]+1.4142135623730951*vmap[2]*f[6]; 
  tmp[5] = 1.4142135623730951*vmap[3]*f[21]+1.4142135623730951*vmap[2]*f[7]; 
  tmp[6] = 1.4142135623730951*vmap[3]*f[22]+1.4142135623730951*vmap[2]*f[8]; 
  tmp[7] = 1.4142135623730951*vmap[3]*f[27]+1.4142135623730951*vmap[2]*f[16]; 
  const double vmap0R2 = pow(vmap[0],2);
  const double vmap1R2 = pow(vmap[1],2);

  out[0] += 2.0*f[0]*volFact; 
  out[1] += 2.0*f[1]*volFact; 
  out[2] += 2.0*f[2]*volFact; 
  out[3] += 2.0*f[3]*volFact; 
  out[4] += 2.0*f[6]*volFact; 
  out[5] += 2.0*f[7]*volFact; 
  out[6] += 2.0*f[8]*volFact; 
  out[7] += 2.0*f[16]*volFact; 
  out[8] += (1.4142135623730951*vmap[1]*f[4]+1.4142135623730951*f[0]*vmap[0])*volFact; 
  out[9] += (1.4142135623730951*vmap[1]*f[9]+1.4142135623730951*vmap[0]*f[1])*volFact; 
  out[10] += (1.4142135623730951*vmap[1]*f[10]+1.4142135623730951*vmap[0]*f[2])*volFact; 
  out[11] += (1.4142135623730951*vmap[1]*f[11]+1.4142135623730951*vmap[0]*f[3])*volFact; 
  out[12] += (1.4142135623730951*vmap[1]*f[17]+1.4142135623730951*vmap[0]*f[6])*volFact; 
  out[13] += (1.4142135623730951*vmap[1]*f[18]+1.4142135623730951*vmap[0]*f[7])*volFact; 
  out[14] += (1.4142135623730951*vmap[1]*f[19]+1.4142135623730951*vmap[0]*f[8])*volFact; 
  out[15] += (1.4142135623730951*vmap[1]*f[26]+1.4142135623730951*vmap[0]*f[16])*volFact; 
  out[16] += ((0.7071067811865475*bmag[7]*tmp[7]+0.7071067811865475*bmag[6]*tmp[6]+0.7071067811865475*bmag[5]*tmp[5]+0.7071067811865475*bmag[4]*tmp[4]+0.7071067811865475*bmag[3]*tmp[3]+0.7071067811865475*bmag[2]*tmp[2]+0.7071067811865475*bmag[1]*tmp[1]+0.7071067811865475*bmag[0]*tmp[0])*volFact)/m_+(0.8944271909999159*vmap1R2*f[32]+2.0*vmap[0]*vmap[1]*f[4]+f[0]*vmap1R2+f[0]*vmap0R2)*volFact; 
  out[17] += ((0.7071067811865475*bmag[6]*tmp[7]+0.7071067811865475*tmp[6]*bmag[7]+0.7071067811865475*bmag[3]*tmp[5]+0.7071067811865475*tmp[3]*bmag[5]+0.7071067811865475*bmag[2]*tmp[4]+0.7071067811865475*tmp[2]*bmag[4]+0.7071067811865475*bmag[0]*tmp[1]+0.7071067811865475*tmp[0]*bmag[1])*volFact)/m_+(0.8944271909999161*vmap1R2*f[33]+2.0*vmap[0]*vmap[1]*f[9]+f[1]*vmap1R2+vmap0R2*f[1])*volFact; 
  out[18] += ((0.7071067811865475*bmag[5]*tmp[7]+0.7071067811865475*tmp[5]*bmag[7]+0.7071067811865475*bmag[3]*tmp[6]+0.7071067811865475*tmp[3]*bmag[6]+0.7071067811865475*bmag[1]*tmp[4]+0.7071067811865475*tmp[1]*bmag[4]+0.7071067811865475*bmag[0]*tmp[2]+0.7071067811865475*tmp[0]*bmag[2])*volFact)/m_+(0.8944271909999161*vmap1R2*f[34]+2.0*vmap[0]*vmap[1]*f[10]+vmap1R2*f[2]+vmap0R2*f[2])*volFact; 
  out[19] += ((0.7071067811865475*bmag[4]*tmp[7]+0.7071067811865475*tmp[4]*bmag[7]+0.7071067811865475*bmag[2]*tmp[6]+0.7071067811865475*tmp[2]*bmag[6]+0.7071067811865475*bmag[1]*tmp[5]+0.7071067811865475*tmp[1]*bmag[5]+0.7071067811865475*bmag[0]*tmp[3]+0.7071067811865475*tmp[0]*bmag[3])*volFact)/m_+(0.8944271909999161*vmap1R2*f[35]+2.0*vmap[0]*vmap[1]*f[11]+vmap1R2*f[3]+vmap0R2*f[3])*volFact; 
  out[20] += ((0.7071067811865475*bmag[3]*tmp[7]+0.7071067811865475*tmp[3]*bmag[7]+0.7071067811865475*bmag[5]*tmp[6]+0.7071067811865475*tmp[5]*bmag[6]+0.7071067811865475*bmag[0]*tmp[4]+0.7071067811865475*tmp[0]*bmag[4]+0.7071067811865475*bmag[1]*tmp[2]+0.7071067811865475*tmp[1]*bmag[2])*volFact)/m_+(0.8944271909999159*vmap1R2*f[37]+2.0*vmap[0]*vmap[1]*f[17]+vmap1R2*f[6]+vmap0R2*f[6])*volFact; 
  out[21] += ((0.7071067811865475*bmag[2]*tmp[7]+0.7071067811865475*tmp[2]*bmag[7]+0.7071067811865475*bmag[4]*tmp[6]+0.7071067811865475*tmp[4]*bmag[6]+0.7071067811865475*bmag[0]*tmp[5]+0.7071067811865475*tmp[0]*bmag[5]+0.7071067811865475*bmag[1]*tmp[3]+0.7071067811865475*tmp[1]*bmag[3])*volFact)/m_+(0.8944271909999159*vmap1R2*f[38]+2.0*vmap[0]*vmap[1]*f[18]+vmap1R2*f[7]+vmap0R2*f[7])*volFact; 
  out[22] += ((0.7071067811865475*bmag[1]*tmp[7]+0.7071067811865475*tmp[1]*bmag[7]+0.7071067811865475*bmag[0]*tmp[6]+0.7071067811865475*tmp[0]*bmag[6]+0.7071067811865475*bmag[4]*tmp[5]+0.7071067811865475*tmp[4]*bmag[5]+0.7071067811865475*bmag[2]*tmp[3]+0.7071067811865475*tmp[2]*bmag[3])*volFact)/m_+(0.8944271909999159*vmap1R2*f[39]+2.0*vmap[0]*vmap[1]*f[19]+vmap1R2*f[8]+vmap0R2*f[8])*volFact; 
  out[23] += ((0.7071067811865475*bmag[0]*tmp[7]+0.7071067811865475*tmp[0]*bmag[7]+0.7071067811865475*bmag[1]*tmp[6]+0.7071067811865475*tmp[1]*bmag[6]+0.7071067811865475*bmag[2]*tmp[5]+0.7071067811865475*tmp[2]*bmag[5]+0.7071067811865475*bmag[3]*tmp[4]+0.7071067811865475*tmp[3]*bmag[4])*volFact)/m_+(0.8944271909999161*vmap1R2*f[43]+2.0*vmap[0]*vmap[1]*f[26]+vmap1R2*f[16]+vmap0R2*f[16])*volFact; 
} 

GKYL_CU_DH void gyrokinetic_four_moments_3x2v_ser_p1(const double *dxv, const double *vmap, double m_, const double *bmag, const double *f, double* GKYL_RESTRICT out) 
{ 
  const double volFact = 1.5707963267948966*dxv[3]*dxv[4]/m_; 
  double tmp[8]; 
  tmp[0] = 1.4142135623730951*vmap[3]*f[5]+1.4142135623730951*f[0]*vmap[2]; 
  tmp[1] = 1.4142135623730951*vmap[3]*f[12]+1.4142135623730951*f[1]*vmap[2]; 
  tmp[2] = 1.4142135623730951*vmap[3]*f[13]+1.4142135623730951*f[2]*vmap[2]; 
  tmp[3] = 1.4142135623730951*vmap[3]*f[14]+1.4142135623730951*vmap[2]*f[3]; 
  tmp[4] = 1.4142135623730951*vmap[3]*f[20]+1.4142135623730951*vmap[2]*f[6]; 
  tmp[5] = 1.4142135623730951*vmap[3]*f[21]+1.4142135623730951*vmap[2]*f[7]; 
  tmp[6] = 1.4142135623730951*vmap[3]*f[22]+1.4142135623730951*vmap[2]*f[8]; 
  tmp[7] = 1.4142135623730951*vmap[3]*f[27]+1.4142135623730951*vmap[2]*f[16]; 
  const double vmap0R2 = pow(vmap[0],2);
  const double vmap1R2 = pow(vmap[1],2);

  out[0] += 2.0*f[0]*volFact; 
  out[1] += 2.0*f[1]*volFact; 
  out[2] += 2.0*f[2]*volFact; 
  out[3] += 2.0*f[3]*volFact; 
  out[4] += 2.0*f[6]*volFact; 
  out[5] += 2.0*f[7]*volFact; 
  out[6] += 2.0*f[8]*volFact; 
  out[7] += 2.0*f[16]*volFact; 
  out[8] += (1.4142135623730951*vmap[1]*f[4]+1.4142135623730951*f[0]*vmap[0])*volFact; 
  out[9] += (1.4142135623730951*vmap[1]*f[9]+1.4142135623730951*vmap[0]*f[1])*volFact; 
  out[10] += (1.4142135623730951*vmap[1]*f[10]+1.4142135623730951*vmap[0]*f[2])*volFact; 
  out[11] += (1.4142135623730951*vmap[1]*f[11]+1.4142135623730951*vmap[0]*f[3])*volFact; 
  out[12] += (1.4142135623730951*vmap[1]*f[17]+1.4142135623730951*vmap[0]*f[6])*volFact; 
  out[13] += (1.4142135623730951*vmap[1]*f[18]+1.4142135623730951*vmap[0]*f[7])*volFact; 
  out[14] += (1.4142135623730951*vmap[1]*f[19]+1.4142135623730951*vmap[0]*f[8])*volFact; 
  out[15] += (1.4142135623730951*vmap[1]*f[26]+1.4142135623730951*vmap[0]*f[16])*volFact; 
  out[16] += (0.8944271909999159*vmap1R2*f[32]+2.0*vmap[0]*vmap[1]*f[4]+f[0]*vmap1R2+f[0]*vmap0R2)*volFact; 
  out[17] += (0.8944271909999161*vmap1R2*f[33]+2.0*vmap[0]*vmap[1]*f[9]+f[1]*vmap1R2+vmap0R2*f[1])*volFact; 
  out[18] += (0.8944271909999161*vmap1R2*f[34]+2.0*vmap[0]*vmap[1]*f[10]+vmap1R2*f[2]+vmap0R2*f[2])*volFact; 
  out[19] += (0.8944271909999161*vmap1R2*f[35]+2.0*vmap[0]*vmap[1]*f[11]+vmap1R2*f[3]+vmap0R2*f[3])*volFact; 
  out[20] += (0.8944271909999159*vmap1R2*f[37]+2.0*vmap[0]*vmap[1]*f[17]+vmap1R2*f[6]+vmap0R2*f[6])*volFact; 
  out[21] += (0.8944271909999159*vmap1R2*f[38]+2.0*vmap[0]*vmap[1]*f[18]+vmap1R2*f[7]+vmap0R2*f[7])*volFact; 
  out[22] += (0.8944271909999159*vmap1R2*f[39]+2.0*vmap[0]*vmap[1]*f[19]+vmap1R2*f[8]+vmap0R2*f[8])*volFact; 
  out[23] += (0.8944271909999161*vmap1R2*f[43]+2.0*vmap[0]*vmap[1]*f[26]+vmap1R2*f[16]+vmap0R2*f[16])*volFact; 
  out[24] += ((0.7071067811865475*bmag[7]*tmp[7]+0.7071067811865475*bmag[6]*tmp[6]+0.7071067811865475*bmag[5]*tmp[5]+0.7071067811865475*bmag[4]*tmp[4]+0.7071067811865475*bmag[3]*tmp[3]+0.7071067811865475*bmag[2]*tmp[2]+0.7071067811865475*bmag[1]*tmp[1]+0.7071067811865475*bmag[0]*tmp[0])*volFact)/m_; 
  out[25] += ((0.7071067811865475*bmag[6]*tmp[7]+0.7071067811865475*tmp[6]*bmag[7]+0.7071067811865475*bmag[3]*tmp[5]+0.7071067811865475*tmp[3]*bmag[5]+0.7071067811865475*bmag[2]*tmp[4]+0.7071067811865475*tmp[2]*bmag[4]+0.7071067811865475*bmag[0]*tmp[1]+0.7071067811865475*tmp[0]*bmag[1])*volFact)/m_; 
  out[26] += ((0.7071067811865475*bmag[5]*tmp[7]+0.7071067811865475*tmp[5]*bmag[7]+0.7071067811865475*bmag[3]*tmp[6]+0.7071067811865475*tmp[3]*bmag[6]+0.7071067811865475*bmag[1]*tmp[4]+0.7071067811865475*tmp[1]*bmag[4]+0.7071067811865475*bmag[0]*tmp[2]+0.7071067811865475*tmp[0]*bmag[2])*volFact)/m_; 
  out[27] += ((0.7071067811865475*bmag[4]*tmp[7]+0.7071067811865475*tmp[4]*bmag[7]+0.7071067811865475*bmag[2]*tmp[6]+0.7071067811865475*tmp[2]*bmag[6]+0.7071067811865475*bmag[1]*tmp[5]+0.7071067811865475*tmp[1]*bmag[5]+0.7071067811865475*bmag[0]*tmp[3]+0.7071067811865475*tmp[0]*bmag[3])*volFact)/m_; 
  out[28] += ((0.7071067811865475*bmag[3]*tmp[7]+0.7071067811865475*tmp[3]*bmag[7]+0.7071067811865475*bmag[5]*tmp[6]+0.7071067811865475*tmp[5]*bmag[6]+0.7071067811865475*bmag[0]*tmp[4]+0.7071067811865475*tmp[0]*bmag[4]+0.7071067811865475*bmag[1]*tmp[2]+0.7071067811865475*tmp[1]*bmag[2])*volFact)/m_; 
  out[29] += ((0.7071067811865475*bmag[2]*tmp[7]+0.7071067811865475*tmp[2]*bmag[7]+0.7071067811865475*bmag[4]*tmp[6]+0.7071067811865475*tmp[4]*bmag[6]+0.7071067811865475*bmag[0]*tmp[5]+0.7071067811865475*tmp[0]*bmag[5]+0.7071067811865475*bmag[1]*tmp[3]+0.7071067811865475*tmp[1]*bmag[3])*volFact)/m_; 
  out[30] += ((0.7071067811865475*bmag[1]*tmp[7]+0.7071067811865475*tmp[1]*bmag[7]+0.7071067811865475*bmag[0]*tmp[6]+0.7071067811865475*tmp[0]*bmag[6]+0.7071067811865475*bmag[4]*tmp[5]+0.7071067811865475*tmp[4]*bmag[5]+0.7071067811865475*bmag[2]*tmp[3]+0.7071067811865475*tmp[2]*bmag[3])*volFact)/m_; 
  out[31] += ((0.7071067811865475*bmag[0]*tmp[7]+0.7071067811865475*tmp[0]*bmag[7]+0.7071067811865475*bmag[1]*tmp[6]+0.7071067811865475*tmp[1]*bmag[6]+0.7071067811865475*bmag[2]*tmp[5]+0.7071067811865475*tmp[2]*bmag[5]+0.7071067811865475*bmag[3]*tmp[4]+0.7071067811865475*tmp[3]*bmag[4])*volFact)/m_; 
} 

GKYL_CU_DH void gyrokinetic_M0_step1_3x2v_ser_p1(const double *dxv, const double *vmap, double m_, const double *bmag, const double *f, double* GKYL_RESTRICT out) 
{ 
  const double volFact = dxv[3]/2; 
  out[0] += 1.4142135623730951*f[0]*volFact; 
  out[1] += 1.4142135623730951*f[1]*volFact; 
  out[2] += 1.4142135623730951*f[2]*volFact; 
  out[3] += 1.4142135623730951*f[3]*volFact; 
  out[4] += 1.4142135623730951*f[5]*volFact; 
  out[5] += 1.4142135623730951*f[6]*volFact; 
  out[6] += 1.4142135623730951*f[7]*volFact; 
  out[7] += 1.4142135623730951*f[8]*volFact; 
  out[8] += 1.4142135623730951*f[12]*volFact; 
  out[9] += 1.4142135623730951*f[13]*volFact; 
  out[10] += 1.4142135623730951*f[14]*volFact; 
  out[11] += 1.4142135623730951*f[16]*volFact; 
  out[12] += 1.4142135623730951*f[20]*volFact; 
  out[13] += 1.4142135623730951*f[21]*volFact; 
  out[14] += 1.4142135623730951*f[22]*volFact; 
  out[15] += 1.4142135623730951*f[27]*volFact; 
} 

GKYL_CU_DH void gyrokinetic_M0_step2_3x2v_ser_p1(const double *dxv, const double *vmap, double m_, const double *bmag, const double *f, double* GKYL_RESTRICT out) 
{ 
  const double volFact = 3.141592653589793*dxv[4]/m_; 
  out[0] += 2.8284271247461907*f[0]*volFact; 
  out[1] += 2.8284271247461907*f[1]*volFact; 
  out[2] += 2.8284271247461907*f[2]*volFact; 
  out[3] += 2.8284271247461907*f[3]*volFact; 
  out[4] += 2.8284271247461907*f[5]*volFact; 
  out[5] += 2.8284271247461907*f[6]*volFact; 
  out[6] += 2.8284271247461907*f[7]*volFact; 
  out[7] += 2.8284271247461907*f[11]*volFact; 
} 

GKYL_CU_DH void gyrokinetic_hamiltonian_moments_3x2v_ser_p1(const double *dxv, const double *vmap, double m_, double q_, const double *bmag, const double *phi, const double *f, double* GKYL_RESTRICT out) 
{ 
  const double volFact = 1.5707963267948966*dxv[3]*dxv[4]/m_; 
  double tmp[8]; 
  tmp[0] = 1.4142135623730951*vmap[3]*f[5]+1.4142135623730951*f[0]*vmap[2]; 
  tmp[1] = 1.4142135623730951*vmap[3]*f[12]+1.4142135623730951*f[1]*vmap[2]; 
  tmp[2] = 1.4142135623730951*vmap[3]*f[13]+1.4142135623730951*f[2]*vmap[2]; 
  tmp[3] = 1.4142135623730951*vmap[3]*f[14]+1.4142135623730951*vmap[2]*f[3]; 
  tmp[4] = 1.4142135623730951*vmap[3]*f[20]+1.4142135623730951*vmap[2]*f[6]; 
  tmp[5] = 1.4142135623730951*vmap[3]*f[21]+1.4142135623730951*vmap[2]*f[7]; 
  tmp[6] = 1.4142135623730951*vmap[3]*f[22]+1.4142135623730951*vmap[2]*f[8]; 
  tmp[7] = 1.4142135623730951*vmap[3]*f[27]+1.4142135623730951*vmap[2]*f[16]; 
  const double vmap0R2 = pow(vmap[0],2);
  const double vmap1R2 = pow(vmap[1],2);

  out[0] += 2.0*f[0]*volFact; 
  out[1] += 2.0*f[1]*volFact; 
  out[2] += 2.0*f[2]*volFact; 
  out[3] += 2.0*f[3]*volFact; 
  out[4] += 2.0*f[6]*volFact; 
  out[5] += 2.0*f[7]*volFact; 
  out[6] += 2.0*f[8]*volFact; 
  out[7] += 2.0*f[16]*volFact; 
  out[8] += (1.4142135623730951*vmap[1]*f[4]+1.4142135623730951*f[0]*vmap[0])*m_*volFact; 
  out[9] += (1.4142135623730951*vmap[1]*f[9]+1.4142135623730951*vmap[0]*f[1])*m_*volFact; 
  out[10] += (1.4142135623730951*vmap[1]*f[10]+1.4142135623730951*vmap[0]*f[2])*m_*volFact; 
  out[11] += (1.4142135623730951*vmap[1]*f[11]+1.4142135623730951*vmap[0]*f[3])*m_*volFact; 
  out[12] += (1.4142135623730951*vmap[1]*f[17]+1.4142135623730951*vmap[0]*f[6])*m_*volFact; 
  out[13] += (1.4142135623730951*vmap[1]*f[18]+1.4142135623730951*vmap[0]*f[7])*m_*volFact; 
  out[14] += (1.4142135623730951*vmap[1]*f[19]+1.4142135623730951*vmap[0]*f[8])*m_*volFact; 
  out[15] += (1.4142135623730951*vmap[1]*f[26]+1.4142135623730951*vmap[0]*f[16])*m_*volFact; 
  out[16] += (0.7071067811865475*phi[7]*f[16]+0.7071067811865475*phi[6]*f[8]+0.7071067811865475*phi[5]*f[7]+0.7071067811865475*phi[4]*f[6]+0.7071067811865475*f[3]*phi[3]+0.7071067811865475*f[2]*phi[2]+0.7071067811865475*f[1]*phi[1]+0.7071067811865475*f[0]*phi[0])*q_*volFact+(0.4472135954999579*vmap1R2*f[32]+vmap[0]*vmap[1]*f[4]+0.5*f[0]*vmap1R2+0.5*f[0]*vmap0R2)*m_*volFact+(0.3535533905932737*bmag[7]*tmp[7]+0.3535533905932737*bmag[6]*tmp[6]+0.3535533905932737*bmag[5]*tmp[5]+0.3535533905932737*bmag[4]*tmp[4]+0.3535533905932737*bmag[3]*tmp[3]+0.3535533905932737*bmag[2]*tmp[2]+0.3535533905932737*bmag[1]*tmp[1]+0.3535533905932737*bmag[0]*tmp[0])*volFact; 
  out[17] += (0.7071067811865475*phi[6]*f[16]+0.7071067811865475*phi[7]*f[8]+0.7071067811865475*phi[3]*f[7]+0.7071067811865475*phi[2]*f[6]+0.7071067811865475*f[3]*phi[5]+0.7071067811865475*f[2]*phi[4]+0.7071067811865475*f[0]*phi[1]+0.7071067811865475*phi[0]*f[1])*q_*volFact+(0.44721359549995804*vmap1R2*f[33]+vmap[0]*vmap[1]*f[9]+0.5*f[1]*vmap1R2+0.5*vmap0R2*f[1])*m_*volFact+(0.3535533905932737*bmag[6]*tmp[7]+0.3535533905932737*tmp[6]*bmag[7]+0.3535533905932737*bmag[3]*tmp[5]+0.3535533905932737*tmp[3]*bmag[5]+0.3535533905932737*bmag[2]*tmp[4]+0.3535533905932737*tmp[2]*bmag[4]+0.3535533905932737*bmag[0]*tmp[1]+0.3535533905932737*tmp[0]*bmag[1])*volFact; 
  out[18] += (0.7071067811865475*phi[5]*f[16]+0.7071067811865475*phi[3]*f[8]+0.7071067811865475*f[7]*phi[7]+0.7071067811865475*f[3]*phi[6]+0.7071067811865475*phi[1]*f[6]+0.7071067811865475*f[1]*phi[4]+0.7071067811865475*f[0]*phi[2]+0.7071067811865475*phi[0]*f[2])*q_*volFact+(0.44721359549995804*vmap1R2*f[34]+vmap[0]*vmap[1]*f[10]+0.5*vmap1R2*f[2]+0.5*vmap0R2*f[2])*m_*volFact+(0.3535533905932737*bmag[5]*tmp[7]+0.3535533905932737*tmp[5]*bmag[7]+0.3535533905932737*bmag[3]*tmp[6]+0.3535533905932737*tmp[3]*bmag[6]+0.3535533905932737*bmag[1]*tmp[4]+0.3535533905932737*tmp[1]*bmag[4]+0.3535533905932737*bmag[0]*tmp[2]+0.3535533905932737*tmp[0]*bmag[2])*volFact; 
  out[19] += (0.7071067811865475*phi[4]*f[16]+0.7071067811865475*phi[2]*f[8]+0.7071067811865475*f[6]*phi[7]+0.7071067811865475*phi[1]*f[7]+0.7071067811865475*f[2]*phi[6]+0.7071067811865475*f[1]*phi[5]+0.7071067811865475*f[0]*phi[3]+0.7071067811865475*phi[0]*f[3])*q_*volFact+(0.44721359549995804*vmap1R2*f[35]+vmap[0]*vmap[1]*f[11]+0.5*vmap1R2*f[3]+0.5*vmap0R2*f[3])*m_*volFact+(0.3535533905932737*bmag[4]*tmp[7]+0.3535533905932737*tmp[4]*bmag[7]+0.3535533905932737*bmag[2]*tmp[6]+0.3535533905932737*tmp[2]*bmag[6]+0.3535533905932737*bmag[1]*tmp[5]+0.3535533905932737*tmp[1]*bmag[5]+0.3535533905932737*bmag[0]*tmp[3]+0.3535533905932737*tmp[0]*bmag[3])*volFact; 
  out[20] += (0.7071067811865475*phi[3]*f[16]+0.7071067811865475*phi[5]*f[8]+0.7071067811865475*f[3]*phi[7]+0.7071067811865475*phi[6]*f[7]+0.7071067811865475*phi[0]*f[6]+0.7071067811865475*f[0]*phi[4]+0.7071067811865475*f[1]*phi[2]+0.7071067811865475*phi[1]*f[2])*q_*volFact+(0.4472135954999579*vmap1R2*f[37]+vmap[0]*vmap[1]*f[17]+0.5*vmap1R2*f[6]+0.5*vmap0R2*f[6])*m_*volFact+(0.3535533905932737*bmag[3]*tmp[7]+0.3535533905932737*tmp[3]*bmag[7]+0.3535533905932737*bmag[5]*tmp[6]+0.3535533905932737*tmp[5]*bmag[6]+0.3535533905932737*bmag[0]*tmp[4]+0.3535533905932737*tmp[0]*bmag[4]+0.3535533905932737*bmag[1]*tmp[2]+0.3535533905932737*tmp[1]*bmag[2])*volFact; 
  out[21] += (0.7071067811865475*phi[2]*f[16]+0.7071067811865475*phi[4]*f[8]+0.7071067811865475*f[2]*phi[7]+0.7071067811865475*phi[0]*f[7]+0.7071067811865475*f[6]*phi[6]+0.7071067811865475*f[0]*phi[5]+0.7071067811865475*f[1]*phi[3]+0.7071067811865475*phi[1]*f[3])*q_*volFact+(0.4472135954999579*vmap1R2*f[38]+vmap[0]*vmap[1]*f[18]+0.5*vmap1R2*f[7]+0.5*vmap0R2*f[7])*m_*volFact+(0.3535533905932737*bmag[2]*tmp[7]+0.3535533905932737*tmp[2]*bmag[7]+0.3535533905932737*bmag[4]*tmp[6]+0.3535533905932737*tmp[4]*bmag[6]+0.3535533905932737*bmag[0]*tmp[5]+0.3535533905932737*tmp[0]*bmag[5]+0.3535533905932737*bmag[1]*tmp[3]+0.3535533905932737*tmp[1]*bmag[3])*volFact; 
  out[22] += (0.7071067811865475*phi[1]*f[16]+0.7071067811865475*phi[0]*f[8]+0.7071067811865475*f[1]*phi[7]+0.7071067811865475*phi[4]*f[7]+0.7071067811865475*f[0]*phi[6]+0.7071067811865475*phi[5]*f[6]+0.7071067811865475*f[2]*phi[3]+0.7071067811865475*phi[2]*f[3])*q_*volFact+(0.4472135954999579*vmap1R2*f[39]+vmap[0]*vmap[1]*f[19]+0.5*vmap1R2*f[8]+0.5*vmap0R2*f[8])*m_*volFact+(0.3535533905932737*bmag[1]*tmp[7]+0.3535533905932737*tmp[1]*bmag[7]+0.3535533905932737*bmag[0]*tmp[6]+0.3535533905932737*tmp[0]*bmag[6]+0.3535533905932737*bmag[4]*tmp[5]+0.3535533905932737*tmp[4]*bmag[5]+0.3535533905932737*bmag[2]*tmp[3]+0.3535533905932737*tmp[2]*bmag[3])*volFact; 
  out[23] += (0.7071067811865475*phi[0]*f[16]+0.7071067811865475*phi[1]*f[8]+0.7071067811865475*f[0]*phi[7]+0.7071067811865475*phi[2]*f[7]+0.7071067811865475*f[1]*phi[6]+0.7071067811865475*phi[3]*f[6]+0.7071067811865475*f[2]*phi[5]+0.7071067811865475*f[3]*phi[4])*q_*volFact+(0.44721359549995804*vmap1R2*f[43]+vmap[0]*vmap[1]*f[26]+0.5*vmap1R2*f[16]+0.5*vmap0R2*f[16])*m_*volFact+(0.3535533905932737*bmag[0]*tmp[7]+0.3535533905932737*tmp[0]*bmag[7]+0.3535533905932737*bmag[1]*tmp[6]+0.3535533905932737*tmp[1]*bmag[6]+0.3535533905932737*bmag[2]*tmp[5]+0.3535533905932737*tmp[2]*bmag[5]+0.3535533905932737*bmag[3]*tmp[4]+0.3535533905932737*tmp[3]*bmag[4])*volFact; 
} 

