#include <gkyl_rad_gyrokinetic_kernels.h> 
GKYL_CU_DH double rad_gyrokinetic_boundary_surfvpar_2x2v_ser_p1(const double *w, const double *dxv, const double *vmap,
    const double *vmap_prime_edge, const double *vmap_prime_skin,
    const double *nvnu_edge, const double *nvnu_skin, const double *nvsqnu_edge, const double *nvsqnu_skin, 
    const int edge, const double *fedge, const double *fskin, double* GKYL_RESTRICT out) 
{ 
  // w[4]:     cell-center coordinates. 
  // dxv[4]:   cell spacing. 
  // vmap: velocity space mapping.
  // vmap_prime_edge,vmap_prime_skin: velocity space mapping derivative in edge and skin cells.
  // nvnu_edge: Surface expansion sum_s n_s*nu_s(v) in vparallel direction on the lower edges of the edge cell.
  // nvnu_skin: Surface expansion sum_s n_s*nu_s(v) in vparallel direction on the lower edges of the skin cell.
  // nvsqnu_edge: Surface expansion sum_s n_s*nu_s(v) in mu direction on the lower edges of the edge cell.
  // nvsqnu_skin: Surface expansion sum_s n_s*nu_s(v) in mu direction on the lower edges of the edge skin.
  // edge: determines if the update is for the left edge (-1) or right edge (+1).
  // fskin,fedge: distribution function in skin cell/last edge cell.
  // out: output increment in center cell.

  double rdv2 = 2.0/dxv[2]; 

  if (edge == -1) { 

  double Ghat_r[8] = {0.0}; 
  if (0.7071067811865475*vmap[0]>0) {

  Ghat_r[0] = (0.5590169943749476*nvnu_edge[7]*fedge[23]+0.5590169943749475*(nvnu_edge[6]*fedge[22]+nvnu_edge[5]*fedge[21]+nvnu_edge[4]*fedge[20])+0.5590169943749476*(nvnu_edge[3]*fedge[19]+nvnu_edge[2]*fedge[18]+nvnu_edge[1]*fedge[17])+0.5590169943749475*nvnu_edge[0]*fedge[16]-0.4330127018922193*(nvnu_edge[7]*fedge[15]+nvnu_edge[6]*fedge[14]+nvnu_edge[5]*fedge[13])+0.25*nvnu_edge[7]*fedge[12]-0.4330127018922193*(nvnu_edge[4]*fedge[11]+nvnu_edge[3]*fedge[10])+0.25*(nvnu_edge[6]*fedge[9]+nvnu_edge[5]*fedge[8])-0.4330127018922193*(nvnu_edge[2]*fedge[7]+nvnu_edge[1]*fedge[6])+0.25*(nvnu_edge[4]*fedge[5]+nvnu_edge[3]*fedge[4])-0.4330127018922193*nvnu_edge[0]*fedge[3]+0.25*(fedge[2]*nvnu_edge[2]+fedge[1]*nvnu_edge[1]+fedge[0]*nvnu_edge[0]))/vmap_prime_edge[0]; 
  Ghat_r[1] = (0.5590169943749476*nvnu_edge[6]*fedge[23]+0.5590169943749475*(nvnu_edge[7]*fedge[22]+nvnu_edge[3]*fedge[21]+nvnu_edge[2]*fedge[20])+0.5590169943749476*(nvnu_edge[5]*fedge[19]+nvnu_edge[4]*fedge[18]+nvnu_edge[0]*fedge[17])+0.5590169943749475*nvnu_edge[1]*fedge[16]-0.4330127018922193*(nvnu_edge[6]*fedge[15]+nvnu_edge[7]*fedge[14]+nvnu_edge[3]*fedge[13])+0.25*nvnu_edge[6]*fedge[12]-0.4330127018922193*(nvnu_edge[2]*fedge[11]+nvnu_edge[5]*fedge[10])+0.25*(nvnu_edge[7]*fedge[9]+nvnu_edge[3]*fedge[8])-0.4330127018922193*(nvnu_edge[4]*fedge[7]+nvnu_edge[0]*fedge[6])+0.25*(fedge[4]*nvnu_edge[5]+nvnu_edge[2]*fedge[5]+fedge[2]*nvnu_edge[4])-0.4330127018922193*nvnu_edge[1]*fedge[3]+0.25*(fedge[0]*nvnu_edge[1]+nvnu_edge[0]*fedge[1]))/vmap_prime_edge[0]; 
  Ghat_r[2] = (0.5590169943749476*nvnu_edge[5]*fedge[23]+0.5590169943749475*(nvnu_edge[3]*fedge[22]+nvnu_edge[7]*fedge[21]+nvnu_edge[1]*fedge[20])+0.5590169943749476*(nvnu_edge[6]*fedge[19]+nvnu_edge[0]*fedge[18]+nvnu_edge[4]*fedge[17])+0.5590169943749475*nvnu_edge[2]*fedge[16]-0.4330127018922193*(nvnu_edge[5]*fedge[15]+nvnu_edge[3]*fedge[14]+nvnu_edge[7]*fedge[13])+0.25*nvnu_edge[5]*fedge[12]-0.4330127018922193*(nvnu_edge[1]*fedge[11]+nvnu_edge[6]*fedge[10])+0.25*(nvnu_edge[3]*fedge[9]+nvnu_edge[7]*fedge[8])-0.4330127018922193*nvnu_edge[0]*fedge[7]+0.25*fedge[4]*nvnu_edge[6]-0.4330127018922193*nvnu_edge[4]*fedge[6]+0.25*(nvnu_edge[1]*fedge[5]+fedge[1]*nvnu_edge[4])-0.4330127018922193*nvnu_edge[2]*fedge[3]+0.25*(fedge[0]*nvnu_edge[2]+nvnu_edge[0]*fedge[2]))/vmap_prime_edge[0]; 
  Ghat_r[3] = (0.5590169943749476*nvnu_edge[4]*fedge[23]+0.5590169943749475*(nvnu_edge[2]*fedge[22]+nvnu_edge[1]*fedge[21]+nvnu_edge[7]*fedge[20])+0.5590169943749476*(nvnu_edge[0]*fedge[19]+nvnu_edge[6]*fedge[18]+nvnu_edge[5]*fedge[17])+0.5590169943749475*nvnu_edge[3]*fedge[16]-0.4330127018922193*(nvnu_edge[4]*fedge[15]+nvnu_edge[2]*fedge[14]+nvnu_edge[1]*fedge[13])+0.25*nvnu_edge[4]*fedge[12]-0.4330127018922193*(nvnu_edge[7]*fedge[11]+nvnu_edge[0]*fedge[10])+0.25*(nvnu_edge[2]*fedge[9]+nvnu_edge[1]*fedge[8]+fedge[5]*nvnu_edge[7])+nvnu_edge[6]*(0.25*fedge[2]-0.4330127018922193*fedge[7])-0.4330127018922193*nvnu_edge[5]*fedge[6]+0.25*(fedge[1]*nvnu_edge[5]+nvnu_edge[0]*fedge[4])+(0.25*fedge[0]-0.4330127018922193*fedge[3])*nvnu_edge[3])/vmap_prime_edge[0]; 
  Ghat_r[4] = (0.5590169943749476*nvnu_edge[3]*fedge[23]+0.5590169943749475*(nvnu_edge[5]*fedge[22]+nvnu_edge[6]*fedge[21]+nvnu_edge[0]*fedge[20])+0.5590169943749476*(nvnu_edge[7]*fedge[19]+nvnu_edge[1]*fedge[18]+nvnu_edge[2]*fedge[17])+0.5590169943749475*nvnu_edge[4]*fedge[16]-0.4330127018922193*(nvnu_edge[3]*fedge[15]+nvnu_edge[5]*fedge[14]+nvnu_edge[6]*fedge[13])+0.25*nvnu_edge[3]*fedge[12]-0.4330127018922193*(nvnu_edge[0]*fedge[11]+nvnu_edge[7]*fedge[10])+0.25*(nvnu_edge[5]*fedge[9]+nvnu_edge[6]*fedge[8]+fedge[4]*nvnu_edge[7])-0.4330127018922193*(nvnu_edge[1]*fedge[7]+nvnu_edge[2]*fedge[6])+0.25*nvnu_edge[0]*fedge[5]-0.4330127018922193*fedge[3]*nvnu_edge[4]+0.25*(fedge[0]*nvnu_edge[4]+fedge[1]*nvnu_edge[2]+nvnu_edge[1]*fedge[2]))/vmap_prime_edge[0]; 
  Ghat_r[5] = (0.5590169943749476*nvnu_edge[2]*fedge[23]+0.5590169943749475*(nvnu_edge[4]*fedge[22]+nvnu_edge[0]*fedge[21]+nvnu_edge[6]*fedge[20])+0.5590169943749476*(nvnu_edge[1]*fedge[19]+nvnu_edge[7]*fedge[18]+nvnu_edge[3]*fedge[17])+0.5590169943749475*nvnu_edge[5]*fedge[16]-0.4330127018922193*(nvnu_edge[2]*fedge[15]+nvnu_edge[4]*fedge[14]+nvnu_edge[0]*fedge[13])+0.25*nvnu_edge[2]*fedge[12]-0.4330127018922193*(nvnu_edge[6]*fedge[11]+nvnu_edge[1]*fedge[10])+0.25*(nvnu_edge[4]*fedge[9]+nvnu_edge[0]*fedge[8])-0.4330127018922193*fedge[7]*nvnu_edge[7]+0.25*(fedge[2]*nvnu_edge[7]+fedge[5]*nvnu_edge[6])-0.4330127018922193*(nvnu_edge[3]*fedge[6]+fedge[3]*nvnu_edge[5])+0.25*(fedge[0]*nvnu_edge[5]+nvnu_edge[1]*fedge[4]+fedge[1]*nvnu_edge[3]))/vmap_prime_edge[0]; 
  Ghat_r[6] = (0.5590169943749476*nvnu_edge[1]*fedge[23]+0.5590169943749475*(nvnu_edge[0]*fedge[22]+nvnu_edge[4]*fedge[21]+nvnu_edge[5]*fedge[20])+0.5590169943749476*(nvnu_edge[2]*fedge[19]+nvnu_edge[3]*fedge[18]+nvnu_edge[7]*fedge[17])+0.5590169943749475*nvnu_edge[6]*fedge[16]-0.4330127018922193*(nvnu_edge[1]*fedge[15]+nvnu_edge[0]*fedge[14]+nvnu_edge[4]*fedge[13])+0.25*nvnu_edge[1]*fedge[12]-0.4330127018922193*(nvnu_edge[5]*fedge[11]+nvnu_edge[2]*fedge[10])+0.25*(nvnu_edge[0]*fedge[9]+nvnu_edge[4]*fedge[8])+(0.25*fedge[1]-0.4330127018922193*fedge[6])*nvnu_edge[7]-0.4330127018922193*(nvnu_edge[3]*fedge[7]+fedge[3]*nvnu_edge[6])+0.25*(fedge[0]*nvnu_edge[6]+fedge[5]*nvnu_edge[5]+nvnu_edge[2]*fedge[4]+fedge[2]*nvnu_edge[3]))/vmap_prime_edge[0]; 
  Ghat_r[7] = (0.5590169943749476*nvnu_edge[0]*fedge[23]+0.5590169943749475*(nvnu_edge[1]*fedge[22]+nvnu_edge[2]*fedge[21]+nvnu_edge[3]*fedge[20])+0.5590169943749476*(nvnu_edge[4]*fedge[19]+nvnu_edge[5]*fedge[18]+nvnu_edge[6]*fedge[17])+0.5590169943749475*nvnu_edge[7]*fedge[16]-0.4330127018922193*(nvnu_edge[0]*fedge[15]+nvnu_edge[1]*fedge[14]+nvnu_edge[2]*fedge[13])+0.25*nvnu_edge[0]*fedge[12]-0.4330127018922193*(nvnu_edge[3]*fedge[11]+nvnu_edge[4]*fedge[10])+0.25*(nvnu_edge[1]*fedge[9]+nvnu_edge[2]*fedge[8])+(0.25*fedge[0]-0.4330127018922193*fedge[3])*nvnu_edge[7]-0.4330127018922193*(nvnu_edge[5]*fedge[7]+fedge[6]*nvnu_edge[6])+0.25*(fedge[1]*nvnu_edge[6]+fedge[2]*nvnu_edge[5]+nvnu_edge[3]*fedge[5]+fedge[4]*nvnu_edge[4]))/vmap_prime_edge[0]; 

  } else { 

  Ghat_r[0] = (0.5590169943749476*nvnu_edge[7]*fskin[23]+0.5590169943749475*(nvnu_edge[6]*fskin[22]+nvnu_edge[5]*fskin[21]+nvnu_edge[4]*fskin[20])+0.5590169943749476*(nvnu_edge[3]*fskin[19]+nvnu_edge[2]*fskin[18]+nvnu_edge[1]*fskin[17])+0.5590169943749475*nvnu_edge[0]*fskin[16]+0.4330127018922193*(nvnu_edge[7]*fskin[15]+nvnu_edge[6]*fskin[14]+nvnu_edge[5]*fskin[13])+0.25*nvnu_edge[7]*fskin[12]+0.4330127018922193*(nvnu_edge[4]*fskin[11]+nvnu_edge[3]*fskin[10])+0.25*(nvnu_edge[6]*fskin[9]+nvnu_edge[5]*fskin[8])+0.4330127018922193*(nvnu_edge[2]*fskin[7]+nvnu_edge[1]*fskin[6])+0.25*(nvnu_edge[4]*fskin[5]+nvnu_edge[3]*fskin[4])+0.4330127018922193*nvnu_edge[0]*fskin[3]+0.25*(fskin[2]*nvnu_edge[2]+fskin[1]*nvnu_edge[1]+fskin[0]*nvnu_edge[0]))/vmap_prime_skin[0]; 
  Ghat_r[1] = (0.5590169943749476*nvnu_edge[6]*fskin[23]+0.5590169943749475*(nvnu_edge[7]*fskin[22]+nvnu_edge[3]*fskin[21]+nvnu_edge[2]*fskin[20])+0.5590169943749476*(nvnu_edge[5]*fskin[19]+nvnu_edge[4]*fskin[18]+nvnu_edge[0]*fskin[17])+0.5590169943749475*nvnu_edge[1]*fskin[16]+0.4330127018922193*(nvnu_edge[6]*fskin[15]+nvnu_edge[7]*fskin[14]+nvnu_edge[3]*fskin[13])+0.25*nvnu_edge[6]*fskin[12]+0.4330127018922193*(nvnu_edge[2]*fskin[11]+nvnu_edge[5]*fskin[10])+0.25*(nvnu_edge[7]*fskin[9]+nvnu_edge[3]*fskin[8])+0.4330127018922193*(nvnu_edge[4]*fskin[7]+nvnu_edge[0]*fskin[6])+0.25*(fskin[4]*nvnu_edge[5]+nvnu_edge[2]*fskin[5]+fskin[2]*nvnu_edge[4])+0.4330127018922193*nvnu_edge[1]*fskin[3]+0.25*(fskin[0]*nvnu_edge[1]+nvnu_edge[0]*fskin[1]))/vmap_prime_skin[0]; 
  Ghat_r[2] = (0.5590169943749476*nvnu_edge[5]*fskin[23]+0.5590169943749475*(nvnu_edge[3]*fskin[22]+nvnu_edge[7]*fskin[21]+nvnu_edge[1]*fskin[20])+0.5590169943749476*(nvnu_edge[6]*fskin[19]+nvnu_edge[0]*fskin[18]+nvnu_edge[4]*fskin[17])+0.5590169943749475*nvnu_edge[2]*fskin[16]+0.4330127018922193*(nvnu_edge[5]*fskin[15]+nvnu_edge[3]*fskin[14]+nvnu_edge[7]*fskin[13])+0.25*nvnu_edge[5]*fskin[12]+0.4330127018922193*(nvnu_edge[1]*fskin[11]+nvnu_edge[6]*fskin[10])+0.25*(nvnu_edge[3]*fskin[9]+nvnu_edge[7]*fskin[8])+0.4330127018922193*nvnu_edge[0]*fskin[7]+0.25*fskin[4]*nvnu_edge[6]+0.4330127018922193*nvnu_edge[4]*fskin[6]+0.25*(nvnu_edge[1]*fskin[5]+fskin[1]*nvnu_edge[4])+0.4330127018922193*nvnu_edge[2]*fskin[3]+0.25*(fskin[0]*nvnu_edge[2]+nvnu_edge[0]*fskin[2]))/vmap_prime_skin[0]; 
  Ghat_r[3] = (0.5590169943749476*nvnu_edge[4]*fskin[23]+0.5590169943749475*(nvnu_edge[2]*fskin[22]+nvnu_edge[1]*fskin[21]+nvnu_edge[7]*fskin[20])+0.5590169943749476*(nvnu_edge[0]*fskin[19]+nvnu_edge[6]*fskin[18]+nvnu_edge[5]*fskin[17])+0.5590169943749475*nvnu_edge[3]*fskin[16]+0.4330127018922193*(nvnu_edge[4]*fskin[15]+nvnu_edge[2]*fskin[14]+nvnu_edge[1]*fskin[13])+0.25*nvnu_edge[4]*fskin[12]+0.4330127018922193*(nvnu_edge[7]*fskin[11]+nvnu_edge[0]*fskin[10])+0.25*(nvnu_edge[2]*fskin[9]+nvnu_edge[1]*fskin[8]+fskin[5]*nvnu_edge[7])+nvnu_edge[6]*(0.4330127018922193*fskin[7]+0.25*fskin[2])+0.4330127018922193*nvnu_edge[5]*fskin[6]+0.25*(fskin[1]*nvnu_edge[5]+nvnu_edge[0]*fskin[4])+(0.4330127018922193*fskin[3]+0.25*fskin[0])*nvnu_edge[3])/vmap_prime_skin[0]; 
  Ghat_r[4] = (0.5590169943749476*nvnu_edge[3]*fskin[23]+0.5590169943749475*(nvnu_edge[5]*fskin[22]+nvnu_edge[6]*fskin[21]+nvnu_edge[0]*fskin[20])+0.5590169943749476*(nvnu_edge[7]*fskin[19]+nvnu_edge[1]*fskin[18]+nvnu_edge[2]*fskin[17])+0.5590169943749475*nvnu_edge[4]*fskin[16]+0.4330127018922193*(nvnu_edge[3]*fskin[15]+nvnu_edge[5]*fskin[14]+nvnu_edge[6]*fskin[13])+0.25*nvnu_edge[3]*fskin[12]+0.4330127018922193*(nvnu_edge[0]*fskin[11]+nvnu_edge[7]*fskin[10])+0.25*(nvnu_edge[5]*fskin[9]+nvnu_edge[6]*fskin[8]+fskin[4]*nvnu_edge[7])+0.4330127018922193*(nvnu_edge[1]*fskin[7]+nvnu_edge[2]*fskin[6])+0.25*nvnu_edge[0]*fskin[5]+0.4330127018922193*fskin[3]*nvnu_edge[4]+0.25*(fskin[0]*nvnu_edge[4]+fskin[1]*nvnu_edge[2]+nvnu_edge[1]*fskin[2]))/vmap_prime_skin[0]; 
  Ghat_r[5] = (0.5590169943749476*nvnu_edge[2]*fskin[23]+0.5590169943749475*(nvnu_edge[4]*fskin[22]+nvnu_edge[0]*fskin[21]+nvnu_edge[6]*fskin[20])+0.5590169943749476*(nvnu_edge[1]*fskin[19]+nvnu_edge[7]*fskin[18]+nvnu_edge[3]*fskin[17])+0.5590169943749475*nvnu_edge[5]*fskin[16]+0.4330127018922193*(nvnu_edge[2]*fskin[15]+nvnu_edge[4]*fskin[14]+nvnu_edge[0]*fskin[13])+0.25*nvnu_edge[2]*fskin[12]+0.4330127018922193*(nvnu_edge[6]*fskin[11]+nvnu_edge[1]*fskin[10])+0.25*(nvnu_edge[4]*fskin[9]+nvnu_edge[0]*fskin[8])+0.4330127018922193*fskin[7]*nvnu_edge[7]+0.25*(fskin[2]*nvnu_edge[7]+fskin[5]*nvnu_edge[6])+0.4330127018922193*(nvnu_edge[3]*fskin[6]+fskin[3]*nvnu_edge[5])+0.25*(fskin[0]*nvnu_edge[5]+nvnu_edge[1]*fskin[4]+fskin[1]*nvnu_edge[3]))/vmap_prime_skin[0]; 
  Ghat_r[6] = (0.5590169943749476*nvnu_edge[1]*fskin[23]+0.5590169943749475*(nvnu_edge[0]*fskin[22]+nvnu_edge[4]*fskin[21]+nvnu_edge[5]*fskin[20])+0.5590169943749476*(nvnu_edge[2]*fskin[19]+nvnu_edge[3]*fskin[18]+nvnu_edge[7]*fskin[17])+0.5590169943749475*nvnu_edge[6]*fskin[16]+0.4330127018922193*(nvnu_edge[1]*fskin[15]+nvnu_edge[0]*fskin[14]+nvnu_edge[4]*fskin[13])+0.25*nvnu_edge[1]*fskin[12]+0.4330127018922193*(nvnu_edge[5]*fskin[11]+nvnu_edge[2]*fskin[10])+0.25*(nvnu_edge[0]*fskin[9]+nvnu_edge[4]*fskin[8])+(0.4330127018922193*fskin[6]+0.25*fskin[1])*nvnu_edge[7]+0.4330127018922193*(nvnu_edge[3]*fskin[7]+fskin[3]*nvnu_edge[6])+0.25*(fskin[0]*nvnu_edge[6]+fskin[5]*nvnu_edge[5]+nvnu_edge[2]*fskin[4]+fskin[2]*nvnu_edge[3]))/vmap_prime_skin[0]; 
  Ghat_r[7] = (0.5590169943749476*nvnu_edge[0]*fskin[23]+0.5590169943749475*(nvnu_edge[1]*fskin[22]+nvnu_edge[2]*fskin[21]+nvnu_edge[3]*fskin[20])+0.5590169943749476*(nvnu_edge[4]*fskin[19]+nvnu_edge[5]*fskin[18]+nvnu_edge[6]*fskin[17])+0.5590169943749475*nvnu_edge[7]*fskin[16]+0.4330127018922193*(nvnu_edge[0]*fskin[15]+nvnu_edge[1]*fskin[14]+nvnu_edge[2]*fskin[13])+0.25*nvnu_edge[0]*fskin[12]+0.4330127018922193*(nvnu_edge[3]*fskin[11]+nvnu_edge[4]*fskin[10])+0.25*(nvnu_edge[1]*fskin[9]+nvnu_edge[2]*fskin[8])+(0.4330127018922193*fskin[3]+0.25*fskin[0])*nvnu_edge[7]+0.4330127018922193*(nvnu_edge[5]*fskin[7]+fskin[6]*nvnu_edge[6])+0.25*(fskin[1]*nvnu_edge[6]+fskin[2]*nvnu_edge[5]+nvnu_edge[3]*fskin[5]+fskin[4]*nvnu_edge[4]))/vmap_prime_skin[0]; 

  } 
  out[0] += 0.7071067811865475*Ghat_r[0]*rdv2; 
  out[1] += 0.7071067811865475*Ghat_r[1]*rdv2; 
  out[2] += 0.7071067811865475*Ghat_r[2]*rdv2; 
  out[3] += 1.224744871391589*Ghat_r[0]*rdv2; 
  out[4] += 0.7071067811865475*Ghat_r[3]*rdv2; 
  out[5] += 0.7071067811865475*Ghat_r[4]*rdv2; 
  out[6] += 1.224744871391589*Ghat_r[1]*rdv2; 
  out[7] += 1.224744871391589*Ghat_r[2]*rdv2; 
  out[8] += 0.7071067811865475*Ghat_r[5]*rdv2; 
  out[9] += 0.7071067811865475*Ghat_r[6]*rdv2; 
  out[10] += 1.224744871391589*Ghat_r[3]*rdv2; 
  out[11] += 1.224744871391589*Ghat_r[4]*rdv2; 
  out[12] += 0.7071067811865475*Ghat_r[7]*rdv2; 
  out[13] += 1.224744871391589*Ghat_r[5]*rdv2; 
  out[14] += 1.224744871391589*Ghat_r[6]*rdv2; 
  out[15] += 1.224744871391589*Ghat_r[7]*rdv2; 
  out[16] += 1.58113883008419*Ghat_r[0]*rdv2; 
  out[17] += 1.58113883008419*Ghat_r[1]*rdv2; 
  out[18] += 1.58113883008419*Ghat_r[2]*rdv2; 
  out[19] += 1.58113883008419*Ghat_r[3]*rdv2; 
  out[20] += 1.58113883008419*Ghat_r[4]*rdv2; 
  out[21] += 1.58113883008419*Ghat_r[5]*rdv2; 
  out[22] += 1.58113883008419*Ghat_r[6]*rdv2; 
  out[23] += 1.58113883008419*Ghat_r[7]*rdv2; 

  } else { 

  double Ghat_l[8] = {0.0}; 
  if (w[2]>0) {

  Ghat_l[0] = (0.5590169943749476*nvnu_skin[7]*fskin[23]+0.5590169943749475*(nvnu_skin[6]*fskin[22]+nvnu_skin[5]*fskin[21]+nvnu_skin[4]*fskin[20])+0.5590169943749476*(nvnu_skin[3]*fskin[19]+nvnu_skin[2]*fskin[18]+nvnu_skin[1]*fskin[17])+0.5590169943749475*nvnu_skin[0]*fskin[16]-0.4330127018922193*(nvnu_skin[7]*fskin[15]+nvnu_skin[6]*fskin[14]+nvnu_skin[5]*fskin[13])+0.25*nvnu_skin[7]*fskin[12]-0.4330127018922193*(nvnu_skin[4]*fskin[11]+nvnu_skin[3]*fskin[10])+0.25*(nvnu_skin[6]*fskin[9]+nvnu_skin[5]*fskin[8])-0.4330127018922193*(nvnu_skin[2]*fskin[7]+nvnu_skin[1]*fskin[6])+0.25*(nvnu_skin[4]*fskin[5]+nvnu_skin[3]*fskin[4])-0.4330127018922193*nvnu_skin[0]*fskin[3]+0.25*(fskin[2]*nvnu_skin[2]+fskin[1]*nvnu_skin[1]+fskin[0]*nvnu_skin[0]))/vmap_prime_skin[0]; 
  Ghat_l[1] = (0.5590169943749476*nvnu_skin[6]*fskin[23]+0.5590169943749475*(nvnu_skin[7]*fskin[22]+nvnu_skin[3]*fskin[21]+nvnu_skin[2]*fskin[20])+0.5590169943749476*(nvnu_skin[5]*fskin[19]+nvnu_skin[4]*fskin[18]+nvnu_skin[0]*fskin[17])+0.5590169943749475*nvnu_skin[1]*fskin[16]-0.4330127018922193*(nvnu_skin[6]*fskin[15]+nvnu_skin[7]*fskin[14]+nvnu_skin[3]*fskin[13])+0.25*nvnu_skin[6]*fskin[12]-0.4330127018922193*(nvnu_skin[2]*fskin[11]+nvnu_skin[5]*fskin[10])+0.25*(nvnu_skin[7]*fskin[9]+nvnu_skin[3]*fskin[8])-0.4330127018922193*(nvnu_skin[4]*fskin[7]+nvnu_skin[0]*fskin[6])+0.25*(fskin[4]*nvnu_skin[5]+nvnu_skin[2]*fskin[5]+fskin[2]*nvnu_skin[4])-0.4330127018922193*nvnu_skin[1]*fskin[3]+0.25*(fskin[0]*nvnu_skin[1]+nvnu_skin[0]*fskin[1]))/vmap_prime_skin[0]; 
  Ghat_l[2] = (0.5590169943749476*nvnu_skin[5]*fskin[23]+0.5590169943749475*(nvnu_skin[3]*fskin[22]+nvnu_skin[7]*fskin[21]+nvnu_skin[1]*fskin[20])+0.5590169943749476*(nvnu_skin[6]*fskin[19]+nvnu_skin[0]*fskin[18]+nvnu_skin[4]*fskin[17])+0.5590169943749475*nvnu_skin[2]*fskin[16]-0.4330127018922193*(nvnu_skin[5]*fskin[15]+nvnu_skin[3]*fskin[14]+nvnu_skin[7]*fskin[13])+0.25*nvnu_skin[5]*fskin[12]-0.4330127018922193*(nvnu_skin[1]*fskin[11]+nvnu_skin[6]*fskin[10])+0.25*(nvnu_skin[3]*fskin[9]+nvnu_skin[7]*fskin[8])-0.4330127018922193*nvnu_skin[0]*fskin[7]+0.25*fskin[4]*nvnu_skin[6]-0.4330127018922193*nvnu_skin[4]*fskin[6]+0.25*(nvnu_skin[1]*fskin[5]+fskin[1]*nvnu_skin[4])-0.4330127018922193*nvnu_skin[2]*fskin[3]+0.25*(fskin[0]*nvnu_skin[2]+nvnu_skin[0]*fskin[2]))/vmap_prime_skin[0]; 
  Ghat_l[3] = (0.5590169943749476*nvnu_skin[4]*fskin[23]+0.5590169943749475*(nvnu_skin[2]*fskin[22]+nvnu_skin[1]*fskin[21]+nvnu_skin[7]*fskin[20])+0.5590169943749476*(nvnu_skin[0]*fskin[19]+nvnu_skin[6]*fskin[18]+nvnu_skin[5]*fskin[17])+0.5590169943749475*nvnu_skin[3]*fskin[16]-0.4330127018922193*(nvnu_skin[4]*fskin[15]+nvnu_skin[2]*fskin[14]+nvnu_skin[1]*fskin[13])+0.25*nvnu_skin[4]*fskin[12]-0.4330127018922193*(nvnu_skin[7]*fskin[11]+nvnu_skin[0]*fskin[10])+0.25*(nvnu_skin[2]*fskin[9]+nvnu_skin[1]*fskin[8]+fskin[5]*nvnu_skin[7])+nvnu_skin[6]*(0.25*fskin[2]-0.4330127018922193*fskin[7])-0.4330127018922193*nvnu_skin[5]*fskin[6]+0.25*(fskin[1]*nvnu_skin[5]+nvnu_skin[0]*fskin[4])+(0.25*fskin[0]-0.4330127018922193*fskin[3])*nvnu_skin[3])/vmap_prime_skin[0]; 
  Ghat_l[4] = (0.5590169943749476*nvnu_skin[3]*fskin[23]+0.5590169943749475*(nvnu_skin[5]*fskin[22]+nvnu_skin[6]*fskin[21]+nvnu_skin[0]*fskin[20])+0.5590169943749476*(nvnu_skin[7]*fskin[19]+nvnu_skin[1]*fskin[18]+nvnu_skin[2]*fskin[17])+0.5590169943749475*nvnu_skin[4]*fskin[16]-0.4330127018922193*(nvnu_skin[3]*fskin[15]+nvnu_skin[5]*fskin[14]+nvnu_skin[6]*fskin[13])+0.25*nvnu_skin[3]*fskin[12]-0.4330127018922193*(nvnu_skin[0]*fskin[11]+nvnu_skin[7]*fskin[10])+0.25*(nvnu_skin[5]*fskin[9]+nvnu_skin[6]*fskin[8]+fskin[4]*nvnu_skin[7])-0.4330127018922193*(nvnu_skin[1]*fskin[7]+nvnu_skin[2]*fskin[6])+0.25*nvnu_skin[0]*fskin[5]-0.4330127018922193*fskin[3]*nvnu_skin[4]+0.25*(fskin[0]*nvnu_skin[4]+fskin[1]*nvnu_skin[2]+nvnu_skin[1]*fskin[2]))/vmap_prime_skin[0]; 
  Ghat_l[5] = (0.5590169943749476*nvnu_skin[2]*fskin[23]+0.5590169943749475*(nvnu_skin[4]*fskin[22]+nvnu_skin[0]*fskin[21]+nvnu_skin[6]*fskin[20])+0.5590169943749476*(nvnu_skin[1]*fskin[19]+nvnu_skin[7]*fskin[18]+nvnu_skin[3]*fskin[17])+0.5590169943749475*nvnu_skin[5]*fskin[16]-0.4330127018922193*(nvnu_skin[2]*fskin[15]+nvnu_skin[4]*fskin[14]+nvnu_skin[0]*fskin[13])+0.25*nvnu_skin[2]*fskin[12]-0.4330127018922193*(nvnu_skin[6]*fskin[11]+nvnu_skin[1]*fskin[10])+0.25*(nvnu_skin[4]*fskin[9]+nvnu_skin[0]*fskin[8])-0.4330127018922193*fskin[7]*nvnu_skin[7]+0.25*(fskin[2]*nvnu_skin[7]+fskin[5]*nvnu_skin[6])-0.4330127018922193*(nvnu_skin[3]*fskin[6]+fskin[3]*nvnu_skin[5])+0.25*(fskin[0]*nvnu_skin[5]+nvnu_skin[1]*fskin[4]+fskin[1]*nvnu_skin[3]))/vmap_prime_skin[0]; 
  Ghat_l[6] = (0.5590169943749476*nvnu_skin[1]*fskin[23]+0.5590169943749475*(nvnu_skin[0]*fskin[22]+nvnu_skin[4]*fskin[21]+nvnu_skin[5]*fskin[20])+0.5590169943749476*(nvnu_skin[2]*fskin[19]+nvnu_skin[3]*fskin[18]+nvnu_skin[7]*fskin[17])+0.5590169943749475*nvnu_skin[6]*fskin[16]-0.4330127018922193*(nvnu_skin[1]*fskin[15]+nvnu_skin[0]*fskin[14]+nvnu_skin[4]*fskin[13])+0.25*nvnu_skin[1]*fskin[12]-0.4330127018922193*(nvnu_skin[5]*fskin[11]+nvnu_skin[2]*fskin[10])+0.25*(nvnu_skin[0]*fskin[9]+nvnu_skin[4]*fskin[8])+(0.25*fskin[1]-0.4330127018922193*fskin[6])*nvnu_skin[7]-0.4330127018922193*(nvnu_skin[3]*fskin[7]+fskin[3]*nvnu_skin[6])+0.25*(fskin[0]*nvnu_skin[6]+fskin[5]*nvnu_skin[5]+nvnu_skin[2]*fskin[4]+fskin[2]*nvnu_skin[3]))/vmap_prime_skin[0]; 
  Ghat_l[7] = (0.5590169943749476*nvnu_skin[0]*fskin[23]+0.5590169943749475*(nvnu_skin[1]*fskin[22]+nvnu_skin[2]*fskin[21]+nvnu_skin[3]*fskin[20])+0.5590169943749476*(nvnu_skin[4]*fskin[19]+nvnu_skin[5]*fskin[18]+nvnu_skin[6]*fskin[17])+0.5590169943749475*nvnu_skin[7]*fskin[16]-0.4330127018922193*(nvnu_skin[0]*fskin[15]+nvnu_skin[1]*fskin[14]+nvnu_skin[2]*fskin[13])+0.25*nvnu_skin[0]*fskin[12]-0.4330127018922193*(nvnu_skin[3]*fskin[11]+nvnu_skin[4]*fskin[10])+0.25*(nvnu_skin[1]*fskin[9]+nvnu_skin[2]*fskin[8])+(0.25*fskin[0]-0.4330127018922193*fskin[3])*nvnu_skin[7]-0.4330127018922193*(nvnu_skin[5]*fskin[7]+fskin[6]*nvnu_skin[6])+0.25*(fskin[1]*nvnu_skin[6]+fskin[2]*nvnu_skin[5]+nvnu_skin[3]*fskin[5]+fskin[4]*nvnu_skin[4]))/vmap_prime_skin[0]; 

  } else { 

  Ghat_l[0] = (0.5590169943749476*nvnu_skin[7]*fedge[23]+0.5590169943749475*(nvnu_skin[6]*fedge[22]+nvnu_skin[5]*fedge[21]+nvnu_skin[4]*fedge[20])+0.5590169943749476*(nvnu_skin[3]*fedge[19]+nvnu_skin[2]*fedge[18]+nvnu_skin[1]*fedge[17])+0.5590169943749475*nvnu_skin[0]*fedge[16]+0.4330127018922193*(nvnu_skin[7]*fedge[15]+nvnu_skin[6]*fedge[14]+nvnu_skin[5]*fedge[13])+0.25*nvnu_skin[7]*fedge[12]+0.4330127018922193*(nvnu_skin[4]*fedge[11]+nvnu_skin[3]*fedge[10])+0.25*(nvnu_skin[6]*fedge[9]+nvnu_skin[5]*fedge[8])+0.4330127018922193*(nvnu_skin[2]*fedge[7]+nvnu_skin[1]*fedge[6])+0.25*(nvnu_skin[4]*fedge[5]+nvnu_skin[3]*fedge[4])+0.4330127018922193*nvnu_skin[0]*fedge[3]+0.25*(fedge[2]*nvnu_skin[2]+fedge[1]*nvnu_skin[1]+fedge[0]*nvnu_skin[0]))/vmap_prime_edge[0]; 
  Ghat_l[1] = (0.5590169943749476*nvnu_skin[6]*fedge[23]+0.5590169943749475*(nvnu_skin[7]*fedge[22]+nvnu_skin[3]*fedge[21]+nvnu_skin[2]*fedge[20])+0.5590169943749476*(nvnu_skin[5]*fedge[19]+nvnu_skin[4]*fedge[18]+nvnu_skin[0]*fedge[17])+0.5590169943749475*nvnu_skin[1]*fedge[16]+0.4330127018922193*(nvnu_skin[6]*fedge[15]+nvnu_skin[7]*fedge[14]+nvnu_skin[3]*fedge[13])+0.25*nvnu_skin[6]*fedge[12]+0.4330127018922193*(nvnu_skin[2]*fedge[11]+nvnu_skin[5]*fedge[10])+0.25*(nvnu_skin[7]*fedge[9]+nvnu_skin[3]*fedge[8])+0.4330127018922193*(nvnu_skin[4]*fedge[7]+nvnu_skin[0]*fedge[6])+0.25*(fedge[4]*nvnu_skin[5]+nvnu_skin[2]*fedge[5]+fedge[2]*nvnu_skin[4])+0.4330127018922193*nvnu_skin[1]*fedge[3]+0.25*(fedge[0]*nvnu_skin[1]+nvnu_skin[0]*fedge[1]))/vmap_prime_edge[0]; 
  Ghat_l[2] = (0.5590169943749476*nvnu_skin[5]*fedge[23]+0.5590169943749475*(nvnu_skin[3]*fedge[22]+nvnu_skin[7]*fedge[21]+nvnu_skin[1]*fedge[20])+0.5590169943749476*(nvnu_skin[6]*fedge[19]+nvnu_skin[0]*fedge[18]+nvnu_skin[4]*fedge[17])+0.5590169943749475*nvnu_skin[2]*fedge[16]+0.4330127018922193*(nvnu_skin[5]*fedge[15]+nvnu_skin[3]*fedge[14]+nvnu_skin[7]*fedge[13])+0.25*nvnu_skin[5]*fedge[12]+0.4330127018922193*(nvnu_skin[1]*fedge[11]+nvnu_skin[6]*fedge[10])+0.25*(nvnu_skin[3]*fedge[9]+nvnu_skin[7]*fedge[8])+0.4330127018922193*nvnu_skin[0]*fedge[7]+0.25*fedge[4]*nvnu_skin[6]+0.4330127018922193*nvnu_skin[4]*fedge[6]+0.25*(nvnu_skin[1]*fedge[5]+fedge[1]*nvnu_skin[4])+0.4330127018922193*nvnu_skin[2]*fedge[3]+0.25*(fedge[0]*nvnu_skin[2]+nvnu_skin[0]*fedge[2]))/vmap_prime_edge[0]; 
  Ghat_l[3] = (0.5590169943749476*nvnu_skin[4]*fedge[23]+0.5590169943749475*(nvnu_skin[2]*fedge[22]+nvnu_skin[1]*fedge[21]+nvnu_skin[7]*fedge[20])+0.5590169943749476*(nvnu_skin[0]*fedge[19]+nvnu_skin[6]*fedge[18]+nvnu_skin[5]*fedge[17])+0.5590169943749475*nvnu_skin[3]*fedge[16]+0.4330127018922193*(nvnu_skin[4]*fedge[15]+nvnu_skin[2]*fedge[14]+nvnu_skin[1]*fedge[13])+0.25*nvnu_skin[4]*fedge[12]+0.4330127018922193*(nvnu_skin[7]*fedge[11]+nvnu_skin[0]*fedge[10])+0.25*(nvnu_skin[2]*fedge[9]+nvnu_skin[1]*fedge[8]+fedge[5]*nvnu_skin[7])+nvnu_skin[6]*(0.4330127018922193*fedge[7]+0.25*fedge[2])+0.4330127018922193*nvnu_skin[5]*fedge[6]+0.25*(fedge[1]*nvnu_skin[5]+nvnu_skin[0]*fedge[4])+(0.4330127018922193*fedge[3]+0.25*fedge[0])*nvnu_skin[3])/vmap_prime_edge[0]; 
  Ghat_l[4] = (0.5590169943749476*nvnu_skin[3]*fedge[23]+0.5590169943749475*(nvnu_skin[5]*fedge[22]+nvnu_skin[6]*fedge[21]+nvnu_skin[0]*fedge[20])+0.5590169943749476*(nvnu_skin[7]*fedge[19]+nvnu_skin[1]*fedge[18]+nvnu_skin[2]*fedge[17])+0.5590169943749475*nvnu_skin[4]*fedge[16]+0.4330127018922193*(nvnu_skin[3]*fedge[15]+nvnu_skin[5]*fedge[14]+nvnu_skin[6]*fedge[13])+0.25*nvnu_skin[3]*fedge[12]+0.4330127018922193*(nvnu_skin[0]*fedge[11]+nvnu_skin[7]*fedge[10])+0.25*(nvnu_skin[5]*fedge[9]+nvnu_skin[6]*fedge[8]+fedge[4]*nvnu_skin[7])+0.4330127018922193*(nvnu_skin[1]*fedge[7]+nvnu_skin[2]*fedge[6])+0.25*nvnu_skin[0]*fedge[5]+0.4330127018922193*fedge[3]*nvnu_skin[4]+0.25*(fedge[0]*nvnu_skin[4]+fedge[1]*nvnu_skin[2]+nvnu_skin[1]*fedge[2]))/vmap_prime_edge[0]; 
  Ghat_l[5] = (0.5590169943749476*nvnu_skin[2]*fedge[23]+0.5590169943749475*(nvnu_skin[4]*fedge[22]+nvnu_skin[0]*fedge[21]+nvnu_skin[6]*fedge[20])+0.5590169943749476*(nvnu_skin[1]*fedge[19]+nvnu_skin[7]*fedge[18]+nvnu_skin[3]*fedge[17])+0.5590169943749475*nvnu_skin[5]*fedge[16]+0.4330127018922193*(nvnu_skin[2]*fedge[15]+nvnu_skin[4]*fedge[14]+nvnu_skin[0]*fedge[13])+0.25*nvnu_skin[2]*fedge[12]+0.4330127018922193*(nvnu_skin[6]*fedge[11]+nvnu_skin[1]*fedge[10])+0.25*(nvnu_skin[4]*fedge[9]+nvnu_skin[0]*fedge[8])+0.4330127018922193*fedge[7]*nvnu_skin[7]+0.25*(fedge[2]*nvnu_skin[7]+fedge[5]*nvnu_skin[6])+0.4330127018922193*(nvnu_skin[3]*fedge[6]+fedge[3]*nvnu_skin[5])+0.25*(fedge[0]*nvnu_skin[5]+nvnu_skin[1]*fedge[4]+fedge[1]*nvnu_skin[3]))/vmap_prime_edge[0]; 
  Ghat_l[6] = (0.5590169943749476*nvnu_skin[1]*fedge[23]+0.5590169943749475*(nvnu_skin[0]*fedge[22]+nvnu_skin[4]*fedge[21]+nvnu_skin[5]*fedge[20])+0.5590169943749476*(nvnu_skin[2]*fedge[19]+nvnu_skin[3]*fedge[18]+nvnu_skin[7]*fedge[17])+0.5590169943749475*nvnu_skin[6]*fedge[16]+0.4330127018922193*(nvnu_skin[1]*fedge[15]+nvnu_skin[0]*fedge[14]+nvnu_skin[4]*fedge[13])+0.25*nvnu_skin[1]*fedge[12]+0.4330127018922193*(nvnu_skin[5]*fedge[11]+nvnu_skin[2]*fedge[10])+0.25*(nvnu_skin[0]*fedge[9]+nvnu_skin[4]*fedge[8])+(0.4330127018922193*fedge[6]+0.25*fedge[1])*nvnu_skin[7]+0.4330127018922193*(nvnu_skin[3]*fedge[7]+fedge[3]*nvnu_skin[6])+0.25*(fedge[0]*nvnu_skin[6]+fedge[5]*nvnu_skin[5]+nvnu_skin[2]*fedge[4]+fedge[2]*nvnu_skin[3]))/vmap_prime_edge[0]; 
  Ghat_l[7] = (0.5590169943749476*nvnu_skin[0]*fedge[23]+0.5590169943749475*(nvnu_skin[1]*fedge[22]+nvnu_skin[2]*fedge[21]+nvnu_skin[3]*fedge[20])+0.5590169943749476*(nvnu_skin[4]*fedge[19]+nvnu_skin[5]*fedge[18]+nvnu_skin[6]*fedge[17])+0.5590169943749475*nvnu_skin[7]*fedge[16]+0.4330127018922193*(nvnu_skin[0]*fedge[15]+nvnu_skin[1]*fedge[14]+nvnu_skin[2]*fedge[13])+0.25*nvnu_skin[0]*fedge[12]+0.4330127018922193*(nvnu_skin[3]*fedge[11]+nvnu_skin[4]*fedge[10])+0.25*(nvnu_skin[1]*fedge[9]+nvnu_skin[2]*fedge[8])+(0.4330127018922193*fedge[3]+0.25*fedge[0])*nvnu_skin[7]+0.4330127018922193*(nvnu_skin[5]*fedge[7]+fedge[6]*nvnu_skin[6])+0.25*(fedge[1]*nvnu_skin[6]+fedge[2]*nvnu_skin[5]+nvnu_skin[3]*fedge[5]+fedge[4]*nvnu_skin[4]))/vmap_prime_edge[0]; 

  } 
  out[0] += -0.7071067811865475*Ghat_l[0]*rdv2; 
  out[1] += -0.7071067811865475*Ghat_l[1]*rdv2; 
  out[2] += -0.7071067811865475*Ghat_l[2]*rdv2; 
  out[3] += 1.224744871391589*Ghat_l[0]*rdv2; 
  out[4] += -0.7071067811865475*Ghat_l[3]*rdv2; 
  out[5] += -0.7071067811865475*Ghat_l[4]*rdv2; 
  out[6] += 1.224744871391589*Ghat_l[1]*rdv2; 
  out[7] += 1.224744871391589*Ghat_l[2]*rdv2; 
  out[8] += -0.7071067811865475*Ghat_l[5]*rdv2; 
  out[9] += -0.7071067811865475*Ghat_l[6]*rdv2; 
  out[10] += 1.224744871391589*Ghat_l[3]*rdv2; 
  out[11] += 1.224744871391589*Ghat_l[4]*rdv2; 
  out[12] += -0.7071067811865475*Ghat_l[7]*rdv2; 
  out[13] += 1.224744871391589*Ghat_l[5]*rdv2; 
  out[14] += 1.224744871391589*Ghat_l[6]*rdv2; 
  out[15] += 1.224744871391589*Ghat_l[7]*rdv2; 
  out[16] += -1.58113883008419*Ghat_l[0]*rdv2; 
  out[17] += -1.58113883008419*Ghat_l[1]*rdv2; 
  out[18] += -1.58113883008419*Ghat_l[2]*rdv2; 
  out[19] += -1.58113883008419*Ghat_l[3]*rdv2; 
  out[20] += -1.58113883008419*Ghat_l[4]*rdv2; 
  out[21] += -1.58113883008419*Ghat_l[5]*rdv2; 
  out[22] += -1.58113883008419*Ghat_l[6]*rdv2; 
  out[23] += -1.58113883008419*Ghat_l[7]*rdv2; 

  } 

  double vmap_prime_min = fmin(fabs(vmap_prime_edge[0]),fabs(vmap_prime_skin[0]));
  double cflFreq = fmax(fabs(nvnu_edge[0]/vmap_prime_min), fabs(nvnu_skin[0]/vmap_prime_min)); 
  return 0.8838834764831842*rdv2*cflFreq; 

} 
