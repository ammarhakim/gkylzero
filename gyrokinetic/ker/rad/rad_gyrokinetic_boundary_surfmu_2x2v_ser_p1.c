#include <gkyl_rad_gyrokinetic_kernels.h> 
GKYL_CU_DH double rad_gyrokinetic_boundary_surfmu_2x2v_ser_p1(const double *w, const double *dxv, const double *vmap,
    const double *vmap_prime_edge, const double *vmap_prime_skin,
    const double *nvnu_edge, const double *nvnu_skin, const double *nvsqnu_edge, const double *nvsqnu_skin, 
    const int edge, const double *fedge, const double *fskin, double* GKYL_RESTRICT out) 
{ 
  // w[4]:     cell-center coordinates. 
  // dxv[4]:   cell spacing. 
  // vmap: velocity space mapping.
  // vmap_prime_edge,vmap_prime_skin: velocity space mapping derivative in edge and skin cells.
  // nvnu_edge: Surface expansion sum_s n_s*nu_s(v) in vparallel direction on the lower edges of the edge cell.
  // nvnu_skin: Surface expansion sum_s n_s*nu_s(v) in vparallel direction on the lower edges of the skin cell.
  // nvsqnu_edge: Surface expansion sum_s n_s*nu_s(v) in mu direction on the lower edges of the edge cell.
  // nvsqnu_skin: Surface expansion sum_s n_s*nu_s(v) in mu direction on the lower edges of the edge skin.
  // edge: determines if the update is for the left edge (-1) or right edge (+1).
  // fskin,fedge: distribution function in skin cell/last edge cell.
  // out: output increment in center cell.

  double rdv2 = 2.0/dxv[3]; 

  if (edge == -1) { 

  double Ghat_r[12] = {0.0}; 
  Ghat_r[0] = ((-0.4330127018922194*(nvsqnu_edge[11]*fedge[23]+nvsqnu_edge[10]*fedge[22]+nvsqnu_edge[9]*fedge[21]))+0.25*nvsqnu_edge[11]*fedge[20]-0.4330127018922194*nvsqnu_edge[8]*fedge[19]+0.25*(nvsqnu_edge[10]*fedge[18]+nvsqnu_edge[9]*fedge[17]+nvsqnu_edge[8]*fedge[16])-0.4330127018922193*(nvsqnu_edge[7]*fedge[15]+nvsqnu_edge[6]*fedge[14]+nvsqnu_edge[5]*fedge[13]+nvsqnu_edge[4]*fedge[12])+0.25*nvsqnu_edge[7]*fedge[11]-0.4330127018922193*(nvsqnu_edge[3]*fedge[10]+nvsqnu_edge[2]*fedge[9]+nvsqnu_edge[1]*fedge[8])+0.25*(nvsqnu_edge[6]*fedge[7]+nvsqnu_edge[5]*fedge[6]+nvsqnu_edge[4]*fedge[5])-0.4330127018922193*nvsqnu_edge[0]*fedge[4]+0.25*(fedge[3]*nvsqnu_edge[3]+fedge[2]*nvsqnu_edge[2]+fedge[1]*nvsqnu_edge[1]+fedge[0]*nvsqnu_edge[0]))/vmap_prime_edge[1]; 
  Ghat_r[1] = ((-0.4330127018922193*(nvsqnu_edge[10]*fedge[23]+nvsqnu_edge[11]*fedge[22]+nvsqnu_edge[8]*fedge[21]))+0.2500000000000001*nvsqnu_edge[10]*fedge[20]-0.4330127018922193*nvsqnu_edge[9]*fedge[19]+0.2500000000000001*(nvsqnu_edge[11]*fedge[18]+nvsqnu_edge[8]*fedge[17]+nvsqnu_edge[9]*fedge[16])-0.4330127018922193*(nvsqnu_edge[6]*fedge[15]+nvsqnu_edge[7]*fedge[14]+nvsqnu_edge[3]*fedge[13]+nvsqnu_edge[2]*fedge[12])+0.25*nvsqnu_edge[6]*fedge[11]-0.4330127018922193*(nvsqnu_edge[5]*fedge[10]+nvsqnu_edge[4]*fedge[9]+nvsqnu_edge[0]*fedge[8])+0.25*(fedge[7]*nvsqnu_edge[7]+nvsqnu_edge[3]*fedge[6]+fedge[3]*nvsqnu_edge[5]+nvsqnu_edge[2]*fedge[5]+fedge[2]*nvsqnu_edge[4])-0.4330127018922193*nvsqnu_edge[1]*fedge[4]+0.25*(fedge[0]*nvsqnu_edge[1]+nvsqnu_edge[0]*fedge[1]))/vmap_prime_edge[1]; 
  Ghat_r[2] = ((-0.4330127018922193*(nvsqnu_edge[9]*fedge[23]+nvsqnu_edge[8]*fedge[22]+nvsqnu_edge[11]*fedge[21]))+0.2500000000000001*nvsqnu_edge[9]*fedge[20]-0.4330127018922193*nvsqnu_edge[10]*fedge[19]+0.2500000000000001*(nvsqnu_edge[8]*fedge[18]+nvsqnu_edge[11]*fedge[17]+nvsqnu_edge[10]*fedge[16])-0.4330127018922193*(nvsqnu_edge[5]*fedge[15]+nvsqnu_edge[3]*fedge[14]+nvsqnu_edge[7]*fedge[13]+nvsqnu_edge[1]*fedge[12])+0.25*nvsqnu_edge[5]*fedge[11]-0.4330127018922193*(nvsqnu_edge[6]*fedge[10]+nvsqnu_edge[0]*fedge[9]+nvsqnu_edge[4]*fedge[8])+0.25*(fedge[6]*nvsqnu_edge[7]+nvsqnu_edge[3]*fedge[7]+fedge[3]*nvsqnu_edge[6]+nvsqnu_edge[1]*fedge[5]+fedge[1]*nvsqnu_edge[4])-0.4330127018922193*nvsqnu_edge[2]*fedge[4]+0.25*(fedge[0]*nvsqnu_edge[2]+nvsqnu_edge[0]*fedge[2]))/vmap_prime_edge[1]; 
  Ghat_r[3] = ((-0.3872983346207417*nvsqnu_edge[7]*fedge[23])-0.3872983346207416*(nvsqnu_edge[6]*fedge[22]+nvsqnu_edge[5]*fedge[21])+0.223606797749979*nvsqnu_edge[7]*fedge[20]-0.3872983346207417*nvsqnu_edge[3]*fedge[19]+0.223606797749979*(nvsqnu_edge[6]*fedge[18]+nvsqnu_edge[5]*fedge[17])+0.223606797749979*nvsqnu_edge[3]*fedge[16]+((-0.3872983346207416*nvsqnu_edge[11])-0.4330127018922193*nvsqnu_edge[4])*fedge[15]+((-0.3872983346207417*nvsqnu_edge[10])-0.4330127018922193*nvsqnu_edge[2])*fedge[14]-0.3872983346207417*nvsqnu_edge[9]*fedge[13]-0.4330127018922193*(nvsqnu_edge[1]*fedge[13]+nvsqnu_edge[7]*fedge[12])+fedge[11]*(0.223606797749979*nvsqnu_edge[11]+0.25*nvsqnu_edge[4])+0.223606797749979*fedge[7]*nvsqnu_edge[10]+((-0.3872983346207416*nvsqnu_edge[8])-0.4330127018922193*nvsqnu_edge[0])*fedge[10]+0.223606797749979*fedge[6]*nvsqnu_edge[9]-0.4330127018922193*nvsqnu_edge[6]*fedge[9]+0.223606797749979*fedge[3]*nvsqnu_edge[8]-0.4330127018922193*nvsqnu_edge[5]*fedge[8]+0.25*(fedge[5]*nvsqnu_edge[7]+nvsqnu_edge[2]*fedge[7]+fedge[2]*nvsqnu_edge[6]+nvsqnu_edge[1]*fedge[6]+fedge[1]*nvsqnu_edge[5])-0.4330127018922193*nvsqnu_edge[3]*fedge[4]+0.25*(fedge[0]*nvsqnu_edge[3]+nvsqnu_edge[0]*fedge[3]))/vmap_prime_edge[1]; 
  Ghat_r[4] = ((-0.4330127018922194*(nvsqnu_edge[8]*fedge[23]+nvsqnu_edge[9]*fedge[22]+nvsqnu_edge[10]*fedge[21]))+0.25*nvsqnu_edge[8]*fedge[20]-0.4330127018922194*nvsqnu_edge[11]*fedge[19]+0.25*(nvsqnu_edge[9]*fedge[18]+nvsqnu_edge[10]*fedge[17]+nvsqnu_edge[11]*fedge[16])-0.4330127018922193*(nvsqnu_edge[3]*fedge[15]+nvsqnu_edge[5]*fedge[14]+nvsqnu_edge[6]*fedge[13]+nvsqnu_edge[0]*fedge[12])+0.25*nvsqnu_edge[3]*fedge[11]-0.4330127018922193*(nvsqnu_edge[7]*fedge[10]+nvsqnu_edge[1]*fedge[9]+nvsqnu_edge[2]*fedge[8])+0.25*(fedge[3]*nvsqnu_edge[7]+nvsqnu_edge[5]*fedge[7]+fedge[6]*nvsqnu_edge[6]+nvsqnu_edge[0]*fedge[5])-0.4330127018922193*fedge[4]*nvsqnu_edge[4]+0.25*(fedge[0]*nvsqnu_edge[4]+fedge[1]*nvsqnu_edge[2]+nvsqnu_edge[1]*fedge[2]))/vmap_prime_edge[1]; 
  Ghat_r[5] = ((-0.3872983346207417*nvsqnu_edge[6]*fedge[23])-0.3872983346207416*(nvsqnu_edge[7]*fedge[22]+nvsqnu_edge[3]*fedge[21])+0.223606797749979*nvsqnu_edge[6]*fedge[20]-0.3872983346207417*nvsqnu_edge[5]*fedge[19]+0.223606797749979*(nvsqnu_edge[7]*fedge[18]+nvsqnu_edge[3]*fedge[17])+0.223606797749979*nvsqnu_edge[5]*fedge[16]+((-0.3872983346207417*nvsqnu_edge[10])-0.4330127018922193*nvsqnu_edge[2])*fedge[15]+((-0.3872983346207416*nvsqnu_edge[11])-0.4330127018922193*nvsqnu_edge[4])*fedge[14]-0.3872983346207416*nvsqnu_edge[8]*fedge[13]-0.4330127018922193*(nvsqnu_edge[0]*fedge[13]+nvsqnu_edge[6]*fedge[12])+0.223606797749979*fedge[7]*nvsqnu_edge[11]+(0.223606797749979*nvsqnu_edge[10]+0.25*nvsqnu_edge[2])*fedge[11]+((-0.3872983346207417*nvsqnu_edge[9])-0.4330127018922193*nvsqnu_edge[1])*fedge[10]+0.223606797749979*fedge[3]*nvsqnu_edge[9]-0.4330127018922193*nvsqnu_edge[7]*fedge[9]+0.223606797749979*fedge[6]*nvsqnu_edge[8]-0.4330127018922193*nvsqnu_edge[3]*fedge[8]+0.25*(fedge[2]*nvsqnu_edge[7]+nvsqnu_edge[4]*fedge[7]+fedge[5]*nvsqnu_edge[6]+nvsqnu_edge[0]*fedge[6])-0.4330127018922193*fedge[4]*nvsqnu_edge[5]+0.25*(fedge[0]*nvsqnu_edge[5]+fedge[1]*nvsqnu_edge[3]+nvsqnu_edge[1]*fedge[3]))/vmap_prime_edge[1]; 
  Ghat_r[6] = ((-0.3872983346207417*nvsqnu_edge[5]*fedge[23])-0.3872983346207416*(nvsqnu_edge[3]*fedge[22]+nvsqnu_edge[7]*fedge[21])+0.223606797749979*nvsqnu_edge[5]*fedge[20]-0.3872983346207417*nvsqnu_edge[6]*fedge[19]+0.223606797749979*(nvsqnu_edge[3]*fedge[18]+nvsqnu_edge[7]*fedge[17])+0.223606797749979*nvsqnu_edge[6]*fedge[16]+((-0.3872983346207417*nvsqnu_edge[9])-0.4330127018922193*nvsqnu_edge[1])*fedge[15]+((-0.3872983346207416*nvsqnu_edge[8])-0.4330127018922193*nvsqnu_edge[0])*fedge[14]-0.3872983346207416*nvsqnu_edge[11]*fedge[13]-0.4330127018922193*(nvsqnu_edge[4]*fedge[13]+nvsqnu_edge[5]*fedge[12])+0.223606797749979*fedge[6]*nvsqnu_edge[11]+(0.223606797749979*nvsqnu_edge[9]+0.25*nvsqnu_edge[1])*fedge[11]+(0.223606797749979*fedge[3]-0.3872983346207417*fedge[10])*nvsqnu_edge[10]-0.4330127018922193*(nvsqnu_edge[2]*fedge[10]+nvsqnu_edge[3]*fedge[9])+0.223606797749979*fedge[7]*nvsqnu_edge[8]-0.4330127018922193*nvsqnu_edge[7]*fedge[8]+0.25*(fedge[1]*nvsqnu_edge[7]+nvsqnu_edge[0]*fedge[7])-0.4330127018922193*fedge[4]*nvsqnu_edge[6]+0.25*(fedge[0]*nvsqnu_edge[6]+nvsqnu_edge[4]*fedge[6]+fedge[5]*nvsqnu_edge[5]+fedge[2]*nvsqnu_edge[3]+nvsqnu_edge[2]*fedge[3]))/vmap_prime_edge[1]; 
  Ghat_r[7] = ((-0.3872983346207417*nvsqnu_edge[3]*fedge[23])-0.3872983346207416*(nvsqnu_edge[5]*fedge[22]+nvsqnu_edge[6]*fedge[21])+0.223606797749979*nvsqnu_edge[3]*fedge[20]-0.3872983346207417*nvsqnu_edge[7]*fedge[19]+0.223606797749979*(nvsqnu_edge[5]*fedge[18]+nvsqnu_edge[6]*fedge[17])+0.223606797749979*nvsqnu_edge[7]*fedge[16]+((-0.3872983346207416*nvsqnu_edge[8])-0.4330127018922193*nvsqnu_edge[0])*fedge[15]+((-0.3872983346207417*nvsqnu_edge[9])-0.4330127018922193*nvsqnu_edge[1])*fedge[14]-0.3872983346207417*nvsqnu_edge[10]*fedge[13]-0.4330127018922193*(nvsqnu_edge[2]*fedge[13]+nvsqnu_edge[3]*fedge[12])+(0.223606797749979*fedge[3]-0.3872983346207416*fedge[10])*nvsqnu_edge[11]+(0.223606797749979*nvsqnu_edge[8]+0.25*nvsqnu_edge[0])*fedge[11]+0.223606797749979*fedge[6]*nvsqnu_edge[10]-0.4330127018922193*nvsqnu_edge[4]*fedge[10]+0.223606797749979*fedge[7]*nvsqnu_edge[9]-0.4330127018922193*(nvsqnu_edge[5]*fedge[9]+nvsqnu_edge[6]*fedge[8]+fedge[4]*nvsqnu_edge[7])+0.25*(fedge[0]*nvsqnu_edge[7]+nvsqnu_edge[1]*fedge[7]+fedge[1]*nvsqnu_edge[6]+nvsqnu_edge[2]*fedge[6]+fedge[2]*nvsqnu_edge[5]+nvsqnu_edge[3]*fedge[5]+fedge[3]*nvsqnu_edge[4]))/vmap_prime_edge[1]; 
  Ghat_r[8] = (((-0.276641667586244*nvsqnu_edge[11])-0.4330127018922194*nvsqnu_edge[4])*fedge[23]+((-0.276641667586244*nvsqnu_edge[10])-0.4330127018922193*nvsqnu_edge[2])*fedge[22]+((-0.276641667586244*nvsqnu_edge[9])-0.4330127018922193*nvsqnu_edge[1])*fedge[21]+(0.159719141249985*nvsqnu_edge[11]+0.25*nvsqnu_edge[4])*fedge[20]+((-0.276641667586244*nvsqnu_edge[8])-0.4330127018922194*nvsqnu_edge[0])*fedge[19]+(0.159719141249985*nvsqnu_edge[10]+0.2500000000000001*nvsqnu_edge[2])*fedge[18]+(0.159719141249985*nvsqnu_edge[9]+0.2500000000000001*nvsqnu_edge[1])*fedge[17]+(0.159719141249985*nvsqnu_edge[8]+0.25*nvsqnu_edge[0])*fedge[16]-0.3872983346207416*(nvsqnu_edge[7]*fedge[15]+nvsqnu_edge[6]*fedge[14]+nvsqnu_edge[5]*fedge[13])+nvsqnu_edge[11]*(0.25*fedge[5]-0.4330127018922193*fedge[12])+0.223606797749979*nvsqnu_edge[7]*fedge[11]+(0.2500000000000001*fedge[2]-0.4330127018922194*fedge[9])*nvsqnu_edge[10]-0.3872983346207416*nvsqnu_edge[3]*fedge[10]+(0.2500000000000001*fedge[1]-0.4330127018922194*fedge[8])*nvsqnu_edge[9]+(0.25*fedge[0]-0.4330127018922193*fedge[4])*nvsqnu_edge[8]+0.223606797749979*(nvsqnu_edge[6]*fedge[7]+nvsqnu_edge[5]*fedge[6]+fedge[3]*nvsqnu_edge[3]))/vmap_prime_edge[1]; 
  Ghat_r[9] = (((-0.276641667586244*nvsqnu_edge[10])-0.4330127018922193*nvsqnu_edge[2])*fedge[23]+((-0.276641667586244*nvsqnu_edge[11])-0.4330127018922194*nvsqnu_edge[4])*fedge[22]+((-0.276641667586244*nvsqnu_edge[8])-0.4330127018922194*nvsqnu_edge[0])*fedge[21]+(0.159719141249985*nvsqnu_edge[10]+0.2500000000000001*nvsqnu_edge[2])*fedge[20]+((-0.276641667586244*nvsqnu_edge[9])-0.4330127018922193*nvsqnu_edge[1])*fedge[19]+(0.159719141249985*nvsqnu_edge[11]+0.25*nvsqnu_edge[4])*fedge[18]+(0.159719141249985*nvsqnu_edge[8]+0.25*nvsqnu_edge[0])*fedge[17]+(0.159719141249985*nvsqnu_edge[9]+0.2500000000000001*nvsqnu_edge[1])*fedge[16]-0.3872983346207417*(nvsqnu_edge[6]*fedge[15]+nvsqnu_edge[7]*fedge[14]+nvsqnu_edge[3]*fedge[13])-0.4330127018922193*nvsqnu_edge[10]*fedge[12]+(0.2500000000000001*fedge[2]-0.4330127018922194*fedge[9])*nvsqnu_edge[11]+0.223606797749979*nvsqnu_edge[6]*fedge[11]+0.25*fedge[5]*nvsqnu_edge[10]-0.3872983346207417*nvsqnu_edge[5]*fedge[10]+(0.25*fedge[0]-0.4330127018922193*fedge[4])*nvsqnu_edge[9]+(0.2500000000000001*fedge[1]-0.4330127018922194*fedge[8])*nvsqnu_edge[8]+0.223606797749979*(fedge[7]*nvsqnu_edge[7]+nvsqnu_edge[3]*fedge[6]+fedge[3]*nvsqnu_edge[5]))/vmap_prime_edge[1]; 
  Ghat_r[10] = (((-0.276641667586244*nvsqnu_edge[9])-0.4330127018922193*nvsqnu_edge[1])*fedge[23]+((-0.276641667586244*nvsqnu_edge[8])-0.4330127018922194*nvsqnu_edge[0])*fedge[22]+((-0.276641667586244*nvsqnu_edge[11])-0.4330127018922194*nvsqnu_edge[4])*fedge[21]+(0.159719141249985*nvsqnu_edge[9]+0.2500000000000001*nvsqnu_edge[1])*fedge[20]+((-0.276641667586244*nvsqnu_edge[10])-0.4330127018922193*nvsqnu_edge[2])*fedge[19]+(0.159719141249985*nvsqnu_edge[8]+0.25*nvsqnu_edge[0])*fedge[18]+(0.159719141249985*nvsqnu_edge[11]+0.25*nvsqnu_edge[4])*fedge[17]+(0.159719141249985*nvsqnu_edge[10]+0.2500000000000001*nvsqnu_edge[2])*fedge[16]-0.3872983346207417*(nvsqnu_edge[5]*fedge[15]+nvsqnu_edge[3]*fedge[14]+nvsqnu_edge[7]*fedge[13])-0.4330127018922193*nvsqnu_edge[9]*fedge[12]+(0.2500000000000001*fedge[1]-0.4330127018922194*fedge[8])*nvsqnu_edge[11]+0.223606797749979*nvsqnu_edge[5]*fedge[11]+(0.25*fedge[0]-0.4330127018922193*fedge[4])*nvsqnu_edge[10]-0.3872983346207417*nvsqnu_edge[6]*fedge[10]+0.25*fedge[5]*nvsqnu_edge[9]+nvsqnu_edge[8]*(0.2500000000000001*fedge[2]-0.4330127018922194*fedge[9])+0.223606797749979*(fedge[6]*nvsqnu_edge[7]+nvsqnu_edge[3]*fedge[7]+fedge[3]*nvsqnu_edge[6]))/vmap_prime_edge[1]; 
  Ghat_r[11] = (((-0.276641667586244*nvsqnu_edge[8])-0.4330127018922194*nvsqnu_edge[0])*fedge[23]+((-0.276641667586244*nvsqnu_edge[9])-0.4330127018922193*nvsqnu_edge[1])*fedge[22]+((-0.276641667586244*nvsqnu_edge[10])-0.4330127018922193*nvsqnu_edge[2])*fedge[21]+(0.159719141249985*nvsqnu_edge[8]+0.25*nvsqnu_edge[0])*fedge[20]+((-0.276641667586244*nvsqnu_edge[11])-0.4330127018922194*nvsqnu_edge[4])*fedge[19]+(0.159719141249985*nvsqnu_edge[9]+0.2500000000000001*nvsqnu_edge[1])*fedge[18]+(0.159719141249985*nvsqnu_edge[10]+0.2500000000000001*nvsqnu_edge[2])*fedge[17]+(0.159719141249985*nvsqnu_edge[11]+0.25*nvsqnu_edge[4])*fedge[16]-0.3872983346207416*(nvsqnu_edge[3]*fedge[15]+nvsqnu_edge[5]*fedge[14]+nvsqnu_edge[6]*fedge[13])-0.4330127018922193*nvsqnu_edge[8]*fedge[12]+(0.25*fedge[0]-0.4330127018922193*fedge[4])*nvsqnu_edge[11]+0.223606797749979*nvsqnu_edge[3]*fedge[11]+(0.2500000000000001*fedge[1]-0.4330127018922194*fedge[8])*nvsqnu_edge[10]-0.3872983346207416*nvsqnu_edge[7]*fedge[10]+(0.2500000000000001*fedge[2]-0.4330127018922194*fedge[9])*nvsqnu_edge[9]+0.25*fedge[5]*nvsqnu_edge[8]+0.223606797749979*(fedge[3]*nvsqnu_edge[7]+nvsqnu_edge[5]*fedge[7]+fedge[6]*nvsqnu_edge[6]))/vmap_prime_edge[1]; 

  out[0] += 0.7071067811865475*Ghat_r[0]*rdv2; 
  out[1] += 0.7071067811865475*Ghat_r[1]*rdv2; 
  out[2] += 0.7071067811865475*Ghat_r[2]*rdv2; 
  out[3] += 0.7071067811865475*Ghat_r[3]*rdv2; 
  out[4] += 1.224744871391589*Ghat_r[0]*rdv2; 
  out[5] += 0.7071067811865475*Ghat_r[4]*rdv2; 
  out[6] += 0.7071067811865475*Ghat_r[5]*rdv2; 
  out[7] += 0.7071067811865475*Ghat_r[6]*rdv2; 
  out[8] += 1.224744871391589*Ghat_r[1]*rdv2; 
  out[9] += 1.224744871391589*Ghat_r[2]*rdv2; 
  out[10] += 1.224744871391589*Ghat_r[3]*rdv2; 
  out[11] += 0.7071067811865475*Ghat_r[7]*rdv2; 
  out[12] += 1.224744871391589*Ghat_r[4]*rdv2; 
  out[13] += 1.224744871391589*Ghat_r[5]*rdv2; 
  out[14] += 1.224744871391589*Ghat_r[6]*rdv2; 
  out[15] += 1.224744871391589*Ghat_r[7]*rdv2; 
  out[16] += 0.7071067811865475*Ghat_r[8]*rdv2; 
  out[17] += 0.7071067811865475*Ghat_r[9]*rdv2; 
  out[18] += 0.7071067811865475*Ghat_r[10]*rdv2; 
  out[19] += 1.224744871391589*Ghat_r[8]*rdv2; 
  out[20] += 0.7071067811865475*Ghat_r[11]*rdv2; 
  out[21] += 1.224744871391589*Ghat_r[9]*rdv2; 
  out[22] += 1.224744871391589*Ghat_r[10]*rdv2; 
  out[23] += 1.224744871391589*Ghat_r[11]*rdv2; 

  } else { 

  double Ghat_l[12] = {0.0}; 
  Ghat_l[0] = ((-0.4330127018922194*(nvsqnu_skin[11]*fskin[23]+nvsqnu_skin[10]*fskin[22]+nvsqnu_skin[9]*fskin[21]))+0.25*nvsqnu_skin[11]*fskin[20]-0.4330127018922194*nvsqnu_skin[8]*fskin[19]+0.25*(nvsqnu_skin[10]*fskin[18]+nvsqnu_skin[9]*fskin[17]+nvsqnu_skin[8]*fskin[16])-0.4330127018922193*(nvsqnu_skin[7]*fskin[15]+nvsqnu_skin[6]*fskin[14]+nvsqnu_skin[5]*fskin[13]+nvsqnu_skin[4]*fskin[12])+0.25*nvsqnu_skin[7]*fskin[11]-0.4330127018922193*(nvsqnu_skin[3]*fskin[10]+nvsqnu_skin[2]*fskin[9]+nvsqnu_skin[1]*fskin[8])+0.25*(nvsqnu_skin[6]*fskin[7]+nvsqnu_skin[5]*fskin[6]+nvsqnu_skin[4]*fskin[5])-0.4330127018922193*nvsqnu_skin[0]*fskin[4]+0.25*(fskin[3]*nvsqnu_skin[3]+fskin[2]*nvsqnu_skin[2]+fskin[1]*nvsqnu_skin[1]+fskin[0]*nvsqnu_skin[0]))/vmap_prime_skin[1]; 
  Ghat_l[1] = ((-0.4330127018922193*(nvsqnu_skin[10]*fskin[23]+nvsqnu_skin[11]*fskin[22]+nvsqnu_skin[8]*fskin[21]))+0.2500000000000001*nvsqnu_skin[10]*fskin[20]-0.4330127018922193*nvsqnu_skin[9]*fskin[19]+0.2500000000000001*(nvsqnu_skin[11]*fskin[18]+nvsqnu_skin[8]*fskin[17]+nvsqnu_skin[9]*fskin[16])-0.4330127018922193*(nvsqnu_skin[6]*fskin[15]+nvsqnu_skin[7]*fskin[14]+nvsqnu_skin[3]*fskin[13]+nvsqnu_skin[2]*fskin[12])+0.25*nvsqnu_skin[6]*fskin[11]-0.4330127018922193*(nvsqnu_skin[5]*fskin[10]+nvsqnu_skin[4]*fskin[9]+nvsqnu_skin[0]*fskin[8])+0.25*(fskin[7]*nvsqnu_skin[7]+nvsqnu_skin[3]*fskin[6]+fskin[3]*nvsqnu_skin[5]+nvsqnu_skin[2]*fskin[5]+fskin[2]*nvsqnu_skin[4])-0.4330127018922193*nvsqnu_skin[1]*fskin[4]+0.25*(fskin[0]*nvsqnu_skin[1]+nvsqnu_skin[0]*fskin[1]))/vmap_prime_skin[1]; 
  Ghat_l[2] = ((-0.4330127018922193*(nvsqnu_skin[9]*fskin[23]+nvsqnu_skin[8]*fskin[22]+nvsqnu_skin[11]*fskin[21]))+0.2500000000000001*nvsqnu_skin[9]*fskin[20]-0.4330127018922193*nvsqnu_skin[10]*fskin[19]+0.2500000000000001*(nvsqnu_skin[8]*fskin[18]+nvsqnu_skin[11]*fskin[17]+nvsqnu_skin[10]*fskin[16])-0.4330127018922193*(nvsqnu_skin[5]*fskin[15]+nvsqnu_skin[3]*fskin[14]+nvsqnu_skin[7]*fskin[13]+nvsqnu_skin[1]*fskin[12])+0.25*nvsqnu_skin[5]*fskin[11]-0.4330127018922193*(nvsqnu_skin[6]*fskin[10]+nvsqnu_skin[0]*fskin[9]+nvsqnu_skin[4]*fskin[8])+0.25*(fskin[6]*nvsqnu_skin[7]+nvsqnu_skin[3]*fskin[7]+fskin[3]*nvsqnu_skin[6]+nvsqnu_skin[1]*fskin[5]+fskin[1]*nvsqnu_skin[4])-0.4330127018922193*nvsqnu_skin[2]*fskin[4]+0.25*(fskin[0]*nvsqnu_skin[2]+nvsqnu_skin[0]*fskin[2]))/vmap_prime_skin[1]; 
  Ghat_l[3] = ((-0.3872983346207417*nvsqnu_skin[7]*fskin[23])-0.3872983346207416*(nvsqnu_skin[6]*fskin[22]+nvsqnu_skin[5]*fskin[21])+0.223606797749979*nvsqnu_skin[7]*fskin[20]-0.3872983346207417*nvsqnu_skin[3]*fskin[19]+0.223606797749979*(nvsqnu_skin[6]*fskin[18]+nvsqnu_skin[5]*fskin[17])+0.223606797749979*nvsqnu_skin[3]*fskin[16]+((-0.3872983346207416*nvsqnu_skin[11])-0.4330127018922193*nvsqnu_skin[4])*fskin[15]+((-0.3872983346207417*nvsqnu_skin[10])-0.4330127018922193*nvsqnu_skin[2])*fskin[14]-0.3872983346207417*nvsqnu_skin[9]*fskin[13]-0.4330127018922193*(nvsqnu_skin[1]*fskin[13]+nvsqnu_skin[7]*fskin[12])+fskin[11]*(0.223606797749979*nvsqnu_skin[11]+0.25*nvsqnu_skin[4])+0.223606797749979*fskin[7]*nvsqnu_skin[10]+((-0.3872983346207416*nvsqnu_skin[8])-0.4330127018922193*nvsqnu_skin[0])*fskin[10]+0.223606797749979*fskin[6]*nvsqnu_skin[9]-0.4330127018922193*nvsqnu_skin[6]*fskin[9]+0.223606797749979*fskin[3]*nvsqnu_skin[8]-0.4330127018922193*nvsqnu_skin[5]*fskin[8]+0.25*(fskin[5]*nvsqnu_skin[7]+nvsqnu_skin[2]*fskin[7]+fskin[2]*nvsqnu_skin[6]+nvsqnu_skin[1]*fskin[6]+fskin[1]*nvsqnu_skin[5])-0.4330127018922193*nvsqnu_skin[3]*fskin[4]+0.25*(fskin[0]*nvsqnu_skin[3]+nvsqnu_skin[0]*fskin[3]))/vmap_prime_skin[1]; 
  Ghat_l[4] = ((-0.4330127018922194*(nvsqnu_skin[8]*fskin[23]+nvsqnu_skin[9]*fskin[22]+nvsqnu_skin[10]*fskin[21]))+0.25*nvsqnu_skin[8]*fskin[20]-0.4330127018922194*nvsqnu_skin[11]*fskin[19]+0.25*(nvsqnu_skin[9]*fskin[18]+nvsqnu_skin[10]*fskin[17]+nvsqnu_skin[11]*fskin[16])-0.4330127018922193*(nvsqnu_skin[3]*fskin[15]+nvsqnu_skin[5]*fskin[14]+nvsqnu_skin[6]*fskin[13]+nvsqnu_skin[0]*fskin[12])+0.25*nvsqnu_skin[3]*fskin[11]-0.4330127018922193*(nvsqnu_skin[7]*fskin[10]+nvsqnu_skin[1]*fskin[9]+nvsqnu_skin[2]*fskin[8])+0.25*(fskin[3]*nvsqnu_skin[7]+nvsqnu_skin[5]*fskin[7]+fskin[6]*nvsqnu_skin[6]+nvsqnu_skin[0]*fskin[5])-0.4330127018922193*fskin[4]*nvsqnu_skin[4]+0.25*(fskin[0]*nvsqnu_skin[4]+fskin[1]*nvsqnu_skin[2]+nvsqnu_skin[1]*fskin[2]))/vmap_prime_skin[1]; 
  Ghat_l[5] = ((-0.3872983346207417*nvsqnu_skin[6]*fskin[23])-0.3872983346207416*(nvsqnu_skin[7]*fskin[22]+nvsqnu_skin[3]*fskin[21])+0.223606797749979*nvsqnu_skin[6]*fskin[20]-0.3872983346207417*nvsqnu_skin[5]*fskin[19]+0.223606797749979*(nvsqnu_skin[7]*fskin[18]+nvsqnu_skin[3]*fskin[17])+0.223606797749979*nvsqnu_skin[5]*fskin[16]+((-0.3872983346207417*nvsqnu_skin[10])-0.4330127018922193*nvsqnu_skin[2])*fskin[15]+((-0.3872983346207416*nvsqnu_skin[11])-0.4330127018922193*nvsqnu_skin[4])*fskin[14]-0.3872983346207416*nvsqnu_skin[8]*fskin[13]-0.4330127018922193*(nvsqnu_skin[0]*fskin[13]+nvsqnu_skin[6]*fskin[12])+0.223606797749979*fskin[7]*nvsqnu_skin[11]+(0.223606797749979*nvsqnu_skin[10]+0.25*nvsqnu_skin[2])*fskin[11]+((-0.3872983346207417*nvsqnu_skin[9])-0.4330127018922193*nvsqnu_skin[1])*fskin[10]+0.223606797749979*fskin[3]*nvsqnu_skin[9]-0.4330127018922193*nvsqnu_skin[7]*fskin[9]+0.223606797749979*fskin[6]*nvsqnu_skin[8]-0.4330127018922193*nvsqnu_skin[3]*fskin[8]+0.25*(fskin[2]*nvsqnu_skin[7]+nvsqnu_skin[4]*fskin[7]+fskin[5]*nvsqnu_skin[6]+nvsqnu_skin[0]*fskin[6])-0.4330127018922193*fskin[4]*nvsqnu_skin[5]+0.25*(fskin[0]*nvsqnu_skin[5]+fskin[1]*nvsqnu_skin[3]+nvsqnu_skin[1]*fskin[3]))/vmap_prime_skin[1]; 
  Ghat_l[6] = ((-0.3872983346207417*nvsqnu_skin[5]*fskin[23])-0.3872983346207416*(nvsqnu_skin[3]*fskin[22]+nvsqnu_skin[7]*fskin[21])+0.223606797749979*nvsqnu_skin[5]*fskin[20]-0.3872983346207417*nvsqnu_skin[6]*fskin[19]+0.223606797749979*(nvsqnu_skin[3]*fskin[18]+nvsqnu_skin[7]*fskin[17])+0.223606797749979*nvsqnu_skin[6]*fskin[16]+((-0.3872983346207417*nvsqnu_skin[9])-0.4330127018922193*nvsqnu_skin[1])*fskin[15]+((-0.3872983346207416*nvsqnu_skin[8])-0.4330127018922193*nvsqnu_skin[0])*fskin[14]-0.3872983346207416*nvsqnu_skin[11]*fskin[13]-0.4330127018922193*(nvsqnu_skin[4]*fskin[13]+nvsqnu_skin[5]*fskin[12])+0.223606797749979*fskin[6]*nvsqnu_skin[11]+(0.223606797749979*nvsqnu_skin[9]+0.25*nvsqnu_skin[1])*fskin[11]+(0.223606797749979*fskin[3]-0.3872983346207417*fskin[10])*nvsqnu_skin[10]-0.4330127018922193*(nvsqnu_skin[2]*fskin[10]+nvsqnu_skin[3]*fskin[9])+0.223606797749979*fskin[7]*nvsqnu_skin[8]-0.4330127018922193*nvsqnu_skin[7]*fskin[8]+0.25*(fskin[1]*nvsqnu_skin[7]+nvsqnu_skin[0]*fskin[7])-0.4330127018922193*fskin[4]*nvsqnu_skin[6]+0.25*(fskin[0]*nvsqnu_skin[6]+nvsqnu_skin[4]*fskin[6]+fskin[5]*nvsqnu_skin[5]+fskin[2]*nvsqnu_skin[3]+nvsqnu_skin[2]*fskin[3]))/vmap_prime_skin[1]; 
  Ghat_l[7] = ((-0.3872983346207417*nvsqnu_skin[3]*fskin[23])-0.3872983346207416*(nvsqnu_skin[5]*fskin[22]+nvsqnu_skin[6]*fskin[21])+0.223606797749979*nvsqnu_skin[3]*fskin[20]-0.3872983346207417*nvsqnu_skin[7]*fskin[19]+0.223606797749979*(nvsqnu_skin[5]*fskin[18]+nvsqnu_skin[6]*fskin[17])+0.223606797749979*nvsqnu_skin[7]*fskin[16]+((-0.3872983346207416*nvsqnu_skin[8])-0.4330127018922193*nvsqnu_skin[0])*fskin[15]+((-0.3872983346207417*nvsqnu_skin[9])-0.4330127018922193*nvsqnu_skin[1])*fskin[14]-0.3872983346207417*nvsqnu_skin[10]*fskin[13]-0.4330127018922193*(nvsqnu_skin[2]*fskin[13]+nvsqnu_skin[3]*fskin[12])+(0.223606797749979*fskin[3]-0.3872983346207416*fskin[10])*nvsqnu_skin[11]+(0.223606797749979*nvsqnu_skin[8]+0.25*nvsqnu_skin[0])*fskin[11]+0.223606797749979*fskin[6]*nvsqnu_skin[10]-0.4330127018922193*nvsqnu_skin[4]*fskin[10]+0.223606797749979*fskin[7]*nvsqnu_skin[9]-0.4330127018922193*(nvsqnu_skin[5]*fskin[9]+nvsqnu_skin[6]*fskin[8]+fskin[4]*nvsqnu_skin[7])+0.25*(fskin[0]*nvsqnu_skin[7]+nvsqnu_skin[1]*fskin[7]+fskin[1]*nvsqnu_skin[6]+nvsqnu_skin[2]*fskin[6]+fskin[2]*nvsqnu_skin[5]+nvsqnu_skin[3]*fskin[5]+fskin[3]*nvsqnu_skin[4]))/vmap_prime_skin[1]; 
  Ghat_l[8] = (((-0.276641667586244*nvsqnu_skin[11])-0.4330127018922194*nvsqnu_skin[4])*fskin[23]+((-0.276641667586244*nvsqnu_skin[10])-0.4330127018922193*nvsqnu_skin[2])*fskin[22]+((-0.276641667586244*nvsqnu_skin[9])-0.4330127018922193*nvsqnu_skin[1])*fskin[21]+(0.159719141249985*nvsqnu_skin[11]+0.25*nvsqnu_skin[4])*fskin[20]+((-0.276641667586244*nvsqnu_skin[8])-0.4330127018922194*nvsqnu_skin[0])*fskin[19]+(0.159719141249985*nvsqnu_skin[10]+0.2500000000000001*nvsqnu_skin[2])*fskin[18]+(0.159719141249985*nvsqnu_skin[9]+0.2500000000000001*nvsqnu_skin[1])*fskin[17]+(0.159719141249985*nvsqnu_skin[8]+0.25*nvsqnu_skin[0])*fskin[16]-0.3872983346207416*(nvsqnu_skin[7]*fskin[15]+nvsqnu_skin[6]*fskin[14]+nvsqnu_skin[5]*fskin[13])+nvsqnu_skin[11]*(0.25*fskin[5]-0.4330127018922193*fskin[12])+0.223606797749979*nvsqnu_skin[7]*fskin[11]+(0.2500000000000001*fskin[2]-0.4330127018922194*fskin[9])*nvsqnu_skin[10]-0.3872983346207416*nvsqnu_skin[3]*fskin[10]+(0.2500000000000001*fskin[1]-0.4330127018922194*fskin[8])*nvsqnu_skin[9]+(0.25*fskin[0]-0.4330127018922193*fskin[4])*nvsqnu_skin[8]+0.223606797749979*(nvsqnu_skin[6]*fskin[7]+nvsqnu_skin[5]*fskin[6]+fskin[3]*nvsqnu_skin[3]))/vmap_prime_skin[1]; 
  Ghat_l[9] = (((-0.276641667586244*nvsqnu_skin[10])-0.4330127018922193*nvsqnu_skin[2])*fskin[23]+((-0.276641667586244*nvsqnu_skin[11])-0.4330127018922194*nvsqnu_skin[4])*fskin[22]+((-0.276641667586244*nvsqnu_skin[8])-0.4330127018922194*nvsqnu_skin[0])*fskin[21]+(0.159719141249985*nvsqnu_skin[10]+0.2500000000000001*nvsqnu_skin[2])*fskin[20]+((-0.276641667586244*nvsqnu_skin[9])-0.4330127018922193*nvsqnu_skin[1])*fskin[19]+(0.159719141249985*nvsqnu_skin[11]+0.25*nvsqnu_skin[4])*fskin[18]+(0.159719141249985*nvsqnu_skin[8]+0.25*nvsqnu_skin[0])*fskin[17]+(0.159719141249985*nvsqnu_skin[9]+0.2500000000000001*nvsqnu_skin[1])*fskin[16]-0.3872983346207417*(nvsqnu_skin[6]*fskin[15]+nvsqnu_skin[7]*fskin[14]+nvsqnu_skin[3]*fskin[13])-0.4330127018922193*nvsqnu_skin[10]*fskin[12]+(0.2500000000000001*fskin[2]-0.4330127018922194*fskin[9])*nvsqnu_skin[11]+0.223606797749979*nvsqnu_skin[6]*fskin[11]+0.25*fskin[5]*nvsqnu_skin[10]-0.3872983346207417*nvsqnu_skin[5]*fskin[10]+(0.25*fskin[0]-0.4330127018922193*fskin[4])*nvsqnu_skin[9]+(0.2500000000000001*fskin[1]-0.4330127018922194*fskin[8])*nvsqnu_skin[8]+0.223606797749979*(fskin[7]*nvsqnu_skin[7]+nvsqnu_skin[3]*fskin[6]+fskin[3]*nvsqnu_skin[5]))/vmap_prime_skin[1]; 
  Ghat_l[10] = (((-0.276641667586244*nvsqnu_skin[9])-0.4330127018922193*nvsqnu_skin[1])*fskin[23]+((-0.276641667586244*nvsqnu_skin[8])-0.4330127018922194*nvsqnu_skin[0])*fskin[22]+((-0.276641667586244*nvsqnu_skin[11])-0.4330127018922194*nvsqnu_skin[4])*fskin[21]+(0.159719141249985*nvsqnu_skin[9]+0.2500000000000001*nvsqnu_skin[1])*fskin[20]+((-0.276641667586244*nvsqnu_skin[10])-0.4330127018922193*nvsqnu_skin[2])*fskin[19]+(0.159719141249985*nvsqnu_skin[8]+0.25*nvsqnu_skin[0])*fskin[18]+(0.159719141249985*nvsqnu_skin[11]+0.25*nvsqnu_skin[4])*fskin[17]+(0.159719141249985*nvsqnu_skin[10]+0.2500000000000001*nvsqnu_skin[2])*fskin[16]-0.3872983346207417*(nvsqnu_skin[5]*fskin[15]+nvsqnu_skin[3]*fskin[14]+nvsqnu_skin[7]*fskin[13])-0.4330127018922193*nvsqnu_skin[9]*fskin[12]+(0.2500000000000001*fskin[1]-0.4330127018922194*fskin[8])*nvsqnu_skin[11]+0.223606797749979*nvsqnu_skin[5]*fskin[11]+(0.25*fskin[0]-0.4330127018922193*fskin[4])*nvsqnu_skin[10]-0.3872983346207417*nvsqnu_skin[6]*fskin[10]+0.25*fskin[5]*nvsqnu_skin[9]+nvsqnu_skin[8]*(0.2500000000000001*fskin[2]-0.4330127018922194*fskin[9])+0.223606797749979*(fskin[6]*nvsqnu_skin[7]+nvsqnu_skin[3]*fskin[7]+fskin[3]*nvsqnu_skin[6]))/vmap_prime_skin[1]; 
  Ghat_l[11] = (((-0.276641667586244*nvsqnu_skin[8])-0.4330127018922194*nvsqnu_skin[0])*fskin[23]+((-0.276641667586244*nvsqnu_skin[9])-0.4330127018922193*nvsqnu_skin[1])*fskin[22]+((-0.276641667586244*nvsqnu_skin[10])-0.4330127018922193*nvsqnu_skin[2])*fskin[21]+(0.159719141249985*nvsqnu_skin[8]+0.25*nvsqnu_skin[0])*fskin[20]+((-0.276641667586244*nvsqnu_skin[11])-0.4330127018922194*nvsqnu_skin[4])*fskin[19]+(0.159719141249985*nvsqnu_skin[9]+0.2500000000000001*nvsqnu_skin[1])*fskin[18]+(0.159719141249985*nvsqnu_skin[10]+0.2500000000000001*nvsqnu_skin[2])*fskin[17]+(0.159719141249985*nvsqnu_skin[11]+0.25*nvsqnu_skin[4])*fskin[16]-0.3872983346207416*(nvsqnu_skin[3]*fskin[15]+nvsqnu_skin[5]*fskin[14]+nvsqnu_skin[6]*fskin[13])-0.4330127018922193*nvsqnu_skin[8]*fskin[12]+(0.25*fskin[0]-0.4330127018922193*fskin[4])*nvsqnu_skin[11]+0.223606797749979*nvsqnu_skin[3]*fskin[11]+(0.2500000000000001*fskin[1]-0.4330127018922194*fskin[8])*nvsqnu_skin[10]-0.3872983346207416*nvsqnu_skin[7]*fskin[10]+(0.2500000000000001*fskin[2]-0.4330127018922194*fskin[9])*nvsqnu_skin[9]+0.25*fskin[5]*nvsqnu_skin[8]+0.223606797749979*(fskin[3]*nvsqnu_skin[7]+nvsqnu_skin[5]*fskin[7]+fskin[6]*nvsqnu_skin[6]))/vmap_prime_skin[1]; 

  out[0] += -0.7071067811865475*Ghat_l[0]*rdv2; 
  out[1] += -0.7071067811865475*Ghat_l[1]*rdv2; 
  out[2] += -0.7071067811865475*Ghat_l[2]*rdv2; 
  out[3] += -0.7071067811865475*Ghat_l[3]*rdv2; 
  out[4] += 1.224744871391589*Ghat_l[0]*rdv2; 
  out[5] += -0.7071067811865475*Ghat_l[4]*rdv2; 
  out[6] += -0.7071067811865475*Ghat_l[5]*rdv2; 
  out[7] += -0.7071067811865475*Ghat_l[6]*rdv2; 
  out[8] += 1.224744871391589*Ghat_l[1]*rdv2; 
  out[9] += 1.224744871391589*Ghat_l[2]*rdv2; 
  out[10] += 1.224744871391589*Ghat_l[3]*rdv2; 
  out[11] += -0.7071067811865475*Ghat_l[7]*rdv2; 
  out[12] += 1.224744871391589*Ghat_l[4]*rdv2; 
  out[13] += 1.224744871391589*Ghat_l[5]*rdv2; 
  out[14] += 1.224744871391589*Ghat_l[6]*rdv2; 
  out[15] += 1.224744871391589*Ghat_l[7]*rdv2; 
  out[16] += -0.7071067811865475*Ghat_l[8]*rdv2; 
  out[17] += -0.7071067811865475*Ghat_l[9]*rdv2; 
  out[18] += -0.7071067811865475*Ghat_l[10]*rdv2; 
  out[19] += 1.224744871391589*Ghat_l[8]*rdv2; 
  out[20] += -0.7071067811865475*Ghat_l[11]*rdv2; 
  out[21] += 1.224744871391589*Ghat_l[9]*rdv2; 
  out[22] += 1.224744871391589*Ghat_l[10]*rdv2; 
  out[23] += 1.224744871391589*Ghat_l[11]*rdv2; 

  } 

  double vmap_prime_min = fmin(fabs(vmap_prime_edge[1]),fabs(vmap_prime_skin[1]));
  double cflFreq = fmax(fabs(nvsqnu_edge[0]/vmap_prime_min), fabs(nvsqnu_skin[0]/vmap_prime_min)); 
  return 0.8838834764831842*rdv2*cflFreq; 

} 
