#include <gkyl_positivity_shift_gyrokinetic_kernels.h> 
#include <math.h> 
#include <float.h> 

GKYL_CU_DH bool positivity_shift_gyrokinetic_shift_only_2x2v_ser_p1(double ffloor, double *distf) 
{ 
  // ffloor: Distribution function floor to shift to when f<0.
  // distf: distribution function.

  bool shifted = false;

  double fnod[24];
  fnod[0] = -(0.22360679774997894*distf[23])+0.22360679774997896*distf[22]+0.22360679774997896*distf[21]+0.22360679774997896*distf[20]-0.22360679774997894*distf[19]-0.22360679774997902*distf[18]-0.22360679774997902*distf[17]+0.22360679774997896*distf[16]+0.33541019662496846*distf[15]-0.33541019662496846*distf[14]-0.33541019662496846*distf[13]-0.25*distf[12]-0.33541019662496846*distf[11]+0.33541019662496846*distf[10]+0.25*distf[9]+0.25*distf[8]+0.33541019662496846*distf[7]+0.33541019662496846*distf[6]+0.25*distf[5]-0.25*distf[4]-0.33541019662496846*distf[3]-0.25*distf[2]-0.25*distf[1]+0.25*distf[0]; 
  fnod[1] = 0.2795084971874738*distf[23]-0.2795084971874737*distf[22]-0.2795084971874737*distf[21]-0.2795084971874737*distf[20]+0.2795084971874738*distf[19]+0.2795084971874738*distf[18]+0.2795084971874738*distf[17]-0.2795084971874737*distf[16]-0.25*distf[12]+0.25*distf[9]+0.25*distf[8]+0.25*distf[5]-0.25*distf[4]-0.25*distf[2]-0.25*distf[1]+0.25*distf[0]; 
  fnod[2] = -(0.22360679774997894*distf[23])+0.22360679774997896*distf[22]+0.22360679774997896*distf[21]+0.22360679774997896*distf[20]-0.22360679774997894*distf[19]-0.22360679774997902*distf[18]-0.22360679774997902*distf[17]+0.22360679774997896*distf[16]-0.33541019662496846*distf[15]+0.33541019662496846*distf[14]+0.33541019662496846*distf[13]-0.25*distf[12]+0.33541019662496846*distf[11]-0.33541019662496846*distf[10]+0.25*distf[9]+0.25*distf[8]-0.33541019662496846*distf[7]-0.33541019662496846*distf[6]+0.25*distf[5]-0.25*distf[4]+0.33541019662496846*distf[3]-0.25*distf[2]-0.25*distf[1]+0.25*distf[0]; 
  fnod[3] = 0.22360679774997894*distf[23]-0.22360679774997896*distf[22]-0.22360679774997896*distf[21]+0.22360679774997896*distf[20]+0.22360679774997894*distf[19]-0.22360679774997902*distf[18]-0.22360679774997902*distf[17]+0.22360679774997896*distf[16]-0.33541019662496846*distf[15]+0.33541019662496846*distf[14]+0.33541019662496846*distf[13]+0.25*distf[12]-0.33541019662496846*distf[11]-0.33541019662496846*distf[10]-0.25*distf[9]-0.25*distf[8]+0.33541019662496846*distf[7]+0.33541019662496846*distf[6]+0.25*distf[5]+0.25*distf[4]-0.33541019662496846*distf[3]-0.25*distf[2]-0.25*distf[1]+0.25*distf[0]; 
  fnod[4] = -(0.2795084971874738*distf[23])+0.2795084971874737*distf[22]+0.2795084971874737*distf[21]-0.2795084971874737*distf[20]-0.2795084971874738*distf[19]+0.2795084971874738*distf[18]+0.2795084971874738*distf[17]-0.2795084971874737*distf[16]+0.25*distf[12]-0.25*distf[9]-0.25*distf[8]+0.25*distf[5]+0.25*distf[4]-0.25*distf[2]-0.25*distf[1]+0.25*distf[0]; 
  fnod[5] = 0.22360679774997894*distf[23]-0.22360679774997896*distf[22]-0.22360679774997896*distf[21]+0.22360679774997896*distf[20]+0.22360679774997894*distf[19]-0.22360679774997902*distf[18]-0.22360679774997902*distf[17]+0.22360679774997896*distf[16]+0.33541019662496846*distf[15]-0.33541019662496846*distf[14]-0.33541019662496846*distf[13]+0.25*distf[12]+0.33541019662496846*distf[11]+0.33541019662496846*distf[10]-0.25*distf[9]-0.25*distf[8]-0.33541019662496846*distf[7]-0.33541019662496846*distf[6]+0.25*distf[5]+0.25*distf[4]+0.33541019662496846*distf[3]-0.25*distf[2]-0.25*distf[1]+0.25*distf[0]; 
  fnod[6] = 0.22360679774997894*distf[23]-0.22360679774997896*distf[22]+0.22360679774997896*distf[21]-0.22360679774997896*distf[20]-0.22360679774997894*distf[19]+0.22360679774997902*distf[18]-0.22360679774997902*distf[17]+0.22360679774997896*distf[16]-0.33541019662496846*distf[15]+0.33541019662496846*distf[14]-0.33541019662496846*distf[13]+0.25*distf[12]+0.33541019662496846*distf[11]+0.33541019662496846*distf[10]-0.25*distf[9]+0.25*distf[8]-0.33541019662496846*distf[7]+0.33541019662496846*distf[6]-0.25*distf[5]-0.25*distf[4]-0.33541019662496846*distf[3]+0.25*distf[2]-0.25*distf[1]+0.25*distf[0]; 
  fnod[7] = -(0.2795084971874738*distf[23])+0.2795084971874737*distf[22]-0.2795084971874737*distf[21]+0.2795084971874737*distf[20]+0.2795084971874738*distf[19]-0.2795084971874738*distf[18]+0.2795084971874738*distf[17]-0.2795084971874737*distf[16]+0.25*distf[12]-0.25*distf[9]+0.25*distf[8]-0.25*distf[5]-0.25*distf[4]+0.25*distf[2]-0.25*distf[1]+0.25*distf[0]; 
  fnod[8] = 0.22360679774997894*distf[23]-0.22360679774997896*distf[22]+0.22360679774997896*distf[21]-0.22360679774997896*distf[20]-0.22360679774997894*distf[19]+0.22360679774997902*distf[18]-0.22360679774997902*distf[17]+0.22360679774997896*distf[16]+0.33541019662496846*distf[15]-0.33541019662496846*distf[14]+0.33541019662496846*distf[13]+0.25*distf[12]-0.33541019662496846*distf[11]-0.33541019662496846*distf[10]-0.25*distf[9]+0.25*distf[8]+0.33541019662496846*distf[7]-0.33541019662496846*distf[6]-0.25*distf[5]-0.25*distf[4]+0.33541019662496846*distf[3]+0.25*distf[2]-0.25*distf[1]+0.25*distf[0]; 
  fnod[9] = -(0.22360679774997894*distf[23])+0.22360679774997896*distf[22]-0.22360679774997896*distf[21]-0.22360679774997896*distf[20]+0.22360679774997894*distf[19]+0.22360679774997902*distf[18]-0.22360679774997902*distf[17]+0.22360679774997896*distf[16]+0.33541019662496846*distf[15]-0.33541019662496846*distf[14]+0.33541019662496846*distf[13]-0.25*distf[12]+0.33541019662496846*distf[11]-0.33541019662496846*distf[10]+0.25*distf[9]-0.25*distf[8]-0.33541019662496846*distf[7]+0.33541019662496846*distf[6]-0.25*distf[5]+0.25*distf[4]-0.33541019662496846*distf[3]+0.25*distf[2]-0.25*distf[1]+0.25*distf[0]; 
  fnod[10] = 0.2795084971874738*distf[23]-0.2795084971874737*distf[22]+0.2795084971874737*distf[21]+0.2795084971874737*distf[20]-0.2795084971874738*distf[19]-0.2795084971874738*distf[18]+0.2795084971874738*distf[17]-0.2795084971874737*distf[16]-0.25*distf[12]+0.25*distf[9]-0.25*distf[8]-0.25*distf[5]+0.25*distf[4]+0.25*distf[2]-0.25*distf[1]+0.25*distf[0]; 
  fnod[11] = -(0.22360679774997894*distf[23])+0.22360679774997896*distf[22]-0.22360679774997896*distf[21]-0.22360679774997896*distf[20]+0.22360679774997894*distf[19]+0.22360679774997902*distf[18]-0.22360679774997902*distf[17]+0.22360679774997896*distf[16]-0.33541019662496846*distf[15]+0.33541019662496846*distf[14]-0.33541019662496846*distf[13]-0.25*distf[12]-0.33541019662496846*distf[11]+0.33541019662496846*distf[10]+0.25*distf[9]-0.25*distf[8]+0.33541019662496846*distf[7]-0.33541019662496846*distf[6]-0.25*distf[5]+0.25*distf[4]+0.33541019662496846*distf[3]+0.25*distf[2]-0.25*distf[1]+0.25*distf[0]; 
  fnod[12] = 0.22360679774997894*distf[23]+0.22360679774997896*distf[22]-0.22360679774997896*distf[21]-0.22360679774997896*distf[20]-0.22360679774997894*distf[19]-0.22360679774997902*distf[18]+0.22360679774997902*distf[17]+0.22360679774997896*distf[16]-0.33541019662496846*distf[15]-0.33541019662496846*distf[14]+0.33541019662496846*distf[13]+0.25*distf[12]+0.33541019662496846*distf[11]+0.33541019662496846*distf[10]+0.25*distf[9]-0.25*distf[8]+0.33541019662496846*distf[7]-0.33541019662496846*distf[6]-0.25*distf[5]-0.25*distf[4]-0.33541019662496846*distf[3]-0.25*distf[2]+0.25*distf[1]+0.25*distf[0]; 
  fnod[13] = -(0.2795084971874738*distf[23])-0.2795084971874737*distf[22]+0.2795084971874737*distf[21]+0.2795084971874737*distf[20]+0.2795084971874738*distf[19]+0.2795084971874738*distf[18]-0.2795084971874738*distf[17]-0.2795084971874737*distf[16]+0.25*distf[12]+0.25*distf[9]-0.25*distf[8]-0.25*distf[5]-0.25*distf[4]-0.25*distf[2]+0.25*distf[1]+0.25*distf[0]; 
  fnod[14] = 0.22360679774997894*distf[23]+0.22360679774997896*distf[22]-0.22360679774997896*distf[21]-0.22360679774997896*distf[20]-0.22360679774997894*distf[19]-0.22360679774997902*distf[18]+0.22360679774997902*distf[17]+0.22360679774997896*distf[16]+0.33541019662496846*distf[15]+0.33541019662496846*distf[14]-0.33541019662496846*distf[13]+0.25*distf[12]-0.33541019662496846*distf[11]-0.33541019662496846*distf[10]+0.25*distf[9]-0.25*distf[8]-0.33541019662496846*distf[7]+0.33541019662496846*distf[6]-0.25*distf[5]-0.25*distf[4]+0.33541019662496846*distf[3]-0.25*distf[2]+0.25*distf[1]+0.25*distf[0]; 
  fnod[15] = -(0.22360679774997894*distf[23])-0.22360679774997896*distf[22]+0.22360679774997896*distf[21]-0.22360679774997896*distf[20]+0.22360679774997894*distf[19]-0.22360679774997902*distf[18]+0.22360679774997902*distf[17]+0.22360679774997896*distf[16]+0.33541019662496846*distf[15]+0.33541019662496846*distf[14]-0.33541019662496846*distf[13]-0.25*distf[12]+0.33541019662496846*distf[11]-0.33541019662496846*distf[10]-0.25*distf[9]+0.25*distf[8]+0.33541019662496846*distf[7]-0.33541019662496846*distf[6]-0.25*distf[5]+0.25*distf[4]-0.33541019662496846*distf[3]-0.25*distf[2]+0.25*distf[1]+0.25*distf[0]; 
  fnod[16] = 0.2795084971874738*distf[23]+0.2795084971874737*distf[22]-0.2795084971874737*distf[21]+0.2795084971874737*distf[20]-0.2795084971874738*distf[19]+0.2795084971874738*distf[18]-0.2795084971874738*distf[17]-0.2795084971874737*distf[16]-0.25*distf[12]-0.25*distf[9]+0.25*distf[8]-0.25*distf[5]+0.25*distf[4]-0.25*distf[2]+0.25*distf[1]+0.25*distf[0]; 
  fnod[17] = -(0.22360679774997894*distf[23])-0.22360679774997896*distf[22]+0.22360679774997896*distf[21]-0.22360679774997896*distf[20]+0.22360679774997894*distf[19]-0.22360679774997902*distf[18]+0.22360679774997902*distf[17]+0.22360679774997896*distf[16]-0.33541019662496846*distf[15]-0.33541019662496846*distf[14]+0.33541019662496846*distf[13]-0.25*distf[12]-0.33541019662496846*distf[11]+0.33541019662496846*distf[10]-0.25*distf[9]+0.25*distf[8]-0.33541019662496846*distf[7]+0.33541019662496846*distf[6]-0.25*distf[5]+0.25*distf[4]+0.33541019662496846*distf[3]-0.25*distf[2]+0.25*distf[1]+0.25*distf[0]; 
  fnod[18] = -(0.22360679774997894*distf[23])-0.22360679774997896*distf[22]-0.22360679774997896*distf[21]+0.22360679774997896*distf[20]-0.22360679774997894*distf[19]+0.22360679774997902*distf[18]+0.22360679774997902*distf[17]+0.22360679774997896*distf[16]+0.33541019662496846*distf[15]+0.33541019662496846*distf[14]+0.33541019662496846*distf[13]-0.25*distf[12]-0.33541019662496846*distf[11]+0.33541019662496846*distf[10]-0.25*distf[9]-0.25*distf[8]-0.33541019662496846*distf[7]-0.33541019662496846*distf[6]+0.25*distf[5]-0.25*distf[4]-0.33541019662496846*distf[3]+0.25*distf[2]+0.25*distf[1]+0.25*distf[0]; 
  fnod[19] = 0.2795084971874738*distf[23]+0.2795084971874737*distf[22]+0.2795084971874737*distf[21]-0.2795084971874737*distf[20]+0.2795084971874738*distf[19]-0.2795084971874738*distf[18]-0.2795084971874738*distf[17]-0.2795084971874737*distf[16]-0.25*distf[12]-0.25*distf[9]-0.25*distf[8]+0.25*distf[5]-0.25*distf[4]+0.25*distf[2]+0.25*distf[1]+0.25*distf[0]; 
  fnod[20] = -(0.22360679774997894*distf[23])-0.22360679774997896*distf[22]-0.22360679774997896*distf[21]+0.22360679774997896*distf[20]-0.22360679774997894*distf[19]+0.22360679774997902*distf[18]+0.22360679774997902*distf[17]+0.22360679774997896*distf[16]-0.33541019662496846*distf[15]-0.33541019662496846*distf[14]-0.33541019662496846*distf[13]-0.25*distf[12]+0.33541019662496846*distf[11]-0.33541019662496846*distf[10]-0.25*distf[9]-0.25*distf[8]+0.33541019662496846*distf[7]+0.33541019662496846*distf[6]+0.25*distf[5]-0.25*distf[4]+0.33541019662496846*distf[3]+0.25*distf[2]+0.25*distf[1]+0.25*distf[0]; 
  fnod[21] = 0.22360679774997894*distf[23]+0.22360679774997896*distf[22]+0.22360679774997896*distf[21]+0.22360679774997896*distf[20]+0.22360679774997894*distf[19]+0.22360679774997902*distf[18]+0.22360679774997902*distf[17]+0.22360679774997896*distf[16]-0.33541019662496846*distf[15]-0.33541019662496846*distf[14]-0.33541019662496846*distf[13]+0.25*distf[12]-0.33541019662496846*distf[11]-0.33541019662496846*distf[10]+0.25*distf[9]+0.25*distf[8]-0.33541019662496846*distf[7]-0.33541019662496846*distf[6]+0.25*distf[5]+0.25*distf[4]-0.33541019662496846*distf[3]+0.25*distf[2]+0.25*distf[1]+0.25*distf[0]; 
  fnod[22] = -(0.2795084971874738*distf[23])-0.2795084971874737*distf[22]-0.2795084971874737*distf[21]-0.2795084971874737*distf[20]-0.2795084971874738*distf[19]-0.2795084971874738*distf[18]-0.2795084971874738*distf[17]-0.2795084971874737*distf[16]+0.25*distf[12]+0.25*distf[9]+0.25*distf[8]+0.25*distf[5]+0.25*distf[4]+0.25*distf[2]+0.25*distf[1]+0.25*distf[0]; 
  fnod[23] = 0.22360679774997894*distf[23]+0.22360679774997896*distf[22]+0.22360679774997896*distf[21]+0.22360679774997896*distf[20]+0.22360679774997894*distf[19]+0.22360679774997902*distf[18]+0.22360679774997902*distf[17]+0.22360679774997896*distf[16]+0.33541019662496846*distf[15]+0.33541019662496846*distf[14]+0.33541019662496846*distf[13]+0.25*distf[12]+0.33541019662496846*distf[11]+0.33541019662496846*distf[10]+0.25*distf[9]+0.25*distf[8]+0.33541019662496846*distf[7]+0.33541019662496846*distf[6]+0.25*distf[5]+0.25*distf[4]+0.33541019662496846*distf[3]+0.25*distf[2]+0.25*distf[1]+0.25*distf[0]; 

  // If f < 0. at check nodes, set it to ffloor.
  if (fnod[0] < 0.) {
    fnod[0] = ffloor;
    shifted = true;
  }
  if (fnod[1] < 0.) {
    fnod[1] = ffloor;
    shifted = true;
  }
  if (fnod[2] < 0.) {
    fnod[2] = ffloor;
    shifted = true;
  }
  if (fnod[3] < 0.) {
    fnod[3] = ffloor;
    shifted = true;
  }
  if (fnod[4] < 0.) {
    fnod[4] = ffloor;
    shifted = true;
  }
  if (fnod[5] < 0.) {
    fnod[5] = ffloor;
    shifted = true;
  }
  if (fnod[6] < 0.) {
    fnod[6] = ffloor;
    shifted = true;
  }
  if (fnod[7] < 0.) {
    fnod[7] = ffloor;
    shifted = true;
  }
  if (fnod[8] < 0.) {
    fnod[8] = ffloor;
    shifted = true;
  }
  if (fnod[9] < 0.) {
    fnod[9] = ffloor;
    shifted = true;
  }
  if (fnod[10] < 0.) {
    fnod[10] = ffloor;
    shifted = true;
  }
  if (fnod[11] < 0.) {
    fnod[11] = ffloor;
    shifted = true;
  }
  if (fnod[12] < 0.) {
    fnod[12] = ffloor;
    shifted = true;
  }
  if (fnod[13] < 0.) {
    fnod[13] = ffloor;
    shifted = true;
  }
  if (fnod[14] < 0.) {
    fnod[14] = ffloor;
    shifted = true;
  }
  if (fnod[15] < 0.) {
    fnod[15] = ffloor;
    shifted = true;
  }
  if (fnod[16] < 0.) {
    fnod[16] = ffloor;
    shifted = true;
  }
  if (fnod[17] < 0.) {
    fnod[17] = ffloor;
    shifted = true;
  }
  if (fnod[18] < 0.) {
    fnod[18] = ffloor;
    shifted = true;
  }
  if (fnod[19] < 0.) {
    fnod[19] = ffloor;
    shifted = true;
  }
  if (fnod[20] < 0.) {
    fnod[20] = ffloor;
    shifted = true;
  }
  if (fnod[21] < 0.) {
    fnod[21] = ffloor;
    shifted = true;
  }
  if (fnod[22] < 0.) {
    fnod[22] = ffloor;
    shifted = true;
  }
  if (fnod[23] < 0.) {
    fnod[23] = ffloor;
    shifted = true;
  }

  if (shifted) {
  distf[0] = 0.1388888888888889*fnod[23]+0.2222222222222222*fnod[22]+0.1388888888888889*fnod[21]+0.1388888888888889*fnod[20]+0.2222222222222222*fnod[19]+0.1388888888888889*fnod[18]+0.1388888888888889*fnod[17]+0.2222222222222222*fnod[16]+0.1388888888888889*fnod[15]+0.1388888888888889*fnod[14]+0.2222222222222222*fnod[13]+0.1388888888888889*fnod[12]+0.1388888888888889*fnod[11]+0.2222222222222222*fnod[10]+0.1388888888888889*fnod[9]+0.1388888888888889*fnod[8]+0.2222222222222222*fnod[7]+0.1388888888888889*fnod[6]+0.1388888888888889*fnod[5]+0.2222222222222222*fnod[4]+0.1388888888888889*fnod[3]+0.1388888888888889*fnod[2]+0.2222222222222222*fnod[1]+0.1388888888888889*fnod[0]; 
  distf[1] = 0.1388888888888889*fnod[23]+0.2222222222222222*fnod[22]+0.1388888888888889*fnod[21]+0.1388888888888889*fnod[20]+0.2222222222222222*fnod[19]+0.1388888888888889*fnod[18]+0.1388888888888889*fnod[17]+0.2222222222222222*fnod[16]+0.1388888888888889*fnod[15]+0.1388888888888889*fnod[14]+0.2222222222222222*fnod[13]+0.1388888888888889*fnod[12]-0.1388888888888889*fnod[11]-0.2222222222222222*fnod[10]-0.1388888888888889*fnod[9]-0.1388888888888889*fnod[8]-0.2222222222222222*fnod[7]-0.1388888888888889*fnod[6]-0.1388888888888889*fnod[5]-0.2222222222222222*fnod[4]-0.1388888888888889*fnod[3]-0.1388888888888889*fnod[2]-0.2222222222222222*fnod[1]-0.1388888888888889*fnod[0]; 
  distf[2] = 0.1388888888888889*fnod[23]+0.2222222222222222*fnod[22]+0.1388888888888889*fnod[21]+0.1388888888888889*fnod[20]+0.2222222222222222*fnod[19]+0.1388888888888889*fnod[18]-0.1388888888888889*fnod[17]-0.2222222222222222*fnod[16]-0.1388888888888889*fnod[15]-0.1388888888888889*fnod[14]-0.2222222222222222*fnod[13]-0.1388888888888889*fnod[12]+0.1388888888888889*fnod[11]+0.2222222222222222*fnod[10]+0.1388888888888889*fnod[9]+0.1388888888888889*fnod[8]+0.2222222222222222*fnod[7]+0.1388888888888889*fnod[6]-0.1388888888888889*fnod[5]-0.2222222222222222*fnod[4]-0.1388888888888889*fnod[3]-0.1388888888888889*fnod[2]-0.2222222222222222*fnod[1]-0.1388888888888889*fnod[0]; 
  distf[3] = 0.18633899812498247*fnod[23]-0.18633899812498247*fnod[21]+0.18633899812498247*fnod[20]-0.18633899812498247*fnod[18]+0.18633899812498247*fnod[17]-0.18633899812498247*fnod[15]+0.18633899812498247*fnod[14]-0.18633899812498247*fnod[12]+0.18633899812498247*fnod[11]-0.18633899812498247*fnod[9]+0.18633899812498247*fnod[8]-0.18633899812498247*fnod[6]+0.18633899812498247*fnod[5]-0.18633899812498247*fnod[3]+0.18633899812498247*fnod[2]-0.18633899812498247*fnod[0]; 
  distf[4] = 0.1388888888888889*fnod[23]+0.2222222222222222*fnod[22]+0.1388888888888889*fnod[21]-0.1388888888888889*fnod[20]-0.2222222222222222*fnod[19]-0.1388888888888889*fnod[18]+0.1388888888888889*fnod[17]+0.2222222222222222*fnod[16]+0.1388888888888889*fnod[15]-0.1388888888888889*fnod[14]-0.2222222222222222*fnod[13]-0.1388888888888889*fnod[12]+0.1388888888888889*fnod[11]+0.2222222222222222*fnod[10]+0.1388888888888889*fnod[9]-0.1388888888888889*fnod[8]-0.2222222222222222*fnod[7]-0.1388888888888889*fnod[6]+0.1388888888888889*fnod[5]+0.2222222222222222*fnod[4]+0.1388888888888889*fnod[3]-0.1388888888888889*fnod[2]-0.2222222222222222*fnod[1]-0.1388888888888889*fnod[0]; 
  distf[5] = 0.1388888888888889*fnod[23]+0.2222222222222222*fnod[22]+0.1388888888888889*fnod[21]+0.1388888888888889*fnod[20]+0.2222222222222222*fnod[19]+0.1388888888888889*fnod[18]-0.1388888888888889*fnod[17]-0.2222222222222222*fnod[16]-0.1388888888888889*fnod[15]-0.1388888888888889*fnod[14]-0.2222222222222222*fnod[13]-0.1388888888888889*fnod[12]-0.1388888888888889*fnod[11]-0.2222222222222222*fnod[10]-0.1388888888888889*fnod[9]-0.1388888888888889*fnod[8]-0.2222222222222222*fnod[7]-0.1388888888888889*fnod[6]+0.1388888888888889*fnod[5]+0.2222222222222222*fnod[4]+0.1388888888888889*fnod[3]+0.1388888888888889*fnod[2]+0.2222222222222222*fnod[1]+0.1388888888888889*fnod[0]; 
  distf[6] = 0.18633899812498247*fnod[23]-0.18633899812498247*fnod[21]+0.18633899812498247*fnod[20]-0.18633899812498247*fnod[18]+0.18633899812498247*fnod[17]-0.18633899812498247*fnod[15]+0.18633899812498247*fnod[14]-0.18633899812498247*fnod[12]-0.18633899812498247*fnod[11]+0.18633899812498247*fnod[9]-0.18633899812498247*fnod[8]+0.18633899812498247*fnod[6]-0.18633899812498247*fnod[5]+0.18633899812498247*fnod[3]-0.18633899812498247*fnod[2]+0.18633899812498247*fnod[0]; 
  distf[7] = 0.18633899812498247*fnod[23]-0.18633899812498247*fnod[21]+0.18633899812498247*fnod[20]-0.18633899812498247*fnod[18]-0.18633899812498247*fnod[17]+0.18633899812498247*fnod[15]-0.18633899812498247*fnod[14]+0.18633899812498247*fnod[12]+0.18633899812498247*fnod[11]-0.18633899812498247*fnod[9]+0.18633899812498247*fnod[8]-0.18633899812498247*fnod[6]-0.18633899812498247*fnod[5]+0.18633899812498247*fnod[3]-0.18633899812498247*fnod[2]+0.18633899812498247*fnod[0]; 
  distf[8] = 0.1388888888888889*fnod[23]+0.2222222222222222*fnod[22]+0.1388888888888889*fnod[21]-0.1388888888888889*fnod[20]-0.2222222222222222*fnod[19]-0.1388888888888889*fnod[18]+0.1388888888888889*fnod[17]+0.2222222222222222*fnod[16]+0.1388888888888889*fnod[15]-0.1388888888888889*fnod[14]-0.2222222222222222*fnod[13]-0.1388888888888889*fnod[12]-0.1388888888888889*fnod[11]-0.2222222222222222*fnod[10]-0.1388888888888889*fnod[9]+0.1388888888888889*fnod[8]+0.2222222222222222*fnod[7]+0.1388888888888889*fnod[6]-0.1388888888888889*fnod[5]-0.2222222222222222*fnod[4]-0.1388888888888889*fnod[3]+0.1388888888888889*fnod[2]+0.2222222222222222*fnod[1]+0.1388888888888889*fnod[0]; 
  distf[9] = 0.1388888888888889*fnod[23]+0.2222222222222222*fnod[22]+0.1388888888888889*fnod[21]-0.1388888888888889*fnod[20]-0.2222222222222222*fnod[19]-0.1388888888888889*fnod[18]-0.1388888888888889*fnod[17]-0.2222222222222222*fnod[16]-0.1388888888888889*fnod[15]+0.1388888888888889*fnod[14]+0.2222222222222222*fnod[13]+0.1388888888888889*fnod[12]+0.1388888888888889*fnod[11]+0.2222222222222222*fnod[10]+0.1388888888888889*fnod[9]-0.1388888888888889*fnod[8]-0.2222222222222222*fnod[7]-0.1388888888888889*fnod[6]-0.1388888888888889*fnod[5]-0.2222222222222222*fnod[4]-0.1388888888888889*fnod[3]+0.1388888888888889*fnod[2]+0.2222222222222222*fnod[1]+0.1388888888888889*fnod[0]; 
  distf[10] = 0.18633899812498247*fnod[23]-0.18633899812498247*fnod[21]-0.18633899812498247*fnod[20]+0.18633899812498247*fnod[18]+0.18633899812498247*fnod[17]-0.18633899812498247*fnod[15]-0.18633899812498247*fnod[14]+0.18633899812498247*fnod[12]+0.18633899812498247*fnod[11]-0.18633899812498247*fnod[9]-0.18633899812498247*fnod[8]+0.18633899812498247*fnod[6]+0.18633899812498247*fnod[5]-0.18633899812498247*fnod[3]-0.18633899812498247*fnod[2]+0.18633899812498247*fnod[0]; 
  distf[11] = 0.18633899812498247*fnod[23]-0.18633899812498247*fnod[21]+0.18633899812498247*fnod[20]-0.18633899812498247*fnod[18]-0.18633899812498247*fnod[17]+0.18633899812498247*fnod[15]-0.18633899812498247*fnod[14]+0.18633899812498247*fnod[12]-0.18633899812498247*fnod[11]+0.18633899812498247*fnod[9]-0.18633899812498247*fnod[8]+0.18633899812498247*fnod[6]+0.18633899812498247*fnod[5]-0.18633899812498247*fnod[3]+0.18633899812498247*fnod[2]-0.18633899812498247*fnod[0]; 
  distf[12] = 0.1388888888888889*fnod[23]+0.2222222222222222*fnod[22]+0.1388888888888889*fnod[21]-0.1388888888888889*fnod[20]-0.2222222222222222*fnod[19]-0.1388888888888889*fnod[18]-0.1388888888888889*fnod[17]-0.2222222222222222*fnod[16]-0.1388888888888889*fnod[15]+0.1388888888888889*fnod[14]+0.2222222222222222*fnod[13]+0.1388888888888889*fnod[12]-0.1388888888888889*fnod[11]-0.2222222222222222*fnod[10]-0.1388888888888889*fnod[9]+0.1388888888888889*fnod[8]+0.2222222222222222*fnod[7]+0.1388888888888889*fnod[6]+0.1388888888888889*fnod[5]+0.2222222222222222*fnod[4]+0.1388888888888889*fnod[3]-0.1388888888888889*fnod[2]-0.2222222222222222*fnod[1]-0.1388888888888889*fnod[0]; 
  distf[13] = 0.18633899812498247*fnod[23]-0.18633899812498247*fnod[21]-0.18633899812498247*fnod[20]+0.18633899812498247*fnod[18]+0.18633899812498247*fnod[17]-0.18633899812498247*fnod[15]-0.18633899812498247*fnod[14]+0.18633899812498247*fnod[12]-0.18633899812498247*fnod[11]+0.18633899812498247*fnod[9]+0.18633899812498247*fnod[8]-0.18633899812498247*fnod[6]-0.18633899812498247*fnod[5]+0.18633899812498247*fnod[3]+0.18633899812498247*fnod[2]-0.18633899812498247*fnod[0]; 
  distf[14] = 0.18633899812498247*fnod[23]-0.18633899812498247*fnod[21]-0.18633899812498247*fnod[20]+0.18633899812498247*fnod[18]-0.18633899812498247*fnod[17]+0.18633899812498247*fnod[15]+0.18633899812498247*fnod[14]-0.18633899812498247*fnod[12]+0.18633899812498247*fnod[11]-0.18633899812498247*fnod[9]-0.18633899812498247*fnod[8]+0.18633899812498247*fnod[6]-0.18633899812498247*fnod[5]+0.18633899812498247*fnod[3]+0.18633899812498247*fnod[2]-0.18633899812498247*fnod[0]; 
  distf[15] = 0.18633899812498247*fnod[23]-0.18633899812498247*fnod[21]-0.18633899812498247*fnod[20]+0.18633899812498247*fnod[18]-0.18633899812498247*fnod[17]+0.18633899812498247*fnod[15]+0.18633899812498247*fnod[14]-0.18633899812498247*fnod[12]-0.18633899812498247*fnod[11]+0.18633899812498247*fnod[9]+0.18633899812498247*fnod[8]-0.18633899812498247*fnod[6]+0.18633899812498247*fnod[5]-0.18633899812498247*fnod[3]-0.18633899812498247*fnod[2]+0.18633899812498247*fnod[0]; 
  distf[16] = 0.12422599874998831*fnod[23]-0.24845199749997662*fnod[22]+0.12422599874998831*fnod[21]+0.12422599874998831*fnod[20]-0.24845199749997662*fnod[19]+0.12422599874998831*fnod[18]+0.12422599874998831*fnod[17]-0.24845199749997662*fnod[16]+0.12422599874998831*fnod[15]+0.12422599874998831*fnod[14]-0.24845199749997662*fnod[13]+0.12422599874998831*fnod[12]+0.12422599874998831*fnod[11]-0.24845199749997662*fnod[10]+0.12422599874998831*fnod[9]+0.12422599874998831*fnod[8]-0.24845199749997662*fnod[7]+0.12422599874998831*fnod[6]+0.12422599874998831*fnod[5]-0.24845199749997662*fnod[4]+0.12422599874998831*fnod[3]+0.12422599874998831*fnod[2]-0.24845199749997662*fnod[1]+0.12422599874998831*fnod[0]; 
  distf[17] = 0.12422599874998837*fnod[23]-0.24845199749997673*fnod[22]+0.12422599874998837*fnod[21]+0.12422599874998837*fnod[20]-0.24845199749997673*fnod[19]+0.12422599874998837*fnod[18]+0.12422599874998837*fnod[17]-0.24845199749997673*fnod[16]+0.12422599874998837*fnod[15]+0.12422599874998837*fnod[14]-0.24845199749997673*fnod[13]+0.12422599874998837*fnod[12]-0.12422599874998837*fnod[11]+0.24845199749997673*fnod[10]-0.12422599874998837*fnod[9]-0.12422599874998837*fnod[8]+0.24845199749997673*fnod[7]-0.12422599874998837*fnod[6]-0.12422599874998837*fnod[5]+0.24845199749997673*fnod[4]-0.12422599874998837*fnod[3]-0.12422599874998837*fnod[2]+0.24845199749997673*fnod[1]-0.12422599874998837*fnod[0]; 
  distf[18] = 0.12422599874998837*fnod[23]-0.24845199749997673*fnod[22]+0.12422599874998837*fnod[21]+0.12422599874998837*fnod[20]-0.24845199749997673*fnod[19]+0.12422599874998837*fnod[18]-0.12422599874998837*fnod[17]+0.24845199749997673*fnod[16]-0.12422599874998837*fnod[15]-0.12422599874998837*fnod[14]+0.24845199749997673*fnod[13]-0.12422599874998837*fnod[12]+0.12422599874998837*fnod[11]-0.24845199749997673*fnod[10]+0.12422599874998837*fnod[9]+0.12422599874998837*fnod[8]-0.24845199749997673*fnod[7]+0.12422599874998837*fnod[6]-0.12422599874998837*fnod[5]+0.24845199749997673*fnod[4]-0.12422599874998837*fnod[3]-0.12422599874998837*fnod[2]+0.24845199749997673*fnod[1]-0.12422599874998837*fnod[0]; 
  distf[19] = 0.12422599874998837*fnod[23]-0.24845199749997673*fnod[22]+0.12422599874998837*fnod[21]-0.12422599874998837*fnod[20]+0.24845199749997673*fnod[19]-0.12422599874998837*fnod[18]+0.12422599874998837*fnod[17]-0.24845199749997673*fnod[16]+0.12422599874998837*fnod[15]-0.12422599874998837*fnod[14]+0.24845199749997673*fnod[13]-0.12422599874998837*fnod[12]+0.12422599874998837*fnod[11]-0.24845199749997673*fnod[10]+0.12422599874998837*fnod[9]-0.12422599874998837*fnod[8]+0.24845199749997673*fnod[7]-0.12422599874998837*fnod[6]+0.12422599874998837*fnod[5]-0.24845199749997673*fnod[4]+0.12422599874998837*fnod[3]-0.12422599874998837*fnod[2]+0.24845199749997673*fnod[1]-0.12422599874998837*fnod[0]; 
  distf[20] = 0.12422599874998831*fnod[23]-0.24845199749997662*fnod[22]+0.12422599874998831*fnod[21]+0.12422599874998831*fnod[20]-0.24845199749997662*fnod[19]+0.12422599874998831*fnod[18]-0.12422599874998831*fnod[17]+0.24845199749997662*fnod[16]-0.12422599874998831*fnod[15]-0.12422599874998831*fnod[14]+0.24845199749997662*fnod[13]-0.12422599874998831*fnod[12]-0.12422599874998831*fnod[11]+0.24845199749997662*fnod[10]-0.12422599874998831*fnod[9]-0.12422599874998831*fnod[8]+0.24845199749997662*fnod[7]-0.12422599874998831*fnod[6]+0.12422599874998831*fnod[5]-0.24845199749997662*fnod[4]+0.12422599874998831*fnod[3]+0.12422599874998831*fnod[2]-0.24845199749997662*fnod[1]+0.12422599874998831*fnod[0]; 
  distf[21] = 0.12422599874998831*fnod[23]-0.24845199749997662*fnod[22]+0.12422599874998831*fnod[21]-0.12422599874998831*fnod[20]+0.24845199749997662*fnod[19]-0.12422599874998831*fnod[18]+0.12422599874998831*fnod[17]-0.24845199749997662*fnod[16]+0.12422599874998831*fnod[15]-0.12422599874998831*fnod[14]+0.24845199749997662*fnod[13]-0.12422599874998831*fnod[12]-0.12422599874998831*fnod[11]+0.24845199749997662*fnod[10]-0.12422599874998831*fnod[9]+0.12422599874998831*fnod[8]-0.24845199749997662*fnod[7]+0.12422599874998831*fnod[6]-0.12422599874998831*fnod[5]+0.24845199749997662*fnod[4]-0.12422599874998831*fnod[3]+0.12422599874998831*fnod[2]-0.24845199749997662*fnod[1]+0.12422599874998831*fnod[0]; 
  distf[22] = 0.12422599874998831*fnod[23]-0.24845199749997662*fnod[22]+0.12422599874998831*fnod[21]-0.12422599874998831*fnod[20]+0.24845199749997662*fnod[19]-0.12422599874998831*fnod[18]-0.12422599874998831*fnod[17]+0.24845199749997662*fnod[16]-0.12422599874998831*fnod[15]+0.12422599874998831*fnod[14]-0.24845199749997662*fnod[13]+0.12422599874998831*fnod[12]+0.12422599874998831*fnod[11]-0.24845199749997662*fnod[10]+0.12422599874998831*fnod[9]-0.12422599874998831*fnod[8]+0.24845199749997662*fnod[7]-0.12422599874998831*fnod[6]-0.12422599874998831*fnod[5]+0.24845199749997662*fnod[4]-0.12422599874998831*fnod[3]+0.12422599874998831*fnod[2]-0.24845199749997662*fnod[1]+0.12422599874998831*fnod[0]; 
  distf[23] = 0.12422599874998837*fnod[23]-0.24845199749997673*fnod[22]+0.12422599874998837*fnod[21]-0.12422599874998837*fnod[20]+0.24845199749997673*fnod[19]-0.12422599874998837*fnod[18]-0.12422599874998837*fnod[17]+0.24845199749997673*fnod[16]-0.12422599874998837*fnod[15]+0.12422599874998837*fnod[14]-0.24845199749997673*fnod[13]+0.12422599874998837*fnod[12]-0.12422599874998837*fnod[11]+0.24845199749997673*fnod[10]-0.12422599874998837*fnod[9]+0.12422599874998837*fnod[8]-0.24845199749997673*fnod[7]+0.12422599874998837*fnod[6]+0.12422599874998837*fnod[5]-0.24845199749997673*fnod[4]+0.12422599874998837*fnod[3]-0.12422599874998837*fnod[2]+0.24845199749997673*fnod[1]-0.12422599874998837*fnod[0]; 
  }

  return shifted;

}

GKYL_CU_DH bool positivity_shift_gyrokinetic_MRS_limiter_2x2v_ser_p1(double ffloor, double *distf) 
{ 
  // ffloor: Distribution function floor to shift to when f<0.
  // distf: distribution function.

  double fnod[24];
  fnod[0] = -(0.22360679774997894*distf[23])+0.22360679774997896*distf[22]+0.22360679774997896*distf[21]+0.22360679774997896*distf[20]-0.22360679774997894*distf[19]-0.22360679774997902*distf[18]-0.22360679774997902*distf[17]+0.22360679774997896*distf[16]+0.33541019662496846*distf[15]-0.33541019662496846*distf[14]-0.33541019662496846*distf[13]-0.25*distf[12]-0.33541019662496846*distf[11]+0.33541019662496846*distf[10]+0.25*distf[9]+0.25*distf[8]+0.33541019662496846*distf[7]+0.33541019662496846*distf[6]+0.25*distf[5]-0.25*distf[4]-0.33541019662496846*distf[3]-0.25*distf[2]-0.25*distf[1]+0.25*distf[0]; 
  fnod[1] = 0.2795084971874738*distf[23]-0.2795084971874737*distf[22]-0.2795084971874737*distf[21]-0.2795084971874737*distf[20]+0.2795084971874738*distf[19]+0.2795084971874738*distf[18]+0.2795084971874738*distf[17]-0.2795084971874737*distf[16]-0.25*distf[12]+0.25*distf[9]+0.25*distf[8]+0.25*distf[5]-0.25*distf[4]-0.25*distf[2]-0.25*distf[1]+0.25*distf[0]; 
  fnod[2] = -(0.22360679774997894*distf[23])+0.22360679774997896*distf[22]+0.22360679774997896*distf[21]+0.22360679774997896*distf[20]-0.22360679774997894*distf[19]-0.22360679774997902*distf[18]-0.22360679774997902*distf[17]+0.22360679774997896*distf[16]-0.33541019662496846*distf[15]+0.33541019662496846*distf[14]+0.33541019662496846*distf[13]-0.25*distf[12]+0.33541019662496846*distf[11]-0.33541019662496846*distf[10]+0.25*distf[9]+0.25*distf[8]-0.33541019662496846*distf[7]-0.33541019662496846*distf[6]+0.25*distf[5]-0.25*distf[4]+0.33541019662496846*distf[3]-0.25*distf[2]-0.25*distf[1]+0.25*distf[0]; 
  fnod[3] = 0.22360679774997894*distf[23]-0.22360679774997896*distf[22]-0.22360679774997896*distf[21]+0.22360679774997896*distf[20]+0.22360679774997894*distf[19]-0.22360679774997902*distf[18]-0.22360679774997902*distf[17]+0.22360679774997896*distf[16]-0.33541019662496846*distf[15]+0.33541019662496846*distf[14]+0.33541019662496846*distf[13]+0.25*distf[12]-0.33541019662496846*distf[11]-0.33541019662496846*distf[10]-0.25*distf[9]-0.25*distf[8]+0.33541019662496846*distf[7]+0.33541019662496846*distf[6]+0.25*distf[5]+0.25*distf[4]-0.33541019662496846*distf[3]-0.25*distf[2]-0.25*distf[1]+0.25*distf[0]; 
  fnod[4] = -(0.2795084971874738*distf[23])+0.2795084971874737*distf[22]+0.2795084971874737*distf[21]-0.2795084971874737*distf[20]-0.2795084971874738*distf[19]+0.2795084971874738*distf[18]+0.2795084971874738*distf[17]-0.2795084971874737*distf[16]+0.25*distf[12]-0.25*distf[9]-0.25*distf[8]+0.25*distf[5]+0.25*distf[4]-0.25*distf[2]-0.25*distf[1]+0.25*distf[0]; 
  fnod[5] = 0.22360679774997894*distf[23]-0.22360679774997896*distf[22]-0.22360679774997896*distf[21]+0.22360679774997896*distf[20]+0.22360679774997894*distf[19]-0.22360679774997902*distf[18]-0.22360679774997902*distf[17]+0.22360679774997896*distf[16]+0.33541019662496846*distf[15]-0.33541019662496846*distf[14]-0.33541019662496846*distf[13]+0.25*distf[12]+0.33541019662496846*distf[11]+0.33541019662496846*distf[10]-0.25*distf[9]-0.25*distf[8]-0.33541019662496846*distf[7]-0.33541019662496846*distf[6]+0.25*distf[5]+0.25*distf[4]+0.33541019662496846*distf[3]-0.25*distf[2]-0.25*distf[1]+0.25*distf[0]; 
  fnod[6] = 0.22360679774997894*distf[23]-0.22360679774997896*distf[22]+0.22360679774997896*distf[21]-0.22360679774997896*distf[20]-0.22360679774997894*distf[19]+0.22360679774997902*distf[18]-0.22360679774997902*distf[17]+0.22360679774997896*distf[16]-0.33541019662496846*distf[15]+0.33541019662496846*distf[14]-0.33541019662496846*distf[13]+0.25*distf[12]+0.33541019662496846*distf[11]+0.33541019662496846*distf[10]-0.25*distf[9]+0.25*distf[8]-0.33541019662496846*distf[7]+0.33541019662496846*distf[6]-0.25*distf[5]-0.25*distf[4]-0.33541019662496846*distf[3]+0.25*distf[2]-0.25*distf[1]+0.25*distf[0]; 
  fnod[7] = -(0.2795084971874738*distf[23])+0.2795084971874737*distf[22]-0.2795084971874737*distf[21]+0.2795084971874737*distf[20]+0.2795084971874738*distf[19]-0.2795084971874738*distf[18]+0.2795084971874738*distf[17]-0.2795084971874737*distf[16]+0.25*distf[12]-0.25*distf[9]+0.25*distf[8]-0.25*distf[5]-0.25*distf[4]+0.25*distf[2]-0.25*distf[1]+0.25*distf[0]; 
  fnod[8] = 0.22360679774997894*distf[23]-0.22360679774997896*distf[22]+0.22360679774997896*distf[21]-0.22360679774997896*distf[20]-0.22360679774997894*distf[19]+0.22360679774997902*distf[18]-0.22360679774997902*distf[17]+0.22360679774997896*distf[16]+0.33541019662496846*distf[15]-0.33541019662496846*distf[14]+0.33541019662496846*distf[13]+0.25*distf[12]-0.33541019662496846*distf[11]-0.33541019662496846*distf[10]-0.25*distf[9]+0.25*distf[8]+0.33541019662496846*distf[7]-0.33541019662496846*distf[6]-0.25*distf[5]-0.25*distf[4]+0.33541019662496846*distf[3]+0.25*distf[2]-0.25*distf[1]+0.25*distf[0]; 
  fnod[9] = -(0.22360679774997894*distf[23])+0.22360679774997896*distf[22]-0.22360679774997896*distf[21]-0.22360679774997896*distf[20]+0.22360679774997894*distf[19]+0.22360679774997902*distf[18]-0.22360679774997902*distf[17]+0.22360679774997896*distf[16]+0.33541019662496846*distf[15]-0.33541019662496846*distf[14]+0.33541019662496846*distf[13]-0.25*distf[12]+0.33541019662496846*distf[11]-0.33541019662496846*distf[10]+0.25*distf[9]-0.25*distf[8]-0.33541019662496846*distf[7]+0.33541019662496846*distf[6]-0.25*distf[5]+0.25*distf[4]-0.33541019662496846*distf[3]+0.25*distf[2]-0.25*distf[1]+0.25*distf[0]; 
  fnod[10] = 0.2795084971874738*distf[23]-0.2795084971874737*distf[22]+0.2795084971874737*distf[21]+0.2795084971874737*distf[20]-0.2795084971874738*distf[19]-0.2795084971874738*distf[18]+0.2795084971874738*distf[17]-0.2795084971874737*distf[16]-0.25*distf[12]+0.25*distf[9]-0.25*distf[8]-0.25*distf[5]+0.25*distf[4]+0.25*distf[2]-0.25*distf[1]+0.25*distf[0]; 
  fnod[11] = -(0.22360679774997894*distf[23])+0.22360679774997896*distf[22]-0.22360679774997896*distf[21]-0.22360679774997896*distf[20]+0.22360679774997894*distf[19]+0.22360679774997902*distf[18]-0.22360679774997902*distf[17]+0.22360679774997896*distf[16]-0.33541019662496846*distf[15]+0.33541019662496846*distf[14]-0.33541019662496846*distf[13]-0.25*distf[12]-0.33541019662496846*distf[11]+0.33541019662496846*distf[10]+0.25*distf[9]-0.25*distf[8]+0.33541019662496846*distf[7]-0.33541019662496846*distf[6]-0.25*distf[5]+0.25*distf[4]+0.33541019662496846*distf[3]+0.25*distf[2]-0.25*distf[1]+0.25*distf[0]; 
  fnod[12] = 0.22360679774997894*distf[23]+0.22360679774997896*distf[22]-0.22360679774997896*distf[21]-0.22360679774997896*distf[20]-0.22360679774997894*distf[19]-0.22360679774997902*distf[18]+0.22360679774997902*distf[17]+0.22360679774997896*distf[16]-0.33541019662496846*distf[15]-0.33541019662496846*distf[14]+0.33541019662496846*distf[13]+0.25*distf[12]+0.33541019662496846*distf[11]+0.33541019662496846*distf[10]+0.25*distf[9]-0.25*distf[8]+0.33541019662496846*distf[7]-0.33541019662496846*distf[6]-0.25*distf[5]-0.25*distf[4]-0.33541019662496846*distf[3]-0.25*distf[2]+0.25*distf[1]+0.25*distf[0]; 
  fnod[13] = -(0.2795084971874738*distf[23])-0.2795084971874737*distf[22]+0.2795084971874737*distf[21]+0.2795084971874737*distf[20]+0.2795084971874738*distf[19]+0.2795084971874738*distf[18]-0.2795084971874738*distf[17]-0.2795084971874737*distf[16]+0.25*distf[12]+0.25*distf[9]-0.25*distf[8]-0.25*distf[5]-0.25*distf[4]-0.25*distf[2]+0.25*distf[1]+0.25*distf[0]; 
  fnod[14] = 0.22360679774997894*distf[23]+0.22360679774997896*distf[22]-0.22360679774997896*distf[21]-0.22360679774997896*distf[20]-0.22360679774997894*distf[19]-0.22360679774997902*distf[18]+0.22360679774997902*distf[17]+0.22360679774997896*distf[16]+0.33541019662496846*distf[15]+0.33541019662496846*distf[14]-0.33541019662496846*distf[13]+0.25*distf[12]-0.33541019662496846*distf[11]-0.33541019662496846*distf[10]+0.25*distf[9]-0.25*distf[8]-0.33541019662496846*distf[7]+0.33541019662496846*distf[6]-0.25*distf[5]-0.25*distf[4]+0.33541019662496846*distf[3]-0.25*distf[2]+0.25*distf[1]+0.25*distf[0]; 
  fnod[15] = -(0.22360679774997894*distf[23])-0.22360679774997896*distf[22]+0.22360679774997896*distf[21]-0.22360679774997896*distf[20]+0.22360679774997894*distf[19]-0.22360679774997902*distf[18]+0.22360679774997902*distf[17]+0.22360679774997896*distf[16]+0.33541019662496846*distf[15]+0.33541019662496846*distf[14]-0.33541019662496846*distf[13]-0.25*distf[12]+0.33541019662496846*distf[11]-0.33541019662496846*distf[10]-0.25*distf[9]+0.25*distf[8]+0.33541019662496846*distf[7]-0.33541019662496846*distf[6]-0.25*distf[5]+0.25*distf[4]-0.33541019662496846*distf[3]-0.25*distf[2]+0.25*distf[1]+0.25*distf[0]; 
  fnod[16] = 0.2795084971874738*distf[23]+0.2795084971874737*distf[22]-0.2795084971874737*distf[21]+0.2795084971874737*distf[20]-0.2795084971874738*distf[19]+0.2795084971874738*distf[18]-0.2795084971874738*distf[17]-0.2795084971874737*distf[16]-0.25*distf[12]-0.25*distf[9]+0.25*distf[8]-0.25*distf[5]+0.25*distf[4]-0.25*distf[2]+0.25*distf[1]+0.25*distf[0]; 
  fnod[17] = -(0.22360679774997894*distf[23])-0.22360679774997896*distf[22]+0.22360679774997896*distf[21]-0.22360679774997896*distf[20]+0.22360679774997894*distf[19]-0.22360679774997902*distf[18]+0.22360679774997902*distf[17]+0.22360679774997896*distf[16]-0.33541019662496846*distf[15]-0.33541019662496846*distf[14]+0.33541019662496846*distf[13]-0.25*distf[12]-0.33541019662496846*distf[11]+0.33541019662496846*distf[10]-0.25*distf[9]+0.25*distf[8]-0.33541019662496846*distf[7]+0.33541019662496846*distf[6]-0.25*distf[5]+0.25*distf[4]+0.33541019662496846*distf[3]-0.25*distf[2]+0.25*distf[1]+0.25*distf[0]; 
  fnod[18] = -(0.22360679774997894*distf[23])-0.22360679774997896*distf[22]-0.22360679774997896*distf[21]+0.22360679774997896*distf[20]-0.22360679774997894*distf[19]+0.22360679774997902*distf[18]+0.22360679774997902*distf[17]+0.22360679774997896*distf[16]+0.33541019662496846*distf[15]+0.33541019662496846*distf[14]+0.33541019662496846*distf[13]-0.25*distf[12]-0.33541019662496846*distf[11]+0.33541019662496846*distf[10]-0.25*distf[9]-0.25*distf[8]-0.33541019662496846*distf[7]-0.33541019662496846*distf[6]+0.25*distf[5]-0.25*distf[4]-0.33541019662496846*distf[3]+0.25*distf[2]+0.25*distf[1]+0.25*distf[0]; 
  fnod[19] = 0.2795084971874738*distf[23]+0.2795084971874737*distf[22]+0.2795084971874737*distf[21]-0.2795084971874737*distf[20]+0.2795084971874738*distf[19]-0.2795084971874738*distf[18]-0.2795084971874738*distf[17]-0.2795084971874737*distf[16]-0.25*distf[12]-0.25*distf[9]-0.25*distf[8]+0.25*distf[5]-0.25*distf[4]+0.25*distf[2]+0.25*distf[1]+0.25*distf[0]; 
  fnod[20] = -(0.22360679774997894*distf[23])-0.22360679774997896*distf[22]-0.22360679774997896*distf[21]+0.22360679774997896*distf[20]-0.22360679774997894*distf[19]+0.22360679774997902*distf[18]+0.22360679774997902*distf[17]+0.22360679774997896*distf[16]-0.33541019662496846*distf[15]-0.33541019662496846*distf[14]-0.33541019662496846*distf[13]-0.25*distf[12]+0.33541019662496846*distf[11]-0.33541019662496846*distf[10]-0.25*distf[9]-0.25*distf[8]+0.33541019662496846*distf[7]+0.33541019662496846*distf[6]+0.25*distf[5]-0.25*distf[4]+0.33541019662496846*distf[3]+0.25*distf[2]+0.25*distf[1]+0.25*distf[0]; 
  fnod[21] = 0.22360679774997894*distf[23]+0.22360679774997896*distf[22]+0.22360679774997896*distf[21]+0.22360679774997896*distf[20]+0.22360679774997894*distf[19]+0.22360679774997902*distf[18]+0.22360679774997902*distf[17]+0.22360679774997896*distf[16]-0.33541019662496846*distf[15]-0.33541019662496846*distf[14]-0.33541019662496846*distf[13]+0.25*distf[12]-0.33541019662496846*distf[11]-0.33541019662496846*distf[10]+0.25*distf[9]+0.25*distf[8]-0.33541019662496846*distf[7]-0.33541019662496846*distf[6]+0.25*distf[5]+0.25*distf[4]-0.33541019662496846*distf[3]+0.25*distf[2]+0.25*distf[1]+0.25*distf[0]; 
  fnod[22] = -(0.2795084971874738*distf[23])-0.2795084971874737*distf[22]-0.2795084971874737*distf[21]-0.2795084971874737*distf[20]-0.2795084971874738*distf[19]-0.2795084971874738*distf[18]-0.2795084971874738*distf[17]-0.2795084971874737*distf[16]+0.25*distf[12]+0.25*distf[9]+0.25*distf[8]+0.25*distf[5]+0.25*distf[4]+0.25*distf[2]+0.25*distf[1]+0.25*distf[0]; 
  fnod[23] = 0.22360679774997894*distf[23]+0.22360679774997896*distf[22]+0.22360679774997896*distf[21]+0.22360679774997896*distf[20]+0.22360679774997894*distf[19]+0.22360679774997902*distf[18]+0.22360679774997902*distf[17]+0.22360679774997896*distf[16]+0.33541019662496846*distf[15]+0.33541019662496846*distf[14]+0.33541019662496846*distf[13]+0.25*distf[12]+0.33541019662496846*distf[11]+0.33541019662496846*distf[10]+0.25*distf[9]+0.25*distf[8]+0.33541019662496846*distf[7]+0.33541019662496846*distf[6]+0.25*distf[5]+0.25*distf[4]+0.33541019662496846*distf[3]+0.25*distf[2]+0.25*distf[1]+0.25*distf[0]; 

  bool shifted_node = false;

  if (distf[0] > 0.) {
    // Apply Moe–Rossmanith–Seal limiter.
    double fnod_min = DBL_MAX;
    fnod_min = fmin(fnod_min, fnod[0]);
    fnod_min = fmin(fnod_min, fnod[1]);
    fnod_min = fmin(fnod_min, fnod[2]);
    fnod_min = fmin(fnod_min, fnod[3]);
    fnod_min = fmin(fnod_min, fnod[4]);
    fnod_min = fmin(fnod_min, fnod[5]);
    fnod_min = fmin(fnod_min, fnod[6]);
    fnod_min = fmin(fnod_min, fnod[7]);
    fnod_min = fmin(fnod_min, fnod[8]);
    fnod_min = fmin(fnod_min, fnod[9]);
    fnod_min = fmin(fnod_min, fnod[10]);
    fnod_min = fmin(fnod_min, fnod[11]);
    fnod_min = fmin(fnod_min, fnod[12]);
    fnod_min = fmin(fnod_min, fnod[13]);
    fnod_min = fmin(fnod_min, fnod[14]);
    fnod_min = fmin(fnod_min, fnod[15]);
    fnod_min = fmin(fnod_min, fnod[16]);
    fnod_min = fmin(fnod_min, fnod[17]);
    fnod_min = fmin(fnod_min, fnod[18]);
    fnod_min = fmin(fnod_min, fnod[19]);
    fnod_min = fmin(fnod_min, fnod[20]);
    fnod_min = fmin(fnod_min, fnod[21]);
    fnod_min = fmin(fnod_min, fnod[22]);
    fnod_min = fmin(fnod_min, fnod[23]);

    if (fnod_min < 0.0) {
      double f_cellav = distf[0]/4.000000000000001;
      double denom = f_cellav - fnod_min;
      double theta = denom > 1.0e-12*f_cellav? fmin(1.0, f_cellav/denom) : 1.0;

  distf[0] = -(4.0*f_cellav*theta)+distf[0]*theta+4.0*f_cellav; 
  distf[1] = distf[1]*theta; 
  distf[2] = distf[2]*theta; 
  distf[3] = distf[3]*theta; 
  distf[4] = distf[4]*theta; 
  distf[5] = distf[5]*theta; 
  distf[6] = distf[6]*theta; 
  distf[7] = distf[7]*theta; 
  distf[8] = distf[8]*theta; 
  distf[9] = distf[9]*theta; 
  distf[10] = distf[10]*theta; 
  distf[11] = distf[11]*theta; 
  distf[12] = distf[12]*theta; 
  distf[13] = distf[13]*theta; 
  distf[14] = distf[14]*theta; 
  distf[15] = distf[15]*theta; 
  distf[16] = distf[16]*theta; 
  distf[17] = distf[17]*theta; 
  distf[18] = distf[18]*theta; 
  distf[19] = distf[19]*theta; 
  distf[20] = distf[20]*theta; 
  distf[21] = distf[21]*theta; 
  distf[22] = distf[22]*theta; 
  distf[23] = distf[23]*theta; 

      shifted_node = true;
    }
  }

  else {

    // If f < 0. at check nodes, set it to ffloor.
    if (fnod[0] < 0.) fnod[0] = ffloor;
    if (fnod[1] < 0.) fnod[1] = ffloor;
    if (fnod[2] < 0.) fnod[2] = ffloor;
    if (fnod[3] < 0.) fnod[3] = ffloor;
    if (fnod[4] < 0.) fnod[4] = ffloor;
    if (fnod[5] < 0.) fnod[5] = ffloor;
    if (fnod[6] < 0.) fnod[6] = ffloor;
    if (fnod[7] < 0.) fnod[7] = ffloor;
    if (fnod[8] < 0.) fnod[8] = ffloor;
    if (fnod[9] < 0.) fnod[9] = ffloor;
    if (fnod[10] < 0.) fnod[10] = ffloor;
    if (fnod[11] < 0.) fnod[11] = ffloor;
    if (fnod[12] < 0.) fnod[12] = ffloor;
    if (fnod[13] < 0.) fnod[13] = ffloor;
    if (fnod[14] < 0.) fnod[14] = ffloor;
    if (fnod[15] < 0.) fnod[15] = ffloor;
    if (fnod[16] < 0.) fnod[16] = ffloor;
    if (fnod[17] < 0.) fnod[17] = ffloor;
    if (fnod[18] < 0.) fnod[18] = ffloor;
    if (fnod[19] < 0.) fnod[19] = ffloor;
    if (fnod[20] < 0.) fnod[20] = ffloor;
    if (fnod[21] < 0.) fnod[21] = ffloor;
    if (fnod[22] < 0.) fnod[22] = ffloor;
    if (fnod[23] < 0.) fnod[23] = ffloor;

  distf[0] = 0.1388888888888889*fnod[23]+0.2222222222222222*fnod[22]+0.1388888888888889*fnod[21]+0.1388888888888889*fnod[20]+0.2222222222222222*fnod[19]+0.1388888888888889*fnod[18]+0.1388888888888889*fnod[17]+0.2222222222222222*fnod[16]+0.1388888888888889*fnod[15]+0.1388888888888889*fnod[14]+0.2222222222222222*fnod[13]+0.1388888888888889*fnod[12]+0.1388888888888889*fnod[11]+0.2222222222222222*fnod[10]+0.1388888888888889*fnod[9]+0.1388888888888889*fnod[8]+0.2222222222222222*fnod[7]+0.1388888888888889*fnod[6]+0.1388888888888889*fnod[5]+0.2222222222222222*fnod[4]+0.1388888888888889*fnod[3]+0.1388888888888889*fnod[2]+0.2222222222222222*fnod[1]+0.1388888888888889*fnod[0]; 
  distf[1] = 0.1388888888888889*fnod[23]+0.2222222222222222*fnod[22]+0.1388888888888889*fnod[21]+0.1388888888888889*fnod[20]+0.2222222222222222*fnod[19]+0.1388888888888889*fnod[18]+0.1388888888888889*fnod[17]+0.2222222222222222*fnod[16]+0.1388888888888889*fnod[15]+0.1388888888888889*fnod[14]+0.2222222222222222*fnod[13]+0.1388888888888889*fnod[12]-0.1388888888888889*fnod[11]-0.2222222222222222*fnod[10]-0.1388888888888889*fnod[9]-0.1388888888888889*fnod[8]-0.2222222222222222*fnod[7]-0.1388888888888889*fnod[6]-0.1388888888888889*fnod[5]-0.2222222222222222*fnod[4]-0.1388888888888889*fnod[3]-0.1388888888888889*fnod[2]-0.2222222222222222*fnod[1]-0.1388888888888889*fnod[0]; 
  distf[2] = 0.1388888888888889*fnod[23]+0.2222222222222222*fnod[22]+0.1388888888888889*fnod[21]+0.1388888888888889*fnod[20]+0.2222222222222222*fnod[19]+0.1388888888888889*fnod[18]-0.1388888888888889*fnod[17]-0.2222222222222222*fnod[16]-0.1388888888888889*fnod[15]-0.1388888888888889*fnod[14]-0.2222222222222222*fnod[13]-0.1388888888888889*fnod[12]+0.1388888888888889*fnod[11]+0.2222222222222222*fnod[10]+0.1388888888888889*fnod[9]+0.1388888888888889*fnod[8]+0.2222222222222222*fnod[7]+0.1388888888888889*fnod[6]-0.1388888888888889*fnod[5]-0.2222222222222222*fnod[4]-0.1388888888888889*fnod[3]-0.1388888888888889*fnod[2]-0.2222222222222222*fnod[1]-0.1388888888888889*fnod[0]; 
  distf[3] = 0.18633899812498247*fnod[23]-0.18633899812498247*fnod[21]+0.18633899812498247*fnod[20]-0.18633899812498247*fnod[18]+0.18633899812498247*fnod[17]-0.18633899812498247*fnod[15]+0.18633899812498247*fnod[14]-0.18633899812498247*fnod[12]+0.18633899812498247*fnod[11]-0.18633899812498247*fnod[9]+0.18633899812498247*fnod[8]-0.18633899812498247*fnod[6]+0.18633899812498247*fnod[5]-0.18633899812498247*fnod[3]+0.18633899812498247*fnod[2]-0.18633899812498247*fnod[0]; 
  distf[4] = 0.1388888888888889*fnod[23]+0.2222222222222222*fnod[22]+0.1388888888888889*fnod[21]-0.1388888888888889*fnod[20]-0.2222222222222222*fnod[19]-0.1388888888888889*fnod[18]+0.1388888888888889*fnod[17]+0.2222222222222222*fnod[16]+0.1388888888888889*fnod[15]-0.1388888888888889*fnod[14]-0.2222222222222222*fnod[13]-0.1388888888888889*fnod[12]+0.1388888888888889*fnod[11]+0.2222222222222222*fnod[10]+0.1388888888888889*fnod[9]-0.1388888888888889*fnod[8]-0.2222222222222222*fnod[7]-0.1388888888888889*fnod[6]+0.1388888888888889*fnod[5]+0.2222222222222222*fnod[4]+0.1388888888888889*fnod[3]-0.1388888888888889*fnod[2]-0.2222222222222222*fnod[1]-0.1388888888888889*fnod[0]; 
  distf[5] = 0.1388888888888889*fnod[23]+0.2222222222222222*fnod[22]+0.1388888888888889*fnod[21]+0.1388888888888889*fnod[20]+0.2222222222222222*fnod[19]+0.1388888888888889*fnod[18]-0.1388888888888889*fnod[17]-0.2222222222222222*fnod[16]-0.1388888888888889*fnod[15]-0.1388888888888889*fnod[14]-0.2222222222222222*fnod[13]-0.1388888888888889*fnod[12]-0.1388888888888889*fnod[11]-0.2222222222222222*fnod[10]-0.1388888888888889*fnod[9]-0.1388888888888889*fnod[8]-0.2222222222222222*fnod[7]-0.1388888888888889*fnod[6]+0.1388888888888889*fnod[5]+0.2222222222222222*fnod[4]+0.1388888888888889*fnod[3]+0.1388888888888889*fnod[2]+0.2222222222222222*fnod[1]+0.1388888888888889*fnod[0]; 
  distf[6] = 0.18633899812498247*fnod[23]-0.18633899812498247*fnod[21]+0.18633899812498247*fnod[20]-0.18633899812498247*fnod[18]+0.18633899812498247*fnod[17]-0.18633899812498247*fnod[15]+0.18633899812498247*fnod[14]-0.18633899812498247*fnod[12]-0.18633899812498247*fnod[11]+0.18633899812498247*fnod[9]-0.18633899812498247*fnod[8]+0.18633899812498247*fnod[6]-0.18633899812498247*fnod[5]+0.18633899812498247*fnod[3]-0.18633899812498247*fnod[2]+0.18633899812498247*fnod[0]; 
  distf[7] = 0.18633899812498247*fnod[23]-0.18633899812498247*fnod[21]+0.18633899812498247*fnod[20]-0.18633899812498247*fnod[18]-0.18633899812498247*fnod[17]+0.18633899812498247*fnod[15]-0.18633899812498247*fnod[14]+0.18633899812498247*fnod[12]+0.18633899812498247*fnod[11]-0.18633899812498247*fnod[9]+0.18633899812498247*fnod[8]-0.18633899812498247*fnod[6]-0.18633899812498247*fnod[5]+0.18633899812498247*fnod[3]-0.18633899812498247*fnod[2]+0.18633899812498247*fnod[0]; 
  distf[8] = 0.1388888888888889*fnod[23]+0.2222222222222222*fnod[22]+0.1388888888888889*fnod[21]-0.1388888888888889*fnod[20]-0.2222222222222222*fnod[19]-0.1388888888888889*fnod[18]+0.1388888888888889*fnod[17]+0.2222222222222222*fnod[16]+0.1388888888888889*fnod[15]-0.1388888888888889*fnod[14]-0.2222222222222222*fnod[13]-0.1388888888888889*fnod[12]-0.1388888888888889*fnod[11]-0.2222222222222222*fnod[10]-0.1388888888888889*fnod[9]+0.1388888888888889*fnod[8]+0.2222222222222222*fnod[7]+0.1388888888888889*fnod[6]-0.1388888888888889*fnod[5]-0.2222222222222222*fnod[4]-0.1388888888888889*fnod[3]+0.1388888888888889*fnod[2]+0.2222222222222222*fnod[1]+0.1388888888888889*fnod[0]; 
  distf[9] = 0.1388888888888889*fnod[23]+0.2222222222222222*fnod[22]+0.1388888888888889*fnod[21]-0.1388888888888889*fnod[20]-0.2222222222222222*fnod[19]-0.1388888888888889*fnod[18]-0.1388888888888889*fnod[17]-0.2222222222222222*fnod[16]-0.1388888888888889*fnod[15]+0.1388888888888889*fnod[14]+0.2222222222222222*fnod[13]+0.1388888888888889*fnod[12]+0.1388888888888889*fnod[11]+0.2222222222222222*fnod[10]+0.1388888888888889*fnod[9]-0.1388888888888889*fnod[8]-0.2222222222222222*fnod[7]-0.1388888888888889*fnod[6]-0.1388888888888889*fnod[5]-0.2222222222222222*fnod[4]-0.1388888888888889*fnod[3]+0.1388888888888889*fnod[2]+0.2222222222222222*fnod[1]+0.1388888888888889*fnod[0]; 
  distf[10] = 0.18633899812498247*fnod[23]-0.18633899812498247*fnod[21]-0.18633899812498247*fnod[20]+0.18633899812498247*fnod[18]+0.18633899812498247*fnod[17]-0.18633899812498247*fnod[15]-0.18633899812498247*fnod[14]+0.18633899812498247*fnod[12]+0.18633899812498247*fnod[11]-0.18633899812498247*fnod[9]-0.18633899812498247*fnod[8]+0.18633899812498247*fnod[6]+0.18633899812498247*fnod[5]-0.18633899812498247*fnod[3]-0.18633899812498247*fnod[2]+0.18633899812498247*fnod[0]; 
  distf[11] = 0.18633899812498247*fnod[23]-0.18633899812498247*fnod[21]+0.18633899812498247*fnod[20]-0.18633899812498247*fnod[18]-0.18633899812498247*fnod[17]+0.18633899812498247*fnod[15]-0.18633899812498247*fnod[14]+0.18633899812498247*fnod[12]-0.18633899812498247*fnod[11]+0.18633899812498247*fnod[9]-0.18633899812498247*fnod[8]+0.18633899812498247*fnod[6]+0.18633899812498247*fnod[5]-0.18633899812498247*fnod[3]+0.18633899812498247*fnod[2]-0.18633899812498247*fnod[0]; 
  distf[12] = 0.1388888888888889*fnod[23]+0.2222222222222222*fnod[22]+0.1388888888888889*fnod[21]-0.1388888888888889*fnod[20]-0.2222222222222222*fnod[19]-0.1388888888888889*fnod[18]-0.1388888888888889*fnod[17]-0.2222222222222222*fnod[16]-0.1388888888888889*fnod[15]+0.1388888888888889*fnod[14]+0.2222222222222222*fnod[13]+0.1388888888888889*fnod[12]-0.1388888888888889*fnod[11]-0.2222222222222222*fnod[10]-0.1388888888888889*fnod[9]+0.1388888888888889*fnod[8]+0.2222222222222222*fnod[7]+0.1388888888888889*fnod[6]+0.1388888888888889*fnod[5]+0.2222222222222222*fnod[4]+0.1388888888888889*fnod[3]-0.1388888888888889*fnod[2]-0.2222222222222222*fnod[1]-0.1388888888888889*fnod[0]; 
  distf[13] = 0.18633899812498247*fnod[23]-0.18633899812498247*fnod[21]-0.18633899812498247*fnod[20]+0.18633899812498247*fnod[18]+0.18633899812498247*fnod[17]-0.18633899812498247*fnod[15]-0.18633899812498247*fnod[14]+0.18633899812498247*fnod[12]-0.18633899812498247*fnod[11]+0.18633899812498247*fnod[9]+0.18633899812498247*fnod[8]-0.18633899812498247*fnod[6]-0.18633899812498247*fnod[5]+0.18633899812498247*fnod[3]+0.18633899812498247*fnod[2]-0.18633899812498247*fnod[0]; 
  distf[14] = 0.18633899812498247*fnod[23]-0.18633899812498247*fnod[21]-0.18633899812498247*fnod[20]+0.18633899812498247*fnod[18]-0.18633899812498247*fnod[17]+0.18633899812498247*fnod[15]+0.18633899812498247*fnod[14]-0.18633899812498247*fnod[12]+0.18633899812498247*fnod[11]-0.18633899812498247*fnod[9]-0.18633899812498247*fnod[8]+0.18633899812498247*fnod[6]-0.18633899812498247*fnod[5]+0.18633899812498247*fnod[3]+0.18633899812498247*fnod[2]-0.18633899812498247*fnod[0]; 
  distf[15] = 0.18633899812498247*fnod[23]-0.18633899812498247*fnod[21]-0.18633899812498247*fnod[20]+0.18633899812498247*fnod[18]-0.18633899812498247*fnod[17]+0.18633899812498247*fnod[15]+0.18633899812498247*fnod[14]-0.18633899812498247*fnod[12]-0.18633899812498247*fnod[11]+0.18633899812498247*fnod[9]+0.18633899812498247*fnod[8]-0.18633899812498247*fnod[6]+0.18633899812498247*fnod[5]-0.18633899812498247*fnod[3]-0.18633899812498247*fnod[2]+0.18633899812498247*fnod[0]; 
  distf[16] = 0.12422599874998831*fnod[23]-0.24845199749997662*fnod[22]+0.12422599874998831*fnod[21]+0.12422599874998831*fnod[20]-0.24845199749997662*fnod[19]+0.12422599874998831*fnod[18]+0.12422599874998831*fnod[17]-0.24845199749997662*fnod[16]+0.12422599874998831*fnod[15]+0.12422599874998831*fnod[14]-0.24845199749997662*fnod[13]+0.12422599874998831*fnod[12]+0.12422599874998831*fnod[11]-0.24845199749997662*fnod[10]+0.12422599874998831*fnod[9]+0.12422599874998831*fnod[8]-0.24845199749997662*fnod[7]+0.12422599874998831*fnod[6]+0.12422599874998831*fnod[5]-0.24845199749997662*fnod[4]+0.12422599874998831*fnod[3]+0.12422599874998831*fnod[2]-0.24845199749997662*fnod[1]+0.12422599874998831*fnod[0]; 
  distf[17] = 0.12422599874998837*fnod[23]-0.24845199749997673*fnod[22]+0.12422599874998837*fnod[21]+0.12422599874998837*fnod[20]-0.24845199749997673*fnod[19]+0.12422599874998837*fnod[18]+0.12422599874998837*fnod[17]-0.24845199749997673*fnod[16]+0.12422599874998837*fnod[15]+0.12422599874998837*fnod[14]-0.24845199749997673*fnod[13]+0.12422599874998837*fnod[12]-0.12422599874998837*fnod[11]+0.24845199749997673*fnod[10]-0.12422599874998837*fnod[9]-0.12422599874998837*fnod[8]+0.24845199749997673*fnod[7]-0.12422599874998837*fnod[6]-0.12422599874998837*fnod[5]+0.24845199749997673*fnod[4]-0.12422599874998837*fnod[3]-0.12422599874998837*fnod[2]+0.24845199749997673*fnod[1]-0.12422599874998837*fnod[0]; 
  distf[18] = 0.12422599874998837*fnod[23]-0.24845199749997673*fnod[22]+0.12422599874998837*fnod[21]+0.12422599874998837*fnod[20]-0.24845199749997673*fnod[19]+0.12422599874998837*fnod[18]-0.12422599874998837*fnod[17]+0.24845199749997673*fnod[16]-0.12422599874998837*fnod[15]-0.12422599874998837*fnod[14]+0.24845199749997673*fnod[13]-0.12422599874998837*fnod[12]+0.12422599874998837*fnod[11]-0.24845199749997673*fnod[10]+0.12422599874998837*fnod[9]+0.12422599874998837*fnod[8]-0.24845199749997673*fnod[7]+0.12422599874998837*fnod[6]-0.12422599874998837*fnod[5]+0.24845199749997673*fnod[4]-0.12422599874998837*fnod[3]-0.12422599874998837*fnod[2]+0.24845199749997673*fnod[1]-0.12422599874998837*fnod[0]; 
  distf[19] = 0.12422599874998837*fnod[23]-0.24845199749997673*fnod[22]+0.12422599874998837*fnod[21]-0.12422599874998837*fnod[20]+0.24845199749997673*fnod[19]-0.12422599874998837*fnod[18]+0.12422599874998837*fnod[17]-0.24845199749997673*fnod[16]+0.12422599874998837*fnod[15]-0.12422599874998837*fnod[14]+0.24845199749997673*fnod[13]-0.12422599874998837*fnod[12]+0.12422599874998837*fnod[11]-0.24845199749997673*fnod[10]+0.12422599874998837*fnod[9]-0.12422599874998837*fnod[8]+0.24845199749997673*fnod[7]-0.12422599874998837*fnod[6]+0.12422599874998837*fnod[5]-0.24845199749997673*fnod[4]+0.12422599874998837*fnod[3]-0.12422599874998837*fnod[2]+0.24845199749997673*fnod[1]-0.12422599874998837*fnod[0]; 
  distf[20] = 0.12422599874998831*fnod[23]-0.24845199749997662*fnod[22]+0.12422599874998831*fnod[21]+0.12422599874998831*fnod[20]-0.24845199749997662*fnod[19]+0.12422599874998831*fnod[18]-0.12422599874998831*fnod[17]+0.24845199749997662*fnod[16]-0.12422599874998831*fnod[15]-0.12422599874998831*fnod[14]+0.24845199749997662*fnod[13]-0.12422599874998831*fnod[12]-0.12422599874998831*fnod[11]+0.24845199749997662*fnod[10]-0.12422599874998831*fnod[9]-0.12422599874998831*fnod[8]+0.24845199749997662*fnod[7]-0.12422599874998831*fnod[6]+0.12422599874998831*fnod[5]-0.24845199749997662*fnod[4]+0.12422599874998831*fnod[3]+0.12422599874998831*fnod[2]-0.24845199749997662*fnod[1]+0.12422599874998831*fnod[0]; 
  distf[21] = 0.12422599874998831*fnod[23]-0.24845199749997662*fnod[22]+0.12422599874998831*fnod[21]-0.12422599874998831*fnod[20]+0.24845199749997662*fnod[19]-0.12422599874998831*fnod[18]+0.12422599874998831*fnod[17]-0.24845199749997662*fnod[16]+0.12422599874998831*fnod[15]-0.12422599874998831*fnod[14]+0.24845199749997662*fnod[13]-0.12422599874998831*fnod[12]-0.12422599874998831*fnod[11]+0.24845199749997662*fnod[10]-0.12422599874998831*fnod[9]+0.12422599874998831*fnod[8]-0.24845199749997662*fnod[7]+0.12422599874998831*fnod[6]-0.12422599874998831*fnod[5]+0.24845199749997662*fnod[4]-0.12422599874998831*fnod[3]+0.12422599874998831*fnod[2]-0.24845199749997662*fnod[1]+0.12422599874998831*fnod[0]; 
  distf[22] = 0.12422599874998831*fnod[23]-0.24845199749997662*fnod[22]+0.12422599874998831*fnod[21]-0.12422599874998831*fnod[20]+0.24845199749997662*fnod[19]-0.12422599874998831*fnod[18]-0.12422599874998831*fnod[17]+0.24845199749997662*fnod[16]-0.12422599874998831*fnod[15]+0.12422599874998831*fnod[14]-0.24845199749997662*fnod[13]+0.12422599874998831*fnod[12]+0.12422599874998831*fnod[11]-0.24845199749997662*fnod[10]+0.12422599874998831*fnod[9]-0.12422599874998831*fnod[8]+0.24845199749997662*fnod[7]-0.12422599874998831*fnod[6]-0.12422599874998831*fnod[5]+0.24845199749997662*fnod[4]-0.12422599874998831*fnod[3]+0.12422599874998831*fnod[2]-0.24845199749997662*fnod[1]+0.12422599874998831*fnod[0]; 
  distf[23] = 0.12422599874998837*fnod[23]-0.24845199749997673*fnod[22]+0.12422599874998837*fnod[21]-0.12422599874998837*fnod[20]+0.24845199749997673*fnod[19]-0.12422599874998837*fnod[18]-0.12422599874998837*fnod[17]+0.24845199749997673*fnod[16]-0.12422599874998837*fnod[15]+0.12422599874998837*fnod[14]-0.24845199749997673*fnod[13]+0.12422599874998837*fnod[12]-0.12422599874998837*fnod[11]+0.24845199749997673*fnod[10]-0.12422599874998837*fnod[9]+0.12422599874998837*fnod[8]-0.24845199749997673*fnod[7]+0.12422599874998837*fnod[6]+0.12422599874998837*fnod[5]-0.24845199749997673*fnod[4]+0.12422599874998837*fnod[3]-0.12422599874998837*fnod[2]+0.24845199749997673*fnod[1]-0.12422599874998837*fnod[0]; 

    shifted_node = true;
  }

  return shifted_node;

}
