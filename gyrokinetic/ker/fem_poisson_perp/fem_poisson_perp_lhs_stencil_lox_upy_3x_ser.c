#include <gkyl_fem_poisson_perp_kernels.h> 
 
void fem_poisson_perp_lhs_stencil_3x_ser_p1_lox_periodicx_upy_periodicy(const double *epsilon, const double *kSq, const double *dx, const double *bcVals, const long *globalIdxs, gkyl_mat_triples *tri) 
{ 
  // epsilon: permittivity tensor.
  // kSq: wave number squared (factor multiplying phi).
  // dx: cell length in each direction.
  // bcVals: values to impose as BCs, i.e. bcVals[off+0]*phi+bcVals[off+1]*epsilon^{ij}*d(phi)/dx_j=bcVals[off+2].
  // globalIdxs: global linear index of each basis function/node in current cell.
  // tri: triples object (i,j,val), i.e. contribute val to i,j element of the global matrix.

  const double *epsxx = &epsilon[0];
  const double *epsxy = &epsilon[8];
  const double *epsyy = &epsilon[16];

  double rdx00 = 4.0/(dx[0]*dx[0]);
  double rdx01 = 4.0/(dx[0]*dx[1]);
  double rdx11 = 4.0/(dx[1]*dx[1]);

  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[0], 0.05892556509887897*epsyy[5]*rdx11-0.06804138174397717*epsyy[3]*rdx11-0.06804138174397717*epsyy[1]*rdx11+0.07856742013183864*epsyy[0]*rdx11-0.03402069087198858*epsxy[7]*rdx01+0.05892556509887897*epsxy[6]*rdx01+0.05892556509887897*epsxy[5]*rdx01+0.03928371006591931*epsxy[4]*rdx01-0.10206207261596573*epsxy[3]*rdx01-0.06804138174397717*epsxy[2]*rdx01-0.06804138174397717*epsxy[1]*rdx01+0.11785113019775795*epsxy[0]*rdx01+0.05892556509887897*epsxx[6]*rdx00-0.06804138174397717*epsxx[3]*rdx00-0.06804138174397717*epsxx[2]*rdx00+0.07856742013183864*epsxx[0]*rdx00+0.06804138174397717*kSq[7]-0.07856742013183864*kSq[6]-0.07856742013183864*kSq[5]-0.07856742013183864*kSq[4]+0.09072184232530293*kSq[3]+0.09072184232530293*kSq[2]+0.09072184232530293*kSq[1]-0.10475656017578487*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[1], -(0.03402069087198858*epsyy[3]*rdx11)+0.03928371006591931*epsyy[0]*rdx11+0.03402069087198858*epsxy[7]*rdx01-0.05892556509887897*epsxy[5]*rdx01-0.03928371006591931*epsxy[4]*rdx01+0.06804138174397717*epsxy[1]*rdx01-0.05892556509887897*epsxx[6]*rdx00+0.06804138174397717*epsxx[3]*rdx00+0.06804138174397717*epsxx[2]*rdx00-0.07856742013183864*epsxx[0]*rdx00-0.03928371006591931*kSq[6]+0.04536092116265145*kSq[3]+0.04536092116265145*kSq[2]-0.052378280087892436*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[2], -(0.05892556509887897*epsyy[5]*rdx11)+0.06804138174397717*epsyy[3]*rdx11+0.06804138174397717*epsyy[1]*rdx11-0.07856742013183864*epsyy[0]*rdx11+0.03402069087198858*epsxy[7]*rdx01-0.05892556509887897*epsxy[6]*rdx01-0.03928371006591931*epsxy[4]*rdx01+0.06804138174397717*epsxy[2]*rdx01-0.03402069087198858*epsxx[3]*rdx00+0.03928371006591931*epsxx[0]*rdx00-0.03928371006591931*kSq[5]+0.04536092116265145*kSq[3]+0.04536092116265145*kSq[1]-0.052378280087892436*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[3], 0.03402069087198858*epsyy[3]*rdx11-0.03928371006591931*epsyy[0]*rdx11-0.03402069087198858*epsxy[7]*rdx01+0.03928371006591931*epsxy[4]*rdx01+0.10206207261596573*epsxy[3]*rdx01-0.11785113019775795*epsxy[0]*rdx01+0.03402069087198858*epsxx[3]*rdx00-0.03928371006591931*epsxx[0]*rdx00+0.022680460581325723*kSq[3]-0.026189140043946214*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[4], -(0.03402069087198858*epsyy[1]*rdx11)+0.03928371006591931*epsyy[0]*rdx11+0.019641855032959656*epsxy[4]*rdx01-0.03402069087198858*epsxy[2]*rdx01-0.03402069087198858*epsxy[1]*rdx01+0.05892556509887897*epsxy[0]*rdx01-0.03402069087198858*epsxx[2]*rdx00+0.03928371006591931*epsxx[0]*rdx00-0.03928371006591931*kSq[4]+0.04536092116265145*kSq[2]+0.04536092116265145*kSq[1]-0.052378280087892436*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[5], 0.019641855032959656*epsyy[0]*rdx11-0.019641855032959656*epsxy[4]*rdx01+0.03402069087198858*epsxy[1]*rdx01+0.03402069087198858*epsxx[2]*rdx00-0.03928371006591931*epsxx[0]*rdx00+0.022680460581325723*kSq[2]-0.026189140043946214*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[6], 0.03402069087198858*epsyy[1]*rdx11-0.03928371006591931*epsyy[0]*rdx11-0.019641855032959656*epsxy[4]*rdx01+0.03402069087198858*epsxy[2]*rdx01+0.019641855032959656*epsxx[0]*rdx00+0.022680460581325723*kSq[1]-0.026189140043946214*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[7], -(0.019641855032959656*epsyy[0]*rdx11)+0.019641855032959656*epsxy[4]*rdx01-0.05892556509887897*epsxy[0]*rdx01-0.019641855032959656*epsxx[0]*rdx00-0.013094570021973104*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[0], -(0.03402069087198858*epsyy[3]*rdx11)+0.03928371006591931*epsyy[0]*rdx11+0.03402069087198858*epsxy[7]*rdx01-0.05892556509887897*epsxy[5]*rdx01-0.03928371006591931*epsxy[4]*rdx01+0.06804138174397717*epsxy[1]*rdx01-0.05892556509887897*epsxx[6]*rdx00+0.06804138174397717*epsxx[3]*rdx00+0.06804138174397717*epsxx[2]*rdx00-0.07856742013183864*epsxx[0]*rdx00-0.03928371006591931*kSq[6]+0.04536092116265145*kSq[3]+0.04536092116265145*kSq[2]-0.052378280087892436*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[1], -(0.05892556509887897*epsyy[5]*rdx11)-0.06804138174397717*epsyy[3]*rdx11+0.06804138174397717*epsyy[1]*rdx11+0.07856742013183864*epsyy[0]*rdx11-0.03402069087198858*epsxy[7]*rdx01-0.05892556509887897*epsxy[6]*rdx01+0.05892556509887897*epsxy[5]*rdx01+0.03928371006591931*epsxy[4]*rdx01+0.10206207261596573*epsxy[3]*rdx01+0.06804138174397717*epsxy[2]*rdx01-0.06804138174397717*epsxy[1]*rdx01-0.11785113019775795*epsxy[0]*rdx01+0.05892556509887897*epsxx[6]*rdx00-0.06804138174397717*epsxx[3]*rdx00-0.06804138174397717*epsxx[2]*rdx00+0.07856742013183864*epsxx[0]*rdx00-0.06804138174397717*kSq[7]-0.07856742013183864*kSq[6]+0.07856742013183864*kSq[5]+0.07856742013183864*kSq[4]+0.09072184232530293*kSq[3]+0.09072184232530293*kSq[2]-0.09072184232530293*kSq[1]-0.10475656017578487*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[2], 0.03402069087198858*epsyy[3]*rdx11-0.03928371006591931*epsyy[0]*rdx11-0.03402069087198858*epsxy[7]*rdx01+0.03928371006591931*epsxy[4]*rdx01-0.10206207261596573*epsxy[3]*rdx01+0.11785113019775795*epsxy[0]*rdx01+0.03402069087198858*epsxx[3]*rdx00-0.03928371006591931*epsxx[0]*rdx00+0.022680460581325723*kSq[3]-0.026189140043946214*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[3], 0.05892556509887897*epsyy[5]*rdx11+0.06804138174397717*epsyy[3]*rdx11-0.06804138174397717*epsyy[1]*rdx11-0.07856742013183864*epsyy[0]*rdx11+0.03402069087198858*epsxy[7]*rdx01+0.05892556509887897*epsxy[6]*rdx01-0.03928371006591931*epsxy[4]*rdx01-0.06804138174397717*epsxy[2]*rdx01-0.03402069087198858*epsxx[3]*rdx00+0.03928371006591931*epsxx[0]*rdx00+0.03928371006591931*kSq[5]+0.04536092116265145*kSq[3]-0.04536092116265145*kSq[1]-0.052378280087892436*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[4], 0.019641855032959656*epsyy[0]*rdx11-0.019641855032959656*epsxy[4]*rdx01+0.03402069087198858*epsxy[1]*rdx01+0.03402069087198858*epsxx[2]*rdx00-0.03928371006591931*epsxx[0]*rdx00+0.022680460581325723*kSq[2]-0.026189140043946214*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[5], 0.03402069087198858*epsyy[1]*rdx11+0.03928371006591931*epsyy[0]*rdx11+0.019641855032959656*epsxy[4]*rdx01+0.03402069087198858*epsxy[2]*rdx01-0.03402069087198858*epsxy[1]*rdx01-0.05892556509887897*epsxy[0]*rdx01-0.03402069087198858*epsxx[2]*rdx00+0.03928371006591931*epsxx[0]*rdx00+0.03928371006591931*kSq[4]+0.04536092116265145*kSq[2]-0.04536092116265145*kSq[1]-0.052378280087892436*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[6], -(0.019641855032959656*epsyy[0]*rdx11)+0.019641855032959656*epsxy[4]*rdx01+0.05892556509887897*epsxy[0]*rdx01-0.019641855032959656*epsxx[0]*rdx00-0.013094570021973104*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[7], -(0.03402069087198858*epsyy[1]*rdx11)-0.03928371006591931*epsyy[0]*rdx11-0.019641855032959656*epsxy[4]*rdx01-0.03402069087198858*epsxy[2]*rdx01+0.019641855032959656*epsxx[0]*rdx00-0.022680460581325723*kSq[1]-0.026189140043946214*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[0], -(0.05892556509887897*epsyy[5]*rdx11)+0.06804138174397717*epsyy[3]*rdx11+0.06804138174397717*epsyy[1]*rdx11-0.07856742013183864*epsyy[0]*rdx11+0.03402069087198858*epsxy[7]*rdx01-0.05892556509887897*epsxy[6]*rdx01-0.03928371006591931*epsxy[4]*rdx01+0.06804138174397717*epsxy[2]*rdx01-0.03402069087198858*epsxx[3]*rdx00+0.03928371006591931*epsxx[0]*rdx00-0.03928371006591931*kSq[5]+0.04536092116265145*kSq[3]+0.04536092116265145*kSq[1]-0.052378280087892436*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[1], 0.03402069087198858*epsyy[3]*rdx11-0.03928371006591931*epsyy[0]*rdx11-0.03402069087198858*epsxy[7]*rdx01+0.03928371006591931*epsxy[4]*rdx01-0.10206207261596573*epsxy[3]*rdx01+0.11785113019775795*epsxy[0]*rdx01+0.03402069087198858*epsxx[3]*rdx00-0.03928371006591931*epsxx[0]*rdx00+0.022680460581325723*kSq[3]-0.026189140043946214*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[2], 0.05892556509887897*epsyy[5]*rdx11-0.06804138174397717*epsyy[3]*rdx11-0.06804138174397717*epsyy[1]*rdx11+0.07856742013183864*epsyy[0]*rdx11-0.03402069087198858*epsxy[7]*rdx01+0.05892556509887897*epsxy[6]*rdx01-0.05892556509887897*epsxy[5]*rdx01+0.03928371006591931*epsxy[4]*rdx01+0.10206207261596573*epsxy[3]*rdx01-0.06804138174397717*epsxy[2]*rdx01+0.06804138174397717*epsxy[1]*rdx01-0.11785113019775795*epsxy[0]*rdx01-0.05892556509887897*epsxx[6]*rdx00-0.06804138174397717*epsxx[3]*rdx00+0.06804138174397717*epsxx[2]*rdx00+0.07856742013183864*epsxx[0]*rdx00-0.06804138174397717*kSq[7]+0.07856742013183864*kSq[6]-0.07856742013183864*kSq[5]+0.07856742013183864*kSq[4]+0.09072184232530293*kSq[3]-0.09072184232530293*kSq[2]+0.09072184232530293*kSq[1]-0.10475656017578487*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[3], -(0.03402069087198858*epsyy[3]*rdx11)+0.03928371006591931*epsyy[0]*rdx11+0.03402069087198858*epsxy[7]*rdx01+0.05892556509887897*epsxy[5]*rdx01-0.03928371006591931*epsxy[4]*rdx01-0.06804138174397717*epsxy[1]*rdx01+0.05892556509887897*epsxx[6]*rdx00+0.06804138174397717*epsxx[3]*rdx00-0.06804138174397717*epsxx[2]*rdx00-0.07856742013183864*epsxx[0]*rdx00+0.03928371006591931*kSq[6]+0.04536092116265145*kSq[3]-0.04536092116265145*kSq[2]-0.052378280087892436*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[4], 0.03402069087198858*epsyy[1]*rdx11-0.03928371006591931*epsyy[0]*rdx11-0.019641855032959656*epsxy[4]*rdx01+0.03402069087198858*epsxy[2]*rdx01+0.019641855032959656*epsxx[0]*rdx00+0.022680460581325723*kSq[1]-0.026189140043946214*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[5], -(0.019641855032959656*epsyy[0]*rdx11)+0.019641855032959656*epsxy[4]*rdx01+0.05892556509887897*epsxy[0]*rdx01-0.019641855032959656*epsxx[0]*rdx00-0.013094570021973104*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[6], -(0.03402069087198858*epsyy[1]*rdx11)+0.03928371006591931*epsyy[0]*rdx11+0.019641855032959656*epsxy[4]*rdx01-0.03402069087198858*epsxy[2]*rdx01+0.03402069087198858*epsxy[1]*rdx01-0.05892556509887897*epsxy[0]*rdx01+0.03402069087198858*epsxx[2]*rdx00+0.03928371006591931*epsxx[0]*rdx00+0.03928371006591931*kSq[4]-0.04536092116265145*kSq[2]+0.04536092116265145*kSq[1]-0.052378280087892436*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[7], 0.019641855032959656*epsyy[0]*rdx11-0.019641855032959656*epsxy[4]*rdx01-0.03402069087198858*epsxy[1]*rdx01-0.03402069087198858*epsxx[2]*rdx00-0.03928371006591931*epsxx[0]*rdx00-0.022680460581325723*kSq[2]-0.026189140043946214*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[0], 0.03402069087198858*epsyy[3]*rdx11-0.03928371006591931*epsyy[0]*rdx11-0.03402069087198858*epsxy[7]*rdx01+0.03928371006591931*epsxy[4]*rdx01+0.10206207261596573*epsxy[3]*rdx01-0.11785113019775795*epsxy[0]*rdx01+0.03402069087198858*epsxx[3]*rdx00-0.03928371006591931*epsxx[0]*rdx00+0.022680460581325723*kSq[3]-0.026189140043946214*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[1], 0.05892556509887897*epsyy[5]*rdx11+0.06804138174397717*epsyy[3]*rdx11-0.06804138174397717*epsyy[1]*rdx11-0.07856742013183864*epsyy[0]*rdx11+0.03402069087198858*epsxy[7]*rdx01+0.05892556509887897*epsxy[6]*rdx01-0.03928371006591931*epsxy[4]*rdx01-0.06804138174397717*epsxy[2]*rdx01-0.03402069087198858*epsxx[3]*rdx00+0.03928371006591931*epsxx[0]*rdx00+0.03928371006591931*kSq[5]+0.04536092116265145*kSq[3]-0.04536092116265145*kSq[1]-0.052378280087892436*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[2], -(0.03402069087198858*epsyy[3]*rdx11)+0.03928371006591931*epsyy[0]*rdx11+0.03402069087198858*epsxy[7]*rdx01+0.05892556509887897*epsxy[5]*rdx01-0.03928371006591931*epsxy[4]*rdx01-0.06804138174397717*epsxy[1]*rdx01+0.05892556509887897*epsxx[6]*rdx00+0.06804138174397717*epsxx[3]*rdx00-0.06804138174397717*epsxx[2]*rdx00-0.07856742013183864*epsxx[0]*rdx00+0.03928371006591931*kSq[6]+0.04536092116265145*kSq[3]-0.04536092116265145*kSq[2]-0.052378280087892436*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[3], -(0.05892556509887897*epsyy[5]*rdx11)-0.06804138174397717*epsyy[3]*rdx11+0.06804138174397717*epsyy[1]*rdx11+0.07856742013183864*epsyy[0]*rdx11-0.03402069087198858*epsxy[7]*rdx01-0.05892556509887897*epsxy[6]*rdx01-0.05892556509887897*epsxy[5]*rdx01+0.03928371006591931*epsxy[4]*rdx01-0.10206207261596573*epsxy[3]*rdx01+0.06804138174397717*epsxy[2]*rdx01+0.06804138174397717*epsxy[1]*rdx01+0.11785113019775795*epsxy[0]*rdx01-0.05892556509887897*epsxx[6]*rdx00-0.06804138174397717*epsxx[3]*rdx00+0.06804138174397717*epsxx[2]*rdx00+0.07856742013183864*epsxx[0]*rdx00+0.06804138174397717*kSq[7]+0.07856742013183864*kSq[6]+0.07856742013183864*kSq[5]-0.07856742013183864*kSq[4]+0.09072184232530293*kSq[3]-0.09072184232530293*kSq[2]-0.09072184232530293*kSq[1]-0.10475656017578487*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[4], -(0.019641855032959656*epsyy[0]*rdx11)+0.019641855032959656*epsxy[4]*rdx01-0.05892556509887897*epsxy[0]*rdx01-0.019641855032959656*epsxx[0]*rdx00-0.013094570021973104*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[5], -(0.03402069087198858*epsyy[1]*rdx11)-0.03928371006591931*epsyy[0]*rdx11-0.019641855032959656*epsxy[4]*rdx01-0.03402069087198858*epsxy[2]*rdx01+0.019641855032959656*epsxx[0]*rdx00-0.022680460581325723*kSq[1]-0.026189140043946214*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[6], 0.019641855032959656*epsyy[0]*rdx11-0.019641855032959656*epsxy[4]*rdx01-0.03402069087198858*epsxy[1]*rdx01-0.03402069087198858*epsxx[2]*rdx00-0.03928371006591931*epsxx[0]*rdx00-0.022680460581325723*kSq[2]-0.026189140043946214*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[7], 0.03402069087198858*epsyy[1]*rdx11+0.03928371006591931*epsyy[0]*rdx11+0.019641855032959656*epsxy[4]*rdx01+0.03402069087198858*epsxy[2]*rdx01+0.03402069087198858*epsxy[1]*rdx01+0.05892556509887897*epsxy[0]*rdx01+0.03402069087198858*epsxx[2]*rdx00+0.03928371006591931*epsxx[0]*rdx00-0.03928371006591931*kSq[4]-0.04536092116265145*kSq[2]-0.04536092116265145*kSq[1]-0.052378280087892436*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[4], globalIdxs[0], -(0.03402069087198858*epsyy[1]*rdx11)+0.03928371006591931*epsyy[0]*rdx11+0.019641855032959656*epsxy[4]*rdx01-0.03402069087198858*epsxy[2]*rdx01-0.03402069087198858*epsxy[1]*rdx01+0.05892556509887897*epsxy[0]*rdx01-0.03402069087198858*epsxx[2]*rdx00+0.03928371006591931*epsxx[0]*rdx00-0.03928371006591931*kSq[4]+0.04536092116265145*kSq[2]+0.04536092116265145*kSq[1]-0.052378280087892436*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[4], globalIdxs[1], 0.019641855032959656*epsyy[0]*rdx11-0.019641855032959656*epsxy[4]*rdx01+0.03402069087198858*epsxy[1]*rdx01+0.03402069087198858*epsxx[2]*rdx00-0.03928371006591931*epsxx[0]*rdx00+0.022680460581325723*kSq[2]-0.026189140043946214*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[4], globalIdxs[2], 0.03402069087198858*epsyy[1]*rdx11-0.03928371006591931*epsyy[0]*rdx11-0.019641855032959656*epsxy[4]*rdx01+0.03402069087198858*epsxy[2]*rdx01+0.019641855032959656*epsxx[0]*rdx00+0.022680460581325723*kSq[1]-0.026189140043946214*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[4], globalIdxs[3], -(0.019641855032959656*epsyy[0]*rdx11)+0.019641855032959656*epsxy[4]*rdx01-0.05892556509887897*epsxy[0]*rdx01-0.019641855032959656*epsxx[0]*rdx00-0.013094570021973104*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[4], globalIdxs[4], -(0.05892556509887897*epsyy[5]*rdx11)+0.06804138174397717*epsyy[3]*rdx11-0.06804138174397717*epsyy[1]*rdx11+0.07856742013183864*epsyy[0]*rdx11+0.03402069087198858*epsxy[7]*rdx01-0.05892556509887897*epsxy[6]*rdx01-0.05892556509887897*epsxy[5]*rdx01+0.03928371006591931*epsxy[4]*rdx01+0.10206207261596573*epsxy[3]*rdx01-0.06804138174397717*epsxy[2]*rdx01-0.06804138174397717*epsxy[1]*rdx01+0.11785113019775795*epsxy[0]*rdx01-0.05892556509887897*epsxx[6]*rdx00+0.06804138174397717*epsxx[3]*rdx00-0.06804138174397717*epsxx[2]*rdx00+0.07856742013183864*epsxx[0]*rdx00-0.06804138174397717*kSq[7]+0.07856742013183864*kSq[6]+0.07856742013183864*kSq[5]-0.07856742013183864*kSq[4]-0.09072184232530293*kSq[3]+0.09072184232530293*kSq[2]+0.09072184232530293*kSq[1]-0.10475656017578487*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[4], globalIdxs[5], 0.03402069087198858*epsyy[3]*rdx11+0.03928371006591931*epsyy[0]*rdx11-0.03402069087198858*epsxy[7]*rdx01+0.05892556509887897*epsxy[5]*rdx01-0.03928371006591931*epsxy[4]*rdx01+0.06804138174397717*epsxy[1]*rdx01+0.05892556509887897*epsxx[6]*rdx00-0.06804138174397717*epsxx[3]*rdx00+0.06804138174397717*epsxx[2]*rdx00-0.07856742013183864*epsxx[0]*rdx00+0.03928371006591931*kSq[6]-0.04536092116265145*kSq[3]+0.04536092116265145*kSq[2]-0.052378280087892436*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[4], globalIdxs[6], 0.05892556509887897*epsyy[5]*rdx11-0.06804138174397717*epsyy[3]*rdx11+0.06804138174397717*epsyy[1]*rdx11-0.07856742013183864*epsyy[0]*rdx11-0.03402069087198858*epsxy[7]*rdx01+0.05892556509887897*epsxy[6]*rdx01-0.03928371006591931*epsxy[4]*rdx01+0.06804138174397717*epsxy[2]*rdx01+0.03402069087198858*epsxx[3]*rdx00+0.03928371006591931*epsxx[0]*rdx00+0.03928371006591931*kSq[5]-0.04536092116265145*kSq[3]+0.04536092116265145*kSq[1]-0.052378280087892436*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[4], globalIdxs[7], -(0.03402069087198858*epsyy[3]*rdx11)-0.03928371006591931*epsyy[0]*rdx11+0.03402069087198858*epsxy[7]*rdx01+0.03928371006591931*epsxy[4]*rdx01-0.10206207261596573*epsxy[3]*rdx01-0.11785113019775795*epsxy[0]*rdx01-0.03402069087198858*epsxx[3]*rdx00-0.03928371006591931*epsxx[0]*rdx00-0.022680460581325723*kSq[3]-0.026189140043946214*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[5], globalIdxs[0], 0.019641855032959656*epsyy[0]*rdx11-0.019641855032959656*epsxy[4]*rdx01+0.03402069087198858*epsxy[1]*rdx01+0.03402069087198858*epsxx[2]*rdx00-0.03928371006591931*epsxx[0]*rdx00+0.022680460581325723*kSq[2]-0.026189140043946214*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[5], globalIdxs[1], 0.03402069087198858*epsyy[1]*rdx11+0.03928371006591931*epsyy[0]*rdx11+0.019641855032959656*epsxy[4]*rdx01+0.03402069087198858*epsxy[2]*rdx01-0.03402069087198858*epsxy[1]*rdx01-0.05892556509887897*epsxy[0]*rdx01-0.03402069087198858*epsxx[2]*rdx00+0.03928371006591931*epsxx[0]*rdx00+0.03928371006591931*kSq[4]+0.04536092116265145*kSq[2]-0.04536092116265145*kSq[1]-0.052378280087892436*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[5], globalIdxs[2], -(0.019641855032959656*epsyy[0]*rdx11)+0.019641855032959656*epsxy[4]*rdx01+0.05892556509887897*epsxy[0]*rdx01-0.019641855032959656*epsxx[0]*rdx00-0.013094570021973104*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[5], globalIdxs[3], -(0.03402069087198858*epsyy[1]*rdx11)-0.03928371006591931*epsyy[0]*rdx11-0.019641855032959656*epsxy[4]*rdx01-0.03402069087198858*epsxy[2]*rdx01+0.019641855032959656*epsxx[0]*rdx00-0.022680460581325723*kSq[1]-0.026189140043946214*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[5], globalIdxs[4], 0.03402069087198858*epsyy[3]*rdx11+0.03928371006591931*epsyy[0]*rdx11-0.03402069087198858*epsxy[7]*rdx01+0.05892556509887897*epsxy[5]*rdx01-0.03928371006591931*epsxy[4]*rdx01+0.06804138174397717*epsxy[1]*rdx01+0.05892556509887897*epsxx[6]*rdx00-0.06804138174397717*epsxx[3]*rdx00+0.06804138174397717*epsxx[2]*rdx00-0.07856742013183864*epsxx[0]*rdx00+0.03928371006591931*kSq[6]-0.04536092116265145*kSq[3]+0.04536092116265145*kSq[2]-0.052378280087892436*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[5], globalIdxs[5], 0.05892556509887897*epsyy[5]*rdx11+0.06804138174397717*epsyy[3]*rdx11+0.06804138174397717*epsyy[1]*rdx11+0.07856742013183864*epsyy[0]*rdx11+0.03402069087198858*epsxy[7]*rdx01+0.05892556509887897*epsxy[6]*rdx01-0.05892556509887897*epsxy[5]*rdx01+0.03928371006591931*epsxy[4]*rdx01-0.10206207261596573*epsxy[3]*rdx01+0.06804138174397717*epsxy[2]*rdx01-0.06804138174397717*epsxy[1]*rdx01-0.11785113019775795*epsxy[0]*rdx01-0.05892556509887897*epsxx[6]*rdx00+0.06804138174397717*epsxx[3]*rdx00-0.06804138174397717*epsxx[2]*rdx00+0.07856742013183864*epsxx[0]*rdx00+0.06804138174397717*kSq[7]+0.07856742013183864*kSq[6]-0.07856742013183864*kSq[5]+0.07856742013183864*kSq[4]-0.09072184232530293*kSq[3]+0.09072184232530293*kSq[2]-0.09072184232530293*kSq[1]-0.10475656017578487*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[5], globalIdxs[6], -(0.03402069087198858*epsyy[3]*rdx11)-0.03928371006591931*epsyy[0]*rdx11+0.03402069087198858*epsxy[7]*rdx01+0.03928371006591931*epsxy[4]*rdx01+0.10206207261596573*epsxy[3]*rdx01+0.11785113019775795*epsxy[0]*rdx01-0.03402069087198858*epsxx[3]*rdx00-0.03928371006591931*epsxx[0]*rdx00-0.022680460581325723*kSq[3]-0.026189140043946214*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[5], globalIdxs[7], -(0.05892556509887897*epsyy[5]*rdx11)-0.06804138174397717*epsyy[3]*rdx11-0.06804138174397717*epsyy[1]*rdx11-0.07856742013183864*epsyy[0]*rdx11-0.03402069087198858*epsxy[7]*rdx01-0.05892556509887897*epsxy[6]*rdx01-0.03928371006591931*epsxy[4]*rdx01-0.06804138174397717*epsxy[2]*rdx01+0.03402069087198858*epsxx[3]*rdx00+0.03928371006591931*epsxx[0]*rdx00-0.03928371006591931*kSq[5]-0.04536092116265145*kSq[3]-0.04536092116265145*kSq[1]-0.052378280087892436*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[6], globalIdxs[0], 0.03402069087198858*epsyy[1]*rdx11-0.03928371006591931*epsyy[0]*rdx11-0.019641855032959656*epsxy[4]*rdx01+0.03402069087198858*epsxy[2]*rdx01+0.019641855032959656*epsxx[0]*rdx00+0.022680460581325723*kSq[1]-0.026189140043946214*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[6], globalIdxs[1], -(0.019641855032959656*epsyy[0]*rdx11)+0.019641855032959656*epsxy[4]*rdx01+0.05892556509887897*epsxy[0]*rdx01-0.019641855032959656*epsxx[0]*rdx00-0.013094570021973104*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[6], globalIdxs[2], -(0.03402069087198858*epsyy[1]*rdx11)+0.03928371006591931*epsyy[0]*rdx11+0.019641855032959656*epsxy[4]*rdx01-0.03402069087198858*epsxy[2]*rdx01+0.03402069087198858*epsxy[1]*rdx01-0.05892556509887897*epsxy[0]*rdx01+0.03402069087198858*epsxx[2]*rdx00+0.03928371006591931*epsxx[0]*rdx00+0.03928371006591931*kSq[4]-0.04536092116265145*kSq[2]+0.04536092116265145*kSq[1]-0.052378280087892436*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[6], globalIdxs[3], 0.019641855032959656*epsyy[0]*rdx11-0.019641855032959656*epsxy[4]*rdx01-0.03402069087198858*epsxy[1]*rdx01-0.03402069087198858*epsxx[2]*rdx00-0.03928371006591931*epsxx[0]*rdx00-0.022680460581325723*kSq[2]-0.026189140043946214*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[6], globalIdxs[4], 0.05892556509887897*epsyy[5]*rdx11-0.06804138174397717*epsyy[3]*rdx11+0.06804138174397717*epsyy[1]*rdx11-0.07856742013183864*epsyy[0]*rdx11-0.03402069087198858*epsxy[7]*rdx01+0.05892556509887897*epsxy[6]*rdx01-0.03928371006591931*epsxy[4]*rdx01+0.06804138174397717*epsxy[2]*rdx01+0.03402069087198858*epsxx[3]*rdx00+0.03928371006591931*epsxx[0]*rdx00+0.03928371006591931*kSq[5]-0.04536092116265145*kSq[3]+0.04536092116265145*kSq[1]-0.052378280087892436*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[6], globalIdxs[5], -(0.03402069087198858*epsyy[3]*rdx11)-0.03928371006591931*epsyy[0]*rdx11+0.03402069087198858*epsxy[7]*rdx01+0.03928371006591931*epsxy[4]*rdx01+0.10206207261596573*epsxy[3]*rdx01+0.11785113019775795*epsxy[0]*rdx01-0.03402069087198858*epsxx[3]*rdx00-0.03928371006591931*epsxx[0]*rdx00-0.022680460581325723*kSq[3]-0.026189140043946214*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[6], globalIdxs[6], -(0.05892556509887897*epsyy[5]*rdx11)+0.06804138174397717*epsyy[3]*rdx11-0.06804138174397717*epsyy[1]*rdx11+0.07856742013183864*epsyy[0]*rdx11+0.03402069087198858*epsxy[7]*rdx01-0.05892556509887897*epsxy[6]*rdx01+0.05892556509887897*epsxy[5]*rdx01+0.03928371006591931*epsxy[4]*rdx01-0.10206207261596573*epsxy[3]*rdx01-0.06804138174397717*epsxy[2]*rdx01+0.06804138174397717*epsxy[1]*rdx01-0.11785113019775795*epsxy[0]*rdx01+0.05892556509887897*epsxx[6]*rdx00+0.06804138174397717*epsxx[3]*rdx00+0.06804138174397717*epsxx[2]*rdx00+0.07856742013183864*epsxx[0]*rdx00+0.06804138174397717*kSq[7]-0.07856742013183864*kSq[6]+0.07856742013183864*kSq[5]+0.07856742013183864*kSq[4]-0.09072184232530293*kSq[3]-0.09072184232530293*kSq[2]+0.09072184232530293*kSq[1]-0.10475656017578487*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[6], globalIdxs[7], 0.03402069087198858*epsyy[3]*rdx11+0.03928371006591931*epsyy[0]*rdx11-0.03402069087198858*epsxy[7]*rdx01-0.05892556509887897*epsxy[5]*rdx01-0.03928371006591931*epsxy[4]*rdx01-0.06804138174397717*epsxy[1]*rdx01-0.05892556509887897*epsxx[6]*rdx00-0.06804138174397717*epsxx[3]*rdx00-0.06804138174397717*epsxx[2]*rdx00-0.07856742013183864*epsxx[0]*rdx00-0.03928371006591931*kSq[6]-0.04536092116265145*kSq[3]-0.04536092116265145*kSq[2]-0.052378280087892436*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[7], globalIdxs[0], -(0.019641855032959656*epsyy[0]*rdx11)+0.019641855032959656*epsxy[4]*rdx01-0.05892556509887897*epsxy[0]*rdx01-0.019641855032959656*epsxx[0]*rdx00-0.013094570021973104*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[7], globalIdxs[1], -(0.03402069087198858*epsyy[1]*rdx11)-0.03928371006591931*epsyy[0]*rdx11-0.019641855032959656*epsxy[4]*rdx01-0.03402069087198858*epsxy[2]*rdx01+0.019641855032959656*epsxx[0]*rdx00-0.022680460581325723*kSq[1]-0.026189140043946214*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[7], globalIdxs[2], 0.019641855032959656*epsyy[0]*rdx11-0.019641855032959656*epsxy[4]*rdx01-0.03402069087198858*epsxy[1]*rdx01-0.03402069087198858*epsxx[2]*rdx00-0.03928371006591931*epsxx[0]*rdx00-0.022680460581325723*kSq[2]-0.026189140043946214*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[7], globalIdxs[3], 0.03402069087198858*epsyy[1]*rdx11+0.03928371006591931*epsyy[0]*rdx11+0.019641855032959656*epsxy[4]*rdx01+0.03402069087198858*epsxy[2]*rdx01+0.03402069087198858*epsxy[1]*rdx01+0.05892556509887897*epsxy[0]*rdx01+0.03402069087198858*epsxx[2]*rdx00+0.03928371006591931*epsxx[0]*rdx00-0.03928371006591931*kSq[4]-0.04536092116265145*kSq[2]-0.04536092116265145*kSq[1]-0.052378280087892436*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[7], globalIdxs[4], -(0.03402069087198858*epsyy[3]*rdx11)-0.03928371006591931*epsyy[0]*rdx11+0.03402069087198858*epsxy[7]*rdx01+0.03928371006591931*epsxy[4]*rdx01-0.10206207261596573*epsxy[3]*rdx01-0.11785113019775795*epsxy[0]*rdx01-0.03402069087198858*epsxx[3]*rdx00-0.03928371006591931*epsxx[0]*rdx00-0.022680460581325723*kSq[3]-0.026189140043946214*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[7], globalIdxs[5], -(0.05892556509887897*epsyy[5]*rdx11)-0.06804138174397717*epsyy[3]*rdx11-0.06804138174397717*epsyy[1]*rdx11-0.07856742013183864*epsyy[0]*rdx11-0.03402069087198858*epsxy[7]*rdx01-0.05892556509887897*epsxy[6]*rdx01-0.03928371006591931*epsxy[4]*rdx01-0.06804138174397717*epsxy[2]*rdx01+0.03402069087198858*epsxx[3]*rdx00+0.03928371006591931*epsxx[0]*rdx00-0.03928371006591931*kSq[5]-0.04536092116265145*kSq[3]-0.04536092116265145*kSq[1]-0.052378280087892436*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[7], globalIdxs[6], 0.03402069087198858*epsyy[3]*rdx11+0.03928371006591931*epsyy[0]*rdx11-0.03402069087198858*epsxy[7]*rdx01-0.05892556509887897*epsxy[5]*rdx01-0.03928371006591931*epsxy[4]*rdx01-0.06804138174397717*epsxy[1]*rdx01-0.05892556509887897*epsxx[6]*rdx00-0.06804138174397717*epsxx[3]*rdx00-0.06804138174397717*epsxx[2]*rdx00-0.07856742013183864*epsxx[0]*rdx00-0.03928371006591931*kSq[6]-0.04536092116265145*kSq[3]-0.04536092116265145*kSq[2]-0.052378280087892436*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[7], globalIdxs[7], 0.05892556509887897*epsyy[5]*rdx11+0.06804138174397717*epsyy[3]*rdx11+0.06804138174397717*epsyy[1]*rdx11+0.07856742013183864*epsyy[0]*rdx11+0.03402069087198858*epsxy[7]*rdx01+0.05892556509887897*epsxy[6]*rdx01+0.05892556509887897*epsxy[5]*rdx01+0.03928371006591931*epsxy[4]*rdx01+0.10206207261596573*epsxy[3]*rdx01+0.06804138174397717*epsxy[2]*rdx01+0.06804138174397717*epsxy[1]*rdx01+0.11785113019775795*epsxy[0]*rdx01+0.05892556509887897*epsxx[6]*rdx00+0.06804138174397717*epsxx[3]*rdx00+0.06804138174397717*epsxx[2]*rdx00+0.07856742013183864*epsxx[0]*rdx00-0.06804138174397717*kSq[7]-0.07856742013183864*kSq[6]-0.07856742013183864*kSq[5]-0.07856742013183864*kSq[4]-0.09072184232530293*kSq[3]-0.09072184232530293*kSq[2]-0.09072184232530293*kSq[1]-0.10475656017578487*kSq[0]);

}

void fem_poisson_perp_lhs_stencil_3x_ser_p1_lox_periodicx_upy_dirichlety(const double *epsilon, const double *kSq, const double *dx, const double *bcVals, const long *globalIdxs, gkyl_mat_triples *tri) 
{ 
  // epsilon: permittivity tensor.
  // kSq: wave number squared (factor multiplying phi).
  // dx: cell length in each direction.
  // bcVals: values to impose as BCs, i.e. bcVals[off+0]*phi+bcVals[off+1]*epsilon^{ij}*d(phi)/dx_j=bcVals[off+2].
  // globalIdxs: global linear index of each basis function/node in current cell.
  // tri: triples object (i,j,val), i.e. contribute val to i,j element of the global matrix.

  const double *epsxx = &epsilon[0];
  const double *epsxy = &epsilon[8];
  const double *epsyy = &epsilon[16];

  double rdx00 = 4.0/(dx[0]*dx[0]);
  double rdx01 = 4.0/(dx[0]*dx[1]);
  double rdx11 = 4.0/(dx[1]*dx[1]);

  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[0], 0.05892556509887897*epsyy[5]*rdx11-0.06804138174397717*epsyy[3]*rdx11-0.06804138174397717*epsyy[1]*rdx11+0.07856742013183864*epsyy[0]*rdx11-0.03402069087198858*epsxy[7]*rdx01+0.05892556509887897*epsxy[6]*rdx01+0.05892556509887897*epsxy[5]*rdx01+0.03928371006591931*epsxy[4]*rdx01-0.10206207261596573*epsxy[3]*rdx01-0.06804138174397717*epsxy[2]*rdx01-0.06804138174397717*epsxy[1]*rdx01+0.11785113019775795*epsxy[0]*rdx01+0.05892556509887897*epsxx[6]*rdx00-0.06804138174397717*epsxx[3]*rdx00-0.06804138174397717*epsxx[2]*rdx00+0.07856742013183864*epsxx[0]*rdx00+0.06804138174397717*kSq[7]-0.07856742013183864*kSq[6]-0.07856742013183864*kSq[5]-0.07856742013183864*kSq[4]+0.09072184232530293*kSq[3]+0.09072184232530293*kSq[2]+0.09072184232530293*kSq[1]-0.10475656017578487*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[1], -(0.03402069087198858*epsyy[3]*rdx11)+0.03928371006591931*epsyy[0]*rdx11+0.03402069087198858*epsxy[7]*rdx01-0.05892556509887897*epsxy[5]*rdx01-0.03928371006591931*epsxy[4]*rdx01+0.06804138174397717*epsxy[1]*rdx01-0.05892556509887897*epsxx[6]*rdx00+0.06804138174397717*epsxx[3]*rdx00+0.06804138174397717*epsxx[2]*rdx00-0.07856742013183864*epsxx[0]*rdx00-0.03928371006591931*kSq[6]+0.04536092116265145*kSq[3]+0.04536092116265145*kSq[2]-0.052378280087892436*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[2], -(0.05892556509887897*epsyy[5]*rdx11)+0.06804138174397717*epsyy[3]*rdx11+0.06804138174397717*epsyy[1]*rdx11-0.07856742013183864*epsyy[0]*rdx11+0.03402069087198858*epsxy[7]*rdx01-0.05892556509887897*epsxy[6]*rdx01-0.03928371006591931*epsxy[4]*rdx01+0.06804138174397717*epsxy[2]*rdx01-0.03402069087198858*epsxx[3]*rdx00+0.03928371006591931*epsxx[0]*rdx00-0.03928371006591931*kSq[5]+0.04536092116265145*kSq[3]+0.04536092116265145*kSq[1]-0.052378280087892436*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[3], 0.03402069087198858*epsyy[3]*rdx11-0.03928371006591931*epsyy[0]*rdx11-0.03402069087198858*epsxy[7]*rdx01+0.03928371006591931*epsxy[4]*rdx01+0.10206207261596573*epsxy[3]*rdx01-0.11785113019775795*epsxy[0]*rdx01+0.03402069087198858*epsxx[3]*rdx00-0.03928371006591931*epsxx[0]*rdx00+0.022680460581325723*kSq[3]-0.026189140043946214*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[4], -(0.03402069087198858*epsyy[1]*rdx11)+0.03928371006591931*epsyy[0]*rdx11+0.019641855032959656*epsxy[4]*rdx01-0.03402069087198858*epsxy[2]*rdx01-0.03402069087198858*epsxy[1]*rdx01+0.05892556509887897*epsxy[0]*rdx01-0.03402069087198858*epsxx[2]*rdx00+0.03928371006591931*epsxx[0]*rdx00-0.03928371006591931*kSq[4]+0.04536092116265145*kSq[2]+0.04536092116265145*kSq[1]-0.052378280087892436*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[5], 0.019641855032959656*epsyy[0]*rdx11-0.019641855032959656*epsxy[4]*rdx01+0.03402069087198858*epsxy[1]*rdx01+0.03402069087198858*epsxx[2]*rdx00-0.03928371006591931*epsxx[0]*rdx00+0.022680460581325723*kSq[2]-0.026189140043946214*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[6], 0.03402069087198858*epsyy[1]*rdx11-0.03928371006591931*epsyy[0]*rdx11-0.019641855032959656*epsxy[4]*rdx01+0.03402069087198858*epsxy[2]*rdx01+0.019641855032959656*epsxx[0]*rdx00+0.022680460581325723*kSq[1]-0.026189140043946214*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[7], -(0.019641855032959656*epsyy[0]*rdx11)+0.019641855032959656*epsxy[4]*rdx01-0.05892556509887897*epsxy[0]*rdx01-0.019641855032959656*epsxx[0]*rdx00-0.013094570021973104*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[0], -(0.03402069087198858*epsyy[3]*rdx11)+0.03928371006591931*epsyy[0]*rdx11+0.03402069087198858*epsxy[7]*rdx01-0.05892556509887897*epsxy[5]*rdx01-0.03928371006591931*epsxy[4]*rdx01+0.06804138174397717*epsxy[1]*rdx01-0.05892556509887897*epsxx[6]*rdx00+0.06804138174397717*epsxx[3]*rdx00+0.06804138174397717*epsxx[2]*rdx00-0.07856742013183864*epsxx[0]*rdx00-0.03928371006591931*kSq[6]+0.04536092116265145*kSq[3]+0.04536092116265145*kSq[2]-0.052378280087892436*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[1], -(0.05892556509887897*epsyy[5]*rdx11)-0.06804138174397717*epsyy[3]*rdx11+0.06804138174397717*epsyy[1]*rdx11+0.07856742013183864*epsyy[0]*rdx11-0.03402069087198858*epsxy[7]*rdx01-0.05892556509887897*epsxy[6]*rdx01+0.05892556509887897*epsxy[5]*rdx01+0.03928371006591931*epsxy[4]*rdx01+0.10206207261596573*epsxy[3]*rdx01+0.06804138174397717*epsxy[2]*rdx01-0.06804138174397717*epsxy[1]*rdx01-0.11785113019775795*epsxy[0]*rdx01+0.05892556509887897*epsxx[6]*rdx00-0.06804138174397717*epsxx[3]*rdx00-0.06804138174397717*epsxx[2]*rdx00+0.07856742013183864*epsxx[0]*rdx00-0.06804138174397717*kSq[7]-0.07856742013183864*kSq[6]+0.07856742013183864*kSq[5]+0.07856742013183864*kSq[4]+0.09072184232530293*kSq[3]+0.09072184232530293*kSq[2]-0.09072184232530293*kSq[1]-0.10475656017578487*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[2], 0.03402069087198858*epsyy[3]*rdx11-0.03928371006591931*epsyy[0]*rdx11-0.03402069087198858*epsxy[7]*rdx01+0.03928371006591931*epsxy[4]*rdx01-0.10206207261596573*epsxy[3]*rdx01+0.11785113019775795*epsxy[0]*rdx01+0.03402069087198858*epsxx[3]*rdx00-0.03928371006591931*epsxx[0]*rdx00+0.022680460581325723*kSq[3]-0.026189140043946214*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[3], 0.05892556509887897*epsyy[5]*rdx11+0.06804138174397717*epsyy[3]*rdx11-0.06804138174397717*epsyy[1]*rdx11-0.07856742013183864*epsyy[0]*rdx11+0.03402069087198858*epsxy[7]*rdx01+0.05892556509887897*epsxy[6]*rdx01-0.03928371006591931*epsxy[4]*rdx01-0.06804138174397717*epsxy[2]*rdx01-0.03402069087198858*epsxx[3]*rdx00+0.03928371006591931*epsxx[0]*rdx00+0.03928371006591931*kSq[5]+0.04536092116265145*kSq[3]-0.04536092116265145*kSq[1]-0.052378280087892436*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[4], 0.019641855032959656*epsyy[0]*rdx11-0.019641855032959656*epsxy[4]*rdx01+0.03402069087198858*epsxy[1]*rdx01+0.03402069087198858*epsxx[2]*rdx00-0.03928371006591931*epsxx[0]*rdx00+0.022680460581325723*kSq[2]-0.026189140043946214*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[5], 0.03402069087198858*epsyy[1]*rdx11+0.03928371006591931*epsyy[0]*rdx11+0.019641855032959656*epsxy[4]*rdx01+0.03402069087198858*epsxy[2]*rdx01-0.03402069087198858*epsxy[1]*rdx01-0.05892556509887897*epsxy[0]*rdx01-0.03402069087198858*epsxx[2]*rdx00+0.03928371006591931*epsxx[0]*rdx00+0.03928371006591931*kSq[4]+0.04536092116265145*kSq[2]-0.04536092116265145*kSq[1]-0.052378280087892436*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[6], -(0.019641855032959656*epsyy[0]*rdx11)+0.019641855032959656*epsxy[4]*rdx01+0.05892556509887897*epsxy[0]*rdx01-0.019641855032959656*epsxx[0]*rdx00-0.013094570021973104*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[7], -(0.03402069087198858*epsyy[1]*rdx11)-0.03928371006591931*epsyy[0]*rdx11-0.019641855032959656*epsxy[4]*rdx01-0.03402069087198858*epsxy[2]*rdx01+0.019641855032959656*epsxx[0]*rdx00-0.022680460581325723*kSq[1]-0.026189140043946214*kSq[0]);
  gkyl_mat_triples_insert(tri, globalIdxs[2], globalIdxs[0], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[2], globalIdxs[1], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[2], globalIdxs[2], 1.0);
  gkyl_mat_triples_insert(tri, globalIdxs[2], globalIdxs[3], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[2], globalIdxs[4], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[2], globalIdxs[5], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[2], globalIdxs[6], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[2], globalIdxs[7], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[3], globalIdxs[0], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[3], globalIdxs[1], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[3], globalIdxs[2], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[3], globalIdxs[3], 1.0);
  gkyl_mat_triples_insert(tri, globalIdxs[3], globalIdxs[4], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[3], globalIdxs[5], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[3], globalIdxs[6], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[3], globalIdxs[7], 0.0);
  gkyl_mat_triples_accum(tri, globalIdxs[4], globalIdxs[0], -(0.03402069087198858*epsyy[1]*rdx11)+0.03928371006591931*epsyy[0]*rdx11+0.019641855032959656*epsxy[4]*rdx01-0.03402069087198858*epsxy[2]*rdx01-0.03402069087198858*epsxy[1]*rdx01+0.05892556509887897*epsxy[0]*rdx01-0.03402069087198858*epsxx[2]*rdx00+0.03928371006591931*epsxx[0]*rdx00-0.03928371006591931*kSq[4]+0.04536092116265145*kSq[2]+0.04536092116265145*kSq[1]-0.052378280087892436*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[4], globalIdxs[1], 0.019641855032959656*epsyy[0]*rdx11-0.019641855032959656*epsxy[4]*rdx01+0.03402069087198858*epsxy[1]*rdx01+0.03402069087198858*epsxx[2]*rdx00-0.03928371006591931*epsxx[0]*rdx00+0.022680460581325723*kSq[2]-0.026189140043946214*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[4], globalIdxs[2], 0.03402069087198858*epsyy[1]*rdx11-0.03928371006591931*epsyy[0]*rdx11-0.019641855032959656*epsxy[4]*rdx01+0.03402069087198858*epsxy[2]*rdx01+0.019641855032959656*epsxx[0]*rdx00+0.022680460581325723*kSq[1]-0.026189140043946214*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[4], globalIdxs[3], -(0.019641855032959656*epsyy[0]*rdx11)+0.019641855032959656*epsxy[4]*rdx01-0.05892556509887897*epsxy[0]*rdx01-0.019641855032959656*epsxx[0]*rdx00-0.013094570021973104*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[4], globalIdxs[4], -(0.05892556509887897*epsyy[5]*rdx11)+0.06804138174397717*epsyy[3]*rdx11-0.06804138174397717*epsyy[1]*rdx11+0.07856742013183864*epsyy[0]*rdx11+0.03402069087198858*epsxy[7]*rdx01-0.05892556509887897*epsxy[6]*rdx01-0.05892556509887897*epsxy[5]*rdx01+0.03928371006591931*epsxy[4]*rdx01+0.10206207261596573*epsxy[3]*rdx01-0.06804138174397717*epsxy[2]*rdx01-0.06804138174397717*epsxy[1]*rdx01+0.11785113019775795*epsxy[0]*rdx01-0.05892556509887897*epsxx[6]*rdx00+0.06804138174397717*epsxx[3]*rdx00-0.06804138174397717*epsxx[2]*rdx00+0.07856742013183864*epsxx[0]*rdx00-0.06804138174397717*kSq[7]+0.07856742013183864*kSq[6]+0.07856742013183864*kSq[5]-0.07856742013183864*kSq[4]-0.09072184232530293*kSq[3]+0.09072184232530293*kSq[2]+0.09072184232530293*kSq[1]-0.10475656017578487*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[4], globalIdxs[5], 0.03402069087198858*epsyy[3]*rdx11+0.03928371006591931*epsyy[0]*rdx11-0.03402069087198858*epsxy[7]*rdx01+0.05892556509887897*epsxy[5]*rdx01-0.03928371006591931*epsxy[4]*rdx01+0.06804138174397717*epsxy[1]*rdx01+0.05892556509887897*epsxx[6]*rdx00-0.06804138174397717*epsxx[3]*rdx00+0.06804138174397717*epsxx[2]*rdx00-0.07856742013183864*epsxx[0]*rdx00+0.03928371006591931*kSq[6]-0.04536092116265145*kSq[3]+0.04536092116265145*kSq[2]-0.052378280087892436*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[4], globalIdxs[6], 0.05892556509887897*epsyy[5]*rdx11-0.06804138174397717*epsyy[3]*rdx11+0.06804138174397717*epsyy[1]*rdx11-0.07856742013183864*epsyy[0]*rdx11-0.03402069087198858*epsxy[7]*rdx01+0.05892556509887897*epsxy[6]*rdx01-0.03928371006591931*epsxy[4]*rdx01+0.06804138174397717*epsxy[2]*rdx01+0.03402069087198858*epsxx[3]*rdx00+0.03928371006591931*epsxx[0]*rdx00+0.03928371006591931*kSq[5]-0.04536092116265145*kSq[3]+0.04536092116265145*kSq[1]-0.052378280087892436*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[4], globalIdxs[7], -(0.03402069087198858*epsyy[3]*rdx11)-0.03928371006591931*epsyy[0]*rdx11+0.03402069087198858*epsxy[7]*rdx01+0.03928371006591931*epsxy[4]*rdx01-0.10206207261596573*epsxy[3]*rdx01-0.11785113019775795*epsxy[0]*rdx01-0.03402069087198858*epsxx[3]*rdx00-0.03928371006591931*epsxx[0]*rdx00-0.022680460581325723*kSq[3]-0.026189140043946214*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[5], globalIdxs[0], 0.019641855032959656*epsyy[0]*rdx11-0.019641855032959656*epsxy[4]*rdx01+0.03402069087198858*epsxy[1]*rdx01+0.03402069087198858*epsxx[2]*rdx00-0.03928371006591931*epsxx[0]*rdx00+0.022680460581325723*kSq[2]-0.026189140043946214*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[5], globalIdxs[1], 0.03402069087198858*epsyy[1]*rdx11+0.03928371006591931*epsyy[0]*rdx11+0.019641855032959656*epsxy[4]*rdx01+0.03402069087198858*epsxy[2]*rdx01-0.03402069087198858*epsxy[1]*rdx01-0.05892556509887897*epsxy[0]*rdx01-0.03402069087198858*epsxx[2]*rdx00+0.03928371006591931*epsxx[0]*rdx00+0.03928371006591931*kSq[4]+0.04536092116265145*kSq[2]-0.04536092116265145*kSq[1]-0.052378280087892436*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[5], globalIdxs[2], -(0.019641855032959656*epsyy[0]*rdx11)+0.019641855032959656*epsxy[4]*rdx01+0.05892556509887897*epsxy[0]*rdx01-0.019641855032959656*epsxx[0]*rdx00-0.013094570021973104*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[5], globalIdxs[3], -(0.03402069087198858*epsyy[1]*rdx11)-0.03928371006591931*epsyy[0]*rdx11-0.019641855032959656*epsxy[4]*rdx01-0.03402069087198858*epsxy[2]*rdx01+0.019641855032959656*epsxx[0]*rdx00-0.022680460581325723*kSq[1]-0.026189140043946214*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[5], globalIdxs[4], 0.03402069087198858*epsyy[3]*rdx11+0.03928371006591931*epsyy[0]*rdx11-0.03402069087198858*epsxy[7]*rdx01+0.05892556509887897*epsxy[5]*rdx01-0.03928371006591931*epsxy[4]*rdx01+0.06804138174397717*epsxy[1]*rdx01+0.05892556509887897*epsxx[6]*rdx00-0.06804138174397717*epsxx[3]*rdx00+0.06804138174397717*epsxx[2]*rdx00-0.07856742013183864*epsxx[0]*rdx00+0.03928371006591931*kSq[6]-0.04536092116265145*kSq[3]+0.04536092116265145*kSq[2]-0.052378280087892436*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[5], globalIdxs[5], 0.05892556509887897*epsyy[5]*rdx11+0.06804138174397717*epsyy[3]*rdx11+0.06804138174397717*epsyy[1]*rdx11+0.07856742013183864*epsyy[0]*rdx11+0.03402069087198858*epsxy[7]*rdx01+0.05892556509887897*epsxy[6]*rdx01-0.05892556509887897*epsxy[5]*rdx01+0.03928371006591931*epsxy[4]*rdx01-0.10206207261596573*epsxy[3]*rdx01+0.06804138174397717*epsxy[2]*rdx01-0.06804138174397717*epsxy[1]*rdx01-0.11785113019775795*epsxy[0]*rdx01-0.05892556509887897*epsxx[6]*rdx00+0.06804138174397717*epsxx[3]*rdx00-0.06804138174397717*epsxx[2]*rdx00+0.07856742013183864*epsxx[0]*rdx00+0.06804138174397717*kSq[7]+0.07856742013183864*kSq[6]-0.07856742013183864*kSq[5]+0.07856742013183864*kSq[4]-0.09072184232530293*kSq[3]+0.09072184232530293*kSq[2]-0.09072184232530293*kSq[1]-0.10475656017578487*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[5], globalIdxs[6], -(0.03402069087198858*epsyy[3]*rdx11)-0.03928371006591931*epsyy[0]*rdx11+0.03402069087198858*epsxy[7]*rdx01+0.03928371006591931*epsxy[4]*rdx01+0.10206207261596573*epsxy[3]*rdx01+0.11785113019775795*epsxy[0]*rdx01-0.03402069087198858*epsxx[3]*rdx00-0.03928371006591931*epsxx[0]*rdx00-0.022680460581325723*kSq[3]-0.026189140043946214*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[5], globalIdxs[7], -(0.05892556509887897*epsyy[5]*rdx11)-0.06804138174397717*epsyy[3]*rdx11-0.06804138174397717*epsyy[1]*rdx11-0.07856742013183864*epsyy[0]*rdx11-0.03402069087198858*epsxy[7]*rdx01-0.05892556509887897*epsxy[6]*rdx01-0.03928371006591931*epsxy[4]*rdx01-0.06804138174397717*epsxy[2]*rdx01+0.03402069087198858*epsxx[3]*rdx00+0.03928371006591931*epsxx[0]*rdx00-0.03928371006591931*kSq[5]-0.04536092116265145*kSq[3]-0.04536092116265145*kSq[1]-0.052378280087892436*kSq[0]);
  gkyl_mat_triples_insert(tri, globalIdxs[6], globalIdxs[0], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[6], globalIdxs[1], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[6], globalIdxs[2], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[6], globalIdxs[3], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[6], globalIdxs[4], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[6], globalIdxs[5], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[6], globalIdxs[6], 1.0);
  gkyl_mat_triples_insert(tri, globalIdxs[6], globalIdxs[7], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[7], globalIdxs[0], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[7], globalIdxs[1], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[7], globalIdxs[2], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[7], globalIdxs[3], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[7], globalIdxs[4], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[7], globalIdxs[5], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[7], globalIdxs[6], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[7], globalIdxs[7], 1.0);

}

void fem_poisson_perp_lhs_stencil_3x_ser_p1_lox_periodicx_upy_neumanny(const double *epsilon, const double *kSq, const double *dx, const double *bcVals, const long *globalIdxs, gkyl_mat_triples *tri) 
{ 
  // epsilon: permittivity tensor.
  // kSq: wave number squared (factor multiplying phi).
  // dx: cell length in each direction.
  // bcVals: values to impose as BCs, i.e. bcVals[off+0]*phi+bcVals[off+1]*epsilon^{ij}*d(phi)/dx_j=bcVals[off+2].
  // globalIdxs: global linear index of each basis function/node in current cell.
  // tri: triples object (i,j,val), i.e. contribute val to i,j element of the global matrix.

  const double *epsxx = &epsilon[0];
  const double *epsxy = &epsilon[8];
  const double *epsyy = &epsilon[16];

  double rdx00 = 4.0/(dx[0]*dx[0]);
  double rdx01 = 4.0/(dx[0]*dx[1]);
  double rdx11 = 4.0/(dx[1]*dx[1]);

  double rdx2[2]; 
  rdx2[0] = 2.0/dx[0]; 
  rdx2[1] = 2.0/dx[1]; 

  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[0], 0.05892556509887897*epsyy[5]*rdx11-0.06804138174397717*epsyy[3]*rdx11-0.06804138174397717*epsyy[1]*rdx11+0.07856742013183864*epsyy[0]*rdx11-0.03402069087198858*epsxy[7]*rdx01+0.05892556509887897*epsxy[6]*rdx01+0.05892556509887897*epsxy[5]*rdx01+0.03928371006591931*epsxy[4]*rdx01-0.10206207261596573*epsxy[3]*rdx01-0.06804138174397717*epsxy[2]*rdx01-0.06804138174397717*epsxy[1]*rdx01+0.11785113019775795*epsxy[0]*rdx01+0.05892556509887897*epsxx[6]*rdx00-0.06804138174397717*epsxx[3]*rdx00-0.06804138174397717*epsxx[2]*rdx00+0.07856742013183864*epsxx[0]*rdx00+0.06804138174397717*kSq[7]-0.07856742013183864*kSq[6]-0.07856742013183864*kSq[5]-0.07856742013183864*kSq[4]+0.09072184232530293*kSq[3]+0.09072184232530293*kSq[2]+0.09072184232530293*kSq[1]-0.10475656017578487*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[1], -(0.03402069087198858*epsyy[3]*rdx11)+0.03928371006591931*epsyy[0]*rdx11+0.03402069087198858*epsxy[7]*rdx01-0.05892556509887897*epsxy[5]*rdx01-0.03928371006591931*epsxy[4]*rdx01+0.06804138174397717*epsxy[1]*rdx01-0.05892556509887897*epsxx[6]*rdx00+0.06804138174397717*epsxx[3]*rdx00+0.06804138174397717*epsxx[2]*rdx00-0.07856742013183864*epsxx[0]*rdx00-0.03928371006591931*kSq[6]+0.04536092116265145*kSq[3]+0.04536092116265145*kSq[2]-0.052378280087892436*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[2], -(0.05892556509887897*epsyy[5]*rdx11)+0.06804138174397717*epsyy[3]*rdx11+0.06804138174397717*epsyy[1]*rdx11-0.07856742013183864*epsyy[0]*rdx11+0.03402069087198858*epsxy[7]*rdx01-0.05892556509887897*epsxy[6]*rdx01-0.03928371006591931*epsxy[4]*rdx01+0.06804138174397717*epsxy[2]*rdx01-0.03402069087198858*epsxx[3]*rdx00+0.03928371006591931*epsxx[0]*rdx00-0.03928371006591931*kSq[5]+0.04536092116265145*kSq[3]+0.04536092116265145*kSq[1]-0.052378280087892436*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[3], 0.03402069087198858*epsyy[3]*rdx11-0.03928371006591931*epsyy[0]*rdx11-0.03402069087198858*epsxy[7]*rdx01+0.03928371006591931*epsxy[4]*rdx01+0.10206207261596573*epsxy[3]*rdx01-0.11785113019775795*epsxy[0]*rdx01+0.03402069087198858*epsxx[3]*rdx00-0.03928371006591931*epsxx[0]*rdx00+0.022680460581325723*kSq[3]-0.026189140043946214*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[4], -(0.03402069087198858*epsyy[1]*rdx11)+0.03928371006591931*epsyy[0]*rdx11+0.019641855032959656*epsxy[4]*rdx01-0.03402069087198858*epsxy[2]*rdx01-0.03402069087198858*epsxy[1]*rdx01+0.05892556509887897*epsxy[0]*rdx01-0.03402069087198858*epsxx[2]*rdx00+0.03928371006591931*epsxx[0]*rdx00-0.03928371006591931*kSq[4]+0.04536092116265145*kSq[2]+0.04536092116265145*kSq[1]-0.052378280087892436*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[5], 0.019641855032959656*epsyy[0]*rdx11-0.019641855032959656*epsxy[4]*rdx01+0.03402069087198858*epsxy[1]*rdx01+0.03402069087198858*epsxx[2]*rdx00-0.03928371006591931*epsxx[0]*rdx00+0.022680460581325723*kSq[2]-0.026189140043946214*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[6], 0.03402069087198858*epsyy[1]*rdx11-0.03928371006591931*epsyy[0]*rdx11-0.019641855032959656*epsxy[4]*rdx01+0.03402069087198858*epsxy[2]*rdx01+0.019641855032959656*epsxx[0]*rdx00+0.022680460581325723*kSq[1]-0.026189140043946214*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[7], -(0.019641855032959656*epsyy[0]*rdx11)+0.019641855032959656*epsxy[4]*rdx01-0.05892556509887897*epsxy[0]*rdx01-0.019641855032959656*epsxx[0]*rdx00-0.013094570021973104*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[0], -(0.03402069087198858*epsyy[3]*rdx11)+0.03928371006591931*epsyy[0]*rdx11+0.03402069087198858*epsxy[7]*rdx01-0.05892556509887897*epsxy[5]*rdx01-0.03928371006591931*epsxy[4]*rdx01+0.06804138174397717*epsxy[1]*rdx01-0.05892556509887897*epsxx[6]*rdx00+0.06804138174397717*epsxx[3]*rdx00+0.06804138174397717*epsxx[2]*rdx00-0.07856742013183864*epsxx[0]*rdx00-0.03928371006591931*kSq[6]+0.04536092116265145*kSq[3]+0.04536092116265145*kSq[2]-0.052378280087892436*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[1], -(0.05892556509887897*epsyy[5]*rdx11)-0.06804138174397717*epsyy[3]*rdx11+0.06804138174397717*epsyy[1]*rdx11+0.07856742013183864*epsyy[0]*rdx11-0.03402069087198858*epsxy[7]*rdx01-0.05892556509887897*epsxy[6]*rdx01+0.05892556509887897*epsxy[5]*rdx01+0.03928371006591931*epsxy[4]*rdx01+0.10206207261596573*epsxy[3]*rdx01+0.06804138174397717*epsxy[2]*rdx01-0.06804138174397717*epsxy[1]*rdx01-0.11785113019775795*epsxy[0]*rdx01+0.05892556509887897*epsxx[6]*rdx00-0.06804138174397717*epsxx[3]*rdx00-0.06804138174397717*epsxx[2]*rdx00+0.07856742013183864*epsxx[0]*rdx00-0.06804138174397717*kSq[7]-0.07856742013183864*kSq[6]+0.07856742013183864*kSq[5]+0.07856742013183864*kSq[4]+0.09072184232530293*kSq[3]+0.09072184232530293*kSq[2]-0.09072184232530293*kSq[1]-0.10475656017578487*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[2], 0.03402069087198858*epsyy[3]*rdx11-0.03928371006591931*epsyy[0]*rdx11-0.03402069087198858*epsxy[7]*rdx01+0.03928371006591931*epsxy[4]*rdx01-0.10206207261596573*epsxy[3]*rdx01+0.11785113019775795*epsxy[0]*rdx01+0.03402069087198858*epsxx[3]*rdx00-0.03928371006591931*epsxx[0]*rdx00+0.022680460581325723*kSq[3]-0.026189140043946214*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[3], 0.05892556509887897*epsyy[5]*rdx11+0.06804138174397717*epsyy[3]*rdx11-0.06804138174397717*epsyy[1]*rdx11-0.07856742013183864*epsyy[0]*rdx11+0.03402069087198858*epsxy[7]*rdx01+0.05892556509887897*epsxy[6]*rdx01-0.03928371006591931*epsxy[4]*rdx01-0.06804138174397717*epsxy[2]*rdx01-0.03402069087198858*epsxx[3]*rdx00+0.03928371006591931*epsxx[0]*rdx00+0.03928371006591931*kSq[5]+0.04536092116265145*kSq[3]-0.04536092116265145*kSq[1]-0.052378280087892436*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[4], 0.019641855032959656*epsyy[0]*rdx11-0.019641855032959656*epsxy[4]*rdx01+0.03402069087198858*epsxy[1]*rdx01+0.03402069087198858*epsxx[2]*rdx00-0.03928371006591931*epsxx[0]*rdx00+0.022680460581325723*kSq[2]-0.026189140043946214*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[5], 0.03402069087198858*epsyy[1]*rdx11+0.03928371006591931*epsyy[0]*rdx11+0.019641855032959656*epsxy[4]*rdx01+0.03402069087198858*epsxy[2]*rdx01-0.03402069087198858*epsxy[1]*rdx01-0.05892556509887897*epsxy[0]*rdx01-0.03402069087198858*epsxx[2]*rdx00+0.03928371006591931*epsxx[0]*rdx00+0.03928371006591931*kSq[4]+0.04536092116265145*kSq[2]-0.04536092116265145*kSq[1]-0.052378280087892436*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[6], -(0.019641855032959656*epsyy[0]*rdx11)+0.019641855032959656*epsxy[4]*rdx01+0.05892556509887897*epsxy[0]*rdx01-0.019641855032959656*epsxx[0]*rdx00-0.013094570021973104*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[7], -(0.03402069087198858*epsyy[1]*rdx11)-0.03928371006591931*epsyy[0]*rdx11-0.019641855032959656*epsxy[4]*rdx01-0.03402069087198858*epsxy[2]*rdx01+0.019641855032959656*epsxx[0]*rdx00-0.022680460581325723*kSq[1]-0.026189140043946214*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[0], -(0.05892556509887897*epsyy[5]*rdx11)+0.06804138174397717*epsyy[3]*rdx11+0.06804138174397717*epsyy[1]*rdx11-0.07856742013183864*epsyy[0]*rdx11+0.03402069087198858*epsxy[7]*rdx01-0.05892556509887897*epsxy[6]*rdx01-0.03928371006591931*epsxy[4]*rdx01+0.06804138174397717*epsxy[2]*rdx01-0.03402069087198858*epsxx[3]*rdx00+0.03928371006591931*epsxx[0]*rdx00-0.03928371006591931*kSq[5]+0.04536092116265145*kSq[3]+0.04536092116265145*kSq[1]-0.052378280087892436*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[1], 0.03402069087198858*epsyy[3]*rdx11-0.03928371006591931*epsyy[0]*rdx11-0.03402069087198858*epsxy[7]*rdx01+0.03928371006591931*epsxy[4]*rdx01-0.10206207261596573*epsxy[3]*rdx01+0.11785113019775795*epsxy[0]*rdx01+0.03402069087198858*epsxx[3]*rdx00-0.03928371006591931*epsxx[0]*rdx00+0.022680460581325723*kSq[3]-0.026189140043946214*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[2], 0.05892556509887897*epsyy[5]*rdx11-0.06804138174397717*epsyy[3]*rdx11-0.06804138174397717*epsyy[1]*rdx11+0.07856742013183864*epsyy[0]*rdx11-0.03402069087198858*epsxy[7]*rdx01+0.05892556509887897*epsxy[6]*rdx01-0.05892556509887897*epsxy[5]*rdx01+0.03928371006591931*epsxy[4]*rdx01+0.10206207261596573*epsxy[3]*rdx01-0.06804138174397717*epsxy[2]*rdx01+0.06804138174397717*epsxy[1]*rdx01-0.11785113019775795*epsxy[0]*rdx01-0.05892556509887897*epsxx[6]*rdx00-0.06804138174397717*epsxx[3]*rdx00+0.06804138174397717*epsxx[2]*rdx00+0.07856742013183864*epsxx[0]*rdx00-0.06804138174397717*kSq[7]+0.07856742013183864*kSq[6]-0.07856742013183864*kSq[5]+0.07856742013183864*kSq[4]+0.09072184232530293*kSq[3]-0.09072184232530293*kSq[2]+0.09072184232530293*kSq[1]-0.10475656017578487*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[3], -(0.03402069087198858*epsyy[3]*rdx11)+0.03928371006591931*epsyy[0]*rdx11+0.03402069087198858*epsxy[7]*rdx01+0.05892556509887897*epsxy[5]*rdx01-0.03928371006591931*epsxy[4]*rdx01-0.06804138174397717*epsxy[1]*rdx01+0.05892556509887897*epsxx[6]*rdx00+0.06804138174397717*epsxx[3]*rdx00-0.06804138174397717*epsxx[2]*rdx00-0.07856742013183864*epsxx[0]*rdx00+0.03928371006591931*kSq[6]+0.04536092116265145*kSq[3]-0.04536092116265145*kSq[2]-0.052378280087892436*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[4], 0.03402069087198858*epsyy[1]*rdx11-0.03928371006591931*epsyy[0]*rdx11-0.019641855032959656*epsxy[4]*rdx01+0.03402069087198858*epsxy[2]*rdx01+0.019641855032959656*epsxx[0]*rdx00+0.022680460581325723*kSq[1]-0.026189140043946214*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[5], -(0.019641855032959656*epsyy[0]*rdx11)+0.019641855032959656*epsxy[4]*rdx01+0.05892556509887897*epsxy[0]*rdx01-0.019641855032959656*epsxx[0]*rdx00-0.013094570021973104*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[6], -(0.03402069087198858*epsyy[1]*rdx11)+0.03928371006591931*epsyy[0]*rdx11+0.019641855032959656*epsxy[4]*rdx01-0.03402069087198858*epsxy[2]*rdx01+0.03402069087198858*epsxy[1]*rdx01-0.05892556509887897*epsxy[0]*rdx01+0.03402069087198858*epsxx[2]*rdx00+0.03928371006591931*epsxx[0]*rdx00+0.03928371006591931*kSq[4]-0.04536092116265145*kSq[2]+0.04536092116265145*kSq[1]-0.052378280087892436*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[7], 0.019641855032959656*epsyy[0]*rdx11-0.019641855032959656*epsxy[4]*rdx01-0.03402069087198858*epsxy[1]*rdx01-0.03402069087198858*epsxx[2]*rdx00-0.03928371006591931*epsxx[0]*rdx00-0.022680460581325723*kSq[2]-0.026189140043946214*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[0], 0.03402069087198858*epsyy[3]*rdx11-0.03928371006591931*epsyy[0]*rdx11-0.03402069087198858*epsxy[7]*rdx01+0.03928371006591931*epsxy[4]*rdx01+0.10206207261596573*epsxy[3]*rdx01-0.11785113019775795*epsxy[0]*rdx01+0.03402069087198858*epsxx[3]*rdx00-0.03928371006591931*epsxx[0]*rdx00+0.022680460581325723*kSq[3]-0.026189140043946214*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[1], 0.05892556509887897*epsyy[5]*rdx11+0.06804138174397717*epsyy[3]*rdx11-0.06804138174397717*epsyy[1]*rdx11-0.07856742013183864*epsyy[0]*rdx11+0.03402069087198858*epsxy[7]*rdx01+0.05892556509887897*epsxy[6]*rdx01-0.03928371006591931*epsxy[4]*rdx01-0.06804138174397717*epsxy[2]*rdx01-0.03402069087198858*epsxx[3]*rdx00+0.03928371006591931*epsxx[0]*rdx00+0.03928371006591931*kSq[5]+0.04536092116265145*kSq[3]-0.04536092116265145*kSq[1]-0.052378280087892436*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[2], -(0.03402069087198858*epsyy[3]*rdx11)+0.03928371006591931*epsyy[0]*rdx11+0.03402069087198858*epsxy[7]*rdx01+0.05892556509887897*epsxy[5]*rdx01-0.03928371006591931*epsxy[4]*rdx01-0.06804138174397717*epsxy[1]*rdx01+0.05892556509887897*epsxx[6]*rdx00+0.06804138174397717*epsxx[3]*rdx00-0.06804138174397717*epsxx[2]*rdx00-0.07856742013183864*epsxx[0]*rdx00+0.03928371006591931*kSq[6]+0.04536092116265145*kSq[3]-0.04536092116265145*kSq[2]-0.052378280087892436*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[3], -(0.05892556509887897*epsyy[5]*rdx11)-0.06804138174397717*epsyy[3]*rdx11+0.06804138174397717*epsyy[1]*rdx11+0.07856742013183864*epsyy[0]*rdx11-0.03402069087198858*epsxy[7]*rdx01-0.05892556509887897*epsxy[6]*rdx01-0.05892556509887897*epsxy[5]*rdx01+0.03928371006591931*epsxy[4]*rdx01-0.10206207261596573*epsxy[3]*rdx01+0.06804138174397717*epsxy[2]*rdx01+0.06804138174397717*epsxy[1]*rdx01+0.11785113019775795*epsxy[0]*rdx01-0.05892556509887897*epsxx[6]*rdx00-0.06804138174397717*epsxx[3]*rdx00+0.06804138174397717*epsxx[2]*rdx00+0.07856742013183864*epsxx[0]*rdx00+0.06804138174397717*kSq[7]+0.07856742013183864*kSq[6]+0.07856742013183864*kSq[5]-0.07856742013183864*kSq[4]+0.09072184232530293*kSq[3]-0.09072184232530293*kSq[2]-0.09072184232530293*kSq[1]-0.10475656017578487*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[4], -(0.019641855032959656*epsyy[0]*rdx11)+0.019641855032959656*epsxy[4]*rdx01-0.05892556509887897*epsxy[0]*rdx01-0.019641855032959656*epsxx[0]*rdx00-0.013094570021973104*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[5], -(0.03402069087198858*epsyy[1]*rdx11)-0.03928371006591931*epsyy[0]*rdx11-0.019641855032959656*epsxy[4]*rdx01-0.03402069087198858*epsxy[2]*rdx01+0.019641855032959656*epsxx[0]*rdx00-0.022680460581325723*kSq[1]-0.026189140043946214*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[6], 0.019641855032959656*epsyy[0]*rdx11-0.019641855032959656*epsxy[4]*rdx01-0.03402069087198858*epsxy[1]*rdx01-0.03402069087198858*epsxx[2]*rdx00-0.03928371006591931*epsxx[0]*rdx00-0.022680460581325723*kSq[2]-0.026189140043946214*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[7], 0.03402069087198858*epsyy[1]*rdx11+0.03928371006591931*epsyy[0]*rdx11+0.019641855032959656*epsxy[4]*rdx01+0.03402069087198858*epsxy[2]*rdx01+0.03402069087198858*epsxy[1]*rdx01+0.05892556509887897*epsxy[0]*rdx01+0.03402069087198858*epsxx[2]*rdx00+0.03928371006591931*epsxx[0]*rdx00-0.03928371006591931*kSq[4]-0.04536092116265145*kSq[2]-0.04536092116265145*kSq[1]-0.052378280087892436*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[4], globalIdxs[0], -(0.03402069087198858*epsyy[1]*rdx11)+0.03928371006591931*epsyy[0]*rdx11+0.019641855032959656*epsxy[4]*rdx01-0.03402069087198858*epsxy[2]*rdx01-0.03402069087198858*epsxy[1]*rdx01+0.05892556509887897*epsxy[0]*rdx01-0.03402069087198858*epsxx[2]*rdx00+0.03928371006591931*epsxx[0]*rdx00-0.03928371006591931*kSq[4]+0.04536092116265145*kSq[2]+0.04536092116265145*kSq[1]-0.052378280087892436*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[4], globalIdxs[1], 0.019641855032959656*epsyy[0]*rdx11-0.019641855032959656*epsxy[4]*rdx01+0.03402069087198858*epsxy[1]*rdx01+0.03402069087198858*epsxx[2]*rdx00-0.03928371006591931*epsxx[0]*rdx00+0.022680460581325723*kSq[2]-0.026189140043946214*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[4], globalIdxs[2], 0.03402069087198858*epsyy[1]*rdx11-0.03928371006591931*epsyy[0]*rdx11-0.019641855032959656*epsxy[4]*rdx01+0.03402069087198858*epsxy[2]*rdx01+0.019641855032959656*epsxx[0]*rdx00+0.022680460581325723*kSq[1]-0.026189140043946214*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[4], globalIdxs[3], -(0.019641855032959656*epsyy[0]*rdx11)+0.019641855032959656*epsxy[4]*rdx01-0.05892556509887897*epsxy[0]*rdx01-0.019641855032959656*epsxx[0]*rdx00-0.013094570021973104*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[4], globalIdxs[4], -(0.05892556509887897*epsyy[5]*rdx11)+0.06804138174397717*epsyy[3]*rdx11-0.06804138174397717*epsyy[1]*rdx11+0.07856742013183864*epsyy[0]*rdx11+0.03402069087198858*epsxy[7]*rdx01-0.05892556509887897*epsxy[6]*rdx01-0.05892556509887897*epsxy[5]*rdx01+0.03928371006591931*epsxy[4]*rdx01+0.10206207261596573*epsxy[3]*rdx01-0.06804138174397717*epsxy[2]*rdx01-0.06804138174397717*epsxy[1]*rdx01+0.11785113019775795*epsxy[0]*rdx01-0.05892556509887897*epsxx[6]*rdx00+0.06804138174397717*epsxx[3]*rdx00-0.06804138174397717*epsxx[2]*rdx00+0.07856742013183864*epsxx[0]*rdx00-0.06804138174397717*kSq[7]+0.07856742013183864*kSq[6]+0.07856742013183864*kSq[5]-0.07856742013183864*kSq[4]-0.09072184232530293*kSq[3]+0.09072184232530293*kSq[2]+0.09072184232530293*kSq[1]-0.10475656017578487*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[4], globalIdxs[5], 0.03402069087198858*epsyy[3]*rdx11+0.03928371006591931*epsyy[0]*rdx11-0.03402069087198858*epsxy[7]*rdx01+0.05892556509887897*epsxy[5]*rdx01-0.03928371006591931*epsxy[4]*rdx01+0.06804138174397717*epsxy[1]*rdx01+0.05892556509887897*epsxx[6]*rdx00-0.06804138174397717*epsxx[3]*rdx00+0.06804138174397717*epsxx[2]*rdx00-0.07856742013183864*epsxx[0]*rdx00+0.03928371006591931*kSq[6]-0.04536092116265145*kSq[3]+0.04536092116265145*kSq[2]-0.052378280087892436*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[4], globalIdxs[6], 0.05892556509887897*epsyy[5]*rdx11-0.06804138174397717*epsyy[3]*rdx11+0.06804138174397717*epsyy[1]*rdx11-0.07856742013183864*epsyy[0]*rdx11-0.03402069087198858*epsxy[7]*rdx01+0.05892556509887897*epsxy[6]*rdx01-0.03928371006591931*epsxy[4]*rdx01+0.06804138174397717*epsxy[2]*rdx01+0.03402069087198858*epsxx[3]*rdx00+0.03928371006591931*epsxx[0]*rdx00+0.03928371006591931*kSq[5]-0.04536092116265145*kSq[3]+0.04536092116265145*kSq[1]-0.052378280087892436*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[4], globalIdxs[7], -(0.03402069087198858*epsyy[3]*rdx11)-0.03928371006591931*epsyy[0]*rdx11+0.03402069087198858*epsxy[7]*rdx01+0.03928371006591931*epsxy[4]*rdx01-0.10206207261596573*epsxy[3]*rdx01-0.11785113019775795*epsxy[0]*rdx01-0.03402069087198858*epsxx[3]*rdx00-0.03928371006591931*epsxx[0]*rdx00-0.022680460581325723*kSq[3]-0.026189140043946214*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[5], globalIdxs[0], 0.019641855032959656*epsyy[0]*rdx11-0.019641855032959656*epsxy[4]*rdx01+0.03402069087198858*epsxy[1]*rdx01+0.03402069087198858*epsxx[2]*rdx00-0.03928371006591931*epsxx[0]*rdx00+0.022680460581325723*kSq[2]-0.026189140043946214*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[5], globalIdxs[1], 0.03402069087198858*epsyy[1]*rdx11+0.03928371006591931*epsyy[0]*rdx11+0.019641855032959656*epsxy[4]*rdx01+0.03402069087198858*epsxy[2]*rdx01-0.03402069087198858*epsxy[1]*rdx01-0.05892556509887897*epsxy[0]*rdx01-0.03402069087198858*epsxx[2]*rdx00+0.03928371006591931*epsxx[0]*rdx00+0.03928371006591931*kSq[4]+0.04536092116265145*kSq[2]-0.04536092116265145*kSq[1]-0.052378280087892436*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[5], globalIdxs[2], -(0.019641855032959656*epsyy[0]*rdx11)+0.019641855032959656*epsxy[4]*rdx01+0.05892556509887897*epsxy[0]*rdx01-0.019641855032959656*epsxx[0]*rdx00-0.013094570021973104*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[5], globalIdxs[3], -(0.03402069087198858*epsyy[1]*rdx11)-0.03928371006591931*epsyy[0]*rdx11-0.019641855032959656*epsxy[4]*rdx01-0.03402069087198858*epsxy[2]*rdx01+0.019641855032959656*epsxx[0]*rdx00-0.022680460581325723*kSq[1]-0.026189140043946214*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[5], globalIdxs[4], 0.03402069087198858*epsyy[3]*rdx11+0.03928371006591931*epsyy[0]*rdx11-0.03402069087198858*epsxy[7]*rdx01+0.05892556509887897*epsxy[5]*rdx01-0.03928371006591931*epsxy[4]*rdx01+0.06804138174397717*epsxy[1]*rdx01+0.05892556509887897*epsxx[6]*rdx00-0.06804138174397717*epsxx[3]*rdx00+0.06804138174397717*epsxx[2]*rdx00-0.07856742013183864*epsxx[0]*rdx00+0.03928371006591931*kSq[6]-0.04536092116265145*kSq[3]+0.04536092116265145*kSq[2]-0.052378280087892436*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[5], globalIdxs[5], 0.05892556509887897*epsyy[5]*rdx11+0.06804138174397717*epsyy[3]*rdx11+0.06804138174397717*epsyy[1]*rdx11+0.07856742013183864*epsyy[0]*rdx11+0.03402069087198858*epsxy[7]*rdx01+0.05892556509887897*epsxy[6]*rdx01-0.05892556509887897*epsxy[5]*rdx01+0.03928371006591931*epsxy[4]*rdx01-0.10206207261596573*epsxy[3]*rdx01+0.06804138174397717*epsxy[2]*rdx01-0.06804138174397717*epsxy[1]*rdx01-0.11785113019775795*epsxy[0]*rdx01-0.05892556509887897*epsxx[6]*rdx00+0.06804138174397717*epsxx[3]*rdx00-0.06804138174397717*epsxx[2]*rdx00+0.07856742013183864*epsxx[0]*rdx00+0.06804138174397717*kSq[7]+0.07856742013183864*kSq[6]-0.07856742013183864*kSq[5]+0.07856742013183864*kSq[4]-0.09072184232530293*kSq[3]+0.09072184232530293*kSq[2]-0.09072184232530293*kSq[1]-0.10475656017578487*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[5], globalIdxs[6], -(0.03402069087198858*epsyy[3]*rdx11)-0.03928371006591931*epsyy[0]*rdx11+0.03402069087198858*epsxy[7]*rdx01+0.03928371006591931*epsxy[4]*rdx01+0.10206207261596573*epsxy[3]*rdx01+0.11785113019775795*epsxy[0]*rdx01-0.03402069087198858*epsxx[3]*rdx00-0.03928371006591931*epsxx[0]*rdx00-0.022680460581325723*kSq[3]-0.026189140043946214*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[5], globalIdxs[7], -(0.05892556509887897*epsyy[5]*rdx11)-0.06804138174397717*epsyy[3]*rdx11-0.06804138174397717*epsyy[1]*rdx11-0.07856742013183864*epsyy[0]*rdx11-0.03402069087198858*epsxy[7]*rdx01-0.05892556509887897*epsxy[6]*rdx01-0.03928371006591931*epsxy[4]*rdx01-0.06804138174397717*epsxy[2]*rdx01+0.03402069087198858*epsxx[3]*rdx00+0.03928371006591931*epsxx[0]*rdx00-0.03928371006591931*kSq[5]-0.04536092116265145*kSq[3]-0.04536092116265145*kSq[1]-0.052378280087892436*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[6], globalIdxs[0], 0.03402069087198858*epsyy[1]*rdx11-0.03928371006591931*epsyy[0]*rdx11-0.019641855032959656*epsxy[4]*rdx01+0.03402069087198858*epsxy[2]*rdx01+0.019641855032959656*epsxx[0]*rdx00+0.022680460581325723*kSq[1]-0.026189140043946214*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[6], globalIdxs[1], -(0.019641855032959656*epsyy[0]*rdx11)+0.019641855032959656*epsxy[4]*rdx01+0.05892556509887897*epsxy[0]*rdx01-0.019641855032959656*epsxx[0]*rdx00-0.013094570021973104*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[6], globalIdxs[2], -(0.03402069087198858*epsyy[1]*rdx11)+0.03928371006591931*epsyy[0]*rdx11+0.019641855032959656*epsxy[4]*rdx01-0.03402069087198858*epsxy[2]*rdx01+0.03402069087198858*epsxy[1]*rdx01-0.05892556509887897*epsxy[0]*rdx01+0.03402069087198858*epsxx[2]*rdx00+0.03928371006591931*epsxx[0]*rdx00+0.03928371006591931*kSq[4]-0.04536092116265145*kSq[2]+0.04536092116265145*kSq[1]-0.052378280087892436*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[6], globalIdxs[3], 0.019641855032959656*epsyy[0]*rdx11-0.019641855032959656*epsxy[4]*rdx01-0.03402069087198858*epsxy[1]*rdx01-0.03402069087198858*epsxx[2]*rdx00-0.03928371006591931*epsxx[0]*rdx00-0.022680460581325723*kSq[2]-0.026189140043946214*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[6], globalIdxs[4], 0.05892556509887897*epsyy[5]*rdx11-0.06804138174397717*epsyy[3]*rdx11+0.06804138174397717*epsyy[1]*rdx11-0.07856742013183864*epsyy[0]*rdx11-0.03402069087198858*epsxy[7]*rdx01+0.05892556509887897*epsxy[6]*rdx01-0.03928371006591931*epsxy[4]*rdx01+0.06804138174397717*epsxy[2]*rdx01+0.03402069087198858*epsxx[3]*rdx00+0.03928371006591931*epsxx[0]*rdx00+0.03928371006591931*kSq[5]-0.04536092116265145*kSq[3]+0.04536092116265145*kSq[1]-0.052378280087892436*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[6], globalIdxs[5], -(0.03402069087198858*epsyy[3]*rdx11)-0.03928371006591931*epsyy[0]*rdx11+0.03402069087198858*epsxy[7]*rdx01+0.03928371006591931*epsxy[4]*rdx01+0.10206207261596573*epsxy[3]*rdx01+0.11785113019775795*epsxy[0]*rdx01-0.03402069087198858*epsxx[3]*rdx00-0.03928371006591931*epsxx[0]*rdx00-0.022680460581325723*kSq[3]-0.026189140043946214*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[6], globalIdxs[6], -(0.05892556509887897*epsyy[5]*rdx11)+0.06804138174397717*epsyy[3]*rdx11-0.06804138174397717*epsyy[1]*rdx11+0.07856742013183864*epsyy[0]*rdx11+0.03402069087198858*epsxy[7]*rdx01-0.05892556509887897*epsxy[6]*rdx01+0.05892556509887897*epsxy[5]*rdx01+0.03928371006591931*epsxy[4]*rdx01-0.10206207261596573*epsxy[3]*rdx01-0.06804138174397717*epsxy[2]*rdx01+0.06804138174397717*epsxy[1]*rdx01-0.11785113019775795*epsxy[0]*rdx01+0.05892556509887897*epsxx[6]*rdx00+0.06804138174397717*epsxx[3]*rdx00+0.06804138174397717*epsxx[2]*rdx00+0.07856742013183864*epsxx[0]*rdx00+0.06804138174397717*kSq[7]-0.07856742013183864*kSq[6]+0.07856742013183864*kSq[5]+0.07856742013183864*kSq[4]-0.09072184232530293*kSq[3]-0.09072184232530293*kSq[2]+0.09072184232530293*kSq[1]-0.10475656017578487*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[6], globalIdxs[7], 0.03402069087198858*epsyy[3]*rdx11+0.03928371006591931*epsyy[0]*rdx11-0.03402069087198858*epsxy[7]*rdx01-0.05892556509887897*epsxy[5]*rdx01-0.03928371006591931*epsxy[4]*rdx01-0.06804138174397717*epsxy[1]*rdx01-0.05892556509887897*epsxx[6]*rdx00-0.06804138174397717*epsxx[3]*rdx00-0.06804138174397717*epsxx[2]*rdx00-0.07856742013183864*epsxx[0]*rdx00-0.03928371006591931*kSq[6]-0.04536092116265145*kSq[3]-0.04536092116265145*kSq[2]-0.052378280087892436*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[7], globalIdxs[0], -(0.019641855032959656*epsyy[0]*rdx11)+0.019641855032959656*epsxy[4]*rdx01-0.05892556509887897*epsxy[0]*rdx01-0.019641855032959656*epsxx[0]*rdx00-0.013094570021973104*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[7], globalIdxs[1], -(0.03402069087198858*epsyy[1]*rdx11)-0.03928371006591931*epsyy[0]*rdx11-0.019641855032959656*epsxy[4]*rdx01-0.03402069087198858*epsxy[2]*rdx01+0.019641855032959656*epsxx[0]*rdx00-0.022680460581325723*kSq[1]-0.026189140043946214*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[7], globalIdxs[2], 0.019641855032959656*epsyy[0]*rdx11-0.019641855032959656*epsxy[4]*rdx01-0.03402069087198858*epsxy[1]*rdx01-0.03402069087198858*epsxx[2]*rdx00-0.03928371006591931*epsxx[0]*rdx00-0.022680460581325723*kSq[2]-0.026189140043946214*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[7], globalIdxs[3], 0.03402069087198858*epsyy[1]*rdx11+0.03928371006591931*epsyy[0]*rdx11+0.019641855032959656*epsxy[4]*rdx01+0.03402069087198858*epsxy[2]*rdx01+0.03402069087198858*epsxy[1]*rdx01+0.05892556509887897*epsxy[0]*rdx01+0.03402069087198858*epsxx[2]*rdx00+0.03928371006591931*epsxx[0]*rdx00-0.03928371006591931*kSq[4]-0.04536092116265145*kSq[2]-0.04536092116265145*kSq[1]-0.052378280087892436*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[7], globalIdxs[4], -(0.03402069087198858*epsyy[3]*rdx11)-0.03928371006591931*epsyy[0]*rdx11+0.03402069087198858*epsxy[7]*rdx01+0.03928371006591931*epsxy[4]*rdx01-0.10206207261596573*epsxy[3]*rdx01-0.11785113019775795*epsxy[0]*rdx01-0.03402069087198858*epsxx[3]*rdx00-0.03928371006591931*epsxx[0]*rdx00-0.022680460581325723*kSq[3]-0.026189140043946214*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[7], globalIdxs[5], -(0.05892556509887897*epsyy[5]*rdx11)-0.06804138174397717*epsyy[3]*rdx11-0.06804138174397717*epsyy[1]*rdx11-0.07856742013183864*epsyy[0]*rdx11-0.03402069087198858*epsxy[7]*rdx01-0.05892556509887897*epsxy[6]*rdx01-0.03928371006591931*epsxy[4]*rdx01-0.06804138174397717*epsxy[2]*rdx01+0.03402069087198858*epsxx[3]*rdx00+0.03928371006591931*epsxx[0]*rdx00-0.03928371006591931*kSq[5]-0.04536092116265145*kSq[3]-0.04536092116265145*kSq[1]-0.052378280087892436*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[7], globalIdxs[6], 0.03402069087198858*epsyy[3]*rdx11+0.03928371006591931*epsyy[0]*rdx11-0.03402069087198858*epsxy[7]*rdx01-0.05892556509887897*epsxy[5]*rdx01-0.03928371006591931*epsxy[4]*rdx01-0.06804138174397717*epsxy[1]*rdx01-0.05892556509887897*epsxx[6]*rdx00-0.06804138174397717*epsxx[3]*rdx00-0.06804138174397717*epsxx[2]*rdx00-0.07856742013183864*epsxx[0]*rdx00-0.03928371006591931*kSq[6]-0.04536092116265145*kSq[3]-0.04536092116265145*kSq[2]-0.052378280087892436*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[7], globalIdxs[7], 0.05892556509887897*epsyy[5]*rdx11+0.06804138174397717*epsyy[3]*rdx11+0.06804138174397717*epsyy[1]*rdx11+0.07856742013183864*epsyy[0]*rdx11+0.03402069087198858*epsxy[7]*rdx01+0.05892556509887897*epsxy[6]*rdx01+0.05892556509887897*epsxy[5]*rdx01+0.03928371006591931*epsxy[4]*rdx01+0.10206207261596573*epsxy[3]*rdx01+0.06804138174397717*epsxy[2]*rdx01+0.06804138174397717*epsxy[1]*rdx01+0.11785113019775795*epsxy[0]*rdx01+0.05892556509887897*epsxx[6]*rdx00+0.06804138174397717*epsxx[3]*rdx00+0.06804138174397717*epsxx[2]*rdx00+0.07856742013183864*epsxx[0]*rdx00-0.06804138174397717*kSq[7]-0.07856742013183864*kSq[6]-0.07856742013183864*kSq[5]-0.07856742013183864*kSq[4]-0.09072184232530293*kSq[3]-0.09072184232530293*kSq[2]-0.09072184232530293*kSq[1]-0.10475656017578487*kSq[0]);

}

void fem_poisson_perp_lhs_stencil_3x_ser_p1_lox_dirichletx_upy_periodicy(const double *epsilon, const double *kSq, const double *dx, const double *bcVals, const long *globalIdxs, gkyl_mat_triples *tri) 
{ 
  // epsilon: permittivity tensor.
  // kSq: wave number squared (factor multiplying phi).
  // dx: cell length in each direction.
  // bcVals: values to impose as BCs, i.e. bcVals[off+0]*phi+bcVals[off+1]*epsilon^{ij}*d(phi)/dx_j=bcVals[off+2].
  // globalIdxs: global linear index of each basis function/node in current cell.
  // tri: triples object (i,j,val), i.e. contribute val to i,j element of the global matrix.

  const double *epsxx = &epsilon[0];
  const double *epsxy = &epsilon[8];
  const double *epsyy = &epsilon[16];

  double rdx00 = 4.0/(dx[0]*dx[0]);
  double rdx01 = 4.0/(dx[0]*dx[1]);
  double rdx11 = 4.0/(dx[1]*dx[1]);

  gkyl_mat_triples_insert(tri, globalIdxs[0], globalIdxs[0], 1.0);
  gkyl_mat_triples_insert(tri, globalIdxs[0], globalIdxs[1], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[0], globalIdxs[2], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[0], globalIdxs[3], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[0], globalIdxs[4], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[0], globalIdxs[5], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[0], globalIdxs[6], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[0], globalIdxs[7], 0.0);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[0], -(0.03402069087198858*epsyy[3]*rdx11)+0.03928371006591931*epsyy[0]*rdx11+0.03402069087198858*epsxy[7]*rdx01-0.05892556509887897*epsxy[5]*rdx01-0.03928371006591931*epsxy[4]*rdx01+0.06804138174397717*epsxy[1]*rdx01-0.05892556509887897*epsxx[6]*rdx00+0.06804138174397717*epsxx[3]*rdx00+0.06804138174397717*epsxx[2]*rdx00-0.07856742013183864*epsxx[0]*rdx00-0.03928371006591931*kSq[6]+0.04536092116265145*kSq[3]+0.04536092116265145*kSq[2]-0.052378280087892436*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[1], -(0.05892556509887897*epsyy[5]*rdx11)-0.06804138174397717*epsyy[3]*rdx11+0.06804138174397717*epsyy[1]*rdx11+0.07856742013183864*epsyy[0]*rdx11-0.03402069087198858*epsxy[7]*rdx01-0.05892556509887897*epsxy[6]*rdx01+0.05892556509887897*epsxy[5]*rdx01+0.03928371006591931*epsxy[4]*rdx01+0.10206207261596573*epsxy[3]*rdx01+0.06804138174397717*epsxy[2]*rdx01-0.06804138174397717*epsxy[1]*rdx01-0.11785113019775795*epsxy[0]*rdx01+0.05892556509887897*epsxx[6]*rdx00-0.06804138174397717*epsxx[3]*rdx00-0.06804138174397717*epsxx[2]*rdx00+0.07856742013183864*epsxx[0]*rdx00-0.06804138174397717*kSq[7]-0.07856742013183864*kSq[6]+0.07856742013183864*kSq[5]+0.07856742013183864*kSq[4]+0.09072184232530293*kSq[3]+0.09072184232530293*kSq[2]-0.09072184232530293*kSq[1]-0.10475656017578487*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[2], 0.03402069087198858*epsyy[3]*rdx11-0.03928371006591931*epsyy[0]*rdx11-0.03402069087198858*epsxy[7]*rdx01+0.03928371006591931*epsxy[4]*rdx01-0.10206207261596573*epsxy[3]*rdx01+0.11785113019775795*epsxy[0]*rdx01+0.03402069087198858*epsxx[3]*rdx00-0.03928371006591931*epsxx[0]*rdx00+0.022680460581325723*kSq[3]-0.026189140043946214*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[3], 0.05892556509887897*epsyy[5]*rdx11+0.06804138174397717*epsyy[3]*rdx11-0.06804138174397717*epsyy[1]*rdx11-0.07856742013183864*epsyy[0]*rdx11+0.03402069087198858*epsxy[7]*rdx01+0.05892556509887897*epsxy[6]*rdx01-0.03928371006591931*epsxy[4]*rdx01-0.06804138174397717*epsxy[2]*rdx01-0.03402069087198858*epsxx[3]*rdx00+0.03928371006591931*epsxx[0]*rdx00+0.03928371006591931*kSq[5]+0.04536092116265145*kSq[3]-0.04536092116265145*kSq[1]-0.052378280087892436*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[4], 0.019641855032959656*epsyy[0]*rdx11-0.019641855032959656*epsxy[4]*rdx01+0.03402069087198858*epsxy[1]*rdx01+0.03402069087198858*epsxx[2]*rdx00-0.03928371006591931*epsxx[0]*rdx00+0.022680460581325723*kSq[2]-0.026189140043946214*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[5], 0.03402069087198858*epsyy[1]*rdx11+0.03928371006591931*epsyy[0]*rdx11+0.019641855032959656*epsxy[4]*rdx01+0.03402069087198858*epsxy[2]*rdx01-0.03402069087198858*epsxy[1]*rdx01-0.05892556509887897*epsxy[0]*rdx01-0.03402069087198858*epsxx[2]*rdx00+0.03928371006591931*epsxx[0]*rdx00+0.03928371006591931*kSq[4]+0.04536092116265145*kSq[2]-0.04536092116265145*kSq[1]-0.052378280087892436*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[6], -(0.019641855032959656*epsyy[0]*rdx11)+0.019641855032959656*epsxy[4]*rdx01+0.05892556509887897*epsxy[0]*rdx01-0.019641855032959656*epsxx[0]*rdx00-0.013094570021973104*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[7], -(0.03402069087198858*epsyy[1]*rdx11)-0.03928371006591931*epsyy[0]*rdx11-0.019641855032959656*epsxy[4]*rdx01-0.03402069087198858*epsxy[2]*rdx01+0.019641855032959656*epsxx[0]*rdx00-0.022680460581325723*kSq[1]-0.026189140043946214*kSq[0]);
  gkyl_mat_triples_insert(tri, globalIdxs[2], globalIdxs[0], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[2], globalIdxs[1], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[2], globalIdxs[2], 1.0);
  gkyl_mat_triples_insert(tri, globalIdxs[2], globalIdxs[3], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[2], globalIdxs[4], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[2], globalIdxs[5], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[2], globalIdxs[6], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[2], globalIdxs[7], 0.0);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[0], 0.03402069087198858*epsyy[3]*rdx11-0.03928371006591931*epsyy[0]*rdx11-0.03402069087198858*epsxy[7]*rdx01+0.03928371006591931*epsxy[4]*rdx01+0.10206207261596573*epsxy[3]*rdx01-0.11785113019775795*epsxy[0]*rdx01+0.03402069087198858*epsxx[3]*rdx00-0.03928371006591931*epsxx[0]*rdx00+0.022680460581325723*kSq[3]-0.026189140043946214*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[1], 0.05892556509887897*epsyy[5]*rdx11+0.06804138174397717*epsyy[3]*rdx11-0.06804138174397717*epsyy[1]*rdx11-0.07856742013183864*epsyy[0]*rdx11+0.03402069087198858*epsxy[7]*rdx01+0.05892556509887897*epsxy[6]*rdx01-0.03928371006591931*epsxy[4]*rdx01-0.06804138174397717*epsxy[2]*rdx01-0.03402069087198858*epsxx[3]*rdx00+0.03928371006591931*epsxx[0]*rdx00+0.03928371006591931*kSq[5]+0.04536092116265145*kSq[3]-0.04536092116265145*kSq[1]-0.052378280087892436*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[2], -(0.03402069087198858*epsyy[3]*rdx11)+0.03928371006591931*epsyy[0]*rdx11+0.03402069087198858*epsxy[7]*rdx01+0.05892556509887897*epsxy[5]*rdx01-0.03928371006591931*epsxy[4]*rdx01-0.06804138174397717*epsxy[1]*rdx01+0.05892556509887897*epsxx[6]*rdx00+0.06804138174397717*epsxx[3]*rdx00-0.06804138174397717*epsxx[2]*rdx00-0.07856742013183864*epsxx[0]*rdx00+0.03928371006591931*kSq[6]+0.04536092116265145*kSq[3]-0.04536092116265145*kSq[2]-0.052378280087892436*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[3], -(0.05892556509887897*epsyy[5]*rdx11)-0.06804138174397717*epsyy[3]*rdx11+0.06804138174397717*epsyy[1]*rdx11+0.07856742013183864*epsyy[0]*rdx11-0.03402069087198858*epsxy[7]*rdx01-0.05892556509887897*epsxy[6]*rdx01-0.05892556509887897*epsxy[5]*rdx01+0.03928371006591931*epsxy[4]*rdx01-0.10206207261596573*epsxy[3]*rdx01+0.06804138174397717*epsxy[2]*rdx01+0.06804138174397717*epsxy[1]*rdx01+0.11785113019775795*epsxy[0]*rdx01-0.05892556509887897*epsxx[6]*rdx00-0.06804138174397717*epsxx[3]*rdx00+0.06804138174397717*epsxx[2]*rdx00+0.07856742013183864*epsxx[0]*rdx00+0.06804138174397717*kSq[7]+0.07856742013183864*kSq[6]+0.07856742013183864*kSq[5]-0.07856742013183864*kSq[4]+0.09072184232530293*kSq[3]-0.09072184232530293*kSq[2]-0.09072184232530293*kSq[1]-0.10475656017578487*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[4], -(0.019641855032959656*epsyy[0]*rdx11)+0.019641855032959656*epsxy[4]*rdx01-0.05892556509887897*epsxy[0]*rdx01-0.019641855032959656*epsxx[0]*rdx00-0.013094570021973104*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[5], -(0.03402069087198858*epsyy[1]*rdx11)-0.03928371006591931*epsyy[0]*rdx11-0.019641855032959656*epsxy[4]*rdx01-0.03402069087198858*epsxy[2]*rdx01+0.019641855032959656*epsxx[0]*rdx00-0.022680460581325723*kSq[1]-0.026189140043946214*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[6], 0.019641855032959656*epsyy[0]*rdx11-0.019641855032959656*epsxy[4]*rdx01-0.03402069087198858*epsxy[1]*rdx01-0.03402069087198858*epsxx[2]*rdx00-0.03928371006591931*epsxx[0]*rdx00-0.022680460581325723*kSq[2]-0.026189140043946214*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[7], 0.03402069087198858*epsyy[1]*rdx11+0.03928371006591931*epsyy[0]*rdx11+0.019641855032959656*epsxy[4]*rdx01+0.03402069087198858*epsxy[2]*rdx01+0.03402069087198858*epsxy[1]*rdx01+0.05892556509887897*epsxy[0]*rdx01+0.03402069087198858*epsxx[2]*rdx00+0.03928371006591931*epsxx[0]*rdx00-0.03928371006591931*kSq[4]-0.04536092116265145*kSq[2]-0.04536092116265145*kSq[1]-0.052378280087892436*kSq[0]);
  gkyl_mat_triples_insert(tri, globalIdxs[4], globalIdxs[0], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[4], globalIdxs[1], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[4], globalIdxs[2], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[4], globalIdxs[3], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[4], globalIdxs[4], 1.0);
  gkyl_mat_triples_insert(tri, globalIdxs[4], globalIdxs[5], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[4], globalIdxs[6], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[4], globalIdxs[7], 0.0);
  gkyl_mat_triples_accum(tri, globalIdxs[5], globalIdxs[0], 0.019641855032959656*epsyy[0]*rdx11-0.019641855032959656*epsxy[4]*rdx01+0.03402069087198858*epsxy[1]*rdx01+0.03402069087198858*epsxx[2]*rdx00-0.03928371006591931*epsxx[0]*rdx00+0.022680460581325723*kSq[2]-0.026189140043946214*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[5], globalIdxs[1], 0.03402069087198858*epsyy[1]*rdx11+0.03928371006591931*epsyy[0]*rdx11+0.019641855032959656*epsxy[4]*rdx01+0.03402069087198858*epsxy[2]*rdx01-0.03402069087198858*epsxy[1]*rdx01-0.05892556509887897*epsxy[0]*rdx01-0.03402069087198858*epsxx[2]*rdx00+0.03928371006591931*epsxx[0]*rdx00+0.03928371006591931*kSq[4]+0.04536092116265145*kSq[2]-0.04536092116265145*kSq[1]-0.052378280087892436*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[5], globalIdxs[2], -(0.019641855032959656*epsyy[0]*rdx11)+0.019641855032959656*epsxy[4]*rdx01+0.05892556509887897*epsxy[0]*rdx01-0.019641855032959656*epsxx[0]*rdx00-0.013094570021973104*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[5], globalIdxs[3], -(0.03402069087198858*epsyy[1]*rdx11)-0.03928371006591931*epsyy[0]*rdx11-0.019641855032959656*epsxy[4]*rdx01-0.03402069087198858*epsxy[2]*rdx01+0.019641855032959656*epsxx[0]*rdx00-0.022680460581325723*kSq[1]-0.026189140043946214*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[5], globalIdxs[4], 0.03402069087198858*epsyy[3]*rdx11+0.03928371006591931*epsyy[0]*rdx11-0.03402069087198858*epsxy[7]*rdx01+0.05892556509887897*epsxy[5]*rdx01-0.03928371006591931*epsxy[4]*rdx01+0.06804138174397717*epsxy[1]*rdx01+0.05892556509887897*epsxx[6]*rdx00-0.06804138174397717*epsxx[3]*rdx00+0.06804138174397717*epsxx[2]*rdx00-0.07856742013183864*epsxx[0]*rdx00+0.03928371006591931*kSq[6]-0.04536092116265145*kSq[3]+0.04536092116265145*kSq[2]-0.052378280087892436*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[5], globalIdxs[5], 0.05892556509887897*epsyy[5]*rdx11+0.06804138174397717*epsyy[3]*rdx11+0.06804138174397717*epsyy[1]*rdx11+0.07856742013183864*epsyy[0]*rdx11+0.03402069087198858*epsxy[7]*rdx01+0.05892556509887897*epsxy[6]*rdx01-0.05892556509887897*epsxy[5]*rdx01+0.03928371006591931*epsxy[4]*rdx01-0.10206207261596573*epsxy[3]*rdx01+0.06804138174397717*epsxy[2]*rdx01-0.06804138174397717*epsxy[1]*rdx01-0.11785113019775795*epsxy[0]*rdx01-0.05892556509887897*epsxx[6]*rdx00+0.06804138174397717*epsxx[3]*rdx00-0.06804138174397717*epsxx[2]*rdx00+0.07856742013183864*epsxx[0]*rdx00+0.06804138174397717*kSq[7]+0.07856742013183864*kSq[6]-0.07856742013183864*kSq[5]+0.07856742013183864*kSq[4]-0.09072184232530293*kSq[3]+0.09072184232530293*kSq[2]-0.09072184232530293*kSq[1]-0.10475656017578487*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[5], globalIdxs[6], -(0.03402069087198858*epsyy[3]*rdx11)-0.03928371006591931*epsyy[0]*rdx11+0.03402069087198858*epsxy[7]*rdx01+0.03928371006591931*epsxy[4]*rdx01+0.10206207261596573*epsxy[3]*rdx01+0.11785113019775795*epsxy[0]*rdx01-0.03402069087198858*epsxx[3]*rdx00-0.03928371006591931*epsxx[0]*rdx00-0.022680460581325723*kSq[3]-0.026189140043946214*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[5], globalIdxs[7], -(0.05892556509887897*epsyy[5]*rdx11)-0.06804138174397717*epsyy[3]*rdx11-0.06804138174397717*epsyy[1]*rdx11-0.07856742013183864*epsyy[0]*rdx11-0.03402069087198858*epsxy[7]*rdx01-0.05892556509887897*epsxy[6]*rdx01-0.03928371006591931*epsxy[4]*rdx01-0.06804138174397717*epsxy[2]*rdx01+0.03402069087198858*epsxx[3]*rdx00+0.03928371006591931*epsxx[0]*rdx00-0.03928371006591931*kSq[5]-0.04536092116265145*kSq[3]-0.04536092116265145*kSq[1]-0.052378280087892436*kSq[0]);
  gkyl_mat_triples_insert(tri, globalIdxs[6], globalIdxs[0], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[6], globalIdxs[1], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[6], globalIdxs[2], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[6], globalIdxs[3], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[6], globalIdxs[4], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[6], globalIdxs[5], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[6], globalIdxs[6], 1.0);
  gkyl_mat_triples_insert(tri, globalIdxs[6], globalIdxs[7], 0.0);
  gkyl_mat_triples_accum(tri, globalIdxs[7], globalIdxs[0], -(0.019641855032959656*epsyy[0]*rdx11)+0.019641855032959656*epsxy[4]*rdx01-0.05892556509887897*epsxy[0]*rdx01-0.019641855032959656*epsxx[0]*rdx00-0.013094570021973104*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[7], globalIdxs[1], -(0.03402069087198858*epsyy[1]*rdx11)-0.03928371006591931*epsyy[0]*rdx11-0.019641855032959656*epsxy[4]*rdx01-0.03402069087198858*epsxy[2]*rdx01+0.019641855032959656*epsxx[0]*rdx00-0.022680460581325723*kSq[1]-0.026189140043946214*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[7], globalIdxs[2], 0.019641855032959656*epsyy[0]*rdx11-0.019641855032959656*epsxy[4]*rdx01-0.03402069087198858*epsxy[1]*rdx01-0.03402069087198858*epsxx[2]*rdx00-0.03928371006591931*epsxx[0]*rdx00-0.022680460581325723*kSq[2]-0.026189140043946214*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[7], globalIdxs[3], 0.03402069087198858*epsyy[1]*rdx11+0.03928371006591931*epsyy[0]*rdx11+0.019641855032959656*epsxy[4]*rdx01+0.03402069087198858*epsxy[2]*rdx01+0.03402069087198858*epsxy[1]*rdx01+0.05892556509887897*epsxy[0]*rdx01+0.03402069087198858*epsxx[2]*rdx00+0.03928371006591931*epsxx[0]*rdx00-0.03928371006591931*kSq[4]-0.04536092116265145*kSq[2]-0.04536092116265145*kSq[1]-0.052378280087892436*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[7], globalIdxs[4], -(0.03402069087198858*epsyy[3]*rdx11)-0.03928371006591931*epsyy[0]*rdx11+0.03402069087198858*epsxy[7]*rdx01+0.03928371006591931*epsxy[4]*rdx01-0.10206207261596573*epsxy[3]*rdx01-0.11785113019775795*epsxy[0]*rdx01-0.03402069087198858*epsxx[3]*rdx00-0.03928371006591931*epsxx[0]*rdx00-0.022680460581325723*kSq[3]-0.026189140043946214*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[7], globalIdxs[5], -(0.05892556509887897*epsyy[5]*rdx11)-0.06804138174397717*epsyy[3]*rdx11-0.06804138174397717*epsyy[1]*rdx11-0.07856742013183864*epsyy[0]*rdx11-0.03402069087198858*epsxy[7]*rdx01-0.05892556509887897*epsxy[6]*rdx01-0.03928371006591931*epsxy[4]*rdx01-0.06804138174397717*epsxy[2]*rdx01+0.03402069087198858*epsxx[3]*rdx00+0.03928371006591931*epsxx[0]*rdx00-0.03928371006591931*kSq[5]-0.04536092116265145*kSq[3]-0.04536092116265145*kSq[1]-0.052378280087892436*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[7], globalIdxs[6], 0.03402069087198858*epsyy[3]*rdx11+0.03928371006591931*epsyy[0]*rdx11-0.03402069087198858*epsxy[7]*rdx01-0.05892556509887897*epsxy[5]*rdx01-0.03928371006591931*epsxy[4]*rdx01-0.06804138174397717*epsxy[1]*rdx01-0.05892556509887897*epsxx[6]*rdx00-0.06804138174397717*epsxx[3]*rdx00-0.06804138174397717*epsxx[2]*rdx00-0.07856742013183864*epsxx[0]*rdx00-0.03928371006591931*kSq[6]-0.04536092116265145*kSq[3]-0.04536092116265145*kSq[2]-0.052378280087892436*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[7], globalIdxs[7], 0.05892556509887897*epsyy[5]*rdx11+0.06804138174397717*epsyy[3]*rdx11+0.06804138174397717*epsyy[1]*rdx11+0.07856742013183864*epsyy[0]*rdx11+0.03402069087198858*epsxy[7]*rdx01+0.05892556509887897*epsxy[6]*rdx01+0.05892556509887897*epsxy[5]*rdx01+0.03928371006591931*epsxy[4]*rdx01+0.10206207261596573*epsxy[3]*rdx01+0.06804138174397717*epsxy[2]*rdx01+0.06804138174397717*epsxy[1]*rdx01+0.11785113019775795*epsxy[0]*rdx01+0.05892556509887897*epsxx[6]*rdx00+0.06804138174397717*epsxx[3]*rdx00+0.06804138174397717*epsxx[2]*rdx00+0.07856742013183864*epsxx[0]*rdx00-0.06804138174397717*kSq[7]-0.07856742013183864*kSq[6]-0.07856742013183864*kSq[5]-0.07856742013183864*kSq[4]-0.09072184232530293*kSq[3]-0.09072184232530293*kSq[2]-0.09072184232530293*kSq[1]-0.10475656017578487*kSq[0]);

}

void fem_poisson_perp_lhs_stencil_3x_ser_p1_lox_dirichletx_upy_dirichlety(const double *epsilon, const double *kSq, const double *dx, const double *bcVals, const long *globalIdxs, gkyl_mat_triples *tri) 
{ 
  // epsilon: permittivity tensor.
  // kSq: wave number squared (factor multiplying phi).
  // dx: cell length in each direction.
  // bcVals: values to impose as BCs, i.e. bcVals[off+0]*phi+bcVals[off+1]*epsilon^{ij}*d(phi)/dx_j=bcVals[off+2].
  // globalIdxs: global linear index of each basis function/node in current cell.
  // tri: triples object (i,j,val), i.e. contribute val to i,j element of the global matrix.

  const double *epsxx = &epsilon[0];
  const double *epsxy = &epsilon[8];
  const double *epsyy = &epsilon[16];

  double rdx00 = 4.0/(dx[0]*dx[0]);
  double rdx01 = 4.0/(dx[0]*dx[1]);
  double rdx11 = 4.0/(dx[1]*dx[1]);

  gkyl_mat_triples_insert(tri, globalIdxs[0], globalIdxs[0], 1.0);
  gkyl_mat_triples_insert(tri, globalIdxs[0], globalIdxs[1], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[0], globalIdxs[2], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[0], globalIdxs[3], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[0], globalIdxs[4], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[0], globalIdxs[5], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[0], globalIdxs[6], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[0], globalIdxs[7], 0.0);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[0], -(0.03402069087198858*epsyy[3]*rdx11)+0.03928371006591931*epsyy[0]*rdx11+0.03402069087198858*epsxy[7]*rdx01-0.05892556509887897*epsxy[5]*rdx01-0.03928371006591931*epsxy[4]*rdx01+0.06804138174397717*epsxy[1]*rdx01-0.05892556509887897*epsxx[6]*rdx00+0.06804138174397717*epsxx[3]*rdx00+0.06804138174397717*epsxx[2]*rdx00-0.07856742013183864*epsxx[0]*rdx00-0.03928371006591931*kSq[6]+0.04536092116265145*kSq[3]+0.04536092116265145*kSq[2]-0.052378280087892436*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[1], -(0.05892556509887897*epsyy[5]*rdx11)-0.06804138174397717*epsyy[3]*rdx11+0.06804138174397717*epsyy[1]*rdx11+0.07856742013183864*epsyy[0]*rdx11-0.03402069087198858*epsxy[7]*rdx01-0.05892556509887897*epsxy[6]*rdx01+0.05892556509887897*epsxy[5]*rdx01+0.03928371006591931*epsxy[4]*rdx01+0.10206207261596573*epsxy[3]*rdx01+0.06804138174397717*epsxy[2]*rdx01-0.06804138174397717*epsxy[1]*rdx01-0.11785113019775795*epsxy[0]*rdx01+0.05892556509887897*epsxx[6]*rdx00-0.06804138174397717*epsxx[3]*rdx00-0.06804138174397717*epsxx[2]*rdx00+0.07856742013183864*epsxx[0]*rdx00-0.06804138174397717*kSq[7]-0.07856742013183864*kSq[6]+0.07856742013183864*kSq[5]+0.07856742013183864*kSq[4]+0.09072184232530293*kSq[3]+0.09072184232530293*kSq[2]-0.09072184232530293*kSq[1]-0.10475656017578487*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[2], 0.03402069087198858*epsyy[3]*rdx11-0.03928371006591931*epsyy[0]*rdx11-0.03402069087198858*epsxy[7]*rdx01+0.03928371006591931*epsxy[4]*rdx01-0.10206207261596573*epsxy[3]*rdx01+0.11785113019775795*epsxy[0]*rdx01+0.03402069087198858*epsxx[3]*rdx00-0.03928371006591931*epsxx[0]*rdx00+0.022680460581325723*kSq[3]-0.026189140043946214*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[3], 0.05892556509887897*epsyy[5]*rdx11+0.06804138174397717*epsyy[3]*rdx11-0.06804138174397717*epsyy[1]*rdx11-0.07856742013183864*epsyy[0]*rdx11+0.03402069087198858*epsxy[7]*rdx01+0.05892556509887897*epsxy[6]*rdx01-0.03928371006591931*epsxy[4]*rdx01-0.06804138174397717*epsxy[2]*rdx01-0.03402069087198858*epsxx[3]*rdx00+0.03928371006591931*epsxx[0]*rdx00+0.03928371006591931*kSq[5]+0.04536092116265145*kSq[3]-0.04536092116265145*kSq[1]-0.052378280087892436*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[4], 0.019641855032959656*epsyy[0]*rdx11-0.019641855032959656*epsxy[4]*rdx01+0.03402069087198858*epsxy[1]*rdx01+0.03402069087198858*epsxx[2]*rdx00-0.03928371006591931*epsxx[0]*rdx00+0.022680460581325723*kSq[2]-0.026189140043946214*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[5], 0.03402069087198858*epsyy[1]*rdx11+0.03928371006591931*epsyy[0]*rdx11+0.019641855032959656*epsxy[4]*rdx01+0.03402069087198858*epsxy[2]*rdx01-0.03402069087198858*epsxy[1]*rdx01-0.05892556509887897*epsxy[0]*rdx01-0.03402069087198858*epsxx[2]*rdx00+0.03928371006591931*epsxx[0]*rdx00+0.03928371006591931*kSq[4]+0.04536092116265145*kSq[2]-0.04536092116265145*kSq[1]-0.052378280087892436*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[6], -(0.019641855032959656*epsyy[0]*rdx11)+0.019641855032959656*epsxy[4]*rdx01+0.05892556509887897*epsxy[0]*rdx01-0.019641855032959656*epsxx[0]*rdx00-0.013094570021973104*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[7], -(0.03402069087198858*epsyy[1]*rdx11)-0.03928371006591931*epsyy[0]*rdx11-0.019641855032959656*epsxy[4]*rdx01-0.03402069087198858*epsxy[2]*rdx01+0.019641855032959656*epsxx[0]*rdx00-0.022680460581325723*kSq[1]-0.026189140043946214*kSq[0]);
  gkyl_mat_triples_insert(tri, globalIdxs[2], globalIdxs[0], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[2], globalIdxs[1], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[2], globalIdxs[2], 1.0);
  gkyl_mat_triples_insert(tri, globalIdxs[2], globalIdxs[3], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[2], globalIdxs[4], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[2], globalIdxs[5], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[2], globalIdxs[6], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[2], globalIdxs[7], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[3], globalIdxs[0], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[3], globalIdxs[1], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[3], globalIdxs[2], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[3], globalIdxs[3], 1.0);
  gkyl_mat_triples_insert(tri, globalIdxs[3], globalIdxs[4], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[3], globalIdxs[5], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[3], globalIdxs[6], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[3], globalIdxs[7], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[4], globalIdxs[0], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[4], globalIdxs[1], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[4], globalIdxs[2], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[4], globalIdxs[3], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[4], globalIdxs[4], 1.0);
  gkyl_mat_triples_insert(tri, globalIdxs[4], globalIdxs[5], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[4], globalIdxs[6], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[4], globalIdxs[7], 0.0);
  gkyl_mat_triples_accum(tri, globalIdxs[5], globalIdxs[0], 0.019641855032959656*epsyy[0]*rdx11-0.019641855032959656*epsxy[4]*rdx01+0.03402069087198858*epsxy[1]*rdx01+0.03402069087198858*epsxx[2]*rdx00-0.03928371006591931*epsxx[0]*rdx00+0.022680460581325723*kSq[2]-0.026189140043946214*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[5], globalIdxs[1], 0.03402069087198858*epsyy[1]*rdx11+0.03928371006591931*epsyy[0]*rdx11+0.019641855032959656*epsxy[4]*rdx01+0.03402069087198858*epsxy[2]*rdx01-0.03402069087198858*epsxy[1]*rdx01-0.05892556509887897*epsxy[0]*rdx01-0.03402069087198858*epsxx[2]*rdx00+0.03928371006591931*epsxx[0]*rdx00+0.03928371006591931*kSq[4]+0.04536092116265145*kSq[2]-0.04536092116265145*kSq[1]-0.052378280087892436*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[5], globalIdxs[2], -(0.019641855032959656*epsyy[0]*rdx11)+0.019641855032959656*epsxy[4]*rdx01+0.05892556509887897*epsxy[0]*rdx01-0.019641855032959656*epsxx[0]*rdx00-0.013094570021973104*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[5], globalIdxs[3], -(0.03402069087198858*epsyy[1]*rdx11)-0.03928371006591931*epsyy[0]*rdx11-0.019641855032959656*epsxy[4]*rdx01-0.03402069087198858*epsxy[2]*rdx01+0.019641855032959656*epsxx[0]*rdx00-0.022680460581325723*kSq[1]-0.026189140043946214*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[5], globalIdxs[4], 0.03402069087198858*epsyy[3]*rdx11+0.03928371006591931*epsyy[0]*rdx11-0.03402069087198858*epsxy[7]*rdx01+0.05892556509887897*epsxy[5]*rdx01-0.03928371006591931*epsxy[4]*rdx01+0.06804138174397717*epsxy[1]*rdx01+0.05892556509887897*epsxx[6]*rdx00-0.06804138174397717*epsxx[3]*rdx00+0.06804138174397717*epsxx[2]*rdx00-0.07856742013183864*epsxx[0]*rdx00+0.03928371006591931*kSq[6]-0.04536092116265145*kSq[3]+0.04536092116265145*kSq[2]-0.052378280087892436*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[5], globalIdxs[5], 0.05892556509887897*epsyy[5]*rdx11+0.06804138174397717*epsyy[3]*rdx11+0.06804138174397717*epsyy[1]*rdx11+0.07856742013183864*epsyy[0]*rdx11+0.03402069087198858*epsxy[7]*rdx01+0.05892556509887897*epsxy[6]*rdx01-0.05892556509887897*epsxy[5]*rdx01+0.03928371006591931*epsxy[4]*rdx01-0.10206207261596573*epsxy[3]*rdx01+0.06804138174397717*epsxy[2]*rdx01-0.06804138174397717*epsxy[1]*rdx01-0.11785113019775795*epsxy[0]*rdx01-0.05892556509887897*epsxx[6]*rdx00+0.06804138174397717*epsxx[3]*rdx00-0.06804138174397717*epsxx[2]*rdx00+0.07856742013183864*epsxx[0]*rdx00+0.06804138174397717*kSq[7]+0.07856742013183864*kSq[6]-0.07856742013183864*kSq[5]+0.07856742013183864*kSq[4]-0.09072184232530293*kSq[3]+0.09072184232530293*kSq[2]-0.09072184232530293*kSq[1]-0.10475656017578487*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[5], globalIdxs[6], -(0.03402069087198858*epsyy[3]*rdx11)-0.03928371006591931*epsyy[0]*rdx11+0.03402069087198858*epsxy[7]*rdx01+0.03928371006591931*epsxy[4]*rdx01+0.10206207261596573*epsxy[3]*rdx01+0.11785113019775795*epsxy[0]*rdx01-0.03402069087198858*epsxx[3]*rdx00-0.03928371006591931*epsxx[0]*rdx00-0.022680460581325723*kSq[3]-0.026189140043946214*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[5], globalIdxs[7], -(0.05892556509887897*epsyy[5]*rdx11)-0.06804138174397717*epsyy[3]*rdx11-0.06804138174397717*epsyy[1]*rdx11-0.07856742013183864*epsyy[0]*rdx11-0.03402069087198858*epsxy[7]*rdx01-0.05892556509887897*epsxy[6]*rdx01-0.03928371006591931*epsxy[4]*rdx01-0.06804138174397717*epsxy[2]*rdx01+0.03402069087198858*epsxx[3]*rdx00+0.03928371006591931*epsxx[0]*rdx00-0.03928371006591931*kSq[5]-0.04536092116265145*kSq[3]-0.04536092116265145*kSq[1]-0.052378280087892436*kSq[0]);
  gkyl_mat_triples_insert(tri, globalIdxs[6], globalIdxs[0], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[6], globalIdxs[1], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[6], globalIdxs[2], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[6], globalIdxs[3], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[6], globalIdxs[4], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[6], globalIdxs[5], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[6], globalIdxs[6], 1.0);
  gkyl_mat_triples_insert(tri, globalIdxs[6], globalIdxs[7], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[7], globalIdxs[0], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[7], globalIdxs[1], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[7], globalIdxs[2], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[7], globalIdxs[3], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[7], globalIdxs[4], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[7], globalIdxs[5], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[7], globalIdxs[6], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[7], globalIdxs[7], 1.0);

}

void fem_poisson_perp_lhs_stencil_3x_ser_p1_lox_dirichletx_upy_neumanny(const double *epsilon, const double *kSq, const double *dx, const double *bcVals, const long *globalIdxs, gkyl_mat_triples *tri) 
{ 
  // epsilon: permittivity tensor.
  // kSq: wave number squared (factor multiplying phi).
  // dx: cell length in each direction.
  // bcVals: values to impose as BCs, i.e. bcVals[off+0]*phi+bcVals[off+1]*epsilon^{ij}*d(phi)/dx_j=bcVals[off+2].
  // globalIdxs: global linear index of each basis function/node in current cell.
  // tri: triples object (i,j,val), i.e. contribute val to i,j element of the global matrix.

  const double *epsxx = &epsilon[0];
  const double *epsxy = &epsilon[8];
  const double *epsyy = &epsilon[16];

  double rdx00 = 4.0/(dx[0]*dx[0]);
  double rdx01 = 4.0/(dx[0]*dx[1]);
  double rdx11 = 4.0/(dx[1]*dx[1]);

  double rdx2[2]; 
  rdx2[0] = 2.0/dx[0]; 
  rdx2[1] = 2.0/dx[1]; 

  gkyl_mat_triples_insert(tri, globalIdxs[0], globalIdxs[0], 1.0);
  gkyl_mat_triples_insert(tri, globalIdxs[0], globalIdxs[1], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[0], globalIdxs[2], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[0], globalIdxs[3], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[0], globalIdxs[4], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[0], globalIdxs[5], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[0], globalIdxs[6], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[0], globalIdxs[7], 0.0);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[0], -(0.03402069087198858*epsyy[3]*rdx11)+0.03928371006591931*epsyy[0]*rdx11+0.03402069087198858*epsxy[7]*rdx01-0.05892556509887897*epsxy[5]*rdx01-0.03928371006591931*epsxy[4]*rdx01+0.06804138174397717*epsxy[1]*rdx01-0.05892556509887897*epsxx[6]*rdx00+0.06804138174397717*epsxx[3]*rdx00+0.06804138174397717*epsxx[2]*rdx00-0.07856742013183864*epsxx[0]*rdx00-0.03928371006591931*kSq[6]+0.04536092116265145*kSq[3]+0.04536092116265145*kSq[2]-0.052378280087892436*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[1], -(0.05892556509887897*epsyy[5]*rdx11)-0.06804138174397717*epsyy[3]*rdx11+0.06804138174397717*epsyy[1]*rdx11+0.07856742013183864*epsyy[0]*rdx11-0.03402069087198858*epsxy[7]*rdx01-0.05892556509887897*epsxy[6]*rdx01+0.05892556509887897*epsxy[5]*rdx01+0.03928371006591931*epsxy[4]*rdx01+0.10206207261596573*epsxy[3]*rdx01+0.06804138174397717*epsxy[2]*rdx01-0.06804138174397717*epsxy[1]*rdx01-0.11785113019775795*epsxy[0]*rdx01+0.05892556509887897*epsxx[6]*rdx00-0.06804138174397717*epsxx[3]*rdx00-0.06804138174397717*epsxx[2]*rdx00+0.07856742013183864*epsxx[0]*rdx00-0.06804138174397717*kSq[7]-0.07856742013183864*kSq[6]+0.07856742013183864*kSq[5]+0.07856742013183864*kSq[4]+0.09072184232530293*kSq[3]+0.09072184232530293*kSq[2]-0.09072184232530293*kSq[1]-0.10475656017578487*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[2], 0.03402069087198858*epsyy[3]*rdx11-0.03928371006591931*epsyy[0]*rdx11-0.03402069087198858*epsxy[7]*rdx01+0.03928371006591931*epsxy[4]*rdx01-0.10206207261596573*epsxy[3]*rdx01+0.11785113019775795*epsxy[0]*rdx01+0.03402069087198858*epsxx[3]*rdx00-0.03928371006591931*epsxx[0]*rdx00+0.022680460581325723*kSq[3]-0.026189140043946214*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[3], 0.05892556509887897*epsyy[5]*rdx11+0.06804138174397717*epsyy[3]*rdx11-0.06804138174397717*epsyy[1]*rdx11-0.07856742013183864*epsyy[0]*rdx11+0.03402069087198858*epsxy[7]*rdx01+0.05892556509887897*epsxy[6]*rdx01-0.03928371006591931*epsxy[4]*rdx01-0.06804138174397717*epsxy[2]*rdx01-0.03402069087198858*epsxx[3]*rdx00+0.03928371006591931*epsxx[0]*rdx00+0.03928371006591931*kSq[5]+0.04536092116265145*kSq[3]-0.04536092116265145*kSq[1]-0.052378280087892436*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[4], 0.019641855032959656*epsyy[0]*rdx11-0.019641855032959656*epsxy[4]*rdx01+0.03402069087198858*epsxy[1]*rdx01+0.03402069087198858*epsxx[2]*rdx00-0.03928371006591931*epsxx[0]*rdx00+0.022680460581325723*kSq[2]-0.026189140043946214*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[5], 0.03402069087198858*epsyy[1]*rdx11+0.03928371006591931*epsyy[0]*rdx11+0.019641855032959656*epsxy[4]*rdx01+0.03402069087198858*epsxy[2]*rdx01-0.03402069087198858*epsxy[1]*rdx01-0.05892556509887897*epsxy[0]*rdx01-0.03402069087198858*epsxx[2]*rdx00+0.03928371006591931*epsxx[0]*rdx00+0.03928371006591931*kSq[4]+0.04536092116265145*kSq[2]-0.04536092116265145*kSq[1]-0.052378280087892436*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[6], -(0.019641855032959656*epsyy[0]*rdx11)+0.019641855032959656*epsxy[4]*rdx01+0.05892556509887897*epsxy[0]*rdx01-0.019641855032959656*epsxx[0]*rdx00-0.013094570021973104*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[7], -(0.03402069087198858*epsyy[1]*rdx11)-0.03928371006591931*epsyy[0]*rdx11-0.019641855032959656*epsxy[4]*rdx01-0.03402069087198858*epsxy[2]*rdx01+0.019641855032959656*epsxx[0]*rdx00-0.022680460581325723*kSq[1]-0.026189140043946214*kSq[0]);
  gkyl_mat_triples_insert(tri, globalIdxs[2], globalIdxs[0], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[2], globalIdxs[1], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[2], globalIdxs[2], 1.0);
  gkyl_mat_triples_insert(tri, globalIdxs[2], globalIdxs[3], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[2], globalIdxs[4], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[2], globalIdxs[5], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[2], globalIdxs[6], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[2], globalIdxs[7], 0.0);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[0], 0.03402069087198858*epsyy[3]*rdx11-0.03928371006591931*epsyy[0]*rdx11-0.03402069087198858*epsxy[7]*rdx01+0.03928371006591931*epsxy[4]*rdx01+0.10206207261596573*epsxy[3]*rdx01-0.11785113019775795*epsxy[0]*rdx01+0.03402069087198858*epsxx[3]*rdx00-0.03928371006591931*epsxx[0]*rdx00+0.022680460581325723*kSq[3]-0.026189140043946214*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[1], 0.05892556509887897*epsyy[5]*rdx11+0.06804138174397717*epsyy[3]*rdx11-0.06804138174397717*epsyy[1]*rdx11-0.07856742013183864*epsyy[0]*rdx11+0.03402069087198858*epsxy[7]*rdx01+0.05892556509887897*epsxy[6]*rdx01-0.03928371006591931*epsxy[4]*rdx01-0.06804138174397717*epsxy[2]*rdx01-0.03402069087198858*epsxx[3]*rdx00+0.03928371006591931*epsxx[0]*rdx00+0.03928371006591931*kSq[5]+0.04536092116265145*kSq[3]-0.04536092116265145*kSq[1]-0.052378280087892436*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[2], -(0.03402069087198858*epsyy[3]*rdx11)+0.03928371006591931*epsyy[0]*rdx11+0.03402069087198858*epsxy[7]*rdx01+0.05892556509887897*epsxy[5]*rdx01-0.03928371006591931*epsxy[4]*rdx01-0.06804138174397717*epsxy[1]*rdx01+0.05892556509887897*epsxx[6]*rdx00+0.06804138174397717*epsxx[3]*rdx00-0.06804138174397717*epsxx[2]*rdx00-0.07856742013183864*epsxx[0]*rdx00+0.03928371006591931*kSq[6]+0.04536092116265145*kSq[3]-0.04536092116265145*kSq[2]-0.052378280087892436*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[3], -(0.05892556509887897*epsyy[5]*rdx11)-0.06804138174397717*epsyy[3]*rdx11+0.06804138174397717*epsyy[1]*rdx11+0.07856742013183864*epsyy[0]*rdx11-0.03402069087198858*epsxy[7]*rdx01-0.05892556509887897*epsxy[6]*rdx01-0.05892556509887897*epsxy[5]*rdx01+0.03928371006591931*epsxy[4]*rdx01-0.10206207261596573*epsxy[3]*rdx01+0.06804138174397717*epsxy[2]*rdx01+0.06804138174397717*epsxy[1]*rdx01+0.11785113019775795*epsxy[0]*rdx01-0.05892556509887897*epsxx[6]*rdx00-0.06804138174397717*epsxx[3]*rdx00+0.06804138174397717*epsxx[2]*rdx00+0.07856742013183864*epsxx[0]*rdx00+0.06804138174397717*kSq[7]+0.07856742013183864*kSq[6]+0.07856742013183864*kSq[5]-0.07856742013183864*kSq[4]+0.09072184232530293*kSq[3]-0.09072184232530293*kSq[2]-0.09072184232530293*kSq[1]-0.10475656017578487*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[4], -(0.019641855032959656*epsyy[0]*rdx11)+0.019641855032959656*epsxy[4]*rdx01-0.05892556509887897*epsxy[0]*rdx01-0.019641855032959656*epsxx[0]*rdx00-0.013094570021973104*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[5], -(0.03402069087198858*epsyy[1]*rdx11)-0.03928371006591931*epsyy[0]*rdx11-0.019641855032959656*epsxy[4]*rdx01-0.03402069087198858*epsxy[2]*rdx01+0.019641855032959656*epsxx[0]*rdx00-0.022680460581325723*kSq[1]-0.026189140043946214*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[6], 0.019641855032959656*epsyy[0]*rdx11-0.019641855032959656*epsxy[4]*rdx01-0.03402069087198858*epsxy[1]*rdx01-0.03402069087198858*epsxx[2]*rdx00-0.03928371006591931*epsxx[0]*rdx00-0.022680460581325723*kSq[2]-0.026189140043946214*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[7], 0.03402069087198858*epsyy[1]*rdx11+0.03928371006591931*epsyy[0]*rdx11+0.019641855032959656*epsxy[4]*rdx01+0.03402069087198858*epsxy[2]*rdx01+0.03402069087198858*epsxy[1]*rdx01+0.05892556509887897*epsxy[0]*rdx01+0.03402069087198858*epsxx[2]*rdx00+0.03928371006591931*epsxx[0]*rdx00-0.03928371006591931*kSq[4]-0.04536092116265145*kSq[2]-0.04536092116265145*kSq[1]-0.052378280087892436*kSq[0]);
  gkyl_mat_triples_insert(tri, globalIdxs[4], globalIdxs[0], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[4], globalIdxs[1], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[4], globalIdxs[2], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[4], globalIdxs[3], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[4], globalIdxs[4], 1.0);
  gkyl_mat_triples_insert(tri, globalIdxs[4], globalIdxs[5], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[4], globalIdxs[6], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[4], globalIdxs[7], 0.0);
  gkyl_mat_triples_accum(tri, globalIdxs[5], globalIdxs[0], 0.019641855032959656*epsyy[0]*rdx11-0.019641855032959656*epsxy[4]*rdx01+0.03402069087198858*epsxy[1]*rdx01+0.03402069087198858*epsxx[2]*rdx00-0.03928371006591931*epsxx[0]*rdx00+0.022680460581325723*kSq[2]-0.026189140043946214*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[5], globalIdxs[1], 0.03402069087198858*epsyy[1]*rdx11+0.03928371006591931*epsyy[0]*rdx11+0.019641855032959656*epsxy[4]*rdx01+0.03402069087198858*epsxy[2]*rdx01-0.03402069087198858*epsxy[1]*rdx01-0.05892556509887897*epsxy[0]*rdx01-0.03402069087198858*epsxx[2]*rdx00+0.03928371006591931*epsxx[0]*rdx00+0.03928371006591931*kSq[4]+0.04536092116265145*kSq[2]-0.04536092116265145*kSq[1]-0.052378280087892436*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[5], globalIdxs[2], -(0.019641855032959656*epsyy[0]*rdx11)+0.019641855032959656*epsxy[4]*rdx01+0.05892556509887897*epsxy[0]*rdx01-0.019641855032959656*epsxx[0]*rdx00-0.013094570021973104*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[5], globalIdxs[3], -(0.03402069087198858*epsyy[1]*rdx11)-0.03928371006591931*epsyy[0]*rdx11-0.019641855032959656*epsxy[4]*rdx01-0.03402069087198858*epsxy[2]*rdx01+0.019641855032959656*epsxx[0]*rdx00-0.022680460581325723*kSq[1]-0.026189140043946214*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[5], globalIdxs[4], 0.03402069087198858*epsyy[3]*rdx11+0.03928371006591931*epsyy[0]*rdx11-0.03402069087198858*epsxy[7]*rdx01+0.05892556509887897*epsxy[5]*rdx01-0.03928371006591931*epsxy[4]*rdx01+0.06804138174397717*epsxy[1]*rdx01+0.05892556509887897*epsxx[6]*rdx00-0.06804138174397717*epsxx[3]*rdx00+0.06804138174397717*epsxx[2]*rdx00-0.07856742013183864*epsxx[0]*rdx00+0.03928371006591931*kSq[6]-0.04536092116265145*kSq[3]+0.04536092116265145*kSq[2]-0.052378280087892436*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[5], globalIdxs[5], 0.05892556509887897*epsyy[5]*rdx11+0.06804138174397717*epsyy[3]*rdx11+0.06804138174397717*epsyy[1]*rdx11+0.07856742013183864*epsyy[0]*rdx11+0.03402069087198858*epsxy[7]*rdx01+0.05892556509887897*epsxy[6]*rdx01-0.05892556509887897*epsxy[5]*rdx01+0.03928371006591931*epsxy[4]*rdx01-0.10206207261596573*epsxy[3]*rdx01+0.06804138174397717*epsxy[2]*rdx01-0.06804138174397717*epsxy[1]*rdx01-0.11785113019775795*epsxy[0]*rdx01-0.05892556509887897*epsxx[6]*rdx00+0.06804138174397717*epsxx[3]*rdx00-0.06804138174397717*epsxx[2]*rdx00+0.07856742013183864*epsxx[0]*rdx00+0.06804138174397717*kSq[7]+0.07856742013183864*kSq[6]-0.07856742013183864*kSq[5]+0.07856742013183864*kSq[4]-0.09072184232530293*kSq[3]+0.09072184232530293*kSq[2]-0.09072184232530293*kSq[1]-0.10475656017578487*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[5], globalIdxs[6], -(0.03402069087198858*epsyy[3]*rdx11)-0.03928371006591931*epsyy[0]*rdx11+0.03402069087198858*epsxy[7]*rdx01+0.03928371006591931*epsxy[4]*rdx01+0.10206207261596573*epsxy[3]*rdx01+0.11785113019775795*epsxy[0]*rdx01-0.03402069087198858*epsxx[3]*rdx00-0.03928371006591931*epsxx[0]*rdx00-0.022680460581325723*kSq[3]-0.026189140043946214*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[5], globalIdxs[7], -(0.05892556509887897*epsyy[5]*rdx11)-0.06804138174397717*epsyy[3]*rdx11-0.06804138174397717*epsyy[1]*rdx11-0.07856742013183864*epsyy[0]*rdx11-0.03402069087198858*epsxy[7]*rdx01-0.05892556509887897*epsxy[6]*rdx01-0.03928371006591931*epsxy[4]*rdx01-0.06804138174397717*epsxy[2]*rdx01+0.03402069087198858*epsxx[3]*rdx00+0.03928371006591931*epsxx[0]*rdx00-0.03928371006591931*kSq[5]-0.04536092116265145*kSq[3]-0.04536092116265145*kSq[1]-0.052378280087892436*kSq[0]);
  gkyl_mat_triples_insert(tri, globalIdxs[6], globalIdxs[0], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[6], globalIdxs[1], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[6], globalIdxs[2], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[6], globalIdxs[3], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[6], globalIdxs[4], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[6], globalIdxs[5], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[6], globalIdxs[6], 1.0);
  gkyl_mat_triples_insert(tri, globalIdxs[6], globalIdxs[7], 0.0);
  gkyl_mat_triples_accum(tri, globalIdxs[7], globalIdxs[0], -(0.019641855032959656*epsyy[0]*rdx11)+0.019641855032959656*epsxy[4]*rdx01-0.05892556509887897*epsxy[0]*rdx01-0.019641855032959656*epsxx[0]*rdx00-0.013094570021973104*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[7], globalIdxs[1], -(0.03402069087198858*epsyy[1]*rdx11)-0.03928371006591931*epsyy[0]*rdx11-0.019641855032959656*epsxy[4]*rdx01-0.03402069087198858*epsxy[2]*rdx01+0.019641855032959656*epsxx[0]*rdx00-0.022680460581325723*kSq[1]-0.026189140043946214*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[7], globalIdxs[2], 0.019641855032959656*epsyy[0]*rdx11-0.019641855032959656*epsxy[4]*rdx01-0.03402069087198858*epsxy[1]*rdx01-0.03402069087198858*epsxx[2]*rdx00-0.03928371006591931*epsxx[0]*rdx00-0.022680460581325723*kSq[2]-0.026189140043946214*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[7], globalIdxs[3], 0.03402069087198858*epsyy[1]*rdx11+0.03928371006591931*epsyy[0]*rdx11+0.019641855032959656*epsxy[4]*rdx01+0.03402069087198858*epsxy[2]*rdx01+0.03402069087198858*epsxy[1]*rdx01+0.05892556509887897*epsxy[0]*rdx01+0.03402069087198858*epsxx[2]*rdx00+0.03928371006591931*epsxx[0]*rdx00-0.03928371006591931*kSq[4]-0.04536092116265145*kSq[2]-0.04536092116265145*kSq[1]-0.052378280087892436*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[7], globalIdxs[4], -(0.03402069087198858*epsyy[3]*rdx11)-0.03928371006591931*epsyy[0]*rdx11+0.03402069087198858*epsxy[7]*rdx01+0.03928371006591931*epsxy[4]*rdx01-0.10206207261596573*epsxy[3]*rdx01-0.11785113019775795*epsxy[0]*rdx01-0.03402069087198858*epsxx[3]*rdx00-0.03928371006591931*epsxx[0]*rdx00-0.022680460581325723*kSq[3]-0.026189140043946214*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[7], globalIdxs[5], -(0.05892556509887897*epsyy[5]*rdx11)-0.06804138174397717*epsyy[3]*rdx11-0.06804138174397717*epsyy[1]*rdx11-0.07856742013183864*epsyy[0]*rdx11-0.03402069087198858*epsxy[7]*rdx01-0.05892556509887897*epsxy[6]*rdx01-0.03928371006591931*epsxy[4]*rdx01-0.06804138174397717*epsxy[2]*rdx01+0.03402069087198858*epsxx[3]*rdx00+0.03928371006591931*epsxx[0]*rdx00-0.03928371006591931*kSq[5]-0.04536092116265145*kSq[3]-0.04536092116265145*kSq[1]-0.052378280087892436*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[7], globalIdxs[6], 0.03402069087198858*epsyy[3]*rdx11+0.03928371006591931*epsyy[0]*rdx11-0.03402069087198858*epsxy[7]*rdx01-0.05892556509887897*epsxy[5]*rdx01-0.03928371006591931*epsxy[4]*rdx01-0.06804138174397717*epsxy[1]*rdx01-0.05892556509887897*epsxx[6]*rdx00-0.06804138174397717*epsxx[3]*rdx00-0.06804138174397717*epsxx[2]*rdx00-0.07856742013183864*epsxx[0]*rdx00-0.03928371006591931*kSq[6]-0.04536092116265145*kSq[3]-0.04536092116265145*kSq[2]-0.052378280087892436*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[7], globalIdxs[7], 0.05892556509887897*epsyy[5]*rdx11+0.06804138174397717*epsyy[3]*rdx11+0.06804138174397717*epsyy[1]*rdx11+0.07856742013183864*epsyy[0]*rdx11+0.03402069087198858*epsxy[7]*rdx01+0.05892556509887897*epsxy[6]*rdx01+0.05892556509887897*epsxy[5]*rdx01+0.03928371006591931*epsxy[4]*rdx01+0.10206207261596573*epsxy[3]*rdx01+0.06804138174397717*epsxy[2]*rdx01+0.06804138174397717*epsxy[1]*rdx01+0.11785113019775795*epsxy[0]*rdx01+0.05892556509887897*epsxx[6]*rdx00+0.06804138174397717*epsxx[3]*rdx00+0.06804138174397717*epsxx[2]*rdx00+0.07856742013183864*epsxx[0]*rdx00-0.06804138174397717*kSq[7]-0.07856742013183864*kSq[6]-0.07856742013183864*kSq[5]-0.07856742013183864*kSq[4]-0.09072184232530293*kSq[3]-0.09072184232530293*kSq[2]-0.09072184232530293*kSq[1]-0.10475656017578487*kSq[0]);

}

void fem_poisson_perp_lhs_stencil_3x_ser_p1_lox_neumannx_upy_periodicy(const double *epsilon, const double *kSq, const double *dx, const double *bcVals, const long *globalIdxs, gkyl_mat_triples *tri) 
{ 
  // epsilon: permittivity tensor.
  // kSq: wave number squared (factor multiplying phi).
  // dx: cell length in each direction.
  // bcVals: values to impose as BCs, i.e. bcVals[off+0]*phi+bcVals[off+1]*epsilon^{ij}*d(phi)/dx_j=bcVals[off+2].
  // globalIdxs: global linear index of each basis function/node in current cell.
  // tri: triples object (i,j,val), i.e. contribute val to i,j element of the global matrix.

  const double *epsxx = &epsilon[0];
  const double *epsxy = &epsilon[8];
  const double *epsyy = &epsilon[16];

  double rdx00 = 4.0/(dx[0]*dx[0]);
  double rdx01 = 4.0/(dx[0]*dx[1]);
  double rdx11 = 4.0/(dx[1]*dx[1]);

  double rdx2[2]; 
  rdx2[0] = 2.0/dx[0]; 
  rdx2[1] = 2.0/dx[1]; 

  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[0], 0.05892556509887897*epsyy[5]*rdx11-0.06804138174397717*epsyy[3]*rdx11-0.06804138174397717*epsyy[1]*rdx11+0.07856742013183864*epsyy[0]*rdx11-0.03402069087198858*epsxy[7]*rdx01+0.05892556509887897*epsxy[6]*rdx01+0.05892556509887897*epsxy[5]*rdx01+0.03928371006591931*epsxy[4]*rdx01-0.10206207261596573*epsxy[3]*rdx01-0.06804138174397717*epsxy[2]*rdx01-0.06804138174397717*epsxy[1]*rdx01+0.11785113019775795*epsxy[0]*rdx01+0.05892556509887897*epsxx[6]*rdx00-0.06804138174397717*epsxx[3]*rdx00-0.06804138174397717*epsxx[2]*rdx00+0.07856742013183864*epsxx[0]*rdx00+0.06804138174397717*kSq[7]-0.07856742013183864*kSq[6]-0.07856742013183864*kSq[5]-0.07856742013183864*kSq[4]+0.09072184232530293*kSq[3]+0.09072184232530293*kSq[2]+0.09072184232530293*kSq[1]-0.10475656017578487*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[1], -(0.03402069087198858*epsyy[3]*rdx11)+0.03928371006591931*epsyy[0]*rdx11+0.03402069087198858*epsxy[7]*rdx01-0.05892556509887897*epsxy[5]*rdx01-0.03928371006591931*epsxy[4]*rdx01+0.06804138174397717*epsxy[1]*rdx01-0.05892556509887897*epsxx[6]*rdx00+0.06804138174397717*epsxx[3]*rdx00+0.06804138174397717*epsxx[2]*rdx00-0.07856742013183864*epsxx[0]*rdx00-0.03928371006591931*kSq[6]+0.04536092116265145*kSq[3]+0.04536092116265145*kSq[2]-0.052378280087892436*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[2], -(0.05892556509887897*epsyy[5]*rdx11)+0.06804138174397717*epsyy[3]*rdx11+0.06804138174397717*epsyy[1]*rdx11-0.07856742013183864*epsyy[0]*rdx11+0.03402069087198858*epsxy[7]*rdx01-0.05892556509887897*epsxy[6]*rdx01-0.03928371006591931*epsxy[4]*rdx01+0.06804138174397717*epsxy[2]*rdx01-0.03402069087198858*epsxx[3]*rdx00+0.03928371006591931*epsxx[0]*rdx00-0.03928371006591931*kSq[5]+0.04536092116265145*kSq[3]+0.04536092116265145*kSq[1]-0.052378280087892436*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[3], 0.03402069087198858*epsyy[3]*rdx11-0.03928371006591931*epsyy[0]*rdx11-0.03402069087198858*epsxy[7]*rdx01+0.03928371006591931*epsxy[4]*rdx01+0.10206207261596573*epsxy[3]*rdx01-0.11785113019775795*epsxy[0]*rdx01+0.03402069087198858*epsxx[3]*rdx00-0.03928371006591931*epsxx[0]*rdx00+0.022680460581325723*kSq[3]-0.026189140043946214*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[4], -(0.03402069087198858*epsyy[1]*rdx11)+0.03928371006591931*epsyy[0]*rdx11+0.019641855032959656*epsxy[4]*rdx01-0.03402069087198858*epsxy[2]*rdx01-0.03402069087198858*epsxy[1]*rdx01+0.05892556509887897*epsxy[0]*rdx01-0.03402069087198858*epsxx[2]*rdx00+0.03928371006591931*epsxx[0]*rdx00-0.03928371006591931*kSq[4]+0.04536092116265145*kSq[2]+0.04536092116265145*kSq[1]-0.052378280087892436*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[5], 0.019641855032959656*epsyy[0]*rdx11-0.019641855032959656*epsxy[4]*rdx01+0.03402069087198858*epsxy[1]*rdx01+0.03402069087198858*epsxx[2]*rdx00-0.03928371006591931*epsxx[0]*rdx00+0.022680460581325723*kSq[2]-0.026189140043946214*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[6], 0.03402069087198858*epsyy[1]*rdx11-0.03928371006591931*epsyy[0]*rdx11-0.019641855032959656*epsxy[4]*rdx01+0.03402069087198858*epsxy[2]*rdx01+0.019641855032959656*epsxx[0]*rdx00+0.022680460581325723*kSq[1]-0.026189140043946214*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[7], -(0.019641855032959656*epsyy[0]*rdx11)+0.019641855032959656*epsxy[4]*rdx01-0.05892556509887897*epsxy[0]*rdx01-0.019641855032959656*epsxx[0]*rdx00-0.013094570021973104*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[0], -(0.03402069087198858*epsyy[3]*rdx11)+0.03928371006591931*epsyy[0]*rdx11+0.03402069087198858*epsxy[7]*rdx01-0.05892556509887897*epsxy[5]*rdx01-0.03928371006591931*epsxy[4]*rdx01+0.06804138174397717*epsxy[1]*rdx01-0.05892556509887897*epsxx[6]*rdx00+0.06804138174397717*epsxx[3]*rdx00+0.06804138174397717*epsxx[2]*rdx00-0.07856742013183864*epsxx[0]*rdx00-0.03928371006591931*kSq[6]+0.04536092116265145*kSq[3]+0.04536092116265145*kSq[2]-0.052378280087892436*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[1], -(0.05892556509887897*epsyy[5]*rdx11)-0.06804138174397717*epsyy[3]*rdx11+0.06804138174397717*epsyy[1]*rdx11+0.07856742013183864*epsyy[0]*rdx11-0.03402069087198858*epsxy[7]*rdx01-0.05892556509887897*epsxy[6]*rdx01+0.05892556509887897*epsxy[5]*rdx01+0.03928371006591931*epsxy[4]*rdx01+0.10206207261596573*epsxy[3]*rdx01+0.06804138174397717*epsxy[2]*rdx01-0.06804138174397717*epsxy[1]*rdx01-0.11785113019775795*epsxy[0]*rdx01+0.05892556509887897*epsxx[6]*rdx00-0.06804138174397717*epsxx[3]*rdx00-0.06804138174397717*epsxx[2]*rdx00+0.07856742013183864*epsxx[0]*rdx00-0.06804138174397717*kSq[7]-0.07856742013183864*kSq[6]+0.07856742013183864*kSq[5]+0.07856742013183864*kSq[4]+0.09072184232530293*kSq[3]+0.09072184232530293*kSq[2]-0.09072184232530293*kSq[1]-0.10475656017578487*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[2], 0.03402069087198858*epsyy[3]*rdx11-0.03928371006591931*epsyy[0]*rdx11-0.03402069087198858*epsxy[7]*rdx01+0.03928371006591931*epsxy[4]*rdx01-0.10206207261596573*epsxy[3]*rdx01+0.11785113019775795*epsxy[0]*rdx01+0.03402069087198858*epsxx[3]*rdx00-0.03928371006591931*epsxx[0]*rdx00+0.022680460581325723*kSq[3]-0.026189140043946214*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[3], 0.05892556509887897*epsyy[5]*rdx11+0.06804138174397717*epsyy[3]*rdx11-0.06804138174397717*epsyy[1]*rdx11-0.07856742013183864*epsyy[0]*rdx11+0.03402069087198858*epsxy[7]*rdx01+0.05892556509887897*epsxy[6]*rdx01-0.03928371006591931*epsxy[4]*rdx01-0.06804138174397717*epsxy[2]*rdx01-0.03402069087198858*epsxx[3]*rdx00+0.03928371006591931*epsxx[0]*rdx00+0.03928371006591931*kSq[5]+0.04536092116265145*kSq[3]-0.04536092116265145*kSq[1]-0.052378280087892436*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[4], 0.019641855032959656*epsyy[0]*rdx11-0.019641855032959656*epsxy[4]*rdx01+0.03402069087198858*epsxy[1]*rdx01+0.03402069087198858*epsxx[2]*rdx00-0.03928371006591931*epsxx[0]*rdx00+0.022680460581325723*kSq[2]-0.026189140043946214*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[5], 0.03402069087198858*epsyy[1]*rdx11+0.03928371006591931*epsyy[0]*rdx11+0.019641855032959656*epsxy[4]*rdx01+0.03402069087198858*epsxy[2]*rdx01-0.03402069087198858*epsxy[1]*rdx01-0.05892556509887897*epsxy[0]*rdx01-0.03402069087198858*epsxx[2]*rdx00+0.03928371006591931*epsxx[0]*rdx00+0.03928371006591931*kSq[4]+0.04536092116265145*kSq[2]-0.04536092116265145*kSq[1]-0.052378280087892436*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[6], -(0.019641855032959656*epsyy[0]*rdx11)+0.019641855032959656*epsxy[4]*rdx01+0.05892556509887897*epsxy[0]*rdx01-0.019641855032959656*epsxx[0]*rdx00-0.013094570021973104*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[7], -(0.03402069087198858*epsyy[1]*rdx11)-0.03928371006591931*epsyy[0]*rdx11-0.019641855032959656*epsxy[4]*rdx01-0.03402069087198858*epsxy[2]*rdx01+0.019641855032959656*epsxx[0]*rdx00-0.022680460581325723*kSq[1]-0.026189140043946214*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[0], -(0.05892556509887897*epsyy[5]*rdx11)+0.06804138174397717*epsyy[3]*rdx11+0.06804138174397717*epsyy[1]*rdx11-0.07856742013183864*epsyy[0]*rdx11+0.03402069087198858*epsxy[7]*rdx01-0.05892556509887897*epsxy[6]*rdx01-0.03928371006591931*epsxy[4]*rdx01+0.06804138174397717*epsxy[2]*rdx01-0.03402069087198858*epsxx[3]*rdx00+0.03928371006591931*epsxx[0]*rdx00-0.03928371006591931*kSq[5]+0.04536092116265145*kSq[3]+0.04536092116265145*kSq[1]-0.052378280087892436*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[1], 0.03402069087198858*epsyy[3]*rdx11-0.03928371006591931*epsyy[0]*rdx11-0.03402069087198858*epsxy[7]*rdx01+0.03928371006591931*epsxy[4]*rdx01-0.10206207261596573*epsxy[3]*rdx01+0.11785113019775795*epsxy[0]*rdx01+0.03402069087198858*epsxx[3]*rdx00-0.03928371006591931*epsxx[0]*rdx00+0.022680460581325723*kSq[3]-0.026189140043946214*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[2], 0.05892556509887897*epsyy[5]*rdx11-0.06804138174397717*epsyy[3]*rdx11-0.06804138174397717*epsyy[1]*rdx11+0.07856742013183864*epsyy[0]*rdx11-0.03402069087198858*epsxy[7]*rdx01+0.05892556509887897*epsxy[6]*rdx01-0.05892556509887897*epsxy[5]*rdx01+0.03928371006591931*epsxy[4]*rdx01+0.10206207261596573*epsxy[3]*rdx01-0.06804138174397717*epsxy[2]*rdx01+0.06804138174397717*epsxy[1]*rdx01-0.11785113019775795*epsxy[0]*rdx01-0.05892556509887897*epsxx[6]*rdx00-0.06804138174397717*epsxx[3]*rdx00+0.06804138174397717*epsxx[2]*rdx00+0.07856742013183864*epsxx[0]*rdx00-0.06804138174397717*kSq[7]+0.07856742013183864*kSq[6]-0.07856742013183864*kSq[5]+0.07856742013183864*kSq[4]+0.09072184232530293*kSq[3]-0.09072184232530293*kSq[2]+0.09072184232530293*kSq[1]-0.10475656017578487*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[3], -(0.03402069087198858*epsyy[3]*rdx11)+0.03928371006591931*epsyy[0]*rdx11+0.03402069087198858*epsxy[7]*rdx01+0.05892556509887897*epsxy[5]*rdx01-0.03928371006591931*epsxy[4]*rdx01-0.06804138174397717*epsxy[1]*rdx01+0.05892556509887897*epsxx[6]*rdx00+0.06804138174397717*epsxx[3]*rdx00-0.06804138174397717*epsxx[2]*rdx00-0.07856742013183864*epsxx[0]*rdx00+0.03928371006591931*kSq[6]+0.04536092116265145*kSq[3]-0.04536092116265145*kSq[2]-0.052378280087892436*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[4], 0.03402069087198858*epsyy[1]*rdx11-0.03928371006591931*epsyy[0]*rdx11-0.019641855032959656*epsxy[4]*rdx01+0.03402069087198858*epsxy[2]*rdx01+0.019641855032959656*epsxx[0]*rdx00+0.022680460581325723*kSq[1]-0.026189140043946214*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[5], -(0.019641855032959656*epsyy[0]*rdx11)+0.019641855032959656*epsxy[4]*rdx01+0.05892556509887897*epsxy[0]*rdx01-0.019641855032959656*epsxx[0]*rdx00-0.013094570021973104*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[6], -(0.03402069087198858*epsyy[1]*rdx11)+0.03928371006591931*epsyy[0]*rdx11+0.019641855032959656*epsxy[4]*rdx01-0.03402069087198858*epsxy[2]*rdx01+0.03402069087198858*epsxy[1]*rdx01-0.05892556509887897*epsxy[0]*rdx01+0.03402069087198858*epsxx[2]*rdx00+0.03928371006591931*epsxx[0]*rdx00+0.03928371006591931*kSq[4]-0.04536092116265145*kSq[2]+0.04536092116265145*kSq[1]-0.052378280087892436*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[7], 0.019641855032959656*epsyy[0]*rdx11-0.019641855032959656*epsxy[4]*rdx01-0.03402069087198858*epsxy[1]*rdx01-0.03402069087198858*epsxx[2]*rdx00-0.03928371006591931*epsxx[0]*rdx00-0.022680460581325723*kSq[2]-0.026189140043946214*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[0], 0.03402069087198858*epsyy[3]*rdx11-0.03928371006591931*epsyy[0]*rdx11-0.03402069087198858*epsxy[7]*rdx01+0.03928371006591931*epsxy[4]*rdx01+0.10206207261596573*epsxy[3]*rdx01-0.11785113019775795*epsxy[0]*rdx01+0.03402069087198858*epsxx[3]*rdx00-0.03928371006591931*epsxx[0]*rdx00+0.022680460581325723*kSq[3]-0.026189140043946214*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[1], 0.05892556509887897*epsyy[5]*rdx11+0.06804138174397717*epsyy[3]*rdx11-0.06804138174397717*epsyy[1]*rdx11-0.07856742013183864*epsyy[0]*rdx11+0.03402069087198858*epsxy[7]*rdx01+0.05892556509887897*epsxy[6]*rdx01-0.03928371006591931*epsxy[4]*rdx01-0.06804138174397717*epsxy[2]*rdx01-0.03402069087198858*epsxx[3]*rdx00+0.03928371006591931*epsxx[0]*rdx00+0.03928371006591931*kSq[5]+0.04536092116265145*kSq[3]-0.04536092116265145*kSq[1]-0.052378280087892436*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[2], -(0.03402069087198858*epsyy[3]*rdx11)+0.03928371006591931*epsyy[0]*rdx11+0.03402069087198858*epsxy[7]*rdx01+0.05892556509887897*epsxy[5]*rdx01-0.03928371006591931*epsxy[4]*rdx01-0.06804138174397717*epsxy[1]*rdx01+0.05892556509887897*epsxx[6]*rdx00+0.06804138174397717*epsxx[3]*rdx00-0.06804138174397717*epsxx[2]*rdx00-0.07856742013183864*epsxx[0]*rdx00+0.03928371006591931*kSq[6]+0.04536092116265145*kSq[3]-0.04536092116265145*kSq[2]-0.052378280087892436*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[3], -(0.05892556509887897*epsyy[5]*rdx11)-0.06804138174397717*epsyy[3]*rdx11+0.06804138174397717*epsyy[1]*rdx11+0.07856742013183864*epsyy[0]*rdx11-0.03402069087198858*epsxy[7]*rdx01-0.05892556509887897*epsxy[6]*rdx01-0.05892556509887897*epsxy[5]*rdx01+0.03928371006591931*epsxy[4]*rdx01-0.10206207261596573*epsxy[3]*rdx01+0.06804138174397717*epsxy[2]*rdx01+0.06804138174397717*epsxy[1]*rdx01+0.11785113019775795*epsxy[0]*rdx01-0.05892556509887897*epsxx[6]*rdx00-0.06804138174397717*epsxx[3]*rdx00+0.06804138174397717*epsxx[2]*rdx00+0.07856742013183864*epsxx[0]*rdx00+0.06804138174397717*kSq[7]+0.07856742013183864*kSq[6]+0.07856742013183864*kSq[5]-0.07856742013183864*kSq[4]+0.09072184232530293*kSq[3]-0.09072184232530293*kSq[2]-0.09072184232530293*kSq[1]-0.10475656017578487*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[4], -(0.019641855032959656*epsyy[0]*rdx11)+0.019641855032959656*epsxy[4]*rdx01-0.05892556509887897*epsxy[0]*rdx01-0.019641855032959656*epsxx[0]*rdx00-0.013094570021973104*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[5], -(0.03402069087198858*epsyy[1]*rdx11)-0.03928371006591931*epsyy[0]*rdx11-0.019641855032959656*epsxy[4]*rdx01-0.03402069087198858*epsxy[2]*rdx01+0.019641855032959656*epsxx[0]*rdx00-0.022680460581325723*kSq[1]-0.026189140043946214*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[6], 0.019641855032959656*epsyy[0]*rdx11-0.019641855032959656*epsxy[4]*rdx01-0.03402069087198858*epsxy[1]*rdx01-0.03402069087198858*epsxx[2]*rdx00-0.03928371006591931*epsxx[0]*rdx00-0.022680460581325723*kSq[2]-0.026189140043946214*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[7], 0.03402069087198858*epsyy[1]*rdx11+0.03928371006591931*epsyy[0]*rdx11+0.019641855032959656*epsxy[4]*rdx01+0.03402069087198858*epsxy[2]*rdx01+0.03402069087198858*epsxy[1]*rdx01+0.05892556509887897*epsxy[0]*rdx01+0.03402069087198858*epsxx[2]*rdx00+0.03928371006591931*epsxx[0]*rdx00-0.03928371006591931*kSq[4]-0.04536092116265145*kSq[2]-0.04536092116265145*kSq[1]-0.052378280087892436*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[4], globalIdxs[0], -(0.03402069087198858*epsyy[1]*rdx11)+0.03928371006591931*epsyy[0]*rdx11+0.019641855032959656*epsxy[4]*rdx01-0.03402069087198858*epsxy[2]*rdx01-0.03402069087198858*epsxy[1]*rdx01+0.05892556509887897*epsxy[0]*rdx01-0.03402069087198858*epsxx[2]*rdx00+0.03928371006591931*epsxx[0]*rdx00-0.03928371006591931*kSq[4]+0.04536092116265145*kSq[2]+0.04536092116265145*kSq[1]-0.052378280087892436*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[4], globalIdxs[1], 0.019641855032959656*epsyy[0]*rdx11-0.019641855032959656*epsxy[4]*rdx01+0.03402069087198858*epsxy[1]*rdx01+0.03402069087198858*epsxx[2]*rdx00-0.03928371006591931*epsxx[0]*rdx00+0.022680460581325723*kSq[2]-0.026189140043946214*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[4], globalIdxs[2], 0.03402069087198858*epsyy[1]*rdx11-0.03928371006591931*epsyy[0]*rdx11-0.019641855032959656*epsxy[4]*rdx01+0.03402069087198858*epsxy[2]*rdx01+0.019641855032959656*epsxx[0]*rdx00+0.022680460581325723*kSq[1]-0.026189140043946214*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[4], globalIdxs[3], -(0.019641855032959656*epsyy[0]*rdx11)+0.019641855032959656*epsxy[4]*rdx01-0.05892556509887897*epsxy[0]*rdx01-0.019641855032959656*epsxx[0]*rdx00-0.013094570021973104*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[4], globalIdxs[4], -(0.05892556509887897*epsyy[5]*rdx11)+0.06804138174397717*epsyy[3]*rdx11-0.06804138174397717*epsyy[1]*rdx11+0.07856742013183864*epsyy[0]*rdx11+0.03402069087198858*epsxy[7]*rdx01-0.05892556509887897*epsxy[6]*rdx01-0.05892556509887897*epsxy[5]*rdx01+0.03928371006591931*epsxy[4]*rdx01+0.10206207261596573*epsxy[3]*rdx01-0.06804138174397717*epsxy[2]*rdx01-0.06804138174397717*epsxy[1]*rdx01+0.11785113019775795*epsxy[0]*rdx01-0.05892556509887897*epsxx[6]*rdx00+0.06804138174397717*epsxx[3]*rdx00-0.06804138174397717*epsxx[2]*rdx00+0.07856742013183864*epsxx[0]*rdx00-0.06804138174397717*kSq[7]+0.07856742013183864*kSq[6]+0.07856742013183864*kSq[5]-0.07856742013183864*kSq[4]-0.09072184232530293*kSq[3]+0.09072184232530293*kSq[2]+0.09072184232530293*kSq[1]-0.10475656017578487*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[4], globalIdxs[5], 0.03402069087198858*epsyy[3]*rdx11+0.03928371006591931*epsyy[0]*rdx11-0.03402069087198858*epsxy[7]*rdx01+0.05892556509887897*epsxy[5]*rdx01-0.03928371006591931*epsxy[4]*rdx01+0.06804138174397717*epsxy[1]*rdx01+0.05892556509887897*epsxx[6]*rdx00-0.06804138174397717*epsxx[3]*rdx00+0.06804138174397717*epsxx[2]*rdx00-0.07856742013183864*epsxx[0]*rdx00+0.03928371006591931*kSq[6]-0.04536092116265145*kSq[3]+0.04536092116265145*kSq[2]-0.052378280087892436*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[4], globalIdxs[6], 0.05892556509887897*epsyy[5]*rdx11-0.06804138174397717*epsyy[3]*rdx11+0.06804138174397717*epsyy[1]*rdx11-0.07856742013183864*epsyy[0]*rdx11-0.03402069087198858*epsxy[7]*rdx01+0.05892556509887897*epsxy[6]*rdx01-0.03928371006591931*epsxy[4]*rdx01+0.06804138174397717*epsxy[2]*rdx01+0.03402069087198858*epsxx[3]*rdx00+0.03928371006591931*epsxx[0]*rdx00+0.03928371006591931*kSq[5]-0.04536092116265145*kSq[3]+0.04536092116265145*kSq[1]-0.052378280087892436*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[4], globalIdxs[7], -(0.03402069087198858*epsyy[3]*rdx11)-0.03928371006591931*epsyy[0]*rdx11+0.03402069087198858*epsxy[7]*rdx01+0.03928371006591931*epsxy[4]*rdx01-0.10206207261596573*epsxy[3]*rdx01-0.11785113019775795*epsxy[0]*rdx01-0.03402069087198858*epsxx[3]*rdx00-0.03928371006591931*epsxx[0]*rdx00-0.022680460581325723*kSq[3]-0.026189140043946214*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[5], globalIdxs[0], 0.019641855032959656*epsyy[0]*rdx11-0.019641855032959656*epsxy[4]*rdx01+0.03402069087198858*epsxy[1]*rdx01+0.03402069087198858*epsxx[2]*rdx00-0.03928371006591931*epsxx[0]*rdx00+0.022680460581325723*kSq[2]-0.026189140043946214*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[5], globalIdxs[1], 0.03402069087198858*epsyy[1]*rdx11+0.03928371006591931*epsyy[0]*rdx11+0.019641855032959656*epsxy[4]*rdx01+0.03402069087198858*epsxy[2]*rdx01-0.03402069087198858*epsxy[1]*rdx01-0.05892556509887897*epsxy[0]*rdx01-0.03402069087198858*epsxx[2]*rdx00+0.03928371006591931*epsxx[0]*rdx00+0.03928371006591931*kSq[4]+0.04536092116265145*kSq[2]-0.04536092116265145*kSq[1]-0.052378280087892436*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[5], globalIdxs[2], -(0.019641855032959656*epsyy[0]*rdx11)+0.019641855032959656*epsxy[4]*rdx01+0.05892556509887897*epsxy[0]*rdx01-0.019641855032959656*epsxx[0]*rdx00-0.013094570021973104*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[5], globalIdxs[3], -(0.03402069087198858*epsyy[1]*rdx11)-0.03928371006591931*epsyy[0]*rdx11-0.019641855032959656*epsxy[4]*rdx01-0.03402069087198858*epsxy[2]*rdx01+0.019641855032959656*epsxx[0]*rdx00-0.022680460581325723*kSq[1]-0.026189140043946214*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[5], globalIdxs[4], 0.03402069087198858*epsyy[3]*rdx11+0.03928371006591931*epsyy[0]*rdx11-0.03402069087198858*epsxy[7]*rdx01+0.05892556509887897*epsxy[5]*rdx01-0.03928371006591931*epsxy[4]*rdx01+0.06804138174397717*epsxy[1]*rdx01+0.05892556509887897*epsxx[6]*rdx00-0.06804138174397717*epsxx[3]*rdx00+0.06804138174397717*epsxx[2]*rdx00-0.07856742013183864*epsxx[0]*rdx00+0.03928371006591931*kSq[6]-0.04536092116265145*kSq[3]+0.04536092116265145*kSq[2]-0.052378280087892436*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[5], globalIdxs[5], 0.05892556509887897*epsyy[5]*rdx11+0.06804138174397717*epsyy[3]*rdx11+0.06804138174397717*epsyy[1]*rdx11+0.07856742013183864*epsyy[0]*rdx11+0.03402069087198858*epsxy[7]*rdx01+0.05892556509887897*epsxy[6]*rdx01-0.05892556509887897*epsxy[5]*rdx01+0.03928371006591931*epsxy[4]*rdx01-0.10206207261596573*epsxy[3]*rdx01+0.06804138174397717*epsxy[2]*rdx01-0.06804138174397717*epsxy[1]*rdx01-0.11785113019775795*epsxy[0]*rdx01-0.05892556509887897*epsxx[6]*rdx00+0.06804138174397717*epsxx[3]*rdx00-0.06804138174397717*epsxx[2]*rdx00+0.07856742013183864*epsxx[0]*rdx00+0.06804138174397717*kSq[7]+0.07856742013183864*kSq[6]-0.07856742013183864*kSq[5]+0.07856742013183864*kSq[4]-0.09072184232530293*kSq[3]+0.09072184232530293*kSq[2]-0.09072184232530293*kSq[1]-0.10475656017578487*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[5], globalIdxs[6], -(0.03402069087198858*epsyy[3]*rdx11)-0.03928371006591931*epsyy[0]*rdx11+0.03402069087198858*epsxy[7]*rdx01+0.03928371006591931*epsxy[4]*rdx01+0.10206207261596573*epsxy[3]*rdx01+0.11785113019775795*epsxy[0]*rdx01-0.03402069087198858*epsxx[3]*rdx00-0.03928371006591931*epsxx[0]*rdx00-0.022680460581325723*kSq[3]-0.026189140043946214*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[5], globalIdxs[7], -(0.05892556509887897*epsyy[5]*rdx11)-0.06804138174397717*epsyy[3]*rdx11-0.06804138174397717*epsyy[1]*rdx11-0.07856742013183864*epsyy[0]*rdx11-0.03402069087198858*epsxy[7]*rdx01-0.05892556509887897*epsxy[6]*rdx01-0.03928371006591931*epsxy[4]*rdx01-0.06804138174397717*epsxy[2]*rdx01+0.03402069087198858*epsxx[3]*rdx00+0.03928371006591931*epsxx[0]*rdx00-0.03928371006591931*kSq[5]-0.04536092116265145*kSq[3]-0.04536092116265145*kSq[1]-0.052378280087892436*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[6], globalIdxs[0], 0.03402069087198858*epsyy[1]*rdx11-0.03928371006591931*epsyy[0]*rdx11-0.019641855032959656*epsxy[4]*rdx01+0.03402069087198858*epsxy[2]*rdx01+0.019641855032959656*epsxx[0]*rdx00+0.022680460581325723*kSq[1]-0.026189140043946214*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[6], globalIdxs[1], -(0.019641855032959656*epsyy[0]*rdx11)+0.019641855032959656*epsxy[4]*rdx01+0.05892556509887897*epsxy[0]*rdx01-0.019641855032959656*epsxx[0]*rdx00-0.013094570021973104*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[6], globalIdxs[2], -(0.03402069087198858*epsyy[1]*rdx11)+0.03928371006591931*epsyy[0]*rdx11+0.019641855032959656*epsxy[4]*rdx01-0.03402069087198858*epsxy[2]*rdx01+0.03402069087198858*epsxy[1]*rdx01-0.05892556509887897*epsxy[0]*rdx01+0.03402069087198858*epsxx[2]*rdx00+0.03928371006591931*epsxx[0]*rdx00+0.03928371006591931*kSq[4]-0.04536092116265145*kSq[2]+0.04536092116265145*kSq[1]-0.052378280087892436*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[6], globalIdxs[3], 0.019641855032959656*epsyy[0]*rdx11-0.019641855032959656*epsxy[4]*rdx01-0.03402069087198858*epsxy[1]*rdx01-0.03402069087198858*epsxx[2]*rdx00-0.03928371006591931*epsxx[0]*rdx00-0.022680460581325723*kSq[2]-0.026189140043946214*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[6], globalIdxs[4], 0.05892556509887897*epsyy[5]*rdx11-0.06804138174397717*epsyy[3]*rdx11+0.06804138174397717*epsyy[1]*rdx11-0.07856742013183864*epsyy[0]*rdx11-0.03402069087198858*epsxy[7]*rdx01+0.05892556509887897*epsxy[6]*rdx01-0.03928371006591931*epsxy[4]*rdx01+0.06804138174397717*epsxy[2]*rdx01+0.03402069087198858*epsxx[3]*rdx00+0.03928371006591931*epsxx[0]*rdx00+0.03928371006591931*kSq[5]-0.04536092116265145*kSq[3]+0.04536092116265145*kSq[1]-0.052378280087892436*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[6], globalIdxs[5], -(0.03402069087198858*epsyy[3]*rdx11)-0.03928371006591931*epsyy[0]*rdx11+0.03402069087198858*epsxy[7]*rdx01+0.03928371006591931*epsxy[4]*rdx01+0.10206207261596573*epsxy[3]*rdx01+0.11785113019775795*epsxy[0]*rdx01-0.03402069087198858*epsxx[3]*rdx00-0.03928371006591931*epsxx[0]*rdx00-0.022680460581325723*kSq[3]-0.026189140043946214*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[6], globalIdxs[6], -(0.05892556509887897*epsyy[5]*rdx11)+0.06804138174397717*epsyy[3]*rdx11-0.06804138174397717*epsyy[1]*rdx11+0.07856742013183864*epsyy[0]*rdx11+0.03402069087198858*epsxy[7]*rdx01-0.05892556509887897*epsxy[6]*rdx01+0.05892556509887897*epsxy[5]*rdx01+0.03928371006591931*epsxy[4]*rdx01-0.10206207261596573*epsxy[3]*rdx01-0.06804138174397717*epsxy[2]*rdx01+0.06804138174397717*epsxy[1]*rdx01-0.11785113019775795*epsxy[0]*rdx01+0.05892556509887897*epsxx[6]*rdx00+0.06804138174397717*epsxx[3]*rdx00+0.06804138174397717*epsxx[2]*rdx00+0.07856742013183864*epsxx[0]*rdx00+0.06804138174397717*kSq[7]-0.07856742013183864*kSq[6]+0.07856742013183864*kSq[5]+0.07856742013183864*kSq[4]-0.09072184232530293*kSq[3]-0.09072184232530293*kSq[2]+0.09072184232530293*kSq[1]-0.10475656017578487*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[6], globalIdxs[7], 0.03402069087198858*epsyy[3]*rdx11+0.03928371006591931*epsyy[0]*rdx11-0.03402069087198858*epsxy[7]*rdx01-0.05892556509887897*epsxy[5]*rdx01-0.03928371006591931*epsxy[4]*rdx01-0.06804138174397717*epsxy[1]*rdx01-0.05892556509887897*epsxx[6]*rdx00-0.06804138174397717*epsxx[3]*rdx00-0.06804138174397717*epsxx[2]*rdx00-0.07856742013183864*epsxx[0]*rdx00-0.03928371006591931*kSq[6]-0.04536092116265145*kSq[3]-0.04536092116265145*kSq[2]-0.052378280087892436*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[7], globalIdxs[0], -(0.019641855032959656*epsyy[0]*rdx11)+0.019641855032959656*epsxy[4]*rdx01-0.05892556509887897*epsxy[0]*rdx01-0.019641855032959656*epsxx[0]*rdx00-0.013094570021973104*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[7], globalIdxs[1], -(0.03402069087198858*epsyy[1]*rdx11)-0.03928371006591931*epsyy[0]*rdx11-0.019641855032959656*epsxy[4]*rdx01-0.03402069087198858*epsxy[2]*rdx01+0.019641855032959656*epsxx[0]*rdx00-0.022680460581325723*kSq[1]-0.026189140043946214*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[7], globalIdxs[2], 0.019641855032959656*epsyy[0]*rdx11-0.019641855032959656*epsxy[4]*rdx01-0.03402069087198858*epsxy[1]*rdx01-0.03402069087198858*epsxx[2]*rdx00-0.03928371006591931*epsxx[0]*rdx00-0.022680460581325723*kSq[2]-0.026189140043946214*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[7], globalIdxs[3], 0.03402069087198858*epsyy[1]*rdx11+0.03928371006591931*epsyy[0]*rdx11+0.019641855032959656*epsxy[4]*rdx01+0.03402069087198858*epsxy[2]*rdx01+0.03402069087198858*epsxy[1]*rdx01+0.05892556509887897*epsxy[0]*rdx01+0.03402069087198858*epsxx[2]*rdx00+0.03928371006591931*epsxx[0]*rdx00-0.03928371006591931*kSq[4]-0.04536092116265145*kSq[2]-0.04536092116265145*kSq[1]-0.052378280087892436*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[7], globalIdxs[4], -(0.03402069087198858*epsyy[3]*rdx11)-0.03928371006591931*epsyy[0]*rdx11+0.03402069087198858*epsxy[7]*rdx01+0.03928371006591931*epsxy[4]*rdx01-0.10206207261596573*epsxy[3]*rdx01-0.11785113019775795*epsxy[0]*rdx01-0.03402069087198858*epsxx[3]*rdx00-0.03928371006591931*epsxx[0]*rdx00-0.022680460581325723*kSq[3]-0.026189140043946214*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[7], globalIdxs[5], -(0.05892556509887897*epsyy[5]*rdx11)-0.06804138174397717*epsyy[3]*rdx11-0.06804138174397717*epsyy[1]*rdx11-0.07856742013183864*epsyy[0]*rdx11-0.03402069087198858*epsxy[7]*rdx01-0.05892556509887897*epsxy[6]*rdx01-0.03928371006591931*epsxy[4]*rdx01-0.06804138174397717*epsxy[2]*rdx01+0.03402069087198858*epsxx[3]*rdx00+0.03928371006591931*epsxx[0]*rdx00-0.03928371006591931*kSq[5]-0.04536092116265145*kSq[3]-0.04536092116265145*kSq[1]-0.052378280087892436*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[7], globalIdxs[6], 0.03402069087198858*epsyy[3]*rdx11+0.03928371006591931*epsyy[0]*rdx11-0.03402069087198858*epsxy[7]*rdx01-0.05892556509887897*epsxy[5]*rdx01-0.03928371006591931*epsxy[4]*rdx01-0.06804138174397717*epsxy[1]*rdx01-0.05892556509887897*epsxx[6]*rdx00-0.06804138174397717*epsxx[3]*rdx00-0.06804138174397717*epsxx[2]*rdx00-0.07856742013183864*epsxx[0]*rdx00-0.03928371006591931*kSq[6]-0.04536092116265145*kSq[3]-0.04536092116265145*kSq[2]-0.052378280087892436*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[7], globalIdxs[7], 0.05892556509887897*epsyy[5]*rdx11+0.06804138174397717*epsyy[3]*rdx11+0.06804138174397717*epsyy[1]*rdx11+0.07856742013183864*epsyy[0]*rdx11+0.03402069087198858*epsxy[7]*rdx01+0.05892556509887897*epsxy[6]*rdx01+0.05892556509887897*epsxy[5]*rdx01+0.03928371006591931*epsxy[4]*rdx01+0.10206207261596573*epsxy[3]*rdx01+0.06804138174397717*epsxy[2]*rdx01+0.06804138174397717*epsxy[1]*rdx01+0.11785113019775795*epsxy[0]*rdx01+0.05892556509887897*epsxx[6]*rdx00+0.06804138174397717*epsxx[3]*rdx00+0.06804138174397717*epsxx[2]*rdx00+0.07856742013183864*epsxx[0]*rdx00-0.06804138174397717*kSq[7]-0.07856742013183864*kSq[6]-0.07856742013183864*kSq[5]-0.07856742013183864*kSq[4]-0.09072184232530293*kSq[3]-0.09072184232530293*kSq[2]-0.09072184232530293*kSq[1]-0.10475656017578487*kSq[0]);

}

void fem_poisson_perp_lhs_stencil_3x_ser_p1_lox_neumannx_upy_dirichlety(const double *epsilon, const double *kSq, const double *dx, const double *bcVals, const long *globalIdxs, gkyl_mat_triples *tri) 
{ 
  // epsilon: permittivity tensor.
  // kSq: wave number squared (factor multiplying phi).
  // dx: cell length in each direction.
  // bcVals: values to impose as BCs, i.e. bcVals[off+0]*phi+bcVals[off+1]*epsilon^{ij}*d(phi)/dx_j=bcVals[off+2].
  // globalIdxs: global linear index of each basis function/node in current cell.
  // tri: triples object (i,j,val), i.e. contribute val to i,j element of the global matrix.

  const double *epsxx = &epsilon[0];
  const double *epsxy = &epsilon[8];
  const double *epsyy = &epsilon[16];

  double rdx00 = 4.0/(dx[0]*dx[0]);
  double rdx01 = 4.0/(dx[0]*dx[1]);
  double rdx11 = 4.0/(dx[1]*dx[1]);

  double rdx2[2]; 
  rdx2[0] = 2.0/dx[0]; 
  rdx2[1] = 2.0/dx[1]; 

  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[0], 0.05892556509887897*epsyy[5]*rdx11-0.06804138174397717*epsyy[3]*rdx11-0.06804138174397717*epsyy[1]*rdx11+0.07856742013183864*epsyy[0]*rdx11-0.03402069087198858*epsxy[7]*rdx01+0.05892556509887897*epsxy[6]*rdx01+0.05892556509887897*epsxy[5]*rdx01+0.03928371006591931*epsxy[4]*rdx01-0.10206207261596573*epsxy[3]*rdx01-0.06804138174397717*epsxy[2]*rdx01-0.06804138174397717*epsxy[1]*rdx01+0.11785113019775795*epsxy[0]*rdx01+0.05892556509887897*epsxx[6]*rdx00-0.06804138174397717*epsxx[3]*rdx00-0.06804138174397717*epsxx[2]*rdx00+0.07856742013183864*epsxx[0]*rdx00+0.06804138174397717*kSq[7]-0.07856742013183864*kSq[6]-0.07856742013183864*kSq[5]-0.07856742013183864*kSq[4]+0.09072184232530293*kSq[3]+0.09072184232530293*kSq[2]+0.09072184232530293*kSq[1]-0.10475656017578487*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[1], -(0.03402069087198858*epsyy[3]*rdx11)+0.03928371006591931*epsyy[0]*rdx11+0.03402069087198858*epsxy[7]*rdx01-0.05892556509887897*epsxy[5]*rdx01-0.03928371006591931*epsxy[4]*rdx01+0.06804138174397717*epsxy[1]*rdx01-0.05892556509887897*epsxx[6]*rdx00+0.06804138174397717*epsxx[3]*rdx00+0.06804138174397717*epsxx[2]*rdx00-0.07856742013183864*epsxx[0]*rdx00-0.03928371006591931*kSq[6]+0.04536092116265145*kSq[3]+0.04536092116265145*kSq[2]-0.052378280087892436*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[2], -(0.05892556509887897*epsyy[5]*rdx11)+0.06804138174397717*epsyy[3]*rdx11+0.06804138174397717*epsyy[1]*rdx11-0.07856742013183864*epsyy[0]*rdx11+0.03402069087198858*epsxy[7]*rdx01-0.05892556509887897*epsxy[6]*rdx01-0.03928371006591931*epsxy[4]*rdx01+0.06804138174397717*epsxy[2]*rdx01-0.03402069087198858*epsxx[3]*rdx00+0.03928371006591931*epsxx[0]*rdx00-0.03928371006591931*kSq[5]+0.04536092116265145*kSq[3]+0.04536092116265145*kSq[1]-0.052378280087892436*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[3], 0.03402069087198858*epsyy[3]*rdx11-0.03928371006591931*epsyy[0]*rdx11-0.03402069087198858*epsxy[7]*rdx01+0.03928371006591931*epsxy[4]*rdx01+0.10206207261596573*epsxy[3]*rdx01-0.11785113019775795*epsxy[0]*rdx01+0.03402069087198858*epsxx[3]*rdx00-0.03928371006591931*epsxx[0]*rdx00+0.022680460581325723*kSq[3]-0.026189140043946214*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[4], -(0.03402069087198858*epsyy[1]*rdx11)+0.03928371006591931*epsyy[0]*rdx11+0.019641855032959656*epsxy[4]*rdx01-0.03402069087198858*epsxy[2]*rdx01-0.03402069087198858*epsxy[1]*rdx01+0.05892556509887897*epsxy[0]*rdx01-0.03402069087198858*epsxx[2]*rdx00+0.03928371006591931*epsxx[0]*rdx00-0.03928371006591931*kSq[4]+0.04536092116265145*kSq[2]+0.04536092116265145*kSq[1]-0.052378280087892436*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[5], 0.019641855032959656*epsyy[0]*rdx11-0.019641855032959656*epsxy[4]*rdx01+0.03402069087198858*epsxy[1]*rdx01+0.03402069087198858*epsxx[2]*rdx00-0.03928371006591931*epsxx[0]*rdx00+0.022680460581325723*kSq[2]-0.026189140043946214*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[6], 0.03402069087198858*epsyy[1]*rdx11-0.03928371006591931*epsyy[0]*rdx11-0.019641855032959656*epsxy[4]*rdx01+0.03402069087198858*epsxy[2]*rdx01+0.019641855032959656*epsxx[0]*rdx00+0.022680460581325723*kSq[1]-0.026189140043946214*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[7], -(0.019641855032959656*epsyy[0]*rdx11)+0.019641855032959656*epsxy[4]*rdx01-0.05892556509887897*epsxy[0]*rdx01-0.019641855032959656*epsxx[0]*rdx00-0.013094570021973104*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[0], -(0.03402069087198858*epsyy[3]*rdx11)+0.03928371006591931*epsyy[0]*rdx11+0.03402069087198858*epsxy[7]*rdx01-0.05892556509887897*epsxy[5]*rdx01-0.03928371006591931*epsxy[4]*rdx01+0.06804138174397717*epsxy[1]*rdx01-0.05892556509887897*epsxx[6]*rdx00+0.06804138174397717*epsxx[3]*rdx00+0.06804138174397717*epsxx[2]*rdx00-0.07856742013183864*epsxx[0]*rdx00-0.03928371006591931*kSq[6]+0.04536092116265145*kSq[3]+0.04536092116265145*kSq[2]-0.052378280087892436*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[1], -(0.05892556509887897*epsyy[5]*rdx11)-0.06804138174397717*epsyy[3]*rdx11+0.06804138174397717*epsyy[1]*rdx11+0.07856742013183864*epsyy[0]*rdx11-0.03402069087198858*epsxy[7]*rdx01-0.05892556509887897*epsxy[6]*rdx01+0.05892556509887897*epsxy[5]*rdx01+0.03928371006591931*epsxy[4]*rdx01+0.10206207261596573*epsxy[3]*rdx01+0.06804138174397717*epsxy[2]*rdx01-0.06804138174397717*epsxy[1]*rdx01-0.11785113019775795*epsxy[0]*rdx01+0.05892556509887897*epsxx[6]*rdx00-0.06804138174397717*epsxx[3]*rdx00-0.06804138174397717*epsxx[2]*rdx00+0.07856742013183864*epsxx[0]*rdx00-0.06804138174397717*kSq[7]-0.07856742013183864*kSq[6]+0.07856742013183864*kSq[5]+0.07856742013183864*kSq[4]+0.09072184232530293*kSq[3]+0.09072184232530293*kSq[2]-0.09072184232530293*kSq[1]-0.10475656017578487*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[2], 0.03402069087198858*epsyy[3]*rdx11-0.03928371006591931*epsyy[0]*rdx11-0.03402069087198858*epsxy[7]*rdx01+0.03928371006591931*epsxy[4]*rdx01-0.10206207261596573*epsxy[3]*rdx01+0.11785113019775795*epsxy[0]*rdx01+0.03402069087198858*epsxx[3]*rdx00-0.03928371006591931*epsxx[0]*rdx00+0.022680460581325723*kSq[3]-0.026189140043946214*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[3], 0.05892556509887897*epsyy[5]*rdx11+0.06804138174397717*epsyy[3]*rdx11-0.06804138174397717*epsyy[1]*rdx11-0.07856742013183864*epsyy[0]*rdx11+0.03402069087198858*epsxy[7]*rdx01+0.05892556509887897*epsxy[6]*rdx01-0.03928371006591931*epsxy[4]*rdx01-0.06804138174397717*epsxy[2]*rdx01-0.03402069087198858*epsxx[3]*rdx00+0.03928371006591931*epsxx[0]*rdx00+0.03928371006591931*kSq[5]+0.04536092116265145*kSq[3]-0.04536092116265145*kSq[1]-0.052378280087892436*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[4], 0.019641855032959656*epsyy[0]*rdx11-0.019641855032959656*epsxy[4]*rdx01+0.03402069087198858*epsxy[1]*rdx01+0.03402069087198858*epsxx[2]*rdx00-0.03928371006591931*epsxx[0]*rdx00+0.022680460581325723*kSq[2]-0.026189140043946214*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[5], 0.03402069087198858*epsyy[1]*rdx11+0.03928371006591931*epsyy[0]*rdx11+0.019641855032959656*epsxy[4]*rdx01+0.03402069087198858*epsxy[2]*rdx01-0.03402069087198858*epsxy[1]*rdx01-0.05892556509887897*epsxy[0]*rdx01-0.03402069087198858*epsxx[2]*rdx00+0.03928371006591931*epsxx[0]*rdx00+0.03928371006591931*kSq[4]+0.04536092116265145*kSq[2]-0.04536092116265145*kSq[1]-0.052378280087892436*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[6], -(0.019641855032959656*epsyy[0]*rdx11)+0.019641855032959656*epsxy[4]*rdx01+0.05892556509887897*epsxy[0]*rdx01-0.019641855032959656*epsxx[0]*rdx00-0.013094570021973104*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[7], -(0.03402069087198858*epsyy[1]*rdx11)-0.03928371006591931*epsyy[0]*rdx11-0.019641855032959656*epsxy[4]*rdx01-0.03402069087198858*epsxy[2]*rdx01+0.019641855032959656*epsxx[0]*rdx00-0.022680460581325723*kSq[1]-0.026189140043946214*kSq[0]);
  gkyl_mat_triples_insert(tri, globalIdxs[2], globalIdxs[0], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[2], globalIdxs[1], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[2], globalIdxs[2], 1.0);
  gkyl_mat_triples_insert(tri, globalIdxs[2], globalIdxs[3], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[2], globalIdxs[4], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[2], globalIdxs[5], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[2], globalIdxs[6], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[2], globalIdxs[7], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[3], globalIdxs[0], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[3], globalIdxs[1], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[3], globalIdxs[2], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[3], globalIdxs[3], 1.0);
  gkyl_mat_triples_insert(tri, globalIdxs[3], globalIdxs[4], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[3], globalIdxs[5], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[3], globalIdxs[6], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[3], globalIdxs[7], 0.0);
  gkyl_mat_triples_accum(tri, globalIdxs[4], globalIdxs[0], -(0.03402069087198858*epsyy[1]*rdx11)+0.03928371006591931*epsyy[0]*rdx11+0.019641855032959656*epsxy[4]*rdx01-0.03402069087198858*epsxy[2]*rdx01-0.03402069087198858*epsxy[1]*rdx01+0.05892556509887897*epsxy[0]*rdx01-0.03402069087198858*epsxx[2]*rdx00+0.03928371006591931*epsxx[0]*rdx00-0.03928371006591931*kSq[4]+0.04536092116265145*kSq[2]+0.04536092116265145*kSq[1]-0.052378280087892436*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[4], globalIdxs[1], 0.019641855032959656*epsyy[0]*rdx11-0.019641855032959656*epsxy[4]*rdx01+0.03402069087198858*epsxy[1]*rdx01+0.03402069087198858*epsxx[2]*rdx00-0.03928371006591931*epsxx[0]*rdx00+0.022680460581325723*kSq[2]-0.026189140043946214*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[4], globalIdxs[2], 0.03402069087198858*epsyy[1]*rdx11-0.03928371006591931*epsyy[0]*rdx11-0.019641855032959656*epsxy[4]*rdx01+0.03402069087198858*epsxy[2]*rdx01+0.019641855032959656*epsxx[0]*rdx00+0.022680460581325723*kSq[1]-0.026189140043946214*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[4], globalIdxs[3], -(0.019641855032959656*epsyy[0]*rdx11)+0.019641855032959656*epsxy[4]*rdx01-0.05892556509887897*epsxy[0]*rdx01-0.019641855032959656*epsxx[0]*rdx00-0.013094570021973104*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[4], globalIdxs[4], -(0.05892556509887897*epsyy[5]*rdx11)+0.06804138174397717*epsyy[3]*rdx11-0.06804138174397717*epsyy[1]*rdx11+0.07856742013183864*epsyy[0]*rdx11+0.03402069087198858*epsxy[7]*rdx01-0.05892556509887897*epsxy[6]*rdx01-0.05892556509887897*epsxy[5]*rdx01+0.03928371006591931*epsxy[4]*rdx01+0.10206207261596573*epsxy[3]*rdx01-0.06804138174397717*epsxy[2]*rdx01-0.06804138174397717*epsxy[1]*rdx01+0.11785113019775795*epsxy[0]*rdx01-0.05892556509887897*epsxx[6]*rdx00+0.06804138174397717*epsxx[3]*rdx00-0.06804138174397717*epsxx[2]*rdx00+0.07856742013183864*epsxx[0]*rdx00-0.06804138174397717*kSq[7]+0.07856742013183864*kSq[6]+0.07856742013183864*kSq[5]-0.07856742013183864*kSq[4]-0.09072184232530293*kSq[3]+0.09072184232530293*kSq[2]+0.09072184232530293*kSq[1]-0.10475656017578487*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[4], globalIdxs[5], 0.03402069087198858*epsyy[3]*rdx11+0.03928371006591931*epsyy[0]*rdx11-0.03402069087198858*epsxy[7]*rdx01+0.05892556509887897*epsxy[5]*rdx01-0.03928371006591931*epsxy[4]*rdx01+0.06804138174397717*epsxy[1]*rdx01+0.05892556509887897*epsxx[6]*rdx00-0.06804138174397717*epsxx[3]*rdx00+0.06804138174397717*epsxx[2]*rdx00-0.07856742013183864*epsxx[0]*rdx00+0.03928371006591931*kSq[6]-0.04536092116265145*kSq[3]+0.04536092116265145*kSq[2]-0.052378280087892436*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[4], globalIdxs[6], 0.05892556509887897*epsyy[5]*rdx11-0.06804138174397717*epsyy[3]*rdx11+0.06804138174397717*epsyy[1]*rdx11-0.07856742013183864*epsyy[0]*rdx11-0.03402069087198858*epsxy[7]*rdx01+0.05892556509887897*epsxy[6]*rdx01-0.03928371006591931*epsxy[4]*rdx01+0.06804138174397717*epsxy[2]*rdx01+0.03402069087198858*epsxx[3]*rdx00+0.03928371006591931*epsxx[0]*rdx00+0.03928371006591931*kSq[5]-0.04536092116265145*kSq[3]+0.04536092116265145*kSq[1]-0.052378280087892436*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[4], globalIdxs[7], -(0.03402069087198858*epsyy[3]*rdx11)-0.03928371006591931*epsyy[0]*rdx11+0.03402069087198858*epsxy[7]*rdx01+0.03928371006591931*epsxy[4]*rdx01-0.10206207261596573*epsxy[3]*rdx01-0.11785113019775795*epsxy[0]*rdx01-0.03402069087198858*epsxx[3]*rdx00-0.03928371006591931*epsxx[0]*rdx00-0.022680460581325723*kSq[3]-0.026189140043946214*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[5], globalIdxs[0], 0.019641855032959656*epsyy[0]*rdx11-0.019641855032959656*epsxy[4]*rdx01+0.03402069087198858*epsxy[1]*rdx01+0.03402069087198858*epsxx[2]*rdx00-0.03928371006591931*epsxx[0]*rdx00+0.022680460581325723*kSq[2]-0.026189140043946214*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[5], globalIdxs[1], 0.03402069087198858*epsyy[1]*rdx11+0.03928371006591931*epsyy[0]*rdx11+0.019641855032959656*epsxy[4]*rdx01+0.03402069087198858*epsxy[2]*rdx01-0.03402069087198858*epsxy[1]*rdx01-0.05892556509887897*epsxy[0]*rdx01-0.03402069087198858*epsxx[2]*rdx00+0.03928371006591931*epsxx[0]*rdx00+0.03928371006591931*kSq[4]+0.04536092116265145*kSq[2]-0.04536092116265145*kSq[1]-0.052378280087892436*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[5], globalIdxs[2], -(0.019641855032959656*epsyy[0]*rdx11)+0.019641855032959656*epsxy[4]*rdx01+0.05892556509887897*epsxy[0]*rdx01-0.019641855032959656*epsxx[0]*rdx00-0.013094570021973104*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[5], globalIdxs[3], -(0.03402069087198858*epsyy[1]*rdx11)-0.03928371006591931*epsyy[0]*rdx11-0.019641855032959656*epsxy[4]*rdx01-0.03402069087198858*epsxy[2]*rdx01+0.019641855032959656*epsxx[0]*rdx00-0.022680460581325723*kSq[1]-0.026189140043946214*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[5], globalIdxs[4], 0.03402069087198858*epsyy[3]*rdx11+0.03928371006591931*epsyy[0]*rdx11-0.03402069087198858*epsxy[7]*rdx01+0.05892556509887897*epsxy[5]*rdx01-0.03928371006591931*epsxy[4]*rdx01+0.06804138174397717*epsxy[1]*rdx01+0.05892556509887897*epsxx[6]*rdx00-0.06804138174397717*epsxx[3]*rdx00+0.06804138174397717*epsxx[2]*rdx00-0.07856742013183864*epsxx[0]*rdx00+0.03928371006591931*kSq[6]-0.04536092116265145*kSq[3]+0.04536092116265145*kSq[2]-0.052378280087892436*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[5], globalIdxs[5], 0.05892556509887897*epsyy[5]*rdx11+0.06804138174397717*epsyy[3]*rdx11+0.06804138174397717*epsyy[1]*rdx11+0.07856742013183864*epsyy[0]*rdx11+0.03402069087198858*epsxy[7]*rdx01+0.05892556509887897*epsxy[6]*rdx01-0.05892556509887897*epsxy[5]*rdx01+0.03928371006591931*epsxy[4]*rdx01-0.10206207261596573*epsxy[3]*rdx01+0.06804138174397717*epsxy[2]*rdx01-0.06804138174397717*epsxy[1]*rdx01-0.11785113019775795*epsxy[0]*rdx01-0.05892556509887897*epsxx[6]*rdx00+0.06804138174397717*epsxx[3]*rdx00-0.06804138174397717*epsxx[2]*rdx00+0.07856742013183864*epsxx[0]*rdx00+0.06804138174397717*kSq[7]+0.07856742013183864*kSq[6]-0.07856742013183864*kSq[5]+0.07856742013183864*kSq[4]-0.09072184232530293*kSq[3]+0.09072184232530293*kSq[2]-0.09072184232530293*kSq[1]-0.10475656017578487*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[5], globalIdxs[6], -(0.03402069087198858*epsyy[3]*rdx11)-0.03928371006591931*epsyy[0]*rdx11+0.03402069087198858*epsxy[7]*rdx01+0.03928371006591931*epsxy[4]*rdx01+0.10206207261596573*epsxy[3]*rdx01+0.11785113019775795*epsxy[0]*rdx01-0.03402069087198858*epsxx[3]*rdx00-0.03928371006591931*epsxx[0]*rdx00-0.022680460581325723*kSq[3]-0.026189140043946214*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[5], globalIdxs[7], -(0.05892556509887897*epsyy[5]*rdx11)-0.06804138174397717*epsyy[3]*rdx11-0.06804138174397717*epsyy[1]*rdx11-0.07856742013183864*epsyy[0]*rdx11-0.03402069087198858*epsxy[7]*rdx01-0.05892556509887897*epsxy[6]*rdx01-0.03928371006591931*epsxy[4]*rdx01-0.06804138174397717*epsxy[2]*rdx01+0.03402069087198858*epsxx[3]*rdx00+0.03928371006591931*epsxx[0]*rdx00-0.03928371006591931*kSq[5]-0.04536092116265145*kSq[3]-0.04536092116265145*kSq[1]-0.052378280087892436*kSq[0]);
  gkyl_mat_triples_insert(tri, globalIdxs[6], globalIdxs[0], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[6], globalIdxs[1], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[6], globalIdxs[2], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[6], globalIdxs[3], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[6], globalIdxs[4], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[6], globalIdxs[5], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[6], globalIdxs[6], 1.0);
  gkyl_mat_triples_insert(tri, globalIdxs[6], globalIdxs[7], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[7], globalIdxs[0], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[7], globalIdxs[1], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[7], globalIdxs[2], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[7], globalIdxs[3], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[7], globalIdxs[4], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[7], globalIdxs[5], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[7], globalIdxs[6], 0.0);
  gkyl_mat_triples_insert(tri, globalIdxs[7], globalIdxs[7], 1.0);

}

void fem_poisson_perp_lhs_stencil_3x_ser_p1_lox_neumannx_upy_neumanny(const double *epsilon, const double *kSq, const double *dx, const double *bcVals, const long *globalIdxs, gkyl_mat_triples *tri) 
{ 
  // epsilon: permittivity tensor.
  // kSq: wave number squared (factor multiplying phi).
  // dx: cell length in each direction.
  // bcVals: values to impose as BCs, i.e. bcVals[off+0]*phi+bcVals[off+1]*epsilon^{ij}*d(phi)/dx_j=bcVals[off+2].
  // globalIdxs: global linear index of each basis function/node in current cell.
  // tri: triples object (i,j,val), i.e. contribute val to i,j element of the global matrix.

  const double *epsxx = &epsilon[0];
  const double *epsxy = &epsilon[8];
  const double *epsyy = &epsilon[16];

  double rdx00 = 4.0/(dx[0]*dx[0]);
  double rdx01 = 4.0/(dx[0]*dx[1]);
  double rdx11 = 4.0/(dx[1]*dx[1]);

  double rdx2[2]; 
  rdx2[0] = 2.0/dx[0]; 
  rdx2[1] = 2.0/dx[1]; 

  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[0], 0.05892556509887897*epsyy[5]*rdx11-0.06804138174397717*epsyy[3]*rdx11-0.06804138174397717*epsyy[1]*rdx11+0.07856742013183864*epsyy[0]*rdx11-0.03402069087198858*epsxy[7]*rdx01+0.05892556509887897*epsxy[6]*rdx01+0.05892556509887897*epsxy[5]*rdx01+0.03928371006591931*epsxy[4]*rdx01-0.10206207261596573*epsxy[3]*rdx01-0.06804138174397717*epsxy[2]*rdx01-0.06804138174397717*epsxy[1]*rdx01+0.11785113019775795*epsxy[0]*rdx01+0.05892556509887897*epsxx[6]*rdx00-0.06804138174397717*epsxx[3]*rdx00-0.06804138174397717*epsxx[2]*rdx00+0.07856742013183864*epsxx[0]*rdx00+0.06804138174397717*kSq[7]-0.07856742013183864*kSq[6]-0.07856742013183864*kSq[5]-0.07856742013183864*kSq[4]+0.09072184232530293*kSq[3]+0.09072184232530293*kSq[2]+0.09072184232530293*kSq[1]-0.10475656017578487*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[1], -(0.03402069087198858*epsyy[3]*rdx11)+0.03928371006591931*epsyy[0]*rdx11+0.03402069087198858*epsxy[7]*rdx01-0.05892556509887897*epsxy[5]*rdx01-0.03928371006591931*epsxy[4]*rdx01+0.06804138174397717*epsxy[1]*rdx01-0.05892556509887897*epsxx[6]*rdx00+0.06804138174397717*epsxx[3]*rdx00+0.06804138174397717*epsxx[2]*rdx00-0.07856742013183864*epsxx[0]*rdx00-0.03928371006591931*kSq[6]+0.04536092116265145*kSq[3]+0.04536092116265145*kSq[2]-0.052378280087892436*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[2], -(0.05892556509887897*epsyy[5]*rdx11)+0.06804138174397717*epsyy[3]*rdx11+0.06804138174397717*epsyy[1]*rdx11-0.07856742013183864*epsyy[0]*rdx11+0.03402069087198858*epsxy[7]*rdx01-0.05892556509887897*epsxy[6]*rdx01-0.03928371006591931*epsxy[4]*rdx01+0.06804138174397717*epsxy[2]*rdx01-0.03402069087198858*epsxx[3]*rdx00+0.03928371006591931*epsxx[0]*rdx00-0.03928371006591931*kSq[5]+0.04536092116265145*kSq[3]+0.04536092116265145*kSq[1]-0.052378280087892436*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[3], 0.03402069087198858*epsyy[3]*rdx11-0.03928371006591931*epsyy[0]*rdx11-0.03402069087198858*epsxy[7]*rdx01+0.03928371006591931*epsxy[4]*rdx01+0.10206207261596573*epsxy[3]*rdx01-0.11785113019775795*epsxy[0]*rdx01+0.03402069087198858*epsxx[3]*rdx00-0.03928371006591931*epsxx[0]*rdx00+0.022680460581325723*kSq[3]-0.026189140043946214*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[4], -(0.03402069087198858*epsyy[1]*rdx11)+0.03928371006591931*epsyy[0]*rdx11+0.019641855032959656*epsxy[4]*rdx01-0.03402069087198858*epsxy[2]*rdx01-0.03402069087198858*epsxy[1]*rdx01+0.05892556509887897*epsxy[0]*rdx01-0.03402069087198858*epsxx[2]*rdx00+0.03928371006591931*epsxx[0]*rdx00-0.03928371006591931*kSq[4]+0.04536092116265145*kSq[2]+0.04536092116265145*kSq[1]-0.052378280087892436*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[5], 0.019641855032959656*epsyy[0]*rdx11-0.019641855032959656*epsxy[4]*rdx01+0.03402069087198858*epsxy[1]*rdx01+0.03402069087198858*epsxx[2]*rdx00-0.03928371006591931*epsxx[0]*rdx00+0.022680460581325723*kSq[2]-0.026189140043946214*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[6], 0.03402069087198858*epsyy[1]*rdx11-0.03928371006591931*epsyy[0]*rdx11-0.019641855032959656*epsxy[4]*rdx01+0.03402069087198858*epsxy[2]*rdx01+0.019641855032959656*epsxx[0]*rdx00+0.022680460581325723*kSq[1]-0.026189140043946214*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[0], globalIdxs[7], -(0.019641855032959656*epsyy[0]*rdx11)+0.019641855032959656*epsxy[4]*rdx01-0.05892556509887897*epsxy[0]*rdx01-0.019641855032959656*epsxx[0]*rdx00-0.013094570021973104*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[0], -(0.03402069087198858*epsyy[3]*rdx11)+0.03928371006591931*epsyy[0]*rdx11+0.03402069087198858*epsxy[7]*rdx01-0.05892556509887897*epsxy[5]*rdx01-0.03928371006591931*epsxy[4]*rdx01+0.06804138174397717*epsxy[1]*rdx01-0.05892556509887897*epsxx[6]*rdx00+0.06804138174397717*epsxx[3]*rdx00+0.06804138174397717*epsxx[2]*rdx00-0.07856742013183864*epsxx[0]*rdx00-0.03928371006591931*kSq[6]+0.04536092116265145*kSq[3]+0.04536092116265145*kSq[2]-0.052378280087892436*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[1], -(0.05892556509887897*epsyy[5]*rdx11)-0.06804138174397717*epsyy[3]*rdx11+0.06804138174397717*epsyy[1]*rdx11+0.07856742013183864*epsyy[0]*rdx11-0.03402069087198858*epsxy[7]*rdx01-0.05892556509887897*epsxy[6]*rdx01+0.05892556509887897*epsxy[5]*rdx01+0.03928371006591931*epsxy[4]*rdx01+0.10206207261596573*epsxy[3]*rdx01+0.06804138174397717*epsxy[2]*rdx01-0.06804138174397717*epsxy[1]*rdx01-0.11785113019775795*epsxy[0]*rdx01+0.05892556509887897*epsxx[6]*rdx00-0.06804138174397717*epsxx[3]*rdx00-0.06804138174397717*epsxx[2]*rdx00+0.07856742013183864*epsxx[0]*rdx00-0.06804138174397717*kSq[7]-0.07856742013183864*kSq[6]+0.07856742013183864*kSq[5]+0.07856742013183864*kSq[4]+0.09072184232530293*kSq[3]+0.09072184232530293*kSq[2]-0.09072184232530293*kSq[1]-0.10475656017578487*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[2], 0.03402069087198858*epsyy[3]*rdx11-0.03928371006591931*epsyy[0]*rdx11-0.03402069087198858*epsxy[7]*rdx01+0.03928371006591931*epsxy[4]*rdx01-0.10206207261596573*epsxy[3]*rdx01+0.11785113019775795*epsxy[0]*rdx01+0.03402069087198858*epsxx[3]*rdx00-0.03928371006591931*epsxx[0]*rdx00+0.022680460581325723*kSq[3]-0.026189140043946214*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[3], 0.05892556509887897*epsyy[5]*rdx11+0.06804138174397717*epsyy[3]*rdx11-0.06804138174397717*epsyy[1]*rdx11-0.07856742013183864*epsyy[0]*rdx11+0.03402069087198858*epsxy[7]*rdx01+0.05892556509887897*epsxy[6]*rdx01-0.03928371006591931*epsxy[4]*rdx01-0.06804138174397717*epsxy[2]*rdx01-0.03402069087198858*epsxx[3]*rdx00+0.03928371006591931*epsxx[0]*rdx00+0.03928371006591931*kSq[5]+0.04536092116265145*kSq[3]-0.04536092116265145*kSq[1]-0.052378280087892436*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[4], 0.019641855032959656*epsyy[0]*rdx11-0.019641855032959656*epsxy[4]*rdx01+0.03402069087198858*epsxy[1]*rdx01+0.03402069087198858*epsxx[2]*rdx00-0.03928371006591931*epsxx[0]*rdx00+0.022680460581325723*kSq[2]-0.026189140043946214*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[5], 0.03402069087198858*epsyy[1]*rdx11+0.03928371006591931*epsyy[0]*rdx11+0.019641855032959656*epsxy[4]*rdx01+0.03402069087198858*epsxy[2]*rdx01-0.03402069087198858*epsxy[1]*rdx01-0.05892556509887897*epsxy[0]*rdx01-0.03402069087198858*epsxx[2]*rdx00+0.03928371006591931*epsxx[0]*rdx00+0.03928371006591931*kSq[4]+0.04536092116265145*kSq[2]-0.04536092116265145*kSq[1]-0.052378280087892436*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[6], -(0.019641855032959656*epsyy[0]*rdx11)+0.019641855032959656*epsxy[4]*rdx01+0.05892556509887897*epsxy[0]*rdx01-0.019641855032959656*epsxx[0]*rdx00-0.013094570021973104*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[1], globalIdxs[7], -(0.03402069087198858*epsyy[1]*rdx11)-0.03928371006591931*epsyy[0]*rdx11-0.019641855032959656*epsxy[4]*rdx01-0.03402069087198858*epsxy[2]*rdx01+0.019641855032959656*epsxx[0]*rdx00-0.022680460581325723*kSq[1]-0.026189140043946214*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[0], -(0.05892556509887897*epsyy[5]*rdx11)+0.06804138174397717*epsyy[3]*rdx11+0.06804138174397717*epsyy[1]*rdx11-0.07856742013183864*epsyy[0]*rdx11+0.03402069087198858*epsxy[7]*rdx01-0.05892556509887897*epsxy[6]*rdx01-0.03928371006591931*epsxy[4]*rdx01+0.06804138174397717*epsxy[2]*rdx01-0.03402069087198858*epsxx[3]*rdx00+0.03928371006591931*epsxx[0]*rdx00-0.03928371006591931*kSq[5]+0.04536092116265145*kSq[3]+0.04536092116265145*kSq[1]-0.052378280087892436*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[1], 0.03402069087198858*epsyy[3]*rdx11-0.03928371006591931*epsyy[0]*rdx11-0.03402069087198858*epsxy[7]*rdx01+0.03928371006591931*epsxy[4]*rdx01-0.10206207261596573*epsxy[3]*rdx01+0.11785113019775795*epsxy[0]*rdx01+0.03402069087198858*epsxx[3]*rdx00-0.03928371006591931*epsxx[0]*rdx00+0.022680460581325723*kSq[3]-0.026189140043946214*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[2], 0.05892556509887897*epsyy[5]*rdx11-0.06804138174397717*epsyy[3]*rdx11-0.06804138174397717*epsyy[1]*rdx11+0.07856742013183864*epsyy[0]*rdx11-0.03402069087198858*epsxy[7]*rdx01+0.05892556509887897*epsxy[6]*rdx01-0.05892556509887897*epsxy[5]*rdx01+0.03928371006591931*epsxy[4]*rdx01+0.10206207261596573*epsxy[3]*rdx01-0.06804138174397717*epsxy[2]*rdx01+0.06804138174397717*epsxy[1]*rdx01-0.11785113019775795*epsxy[0]*rdx01-0.05892556509887897*epsxx[6]*rdx00-0.06804138174397717*epsxx[3]*rdx00+0.06804138174397717*epsxx[2]*rdx00+0.07856742013183864*epsxx[0]*rdx00-0.06804138174397717*kSq[7]+0.07856742013183864*kSq[6]-0.07856742013183864*kSq[5]+0.07856742013183864*kSq[4]+0.09072184232530293*kSq[3]-0.09072184232530293*kSq[2]+0.09072184232530293*kSq[1]-0.10475656017578487*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[3], -(0.03402069087198858*epsyy[3]*rdx11)+0.03928371006591931*epsyy[0]*rdx11+0.03402069087198858*epsxy[7]*rdx01+0.05892556509887897*epsxy[5]*rdx01-0.03928371006591931*epsxy[4]*rdx01-0.06804138174397717*epsxy[1]*rdx01+0.05892556509887897*epsxx[6]*rdx00+0.06804138174397717*epsxx[3]*rdx00-0.06804138174397717*epsxx[2]*rdx00-0.07856742013183864*epsxx[0]*rdx00+0.03928371006591931*kSq[6]+0.04536092116265145*kSq[3]-0.04536092116265145*kSq[2]-0.052378280087892436*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[4], 0.03402069087198858*epsyy[1]*rdx11-0.03928371006591931*epsyy[0]*rdx11-0.019641855032959656*epsxy[4]*rdx01+0.03402069087198858*epsxy[2]*rdx01+0.019641855032959656*epsxx[0]*rdx00+0.022680460581325723*kSq[1]-0.026189140043946214*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[5], -(0.019641855032959656*epsyy[0]*rdx11)+0.019641855032959656*epsxy[4]*rdx01+0.05892556509887897*epsxy[0]*rdx01-0.019641855032959656*epsxx[0]*rdx00-0.013094570021973104*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[6], -(0.03402069087198858*epsyy[1]*rdx11)+0.03928371006591931*epsyy[0]*rdx11+0.019641855032959656*epsxy[4]*rdx01-0.03402069087198858*epsxy[2]*rdx01+0.03402069087198858*epsxy[1]*rdx01-0.05892556509887897*epsxy[0]*rdx01+0.03402069087198858*epsxx[2]*rdx00+0.03928371006591931*epsxx[0]*rdx00+0.03928371006591931*kSq[4]-0.04536092116265145*kSq[2]+0.04536092116265145*kSq[1]-0.052378280087892436*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[2], globalIdxs[7], 0.019641855032959656*epsyy[0]*rdx11-0.019641855032959656*epsxy[4]*rdx01-0.03402069087198858*epsxy[1]*rdx01-0.03402069087198858*epsxx[2]*rdx00-0.03928371006591931*epsxx[0]*rdx00-0.022680460581325723*kSq[2]-0.026189140043946214*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[0], 0.03402069087198858*epsyy[3]*rdx11-0.03928371006591931*epsyy[0]*rdx11-0.03402069087198858*epsxy[7]*rdx01+0.03928371006591931*epsxy[4]*rdx01+0.10206207261596573*epsxy[3]*rdx01-0.11785113019775795*epsxy[0]*rdx01+0.03402069087198858*epsxx[3]*rdx00-0.03928371006591931*epsxx[0]*rdx00+0.022680460581325723*kSq[3]-0.026189140043946214*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[1], 0.05892556509887897*epsyy[5]*rdx11+0.06804138174397717*epsyy[3]*rdx11-0.06804138174397717*epsyy[1]*rdx11-0.07856742013183864*epsyy[0]*rdx11+0.03402069087198858*epsxy[7]*rdx01+0.05892556509887897*epsxy[6]*rdx01-0.03928371006591931*epsxy[4]*rdx01-0.06804138174397717*epsxy[2]*rdx01-0.03402069087198858*epsxx[3]*rdx00+0.03928371006591931*epsxx[0]*rdx00+0.03928371006591931*kSq[5]+0.04536092116265145*kSq[3]-0.04536092116265145*kSq[1]-0.052378280087892436*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[2], -(0.03402069087198858*epsyy[3]*rdx11)+0.03928371006591931*epsyy[0]*rdx11+0.03402069087198858*epsxy[7]*rdx01+0.05892556509887897*epsxy[5]*rdx01-0.03928371006591931*epsxy[4]*rdx01-0.06804138174397717*epsxy[1]*rdx01+0.05892556509887897*epsxx[6]*rdx00+0.06804138174397717*epsxx[3]*rdx00-0.06804138174397717*epsxx[2]*rdx00-0.07856742013183864*epsxx[0]*rdx00+0.03928371006591931*kSq[6]+0.04536092116265145*kSq[3]-0.04536092116265145*kSq[2]-0.052378280087892436*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[3], -(0.05892556509887897*epsyy[5]*rdx11)-0.06804138174397717*epsyy[3]*rdx11+0.06804138174397717*epsyy[1]*rdx11+0.07856742013183864*epsyy[0]*rdx11-0.03402069087198858*epsxy[7]*rdx01-0.05892556509887897*epsxy[6]*rdx01-0.05892556509887897*epsxy[5]*rdx01+0.03928371006591931*epsxy[4]*rdx01-0.10206207261596573*epsxy[3]*rdx01+0.06804138174397717*epsxy[2]*rdx01+0.06804138174397717*epsxy[1]*rdx01+0.11785113019775795*epsxy[0]*rdx01-0.05892556509887897*epsxx[6]*rdx00-0.06804138174397717*epsxx[3]*rdx00+0.06804138174397717*epsxx[2]*rdx00+0.07856742013183864*epsxx[0]*rdx00+0.06804138174397717*kSq[7]+0.07856742013183864*kSq[6]+0.07856742013183864*kSq[5]-0.07856742013183864*kSq[4]+0.09072184232530293*kSq[3]-0.09072184232530293*kSq[2]-0.09072184232530293*kSq[1]-0.10475656017578487*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[4], -(0.019641855032959656*epsyy[0]*rdx11)+0.019641855032959656*epsxy[4]*rdx01-0.05892556509887897*epsxy[0]*rdx01-0.019641855032959656*epsxx[0]*rdx00-0.013094570021973104*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[5], -(0.03402069087198858*epsyy[1]*rdx11)-0.03928371006591931*epsyy[0]*rdx11-0.019641855032959656*epsxy[4]*rdx01-0.03402069087198858*epsxy[2]*rdx01+0.019641855032959656*epsxx[0]*rdx00-0.022680460581325723*kSq[1]-0.026189140043946214*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[6], 0.019641855032959656*epsyy[0]*rdx11-0.019641855032959656*epsxy[4]*rdx01-0.03402069087198858*epsxy[1]*rdx01-0.03402069087198858*epsxx[2]*rdx00-0.03928371006591931*epsxx[0]*rdx00-0.022680460581325723*kSq[2]-0.026189140043946214*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[3], globalIdxs[7], 0.03402069087198858*epsyy[1]*rdx11+0.03928371006591931*epsyy[0]*rdx11+0.019641855032959656*epsxy[4]*rdx01+0.03402069087198858*epsxy[2]*rdx01+0.03402069087198858*epsxy[1]*rdx01+0.05892556509887897*epsxy[0]*rdx01+0.03402069087198858*epsxx[2]*rdx00+0.03928371006591931*epsxx[0]*rdx00-0.03928371006591931*kSq[4]-0.04536092116265145*kSq[2]-0.04536092116265145*kSq[1]-0.052378280087892436*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[4], globalIdxs[0], -(0.03402069087198858*epsyy[1]*rdx11)+0.03928371006591931*epsyy[0]*rdx11+0.019641855032959656*epsxy[4]*rdx01-0.03402069087198858*epsxy[2]*rdx01-0.03402069087198858*epsxy[1]*rdx01+0.05892556509887897*epsxy[0]*rdx01-0.03402069087198858*epsxx[2]*rdx00+0.03928371006591931*epsxx[0]*rdx00-0.03928371006591931*kSq[4]+0.04536092116265145*kSq[2]+0.04536092116265145*kSq[1]-0.052378280087892436*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[4], globalIdxs[1], 0.019641855032959656*epsyy[0]*rdx11-0.019641855032959656*epsxy[4]*rdx01+0.03402069087198858*epsxy[1]*rdx01+0.03402069087198858*epsxx[2]*rdx00-0.03928371006591931*epsxx[0]*rdx00+0.022680460581325723*kSq[2]-0.026189140043946214*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[4], globalIdxs[2], 0.03402069087198858*epsyy[1]*rdx11-0.03928371006591931*epsyy[0]*rdx11-0.019641855032959656*epsxy[4]*rdx01+0.03402069087198858*epsxy[2]*rdx01+0.019641855032959656*epsxx[0]*rdx00+0.022680460581325723*kSq[1]-0.026189140043946214*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[4], globalIdxs[3], -(0.019641855032959656*epsyy[0]*rdx11)+0.019641855032959656*epsxy[4]*rdx01-0.05892556509887897*epsxy[0]*rdx01-0.019641855032959656*epsxx[0]*rdx00-0.013094570021973104*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[4], globalIdxs[4], -(0.05892556509887897*epsyy[5]*rdx11)+0.06804138174397717*epsyy[3]*rdx11-0.06804138174397717*epsyy[1]*rdx11+0.07856742013183864*epsyy[0]*rdx11+0.03402069087198858*epsxy[7]*rdx01-0.05892556509887897*epsxy[6]*rdx01-0.05892556509887897*epsxy[5]*rdx01+0.03928371006591931*epsxy[4]*rdx01+0.10206207261596573*epsxy[3]*rdx01-0.06804138174397717*epsxy[2]*rdx01-0.06804138174397717*epsxy[1]*rdx01+0.11785113019775795*epsxy[0]*rdx01-0.05892556509887897*epsxx[6]*rdx00+0.06804138174397717*epsxx[3]*rdx00-0.06804138174397717*epsxx[2]*rdx00+0.07856742013183864*epsxx[0]*rdx00-0.06804138174397717*kSq[7]+0.07856742013183864*kSq[6]+0.07856742013183864*kSq[5]-0.07856742013183864*kSq[4]-0.09072184232530293*kSq[3]+0.09072184232530293*kSq[2]+0.09072184232530293*kSq[1]-0.10475656017578487*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[4], globalIdxs[5], 0.03402069087198858*epsyy[3]*rdx11+0.03928371006591931*epsyy[0]*rdx11-0.03402069087198858*epsxy[7]*rdx01+0.05892556509887897*epsxy[5]*rdx01-0.03928371006591931*epsxy[4]*rdx01+0.06804138174397717*epsxy[1]*rdx01+0.05892556509887897*epsxx[6]*rdx00-0.06804138174397717*epsxx[3]*rdx00+0.06804138174397717*epsxx[2]*rdx00-0.07856742013183864*epsxx[0]*rdx00+0.03928371006591931*kSq[6]-0.04536092116265145*kSq[3]+0.04536092116265145*kSq[2]-0.052378280087892436*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[4], globalIdxs[6], 0.05892556509887897*epsyy[5]*rdx11-0.06804138174397717*epsyy[3]*rdx11+0.06804138174397717*epsyy[1]*rdx11-0.07856742013183864*epsyy[0]*rdx11-0.03402069087198858*epsxy[7]*rdx01+0.05892556509887897*epsxy[6]*rdx01-0.03928371006591931*epsxy[4]*rdx01+0.06804138174397717*epsxy[2]*rdx01+0.03402069087198858*epsxx[3]*rdx00+0.03928371006591931*epsxx[0]*rdx00+0.03928371006591931*kSq[5]-0.04536092116265145*kSq[3]+0.04536092116265145*kSq[1]-0.052378280087892436*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[4], globalIdxs[7], -(0.03402069087198858*epsyy[3]*rdx11)-0.03928371006591931*epsyy[0]*rdx11+0.03402069087198858*epsxy[7]*rdx01+0.03928371006591931*epsxy[4]*rdx01-0.10206207261596573*epsxy[3]*rdx01-0.11785113019775795*epsxy[0]*rdx01-0.03402069087198858*epsxx[3]*rdx00-0.03928371006591931*epsxx[0]*rdx00-0.022680460581325723*kSq[3]-0.026189140043946214*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[5], globalIdxs[0], 0.019641855032959656*epsyy[0]*rdx11-0.019641855032959656*epsxy[4]*rdx01+0.03402069087198858*epsxy[1]*rdx01+0.03402069087198858*epsxx[2]*rdx00-0.03928371006591931*epsxx[0]*rdx00+0.022680460581325723*kSq[2]-0.026189140043946214*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[5], globalIdxs[1], 0.03402069087198858*epsyy[1]*rdx11+0.03928371006591931*epsyy[0]*rdx11+0.019641855032959656*epsxy[4]*rdx01+0.03402069087198858*epsxy[2]*rdx01-0.03402069087198858*epsxy[1]*rdx01-0.05892556509887897*epsxy[0]*rdx01-0.03402069087198858*epsxx[2]*rdx00+0.03928371006591931*epsxx[0]*rdx00+0.03928371006591931*kSq[4]+0.04536092116265145*kSq[2]-0.04536092116265145*kSq[1]-0.052378280087892436*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[5], globalIdxs[2], -(0.019641855032959656*epsyy[0]*rdx11)+0.019641855032959656*epsxy[4]*rdx01+0.05892556509887897*epsxy[0]*rdx01-0.019641855032959656*epsxx[0]*rdx00-0.013094570021973104*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[5], globalIdxs[3], -(0.03402069087198858*epsyy[1]*rdx11)-0.03928371006591931*epsyy[0]*rdx11-0.019641855032959656*epsxy[4]*rdx01-0.03402069087198858*epsxy[2]*rdx01+0.019641855032959656*epsxx[0]*rdx00-0.022680460581325723*kSq[1]-0.026189140043946214*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[5], globalIdxs[4], 0.03402069087198858*epsyy[3]*rdx11+0.03928371006591931*epsyy[0]*rdx11-0.03402069087198858*epsxy[7]*rdx01+0.05892556509887897*epsxy[5]*rdx01-0.03928371006591931*epsxy[4]*rdx01+0.06804138174397717*epsxy[1]*rdx01+0.05892556509887897*epsxx[6]*rdx00-0.06804138174397717*epsxx[3]*rdx00+0.06804138174397717*epsxx[2]*rdx00-0.07856742013183864*epsxx[0]*rdx00+0.03928371006591931*kSq[6]-0.04536092116265145*kSq[3]+0.04536092116265145*kSq[2]-0.052378280087892436*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[5], globalIdxs[5], 0.05892556509887897*epsyy[5]*rdx11+0.06804138174397717*epsyy[3]*rdx11+0.06804138174397717*epsyy[1]*rdx11+0.07856742013183864*epsyy[0]*rdx11+0.03402069087198858*epsxy[7]*rdx01+0.05892556509887897*epsxy[6]*rdx01-0.05892556509887897*epsxy[5]*rdx01+0.03928371006591931*epsxy[4]*rdx01-0.10206207261596573*epsxy[3]*rdx01+0.06804138174397717*epsxy[2]*rdx01-0.06804138174397717*epsxy[1]*rdx01-0.11785113019775795*epsxy[0]*rdx01-0.05892556509887897*epsxx[6]*rdx00+0.06804138174397717*epsxx[3]*rdx00-0.06804138174397717*epsxx[2]*rdx00+0.07856742013183864*epsxx[0]*rdx00+0.06804138174397717*kSq[7]+0.07856742013183864*kSq[6]-0.07856742013183864*kSq[5]+0.07856742013183864*kSq[4]-0.09072184232530293*kSq[3]+0.09072184232530293*kSq[2]-0.09072184232530293*kSq[1]-0.10475656017578487*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[5], globalIdxs[6], -(0.03402069087198858*epsyy[3]*rdx11)-0.03928371006591931*epsyy[0]*rdx11+0.03402069087198858*epsxy[7]*rdx01+0.03928371006591931*epsxy[4]*rdx01+0.10206207261596573*epsxy[3]*rdx01+0.11785113019775795*epsxy[0]*rdx01-0.03402069087198858*epsxx[3]*rdx00-0.03928371006591931*epsxx[0]*rdx00-0.022680460581325723*kSq[3]-0.026189140043946214*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[5], globalIdxs[7], -(0.05892556509887897*epsyy[5]*rdx11)-0.06804138174397717*epsyy[3]*rdx11-0.06804138174397717*epsyy[1]*rdx11-0.07856742013183864*epsyy[0]*rdx11-0.03402069087198858*epsxy[7]*rdx01-0.05892556509887897*epsxy[6]*rdx01-0.03928371006591931*epsxy[4]*rdx01-0.06804138174397717*epsxy[2]*rdx01+0.03402069087198858*epsxx[3]*rdx00+0.03928371006591931*epsxx[0]*rdx00-0.03928371006591931*kSq[5]-0.04536092116265145*kSq[3]-0.04536092116265145*kSq[1]-0.052378280087892436*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[6], globalIdxs[0], 0.03402069087198858*epsyy[1]*rdx11-0.03928371006591931*epsyy[0]*rdx11-0.019641855032959656*epsxy[4]*rdx01+0.03402069087198858*epsxy[2]*rdx01+0.019641855032959656*epsxx[0]*rdx00+0.022680460581325723*kSq[1]-0.026189140043946214*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[6], globalIdxs[1], -(0.019641855032959656*epsyy[0]*rdx11)+0.019641855032959656*epsxy[4]*rdx01+0.05892556509887897*epsxy[0]*rdx01-0.019641855032959656*epsxx[0]*rdx00-0.013094570021973104*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[6], globalIdxs[2], -(0.03402069087198858*epsyy[1]*rdx11)+0.03928371006591931*epsyy[0]*rdx11+0.019641855032959656*epsxy[4]*rdx01-0.03402069087198858*epsxy[2]*rdx01+0.03402069087198858*epsxy[1]*rdx01-0.05892556509887897*epsxy[0]*rdx01+0.03402069087198858*epsxx[2]*rdx00+0.03928371006591931*epsxx[0]*rdx00+0.03928371006591931*kSq[4]-0.04536092116265145*kSq[2]+0.04536092116265145*kSq[1]-0.052378280087892436*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[6], globalIdxs[3], 0.019641855032959656*epsyy[0]*rdx11-0.019641855032959656*epsxy[4]*rdx01-0.03402069087198858*epsxy[1]*rdx01-0.03402069087198858*epsxx[2]*rdx00-0.03928371006591931*epsxx[0]*rdx00-0.022680460581325723*kSq[2]-0.026189140043946214*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[6], globalIdxs[4], 0.05892556509887897*epsyy[5]*rdx11-0.06804138174397717*epsyy[3]*rdx11+0.06804138174397717*epsyy[1]*rdx11-0.07856742013183864*epsyy[0]*rdx11-0.03402069087198858*epsxy[7]*rdx01+0.05892556509887897*epsxy[6]*rdx01-0.03928371006591931*epsxy[4]*rdx01+0.06804138174397717*epsxy[2]*rdx01+0.03402069087198858*epsxx[3]*rdx00+0.03928371006591931*epsxx[0]*rdx00+0.03928371006591931*kSq[5]-0.04536092116265145*kSq[3]+0.04536092116265145*kSq[1]-0.052378280087892436*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[6], globalIdxs[5], -(0.03402069087198858*epsyy[3]*rdx11)-0.03928371006591931*epsyy[0]*rdx11+0.03402069087198858*epsxy[7]*rdx01+0.03928371006591931*epsxy[4]*rdx01+0.10206207261596573*epsxy[3]*rdx01+0.11785113019775795*epsxy[0]*rdx01-0.03402069087198858*epsxx[3]*rdx00-0.03928371006591931*epsxx[0]*rdx00-0.022680460581325723*kSq[3]-0.026189140043946214*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[6], globalIdxs[6], -(0.05892556509887897*epsyy[5]*rdx11)+0.06804138174397717*epsyy[3]*rdx11-0.06804138174397717*epsyy[1]*rdx11+0.07856742013183864*epsyy[0]*rdx11+0.03402069087198858*epsxy[7]*rdx01-0.05892556509887897*epsxy[6]*rdx01+0.05892556509887897*epsxy[5]*rdx01+0.03928371006591931*epsxy[4]*rdx01-0.10206207261596573*epsxy[3]*rdx01-0.06804138174397717*epsxy[2]*rdx01+0.06804138174397717*epsxy[1]*rdx01-0.11785113019775795*epsxy[0]*rdx01+0.05892556509887897*epsxx[6]*rdx00+0.06804138174397717*epsxx[3]*rdx00+0.06804138174397717*epsxx[2]*rdx00+0.07856742013183864*epsxx[0]*rdx00+0.06804138174397717*kSq[7]-0.07856742013183864*kSq[6]+0.07856742013183864*kSq[5]+0.07856742013183864*kSq[4]-0.09072184232530293*kSq[3]-0.09072184232530293*kSq[2]+0.09072184232530293*kSq[1]-0.10475656017578487*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[6], globalIdxs[7], 0.03402069087198858*epsyy[3]*rdx11+0.03928371006591931*epsyy[0]*rdx11-0.03402069087198858*epsxy[7]*rdx01-0.05892556509887897*epsxy[5]*rdx01-0.03928371006591931*epsxy[4]*rdx01-0.06804138174397717*epsxy[1]*rdx01-0.05892556509887897*epsxx[6]*rdx00-0.06804138174397717*epsxx[3]*rdx00-0.06804138174397717*epsxx[2]*rdx00-0.07856742013183864*epsxx[0]*rdx00-0.03928371006591931*kSq[6]-0.04536092116265145*kSq[3]-0.04536092116265145*kSq[2]-0.052378280087892436*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[7], globalIdxs[0], -(0.019641855032959656*epsyy[0]*rdx11)+0.019641855032959656*epsxy[4]*rdx01-0.05892556509887897*epsxy[0]*rdx01-0.019641855032959656*epsxx[0]*rdx00-0.013094570021973104*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[7], globalIdxs[1], -(0.03402069087198858*epsyy[1]*rdx11)-0.03928371006591931*epsyy[0]*rdx11-0.019641855032959656*epsxy[4]*rdx01-0.03402069087198858*epsxy[2]*rdx01+0.019641855032959656*epsxx[0]*rdx00-0.022680460581325723*kSq[1]-0.026189140043946214*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[7], globalIdxs[2], 0.019641855032959656*epsyy[0]*rdx11-0.019641855032959656*epsxy[4]*rdx01-0.03402069087198858*epsxy[1]*rdx01-0.03402069087198858*epsxx[2]*rdx00-0.03928371006591931*epsxx[0]*rdx00-0.022680460581325723*kSq[2]-0.026189140043946214*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[7], globalIdxs[3], 0.03402069087198858*epsyy[1]*rdx11+0.03928371006591931*epsyy[0]*rdx11+0.019641855032959656*epsxy[4]*rdx01+0.03402069087198858*epsxy[2]*rdx01+0.03402069087198858*epsxy[1]*rdx01+0.05892556509887897*epsxy[0]*rdx01+0.03402069087198858*epsxx[2]*rdx00+0.03928371006591931*epsxx[0]*rdx00-0.03928371006591931*kSq[4]-0.04536092116265145*kSq[2]-0.04536092116265145*kSq[1]-0.052378280087892436*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[7], globalIdxs[4], -(0.03402069087198858*epsyy[3]*rdx11)-0.03928371006591931*epsyy[0]*rdx11+0.03402069087198858*epsxy[7]*rdx01+0.03928371006591931*epsxy[4]*rdx01-0.10206207261596573*epsxy[3]*rdx01-0.11785113019775795*epsxy[0]*rdx01-0.03402069087198858*epsxx[3]*rdx00-0.03928371006591931*epsxx[0]*rdx00-0.022680460581325723*kSq[3]-0.026189140043946214*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[7], globalIdxs[5], -(0.05892556509887897*epsyy[5]*rdx11)-0.06804138174397717*epsyy[3]*rdx11-0.06804138174397717*epsyy[1]*rdx11-0.07856742013183864*epsyy[0]*rdx11-0.03402069087198858*epsxy[7]*rdx01-0.05892556509887897*epsxy[6]*rdx01-0.03928371006591931*epsxy[4]*rdx01-0.06804138174397717*epsxy[2]*rdx01+0.03402069087198858*epsxx[3]*rdx00+0.03928371006591931*epsxx[0]*rdx00-0.03928371006591931*kSq[5]-0.04536092116265145*kSq[3]-0.04536092116265145*kSq[1]-0.052378280087892436*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[7], globalIdxs[6], 0.03402069087198858*epsyy[3]*rdx11+0.03928371006591931*epsyy[0]*rdx11-0.03402069087198858*epsxy[7]*rdx01-0.05892556509887897*epsxy[5]*rdx01-0.03928371006591931*epsxy[4]*rdx01-0.06804138174397717*epsxy[1]*rdx01-0.05892556509887897*epsxx[6]*rdx00-0.06804138174397717*epsxx[3]*rdx00-0.06804138174397717*epsxx[2]*rdx00-0.07856742013183864*epsxx[0]*rdx00-0.03928371006591931*kSq[6]-0.04536092116265145*kSq[3]-0.04536092116265145*kSq[2]-0.052378280087892436*kSq[0]);
  gkyl_mat_triples_accum(tri, globalIdxs[7], globalIdxs[7], 0.05892556509887897*epsyy[5]*rdx11+0.06804138174397717*epsyy[3]*rdx11+0.06804138174397717*epsyy[1]*rdx11+0.07856742013183864*epsyy[0]*rdx11+0.03402069087198858*epsxy[7]*rdx01+0.05892556509887897*epsxy[6]*rdx01+0.05892556509887897*epsxy[5]*rdx01+0.03928371006591931*epsxy[4]*rdx01+0.10206207261596573*epsxy[3]*rdx01+0.06804138174397717*epsxy[2]*rdx01+0.06804138174397717*epsxy[1]*rdx01+0.11785113019775795*epsxy[0]*rdx01+0.05892556509887897*epsxx[6]*rdx00+0.06804138174397717*epsxx[3]*rdx00+0.06804138174397717*epsxx[2]*rdx00+0.07856742013183864*epsxx[0]*rdx00-0.06804138174397717*kSq[7]-0.07856742013183864*kSq[6]-0.07856742013183864*kSq[5]-0.07856742013183864*kSq[4]-0.09072184232530293*kSq[3]-0.09072184232530293*kSq[2]-0.09072184232530293*kSq[1]-0.10475656017578487*kSq[0]);

}

