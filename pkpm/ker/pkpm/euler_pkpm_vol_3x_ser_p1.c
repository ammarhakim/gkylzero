#include <gkyl_euler_pkpm_kernels.h> 
GKYL_CU_DH double euler_pkpm_vol_3x_ser_p1(const double *w, const double *dxv, const double *prim, const double *p_ij, const double *euler_pkpm, double* GKYL_RESTRICT out) 
{ 
  // w[NDIM]:    Cell-center coordinates.
  // dxv[NDIM]:  Cell spacing.
  // prim:       Input primitive variables [ux, uy, uz, 3*Txx/m, 3*Tyy/m, 3*Tzz/m, 1/rho div(p_par b), T_perp/m, m/T_perp].
  // p_ij:       Input pressure tensor.
  // euler_pkpm: [rho ux, rho uy, rho uz], Fluid input state vector.
  // out:        Incremented output.

  double dx10 = 2./dxv[0]; 
  double dx11 = 2./dxv[1]; 
  double dx12 = 2./dxv[2]; 

  const double *rhoux = &euler_pkpm[0]; 
  const double *rhouy = &euler_pkpm[8]; 
  const double *rhouz = &euler_pkpm[16]; 

  const double *ux = &prim[0]; 
  const double *uy = &prim[8]; 
  const double *uz = &prim[16]; 

  const double *Pxx = &p_ij[0]; 
  const double *Pxy = &p_ij[8]; 
  const double *Pxz = &p_ij[16]; 
  const double *Pyy = &p_ij[24]; 
  const double *Pyz = &p_ij[32]; 
  const double *Pzz = &p_ij[40]; 

  double *outrhoux = &out[0]; 
  double *outrhouy = &out[8]; 
  double *outrhouz = &out[16]; 

  double cflFreq_mid = 0.0; 
  cflFreq_mid += 0.5*3.0*dx10*(fabs(0.3535533905932737*ux[0])); 
  cflFreq_mid += 0.5*3.0*dx11*(fabs(0.3535533905932737*uy[0])); 
  cflFreq_mid += 0.5*3.0*dx12*(fabs(0.3535533905932737*uz[0])); 

  outrhoux[1] += 0.6123724356957944*rhoux[7]*ux[7]*dx10+0.6123724356957944*rhoux[6]*ux[6]*dx10+0.6123724356957944*rhoux[5]*ux[5]*dx10+0.6123724356957944*rhoux[4]*ux[4]*dx10+0.6123724356957944*rhoux[3]*ux[3]*dx10+0.6123724356957944*rhoux[2]*ux[2]*dx10+0.6123724356957944*rhoux[1]*ux[1]*dx10+0.6123724356957944*rhoux[0]*ux[0]*dx10+1.732050807568877*Pxx[0]*dx10; 
  outrhoux[2] += 0.6123724356957944*rhoux[7]*uy[7]*dx11+0.6123724356957944*rhoux[6]*uy[6]*dx11+0.6123724356957944*rhoux[5]*uy[5]*dx11+0.6123724356957944*rhoux[4]*uy[4]*dx11+0.6123724356957944*rhoux[3]*uy[3]*dx11+0.6123724356957944*rhoux[2]*uy[2]*dx11+0.6123724356957944*rhoux[1]*uy[1]*dx11+0.6123724356957944*rhoux[0]*uy[0]*dx11+1.732050807568877*Pxy[0]*dx11; 
  outrhoux[3] += 0.6123724356957944*rhoux[7]*uz[7]*dx12+0.6123724356957944*rhoux[6]*uz[6]*dx12+0.6123724356957944*rhoux[5]*uz[5]*dx12+0.6123724356957944*rhoux[4]*uz[4]*dx12+0.6123724356957944*rhoux[3]*uz[3]*dx12+0.6123724356957944*rhoux[2]*uz[2]*dx12+0.6123724356957944*rhoux[1]*uz[1]*dx12+0.6123724356957944*rhoux[0]*uz[0]*dx12+1.732050807568877*Pxz[0]*dx12; 
  outrhoux[4] += 0.6123724356957944*rhoux[6]*uy[7]*dx11+0.6123724356957944*uy[6]*rhoux[7]*dx11+0.6123724356957944*rhoux[3]*uy[5]*dx11+0.6123724356957944*uy[3]*rhoux[5]*dx11+0.6123724356957944*rhoux[2]*uy[4]*dx11+0.6123724356957944*uy[2]*rhoux[4]*dx11+0.6123724356957944*rhoux[0]*uy[1]*dx11+0.6123724356957944*uy[0]*rhoux[1]*dx11+1.732050807568877*Pxy[1]*dx11+0.6123724356957944*rhoux[5]*ux[7]*dx10+0.6123724356957944*ux[5]*rhoux[7]*dx10+0.6123724356957944*rhoux[3]*ux[6]*dx10+0.6123724356957944*ux[3]*rhoux[6]*dx10+0.6123724356957944*rhoux[1]*ux[4]*dx10+0.6123724356957944*ux[1]*rhoux[4]*dx10+0.6123724356957944*rhoux[0]*ux[2]*dx10+0.6123724356957944*ux[0]*rhoux[2]*dx10+1.732050807568877*Pxx[2]*dx10; 
  outrhoux[5] += 0.6123724356957944*rhoux[6]*uz[7]*dx12+0.6123724356957944*uz[6]*rhoux[7]*dx12+0.6123724356957944*rhoux[3]*uz[5]*dx12+0.6123724356957944*uz[3]*rhoux[5]*dx12+0.6123724356957944*rhoux[2]*uz[4]*dx12+0.6123724356957944*uz[2]*rhoux[4]*dx12+0.6123724356957944*rhoux[0]*uz[1]*dx12+0.6123724356957944*uz[0]*rhoux[1]*dx12+1.732050807568877*Pxz[1]*dx12+0.6123724356957944*rhoux[4]*ux[7]*dx10+0.6123724356957944*ux[4]*rhoux[7]*dx10+0.6123724356957944*rhoux[2]*ux[6]*dx10+0.6123724356957944*ux[2]*rhoux[6]*dx10+0.6123724356957944*rhoux[1]*ux[5]*dx10+0.6123724356957944*ux[1]*rhoux[5]*dx10+0.6123724356957944*rhoux[0]*ux[3]*dx10+0.6123724356957944*ux[0]*rhoux[3]*dx10+1.732050807568877*Pxx[3]*dx10; 
  outrhoux[6] += 0.6123724356957944*rhoux[5]*uz[7]*dx12+0.6123724356957944*uz[5]*rhoux[7]*dx12+0.6123724356957944*rhoux[3]*uz[6]*dx12+0.6123724356957944*uz[3]*rhoux[6]*dx12+0.6123724356957944*rhoux[1]*uz[4]*dx12+0.6123724356957944*uz[1]*rhoux[4]*dx12+0.6123724356957944*rhoux[0]*uz[2]*dx12+0.6123724356957944*uz[0]*rhoux[2]*dx12+1.732050807568877*Pxz[2]*dx12+0.6123724356957944*rhoux[4]*uy[7]*dx11+0.6123724356957944*uy[4]*rhoux[7]*dx11+0.6123724356957944*rhoux[2]*uy[6]*dx11+0.6123724356957944*uy[2]*rhoux[6]*dx11+0.6123724356957944*rhoux[1]*uy[5]*dx11+0.6123724356957944*uy[1]*rhoux[5]*dx11+0.6123724356957944*rhoux[0]*uy[3]*dx11+0.6123724356957944*uy[0]*rhoux[3]*dx11+1.732050807568877*Pxy[3]*dx11; 
  outrhoux[7] += 0.6123724356957944*rhoux[3]*uz[7]*dx12+0.6123724356957944*uz[3]*rhoux[7]*dx12+0.6123724356957944*rhoux[5]*uz[6]*dx12+0.6123724356957944*uz[5]*rhoux[6]*dx12+0.6123724356957944*rhoux[0]*uz[4]*dx12+0.6123724356957944*uz[0]*rhoux[4]*dx12+1.732050807568877*Pxz[4]*dx12+0.6123724356957944*rhoux[1]*uz[2]*dx12+0.6123724356957944*uz[1]*rhoux[2]*dx12+0.6123724356957944*rhoux[2]*uy[7]*dx11+0.6123724356957944*uy[2]*rhoux[7]*dx11+0.6123724356957944*rhoux[4]*uy[6]*dx11+0.6123724356957944*uy[4]*rhoux[6]*dx11+0.6123724356957944*rhoux[0]*uy[5]*dx11+0.6123724356957944*uy[0]*rhoux[5]*dx11+1.732050807568877*Pxy[5]*dx11+0.6123724356957944*rhoux[1]*uy[3]*dx11+0.6123724356957944*uy[1]*rhoux[3]*dx11+0.6123724356957944*rhoux[1]*ux[7]*dx10+0.6123724356957944*ux[1]*rhoux[7]*dx10+0.6123724356957944*rhoux[0]*ux[6]*dx10+0.6123724356957944*ux[0]*rhoux[6]*dx10+1.732050807568877*Pxx[6]*dx10+0.6123724356957944*rhoux[4]*ux[5]*dx10+0.6123724356957944*ux[4]*rhoux[5]*dx10+0.6123724356957944*rhoux[2]*ux[3]*dx10+0.6123724356957944*ux[2]*rhoux[3]*dx10; 

  outrhouy[1] += 0.6123724356957944*rhouy[7]*ux[7]*dx10+0.6123724356957944*rhouy[6]*ux[6]*dx10+0.6123724356957944*rhouy[5]*ux[5]*dx10+0.6123724356957944*rhouy[4]*ux[4]*dx10+0.6123724356957944*rhouy[3]*ux[3]*dx10+0.6123724356957944*rhouy[2]*ux[2]*dx10+0.6123724356957944*rhouy[1]*ux[1]*dx10+0.6123724356957944*rhouy[0]*ux[0]*dx10+1.732050807568877*Pxy[0]*dx10; 
  outrhouy[2] += 0.6123724356957944*rhouy[7]*uy[7]*dx11+0.6123724356957944*rhouy[6]*uy[6]*dx11+0.6123724356957944*rhouy[5]*uy[5]*dx11+0.6123724356957944*rhouy[4]*uy[4]*dx11+0.6123724356957944*rhouy[3]*uy[3]*dx11+0.6123724356957944*rhouy[2]*uy[2]*dx11+0.6123724356957944*rhouy[1]*uy[1]*dx11+0.6123724356957944*rhouy[0]*uy[0]*dx11+1.732050807568877*Pyy[0]*dx11; 
  outrhouy[3] += 0.6123724356957944*rhouy[7]*uz[7]*dx12+0.6123724356957944*rhouy[6]*uz[6]*dx12+0.6123724356957944*rhouy[5]*uz[5]*dx12+0.6123724356957944*rhouy[4]*uz[4]*dx12+0.6123724356957944*rhouy[3]*uz[3]*dx12+0.6123724356957944*rhouy[2]*uz[2]*dx12+0.6123724356957944*rhouy[1]*uz[1]*dx12+0.6123724356957944*rhouy[0]*uz[0]*dx12+1.732050807568877*Pyz[0]*dx12; 
  outrhouy[4] += 0.6123724356957944*rhouy[6]*uy[7]*dx11+0.6123724356957944*uy[6]*rhouy[7]*dx11+0.6123724356957944*rhouy[3]*uy[5]*dx11+0.6123724356957944*uy[3]*rhouy[5]*dx11+0.6123724356957944*rhouy[2]*uy[4]*dx11+0.6123724356957944*uy[2]*rhouy[4]*dx11+0.6123724356957944*rhouy[0]*uy[1]*dx11+0.6123724356957944*uy[0]*rhouy[1]*dx11+1.732050807568877*Pyy[1]*dx11+0.6123724356957944*rhouy[5]*ux[7]*dx10+0.6123724356957944*ux[5]*rhouy[7]*dx10+0.6123724356957944*rhouy[3]*ux[6]*dx10+0.6123724356957944*ux[3]*rhouy[6]*dx10+0.6123724356957944*rhouy[1]*ux[4]*dx10+0.6123724356957944*ux[1]*rhouy[4]*dx10+0.6123724356957944*rhouy[0]*ux[2]*dx10+0.6123724356957944*ux[0]*rhouy[2]*dx10+1.732050807568877*Pxy[2]*dx10; 
  outrhouy[5] += 0.6123724356957944*rhouy[6]*uz[7]*dx12+0.6123724356957944*uz[6]*rhouy[7]*dx12+0.6123724356957944*rhouy[3]*uz[5]*dx12+0.6123724356957944*uz[3]*rhouy[5]*dx12+0.6123724356957944*rhouy[2]*uz[4]*dx12+0.6123724356957944*uz[2]*rhouy[4]*dx12+0.6123724356957944*rhouy[0]*uz[1]*dx12+0.6123724356957944*uz[0]*rhouy[1]*dx12+1.732050807568877*Pyz[1]*dx12+0.6123724356957944*rhouy[4]*ux[7]*dx10+0.6123724356957944*ux[4]*rhouy[7]*dx10+0.6123724356957944*rhouy[2]*ux[6]*dx10+0.6123724356957944*ux[2]*rhouy[6]*dx10+0.6123724356957944*rhouy[1]*ux[5]*dx10+0.6123724356957944*ux[1]*rhouy[5]*dx10+0.6123724356957944*rhouy[0]*ux[3]*dx10+0.6123724356957944*ux[0]*rhouy[3]*dx10+1.732050807568877*Pxy[3]*dx10; 
  outrhouy[6] += 0.6123724356957944*rhouy[5]*uz[7]*dx12+0.6123724356957944*uz[5]*rhouy[7]*dx12+0.6123724356957944*rhouy[3]*uz[6]*dx12+0.6123724356957944*uz[3]*rhouy[6]*dx12+0.6123724356957944*rhouy[1]*uz[4]*dx12+0.6123724356957944*uz[1]*rhouy[4]*dx12+0.6123724356957944*rhouy[0]*uz[2]*dx12+0.6123724356957944*uz[0]*rhouy[2]*dx12+1.732050807568877*Pyz[2]*dx12+0.6123724356957944*rhouy[4]*uy[7]*dx11+0.6123724356957944*uy[4]*rhouy[7]*dx11+0.6123724356957944*rhouy[2]*uy[6]*dx11+0.6123724356957944*uy[2]*rhouy[6]*dx11+0.6123724356957944*rhouy[1]*uy[5]*dx11+0.6123724356957944*uy[1]*rhouy[5]*dx11+0.6123724356957944*rhouy[0]*uy[3]*dx11+0.6123724356957944*uy[0]*rhouy[3]*dx11+1.732050807568877*Pyy[3]*dx11; 
  outrhouy[7] += 0.6123724356957944*rhouy[3]*uz[7]*dx12+0.6123724356957944*uz[3]*rhouy[7]*dx12+0.6123724356957944*rhouy[5]*uz[6]*dx12+0.6123724356957944*uz[5]*rhouy[6]*dx12+0.6123724356957944*rhouy[0]*uz[4]*dx12+0.6123724356957944*uz[0]*rhouy[4]*dx12+1.732050807568877*Pyz[4]*dx12+0.6123724356957944*rhouy[1]*uz[2]*dx12+0.6123724356957944*uz[1]*rhouy[2]*dx12+0.6123724356957944*rhouy[2]*uy[7]*dx11+0.6123724356957944*uy[2]*rhouy[7]*dx11+0.6123724356957944*rhouy[4]*uy[6]*dx11+0.6123724356957944*uy[4]*rhouy[6]*dx11+0.6123724356957944*rhouy[0]*uy[5]*dx11+0.6123724356957944*uy[0]*rhouy[5]*dx11+1.732050807568877*Pyy[5]*dx11+0.6123724356957944*rhouy[1]*uy[3]*dx11+0.6123724356957944*uy[1]*rhouy[3]*dx11+0.6123724356957944*rhouy[1]*ux[7]*dx10+0.6123724356957944*ux[1]*rhouy[7]*dx10+0.6123724356957944*rhouy[0]*ux[6]*dx10+0.6123724356957944*ux[0]*rhouy[6]*dx10+1.732050807568877*Pxy[6]*dx10+0.6123724356957944*rhouy[4]*ux[5]*dx10+0.6123724356957944*ux[4]*rhouy[5]*dx10+0.6123724356957944*rhouy[2]*ux[3]*dx10+0.6123724356957944*ux[2]*rhouy[3]*dx10; 

  outrhouz[1] += 0.6123724356957944*rhouz[7]*ux[7]*dx10+0.6123724356957944*rhouz[6]*ux[6]*dx10+0.6123724356957944*rhouz[5]*ux[5]*dx10+0.6123724356957944*rhouz[4]*ux[4]*dx10+0.6123724356957944*rhouz[3]*ux[3]*dx10+0.6123724356957944*rhouz[2]*ux[2]*dx10+0.6123724356957944*rhouz[1]*ux[1]*dx10+0.6123724356957944*rhouz[0]*ux[0]*dx10+1.732050807568877*Pxz[0]*dx10; 
  outrhouz[2] += 0.6123724356957944*rhouz[7]*uy[7]*dx11+0.6123724356957944*rhouz[6]*uy[6]*dx11+0.6123724356957944*rhouz[5]*uy[5]*dx11+0.6123724356957944*rhouz[4]*uy[4]*dx11+0.6123724356957944*rhouz[3]*uy[3]*dx11+0.6123724356957944*rhouz[2]*uy[2]*dx11+0.6123724356957944*rhouz[1]*uy[1]*dx11+0.6123724356957944*rhouz[0]*uy[0]*dx11+1.732050807568877*Pyz[0]*dx11; 
  outrhouz[3] += 0.6123724356957944*rhouz[7]*uz[7]*dx12+0.6123724356957944*rhouz[6]*uz[6]*dx12+0.6123724356957944*rhouz[5]*uz[5]*dx12+0.6123724356957944*rhouz[4]*uz[4]*dx12+0.6123724356957944*rhouz[3]*uz[3]*dx12+0.6123724356957944*rhouz[2]*uz[2]*dx12+0.6123724356957944*rhouz[1]*uz[1]*dx12+0.6123724356957944*rhouz[0]*uz[0]*dx12+1.732050807568877*Pzz[0]*dx12; 
  outrhouz[4] += 0.6123724356957944*rhouz[6]*uy[7]*dx11+0.6123724356957944*uy[6]*rhouz[7]*dx11+0.6123724356957944*rhouz[3]*uy[5]*dx11+0.6123724356957944*uy[3]*rhouz[5]*dx11+0.6123724356957944*rhouz[2]*uy[4]*dx11+0.6123724356957944*uy[2]*rhouz[4]*dx11+0.6123724356957944*rhouz[0]*uy[1]*dx11+0.6123724356957944*uy[0]*rhouz[1]*dx11+1.732050807568877*Pyz[1]*dx11+0.6123724356957944*rhouz[5]*ux[7]*dx10+0.6123724356957944*ux[5]*rhouz[7]*dx10+0.6123724356957944*rhouz[3]*ux[6]*dx10+0.6123724356957944*ux[3]*rhouz[6]*dx10+0.6123724356957944*rhouz[1]*ux[4]*dx10+0.6123724356957944*ux[1]*rhouz[4]*dx10+0.6123724356957944*rhouz[0]*ux[2]*dx10+0.6123724356957944*ux[0]*rhouz[2]*dx10+1.732050807568877*Pxz[2]*dx10; 
  outrhouz[5] += 0.6123724356957944*rhouz[6]*uz[7]*dx12+0.6123724356957944*uz[6]*rhouz[7]*dx12+0.6123724356957944*rhouz[3]*uz[5]*dx12+0.6123724356957944*uz[3]*rhouz[5]*dx12+0.6123724356957944*rhouz[2]*uz[4]*dx12+0.6123724356957944*uz[2]*rhouz[4]*dx12+0.6123724356957944*rhouz[0]*uz[1]*dx12+0.6123724356957944*uz[0]*rhouz[1]*dx12+1.732050807568877*Pzz[1]*dx12+0.6123724356957944*rhouz[4]*ux[7]*dx10+0.6123724356957944*ux[4]*rhouz[7]*dx10+0.6123724356957944*rhouz[2]*ux[6]*dx10+0.6123724356957944*ux[2]*rhouz[6]*dx10+0.6123724356957944*rhouz[1]*ux[5]*dx10+0.6123724356957944*ux[1]*rhouz[5]*dx10+0.6123724356957944*rhouz[0]*ux[3]*dx10+0.6123724356957944*ux[0]*rhouz[3]*dx10+1.732050807568877*Pxz[3]*dx10; 
  outrhouz[6] += 0.6123724356957944*rhouz[5]*uz[7]*dx12+0.6123724356957944*uz[5]*rhouz[7]*dx12+0.6123724356957944*rhouz[3]*uz[6]*dx12+0.6123724356957944*uz[3]*rhouz[6]*dx12+0.6123724356957944*rhouz[1]*uz[4]*dx12+0.6123724356957944*uz[1]*rhouz[4]*dx12+0.6123724356957944*rhouz[0]*uz[2]*dx12+0.6123724356957944*uz[0]*rhouz[2]*dx12+1.732050807568877*Pzz[2]*dx12+0.6123724356957944*rhouz[4]*uy[7]*dx11+0.6123724356957944*uy[4]*rhouz[7]*dx11+0.6123724356957944*rhouz[2]*uy[6]*dx11+0.6123724356957944*uy[2]*rhouz[6]*dx11+0.6123724356957944*rhouz[1]*uy[5]*dx11+0.6123724356957944*uy[1]*rhouz[5]*dx11+0.6123724356957944*rhouz[0]*uy[3]*dx11+0.6123724356957944*uy[0]*rhouz[3]*dx11+1.732050807568877*Pyz[3]*dx11; 
  outrhouz[7] += 0.6123724356957944*rhouz[3]*uz[7]*dx12+0.6123724356957944*uz[3]*rhouz[7]*dx12+0.6123724356957944*rhouz[5]*uz[6]*dx12+0.6123724356957944*uz[5]*rhouz[6]*dx12+0.6123724356957944*rhouz[0]*uz[4]*dx12+0.6123724356957944*uz[0]*rhouz[4]*dx12+1.732050807568877*Pzz[4]*dx12+0.6123724356957944*rhouz[1]*uz[2]*dx12+0.6123724356957944*uz[1]*rhouz[2]*dx12+0.6123724356957944*rhouz[2]*uy[7]*dx11+0.6123724356957944*uy[2]*rhouz[7]*dx11+0.6123724356957944*rhouz[4]*uy[6]*dx11+0.6123724356957944*uy[4]*rhouz[6]*dx11+0.6123724356957944*rhouz[0]*uy[5]*dx11+0.6123724356957944*uy[0]*rhouz[5]*dx11+1.732050807568877*Pyz[5]*dx11+0.6123724356957944*rhouz[1]*uy[3]*dx11+0.6123724356957944*uy[1]*rhouz[3]*dx11+0.6123724356957944*rhouz[1]*ux[7]*dx10+0.6123724356957944*ux[1]*rhouz[7]*dx10+0.6123724356957944*rhouz[0]*ux[6]*dx10+0.6123724356957944*ux[0]*rhouz[6]*dx10+1.732050807568877*Pxz[6]*dx10+0.6123724356957944*rhouz[4]*ux[5]*dx10+0.6123724356957944*ux[4]*rhouz[5]*dx10+0.6123724356957944*rhouz[2]*ux[3]*dx10+0.6123724356957944*ux[2]*rhouz[3]*dx10; 

  return cflFreq_mid; 
} 
