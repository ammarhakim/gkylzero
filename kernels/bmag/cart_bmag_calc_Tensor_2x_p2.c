#include "gkyl_calc_cart_bmag_kernels.h"

static inline double magnitude(double B_R, double B_Z) 
{ double mag = 0;  mag = sqrt(B_R*B_R + B_Z*B_Z); return mag; } 

GKYL_CU_DH void cart_bmag_2x_Tensor_p2( const double **psibyr, const double *psibyr2, double *bmag_out, double *br_out, double *bz_out, double scale_factorR, double scale_factorZ) 
{ 
double B_R_n[9], B_Z_n[9], B_Z1_n[9], B_Z2_n[9]; 
const double *psibyrI = psibyr[0];
const double *psibyrL = psibyr[1];
const double *psibyrR = psibyr[2];
const double *psibyrB = psibyr[3];
const double *psibyrT = psibyr[4];
double bmag_n[9]; 
  B_R_n[0] = 1.5*psibyrI[8]-1.5*psibyrB[8]+1.77635683940025E-15*psibyrT[7]-1.161895003862242*psibyrI[7]+1.161895003862226*psibyrB[7]-1.77635683940025E-15*psibyrT[6]-2.662676050517599*psibyrI[6]-2.662676050517602*psibyrB[6]+0.6708203932499366*psibyrI[5]-0.6708203932499393*psibyrB[5]+2.096313728906043*psibyrI[4]-2.09631372890605*psibyrB[4]+2.0625*psibyrI[3]+2.0625*psibyrB[3]-1.190784930203603*psibyrI[2]-1.190784930203606*psibyrB[2]-1.623797632095826*psibyrI[1]+1.623797632095823*psibyrB[1]+0.9375*psibyrI[0]-0.9375*psibyrB[0]; 
  B_R_n[0] = B_R_n[0]*scale_factorZ; 
  B_Z1_n[0] = 1.5*psibyrL[8]-1.5*psibyrI[8]+1.77635683940025E-15*psibyrR[7]+2.662676050517602*psibyrL[7]+2.662676050517599*psibyrI[7]-1.77635683940025E-15*psibyrR[6]-1.161895003862226*psibyrL[6]+1.161895003862242*psibyrI[6]+2.09631372890605*psibyrL[5]-2.096313728906043*psibyrI[5]+0.6708203932499393*psibyrL[4]-0.6708203932499366*psibyrI[4]-2.0625*psibyrL[3]-2.0625*psibyrI[3]-1.623797632095823*psibyrL[2]+1.623797632095826*psibyrI[2]+1.190784930203606*psibyrL[1]+1.190784930203603*psibyrI[1]+0.9375*psibyrL[0]-0.9375*psibyrI[0]; 
  B_Z2_n[0] = (-2.5*psibyr2[8])+1.936491673103709*psibyr2[7]+1.936491673103709*psibyr2[6]-1.118033988749895*psibyr2[5]-1.118033988749895*psibyr2[4]-1.5*psibyr2[3]+0.8660254037844386*psibyr2[2]+0.8660254037844386*psibyr2[1]-0.5*psibyr2[0]; 
  B_Z_n[0] = B_Z1_n[0]*scale_factorR + B_Z2_n[0]; 
  bmag_n[0] = magnitude(B_R_n[0], B_Z_n[0]); 
  B_R_n[1] = (-0.75*psibyrI[8])+0.75*psibyrB[8]+8.881784197001252E-16*psibyrT[6]+1.331338025258801*psibyrI[6]+1.331338025258799*psibyrB[6]+0.6708203932499366*psibyrI[5]-0.6708203932499393*psibyrB[5]-1.048156864453022*psibyrI[4]+1.048156864453025*psibyrB[4]-1.190784930203603*psibyrI[2]-1.190784930203606*psibyrB[2]+0.9375*psibyrI[0]-0.9375*psibyrB[0]; 
  B_R_n[1] = B_R_n[1]*scale_factorZ; 
  B_Z1_n[1] = 0.744140625*psibyrR[8]-0.744140625*psibyrL[8]-0.9758102571499156*psibyrR[7]-0.9758102571499156*psibyrL[7]-4.523523517640695*psibyrI[7]-0.5764088495722758*psibyrR[6]+0.5764088495722758*psibyrL[6]+0.6550980402831419*psibyrR[5]-0.6550980402831419*psibyrL[5]+0.3327898044638359*psibyrR[4]-0.3327898044638359*psibyrL[4]+0.755859375*psibyrR[3]+0.755859375*psibyrL[3]+3.50390625*psibyrI[3]-0.5074367600299444*psibyrR[2]+0.5074367600299444*psibyrL[2]-0.4363956136257522*psibyrR[1]-0.4363956136257522*psibyrL[1]-2.022981216652712*psibyrI[1]+0.29296875*psibyrR[0]-0.29296875*psibyrL[0]; 
  B_Z2_n[1] = 1.25*psibyr2[8]-0.9682458365518543*psibyr2[6]-1.118033988749895*psibyr2[5]+0.5590169943749475*psibyr2[4]+0.8660254037844386*psibyr2[2]-0.5*psibyr2[0]; 
  B_Z_n[1] = B_Z1_n[1]*scale_factorR + B_Z2_n[1]; 
  bmag_n[1] = magnitude(B_R_n[1], B_Z_n[1]); 
  B_R_n[2] = 1.5*psibyrI[8]-1.5*psibyrB[8]-1.77635683940025E-15*psibyrT[7]+1.161895003862242*psibyrI[7]-1.161895003862226*psibyrB[7]-1.77635683940025E-15*psibyrT[6]-2.662676050517599*psibyrI[6]-2.662676050517602*psibyrB[6]+0.6708203932499366*psibyrI[5]-0.6708203932499393*psibyrB[5]+2.096313728906043*psibyrI[4]-2.09631372890605*psibyrB[4]-2.0625*psibyrI[3]-2.0625*psibyrB[3]-1.190784930203603*psibyrI[2]-1.190784930203606*psibyrB[2]+1.623797632095826*psibyrI[1]-1.623797632095823*psibyrB[1]+0.9375*psibyrI[0]-0.9375*psibyrB[0]; 
  B_R_n[2] = B_R_n[2]*scale_factorZ; 
  B_Z1_n[2] = (-1.5*psibyrR[8])+1.5*psibyrI[8]+2.662676050517602*psibyrR[7]+1.77635683940025E-15*psibyrL[7]+2.662676050517599*psibyrI[7]+1.161895003862226*psibyrR[6]+1.77635683940025E-15*psibyrL[6]-1.161895003862242*psibyrI[6]-2.09631372890605*psibyrR[5]+2.096313728906043*psibyrI[5]-0.6708203932499393*psibyrR[4]+0.6708203932499366*psibyrI[4]-2.0625*psibyrR[3]-2.0625*psibyrI[3]+1.623797632095823*psibyrR[2]-1.623797632095826*psibyrI[2]+1.190784930203606*psibyrR[1]+1.190784930203603*psibyrI[1]-0.9375*psibyrR[0]+0.9375*psibyrI[0]; 
  B_Z2_n[2] = (-2.5*psibyr2[8])-1.936491673103709*psibyr2[7]+1.936491673103709*psibyr2[6]-1.118033988749895*psibyr2[5]-1.118033988749895*psibyr2[4]+1.5*psibyr2[3]+0.8660254037844386*psibyr2[2]-0.8660254037844386*psibyr2[1]-0.5*psibyr2[0]; 
  B_Z_n[2] = B_Z1_n[2]*scale_factorR + B_Z2_n[2]; 
  bmag_n[2] = magnitude(B_R_n[2], B_Z_n[2]); 
  B_R_n[3] = (-0.744140625*psibyrT[8])+0.744140625*psibyrB[8]+0.5764088495722758*psibyrT[7]-0.5764088495722758*psibyrB[7]+0.9758102571499156*psibyrT[6]+4.523523517640695*psibyrI[6]+0.9758102571499156*psibyrB[6]-0.3327898044638359*psibyrT[5]+0.3327898044638359*psibyrB[5]-0.6550980402831419*psibyrT[4]+0.6550980402831419*psibyrB[4]-0.755859375*psibyrT[3]-3.50390625*psibyrI[3]-0.755859375*psibyrB[3]+0.4363956136257522*psibyrT[2]+2.022981216652712*psibyrI[2]+0.4363956136257522*psibyrB[2]+0.5074367600299444*psibyrT[1]-0.5074367600299444*psibyrB[1]-0.29296875*psibyrT[0]+0.29296875*psibyrB[0]; 
  B_R_n[3] = B_R_n[3]*scale_factorZ; 
  B_Z1_n[3] = (-0.75*psibyrL[8])+0.75*psibyrI[8]-8.881784197001252E-16*psibyrR[7]-1.331338025258799*psibyrL[7]-1.331338025258801*psibyrI[7]-1.048156864453025*psibyrL[5]+1.048156864453022*psibyrI[5]+0.6708203932499393*psibyrL[4]-0.6708203932499366*psibyrI[4]+1.190784930203606*psibyrL[1]+1.190784930203603*psibyrI[1]+0.9375*psibyrL[0]-0.9375*psibyrI[0]; 
  B_Z2_n[3] = 1.25*psibyr2[8]-0.9682458365518543*psibyr2[7]+0.5590169943749475*psibyr2[5]-1.118033988749895*psibyr2[4]+0.8660254037844386*psibyr2[1]-0.5*psibyr2[0]; 
  B_Z_n[3] = B_Z1_n[3]*scale_factorR + B_Z2_n[3]; 
  bmag_n[3] = magnitude(B_R_n[3], B_Z_n[3]); 
  B_R_n[4] = 0.3720703125*psibyrT[8]-0.3720703125*psibyrB[8]-0.4879051285749578*psibyrT[6]-2.261761758820347*psibyrI[6]-0.4879051285749578*psibyrB[6]-0.3327898044638359*psibyrT[5]+0.3327898044638359*psibyrB[5]+0.327549020141571*psibyrT[4]-0.327549020141571*psibyrB[4]+0.4363956136257522*psibyrT[2]+2.022981216652712*psibyrI[2]+0.4363956136257522*psibyrB[2]-0.29296875*psibyrT[0]+0.29296875*psibyrB[0]; 
  B_R_n[4] = B_R_n[4]*scale_factorZ; 
  B_Z1_n[4] = (-0.3720703125*psibyrR[8])+0.3720703125*psibyrL[8]+0.4879051285749578*psibyrR[7]+0.4879051285749578*psibyrL[7]+2.261761758820347*psibyrI[7]-0.327549020141571*psibyrR[5]+0.327549020141571*psibyrL[5]+0.3327898044638359*psibyrR[4]-0.3327898044638359*psibyrL[4]-0.4363956136257522*psibyrR[1]-0.4363956136257522*psibyrL[1]-2.022981216652712*psibyrI[1]+0.29296875*psibyrR[0]-0.29296875*psibyrL[0]; 
  B_Z2_n[4] = (-0.625*psibyr2[8])+0.5590169943749475*psibyr2[5]+0.5590169943749475*psibyr2[4]-0.5*psibyr2[0]; 
  B_Z_n[4] = B_Z1_n[4]*scale_factorR + B_Z2_n[4]; 
  bmag_n[4] = magnitude(B_R_n[4], B_Z_n[4]); 
  B_R_n[5] = (-0.744140625*psibyrT[8])+0.744140625*psibyrB[8]-0.5764088495722758*psibyrT[7]+0.5764088495722758*psibyrB[7]+0.9758102571499156*psibyrT[6]+4.523523517640695*psibyrI[6]+0.9758102571499156*psibyrB[6]-0.3327898044638359*psibyrT[5]+0.3327898044638359*psibyrB[5]-0.6550980402831419*psibyrT[4]+0.6550980402831419*psibyrB[4]+0.755859375*psibyrT[3]+3.50390625*psibyrI[3]+0.755859375*psibyrB[3]+0.4363956136257522*psibyrT[2]+2.022981216652712*psibyrI[2]+0.4363956136257522*psibyrB[2]-0.5074367600299444*psibyrT[1]+0.5074367600299444*psibyrB[1]-0.29296875*psibyrT[0]+0.29296875*psibyrB[0]; 
  B_R_n[5] = B_R_n[5]*scale_factorZ; 
  B_Z1_n[5] = 0.75*psibyrR[8]-0.75*psibyrI[8]-1.331338025258799*psibyrR[7]-8.881784197001252E-16*psibyrL[7]-1.331338025258801*psibyrI[7]+1.048156864453025*psibyrR[5]-1.048156864453022*psibyrI[5]-0.6708203932499393*psibyrR[4]+0.6708203932499366*psibyrI[4]+1.190784930203606*psibyrR[1]+1.190784930203603*psibyrI[1]-0.9375*psibyrR[0]+0.9375*psibyrI[0]; 
  B_Z2_n[5] = 1.25*psibyr2[8]+0.9682458365518543*psibyr2[7]+0.5590169943749475*psibyr2[5]-1.118033988749895*psibyr2[4]-0.8660254037844386*psibyr2[1]-0.5*psibyr2[0]; 
  B_Z_n[5] = B_Z1_n[5]*scale_factorR + B_Z2_n[5]; 
  bmag_n[5] = magnitude(B_R_n[5], B_Z_n[5]); 
  B_R_n[6] = 1.5*psibyrT[8]-1.5*psibyrI[8]-1.161895003862226*psibyrT[7]+1.161895003862242*psibyrI[7]-1.77635683940025E-15*psibyrB[7]-2.662676050517602*psibyrT[6]-2.662676050517599*psibyrI[6]-1.77635683940025E-15*psibyrB[6]+0.6708203932499393*psibyrT[5]-0.6708203932499366*psibyrI[5]+2.09631372890605*psibyrT[4]-2.096313728906043*psibyrI[4]+2.0625*psibyrT[3]+2.0625*psibyrI[3]-1.190784930203606*psibyrT[2]-1.190784930203603*psibyrI[2]-1.623797632095823*psibyrT[1]+1.623797632095826*psibyrI[1]+0.9375*psibyrT[0]-0.9375*psibyrI[0]; 
  B_R_n[6] = B_R_n[6]*scale_factorZ; 
  B_Z1_n[6] = 1.5*psibyrL[8]-1.5*psibyrI[8]+1.77635683940025E-15*psibyrR[7]+2.662676050517602*psibyrL[7]+2.662676050517599*psibyrI[7]+1.77635683940025E-15*psibyrR[6]+1.161895003862226*psibyrL[6]-1.161895003862242*psibyrI[6]+2.09631372890605*psibyrL[5]-2.096313728906043*psibyrI[5]+0.6708203932499393*psibyrL[4]-0.6708203932499366*psibyrI[4]+2.0625*psibyrL[3]+2.0625*psibyrI[3]+1.623797632095823*psibyrL[2]-1.623797632095826*psibyrI[2]+1.190784930203606*psibyrL[1]+1.190784930203603*psibyrI[1]+0.9375*psibyrL[0]-0.9375*psibyrI[0]; 
  B_Z2_n[6] = (-2.5*psibyr2[8])+1.936491673103709*psibyr2[7]-1.936491673103709*psibyr2[6]-1.118033988749895*psibyr2[5]-1.118033988749895*psibyr2[4]+1.5*psibyr2[3]-0.8660254037844386*psibyr2[2]+0.8660254037844386*psibyr2[1]-0.5*psibyr2[0]; 
  B_Z_n[6] = B_Z1_n[6]*scale_factorR + B_Z2_n[6]; 
  bmag_n[6] = magnitude(B_R_n[6], B_Z_n[6]); 
  B_R_n[7] = (-0.75*psibyrT[8])+0.75*psibyrI[8]+1.331338025258799*psibyrT[6]+1.331338025258801*psibyrI[6]+8.881784197001252E-16*psibyrB[6]+0.6708203932499393*psibyrT[5]-0.6708203932499366*psibyrI[5]-1.048156864453025*psibyrT[4]+1.048156864453022*psibyrI[4]-1.190784930203606*psibyrT[2]-1.190784930203603*psibyrI[2]+0.9375*psibyrT[0]-0.9375*psibyrI[0]; 
  B_R_n[7] = B_R_n[7]*scale_factorZ; 
  B_Z1_n[7] = 0.744140625*psibyrR[8]-0.744140625*psibyrL[8]-0.9758102571499156*psibyrR[7]-0.9758102571499156*psibyrL[7]-4.523523517640695*psibyrI[7]+0.5764088495722758*psibyrR[6]-0.5764088495722758*psibyrL[6]+0.6550980402831419*psibyrR[5]-0.6550980402831419*psibyrL[5]+0.3327898044638359*psibyrR[4]-0.3327898044638359*psibyrL[4]-0.755859375*psibyrR[3]-0.755859375*psibyrL[3]-3.50390625*psibyrI[3]+0.5074367600299444*psibyrR[2]-0.5074367600299444*psibyrL[2]-0.4363956136257522*psibyrR[1]-0.4363956136257522*psibyrL[1]-2.022981216652712*psibyrI[1]+0.29296875*psibyrR[0]-0.29296875*psibyrL[0]; 
  B_Z2_n[7] = 1.25*psibyr2[8]+0.9682458365518543*psibyr2[6]-1.118033988749895*psibyr2[5]+0.5590169943749475*psibyr2[4]-0.8660254037844386*psibyr2[2]-0.5*psibyr2[0]; 
  B_Z_n[7] = B_Z1_n[7]*scale_factorR + B_Z2_n[7]; 
  bmag_n[7] = magnitude(B_R_n[7], B_Z_n[7]); 
  B_R_n[8] = 1.5*psibyrT[8]-1.5*psibyrI[8]+1.161895003862226*psibyrT[7]-1.161895003862242*psibyrI[7]+1.77635683940025E-15*psibyrB[7]-2.662676050517602*psibyrT[6]-2.662676050517599*psibyrI[6]-1.77635683940025E-15*psibyrB[6]+0.6708203932499393*psibyrT[5]-0.6708203932499366*psibyrI[5]+2.09631372890605*psibyrT[4]-2.096313728906043*psibyrI[4]-2.0625*psibyrT[3]-2.0625*psibyrI[3]-1.190784930203606*psibyrT[2]-1.190784930203603*psibyrI[2]+1.623797632095823*psibyrT[1]-1.623797632095826*psibyrI[1]+0.9375*psibyrT[0]-0.9375*psibyrI[0]; 
  B_R_n[8] = B_R_n[8]*scale_factorZ; 
  B_Z1_n[8] = (-1.5*psibyrR[8])+1.5*psibyrI[8]+2.662676050517602*psibyrR[7]+1.77635683940025E-15*psibyrL[7]+2.662676050517599*psibyrI[7]-1.161895003862226*psibyrR[6]-1.77635683940025E-15*psibyrL[6]+1.161895003862242*psibyrI[6]-2.09631372890605*psibyrR[5]+2.096313728906043*psibyrI[5]-0.6708203932499393*psibyrR[4]+0.6708203932499366*psibyrI[4]+2.0625*psibyrR[3]+2.0625*psibyrI[3]-1.623797632095823*psibyrR[2]+1.623797632095826*psibyrI[2]+1.190784930203606*psibyrR[1]+1.190784930203603*psibyrI[1]-0.9375*psibyrR[0]+0.9375*psibyrI[0]; 
  B_Z2_n[8] = (-2.5*psibyr2[8])-1.936491673103709*psibyr2[7]-1.936491673103709*psibyr2[6]-1.118033988749895*psibyr2[5]-1.118033988749895*psibyr2[4]-1.5*psibyr2[3]-0.8660254037844386*psibyr2[2]-0.8660254037844386*psibyr2[1]-0.5*psibyr2[0]; 
  B_Z_n[8] = B_Z1_n[8]*scale_factorR + B_Z2_n[8]; 
  bmag_n[8] = magnitude(B_R_n[8], B_Z_n[8]); 
  bmag_out[0] = 0.05555555555555555*bmag_n[8]+0.2222222222222222*bmag_n[7]+0.05555555555555555*bmag_n[6]+0.2222222222222222*bmag_n[5]+0.8888888888888888*bmag_n[4]+0.2222222222222222*bmag_n[3]+0.05555555555555555*bmag_n[2]+0.2222222222222222*bmag_n[1]+0.05555555555555555*bmag_n[0]; 
  bmag_out[1] = 0.09622504486493764*bmag_n[8]-0.09622504486493764*bmag_n[6]+0.3849001794597506*bmag_n[5]-0.3849001794597506*bmag_n[3]+0.09622504486493764*bmag_n[2]-0.09622504486493764*bmag_n[0]; 
  bmag_out[2] = 0.09622504486493764*bmag_n[8]+0.3849001794597506*bmag_n[7]+0.09622504486493764*bmag_n[6]-0.09622504486493764*bmag_n[2]-0.3849001794597506*bmag_n[1]-0.09622504486493764*bmag_n[0]; 
  bmag_out[3] = 0.1666666666666667*bmag_n[8]-0.1666666666666667*bmag_n[6]-0.1666666666666667*bmag_n[2]+0.1666666666666667*bmag_n[0]; 
  bmag_out[4] = 0.04969039949999532*bmag_n[8]-0.09938079899999064*bmag_n[7]+0.04969039949999532*bmag_n[6]+0.1987615979999813*bmag_n[5]-0.3975231959999626*bmag_n[4]+0.1987615979999813*bmag_n[3]+0.04969039949999532*bmag_n[2]-0.09938079899999064*bmag_n[1]+0.04969039949999532*bmag_n[0]; 
  bmag_out[5] = 0.04969039949999532*bmag_n[8]+0.1987615979999813*bmag_n[7]+0.04969039949999532*bmag_n[6]-0.09938079899999064*bmag_n[5]-0.3975231959999626*bmag_n[4]-0.09938079899999064*bmag_n[3]+0.04969039949999532*bmag_n[2]+0.1987615979999813*bmag_n[1]+0.04969039949999532*bmag_n[0]; 
  bmag_out[6] = 0.08606629658238703*bmag_n[8]-0.1721325931647741*bmag_n[7]+0.08606629658238703*bmag_n[6]-0.08606629658238703*bmag_n[2]+0.1721325931647741*bmag_n[1]-0.08606629658238703*bmag_n[0]; 
  bmag_out[7] = 0.08606629658238703*bmag_n[8]-0.08606629658238703*bmag_n[6]-0.1721325931647741*bmag_n[5]+0.1721325931647741*bmag_n[3]+0.08606629658238703*bmag_n[2]-0.08606629658238703*bmag_n[0]; 
  bmag_out[8] = 0.04444444444444445*bmag_n[8]-0.08888888888888889*bmag_n[7]+0.04444444444444445*bmag_n[6]-0.08888888888888889*bmag_n[5]+0.1777777777777778*bmag_n[4]-0.08888888888888889*bmag_n[3]+0.04444444444444445*bmag_n[2]-0.08888888888888889*bmag_n[1]+0.04444444444444445*bmag_n[0]; 
  bz_out[0] = 0.05555555555555555*B_Z_n[8]+0.2222222222222222*B_Z_n[7]+0.05555555555555555*B_Z_n[6]+0.2222222222222222*B_Z_n[5]+0.8888888888888888*B_Z_n[4]+0.2222222222222222*B_Z_n[3]+0.05555555555555555*B_Z_n[2]+0.2222222222222222*B_Z_n[1]+0.05555555555555555*B_Z_n[0]; 
  bz_out[1] = 0.09622504486493764*B_Z_n[8]-0.09622504486493764*B_Z_n[6]+0.3849001794597506*B_Z_n[5]-0.3849001794597506*B_Z_n[3]+0.09622504486493764*B_Z_n[2]-0.09622504486493764*B_Z_n[0]; 
  bz_out[2] = 0.09622504486493764*B_Z_n[8]+0.3849001794597506*B_Z_n[7]+0.09622504486493764*B_Z_n[6]-0.09622504486493764*B_Z_n[2]-0.3849001794597506*B_Z_n[1]-0.09622504486493764*B_Z_n[0]; 
  bz_out[3] = 0.1666666666666667*B_Z_n[8]-0.1666666666666667*B_Z_n[6]-0.1666666666666667*B_Z_n[2]+0.1666666666666667*B_Z_n[0]; 
  bz_out[4] = 0.04969039949999532*B_Z_n[8]-0.09938079899999064*B_Z_n[7]+0.04969039949999532*B_Z_n[6]+0.1987615979999813*B_Z_n[5]-0.3975231959999626*B_Z_n[4]+0.1987615979999813*B_Z_n[3]+0.04969039949999532*B_Z_n[2]-0.09938079899999064*B_Z_n[1]+0.04969039949999532*B_Z_n[0]; 
  bz_out[5] = 0.04969039949999532*B_Z_n[8]+0.1987615979999813*B_Z_n[7]+0.04969039949999532*B_Z_n[6]-0.09938079899999064*B_Z_n[5]-0.3975231959999626*B_Z_n[4]-0.09938079899999064*B_Z_n[3]+0.04969039949999532*B_Z_n[2]+0.1987615979999813*B_Z_n[1]+0.04969039949999532*B_Z_n[0]; 
  bz_out[6] = 0.08606629658238703*B_Z_n[8]-0.1721325931647741*B_Z_n[7]+0.08606629658238703*B_Z_n[6]-0.08606629658238703*B_Z_n[2]+0.1721325931647741*B_Z_n[1]-0.08606629658238703*B_Z_n[0]; 
  bz_out[7] = 0.08606629658238703*B_Z_n[8]-0.08606629658238703*B_Z_n[6]-0.1721325931647741*B_Z_n[5]+0.1721325931647741*B_Z_n[3]+0.08606629658238703*B_Z_n[2]-0.08606629658238703*B_Z_n[0]; 
  bz_out[8] = 0.04444444444444445*B_Z_n[8]-0.08888888888888889*B_Z_n[7]+0.04444444444444445*B_Z_n[6]-0.08888888888888889*B_Z_n[5]+0.1777777777777778*B_Z_n[4]-0.08888888888888889*B_Z_n[3]+0.04444444444444445*B_Z_n[2]-0.08888888888888889*B_Z_n[1]+0.04444444444444445*B_Z_n[0]; 
  br_out[0] = 0.05555555555555555*B_R_n[8]+0.2222222222222222*B_R_n[7]+0.05555555555555555*B_R_n[6]+0.2222222222222222*B_R_n[5]+0.8888888888888888*B_R_n[4]+0.2222222222222222*B_R_n[3]+0.05555555555555555*B_R_n[2]+0.2222222222222222*B_R_n[1]+0.05555555555555555*B_R_n[0]; 
  br_out[1] = 0.09622504486493764*B_R_n[8]-0.09622504486493764*B_R_n[6]+0.3849001794597506*B_R_n[5]-0.3849001794597506*B_R_n[3]+0.09622504486493764*B_R_n[2]-0.09622504486493764*B_R_n[0]; 
  br_out[2] = 0.09622504486493764*B_R_n[8]+0.3849001794597506*B_R_n[7]+0.09622504486493764*B_R_n[6]-0.09622504486493764*B_R_n[2]-0.3849001794597506*B_R_n[1]-0.09622504486493764*B_R_n[0]; 
  br_out[3] = 0.1666666666666667*B_R_n[8]-0.1666666666666667*B_R_n[6]-0.1666666666666667*B_R_n[2]+0.1666666666666667*B_R_n[0]; 
  br_out[4] = 0.04969039949999532*B_R_n[8]-0.09938079899999064*B_R_n[7]+0.04969039949999532*B_R_n[6]+0.1987615979999813*B_R_n[5]-0.3975231959999626*B_R_n[4]+0.1987615979999813*B_R_n[3]+0.04969039949999532*B_R_n[2]-0.09938079899999064*B_R_n[1]+0.04969039949999532*B_R_n[0]; 
  br_out[5] = 0.04969039949999532*B_R_n[8]+0.1987615979999813*B_R_n[7]+0.04969039949999532*B_R_n[6]-0.09938079899999064*B_R_n[5]-0.3975231959999626*B_R_n[4]-0.09938079899999064*B_R_n[3]+0.04969039949999532*B_R_n[2]+0.1987615979999813*B_R_n[1]+0.04969039949999532*B_R_n[0]; 
  br_out[6] = 0.08606629658238703*B_R_n[8]-0.1721325931647741*B_R_n[7]+0.08606629658238703*B_R_n[6]-0.08606629658238703*B_R_n[2]+0.1721325931647741*B_R_n[1]-0.08606629658238703*B_R_n[0]; 
  br_out[7] = 0.08606629658238703*B_R_n[8]-0.08606629658238703*B_R_n[6]-0.1721325931647741*B_R_n[5]+0.1721325931647741*B_R_n[3]+0.08606629658238703*B_R_n[2]-0.08606629658238703*B_R_n[0]; 
  br_out[8] = 0.04444444444444445*B_R_n[8]-0.08888888888888889*B_R_n[7]+0.04444444444444445*B_R_n[6]-0.08888888888888889*B_R_n[5]+0.1777777777777778*B_R_n[4]-0.08888888888888889*B_R_n[3]+0.04444444444444445*B_R_n[2]-0.08888888888888889*B_R_n[1]+0.04444444444444445*B_R_n[0]; 
 
}
