#include <gkyl_advection_kernels.h> 
GKYL_CU_DH double advection_vol_2x_ser_p2(const double *w, const double *dxv, const double *u, const double *f, double* GKYL_RESTRICT out) 
{ 
  // w[NDIM]:   Cell-center coordinates.
  // dxv[NDIM]: Cell spacing.
  // u[NDIM]:   Advection velocity.
  // f:         Input function.
  // out:       Incremented output.
  const double rdx2 = 2.0/dxv[0]; 
  const double rdy2 = 2.0/dxv[1]; 
  double cflFreq_mid = 0.0; 
  cflFreq_mid += fabs((1.25*u[0]-1.397542485937369*(u[5]+u[4]))*rdx2); 
  cflFreq_mid += fabs((1.25*u[8]-1.397542485937369*(u[13]+u[12]))*rdy2); 

  out[1] += 0.8660254037844386*(f[7]*u[7]+f[6]*u[6]+f[5]*u[5]+f[4]*u[4]+f[3]*u[3]+f[2]*u[2]+f[1]*u[1]+f[0]*u[0])*rdx2; 
  out[2] += 0.8660254037844386*(f[7]*u[15]+f[6]*u[14]+f[5]*u[13]+f[4]*u[12]+f[3]*u[11]+f[2]*u[10]+f[1]*u[9]+f[0]*u[8])*rdy2; 
  out[3] += (0.8660254037844387*f[5]*u[15]+0.7745966692414834*f[3]*u[14]+0.8660254037844387*f[7]*u[13]+0.7745966692414833*f[1]*u[12]+0.8660254037844386*(f[2]*u[11]+f[3]*u[10]+f[0]*u[9]+f[1]*u[8])+0.7745966692414834*f[6]*u[11]+0.7745966692414833*f[4]*u[9])*rdy2+(0.7745966692414834*(f[3]*u[7]+u[3]*f[7])+0.8660254037844387*(f[4]*u[6]+u[4]*f[6])+0.7745966692414833*(f[2]*u[5]+u[2]*f[5])+0.8660254037844386*(f[1]*u[3]+u[1]*f[3]+f[0]*u[2]+u[0]*f[2]))*rdx2; 
  out[4] += (1.936491673103709*(f[5]*u[7]+u[5]*f[7])+1.732050807568877*(f[3]*u[6]+u[3]*f[6])+1.732050807568877*(f[1]*u[4]+u[1]*f[4])+1.936491673103709*(f[2]*u[3]+u[2]*f[3]+f[0]*u[1]+u[0]*f[1]))*rdx2; 
  out[5] += (1.732050807568877*f[3]*u[15]+1.936491673103709*f[4]*u[14]+1.732050807568877*f[2]*u[13]+1.936491673103709*f[6]*u[12]+(1.732050807568877*f[7]+1.936491673103709*f[1])*u[11]+1.732050807568877*f[5]*u[10]+1.936491673103709*(f[0]*u[10]+f[3]*u[9]+f[2]*u[8]))*rdy2; 
  out[6] += (0.7745966692414834*f[7]*u[15]+(0.5532833351724881*f[6]+0.8660254037844386*f[2])*u[14]+(0.5532833351724881*f[4]+0.8660254037844387*f[0])*u[12]+0.7745966692414834*f[3]*u[11]+0.8660254037844386*f[6]*u[10]+0.7745966692414834*f[1]*u[9]+0.8660254037844387*f[4]*u[8])*rdy2+(1.732050807568877*(f[2]*u[7]+u[2]*f[7]+f[1]*u[6]+u[1]*f[6])+1.549193338482967*(f[6]*u[7]+u[6]*f[7])+1.732050807568877*(f[3]*u[5]+u[3]*f[5]+f[3]*u[4]+u[3]*f[4])+1.936491673103709*(f[0]*u[3]+u[0]*f[3]+f[1]*u[2]+u[1]*f[2]))*rdx2; 
  out[7] += ((1.549193338482967*f[6]+1.732050807568877*f[2])*u[15]+(1.549193338482967*f[7]+1.732050807568877*f[1])*u[14]+1.732050807568877*f[3]*(u[13]+u[12])+(1.732050807568877*(f[5]+f[4])+1.936491673103709*f[0])*u[11]+1.732050807568877*(f[7]*u[10]+f[6]*u[9])+1.936491673103709*(f[1]*u[10]+f[2]*u[9]+f[3]*u[8]))*rdy2+(0.8660254037844386*(f[1]*u[7]+u[1]*f[7])+0.5532833351724881*f[7]*u[7]+0.7745966692414834*f[6]*u[6]+0.8660254037844387*(f[0]*u[5]+u[0]*f[5])+0.5532833351724881*f[5]*u[5]+0.7745966692414834*(f[3]*u[3]+f[2]*u[2]))*rdx2; 

  return cflFreq_mid; 
} 
