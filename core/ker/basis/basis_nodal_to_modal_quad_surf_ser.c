#include <gkyl_basis_ser_kernels.h>
GKYL_CU_DH
void
nodal_to_modal_quad_surfx_2d_ser_p1(const double *fnodal, double *fmodal)
{
  fmodal[0] = 0.5*(fnodal[3]+fnodal[2]+fnodal[1]+fnodal[0]); 
  fmodal[1] = 0.2886751345948129*fnodal[3]-0.2886751345948129*fnodal[2]+0.2886751345948129*fnodal[1]-0.2886751345948129*fnodal[0]; 
  fmodal[2] = 0.5*(fnodal[3]+fnodal[2])-0.5*(fnodal[1]+fnodal[0]); 
  fmodal[3] = 0.2886751345948129*fnodal[3]-0.2886751345948129*(fnodal[2]+fnodal[1])+0.2886751345948129*fnodal[0]; 
}

GKYL_CU_DH
void
nodal_to_modal_quad_surfy_2d_ser_p1(const double *fnodal, double *fmodal)
{
  fmodal[0] = 0.5*(fnodal[3]+fnodal[2]+fnodal[1]+fnodal[0]); 
  fmodal[1] = 0.5*fnodal[3]-0.5*fnodal[2]+0.5*fnodal[1]-0.5*fnodal[0]; 
  fmodal[2] = 0.2886751345948129*(fnodal[3]+fnodal[2])-0.2886751345948129*(fnodal[1]+fnodal[0]); 
  fmodal[3] = 0.2886751345948129*fnodal[3]-0.2886751345948129*(fnodal[2]+fnodal[1])+0.2886751345948129*fnodal[0]; 
}

GKYL_CU_DH
void
nodal_to_modal_quad_surfx_2d_ser_p2(const double *fnodal, double *fmodal)
{
  fmodal[0] = (-0.05555555555555554*fnodal[7])+0.6666666666666666*fnodal[6]-0.05555555555555556*fnodal[5]+0.4444444444444445*fnodal[4]+0.4444444444444444*fnodal[3]-0.05555555555555554*fnodal[2]+0.6666666666666666*fnodal[1]-0.05555555555555554*fnodal[0]; 
  fmodal[1] = 0.1603750747748962*fnodal[7]-0.1603750747748961*fnodal[5]+0.2566001196398338*fnodal[4]-0.2566001196398338*fnodal[3]+0.1603750747748962*fnodal[2]-0.1603750747748962*fnodal[0]; 
  fmodal[2] = 0.1242259987499883*fnodal[7]+0.4969039949999532*fnodal[6]+0.1242259987499883*fnodal[5]-0.1242259987499883*fnodal[2]-0.4969039949999532*fnodal[1]-0.1242259987499883*fnodal[0]; 
  fmodal[3] = 0.2151657414559678*fnodal[7]-0.2151657414559678*fnodal[5]-0.2151657414559678*fnodal[2]+0.2151657414559678*fnodal[0]; 
  fmodal[4] = 0.149071198499986*fnodal[7]-0.2981423969999719*fnodal[6]+0.149071198499986*fnodal[5]+0.149071198499986*fnodal[2]-0.2981423969999719*fnodal[1]+0.149071198499986*fnodal[0]; 
  fmodal[5] = 0.2484519974999767*fnodal[7]+0.2484519974999767*fnodal[5]-0.4969039949999532*fnodal[4]-0.4969039949999532*fnodal[3]+0.2484519974999767*fnodal[2]+0.2484519974999767*fnodal[0]; 
  fmodal[6] = 0.1111111111111112*fnodal[7]-0.2222222222222225*fnodal[6]+0.1111111111111112*fnodal[5]-0.1111111111111112*fnodal[2]+0.2222222222222225*fnodal[1]-0.1111111111111112*fnodal[0]; 
  fmodal[7] = 0.1434438276373117*fnodal[7]-0.1434438276373117*fnodal[5]-0.2868876552746235*fnodal[4]+0.2868876552746235*fnodal[3]+0.1434438276373117*fnodal[2]-0.1434438276373117*fnodal[0]; 
}

GKYL_CU_DH
void
nodal_to_modal_quad_surfy_2d_ser_p2(const double *fnodal, double *fmodal)
{
  fmodal[0] = (-0.05555555555555557*fnodal[7])+0.4444444444444445*fnodal[6]-0.05555555555555555*fnodal[5]+0.6666666666666669*fnodal[4]+0.6666666666666667*fnodal[3]-0.05555555555555556*fnodal[2]+0.4444444444444446*fnodal[1]-0.05555555555555565*fnodal[0]; 
  fmodal[1] = 0.1242259987499883*fnodal[7]-0.1242259987499883*fnodal[5]+0.4969039949999531*fnodal[4]-0.4969039949999531*fnodal[3]+0.1242259987499883*fnodal[2]-0.1242259987499883*fnodal[0]; 
  fmodal[2] = 0.1603750747748962*fnodal[7]+0.256600119639834*fnodal[6]+0.1603750747748962*fnodal[5]-0.1603750747748961*fnodal[2]-0.256600119639834*fnodal[1]-0.1603750747748962*fnodal[0]; 
  fmodal[3] = 0.2151657414559678*fnodal[7]-0.2151657414559678*fnodal[5]-0.2151657414559678*fnodal[2]+0.2151657414559678*fnodal[0]; 
  fmodal[4] = 0.2484519974999766*fnodal[7]-0.4969039949999531*fnodal[6]+0.2484519974999766*fnodal[5]+0.2484519974999766*fnodal[2]-0.4969039949999531*fnodal[1]+0.2484519974999766*fnodal[0]; 
  fmodal[5] = 0.149071198499986*fnodal[7]+0.149071198499986*fnodal[5]-0.2981423969999719*fnodal[4]-0.2981423969999719*fnodal[3]+0.149071198499986*fnodal[2]+0.149071198499986*fnodal[0]; 
  fmodal[6] = 0.1434438276373118*fnodal[7]-0.2868876552746236*fnodal[6]+0.1434438276373117*fnodal[5]+1.387778780781446e-17*fnodal[3]-0.1434438276373118*fnodal[2]+0.2868876552746237*fnodal[1]-0.1434438276373118*fnodal[0]; 
  fmodal[7] = 0.1111111111111112*fnodal[7]-0.1111111111111112*fnodal[5]-0.2222222222222224*fnodal[4]+0.2222222222222224*fnodal[3]+0.1111111111111112*fnodal[2]-0.1111111111111112*fnodal[0]; 
}

GKYL_CU_DH
void
nodal_to_modal_quad_surfx_3d_ser_p1(const double *fnodal, double *fmodal)
{
  fmodal[0] = 0.3535533905932739*fnodal[7]+0.3535533905932738*fnodal[6]+0.3535533905932739*fnodal[5]+0.3535533905932738*(fnodal[4]+fnodal[3])+0.3535533905932739*fnodal[2]+0.3535533905932738*(fnodal[1]+fnodal[0]); 
  fmodal[1] = 0.2041241452319316*fnodal[7]-0.2041241452319316*fnodal[6]+0.2041241452319316*fnodal[5]-0.2041241452319316*fnodal[4]+0.2041241452319316*fnodal[3]-0.2041241452319316*fnodal[2]+0.2041241452319316*fnodal[1]-0.2041241452319316*fnodal[0]; 
  fmodal[2] = 0.3535533905932738*(fnodal[7]+fnodal[6])-0.3535533905932738*(fnodal[5]+fnodal[4])+0.3535533905932739*(fnodal[3]+fnodal[2])-0.3535533905932739*(fnodal[1]+fnodal[0]); 
  fmodal[3] = 0.3535533905932738*(fnodal[7]+fnodal[6]+fnodal[5]+fnodal[4])-0.3535533905932739*(fnodal[3]+fnodal[2]+fnodal[1]+fnodal[0]); 
  fmodal[4] = 0.2041241452319316*fnodal[7]-0.2041241452319316*(fnodal[6]+fnodal[5])+0.2041241452319316*fnodal[4]+0.2041241452319316*fnodal[3]-0.2041241452319316*(fnodal[2]+fnodal[1])+0.2041241452319316*fnodal[0]; 
  fmodal[5] = 0.2041241452319316*fnodal[7]-0.2041241452319316*fnodal[6]+0.2041241452319316*fnodal[5]-0.2041241452319316*fnodal[4]-0.2041241452319316*fnodal[3]+0.2041241452319316*fnodal[2]-0.2041241452319316*fnodal[1]+0.2041241452319316*fnodal[0]; 
  fmodal[6] = 0.3535533905932738*(fnodal[7]+fnodal[6])-0.3535533905932739*(fnodal[5]+fnodal[4])-0.3535533905932738*(fnodal[3]+fnodal[2])+0.3535533905932739*(fnodal[1]+fnodal[0]); 
  fmodal[7] = 0.2041241452319316*fnodal[7]-0.2041241452319316*fnodal[6]-0.2041241452319316*fnodal[5]+0.2041241452319316*fnodal[4]-0.2041241452319316*fnodal[3]+0.2041241452319316*fnodal[2]+0.2041241452319316*fnodal[1]-0.2041241452319316*fnodal[0]; 
}

GKYL_CU_DH
void
nodal_to_modal_quad_surfy_3d_ser_p1(const double *fnodal, double *fmodal)
{
  fmodal[0] = 0.3535533905932738*(fnodal[7]+fnodal[6]+fnodal[5]+fnodal[4]+fnodal[3]+fnodal[2]+fnodal[1]+fnodal[0]); 
  fmodal[1] = 0.3535533905932738*fnodal[7]-0.3535533905932738*fnodal[6]+0.3535533905932738*fnodal[5]-0.3535533905932738*fnodal[4]+0.3535533905932738*fnodal[3]-0.3535533905932738*fnodal[2]+0.3535533905932738*fnodal[1]-0.3535533905932738*fnodal[0]; 
  fmodal[2] = 0.2041241452319315*(fnodal[7]+fnodal[6])-0.2041241452319315*(fnodal[5]+fnodal[4])+0.2041241452319315*(fnodal[3]+fnodal[2])-0.2041241452319315*(fnodal[1]+fnodal[0]); 
  fmodal[3] = 0.3535533905932738*(fnodal[7]+fnodal[6]+fnodal[5]+fnodal[4])-0.3535533905932738*fnodal[3]-0.3535533905932738*fnodal[2]-0.3535533905932738*(fnodal[1]+fnodal[0]); 
  fmodal[4] = 0.2041241452319315*fnodal[7]-0.2041241452319315*(fnodal[6]+fnodal[5])+0.2041241452319315*(fnodal[4]+fnodal[3])-0.2041241452319316*fnodal[2]-0.2041241452319315*fnodal[1]+0.2041241452319315*fnodal[0]; 
  fmodal[5] = 0.3535533905932738*fnodal[7]-0.3535533905932738*fnodal[6]+0.3535533905932738*fnodal[5]-0.3535533905932738*(fnodal[4]+fnodal[3])+0.3535533905932738*fnodal[2]-0.3535533905932738*fnodal[1]+0.3535533905932738*fnodal[0]; 
  fmodal[6] = 0.2041241452319315*fnodal[7]+0.2041241452319315*fnodal[6]-0.2041241452319315*fnodal[5]-0.2041241452319315*(fnodal[4]+fnodal[3]+fnodal[2])+0.2041241452319315*(fnodal[1]+fnodal[0]); 
  fmodal[7] = 0.2041241452319315*fnodal[7]-0.2041241452319315*fnodal[6]-0.2041241452319315*fnodal[5]+0.2041241452319315*fnodal[4]-0.2041241452319315*fnodal[3]+0.2041241452319315*(fnodal[2]+fnodal[1])-0.2041241452319315*fnodal[0]; 
}

GKYL_CU_DH
void
nodal_to_modal_quad_surfz_3d_ser_p1(const double *fnodal, double *fmodal)
{
  fmodal[0] = 0.353553390593274*fnodal[7]+0.353553390593274*(fnodal[6]+fnodal[5]+fnodal[4])+0.3535533905932739*fnodal[3]+0.353553390593274*fnodal[2]+0.3535533905932739*(fnodal[1]+fnodal[0]); 
  fmodal[1] = 0.353553390593274*fnodal[7]-0.353553390593274*fnodal[6]+0.353553390593274*fnodal[5]-0.353553390593274*fnodal[4]+0.3535533905932739*fnodal[3]-0.353553390593274*fnodal[2]+0.3535533905932739*fnodal[1]-0.3535533905932739*fnodal[0]; 
  fmodal[2] = 0.353553390593274*(fnodal[7]+fnodal[6])-0.3535533905932741*fnodal[5]-0.353553390593274*fnodal[4]+0.3535533905932739*(fnodal[3]+fnodal[2])-0.3535533905932739*(fnodal[1]+fnodal[0]); 
  fmodal[3] = 0.2041241452319316*fnodal[7]+0.2041241452319316*(fnodal[6]+fnodal[5])+0.2041241452319316*fnodal[4]-0.2041241452319316*fnodal[3]-0.2041241452319316*fnodal[2]-0.2041241452319316*(fnodal[1]+fnodal[0]); 
  fmodal[4] = 0.353553390593274*fnodal[7]-0.3535533905932741*fnodal[6]-0.353553390593274*fnodal[5]+0.353553390593274*fnodal[4]+0.3535533905932739*fnodal[3]-0.3535533905932739*(fnodal[2]+fnodal[1])+0.3535533905932739*fnodal[0]; 
  fmodal[5] = 0.2041241452319316*fnodal[7]-0.2041241452319316*fnodal[6]+0.2041241452319316*fnodal[5]-0.2041241452319316*fnodal[4]-0.2041241452319316*fnodal[3]+0.2041241452319316*fnodal[2]-0.2041241452319316*fnodal[1]+0.2041241452319316*fnodal[0]; 
  fmodal[6] = 0.2041241452319316*fnodal[7]+0.2041241452319316*fnodal[6]-0.2041241452319316*fnodal[5]-0.2041241452319316*fnodal[4]-0.2041241452319316*(fnodal[3]+fnodal[2])+0.2041241452319316*(fnodal[1]+fnodal[0]); 
  fmodal[7] = 0.2041241452319316*fnodal[7]-0.2041241452319316*fnodal[6]-0.2041241452319316*fnodal[5]+0.2041241452319316*fnodal[4]-0.2041241452319316*fnodal[3]+0.2041241452319316*(fnodal[2]+fnodal[1])-0.2041241452319316*fnodal[0]; 
}

GKYL_CU_DH
void
nodal_to_modal_quad_surfx_3d_ser_p2(const double *fnodal, double *fmodal)
{
  fmodal[0] = (-0.1964185503295965*fnodal[19])+0.4714045207910317*fnodal[18]-0.1964185503295965*fnodal[17]+0.3142696805273545*fnodal[16]+0.3142696805273545*fnodal[15]-0.1964185503295965*fnodal[14]+0.4714045207910317*fnodal[13]-0.1964185503295965*fnodal[12]+0.3142696805273545*fnodal[11]+0.3142696805273545*fnodal[10]+0.3142696805273545*fnodal[9]+0.3142696805273545*fnodal[8]-0.1964185503295965*fnodal[7]+0.4714045207910317*fnodal[6]-0.1964185503295965*fnodal[5]+0.3142696805273545*fnodal[4]+0.3142696805273545*fnodal[3]-0.1964185503295965*fnodal[2]+0.4714045207910317*fnodal[1]-0.1964185503295965*fnodal[0]; 
  fmodal[1] = 0.02268046058132573*fnodal[19]-0.02268046058132573*fnodal[17]+0.1814436846506059*fnodal[16]-0.1814436846506059*fnodal[15]+0.02268046058132573*fnodal[14]-0.02268046058132573*fnodal[12]+0.1814436846506059*fnodal[11]-0.1814436846506059*fnodal[10]+0.1814436846506059*fnodal[9]-0.1814436846506059*fnodal[8]+0.02268046058132573*fnodal[7]-0.02268046058132573*fnodal[5]+0.1814436846506059*fnodal[4]-0.1814436846506059*fnodal[3]+0.02268046058132573*fnodal[2]-0.02268046058132573*fnodal[0]; 
  fmodal[2] = (-0.02928034870526278*fnodal[19])+0.3513641844631533*fnodal[18]-0.02928034870526278*fnodal[17]+0.02928034870526278*fnodal[14]-0.3513641844631533*fnodal[13]+0.02928034870526278*fnodal[12]+0.2342427896421021*fnodal[11]+0.2342427896421021*fnodal[10]-0.2342427896421021*fnodal[9]-0.2342427896421021*fnodal[8]-0.02928034870526278*fnodal[7]+0.3513641844631533*fnodal[6]-0.02928034870526278*fnodal[5]+0.02928034870526278*fnodal[2]-0.3513641844631533*fnodal[1]+0.02928034870526278*fnodal[0]; 
  fmodal[3] = (-0.0292803487052628*fnodal[19])+0.3513641844631533*fnodal[18]-0.0292803487052628*fnodal[17]+0.2342427896421022*fnodal[16]+0.2342427896421022*fnodal[15]-0.0292803487052628*fnodal[14]+0.3513641844631533*fnodal[13]-0.0292803487052628*fnodal[12]+0.0292803487052628*fnodal[7]-0.3513641844631533*fnodal[6]+0.0292803487052628*fnodal[5]-0.2342427896421022*fnodal[4]-0.2342427896421022*fnodal[3]+0.0292803487052628*fnodal[2]-0.3513641844631533*fnodal[1]+0.0292803487052628*fnodal[0]; 
  fmodal[4] = 0.08452508603474788*fnodal[19]-0.08452508603474788*fnodal[17]-0.08452508603474788*fnodal[14]+0.08452508603474788*fnodal[12]+0.1352401376555965*fnodal[11]-0.1352401376555965*fnodal[10]-0.1352401376555965*fnodal[9]+0.1352401376555965*fnodal[8]+0.08452508603474788*fnodal[7]-0.08452508603474788*fnodal[5]-0.08452508603474788*fnodal[2]+0.08452508603474788*fnodal[0]; 
  fmodal[5] = 0.08452508603474788*fnodal[19]-0.08452508603474788*fnodal[17]+0.1352401376555966*fnodal[16]-0.1352401376555966*fnodal[15]+0.08452508603474788*fnodal[14]-0.08452508603474788*fnodal[12]-0.08452508603474788*fnodal[7]+0.08452508603474788*fnodal[5]-0.1352401376555966*fnodal[4]+0.1352401376555966*fnodal[3]-0.08452508603474788*fnodal[2]+0.08452508603474788*fnodal[0]; 
  fmodal[6] = 0.06547285010986549*fnodal[19]+0.2618914004394621*fnodal[18]+0.06547285010986549*fnodal[17]-0.06547285010986549*fnodal[14]-0.2618914004394621*fnodal[13]-0.06547285010986549*fnodal[12]-0.06547285010986549*fnodal[7]-0.2618914004394621*fnodal[6]-0.06547285010986549*fnodal[5]+0.06547285010986549*fnodal[2]+0.2618914004394621*fnodal[1]+0.06547285010986549*fnodal[0]; 
  fmodal[7] = 0.105409255338946*fnodal[19]-0.210818510677892*fnodal[18]+0.105409255338946*fnodal[17]+0.105409255338946*fnodal[14]-0.210818510677892*fnodal[13]+0.105409255338946*fnodal[12]+0.105409255338946*fnodal[7]-0.210818510677892*fnodal[6]+0.105409255338946*fnodal[5]+0.105409255338946*fnodal[2]-0.210818510677892*fnodal[1]+0.105409255338946*fnodal[0]; 
  fmodal[8] = 0.1756820922315766*fnodal[19]+0.1756820922315766*fnodal[17]-0.3513641844631533*fnodal[16]-0.3513641844631533*fnodal[15]+0.1756820922315766*fnodal[14]+0.1756820922315766*fnodal[12]+0.1756820922315766*fnodal[7]+0.1756820922315766*fnodal[5]-0.3513641844631533*fnodal[4]-0.3513641844631533*fnodal[3]+0.1756820922315766*fnodal[2]+0.1756820922315766*fnodal[0]; 
  fmodal[9] = 0.1756820922315766*fnodal[19]+0.1756820922315766*fnodal[17]+0.1756820922315766*fnodal[14]+0.1756820922315766*fnodal[12]-0.3513641844631533*fnodal[11]-0.3513641844631533*fnodal[10]-0.3513641844631533*fnodal[9]-0.3513641844631533*fnodal[8]+0.1756820922315766*fnodal[7]+0.1756820922315766*fnodal[5]+0.1756820922315766*fnodal[2]+0.1756820922315766*fnodal[0]; 
  fmodal[10] = 0.1134023029066286*fnodal[19]-0.1134023029066286*fnodal[17]-0.1134023029066286*fnodal[14]+0.1134023029066286*fnodal[12]-0.1134023029066286*fnodal[7]+0.1134023029066286*fnodal[5]+0.1134023029066286*fnodal[2]-0.1134023029066286*fnodal[0]; 
  fmodal[11] = 0.07856742013183861*fnodal[19]-0.1571348402636772*fnodal[18]+0.07856742013183861*fnodal[17]-0.07856742013183861*fnodal[14]+0.1571348402636772*fnodal[13]-0.07856742013183861*fnodal[12]+0.07856742013183861*fnodal[7]-0.1571348402636772*fnodal[6]+0.07856742013183861*fnodal[5]-0.07856742013183861*fnodal[2]+0.1571348402636772*fnodal[1]-0.07856742013183861*fnodal[0]; 
  fmodal[12] = 0.1014301032416974*fnodal[19]-0.1014301032416974*fnodal[17]-0.2028602064833949*fnodal[16]+0.2028602064833949*fnodal[15]+0.1014301032416974*fnodal[14]-0.1014301032416974*fnodal[12]+0.1014301032416974*fnodal[7]-0.1014301032416974*fnodal[5]-0.2028602064833949*fnodal[4]+0.2028602064833949*fnodal[3]+0.1014301032416974*fnodal[2]-0.1014301032416974*fnodal[0]; 
  fmodal[13] = 0.07856742013183861*fnodal[19]-0.1571348402636772*fnodal[18]+0.07856742013183861*fnodal[17]+0.07856742013183861*fnodal[14]-0.1571348402636772*fnodal[13]+0.07856742013183861*fnodal[12]-0.07856742013183861*fnodal[7]+0.1571348402636772*fnodal[6]-0.07856742013183861*fnodal[5]-0.07856742013183861*fnodal[2]+0.1571348402636772*fnodal[1]-0.07856742013183861*fnodal[0]; 
  fmodal[14] = 0.1309457002197311*fnodal[19]+0.1309457002197311*fnodal[17]-0.2618914004394622*fnodal[16]-0.2618914004394622*fnodal[15]+0.1309457002197311*fnodal[14]+0.1309457002197311*fnodal[12]-0.1309457002197311*fnodal[7]-0.1309457002197311*fnodal[5]+0.2618914004394622*fnodal[4]+0.2618914004394622*fnodal[3]-0.1309457002197311*fnodal[2]-0.1309457002197311*fnodal[0]; 
  fmodal[15] = 0.1014301032416974*fnodal[19]-0.1014301032416974*fnodal[17]+0.1014301032416974*fnodal[14]-0.1014301032416974*fnodal[12]-0.2028602064833949*fnodal[11]+0.2028602064833949*fnodal[10]-0.2028602064833949*fnodal[9]+0.2028602064833949*fnodal[8]+0.1014301032416974*fnodal[7]-0.1014301032416974*fnodal[5]+0.1014301032416974*fnodal[2]-0.1014301032416974*fnodal[0]; 
  fmodal[16] = 0.1309457002197311*fnodal[19]+0.1309457002197311*fnodal[17]-0.1309457002197311*fnodal[14]-0.1309457002197311*fnodal[12]-0.2618914004394622*fnodal[11]-0.2618914004394622*fnodal[10]+0.2618914004394622*fnodal[9]+0.2618914004394622*fnodal[8]+0.1309457002197311*fnodal[7]+0.1309457002197311*fnodal[5]-0.1309457002197311*fnodal[2]-0.1309457002197311*fnodal[0]; 
  fmodal[17] = 0.05856069741052554*fnodal[19]-0.1171213948210511*fnodal[18]+0.05856069741052554*fnodal[17]-0.05856069741052554*fnodal[14]+0.1171213948210511*fnodal[13]-0.05856069741052554*fnodal[12]-0.05856069741052554*fnodal[7]+0.1171213948210511*fnodal[6]-0.05856069741052554*fnodal[5]+0.05856069741052554*fnodal[2]-0.1171213948210511*fnodal[1]+0.05856069741052554*fnodal[0]; 
  fmodal[18] = 0.07560153527108576*fnodal[19]-0.07560153527108576*fnodal[17]-0.1512030705421716*fnodal[16]+0.1512030705421716*fnodal[15]+0.07560153527108576*fnodal[14]-0.07560153527108576*fnodal[12]-0.07560153527108576*fnodal[7]+0.07560153527108576*fnodal[5]+0.1512030705421716*fnodal[4]-0.1512030705421716*fnodal[3]-0.07560153527108576*fnodal[2]+0.07560153527108576*fnodal[0]; 
  fmodal[19] = 0.07560153527108576*fnodal[19]-0.07560153527108576*fnodal[17]-0.07560153527108576*fnodal[14]+0.07560153527108576*fnodal[12]-0.1512030705421716*fnodal[11]+0.1512030705421716*fnodal[10]+0.1512030705421716*fnodal[9]-0.1512030705421716*fnodal[8]+0.07560153527108576*fnodal[7]-0.07560153527108576*fnodal[5]-0.07560153527108576*fnodal[2]+0.07560153527108576*fnodal[0]; 
}

GKYL_CU_DH
void
nodal_to_modal_quad_surfy_3d_ser_p2(const double *fnodal, double *fmodal)
{
  fmodal[0] = (-0.1964185503295965*fnodal[19])+0.3142696805273545*fnodal[18]-0.1964185503295965*fnodal[17]+0.4714045207910317*fnodal[16]+0.4714045207910317*fnodal[15]-0.1964185503295965*fnodal[14]+0.3142696805273545*fnodal[13]-0.1964185503295965*fnodal[12]+0.3142696805273545*fnodal[11]+0.3142696805273545*fnodal[10]+0.3142696805273545*fnodal[9]+0.3142696805273545*fnodal[8]-0.1964185503295965*fnodal[7]+0.3142696805273545*fnodal[6]-0.1964185503295965*fnodal[5]+0.4714045207910317*fnodal[4]+0.4714045207910317*fnodal[3]-0.1964185503295965*fnodal[2]+0.3142696805273545*fnodal[1]-0.1964185503295965*fnodal[0]; 
  fmodal[1] = (-0.02928034870526278*fnodal[19])+0.02928034870526278*fnodal[17]+0.3513641844631533*fnodal[16]-0.3513641844631533*fnodal[15]-0.02928034870526278*fnodal[14]+0.02928034870526278*fnodal[12]+0.2342427896421021*fnodal[11]-0.2342427896421021*fnodal[10]+0.2342427896421021*fnodal[9]-0.2342427896421021*fnodal[8]-0.02928034870526278*fnodal[7]+0.02928034870526278*fnodal[5]+0.3513641844631533*fnodal[4]-0.3513641844631533*fnodal[3]-0.02928034870526278*fnodal[2]+0.02928034870526278*fnodal[0]; 
  fmodal[2] = 0.02268046058132573*fnodal[19]+0.1814436846506059*fnodal[18]+0.02268046058132573*fnodal[17]-0.02268046058132573*fnodal[14]-0.1814436846506059*fnodal[13]-0.02268046058132573*fnodal[12]+0.1814436846506059*fnodal[11]+0.1814436846506059*fnodal[10]-0.1814436846506059*fnodal[9]-0.1814436846506059*fnodal[8]+0.02268046058132573*fnodal[7]+0.1814436846506059*fnodal[6]+0.02268046058132573*fnodal[5]-0.02268046058132573*fnodal[2]-0.1814436846506059*fnodal[1]-0.02268046058132573*fnodal[0]; 
  fmodal[3] = (-0.0292803487052628*fnodal[19])+0.2342427896421022*fnodal[18]-0.0292803487052628*fnodal[17]+0.3513641844631533*fnodal[16]+0.3513641844631533*fnodal[15]-0.0292803487052628*fnodal[14]+0.2342427896421022*fnodal[13]-0.0292803487052628*fnodal[12]+0.0292803487052628*fnodal[7]-0.2342427896421022*fnodal[6]+0.0292803487052628*fnodal[5]-0.3513641844631533*fnodal[4]-0.3513641844631533*fnodal[3]+0.0292803487052628*fnodal[2]-0.2342427896421022*fnodal[1]+0.0292803487052628*fnodal[0]; 
  fmodal[4] = 0.08452508603474788*fnodal[19]-0.08452508603474788*fnodal[17]-0.08452508603474788*fnodal[14]+0.08452508603474788*fnodal[12]+0.1352401376555965*fnodal[11]-0.1352401376555965*fnodal[10]-0.1352401376555965*fnodal[9]+0.1352401376555965*fnodal[8]+0.08452508603474788*fnodal[7]-0.08452508603474788*fnodal[5]-0.08452508603474788*fnodal[2]+0.08452508603474788*fnodal[0]; 
  fmodal[5] = 0.06547285010986549*fnodal[19]-0.06547285010986549*fnodal[17]+0.2618914004394621*fnodal[16]-0.2618914004394621*fnodal[15]+0.06547285010986549*fnodal[14]-0.06547285010986549*fnodal[12]-0.06547285010986549*fnodal[7]+0.06547285010986549*fnodal[5]-0.2618914004394621*fnodal[4]+0.2618914004394621*fnodal[3]-0.06547285010986549*fnodal[2]+0.06547285010986549*fnodal[0]; 
  fmodal[6] = 0.08452508603474788*fnodal[19]+0.1352401376555966*fnodal[18]+0.08452508603474788*fnodal[17]-0.08452508603474788*fnodal[14]-0.1352401376555966*fnodal[13]-0.08452508603474788*fnodal[12]-0.08452508603474788*fnodal[7]-0.1352401376555966*fnodal[6]-0.08452508603474788*fnodal[5]+0.08452508603474788*fnodal[2]+0.1352401376555966*fnodal[1]+0.08452508603474788*fnodal[0]; 
  fmodal[7] = 0.1756820922315766*fnodal[19]-0.3513641844631533*fnodal[18]+0.1756820922315766*fnodal[17]+0.1756820922315766*fnodal[14]-0.3513641844631533*fnodal[13]+0.1756820922315766*fnodal[12]+0.1756820922315766*fnodal[7]-0.3513641844631533*fnodal[6]+0.1756820922315766*fnodal[5]+0.1756820922315766*fnodal[2]-0.3513641844631533*fnodal[1]+0.1756820922315766*fnodal[0]; 
  fmodal[8] = 0.105409255338946*fnodal[19]+0.105409255338946*fnodal[17]-0.210818510677892*fnodal[16]-0.210818510677892*fnodal[15]+0.105409255338946*fnodal[14]+0.105409255338946*fnodal[12]+0.105409255338946*fnodal[7]+0.105409255338946*fnodal[5]-0.210818510677892*fnodal[4]-0.210818510677892*fnodal[3]+0.105409255338946*fnodal[2]+0.105409255338946*fnodal[0]; 
  fmodal[9] = 0.1756820922315766*fnodal[19]+0.1756820922315766*fnodal[17]+0.1756820922315766*fnodal[14]+0.1756820922315766*fnodal[12]-0.3513641844631533*fnodal[11]-0.3513641844631533*fnodal[10]-0.3513641844631533*fnodal[9]-0.3513641844631533*fnodal[8]+0.1756820922315766*fnodal[7]+0.1756820922315766*fnodal[5]+0.1756820922315766*fnodal[2]+0.1756820922315766*fnodal[0]; 
  fmodal[10] = 0.1134023029066286*fnodal[19]-0.1134023029066286*fnodal[17]-0.1134023029066286*fnodal[14]+0.1134023029066286*fnodal[12]-0.1134023029066286*fnodal[7]+0.1134023029066286*fnodal[5]+0.1134023029066286*fnodal[2]-0.1134023029066286*fnodal[0]; 
  fmodal[11] = 0.1014301032416974*fnodal[19]-0.2028602064833949*fnodal[18]+0.1014301032416974*fnodal[17]-0.1014301032416974*fnodal[14]+0.2028602064833949*fnodal[13]-0.1014301032416974*fnodal[12]+0.1014301032416974*fnodal[7]-0.2028602064833949*fnodal[6]+0.1014301032416974*fnodal[5]-0.1014301032416974*fnodal[2]+0.2028602064833949*fnodal[1]-0.1014301032416974*fnodal[0]; 
  fmodal[12] = 0.07856742013183861*fnodal[19]-0.07856742013183861*fnodal[17]-0.1571348402636772*fnodal[16]+0.1571348402636772*fnodal[15]+0.07856742013183861*fnodal[14]-0.07856742013183861*fnodal[12]+0.07856742013183861*fnodal[7]-0.07856742013183861*fnodal[5]-0.1571348402636772*fnodal[4]+0.1571348402636772*fnodal[3]+0.07856742013183861*fnodal[2]-0.07856742013183861*fnodal[0]; 
  fmodal[13] = 0.1309457002197311*fnodal[19]-0.2618914004394622*fnodal[18]+0.1309457002197311*fnodal[17]+0.1309457002197311*fnodal[14]-0.2618914004394622*fnodal[13]+0.1309457002197311*fnodal[12]-0.1309457002197311*fnodal[7]+0.2618914004394622*fnodal[6]-0.1309457002197311*fnodal[5]-0.1309457002197311*fnodal[2]+0.2618914004394622*fnodal[1]-0.1309457002197311*fnodal[0]; 
  fmodal[14] = 0.07856742013183861*fnodal[19]+0.07856742013183861*fnodal[17]-0.1571348402636772*fnodal[16]-0.1571348402636772*fnodal[15]+0.07856742013183861*fnodal[14]+0.07856742013183861*fnodal[12]-0.07856742013183861*fnodal[7]-0.07856742013183861*fnodal[5]+0.1571348402636772*fnodal[4]+0.1571348402636772*fnodal[3]-0.07856742013183861*fnodal[2]-0.07856742013183861*fnodal[0]; 
  fmodal[15] = 0.1309457002197311*fnodal[19]-0.1309457002197311*fnodal[17]+0.1309457002197311*fnodal[14]-0.1309457002197311*fnodal[12]-0.2618914004394622*fnodal[11]+0.2618914004394622*fnodal[10]-0.2618914004394622*fnodal[9]+0.2618914004394622*fnodal[8]+0.1309457002197311*fnodal[7]-0.1309457002197311*fnodal[5]+0.1309457002197311*fnodal[2]-0.1309457002197311*fnodal[0]; 
  fmodal[16] = 0.1014301032416974*fnodal[19]+0.1014301032416974*fnodal[17]-0.1014301032416974*fnodal[14]-0.1014301032416974*fnodal[12]-0.2028602064833949*fnodal[11]-0.2028602064833949*fnodal[10]+0.2028602064833949*fnodal[9]+0.2028602064833949*fnodal[8]+0.1014301032416974*fnodal[7]+0.1014301032416974*fnodal[5]-0.1014301032416974*fnodal[2]-0.1014301032416974*fnodal[0]; 
  fmodal[17] = 0.07560153527108576*fnodal[19]-0.1512030705421716*fnodal[18]+0.07560153527108576*fnodal[17]-0.07560153527108576*fnodal[14]+0.1512030705421716*fnodal[13]-0.07560153527108576*fnodal[12]-0.07560153527108576*fnodal[7]+0.1512030705421716*fnodal[6]-0.07560153527108576*fnodal[5]+0.07560153527108576*fnodal[2]-0.1512030705421716*fnodal[1]+0.07560153527108576*fnodal[0]; 
  fmodal[18] = 0.05856069741052554*fnodal[19]-0.05856069741052554*fnodal[17]-0.1171213948210511*fnodal[16]+0.1171213948210511*fnodal[15]+0.05856069741052554*fnodal[14]-0.05856069741052554*fnodal[12]-0.05856069741052554*fnodal[7]+0.05856069741052554*fnodal[5]+0.1171213948210511*fnodal[4]-0.1171213948210511*fnodal[3]-0.05856069741052554*fnodal[2]+0.05856069741052554*fnodal[0]; 
  fmodal[19] = 0.07560153527108576*fnodal[19]-0.07560153527108576*fnodal[17]-0.07560153527108576*fnodal[14]+0.07560153527108576*fnodal[12]-0.1512030705421716*fnodal[11]+0.1512030705421716*fnodal[10]+0.1512030705421716*fnodal[9]-0.1512030705421716*fnodal[8]+0.07560153527108576*fnodal[7]-0.07560153527108576*fnodal[5]-0.07560153527108576*fnodal[2]+0.07560153527108576*fnodal[0]; 
}

GKYL_CU_DH
void
nodal_to_modal_quad_surfz_3d_ser_p2(const double *fnodal, double *fmodal)
{
  fmodal[0] = (-0.1964185503295965*fnodal[19])+0.3142696805273545*fnodal[18]-0.1964185503295965*fnodal[17]+0.3142696805273545*fnodal[16]+0.3142696805273545*fnodal[15]-0.1964185503295965*fnodal[14]+0.3142696805273545*fnodal[13]-0.1964185503295965*fnodal[12]+0.4714045207910317*fnodal[11]+0.4714045207910317*fnodal[10]+0.4714045207910317*fnodal[9]+0.4714045207910317*fnodal[8]-0.1964185503295965*fnodal[7]+0.3142696805273545*fnodal[6]-0.1964185503295965*fnodal[5]+0.3142696805273545*fnodal[4]+0.3142696805273545*fnodal[3]-0.1964185503295965*fnodal[2]+0.3142696805273545*fnodal[1]-0.1964185503295965*fnodal[0]; 
  fmodal[1] = (-0.02928034870526278*fnodal[19])+0.02928034870526278*fnodal[17]+0.2342427896421021*fnodal[16]-0.2342427896421021*fnodal[15]-0.02928034870526278*fnodal[14]+0.02928034870526278*fnodal[12]+0.3513641844631533*fnodal[11]-0.3513641844631533*fnodal[10]+0.3513641844631533*fnodal[9]-0.3513641844631533*fnodal[8]-0.02928034870526278*fnodal[7]+0.02928034870526278*fnodal[5]+0.2342427896421021*fnodal[4]-0.2342427896421021*fnodal[3]-0.02928034870526278*fnodal[2]+0.02928034870526278*fnodal[0]; 
  fmodal[2] = (-0.0292803487052628*fnodal[19])+0.2342427896421022*fnodal[18]-0.0292803487052628*fnodal[17]+0.0292803487052628*fnodal[14]-0.2342427896421022*fnodal[13]+0.0292803487052628*fnodal[12]+0.3513641844631533*fnodal[11]+0.3513641844631533*fnodal[10]-0.3513641844631533*fnodal[9]-0.3513641844631533*fnodal[8]-0.0292803487052628*fnodal[7]+0.2342427896421022*fnodal[6]-0.0292803487052628*fnodal[5]+0.0292803487052628*fnodal[2]-0.2342427896421022*fnodal[1]+0.0292803487052628*fnodal[0]; 
  fmodal[3] = 0.02268046058132573*fnodal[19]+0.1814436846506059*fnodal[18]+0.02268046058132573*fnodal[17]+0.1814436846506059*fnodal[16]+0.1814436846506059*fnodal[15]+0.02268046058132573*fnodal[14]+0.1814436846506059*fnodal[13]+0.02268046058132573*fnodal[12]-0.02268046058132573*fnodal[7]-0.1814436846506059*fnodal[6]-0.02268046058132573*fnodal[5]-0.1814436846506059*fnodal[4]-0.1814436846506059*fnodal[3]-0.02268046058132573*fnodal[2]-0.1814436846506059*fnodal[1]-0.02268046058132573*fnodal[0]; 
  fmodal[4] = 0.06547285010986549*fnodal[19]-0.06547285010986549*fnodal[17]-0.06547285010986549*fnodal[14]+0.06547285010986549*fnodal[12]+0.2618914004394621*fnodal[11]-0.2618914004394621*fnodal[10]-0.2618914004394621*fnodal[9]+0.2618914004394621*fnodal[8]+0.06547285010986549*fnodal[7]-0.06547285010986549*fnodal[5]-0.06547285010986549*fnodal[2]+0.06547285010986549*fnodal[0]; 
  fmodal[5] = 0.08452508603474788*fnodal[19]-0.08452508603474788*fnodal[17]+0.1352401376555965*fnodal[16]-0.1352401376555965*fnodal[15]+0.08452508603474788*fnodal[14]-0.08452508603474788*fnodal[12]-0.08452508603474788*fnodal[7]+0.08452508603474788*fnodal[5]-0.1352401376555965*fnodal[4]+0.1352401376555965*fnodal[3]-0.08452508603474788*fnodal[2]+0.08452508603474788*fnodal[0]; 
  fmodal[6] = 0.08452508603474788*fnodal[19]+0.1352401376555966*fnodal[18]+0.08452508603474788*fnodal[17]-0.08452508603474788*fnodal[14]-0.1352401376555966*fnodal[13]-0.08452508603474788*fnodal[12]-0.08452508603474788*fnodal[7]-0.1352401376555966*fnodal[6]-0.08452508603474788*fnodal[5]+0.08452508603474788*fnodal[2]+0.1352401376555966*fnodal[1]+0.08452508603474788*fnodal[0]; 
  fmodal[7] = 0.1756820922315766*fnodal[19]-0.3513641844631533*fnodal[18]+0.1756820922315766*fnodal[17]+0.1756820922315766*fnodal[14]-0.3513641844631533*fnodal[13]+0.1756820922315766*fnodal[12]+0.1756820922315766*fnodal[7]-0.3513641844631533*fnodal[6]+0.1756820922315766*fnodal[5]+0.1756820922315766*fnodal[2]-0.3513641844631533*fnodal[1]+0.1756820922315766*fnodal[0]; 
  fmodal[8] = 0.1756820922315766*fnodal[19]+0.1756820922315766*fnodal[17]-0.3513641844631533*fnodal[16]-0.3513641844631533*fnodal[15]+0.1756820922315766*fnodal[14]+0.1756820922315766*fnodal[12]+0.1756820922315766*fnodal[7]+0.1756820922315766*fnodal[5]-0.3513641844631533*fnodal[4]-0.3513641844631533*fnodal[3]+0.1756820922315766*fnodal[2]+0.1756820922315766*fnodal[0]; 
  fmodal[9] = 0.105409255338946*fnodal[19]+0.105409255338946*fnodal[17]+0.105409255338946*fnodal[14]+0.105409255338946*fnodal[12]-0.210818510677892*fnodal[11]-0.210818510677892*fnodal[10]-0.210818510677892*fnodal[9]-0.210818510677892*fnodal[8]+0.105409255338946*fnodal[7]+0.105409255338946*fnodal[5]+0.105409255338946*fnodal[2]+0.105409255338946*fnodal[0]; 
  fmodal[10] = 0.1134023029066286*fnodal[19]-0.1134023029066286*fnodal[17]-0.1134023029066286*fnodal[14]+0.1134023029066286*fnodal[12]-0.1134023029066286*fnodal[7]+0.1134023029066286*fnodal[5]+0.1134023029066286*fnodal[2]-0.1134023029066286*fnodal[0]; 
  fmodal[11] = 0.1309457002197311*fnodal[19]-0.2618914004394622*fnodal[18]+0.1309457002197311*fnodal[17]-0.1309457002197311*fnodal[14]+0.2618914004394622*fnodal[13]-0.1309457002197311*fnodal[12]+0.1309457002197311*fnodal[7]-0.2618914004394622*fnodal[6]+0.1309457002197311*fnodal[5]-0.1309457002197311*fnodal[2]+0.2618914004394622*fnodal[1]-0.1309457002197311*fnodal[0]; 
  fmodal[12] = 0.1309457002197311*fnodal[19]-0.1309457002197311*fnodal[17]-0.2618914004394622*fnodal[16]+0.2618914004394622*fnodal[15]+0.1309457002197311*fnodal[14]-0.1309457002197311*fnodal[12]+0.1309457002197311*fnodal[7]-0.1309457002197311*fnodal[5]-0.2618914004394622*fnodal[4]+0.2618914004394622*fnodal[3]+0.1309457002197311*fnodal[2]-0.1309457002197311*fnodal[0]; 
  fmodal[13] = 0.1014301032416974*fnodal[19]-0.2028602064833949*fnodal[18]+0.1014301032416974*fnodal[17]+0.1014301032416974*fnodal[14]-0.2028602064833949*fnodal[13]+0.1014301032416974*fnodal[12]-0.1014301032416974*fnodal[7]+0.2028602064833949*fnodal[6]-0.1014301032416974*fnodal[5]-0.1014301032416974*fnodal[2]+0.2028602064833949*fnodal[1]-0.1014301032416974*fnodal[0]; 
  fmodal[14] = 0.1014301032416974*fnodal[19]+0.1014301032416974*fnodal[17]-0.2028602064833949*fnodal[16]-0.2028602064833949*fnodal[15]+0.1014301032416974*fnodal[14]+0.1014301032416974*fnodal[12]-0.1014301032416974*fnodal[7]-0.1014301032416974*fnodal[5]+0.2028602064833949*fnodal[4]+0.2028602064833949*fnodal[3]-0.1014301032416974*fnodal[2]-0.1014301032416974*fnodal[0]; 
  fmodal[15] = 0.07856742013183861*fnodal[19]-0.07856742013183861*fnodal[17]+0.07856742013183861*fnodal[14]-0.07856742013183861*fnodal[12]-0.1571348402636772*fnodal[11]+0.1571348402636772*fnodal[10]-0.1571348402636772*fnodal[9]+0.1571348402636772*fnodal[8]+0.07856742013183861*fnodal[7]-0.07856742013183861*fnodal[5]+0.07856742013183861*fnodal[2]-0.07856742013183861*fnodal[0]; 
  fmodal[16] = 0.07856742013183861*fnodal[19]+0.07856742013183861*fnodal[17]-0.07856742013183861*fnodal[14]-0.07856742013183861*fnodal[12]-0.1571348402636772*fnodal[11]-0.1571348402636772*fnodal[10]+0.1571348402636772*fnodal[9]+0.1571348402636772*fnodal[8]+0.07856742013183861*fnodal[7]+0.07856742013183861*fnodal[5]-0.07856742013183861*fnodal[2]-0.07856742013183861*fnodal[0]; 
  fmodal[17] = 0.07560153527108576*fnodal[19]-0.1512030705421716*fnodal[18]+0.07560153527108576*fnodal[17]-0.07560153527108576*fnodal[14]+0.1512030705421716*fnodal[13]-0.07560153527108576*fnodal[12]-0.07560153527108576*fnodal[7]+0.1512030705421716*fnodal[6]-0.07560153527108576*fnodal[5]+0.07560153527108576*fnodal[2]-0.1512030705421716*fnodal[1]+0.07560153527108576*fnodal[0]; 
  fmodal[18] = 0.07560153527108576*fnodal[19]-0.07560153527108576*fnodal[17]-0.1512030705421716*fnodal[16]+0.1512030705421716*fnodal[15]+0.07560153527108576*fnodal[14]-0.07560153527108576*fnodal[12]-0.07560153527108576*fnodal[7]+0.07560153527108576*fnodal[5]+0.1512030705421716*fnodal[4]-0.1512030705421716*fnodal[3]-0.07560153527108576*fnodal[2]+0.07560153527108576*fnodal[0]; 
  fmodal[19] = 0.05856069741052554*fnodal[19]-0.05856069741052554*fnodal[17]-0.05856069741052554*fnodal[14]+0.05856069741052554*fnodal[12]-0.1171213948210511*fnodal[11]+0.1171213948210511*fnodal[10]+0.1171213948210511*fnodal[9]-0.1171213948210511*fnodal[8]+0.05856069741052554*fnodal[7]-0.05856069741052554*fnodal[5]-0.05856069741052554*fnodal[2]+0.05856069741052554*fnodal[0]; 
}

