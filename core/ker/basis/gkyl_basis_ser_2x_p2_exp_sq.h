GKYL_CU_DH static inline void 
ser_2x_p2_exp_sq(const double *A, double *ASq) 
{ 
  // A:   Input DG field. 
  // ASq: Output DG field (expansion of A^2). 
 
  const double A0R2 = pow(A[0],2);
  const double A1R2 = pow(A[1],2);
  const double A2R2 = pow(A[2],2);
  const double A3R2 = pow(A[3],2);
  const double A4R2 = pow(A[4],2);
  const double A5R2 = pow(A[5],2);
  const double A6R2 = pow(A[6],2);
  const double A7R2 = pow(A[7],2);

  ASq[0] = 0.5*A7R2+0.5*A6R2+0.5*A5R2+0.5*A4R2+0.5*A3R2+0.5*A2R2+0.5*A1R2+0.5*A0R2; 
  ASq[1] = 1.0*A[5]*A[7]+0.8944271909999161*A[3]*A[6]+0.8944271909999159*A[1]*A[4]+A[2]*A[3]+A[0]*A[1]; 
  ASq[2] = 0.8944271909999161*A[3]*A[7]+1.0*A[4]*A[6]+0.8944271909999159*A[2]*A[5]+A[1]*A[3]+A[0]*A[2]; 
  ASq[3] = 0.8*A[6]*A[7]+0.8944271909999161*A[2]*A[7]+0.8944271909999161*A[1]*A[6]+0.8944271909999159*A[3]*A[5]+0.8944271909999159*A[3]*A[4]+A[0]*A[3]+A[1]*A[2]; 
  ASq[4] = 0.4472135954999579*A7R2+0.31943828249997*A6R2+1.0*A[2]*A[6]+0.31943828249997*A4R2+A[0]*A[4]+0.4472135954999579*A3R2+0.4472135954999579*A1R2; 
  ASq[5] = 0.31943828249997*A7R2+1.0*A[1]*A[7]+0.4472135954999579*A6R2+0.31943828249997*A5R2+A[0]*A[5]+0.4472135954999579*A3R2+0.4472135954999579*A2R2; 
  ASq[6] = 0.8*A[3]*A[7]+0.8944271909999159*A[5]*A[6]+0.6388765649999399*A[4]*A[6]+A[0]*A[6]+1.0*A[2]*A[4]+0.8944271909999161*A[1]*A[3]; 
  ASq[7] = 0.6388765649999399*A[5]*A[7]+0.8944271909999159*A[4]*A[7]+A[0]*A[7]+0.8*A[3]*A[6]+1.0*A[1]*A[5]+0.8944271909999161*A[2]*A[3]; 
} 
 
